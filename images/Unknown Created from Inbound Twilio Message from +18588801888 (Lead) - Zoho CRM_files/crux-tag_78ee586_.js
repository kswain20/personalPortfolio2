Lyte.Component.register("crux-tag",{_template:'<template tag-name="crux-tag"> <lyte-dropdown lt-prop-disabled="{{cxPropDisabled}}" onmousedown="{{action(\'onMouseDown\',this,event)}}" onclick="{{action(\'onFocus\',this)}}" class="cxBoxDropdown {{if(cxPropTags.length,\'cxTagTagsPresent\',\'cxTagNoTagsPresent lyteDropNoOptSelected\')}}" lt-prop-selected="{{lbind(selectedList)}}" lt-prop-yield="true" on-before-add="{{method(\'beforeAddToList\')}}" on-add="{{method(\'addToList\')}}" on-before-remove="{{method(\'beforeRemoveFromList\')}}" on-remove="{{method(\'removeFromList\')}}" lt-prop-type="multisearch" lt-prop-tabindex="14" on-before-show="{{method(\'onBeforeOpenDropBox\')}}" on-hide="{{method(\'hideDropBox\')}}" on-before-hide="{{method(\'onBeforeHide\')}}" on-show="{{method(\'onOpenDropBox\')}}" lt-prop-boundary="{{cxPropBoundary}}" on-before-scroll-close="{{method(\'dropdownScrollClose\')}}" lt-prop-scope="{{cxPropScope}}" lt-prop-disable-item-tooltip="true"> <template is="registerYield" yield-name="yield"> <lyte-drop-button> <div class="lyteMultiselect"> <ul class="lyteMultipleSelect"> <template is="for" items="{{cxPropTags}}" item="selitem" index="indeval"> <li onanimationend="{{action(\'animationEnd\',indeval)}}" id="{{concat(\'tag_\',selitem.name)}}" data-value="{{selitem.name}}" class="{{if(tagAnimationArr[indeval].doAnimation,\'cxExistingTag\',\'\')}} {{if(tagAnimationArr[indeval].highlightTag,\'cxTagHighlight\',\'\')}} cxAddedTags {{concat(\'cxTag\',cruxGetTagColorIndex(selitem.color_code))}} {{if(cxPropBinaryColor,selitem.binaryColor,\'\')}} {{if(selitem.class,selitem.class,\'\')}}"> <lyte-text class="lyteDropdownVisible" lt-prop-value="{{selitem.name}}"> </lyte-text> <lyte-drop-remove class="lyteCloseIcon"></lyte-drop-remove> </li> </template> <li class="lyteMultiselectInput"> <lyte-input lt-prop-disabled="{{cxPropInputDisabled}}" on-blur="{{method(\'onBlur\')}}" lt-prop-update-delay="{{unDef}}" lt-prop-value="{{lbind(cxPropInputValue)}}" data-zcqa="searchTags" class="cxTagSearch" lt-prop-type="text" lt-prop-placeholder="{{cxPropInputPlaceholder}}" onkeydown="{{action(\'onKeyDown\',this,event)}}" oninput="{{action(\'onInput\',event,this)}}"></lyte-input> </li> </ul> </div> </lyte-drop-button> <lyte-drop-box class="cxDropbox cxTagDropBox {{cxPropBoxClass}}"> <lyte-drop-body> <lyte-drop-item id="newTagId" data-zcqa="newTag" class="cxNewTagItem {{if(newTag,\'\',\'lyteSearchHidden\')}}" data-value="{{newTagMsg}}" lt-prop-title="{{newTagMsgTooltip}}"> <template is="if" value="{{cxPropColorTags}}"><template case="true"> <crux-color-palette cx-palette-open="{{lbind(paletteOpen)}}" cx-prop-id="{{cxPropId}}" on-before-color-palette-hide="{{method(\'colorPaletteHide\')}}"></crux-color-palette> </template></template> <span class="color_9 mR5 f11 proxmial">{{cxPropNewTagOptionMsg}}</span> <span class="cxNewTagLabel">{{newTagMsg}}</span> </lyte-drop-item> <template is="if" value="{{cxPropAllowDropdown}}"><template case="true"> <template is="for" items="{{cxPropTagOptions}}" item="item" index="indval"> <lyte-drop-item id="tagItem" class="cxTagDropItem" data-zcqa="tag_{{item.name}}" data-value="{{item.name}}"><span class="{{concat(\'cxTag\',cruxGetTagColorIndex(item.color_code))}} {{if(cxPropBinaryColor,item.binaryColor,\'\')}} cxTagDropItemChild">{{item.name}}</span></lyte-drop-item> </template> <div class="cxDropdownNoResult" style="{{if(noValue,\'display: block\',\'display: none\')}}">{{cxPropNoMoreTagOptionsMsg}}</div> </template></template> </lyte-drop-body> </lyte-drop-box> </template> </lyte-dropdown> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1,1,1,1]},{type:"for",position:[1,1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"componentDynamic",position:[1,3]}]},{type:"attr",position:[1,1,1,3,1]},{type:"componentDynamic",position:[1,1,1,3,1]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"attr",position:[3,1,1]},{type:"attr",position:[3,1,1,1]},{type:"if",position:[3,1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"text",position:[3,1,1,3,0]},{type:"text",position:[3,1,1,5,0]},{type:"componentDynamic",position:[3,1,1]},{type:"attr",position:[3,1,3]},{type:"if",position:[3,1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,0]},{type:"text",position:[1,0,0]},{type:"componentDynamic",position:[1]}]},{type:"attr",position:[3],attr:{style:{name:"style",helperInfo:{name:"if",args:["noValue","'display: block'","'display: none'"]}}}},{type:"text",position:[3,0]}]}},default:{}},{type:"componentDynamic",position:[3,1]},{type:"componentDynamic",position:[3]}]},{type:"componentDynamic",position:[1]}],_observedAttributes:["cxPropTagOptions","cxPropTags","cxPropAllowDropdown","cxPropCommaSeperation","cxPropPreventKeyList","cxPropCreteTagKey","cxPropNoMoreTagOptionsMsg","cxPropNewTagOptionMsg","cxPropInputPlaceholder","cxPropMaxOptionsLimit","cxPropMaxTagLimit","cxPropCreateOnAdd","cxPropAllowNewTagCreations","cxPropInputValue","cxPropMaxTagLength","cxPropBoxClass","cxPropInputDisabled","cxPropId","cxPropBoundary","cxPropScope","cxPropDoubleBackSpace","cxPropColorTags","cxPropClass","cxPropDisabled","cxPropTagModelDetails","cxPropBinaryColor","selectedList","noValue","newTag","newTagMsg","onFocus","tagAnimationArr","paletteOpen"],data:function(){return{cxPropTagOptions:Lyte.attr("array",{default:[]}),cxPropTags:Lyte.attr("array",{default:[]}),cxPropAllowDropdown:Lyte.attr("boolean",{default:!0}),cxPropCommaSeperation:Lyte.attr("boolean",{default:!1}),cxPropPreventKeyList:Lyte.attr("array",{default:[]}),cxPropCreteTagKey:Lyte.attr("array",{default:[",",13,9]}),cxPropNoMoreTagOptionsMsg:Lyte.attr("string",{default:_cruxUtils.getI18n("crm.template.listview.search.no.results")}),cxPropNewTagOptionMsg:Lyte.attr("string",{default:_cruxUtils.getI18n("crm.label.tag.new")}),cxPropInputPlaceholder:Lyte.attr("string",{default:_cruxUtils.getI18n("crm.label.enter.tag")}),cxPropMaxOptionsLimit:Lyte.attr("number",{default:0}),cxPropMaxTagLimit:Lyte.attr("number",{default:0}),cxPropCreateOnAdd:Lyte.attr("boolean",{default:!0}),cxPropAllowNewTagCreations:Lyte.attr("boolean",{default:!0}),cxPropInputValue:Lyte.attr("string",{default:""}),cxPropMaxTagLength:Lyte.attr("number",{default:25}),cxPropBoxClass:Lyte.attr("string",{default:""}),cxPropInputDisabled:Lyte.attr("boolean",{default:!1}),cxPropId:Lyte.attr("string"),cxPropBoundary:Lyte.attr("object",{default:{}}),cxPropScope:Lyte.attr("string"),cxPropDoubleBackSpace:Lyte.attr("boolean",{default:!0}),cxPropColorTags:Lyte.attr("boolean",{default:!0}),cxPropClass:Lyte.attr("string"),cxPropDisabled:Lyte.attr("boolean",{default:!1}),cxPropTagModelDetails:Lyte.attr("object",{default:{}}),cxPropBinaryColor:Lyte.attr("object",{default:{enable:!1,existingTagClass:"",newTagClass:""}}),selectedList:Lyte.attr("string"),noValue:Lyte.attr("boolean",{default:!1}),newTag:Lyte.attr("boolean",{default:!1}),newTagMsg:Lyte.attr("string"),onFocus:Lyte.attr("boolean",{default:!1}),tagAnimationArr:Lyte.attr("array",{default:[]}),paletteOpen:Lyte.attr("boolean",{default:!1})}},inputDisabled:function(){var t=this.$node.querySelector(".lyteDummyEventContainer");this.getData("cxPropInputDisabled")?t.onblur=function(){this.setData("onFocus",!1)}.bind(this):t.onblur=null}.observes("cxPropInputDisabled").on("didConnect"),resetNoResultDiv:function(){this.getData("cxPropTagOptions").length>0&&this.setData("noValue",!1)}.observes("cxPropTagOptions"),resetTagAnimationArr:function(t){var e=this.getData("cxPropBinaryColor");if(e.enable&&!this.internalSelectedUpdate&&this.setBinaryClass(e),t){var o=this.getData("cxPropTags");if(this.preventTagsObserver)this.preventTagsObserver=!1;else if("change"==t.type){for(var a=t.newValue,r=a.length,i=[],n=[],s=0;s<r;s++)Lyte.arrayUtils(i,"push",{doAnimation:!1,highlightTag:!1}),n.push(a[s].name);this.setData("selectedList",JSON.stringify(n)),this.setData("tagAnimationArr",i)}else if("array"==t.type){var l;if(t.removedItems&&t.removedItems.length){l=t.removedItems.length;for(s=0;s<l;s++)Lyte.arrayUtils(this.getData("tagAnimationArr"),"removeAt",t.index+s,1),this.removeLatestSelected(t.removedItems[s].name)}if(t.insertedItems&&t.insertedItems.length){l=t.insertedItems.length;for(s=0;s<l;s++)t.index==o.length-1?Lyte.arrayUtils(this.getData("tagAnimationArr"),"push",{doAnimation:!1,highlightTag:!1}):Lyte.arrayUtils(this.getData("tagAnimationArr"),"insertAt",t.index+s,{doAnimation:!1,highlightTag:!1}),this.addToSelectedList(t.insertedItems[s].name)}}}else this.checkIfSelectedIsToBeSet(!1)}.observes("cxPropTags.[]").on("didConnect"),focusObserver:function(t){t.newValue?this.$node.querySelector("lyte-drop-button").classList.add("cxDropButtonFocused"):this.$node.querySelector("lyte-drop-button").classList.remove("cxDropButtonFocused")}.observes("onFocus"),newTagMsgObserver:function(){var t=this.bodyDrop&&this.bodyDrop.querySelector("#newTagId");t&&(t.offsetWidth<t.scrollWidth?this.setData("newTagMsgTooltip",this.data.newTagMsg):this.setData("newTagMsgTooltip",""))}.observes("newTagMsg"),
//!!Check This Below Function
newTag:function(t){if(this.getData("cxPropAllowDropdown")){var e=this.$node.querySelector("lyte-dropdown");if(!(e.component.childComp?e.component.childComp:this.$node.querySelector("lyte-dropdown lyte-drop-box")).classList.contains("lyteDropdownHidden"))if(t.newValue)$L(".lyteDropdownSelection",this.bodyDrop).removeClass("lyteDropdownSelection"),$L(".cxNewTagItem",this.bodyDrop).addClass("lyteDropdownSelection");else if(!$L(".lyteDropdownSelection",this.bodyDrop).length){var o=$L("lyte-drop-item",this.bodyDrop);"newTagId"===o[0].id?o[1]&&o[1].classList.add("lyteDropdownSelection"):o[0].classList.add("lyteDropdownSelection")}}}.observes("newTag"),didDestroy:function(){delete this.bodyDrop},didConnect:function(){this.setDataToScope(),this.$node.checkList=function(t){this.callFromOut=!0;var e=this.checkCharacter(t);return this.callFromOut=!1,e}.bind(this),this.$node.toggle=function(t){this.setFromExternalDeveloper=!0,this.toggleComp(t),setTimeout(function(){this.setFromExternalDeveloper=!1}.bind(this),10)}.bind(this),this.$node.focus=function(){this.setData("onFocus",!1),this.setData("onFocus",!0),this.$node.querySelector(".cxTagSearch").focus()}.bind(this),this.$node.blur=function(){this.setData("onFocus",!1),this.$node.querySelector(".cxTagSearch").blur()}.bind(this),this.$node.resetSearch=function(){this.resetSearch()}.bind(this),
//!!Check This Below Function
this.$node.resetPosition=function(){this.$node.querySelector("lyte-dropdown").resetPosition(),this.data.paletteOpen&&this.bodyDrop.querySelector("crux-color-palette").alignColorPalette()}.bind(this),
//!!Check this below Code Block
this.$node.addNewTag=function(){this.data.cxPropInputValue&&this.addNewTag(this.data.cxPropInputValue,"out")}.bind(this);var t=this.getData("cxPropTags"),e=0;if(t)e=t.length;for(var o=0;o<e;o++)Lyte.arrayUtils(this.getData("tagAnimationArr"),"push",{doAnimation:!1,highlightTag:!1})},setBinaryClass:function(t){var e=this.getData("cxPropTags"),o=this.getData("cxPropTagOptions");if(e)for(var a=e.length,r=o.length,i=0;i<a;i++){for(var n=!1,s=0;s<r;s++)o[s].name.toLowerCase()===e[i].name.toLowerCase()&&(n=!0);n?Lyte.objectUtils(e[i],"add","binaryColor",t.existingTagClass):Lyte.objectUtils(e[i],"add","binaryColor",t.newTagClass)}},checkIfSelectedIsToBeSet:function(t){if(this.getData("cxPropAllowDropdown")||this.data.cxPropColorTags&&this.data.newTag){var e,o,a=this.getData("selectedList").slice();if(0==(a=JSON.parse(a)).length&&0!=this.data.cxPropTags.length)for(e=0;e<this.data.cxPropTags.length;e++)this.addToSelectedList(this.getData("cxPropTags")[e].name);else if(a.length!=this.data.cxPropTags.length)for(e=0;e<this.data.cxPropTags.length;e++){var r=!0;for(o=0;o<a.length;o++)this.data.cxPropTags[e].name==a[o]&&(r=!1);r&&this.addToSelectedList(this.getData("cxPropTags")[e].name)}t&&(this.checkListCount(),this.getData("cxPropInputValue")&&this.getData("cxPropCreateOnAdd")&&this.processSearch({keyCode:null},this.getData("cxPropInputValue")))}},setDataToScope:function(){this.newTagCount=0,this.allowSearch=!0,this.callFromOut=!1,this.onErrorReturn=!1,this.valuesToRemove=[],this.preventTagsObserver=!1,this.preventBlurFromDrop=!1,this.onTagRemovalHighlight=!1,this.preventInput=!1,this.preventOnAdd=!1,this.preventBlurOnError=!1,this.internalSelectedUpdate=!1},addNewTag:function(t,e){var o,a=null,r=!1;this.getData("cxPropCommaSeperation")&&-1!=t.indexOf(",")?(r=!0,o=t.split(",")):o=[t];var i=!0,n=o.length,s=0;for(n<=0&&(i=!1),this.valuesToRemove=[];i;){if(o[s]&&""!=o[s])if(this.checkCharacter(o[s])){var l=this._isPresent(o[s]);if("newTag"==l.message){
//!!Check if the if condition at below line is required
if("keyDown"===e&&(this.data.paletteOpen&&this.bodyDrop.querySelector("crux-color-palette").closePalette(),this.getData("cxPropAllowDropdown")||this.toggleComp("close")),o[s].length>0){var p=!1;"DropDown"===e&&(p=!0),this.addToSelectedTags(event,o[s],p,r)?this.addToSelectedList(o[s]):"DropDown"!==e||this.onErrorReturn?(i=!1,a="NTE"):this.valuesToRemove.push(o[s])}this.bodyDrop&&"DropDown"!==e&&this.bodyDrop.querySelector("#newTagId").classList.remove("lyteDropdownActive")}else if("existingTag"==l.message){if("DropDown"!==e&&(this.preventBlurOnError=!0),this.getMethods("onError")&&this.executeMethod("onError",o[s],{errorCode:4,reason:"Already existing tag"},this.$node.querySelector("lyte-dropdown"),this.$node.querySelector("lyte-dropdown lyte-drop-box"),this.$node.querySelector("lyte-input"),this.$node),"DropDown"!==e&&(this.preventBlurOnError=!1),!this.getData("cxPropColorTags")){var c=this.getData("tagAnimationArr")[l.pos];c.doAnimation=!0,Lyte.arrayUtils(this.getData("tagAnimationArr"),"replaceAt",l.pos,c)}}else"dropOption"==l.message&&(this.addToSelectedTags(event,o[s],!0,r)?
//!!Check if below if condition is required
("DropDown"!==e||"DropDown"===e&&r)&&this.addToSelectedList(this.getData("cxPropTagOptions")[l.pos].name):"DropDown"!==e||this.onErrorReturn?(i=!1,a="DOE"):this.valuesToRemove.push(o[s]))}else i=!1,a="CE";if(i){for(s+=1;""==o[s];)s+=1;s>=n&&(i=!1)}}
//!!Check This Below code
if(a||(a="succ"),this.bodyDrop&&("Blur"===e||"out"===e)&&this.bodyDrop.querySelector("crux-color-palette")){for(var d=this.bodyDrop.querySelector("crux-color-palette").cxProp("defaultColors")[Math.floor(13*Math.random())];d==this.bodyDrop.querySelector("crux-color-palette").cxProp("selectedColor");)d=this.bodyDrop.querySelector("crux-color-palette").cxProp("defaultColors")[Math.floor(13*Math.random())];this.bodyDrop.querySelector("crux-color-palette").cxProp("selectedColor",d)}return a},handleAddNewTag:function(t,e,o){if(!t||""===t||""==t.trim())return!1;var a=this.addNewTag(t,e);if("CE"===a||"NTE"===a||"DOE"===a){if("CE"===a)return"keyDown"===e&&13==o.keyCode&&(this.preventOnAdd=!0),this.setData("cxPropInputValue",t),!1;if(("NTE"===a||"DOE"===a)&&("NTE"===a&&13==o.keyCode&&"keyDown"===e&&(this.preventOnAdd=!0),this.onErrorReturn))return this.setData("cxPropInputValue",t),!1}else if("succ"===a)return!0},toggleComp:function(t){var e=this.$node.querySelector("lyte-dropdown"),o=e.component.childComp?e.component.childComp:this.$node.querySelector("lyte-dropdown lyte-drop-box");"open"==t?o.classList.contains("lyteDropdownHidden")&&(this.getData("cxPropInputValue")&&this.processSearch({keyCode:null},this.getData("cxPropInputValue")),o.classList.contains("lyteDropdownHidden")&&e.toggle()):"close"==t&&o.classList.contains("lyteDropdownHidden")||e.toggle()},processSearch:function(t,e){/^\s+$/.test(e)&&32==t.keyCode||(e=e.trim(),this.localSearch(t,e))},localSearch:function(t,e){for(var o=[],a=[],r=(this.bodyDrop?this.bodyDrop:this.$node.querySelector("lyte-dropdown lyte-drop-box")).querySelectorAll("lyte-drop-item:not(.cxNewTagItem)"),i=[],n=0;n<r.length;n++)i.push(r[n].textContent);for(n=0;n<r.length;n++)-1!=i[n].toLowerCase().indexOf(e.toLowerCase())?(r[n].classList.remove("lyteSearchHidden"),r[n].classList.contains("lyteDropdownActive")||a.push(r[n])):(r[n].classList.add("lyteSearchHidden"),o.push(r[n]));0==o.length&&this.setData("noValue",!1),this.showNoResult(t,e,a)},resetSearch:function(){this.getData("cxPropInputValue").length>0&&(this.allowSearch=!1,this.setData("newTag",!1),this.setData("newTagMsg",""),this.setData("cxPropInputValue",""),this.processSearch({},""))},showNoResult:function(t,e,o){if(this.allowSearch)if(""!=e.trim()){var a=this._isPresent(e);"newTag"==a.message&&this.getData("cxPropAllowNewTagCreations")?(this.setData("newTagMsg",e),this.setData("newTag",!0),this.setData("noValue",!1)):(this.setData("newTagMsg",""),this.setData("newTag",!1),
//!!Check This Below code
this.data.paletteOpen&&this.bodyDrop.querySelector("crux-color-palette").closePalette(),
//!!Check This Below code
this.data.cxPropAllowDropdown||this.toggleComp("close"),this.getData("newTag")||"existingTag"!=a.message?o.length||this.getData("newTag")?this.setData("noValue",!1):this.setData("noValue",!0):o.length?this.setData("noValue",!1):this.setData("noValue",!0))}else{if(this.setData("newTagMsg",""),this.setData("newTag",!1),
//!!Check This Below code
this.data.paletteOpen&&this.bodyDrop.querySelector("crux-color-palette").closePalette(),
//!!Check This Below code
this.data.cxPropAllowDropdown||this.toggleComp("close"),!this.getData("newTag"))if(this.bodyDrop)this.bodyDrop.querySelectorAll("#tagItem.lyteDropdownActive").length==this.getData("cxPropTagOptions").length?this.setData("noValue",!0):this.setData("noValue",!1)}else this.bodyDrop&&(this.allowSearch=!0,this.bodyDrop.querySelectorAll("#tagItem.lyteDropdownActive").length==this.getData("cxPropTagOptions").length&&""==e?this.setData("noValue",!0):this.setData("noValue",!1));if(this.getData("cxPropAllowDropdown")||this.data.cxPropColorTags&&this.data.newTag){var r=this.$node.querySelector("lyte-dropdown");(r.component.childComp?r.component.childComp:this.$node.querySelector("lyte-dropdown lyte-drop-box")).classList.contains("lyteDropdownHidden")||this.getData("newTag")&&(t&&t.keyCode&&13!==t.keyCode&&(t.keyCode>40||t.keyCode<37)||!t||!t.keyCode||0===Object.keys(t).length)&&($L(".lyteDropdownSelection",this.bodyDrop).removeClass("lyteDropdownSelection"),$L(".cxNewTagItem",this.bodyDrop).addClass("lyteDropdownSelection"))}},addToSelectedList:function(t){var e=this.getData("selectedList").slice();(e=JSON.parse(e)).push(t),e=JSON.stringify(e),this.setData("selectedList",e),this.checkListCount()},removeLatestSelected:function(){var t=this.getData("selectedList").slice(),e=(t=JSON.parse(t)).length;e>0&&Lyte.arrayUtils(t,"removeAt",e-1,1),t=JSON.stringify(t),this.setData("selectedList",t)},removeLatestTag:function(t,e){if(this.onTagRemovalHighlight)return this.onTagRemovalHighlight=!1,!1;for(var o,a=!0,r=this.getData("cxPropTags"),i=r.length,n=0;n<i;n++)r[n].name==t&&(o=n);if(this.getMethods("onBeforeRemoveTag")&&(a=this.executeMethod("onBeforeRemoveTag",t,o)),1==a||null==a||null==a){r[o].isNewTag?this.newTagCount=this.newTagCount-1:this.checkListCount();var s=this.getData("tagAnimationArr");if(this.preventTagsObserver=!0,s[o].doAnimation){var l=this.getData("tagAnimationArr")[o];l.doAnimation=!1,Lyte.arrayUtils(this.getData("tagAnimationArr"),"replaceAt",o,l)}Lyte.arrayUtils(this.getData("tagAnimationArr"),"removeAt",o,1),this.internalSelectedUpdate=!0,Lyte.arrayUtils(r,"removeAt",o,1),this.internalSelectedUpdate=!1,this.$node.querySelector("lyte-dropdown").resetPosition();var p=this.getData("tagAnimationArr");return p.length>0&&p[p.length-1].highlightTag&&(p[p.length-1].highlightTag=!1,Lyte.arrayUtils(this.getData("tagAnimationArr"),"replaceAt",p.length-1,p[p.length-1])),this.getMethods("onRemoveTag")&&(a=this.executeMethod("onRemoveTag",t,o)),!0}return!1},_isPresent:function(t){var e=this.getData("cxPropTags"),o=this.getData("cxPropTagOptions"),a=0,r={message:"newTag",pos:0},i=e.length,n=o.length;for(a=0;a<i;a++)if(e[a].name.toUpperCase().trim()==t.toUpperCase().trim())return r.message="existingTag",r.pos=a,r;for(a=0;a<n;a++)if(o[a].name.toUpperCase()==t.toUpperCase())return r.message="dropOption",r.pos=a,r;return r},validation:function(t){for(var e=!0,o=this.getData("cxPropPreventKeyList"),a=0;a<o.length;a++)if(-1!=t.indexOf(o[a])){e=!1;break}return e?!this.getMethods("onValidation")||this.executeMethod("onValidation",t,this.$node):(this.preventBlurOnError=!0,this.getMethods("onError")&&this.executeMethod("onError",t,{errorCode:1,reason:"Contains Invalid Key"},this.$node.querySelector("lyte-dropdown"),this.$node.querySelector("lyte-dropdown lyte-drop-box"),this.$node.querySelector("lyte-input"),this.$node),this.preventBlurOnError=!1,!1)},checkCharacter:function(t){var e;return this.callFromOut&&!this.getData("cxPropCreateOnAdd")||!this.callFromOut&&this.getData("cxPropCreateOnAdd")?e=this.validation(t):this.callFromOut||this.getData("cxPropCreateOnAdd")||(e=!0),1==e||null==e||null==e},addToSelectedTags:function(t,e,o,a){var r,i=!0;this.getMethods("onBeforeAddTag")&&(r=null!=o&&1==o,i=this.executeMethod("onBeforeAddTag",e,this.$node,r));if(1==i||null==i||null==i){var n=this.getData("cxPropBinaryColor"),s=!1,l=this.getData("cxPropTagOptions"),p=this.getData("cxPropTags"),c=l.length;if(!(0==this.getData("cxPropMaxTagLimit")||p.length<this.getData("cxPropMaxTagLimit")))return this.preventBlurOnError=!0,this.getMethods("onError")&&(i=this.executeMethod("onError",e,{errorCode:3,reason:"Max Tag Creation Limit Reached"},this.$node.querySelector("lyte-dropdown"),this.$node.querySelector("lyte-dropdown lyte-drop-box"),this.$node.querySelector("lyte-input"),this.$node)),this.preventBlurOnError=!1,this.onErrorReturn=!0,!1;for(var d=0;d<c;d++)if(l[d].name.toUpperCase().trim()==e.toUpperCase().trim()){s=!0;break}if(s){this.preventTagsObserver=!0,n.enable&&(o?Lyte.objectUtils(l[d],"add","binaryColor",n.existingTagClass):Lyte.objectUtils(l[d],"add","binaryColor",n.newTagClass)),this.internalSelectedUpdate=!0,Lyte.arrayUtils(p,"push",l[d]),this.internalSelectedUpdate=!1,this.resetSearch(),(u=this.getData("tagAnimationArr")).length>0&&u[u.length-1].highlightTag&&(u[u.length-1].highlightTag=!1,Lyte.arrayUtils(this.getData("tagAnimationArr"),"replaceAt",u.length-1,u[u.length-1])),this.getMethods("onAddTag")&&(i=this.executeMethod("onAddTag",e,this.$node))}else{if(this.getData("cxPropMaxOptionsLimit")>0&&l.length+this.newTagCount>=this.getData("cxPropMaxOptionsLimit"))return this.preventBlurOnError=!0,this.getMethods("onError")&&(i=this.executeMethod("onError",e,{errorCode:2,reason:"Max Tag Option Creation Limit Reached"},this.$node.querySelector("lyte-dropdown"),this.$node.querySelector("lyte-dropdown lyte-drop-box"),this.$node.querySelector("lyte-input"),this.$node)),this.preventBlurOnError=!1,this.onErrorReturn=!0,!1;
//!!Check This Below code
if(this.preventTagsObserver=!0,this.newTagCount=this.newTagCount+1,this.data.cxPropColorTags){if(Lyte.arrayUtils(p,"push",{name:e,isNewTag:!0,color_code:this.bodyDrop.querySelector("crux-color-palette").cxProp("selectedColor")}),!a){for(var h=this.bodyDrop.querySelector("crux-color-palette").cxProp("defaultColors")[Math.floor(13*Math.random())];h==this.bodyDrop.querySelector("crux-color-palette").cxProp("selectedColor");)h=this.bodyDrop.querySelector("crux-color-palette").cxProp("defaultColors")[Math.floor(13*Math.random())];this.bodyDrop.querySelector("crux-color-palette").cxProp("selectedColor",h)}}else{var g={name:e,isNewTag:!0};n.enable&&(o?Lyte.objectUtils(g,"add","binaryColor",n.existingTagClass):Lyte.objectUtils(g,"add","binaryColor",n.newTagClass)),this.internalSelectedUpdate=!0,Lyte.arrayUtils(p,"push",g),this.internalSelectedUpdate=!1}var u;this.resetSearch(),(u=this.getData("tagAnimationArr")).length>0&&u[u.length-1].highlightTag&&(u[u.length-1].highlightTag=!1,Lyte.arrayUtils(this.getData("tagAnimationArr"),"replaceAt",u.length-1,u[u.length-1])),this.getMethods("onAddTag")&&(i=this.executeMethod("onAddTag",e,this.$node))}return this.checkListCount(),
//!!Check This Below code
this.data.cxPropAllowDropdown||this.toggleComp("close"),Lyte.arrayUtils(this.getData("tagAnimationArr"),"push",{doAnimation:!1,highlightTag:!1}),!0}return!1},checkListCount:function(){var t=this.getData("cxPropTagOptions");this.bodyDrop&&(this.bodyDrop.querySelectorAll("#tagItem.lyteDropdownActive").length>=t.length?this.getData("newTag")?this.setData("noValue",!1):this.setData("noValue",!0):this.setData("noValue",!1))},
//!!Check Not required
actions:{onMouseDown:function(t,e){if(this.getData("onFocus")){var o=$L(e.target).closest("lyte-close-icon,li",this.$node).get(0);if(o){var a=!1;"LI"==o.tagName&&(a=o.classList.contains("lyteMultiselectInput")),a||(this.preventBlurFromDrop=!0)}}},animationEnd:function(t){var e=this.getData("tagAnimationArr")[t];e.doAnimation=!1,Lyte.arrayUtils(this.getData("tagAnimationArr"),"replaceAt",t,e)},onFocus:function(t){this.setData("onFocus",!0),this.getData("cxPropInputDisabled")||t.querySelector(".cxTagSearch").focus()},
//!!Check this below function
onKeyUp:function(t,e){this.preventInput?this.preventInput=!1:27!=t.keyCode&&(clearTimeout(this._timeout),this.processSearch(t,e.ltProp("value")),(this.getData("cxPropAllowDropdown")||this.data.cxPropColorTags&&this.data.newTag)&&this.toggleComp("open"))},
//!!Check this below function
input:function(t,e){this.preventInput?this.preventInput=!1:27!=t.keyCode&&(clearTimeout(this._timeout),this.processSearch(t,e.ltProp("value")),(this.getData("cxPropAllowDropdown")||this.data.cxPropColorTags&&this.data.newTag)&&this.toggleComp("open"))},onInput:function(t,e){if(e.ltProp("value").length>0)if(e.ltProp("value").length>this.getData("cxPropMaxTagLength")){var o=e.ltProp("value");this.preventInput=!0,this.preventBlurOnError=!0,this.getMethods("onError")&&this.executeMethod("onError",o,{errorCode:5,reason:"Max length of the tag has been reached"},this.$node.querySelector("lyte-dropdown"),this.$node.querySelector("lyte-dropdown lyte-drop-box"),this.$node.querySelector("lyte-input"),this.$node),this.preventBlurOnError=!1;var a=e.querySelector("input").selectionStart;this.setData("cxPropInputValue",o.slice(0,a-(o.length-this.getData("cxPropMaxTagLength")))+o.slice(a)),this.processSearch(t,this.getData("cxPropInputValue")),
//!!Check This Below code
(this.getData("cxPropAllowDropdown")||this.data.cxPropColorTags&&this.data.newTag)&&this.toggleComp("open")}else this.processSearch(t,this.getData("cxPropInputValue")),
//!!Check This Below code
(this.getData("cxPropAllowDropdown")||this.data.cxPropColorTags&&this.data.newTag)&&this.toggleComp("open");else
//!!Check This Below code
this.processSearch(t,this.getData("cxPropInputValue")),this.getData("cxPropAllowDropdown")&&this.toggleComp("open")},onKeyDown:function(t,e){if(this.processSearch(e,this.getData("cxPropInputValue")),(this.getData("cxPropAllowDropdown")||this.data.cxPropColorTags&&this.data.newTag)&&this.toggleComp("open"),8!==e.keyCode)(o=this.getData("tagAnimationArr")).length>0&&o[o.length-1].highlightTag&&(o[o.length-1].highlightTag=!1,Lyte.arrayUtils(this.getData("tagAnimationArr"),"replaceAt",o.length-1,o[o.length-1]));else if(this.getData("cxPropDoubleBackSpace")){var o,a=this.getData("cxPropTags");if(0==this.getData("cxPropInputValue").length&&0!=a.length)return(o=this.getData("tagAnimationArr"))[o.length-1].highlightTag?void 0:(o[o.length-1].highlightTag=!0,this.setData("tagAnimationArr",o),Lyte.arrayUtils(this.getData("tagAnimationArr"),"replaceAt",o.length-1,o[o.length-1]),void(this.onTagRemovalHighlight=!0))}if(this.getData("cxPropAllowNewTagCreations")){var r,i=t.ltProp("value");if(32==e.keyCode&&i.length<1)return void e.preventDefault();if(8==e.keyCode){a=this.getData("cxPropTags");if(1==this.getData("cxPropInputValue").length)
//!!Check lines [thisline +1] ,[thisline +3] and [thisline +5] if required or not
this.setData("newTag",!1),this.setData("newTagMsg",""),this.bodyDrop.querySelectorAll("#tagItem.lyteDropdownActive").length==this.getData("cxPropTagOptions").length?this.setData("noValue",!0):this.setData("noValue",!1)}if(this.getData("cxPropInputValue").length>this.getData("cxPropMaxTagLength")&&8!=e.keyCode)return this.preventBlurOnError=!0,this.getMethods("onError")&&this.executeMethod("onError",this.getData("cxPropInputValue"),{errorCode:5,reason:"Max length of the tag has been reached"},this.$node.querySelector("lyte-dropdown"),this.$node.querySelector("lyte-dropdown lyte-drop-box"),this.$node.querySelector("lyte-input"),this.$node),this.preventBlurOnError=!1,void e.preventDefault();var n=this.getData("cxPropPreventKeyList"),s=this.getData("cxPropCreteTagKey");if((this.getData("cxPropAllowDropdown")||this.data.cxPropColorTags&&this.data.newTag)&&13==e.keyCode){var l=this.$node.querySelector("lyte-dropdown"),p=l.component.childComp?l.component.childComp:this.$node.querySelector("lyte-dropdown lyte-drop-box"),c=$L(".lyteDropdownSelection",this.bodyDrop);if(!p.classList.contains("lyteDropdownHidden")&&c.length>0)return}for(var d=0;d<s.length;d++){var h=s[d];if("string"==typeof s[d]?r=e.key:"number"==typeof s[d]&&(r=e.keyCode),r===h)return this.handleAddNewTag(i,"keyDown",e),void e.preventDefault()}for(d=0;d<n.length;d++){var g=n[d];if("string"==typeof n[d]?r=e.key:"number"==typeof n[d]&&(r=e.keyCode),r===g)return void e.preventDefault()}}}},methods:{
//!!Check the below three function
dropdownScrollClose:function(){if(this.data.paletteOpen)try{this.bodyDrop.querySelector("crux-color-palette").closePalette()}catch(t){return}},colorPaletteHide:function(t,e){this.getMethods("onColorTagPaletteHide")&&this.executeMethod("onColorTagPaletteHide",t,e)},onBeforeHide:function(t){return!(this.data.paletteOpen&&!this.setFromExternalDeveloper)&&((!t||!t.target.classList.contains("cxPaletteCircle")&&!t.target.classList.contains("cxPalettePopoverContent"))&&void(this.data.cxPropColorTags&&this.bodyDrop.querySelector("crux-color-palette").closePalette()))},onBlur:function(t){if(this.setData("onFocus",!1),this.data.tagAnimationArr.length&&Lyte.arrayUtils(this.data.tagAnimationArr,"replaceAt",this.data.tagAnimationArr.length-1,{doAnimation:!1,highlightTag:!1}),this.preventBlurFromDrop)this.preventBlurFromDrop=!1;else if(!this.preventBlurOnError&&!(this.getData("cxPropAllowDropdown")||this.data.cxPropColorTags&&this.data.newTag)){if(this.getData("cxPropInputValue").length>this.getData("cxPropMaxTagLength"))return this.preventBlurOnError=!0,this.getMethods("onError")&&this.executeMethod("onError",this.getData("cxPropInputValue"),{errorCode:5,reason:"Max length of the tag has been reached"},this.$node.querySelector("lyte-dropdown"),this.$node.querySelector("lyte-dropdown lyte-drop-box"),this.$node.querySelector("lyte-input"),this.$node),this.preventBlurOnError=!1,void t.preventDefault();var e=this.getData("cxPropInputValue");this.handleAddNewTag(e,"Blur")}},beforeAddToList:function(t,e,o,a,r){return this.valuesToRemove=[],(!this.data.paletteOpen||"newTagId"!=r.id)&&(this.data.cxPropColorTags&&this.bodyDrop.querySelector("crux-color-palette").closePalette(),this.setData("onFocus",!0),this.preventOnAdd?(this.preventOnAdd=!1,!1):this.handleAddNewTag(e,"DropDown"))},addToList:function(t,e,o,a,r){for(var i=JSON.parse(o),n=i.length,s=this.valuesToRemove,l=s.length,p=0;p<n;p++)if(""!=i[p]){if(l>0)for(var c=0;c<l;c++)if(i[p]!=s[c]);else{d=!0;p==i.length-1&&(d=!1),Lyte.arrayUtils(i,"removeAt",p,1),n=i.length,d&&p--}}else{var d=!0;p==i.length-1&&(d=!1),Lyte.arrayUtils(i,"removeAt",p,1),n=i.length,d&&p--}this.setData("selectedList",i),this.valuesToRemove=[],this.bodyDrop.querySelectorAll("#tagItem.lyteDropdownActive").length==this.getData("cxPropTagOptions").length?this.setData("noValue",!0):this.setData("noValue",!1),this.bodyDrop.querySelector("#newTagId").classList.remove("lyteDropdownActive")},beforeRemoveFromList:function(t,e,o,a,r,i){this.setData("onFocus",!0);this.onTagRemovalHighlight;return this.removeLatestTag(e,r)},removeFromList:function(t,e,o,a,r,i){if(this.processSearch({},this.getData("cxPropInputValue")),this.checkListCount(),this.data.paletteOpen)try{this.bodyDrop.querySelector("crux-color-palette").alignColorPalette()}catch(t){return}},onBeforeOpenDropBox:function(t,e){if(this.bodyDrop=this.$node.querySelector("lyte-dropdown").component.childComp,!(this.getData("cxPropAllowDropdown")||this.data.cxPropColorTags&&this.data.newTag))return!1},onOpenDropBox:function(t){if(this.data.cxPropColorTags&&"noFill"==this.bodyDrop.querySelector("crux-color-palette").cxProp("selectedColor")&&this.bodyDrop.querySelector("crux-color-palette").cxProp("selectedColor",this.bodyDrop.querySelector("crux-color-palette").cxProp("defaultColors")[Math.floor(13*Math.random())]),this.checkIfSelectedIsToBeSet(!0),this.getMethods("onOpen"))return this.executeMethod("onOpen",t,this.$node)},hideDropBox:function(){if(this.getMethods("onClose"))return this.executeMethod("onClose",event,this.$node)}}}),Lyte.Component.register("crux-color-palette",{_template:'<template tag-name="crux-color-palette"> <span class="cxPaletteOuter" data-zcqa="colorPaletteOpen" onclick="{{action(\'openPalette\',this)}}"> <span class="cxPaletteCircle {{concat(\'cx\',cruxReplace(cxPropSelectedColor,\'#\',\'\'))}}" id="cxPaletteOpener_{{cxPropId}}" style="{{if(ifEquals(cxPropSelectedColor,\'noFill\'),\'border:1px solid black;\',concat(\'background-color : \',cxPropSelectedColor))}};"></span> <span class="cxPaletteDropArrow"></span> </span> <lyte-popover lt-prop-placement="bottom top" lt-prop-freeze="false" lt-prop-scrollable="true" lt-prop-content-padding="12px" lt-prop-auto-align="{{cxPropAutoAlignPopover}}" lt-prop-show-close-button="false" lt-prop-show="{{lbind(cxPropShow)}}" lt-prop-max-width="220px" lt-prop-wrapper-class="cxPaletteWrapper" on-before-close="{{method(\'popoverBeforeClose\')}}" on-close="{{method(\'popoverClose\')}}" lt-prop-origin-elem="#cxPaletteOpener_{{cxPropId}}"> <template is="registerYield" yield-name="popover"> <lyte-popover-content class="cxPalettePopoverContent"> <template is="if" value="{{cxPropNoFill}}"><template case="true"> <span class="cxPaletteCircle cxnoFill {{if(expHandlers(\'noFill\',\'==\',cxPropSelectedColor),\'cxPaletteSelected\',\'\')}}" data-zcqa="noFillColor" onclick="{{action(\'selectedColor\',\'noFill\')}}" style="border:1px solid black;"></span> </template></template> <template is="for" items="{{cxPropDefaultColors}}" item="item" index="index"> <span class="cxPaletteCircle {{if(expHandlers(item,\'==\',cxPropSelectedColor),\'cxPaletteSelected\',\'\')}} {{concat(\'cx\',cruxReplace(item,\'#\',\'\'))}}" data-zcqa="color{{cruxReplace(item,\'#\',\'\')}}" onclick="{{action(\'selectedColor\',item)}}" style="background-color : {{item}};"></span> </template> <template is="if" value="{{cxPropAdvancedColorButton}}"><template case="true"> <span class="cxPaletteCircle" onclick="{{action(\'showAdvancedColor\')}}" style="border:1px solid black;"></span> </template></template> </lyte-popover-content> </template> </lyte-popover> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["''",{type:"helper",value:{name:"if",args:[{type:"helper",value:{name:"ifEquals",args:["cxPropSelectedColor","'noFill'"]}},"'border:1px solid black;'",{type:"helper",value:{name:"concat",args:["'background-color : '","cxPropSelectedColor"]}}]}},"';'"]}}}},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"attr",position:[1,3]},{type:"for",position:[1,3],dynamicNodes:[{type:"attr",position:[1],attr:{style:{name:"style",helperInfo:{name:"concat",args:["'background-color : '","item","';'"]}}}}]},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}],_observedAttributes:["cxPropNoFill","cxPropDefaultColors","colorObject","cxPropAdvancedColorButton","cxPropSelectedColor","cxPaletteOpen","cxPropAutoAlignPopover"],data:function(){return{cxPropNoFill:Lyte.attr("boolean",{default:!0}),cxPropDefaultColors:Lyte.attr("array",{default:["#F17574","#F48435","#E7A826","#A8C026","#63C57E","#1DB9B4","#57B1FD","#879BFC","#D297EE","#FD87BD","#969696","#658BA8","#B88562"]}),colorObject:Lyte.attr("object",{default:{Col1:"#F17574",Col2:"#F48435",Col3:"#E7A826",Col4:"#A8C026",Col5:"#63C57E",Col6:"#1DB9B4",Col7:"#57B1FD",Col8:"#879BFC",Col9:"#D297EE",Col10:"#FD87BD",Col11:"#969696",Col12:"#658BA8",Col13:"#B88562"}}),cxPropAdvancedColorButton:Lyte.attr("boolean",{default:!1}),cxPropSelectedColor:Lyte.attr("string",{default:"noFill"}),cxPaletteOpen:Lyte.attr("boolean",{default:!1}),cxPropAutoAlignPopover:Lyte.attr("boolean",{default:!1})}},init:function(){this.$node.closePalette=function(){this.component.setData("cxPaletteOpen",!1);var t=this.querySelector("lyte-popover");t.ltProp("duration",void 0),t.ltProp("show",!1),t.ltProp("duration",400)},this.$node.alignColorPalette=function(){this.querySelector("lyte-popover").alignPopover()}},actions:{selectedColor:function(t){this.getMethods("onSelectColor")&&this.executeMethod("onSelectColor",t),this.setData("cxPropSelectedColor",t);var e=!0;this.getMethods("onBeforeColorPaletteHide")&&(e=0!=(e=this.executeMethod("onBeforeColorPaletteHide",this.data.cxPropId))),e&&this.$node.querySelector("lyte-popover").ltProp("show",!1)},openPalette:function(t){this.data.cxPaletteOpen&&setTimeout(function(){this.$node.querySelector("lyte-popover").ltProp("show",!1)}.bind(this),10);var e=!0;this.getMethods("onBeforeColorPalleteOpen")&&(e=this.executeMethod("onBeforeColorPalleteOpen",this.data.cxPropId)),e&&(this.$node.querySelector("lyte-popover").ltProp("show",!0),t.classList.add("cxPalleteOpened"),this.setData("cxPaletteOpen",!0),this.getMethods("onColorPaletteOpen")&&this.executeMethod("onColorPaletteOpen",this.data.cxPropId))}},methods:{popoverClose:function(t){var e=this.$node.querySelector(".cxPalleteOpened");e&&e.classList.remove("cxPalleteOpened"),this.setData("cxPaletteOpen",!1),this.getMethods("onColorPaletteHide")&&this.executeMethod("onColorPaletteHide",this.data.cxPropId,t)},popoverBeforeClose:function(t){if(this.getMethods("onBeforeColorPaletteHide"))return this.executeMethod("onBeforeColorPaletteHide",this.data.cxPropId,t)}}});
