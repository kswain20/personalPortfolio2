Lyte.Component.register("crm-related-list-actions",{_template:'<template tag-name="crm-related-list-actions"> <template is="if" value="{{expHandlers(relatedList.module.api_name,\'==\',&quot;Attachments&quot;)}}"><template case="true"> <template is="if" value="{{expHandlers(options,\'==\',\'left_pannel\')}}"><template case="true"> <a href="javascript:void(0);" class="attachmentsLeftPanelAddition addNewIcP" data-zcqa="newleft__Add_Attachments" id="addNewIcP_Attachments"></a> </template><template case="false"> <a href="javascript:void(0);" class="atch-dropdown lyte-attach-menu pR pR5" data-zcqa="Detail_Add_Attachemnt"><span></span>{{getI18n(\'crm.attach.option.label\')}}</a> </template></template> <lyte-menu on-before-open="{{method(\'menuOnBeforeOpen\')}}" lt-prop-yield="true" lt-prop-query="{{if(expHandlers(options,\'===\',\'left_pannel\'),\'a.attachmentsLeftPanelAddition\',\'a.atch-dropdown.lyte-attach-menu\')}}" lt-prop-freeze="false" on-open="{{method(\'addSelectionMarker\')}}" on-close="{{method(\'removeSelectionMarker\')}}"> <template is="registerYield" yield-name="yield"> <crm-attachments module="{{module}}" related-list="{{relatedList}}" record="{{record}}"></crm-attachments> </template> </lyte-menu> </template><template case="false"> <template is="for" items="{{actions}}" item="item" index="index"> <span class="relatedListActionClick" onclick="{{action(\'executeRelatedListActions\',item[\'data-cid\'])}}" data-relid="{{relatedList.id}}">{{item.label}}</span> </template></template></template> </template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[]},false:{dynamicNodes:[{type:"text",position:[1,1]}]}},default:{}},{type:"attr",position:[3]},{type:"registerYield",position:[3,1],dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[3]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"for",position:[1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]}]}},default:{}}],_observedAttributes:["actions","options"],data:function(){return{actions:Lyte.attr("array"),options:Lyte.attr("string",{default:void 0})}},init:function(){this.setData("actions",this.getData("relatedList").actions)},actions:{executeRelatedListActions:function(e){this.executeRelatedListActions(e,this.getData("relatedList"),this.getData("module"),this.getData("record"),event)}},methods:{addSelectionMarker:function(){"left_pannel"===this.getData("options")&&$("#newleft_"+this.getData("relatedList").id).addClass("leftnavEnable")},removeSelectionMarker:function(){"left_pannel"===this.getData("options")&&$("#newleft_"+this.getData("relatedList").id).removeClass("leftnavEnable")},menuOnBeforeOpen:function(e){var t=this;$L.fastdom.measure((function(){var a="left_pannel"==t.data.options?$L("#detailViewButtonLayerDiv"):$L("#DetailViewInnerTabs"),i=$L("#wmstoolbar"),o={top:0,bottom:0};a.length&&(o.top=a[0].getBoundingClientRect().bottom),i.length&&(o.bottom=i[0].getBoundingClientRect().top),$L.fastdom.mutate((function(){e.ltProp("boundary",o)}))}))}}},{mixins:["crm-detail-view-utils"]}),Lyte.Component.register("crm-related-list-view-header",{_template:'<template tag-name="crm-related-list-view-header"> <lyte-event-listener event-name="relatedList" on-fire="{{action(\'handleRefresh\')}}"> <div class="rl_Header"> <div class="relListHeader"> <template is="if" value="{{expHandlers(relatedList.type,\'!=\',\'default\')}}"><template case="true"> <template is="if" value="{{editCustomRelList}}"><template case="true"> <span class="labelValTwo oI mB10 pR"> <crux-text-component cx-prop-from="create" id="customRel" cx-prop-value="{{relatedList.display_label}}"></crux-text-component> <span class="mL10"> <span class="saveLink f13" onclick="{{action(\'saveCustomRL\')}}">{{getI18n(\'crm.button.save\')}}</span> <span class="smalledit mL10 lightgreyText" onclick="{{action(\'cancelCustomRL\')}}">{{getI18n(\'crm.button.cancel\')}}</span> </span> </span> </template><template case="false"> <span name="{{relatedList.display_label}}_{{relatedList.id}}" id="{{relatedList.display_label}}_{{relatedList.id}}" class="relListHead pR">{{relatedList.display_label}} <span class="ico-edit-blue svgIcons vh cP mL10 pR dIB rl_editicon" onclick="{{action(\'editCustomRL\')}}"></span> </span> </template></template> </template><template case="false"> <span name="{{relatedList.display_label}}_{{relatedList.id}}" id="{{relatedList.display_label}}_{{relatedList.id}}" class="relListHead">{{relatedList.display_label}}</span> <template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(module,\'===\',\'Tasks\'),\'||\',expHandlers(module,\'===\',\'Events\')),\'&amp;&amp;\',expHandlers(relatedList.api_name,\'===\',\'Attachments\')),\'&amp;&amp;\',expHandlers(relatedListCount,\'!==\',undefined))}}"><template case="true"> <span class="relListHead">({{relatedListCount}})</span> </template></template> </template></template><template is="if" value="{{expHandlers(expHandlers(isClientAccount,\'!\'),\'&amp;&amp;\',expHandlers(expHandlers(relatedList.api_name,\'==\',\'Reporting_Contacts\'),\'||\',expHandlers(expHandlers(expHandlers(relatedList.api_name,\'==\',\'Contacts\'),\'&amp;&amp;\',expHandlers(module,\'==\',&quot;Accounts&quot;)),\'&amp;&amp;\',expHandlers(relatedList.type,\'==\',\'default\'))))}}"><template case="true"> <span id="contactTreePopup" class="dIB link vat hietimeOpen f12 {{if(showNoRecords,\'disabledArow\',\'\')}}" onclick="{{action(\'loadContactsHierarchyView\')}}">{{getI18n("crm.contact.HierarchyView")}}</span> <div id="contactTreePopupId" class="newPopup ppTop is-scroll" style="display : none;"> <h2 class="mB0 pp-header crm-font-bold">{{relatedList.display_label}} {{getI18n("crm.contact.hierarchy.view.Role_Hierarchy")}}</h2> <span class="dIB closeBtnHierar"></span> <div class="pp-content"> <div class="timelineCntn"> <span class="cmpnyLogo dIB"></span> <span class="dIB pB10" id="treeAccName"></span> <ul class="hierarcyTimeline" id="userstree"></ul> </div> </div> <div class="pp-footer"></div> </div> </template></template> </div> <div class="dIFlex rlHeaderItems"> <template is="if" value="{{expHandlers(selectedIds.length,\'>\',0)}}"><template case="true"> <div id="customBtn" class="clearFix listViewCB"> <crm-custom-button module="{{module}}" from="relatedList" btnid="relatedList" custom-buttons="{{customButtons}}"></crm-custom-button> </div> <span class="mL5"><b>{{selectedIds.length}}</b> {{getI18n(\'crm.label.selected.records\')}}</span> </template></template> </div> <div class="mlAuto dIFlex rlHeaderItems"> <template is="if" value="{{showActions}}"><template case="true"> <div class="zcanvas_rl_hide dIFlex"> <crm-related-list-actions module="{{module}}" related-list="{{relatedList}}" record="{{record}}"></crm-related-list-actions> </div> </template></template> <template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(module,\'==\',\'Leads\'),\'||\',expHandlers(module,\'==\',\'Contacts\')),\'&amp;&amp;\',expHandlers(relatedModule,\'==\',\'Campaigns\')),\'&amp;&amp;\',expHandlers(showNoRecords,\'!\'))}}"><template case="true"> <div class="dIFlex mR25 p5 {{if(campaignFilter,\'zWebSITableFilterDivOpen\',\'\')}}"> <span class="zWebSITableFilter svgIcons cP" onclick="{{action(\'showCampaignFilter\')}}"></span> </div> </template></template> <template is="if" value="{{ifContains(relatedModule,\'Visits\')}}"><template case="true"> <crm-salesiq-portals-dropdown class="pR mR15 dIB mB5" entity-id="{{record.id}}" module="{{module}}" rid="{{relatedList.id}}" selected-portal-name="{{lbind(portalName)}}" is-canvas="true"></crm-salesiq-portals-dropdown> </template></template> <template is="if" value="{{expHandlers(relatedList.customize_fields,\'&amp;&amp;\',expHandlers(showNoRecords,\'!\'))}}"><template case="true"> <div class="dIFlex w30 pR"> <span class="newRlEdit dIB" name="relatedclm" id="customizeList{{relatedList.id}}" value="relate" style="visibility: visible;" onclick="{{action(\'showColumnList\')}}"></span> </div> </template></template> <template is="switch" value="{{relatedList.api_name}}"><template case="Contact_Roles"> <input type="hidden" name="Potential_accountId" id="Potential_accountId"> <input type="hidden" id="callingAction" value="-1"> </template><template case="Attachments"> <input type="hidden" name="moduleForIFrame" id="moduleForIFrame" value="{{module}}"> <input type="hidden" name="anchorId" id="anchorId" value="{{relatedList.id}}"> <input type="hidden" name="fileCheckVariable" id="fileCheckVariable" value="RelatedList"> <input type="hidden" name="ID_ATTACHMENTSPERSONALITY" value="{{relatedList.id}}"> </template><template case="Related_List"> <div class="dIFlex" id="relPersAction_{{relatedList.id}}" style="width:70px !important;"></div> </template></template> <input type="hidden" name="ID_{{relatedList.display_label}}" value="{{relatedList.id}}"> </div> </div> <div id="{{relatedList.id}}" class="{{if(ifEquals(relatedModule,&quot;Attachments&quot;),&quot;attachmentRL&quot;,&quot;&quot;)}}"> <template is="if" value="{{showLoading}}"><template case="true"> <div class="rl_NoRec"> <div class="pR30 italic fontsmooth dvfontSnone">{{getI18n(\'crm.admin.loading\')}}</div> </div> </template><template case="false"><template is="if" value="{{inaccessible}}"><template case="true"> <div class="p30 aligncenter fontsmooth">{{unescape(getI18n(\'crm.canvas.component.permission.denied\'))}}</div> </template><template case="false"><template is="if" value="{{showNoRecords}}"><template case="true"> <div class="rl_NoRec"> <template is="if" value="{{expHandlers(relatedList.api_name,\'==\',&quot;Attachments&quot;)}}"><template case="true"> <div class="pR30 italic fontsmooth dvfontSnone">{{getI18n("crm.event.attachment.empty.msg")}}</div> </template><template case="false"> <div class="pR30 italic fontsmooth dvfontSnone">{{getI18n("crm.new.label.no.records")}}</div> </template></template> <div id="norec_{{relatedList.id}}"> </div> </div> </template><template case="false"> <template is="if" value="{{recordGet}}"><template case="true"> <crux-table-component cx-prop-header="{{customfields}}" cx-prop-label-selector="field_label" cx-prop-content="{{tableData}}" cx-prop-sort-columns="true" cx-prop-body-id="lvTred" cx-prop-column-cell-class="sortRelated mW100" cx-prop-field-type-mapping="{{fieldMapping}}" on-sort="{{action(\'showSortDropdown\')}}" cx-prop-sorted-column="{{sort_by}}" cx-prop-sorted-order="{{sort_order}}" on-mouse-over="{{action(\'showIcons\')}}" on-mouse-out="{{action(\'hideIcons\')}}" cx-prop-field-id-vs-route-mapping="{{routeMapping}}" cx-prop-field-type-mapping-selector="api_name" cx-prop-no-records-message="{{getI18n(\'crm.new.label.no.records\')}}" cx-prop-table-id="listviewtable" cx-prop-yield-for-prefix="{{if(expHandlers(prefixYields.length,\'>\',0),true,false)}}" cx-prop-prefix-yields="{{prefixYields}}" cx-prop-height="{{height}}" data-zcqa="relatedListTable" class="nohover" cx-prop-row-zcqa="detailView" cx-prop-module="{{relatedModule}}" cx-prop-add-search="false" cx-prop-enable-body-scroll="false" apply-filter="{{method(\'campaignFilter\')}}" clear-filter="{{method(\'campaignFilterClear\')}}" cx-prop-filter-component="crux-lookupfilter-component" cx-prop-show-filter="{{campaignFilter}}" cx-prop-filter-show-clear="true" set-lookup-filter-conditions="{{method(\'filterConditions\')}}"> <template is="yield" yield-name="body-lookup"> <template is="if" value="{{ifEquals(relatedModule,&quot;Attachments&quot;)}}"><template case="true"> <span id="attach_{{recordObj.id}}" class="link1 {{if(ifEquals(recordObj.extn,\'png\'),\'realtedListImageFileName\',\'\')}}" onclick="{{action(\'attachNameClick\',recordObj)}}" data-zcqa="relatedList_{{recordObj.File_Name}}_Attachments" data-lytecbox-title="{{recordObj.File_Name}}" data-lytecbox-dlink="{{recordObj.$previewUrl}}" data-lytecbox-href="{{recordObj.$previewUrl}}" data-sel-image="{{recordObj.id}}"> <span class="{{if(ifEquals(recordObj.$internal_type,\'workdrive_link\'),\'svgIcons ico-teamDrive\',concat(recordObj.extn,\'-icon\',if(ifEquals(recordObj.extn,\'link\'),\'Atc\',\'\')))}} dIB vam"></span> <span class="dIB elipse_toE mw70per vam" lt-prop-title="{{recordObj.File_Name}}" lt-prop-tooltip-class="alignleft mw50per wordBreak" lt-prop-tooltip-config="{&quot;showdelay&quot;:1000,&quot;maxdisplaytime&quot; : 100000000}">{{recordObj.File_Name}}</span> <template is="if" value="{{expHandlers(recordObj.extn,\'==\',\'mp3\')}}"><template case="true"> <span class="cP vH icon_play notPlaying dIB mL10 {{if(ifEquals(playingMp3,recordObj.id),\'icon_pause\',\'\')}}" onclick="{{action(\'playMp3\',recordObj.id)}}" lt-prop-title="{{getI18n(\'crm.button.play\')}}" lt-prop-tooltip-config="{&quot;showdelay&quot;:1000}" id="play_{{recordObj.id}}" data-zcqa="{{recordObj.id}}_playAudio"></span> <audio class="dN" id="audio_{{recordObj.id}}" src="{{recordObj.$previewUrl}}"></audio> </template></template> </span> <span class="vH rl_dropIcon vam" id="attachLinks_{{recordObj.id}}"></span> <lyte-menu on-before-open="{{method(\'menuOnBeforeOpen\')}}" on-open="{{method(\'attachLinksOpen\')}}" on-close="{{method(\'onAttachMenuClose\',recordObj.id)}}" lt-prop-wrapper-class="attachLinksMenu" lt-prop-yield="true" lt-prop-query="#attachLinks_{{recordObj.id}}" lt-prop-freeze="false" id="attachLinksMenu_{{recordObj.id}}"> <template is="registerYield" yield-name="yield"> <lyte-menu-body id="callMoreOption" class="callMoreOptionLyteNew cscript-attachment-menubody" data-zcqa="callMoreOption"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(expHandlers(recordObj.extn,\'==\',\'link\'),\'||\',expHandlers(recordObj.extn,\'==\',\'png\')),\'||\',recordObj.$previewUrl),\'&amp;&amp;\',expHandlers(recordObj.extn,\'!=\',\'mp3\')),\'&amp;&amp;\',expHandlers(recordObj.extn,\'!=\',\'movie\')),\'&amp;&amp;\',expHandlers(recordObj.extn,\'!=\',\'file\')),\'&amp;&amp;\',expHandlers(recordObj.extn,\'!=\',\'zip\'))}}"><template case="true"> <lyte-menu-item id="viewAttach_{{recordObj.id}}" onclick="{{action(\'attachLinkClick\',\'viewAttach\',recordObj)}}" data-zcqa="lnk_view_Attachments" class="crm-font-regular {{if(ifEquals(recordObj.extn,\'png\'),\'realtedListImage\',\'\')}}" data-lytecbox-title="{{recordObj.File_Name}}" data-lytecbox-dlink="{{recordObj.$previewUrl}}" data-lytecbox-href="{{recordObj.$previewUrl}}" data-sel-image="{{recordObj.id}}">{{getI18n(\'View\')}}</lyte-menu-item> </template></template> <template is="if" value="{{expHandlers(expHandlers(recordObj.extn,\'==\',\'link\'),\'&amp;&amp;\',expHandlers(recordObj.$internal_type,\'!=\',\'workdrive_link\'))}}"><template case="true"> <lyte-menu-item id="editAttach" onclick="{{action(\'attachLinkClick\',\'editLinkAttach\',recordObj)}}" data-zcqa="lnk_edit_Attachments" class="crm-font-regular">{{getI18n(\'Edit\')}}</lyte-menu-item> </template></template> <template is="if" value="{{expHandlers(recordObj.extn,\'!=\',\'link\')}}"><template case="true"> <lyte-menu-item id="downloadAttach" onclick="{{action(\'attachLinkClick\',\'downloadAttach\',recordObj)}}" data-zcqa="lnk_download_Attachments" class="crm-font-regular">{{getI18n(\'crm.view.attachment.download\')}}</lyte-menu-item> </template></template> <lyte-menu-item id="deleteAttach" onclick="{{action(\'attachLinkClick\',\'deleteAttach\',recordObj)}}" data-zcqa="lnk_delete_Attachments" class="crm-font-regular crm-rl-write-action">{{getI18n(\'Delete\')}}</lyte-menu-item> </lyte-menu-body> </template> </lyte-menu> </template><template case="false"><template is="if" value="{{ifEquals(relatedList.api_name,&quot;Invited_Events&quot;)}}"><template case="true"> <crux-lookup-component cx-prop-transition-data="{&quot;cvid&quot; : &quot;{{moduleInfo.cvid}}&quot;, &quot;fromActivityListView&quot; : true, &quot;recordNum&quot;: &quot;{{recordObj.recnum}}&quot;}" cx-prop-value="{{recordObj[fieldObj.api_name]}}" cx-prop-route-name="crm.tab.module.entity.detail" cx-prop-dynamic-params="[&quot;{{relatedModule}}&quot;, &quot;{{recordObj.id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" cx-prop-query-params="{{if(ifEquals(relatedModule,\'Activities\'),concat(\'{&quot;sub_module&quot;:&quot;\',recordObj.Activity_Type,\'&quot;}\'))}}" cx-prop-zcqa="{{recordObj[fieldObj.api_name]}}" cx-prop-id="listView_{{recordObj.id}}"></crux-lookup-component> {{unescape(getColorCodeForEvents("true",recordObj))}} <span class="rl_dropIcon vH" id="attachLinks_{{recordObj.id}}"></span> <lyte-menu on-before-open="{{method(\'menuOnBeforeOpen\')}}" on-open="{{method(\'attachLinksOpen\')}}" on-close="{{method(\'onAttachMenuClose\',recordObj.id)}}" lt-prop-wrapper-class="attachLinksMenu" lt-prop-yield="true" lt-prop-query="#attachLinks_{{recordObj.id}}" lt-prop-freeze="false" id="attachLinksMenu_{{recordObj.id}}"> <template is="registerYield" yield-name="yield"> <lyte-menu-body id="callMoreOption" class="callMoreOptionLyteNew" data-zcqa="callMoreOption"> <lyte-menu-item id="editEvent" onclick="{{action(\'invitedEventsDrop\',\'edit\',recordObj)}}" data-zcqa="relatedListEdit_Events" class="crm-font-regular">{{getI18n(\'Edit\')}}</lyte-menu-item> <lyte-menu-item id="deleteEvent" onclick="{{action(\'invitedEventsDrop\',\'delete\',recordObj)}}" data-zcqa="lnk_delete_Events" class="crm-font-regular">{{getI18n(\'Delete\')}}</lyte-menu-item> <lyte-menu-item id="disassociateEvent" onclick="{{action(\'invitedEventsDrop\',\'disassociate\',recordObj)}}" data-zcqa="lnk_remove_entity" class="crm-font-regular">{{getI18n(\'crm.label.event.remove.participant\',getValue(record,displayField[module][0]))}}</lyte-menu-item> </lyte-menu-body> </template> </lyte-menu> </template><template case="false"><template is="if" value="{{expHandlers(moduleInfo.module_name,\'&amp;&amp;\',contains(displayField[moduleInfo.module_name],fieldObj.api_name))}}"><template case="true"><template is="if" value="{{expHandlers(relatedModule,\'!=\',&quot;Activities&quot;)}}"><template case="true"><template is="if" value="{{isVisitorOnline(moduleInfo.module_name,record.id)}}"><template case="true"> <span id="online-entity-{{recordObj.id}}-lview&quot;+&quot;" class="online-entity vat"></span> </template></template> <crux-lookup-component cx-prop-value="{{recordObj[fieldObj.api_name]}}" cx-prop-route-name="crm.tab.module.entity.detail" cx-prop-dynamic-params="[&quot;{{relatedModule}}&quot;, &quot;{{recordObj.id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" cx-prop-query-params="{{if(ifEquals(relatedModule,\'Activities\'),concat(\'{&quot;sub_module&quot;:&quot;\',recordObj.Activity_Type,\'&quot;}\'))}}" cx-prop-zcqa="{{recordObj[fieldObj.api_name]}}" cx-prop-id="listView_{{recordObj.id}}"></crux-lookup-component> </template><template case="false"> <crux-lookup-component cx-prop-value="{{recordObj[fieldObj.api_name]}}" cx-prop-route-name="crm.tab.module.entity.detail" cx-prop-dynamic-params="[&quot;{{relatedModule}}&quot;, &quot;{{recordObj.id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" cx-prop-query-params="{{if(ifEquals(relatedModule,\'Activities\'),concat(\'{&quot;sub_module&quot;:&quot;\',recordObj.Activity_Type,\'&quot;}\'))}}" cx-prop-zcqa="{{recordObj[fieldObj.api_name]}}" cx-prop-id="listView_{{recordObj.id}}"></crux-lookup-component> </template></template> </template><template case="false"><template is="if" value="{{expHandlers(fieldObj.lookup.module.api_name,\'==\',&quot;se_module&quot;)}}"><template case="true"> <crux-lookup-component cx-prop-value="{{recordObj[fieldObj.api_name].name}}" cx-prop-route-name="crm.tab.module.entity.detail" cx-prop-dynamic-params="[&quot;{{if(ifEquals(getModuleNameByApiName(recordObj.$se_module),&quot;Deals&quot;),&quot;Potentials&quot;,getModuleNameByApiName(recordObj.$se_module))}}&quot;, &quot;{{recordObj[fieldObj.api_name].id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" cx-prop-icon-class="{{concat(getModuleNameForIcon(recordObj.$se_module),\'Small\')}}" onmouseover="{{action(\'showHideRelatedFields\',recordObj,fieldObj)}}" onmouseout="{{action(\'showHideRelatedFields\')}}" cx-prop-zcqa="{{recordObj[fieldObj.api_name].name}}"></crux-lookup-component> </template><template case="false"><template is="if" value="{{expHandlers(fieldObj.column_name,\'==\',&quot;CONTACTID&quot;)}}"><template case="true"> <crux-lookup-component cx-prop-value="{{recordObj[fieldObj.api_name].name}}" cx-prop-route-name="crm.tab.module.entity.detail" cx-prop-dynamic-params="[&quot;Contacts&quot;, &quot;{{recordObj[fieldObj.api_name].id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" onmouseover="{{action(\'showHideRelatedFields\',recordObj,fieldObj)}}" onmouseout="{{action(\'showHideRelatedFields\')}}" cx-prop-zcqa="{{recordObj[fieldObj.api_name].name}}"></crux-lookup-component> </template><template case="false"><template is="if" value="{{recordObj[fieldObj.api_name].id}}"><template case="true"> <crux-lookup-component cx-prop-value="{{recordObj[fieldObj.api_name].name}}" cx-prop-route-name="crm.tab.module.entity.detail" cx-prop-dynamic-params="[&quot;{{getModuleNameByApiName(fieldObj.lookup.module.api_name)}}&quot;, &quot;{{recordObj[fieldObj.api_name].id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" cx-prop-icon-class="{{if(ifEquals(fieldObj.api_name,\'What_Id\'),concat(getModuleNameForIcon(recordObj.$se_module),\'Small\'))}}" onmouseover="{{action(\'showHideRelatedFields\',recordObj,fieldObj)}}" onmouseout="{{action(\'showHideRelatedFields\')}}" cx-prop-zcqa="{{recordObj[fieldObj.api_name].name}}"></crux-lookup-component> </template><template case="false"><template is="if" value="{{ifEquals(relatedList.api_name,&quot;Competitors&quot;)}}"><template case="true"> <span class="link" onclick="{{action(\'showCompetitorPopup\',recordObj)}}">{{recordObj.Competitor_Name}}</span> </template><template case="false"><template is="if" value="{{expHandlers(relatedList.api_name,\'==\',\'Stage_History\')}}"><template case="true"> <span class="stageHistory vat">{{recordObj.stage}}</span> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(relatedList.type,\'==\',\'multiselectlookup\'),\'&amp;&amp;\',expHandlers(fieldObj.api_name,\'==\',\'Name\'))}}"><template case="true"> <crux-lookup-component cx-prop-value="{{recordObj[fieldObj.api_name]}}" cx-prop-route-name="crm.tab.module.entity.detail" cx-prop-dynamic-params="[&quot;{{relatedList.linkingmodule}}&quot;, &quot;{{recordObj.id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" cx-prop-zcqa="{{recordObj[fieldObj.api_name]}}" cx-prop-id="listView_{{recordObj.id}}"></crux-lookup-component> </template></template></template></template></template></template></template></template></template></template></template></template></template></template></template></template></template></template> <template is="if" value="{{expHandlers(ifEquals(relatedModule,&quot;Activities&quot;),\'&amp;&amp;\',recordObj.$in_project_sync)}}"><template case="true"> <i style="margin-bottom: 2px;" class="task_syncIcon vam mL2" lt-prop-title="{{concat(getI18n(&quot;crm.schedules.prefix.in&quot;),getI18n(&quot;crm.integ.sync.message&quot;,&quot;crm.project.integration.title&quot;))}}" lt-prop-tooltip-config="{&quot;position&quot;:&quot;followcursor&quot;, &quot;appearance&quot; : &quot;box&quot;}"></i> </template></template> <template is="if" value="{{expHandlers(ifEquals(relatedModule,&quot;Activities&quot;),\'||\',ifEquals(relatedModule,&quot;Events&quot;))}}"><template case="true"> {{unescape(getColorCodeForEvents("true",recordObj))}} </template></template> </template> <template is="yield" yield-name="body-member-status"> {{recordObj.$member_info.Member_Status}} </template> <template is="yield" yield-name="body-participant-status"> {{unescape(getInvitedEventStatus(recordObj,record))}} </template> <template is="yield" yield-name="body-list-price"> <template is="if" value="{{expHandlers(cruxContains(toString(recordObj.list_price),\'.\'),\'>\',0)}}"><template case="true"> {{recordObj.list_price}} </template><template case="false"> {{fixedDecimal(recordObj.list_price,1)}} </template></template> </template> <template is="yield" yield-name="body-event-date"> {{getInvitedEventDate(recordObj)}} </template> <template is="yield" yield-name="body-terriority"> {{getTerritorityValue(getMultiSelectRecord(recordObj,fieldObj.api_name,relatedList))}} </template> <template is="yield" yield-name="body-contact-role"> {{getContactRole(recordObj.Contact_Role,roleValues)}} </template> <template is="yield" yield-name="body-multiselect-lookup"> <template is="if" value="{{expHandlers(moduleInfo.module_name,\'&amp;&amp;\',showLookup(fieldObj.api_name,displayField[moduleInfo.module_name],relatedList))}}"><template case="true"><template is="if" value="{{expHandlers(relatedModule,\'!=\',&quot;Activities&quot;)}}"><template case="true"><template is="if" value="{{isVisitorOnline(moduleInfo.module_name,record.id)}}"><template case="true"> <span id="online-entity-{{recordObj.id}}-lview&quot;+&quot;" class="online-entity vat"></span> </template></template> <crux-lookup-component cx-prop-value="{{getMultiSelectRecord(recordObj,fieldObj.api_name,relatedList)}}" cx-prop-route-name="crm.tab.module.entity.detail" cx-prop-dynamic-params="[&quot;{{relatedModule}}&quot;, &quot;{{getMultiSelectRecord(recordObj,&quot;id&quot;,relatedList)}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" cx-prop-query-params="{{if(ifEquals(relatedModule,\'Activities\'),concat(\'{&quot;sub_module&quot;:&quot;\',recordObj.Activity_Type,\'&quot;}\'))}}" cx-prop-zcqa="{{recordObj[fieldObj.api_name]}}" cx-prop-id="listView_{{if(recordObj.connectedRecord,recordObj.connectedRecord.id,recordObj.id)}}"></crux-lookup-component> </template><template case="false"> <crux-lookup-component cx-prop-value="{{getMultiSelectRecord(recordObj,fieldObj.api_name,relatedList)}}" cx-prop-route-name="crm.tab.module.entity.detail" cx-prop-dynamic-params="[&quot;{{relatedModule}}&quot;, &quot;{{getMultiSelectRecord(recordObj,&quot;id&quot;,relatedList)}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" cx-prop-query-params="{{if(ifEquals(relatedModule,\'Activities\'),concat(\'{&quot;sub_module&quot;:&quot;\',recordObj.Activity_Type,\'&quot;}\'))}}" cx-prop-zcqa="{{recordObj[fieldObj.api_name]}}" cx-prop-id="listView_{{recordObj.id}}"></crux-lookup-component> </template></template> </template><template case="false"><template is="if" value="{{expHandlers(fieldObj.column_name,\'==\',&quot;SEID&quot;)}}"><template case="true"> <crux-lookup-component cx-prop-value="{{getValue(getMultiSelectRecord(recordObj,fieldObj.api_name,relatedList),\'name\')}}" cx-prop-route-name="crm.tab.module.entity.detail" cx-prop-dynamic-params="[&quot;{{if(ifEquals({{getMultiSelectRecord(recordObj,&quot;$se_module&quot;,relatedList)}}, &quot;Deals&quot;),&quot;Potentials&quot;,getMultiSelectRecord(recordObj,&quot;$se_module&quot;,relatedList)}})}}&quot;, &quot;{{recordObj[fieldObj.api_name].id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" cx-prop-icon-class="{{concat(getModuleNameForIcon(recordObj.$se_module),\'Small\')}}" onmouseover="{{action(\'showHideRelatedFields\',recordObj,fieldObj)}}" onmouseout="{{action(\'showHideRelatedFields\')}}" cx-prop-zcqa="{{recordObj[fieldObj.api_name].name}}"></crux-lookup-component> </template><template case="false"><template is="if" value="{{expHandlers(fieldObj.column_name,\'==\',&quot;CONTACTID&quot;)}}"><template case="true"> <crux-lookup-component cx-prop-value="{{getValue(getMultiSelectRecord(recordObj,fieldObj.api_name,relatedList),\'name\')}}" cx-prop-route-name="crm.tab.module.entity.detail" cx-prop-dynamic-params="[&quot;Contacts&quot;, &quot;{{getValue(getMultiSelectRecord(recordObj,fieldObj.api_name,relatedList),&quot;id&quot;)}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" onmouseover="{{action(\'showHideRelatedFields\',recordObj,fieldObj)}}" onmouseout="{{action(\'showHideRelatedFields\')}}" cx-prop-zcqa="{{recordObj[fieldObj.api_name].name}}"></crux-lookup-component> </template><template case="false"><template is="if" value="{{getValue(getMultiSelectRecord(recordObj,fieldObj.api_name,relatedList),\'id\')}}"><template case="true"> <crux-lookup-component cx-prop-value="{{getValue(getMultiSelectRecord(recordObj,fieldObj.api_name,relatedList),\'name\')}}" cx-prop-route-name="crm.tab.module.entity.detail" cx-prop-dynamic-params="[&quot;{{fieldObj.lookup.module.api_name}}&quot;, &quot;{{getValue(getMultiSelectRecord(recordObj,fieldObj.api_name,relatedList),&quot;id&quot;)}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" cx-prop-icon-class="{{if(ifEquals(fieldObj.api_name,\'What_Id\'),concat(getModuleNameForIcon(recordObj.$se_module),\'Small\'))}}" onmouseover="{{action(\'showHideRelatedFields\',recordObj,fieldObj)}}" onmouseout="{{action(\'showHideRelatedFields\')}}" cx-prop-zcqa="{{recordObj[fieldObj.api_name].name}}"></crux-lookup-component> </template></template></template></template></template></template></template></template> </template> <template is="yield" yield-name="body-picklist"> <crux-picklist-component cx-prop-from="view" cx-prop-value="{{recordObj[fieldObj.api_name]}}" cx-prop-field="{{fieldObj}}" cx-prop-is-color-code-enabled="false"> </crux-picklist-component> </template> <template is="yield" yield-name="body-multiselect"> <template is="if" value="{{expHandlers(expHandlers(getMultiSelectRecord(recordObj,fieldObj.api_name,relatedList),\'||\',expHandlers(fieldObj.cxTypeMapping,\'==\',&quot;number&quot;)),\'||\',expHandlers(expHandlers(fieldObj.cxTypeMapping,\'==\',&quot;text&quot;),\'&amp;&amp;\',expHandlers(getMultiSelectRecord(recordObj,fieldObj.api_name,relatedList),\'==\',false)))}}"><template case="true"><template is="if" value="{{expHandlers(expHandlers(expHandlers(fieldObj.cxTypeMapping,\'==\',&quot;text&quot;),\'||\',expHandlers(fieldObj.cxTypeMapping,\'==\',&quot;multi-picklist&quot;)),\'||\',expHandlers(fieldObj.cxTypeMapping,\'==\',&quot;picklist&quot;))}}"><template case="true"> {{getMultiSelectRecord(recordObj,fieldObj.api_name,relatedList)}} </template><template case="false"><template is="if" value="{{expHandlers(fieldObj.cxTypeMapping,\'==\',&quot;phone&quot;)}}"><template case="true"> <crux-phone-component cx-prop-value="{{getMultiSelectRecord(recordObj,fieldObj.api_name,relatedList)}}" cx-prop-field="{{fieldObj}}" cx-prop-call-allowed="{{if(getMultiSelectRecord(recordObj,\'Data_Processing_Basis_Details\',relatedList),getMultiSelectRecord(recordObj,\'Data_Processing_Basis_Details\',relatedList),true)}}" cx-prop-entity-id="{{recordObj.id}}" cx-prop-module="{{relatedModule}}"></crux-phone-component> </template><template case="false"><template is="if" value="{{expHandlers(expHandlers(fieldObj.cxTypeMapping,\'==\',&quot;number&quot;),\'||\',expHandlers(fieldObj.cxTypeMapping,\'==\',&quot;picklist&quot;))}}"><template case="true"> <template is="component" component-name="crux-{{fieldObj.cxTypeMapping}}-component" cx-prop-value="{{getMultiSelectRecord(recordObj,fieldObj.api_name,relatedList)}}" cx-prop-field="{{fieldObj}}" cx-prop-iso-code="{{getMultiSelectRecord(recordObj,\'Currency\',relatedList)}}" cx-prop-exchange-rate="{{if(getMultiSelectRecord(recordObj,\'ExchangeRate\',relatedList),getMultiSelectRecord(recordObj,\'ExchangeRate\',relatedList),getMultiSelectRecord(recordObj,\'Exchange_Rate\',relatedList))}}"></template> </template><template case="false"><template is="if" value="{{expHandlers(fieldObj.cxTypeMapping,\'==\',&quot;allday&quot;)}}"><template case="true"> <template is="if" value="{{recordObj.All_day}}"><template case="true"> <crux-date-component cx-prop-value="{{getMultiSelectRecord(recordObj,fieldObj.api_name,relatedList)}}"></crux-date-component> </template><template case="false"> <crux-date-time-component cx-prop-value="{{getMultiSelectRecord(recordObj,fieldObj.api_name,relatedList)}}"></crux-date-time-component> </template></template> </template><template case="false"> <template is="component" component-name="crux-{{fieldObj.cxTypeMapping}}-component" cx-prop-value="{{getMultiSelectRecord(recordObj,fieldObj.api_name,relatedList)}}" data-zcqa="{{if(ifEquals(cxTypeMapping,\'lookup\'),cxPropRowZcqa)}}"></template> </template></template></template></template></template></template></template></template></template></template> </template> <template is="yield" yield-name="body-multi_module_lookup"> <crux-lookup-component cx-prop-value="{{recordObj[fieldObj.api_name].name}}" cx-prop-route-name="crm.tab.module.entity.detail" cx-prop-dynamic-params="[&quot;{{recordObj[fieldObj.api_name].module.api_name}}&quot;, &quot;{{recordObj[fieldObj.api_name].id}}&quot;]" onclick="{{action(\'stopPropagation\',event)}}" cx-prop-icon-class="{{if(ifEquals(fieldObj.api_name,\'What_Id\'),concat(getModuleNameForIcon(recordObj.$se_module),\'Small\'))}}" onmouseover="{{action(\'showHideRelatedFields\',recordObj,fieldObj)}}" onmouseout="{{action(\'showHideRelatedFields\')}}" cx-prop-zcqa="{{recordObj[fieldObj.api_name].name}}"></crux-lookup-component> </template> <template is="yield" yield-name="body-prefix-1"> <template is="if" value="{{expHandlers(expHandlers(expHandlers(relatedList.api_name,\'!=\',\'Lead_Source_History\'),\'&amp;&amp;\',expHandlers(relatedList.api_name,\'!=\',\'Attachments\')),\'&amp;&amp;\',expHandlers(relatedList.api_name,\'!=\',\'Stage_History\'))}}"><template case="true"> <template is="if" value="{{expHandlers(expHandlers(module,\'!=\',&quot;Visits&quot;),\'&amp;&amp;\',isRecordApproved(recordObj,relatedList))}}"><template case="true"> <div id="icons_{{recordObj.id}}" class="vH"> <template is="if" value="{{expHandlers(isClientAccount,\'!\')}}"><template case="true"> <crm-edit-delete-icons record="{{recordObj}}" module="{{relatedModule}}" from-module="{{module}}" cvid="{{moduleInfo.cvid}}" from-record="{{record}}" related-list="{{relatedList}}"> </crm-edit-delete-icons></template></template> </div> </template><template case="false"> <span class="iconlock_ap mL2" title="{{getI18n(\'crm.approvalProcess.label.waitingForApproval\')}}" alt="{{getI18n(\'crm.approvalProcess.label.waitingForApproval\')}}"></span> </template></template> </template></template> </template> <template is="yield" yield-name="header-prefix-1"></template> <template is="yield" yield-name="body-prefix-2" cx-prop-style="width:18px" data-zcqa="dummy"> <template is="if" value="{{expHandlers(isClientAccount,\'!\')}}"><template case="true"> <lyte-checkbox style="user-select:none; -ms-user-select:none; -webkit-user-select:none; -moz-user-select:none;" data-id="selectEntity" id="selectEntity_{{recordObj.id}}" lt-prop-class="{{if(contains(selectedIds,recordObj.id,selectedIds.length),\'customCheckBoxChecked\',\'customCheckBox\')}}" data-zcqa="selectEntity" on-changed="{{method(&quot;onRecordCheckBoxChanged&quot;)}}" onclick="{{action(&quot;stopPropagation&quot;,event)}}" lt-prop-id="{{recordObj.id}}" data-recnum="{{recordObj.recnum}}"></lyte-checkbox> </template></template> </template> <template is="yield" yield-name="header-prefix-2" cx-prop-fixed="enable" cx-prop-style="width:10px"> <template is="if" value="{{expHandlers(isClientAccount,\'!\')}}"><template case="true"> <lyte-checkbox style="user-select:none; -ms-user-select:none; -webkit-user-select:none; -moz-user-select:none;" id="selectCheckbox" data-zcqa="relatedList_selectAllEntity" lt-prop-id="selectAllEntity" lt-prop-class="{{if(pageSelectedRecords(selectedIds,tableData,selectedIds.length),\'customCheckBoxChecked\',\'customCheckBox\')}}" on-changed="{{method(&quot;onPageCheckBoxChanged&quot;)}}"></lyte-checkbox> </template></template> </template> </crux-table-component> <template is="if" value="{{showCountDiv}}"><template case="true"> <span>{{getI18n(\'crm.label.totalcount\')}} : {{showCountValue}}</span> </template></template> <template is="if" value="{{showNavig}}"><template case="true"> <div class="p6 whiteBg dF"> <lyte-navigator lt-prop-yield="true" class="mlAuto fR" on-next="{{method(\'navigNext\')}}" on-previous="{{method(\'navigPrevious\')}}" lt-prop-value="{{startIndex}}" lt-prop-records="{{relatedListData.length}}" lt-prop-perpage="10"> <template is="registerYield" yield-name="navigatorYield" style="display : flex"> <div class="lyteSingleBack lyteNavigator lyteIconSingleBack" data-zcqa="{{relatedList.id}}_rellist_navig_prev"></div> <div> {{startRecord}} <span class="lightgray pLR10">-</span> {{endRecord}} </div> <div class="lyteSingleFront lyteNavigator lyteIconSingleFront" data-zcqa="{{relatedList.id}}_rellist_navig_next"></div> </template> </lyte-navigator> </div> </template></template></template></template> </template></template></template></template></template></template> </div> </lyte-event-listener></template>',_dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1,1,1]},{type:"if",position:[1,1,1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3,1]},{type:"text",position:[1,3,1,0]},{type:"attr",position:[1,3,3]},{type:"text",position:[1,3,3,0]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"attr",position:[1,2]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"text",position:[1,1]}]}},default:{}}]}},default:{}},{type:"attr",position:[1,1,1,2]},{type:"if",position:[1,1,1,2],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"text",position:[3,1,0]},{type:"text",position:[3,1,2]}]}},default:{}},{type:"attr",position:[1,1,3,1]},{type:"if",position:[1,1,3,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]},{type:"text",position:[3,0,0]},{type:"text",position:[3,2]}]}},default:{}},{type:"attr",position:[1,1,5,1]},{type:"if",position:[1,1,5,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"componentDynamic",position:[1,1]}]}},default:{}},{type:"attr",position:[1,1,5,3]},{type:"if",position:[1,1,5,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]}]}},default:{}},{type:"attr",position:[1,1,5,5]},{type:"if",position:[1,1,5,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,1,5,7]},{type:"if",position:[1,1,5,7],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]}]}},default:{}},{type:"attr",position:[1,1,5,9]},{type:"switch",position:[1,1,5,9],cases:{Contact_Roles:{dynamicNodes:[]},Attachments:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]},{type:"attr",position:[7]}]},Related_List:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"attr",position:[1,1,5,11]},{type:"attr",position:[1,3]},{type:"attr",position:[1,3,1]},{type:"if",position:[1,3,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,1,0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"text",position:[1,0]}]}},default:{}},{type:"attr",position:[1,3]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"registerYield",position:[1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"attr",position:[1,3]},{type:"text",position:[1,3,0]},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[3]}]}},default:{}},{type:"attr",position:[3]},{type:"attr",position:[5]},{type:"registerYield",position:[5,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,3]},{type:"if",position:[1,3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,5]},{type:"if",position:[1,5],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]},{type:"componentDynamic",position:[1]}]}},default:{}},{type:"attr",position:[1,7]},{type:"text",position:[1,7,0]},{type:"componentDynamic",position:[1,7]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[5]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]},{type:"text",position:[3]},{type:"attr",position:[5]},{type:"attr",position:[7]},{type:"registerYield",position:[7,1],dynamicNodes:[{type:"attr",position:[1,1]},{type:"text",position:[1,1,0]},{type:"componentDynamic",position:[1,1]},{type:"attr",position:[1,3]},{type:"text",position:[1,3,0]},{type:"componentDynamic",position:[1,3]},{type:"attr",position:[1,5]},{type:"text",position:[1,5,0]},{type:"componentDynamic",position:[1,5]},{type:"componentDynamic",position:[1]}]},{type:"componentDynamic",position:[7]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"attr",position:[2]},{type:"componentDynamic",position:[2]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"attr",position:[5]},{type:"if",position:[5],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}}]},{type:"registerYield",position:[1,3],dynamicNodes:[{type:"text",position:[1]}]},{type:"registerYield",position:[1,5],dynamicNodes:[{type:"text",position:[1]}]},{type:"registerYield",position:[1,7],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"text",position:[1]}]}},default:{}}]},{type:"registerYield",position:[1,9],dynamicNodes:[{type:"text",position:[1]}]},{type:"registerYield",position:[1,11],dynamicNodes:[{type:"text",position:[1]}]},{type:"registerYield",position:[1,13],dynamicNodes:[{type:"text",position:[1]}]},{type:"registerYield",position:[1,15],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}},{type:"attr",position:[2]},{type:"componentDynamic",position:[2]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]},{type:"registerYield",position:[1,17],dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},{type:"registerYield",position:[1,19],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"text",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"component",position:[1],dynamicNodes:[]}]},false:{dynamicNodes:[{type:"attr",position:[0]},{type:"if",position:[0],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]},{type:"component",position:[1],dynamicNodes:[]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]},{type:"registerYield",position:[1,21],dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]},{type:"registerYield",position:[1,23],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"attr",position:[1,1]},{type:"if",position:[1,1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]},false:{dynamicNodes:[{type:"attr",position:[1]}]}},default:{}}]}},default:{}}]},{type:"registerYield",position:[1,25],dynamicNodes:[]},{type:"registerYield",position:[1,27],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]},{type:"registerYield",position:[1,29],dynamicNodes:[{type:"attr",position:[1]},{type:"if",position:[1],cases:{true:{dynamicNodes:[{type:"attr",position:[1]},{type:"componentDynamic",position:[1]}]}},default:{}}]},{type:"componentDynamic",position:[1]},{type:"attr",position:[3]},{type:"if",position:[3],cases:{true:{dynamicNodes:[{type:"text",position:[1,0]},{type:"text",position:[1,2]}]}},default:{}},{type:"attr",position:[5]},{type:"if",position:[5],cases:{true:{dynamicNodes:[{type:"attr",position:[1,1]},{type:"registerYield",position:[1,1,1],dynamicNodes:[{type:"attr",position:[1]},{type:"text",position:[3,1]},{type:"text",position:[3,5]},{type:"attr",position:[5]}]},{type:"componentDynamic",position:[1,1]}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}}]}},default:{}},{type:"componentDynamic",position:[1]}],_observedAttributes:["showLoading","showNoRecords","module","moduleInfo","recordGet","record","entityId","relatedListId","relatedList","relatedModule","fieldUiType","relatedListFields","relatedListData","relatedModuleFields","fieldMapping","routeMapping","displayField","customfields","uiTypeLookup","showNavig","startIndex","moreRecords","pageNo","tableData","attachLinkMenuOpen","selectedIds","customButtons","editCustomRelList","prefixYields","isClientAccount","mxnFieldRecordId","campaignFilter","showCountDiv","showCountValue","layoutId","pageRequested","portalName","roleValues","relatedListCount","inaccessible","showActions","playingMp3","eventsFlag"],data:function(){return{showLoading:Lyte.attr("boolean",{default:!0}),showNoRecords:Lyte.attr("boolean",{default:!0}),module:Lyte.attr("string"),moduleInfo:Lyte.attr("object"),recordGet:Lyte.attr("boolean",{default:!1}),record:Lyte.attr("object",{hideAttr:!0}),entityId:Lyte.attr("string"),relatedListId:Lyte.attr("string"),relatedList:Lyte.attr("object",{hideAttr:!0}),relatedModule:Lyte.attr("string"),fieldUiType:Lyte.attr("object"),relatedListFields:Lyte.attr("array"),relatedListData:Lyte.attr("array",{default:[]}),relatedModuleFields:Lyte.attr("array"),fieldMapping:Lyte.attr("object"),routeMapping:Lyte.attr("object"),displayField:Lyte.attr("object",{default:crmConstants.moduleDisplayField}),customfields:Lyte.attr("array"),uiTypeLookup:Lyte.attr("object",{default:{4:!0,5:!0,6:!0,7:!0,9:!0,10:!0,12:!0,13:!0,15:!0,16:!0,42:!0,43:!0,44:!0,62:!0,133:!0,444:!0,135:!0}}),showNavig:Lyte.attr("boolean",{default:!1}),startIndex:Lyte.attr("number",{default:0}),moreRecords:Lyte.attr("boolean",{default:!0}),pageNo:Lyte.attr("number",{default:1}),tableData:Lyte.attr("array",{default:[]}),attachLinkMenuOpen:Lyte.attr("boolean",{default:!1}),selectedIds:Lyte.attr("array",{default:[]}),customButtons:Lyte.attr("array",{default:[]}),editCustomRelList:Lyte.attr("boolean",{default:!1}),prefixYields:Lyte.attr("array",{default:[]}),isClientAccount:Lyte.attr("boolean"),mxnFieldRecordId:Lyte.attr("array",{default:[]}),campaignFilter:Lyte.attr("boolean",{default:!1}),showCountDiv:Lyte.attr("boolean",{default:!1}),showCountValue:Lyte.attr("number"),layoutId:Lyte.attr("string"),pageRequested:Lyte.attr("array",{default:[]}),portalName:Lyte.attr("string",{default:"All Portals"}),roleValues:Lyte.attr("array",{default:[]}),relatedListCount:Lyte.attr("string"),inaccessible:Lyte.attr("boolean"),showActions:Lyte.attr("boolean",{default:!0}),playingMp3:Lyte.attr("string"),eventsFlag:Lyte.attr("boolean",{default:!0})}},eventsFlag:!0,observeLayoutId:function(){this.setData("pageRequested",[]),this.setData("showLoading",!0),clientPortalName?this.setData("isClientAccount",!0):this.setData("isClientAccount",!1);var e=Object.assign({},crmConstants.defaultUiTypeToCruxMapping);Object.assign(e,{20:"user",127:"lookup"}),this.setData("fieldUiType",e);var t=this.getData("relatedList").api_name;this.getData("relatedList").module?"multiselectlookup"==this.getData("relatedList").type&&this.getData("relatedList").connectedmodule?this.setData("relatedModule",this.getData("relatedList").connectedmodule):this.setData("relatedModule",idModuleMapping[this.getData("relatedList").module.id]?idModuleMapping[this.getData("relatedList").module.id]:this.getData("relatedList").module.api_name):"Stage_History"==t&&this.setData("relatedModule","Dealhistory"),"Deals"==this.data.relatedModule&&this.setData("relatedModule","Potentials"),"Attachments"==this.data.relatedModule&&this.setData("showActions",Crm.userDetails.permissions.hasOwnProperty("Crm_Implied_Create_Attachments"));var a=this;if("Lead_Source_History"!=this.getData("relatedList").api_name&&"Attachments"!=this.getData("relatedList").api_name&&"Stage_History"!=this.getData("relatedList").api_name&&"Invited_Events"!=this.getData("relatedList").api_name&&Lyte.arrayUtils(this.getData("prefixYields"),"push",{fixed:"enable",width:"50px",class:"editDeleteIcons"}),this.setData("moduleInfo",moduleRecordMapping[a.data.relatedModule]?store.peekRecord("module",moduleRecordMapping[a.data.relatedModule].id):void 0),store.peekRecord("related_list",a.data.relatedList.id)[this.data.layoutId]&&store.peekRecord("related_list",a.data.relatedList.id)[this.data.layoutId].fields&&store.peekRecord("related_list",a.data.relatedList.id)[this.data.layoutId].fields.length>0){var i=store.peekRecord("related_list",a.data.relatedList.id)[this.data.layoutId];a.setData("relatedList",i),a.setData("relatedListFields",i.fields),a.sorted=!1,i.sort_by&&(a.sorted=!0,a.setData("sort_by",i.sort_by.api_name),a.setData("sort_order",i.sort_order)),a.constructFields(),a.setData("recordGet",!0)}else app.store.makeRequest("findRecord","related_list",a.data.relatedList.id,{module:moduleApiMapping[a.data.module],layout_id:this.data.layoutId,include_inner_details:"fields.ui_type,fields.lookup,fields.formula,fields.field_label,fields.pick_list_values,fields.separator"}).then((function(e){if(a.data){if(void 0===e||0===e.length)return a.setData("showLoading",!1),void a.setData("showNoRecords",!0);a.setData("relatedList",e[0]),a.setData("relatedListFields",e[0].fields),a.sorted=!1,e[0].sort_by&&(a.sorted=!0,a.setData("sort_by",e[0].sort_by.api_name),a.setData("sort_order",e[0].sort_order)),a.constructFields(),a.setData("recordGet",!0),a.fireRequest(a)}}));"Contact_Roles"==this.data.relatedList.api_name&&store.findAll("field",{module:"DealContactRole"}).then((function(e){a.data&&a.setData("roleValues",e.filter((function(e){return"Role"==e.api_name}))[0].pick_list_values)})),"Competitors"!==t&&"Stage_History"!==t&&app.store.makeRequest("findAll","custom_button",{module:moduleRecordMapping[this.getData("module")].api_name},!0).then((function(e){a.data&&(a.setData("customButtons",e.filter((function(e){return"related_list"==e.position&&e.related_list_name==a.getData("relatedList").api_name}))),a.getData("customButtons")&&a.getData("customButtons").length>0&&Lyte.arrayUtils(a.getData("prefixYields"),"push",{fixed:"enable",width:"10px",class:"checkBoxBody"}))})),moduleRecordMapping[this.getData("relatedModule")]&&featuresAvailable.Related_List_Customization&&Crm.userDetails.permissions.Crm_Implied_Customize_Zoho_CRM&&!crmTab.isZBCustomModule(moduleRecordMapping[this.getData("relatedModule")].module_name)&&!crmTab.isZECustomModule(moduleRecordMapping[this.getData("relatedModule")].module_name)&&!crmTab.isZSCustomModule(moduleRecordMapping[this.getData("relatedModule")].module_name)?this.setData("showColumnList",!0):this.setData("showColumnList",!1),this.refreshId="#fetch_"+this.data.relatedList.id}.observes("layoutId").on("init"),recordObserve:function(){this.data.recordGet&&!this.requestFired&&(this.setData("pageNo",1),this.setData("relatedListData",[]),this.setData("startIndex",0),this.setData("pageRequested",[]),this.setData("showCountDiv",!1),this.setData("campaignFilter",!1),document.querySelectorAll(this.refreshId).forEach((function(e){e.classList.remove("eventNone")})),this.campaignFilter=void 0,this.fireRequest(this))}.observes("record").on("didConnect"),fireRequest:function(e,t,a,i){if(e.getData("record")&&e.getData("record").id){var o;o=e.sorted&&"unsort"!=e.getData("sort_order")?{relatedId:e.getData("record").id,relationId:e.getData("relatedList").id,per_page:"11",page:e.getData("pageNo"),sort_order:e.getData("sort_order"),sort_by:e.getData("sort_by")}:{relatedId:e.getData("record").id,relationId:e.getData("relatedList").id,per_page:"11",page:e.getData("pageNo")};var s=e.getData("availableInfo");s&&s.next_page_token&&(o.token=s.next_page_token),o.approved="both",o.approval_state="approved,approval_process_pending,approval_process_rejected",this.setData("attachLinkMenuOpen",!1);var l={};if("Competitors"!==e.getData("relatedList").api_name&&"picklist_tracker"!==e.getData("relatedList").action||(l.type="GET"),e.campaignFilter&&(o.filters=this.campaignFilter,a=!0),"Visits"==e.data.relatedModule&&"All Portals"!=e.data.portalName&&(o.filters={},o.filters.field={},o.filters.field.api_name="Portal_Name",o.filters.comparator="equal",o.filters.value=e.data.portalName),"Stage_History"==e.data.relatedList.api_name&&(o.sort_by="Modified_Time"),this.data.customfields&&"multiselectlookup"==this.data.relatedList.type){o.fields=this.data.relatedListFields.map((e=>e.api_name)).join(","),o.fields+=",id";var n=store.peekRecord("field",this.data.relatedList.mxnfield);o.fields+=n?","+n.api_name:""}e.requestFired=!0,app.store.makeRequest("findAll",moduleRecordMapping["Visits"==e.data.relatedModule?"Visits":e.getData("module")].id,o,void 0,!1,l).then((function(o){if(e.requestFired=!1,e.setData("availableInfo",o.info),e.data){if(Lyte.arrayUtils(e.data.pageRequested,"push",e.getData("pageNo")),o=o[moduleRecordMapping["Visits"==e.data.relatedModule?"Visits":e.getData("module")].id],a&&1==e.getData("pageNo")&&(null==o||0==o.length?(e.setData("relatedListData",[]),e.setData("tableData",[]),e.setData("showCountDiv",!1)):e.setData("showCountDiv",!0)),null==o||0==o.length)e.setData("showLoading",!1),null==t?(e.setData("showNoRecords",!0),Lyte.triggerEvent("relatedListCount",{id:e.data.relatedList.id,api_name:e.data.relatedList.api_name,count:0,format:"table",more_records:!1,page:1}),populateRLCount&&populateRLCount(e.data.relatedList.id)):e.setRelatedListData(!0,!0);else if("multiselectlookup"!=e.getData("relatedList").type){e.setData("showLoading",!1),e.setData("showNoRecords",!1),null==t&&e.setData("showNavig",o.length>10);var s=o.length;if("Attachments"==e.getData("relatedList").api_name){e.idVsURL={};for(var l=0;l<s;l++){"Document"==o[l].$type&&o[l].$docs_file_size&&(o[l].Size=o[l].$docs_file_size);var n=o[l].Size/1024;n>1e3?(n/=1024,n=parseFloat(n).toFixed(2)+" "+I18n.getMsg("MB")):n=0!=n?parseFloat(n).toFixed(2)+" "+I18n.getMsg("KB"):"-",o[l].Size=n,"Link URL"==o[l].$type&&(o[l].extn="link")}}if("picklist_tracker"==e.getData("relatedList").action){var r=e.data.moduleInfo.parent_module.fields.filter((function(e){return e.history_tracking}));r=r.length?r[0]:void 0;for(l=0;l<s;l++)r&&null==o[l][r.api_name]&&(o[l][r.api_name]=I18n.getMsg("crm.picklist.tracker.noneValue"))}e.pushRecordToModule(o)}else{s=o.length;null==t&&e.setData("showNavig",o.length>10);var d=[];if(!e.data.relatedList.mxnfield){var p=store.peekAll("field").filterBy({data_type:"multiselectlookup"}).filter((function(t){return t.multiselectlookup.api_name===e.data.relatedList.api_name}))[0];e.data.relatedList.mxnfield=p.id}for(l=0;l<s;l++)d.push(o[l][store.peekRecord("field",e.data.relatedList.mxnfield).multiselectlookup.connectedlookup_apiname].id);e.setData("mxnFieldRecordId",d),e.getMultiSelectValues(o)}i&&e.refreshHeader()}}),(function(t){if(-1!=JSON.parse(t.responseText).message.indexOf("converted"))renderingUtils.showCustomAlert(I18n.getMsg("crm.convert.lead.converted.error.popup"),I18n.getMsg("crm.convert.lead.converted.heading"),!1,(function(){crmHistory.refreshCurrentPage()}),void 0,I18n.getMsg("workflow.webHook.RefreshURLPreview"));else{var a=Lyte.Router.getRouteInstance();"detail"==a.routeName?renderingUtils.displayPermissionDenied(void 0,(function(){var e=$L("lyte-alert","crux-permission-denied-alert");e&&e[0].setMethods({onAccept:function(){a.refresh()}})})):e.permissionDenyMsg(e)}}))}else e.setData("showLoading",!1),e.setData("showNoRecords",!0)},permissionDenyMsg:function(e){e.setData("showLoading",!1),e.setData("showNoRecords",!1),e.setData("inaccessible",!0);var t=e.getData("relatedListId"),a=store.peekRecord("related_list",t).actions;$("#fetch_"+t).remove(),$("#customizeList"+t).remove(),$("#RL_dataCount_"+t).remove(),a.forEach((function(e){var a=$L(document.querySelectorAll("#zcDetail_"+e.label+"_"+t));if(a)for(var i=a.length,o=0;o<i;o++)a[o].component.setData("ltPropDisabled",!0)}));var i=$L("#id_"+t);i[0]&&i[0].component&&i[0].remove()},actions:{stopPropagation:function(e){e.stopPropagation(),e.cancelBubble=!0},showColumnList:function(){var e=this;commonUtils.showHideLoadingDiv(!0),"multiselectlookup"==this.data.relatedList.type&&moduleRecordMapping[this.data.relatedList.linkingmodule]&&moduleRecordMapping[this.data.relatedList.linkingmodule].visibility%2!=0?moduleRecordMapping[this.getData("relatedModule")].fields&&moduleRecordMapping[this.getData("relatedModule")].fields.legnth&&moduleRecordMapping[this.data.relatedList.linkingmodule].fields&&moduleRecordMapping[this.data.relatedList.linkingmodule].fields.length?this.openColumnList():moduleRecordMapping[this.getData("relatedModule")].fields&&moduleRecordMapping[this.getData("relatedModule")].fields.legnth?store.findRecord("module",moduleRecordMapping[this.data.relatedList.linkingmodule].id).then((function(){e.openColumnList()})):moduleRecordMapping[this.data.relatedList.linkingmodule].fields&&moduleRecordMapping[this.data.relatedList.linkingmodule].fields.legnth?store.findRecord("module",moduleRecordMapping[this.getData("relatedModule")].id).then((function(){e.openColumnList()})):Lyte.resolvePromises([store.findRecord("module",moduleRecordMapping[this.getData("relatedModule")].id),store.findRecord("module",moduleRecordMapping[this.data.relatedList.linkingmodule].id)]).then((function(){e.openColumnList()})):store.peekRecord("module",moduleRecordMapping[this.getData("relatedModule")].id).fields&&0!==store.peekRecord("module",moduleRecordMapping[this.getData("relatedModule")].id).fields.length?"Events"===store.peekRecord("module",moduleRecordMapping[this.getData("relatedModule")].id).module_name&&this.eventsFlag?store.findRecord("module",moduleRecordMapping[this.getData("relatedModule")].id).then((function(){e.eventsFlag=!1,e.openColumnList()})):this.openColumnList():store.findRecord("module",moduleRecordMapping[this.getData("relatedModule")].id).then((function(){e.openColumnList()}))},editCustomRL:function(){this.setData("editCustomRelList",!0)},saveCustomRL:function(){var e=this.$node.querySelector("#customRel");if(e.component.validate()){var t=e.component.getValue(),a=this.getData("relatedList");a.$.set("display_label",t),a.$.save(void 0,{module:moduleApiMapping[selfVal.data.module],layout_id:this.data.layoutId}),this.setData("editCustomRelList",!0)}},cancelCustomRL:function(){this.setData("editCustomRelList",!1)},handleRefresh:function(e){var t=!1;if(e.callActivity)t=!0;else if(e.res){var a="object"==typeof e.res?e.res:JSON.parse(e.res);a&&a[this.data.module]&&a[this.data.module][this.data.relatedListId]&&(t=!0)}else e.module?(this.getData("relatedModule")==e.module||"Activites"==this.data.relatedModule&&"Events"==e.module)&&(t=!0):(e.refresh||e&&e.id&&this.getData("relatedList").id==e.id)&&(t=!0);"unassign"==e.type&&Lyte.arrayUtils(this.data.selectedIds,"removeAt",this.data.selectedIds.indexOf(e.record_id)),e.refreshTemplate&&(this.refreshColumnList=!0,this.setData("selectedIds",[])),t&&!this.requestFired&&(this.setData("pageNo",1),this.setData("relatedListData",[]),this.setData("startIndex",0),this.setData("pageRequested",[]),this.setData("showCountDiv",!1),this.setData("campaignFilter",!1),document.querySelectorAll(this.refreshId).forEach((function(e){e.classList.remove("eventNone")})),this.campaignFilter=void 0,this.fireRequest(this,void 0,void 0,e.refreshTemplate))},attachLinkClick:function(e,t){switch(e){case"viewAttach":this.viewAttachments(t,"realtedListImage");break;case"editLinkAttach":Crm.userDetails.permissions.hasOwnProperty("Crm_Implied_Create_Attachments")?this.editLinkAttachments(t):_cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("crm.delete.error"),ltPropSecondaryMessage:I18n.getMsg("crm.security.error"),ltPropButtons:[{type:"accept",text:I18n.getMsg("crm.button.ok"),appearance:"primary"}],ltPropButtonPosition:"right"},show:function(e){e.childComp.querySelector(".alertPrimaryMsg").style="color:#E20000"}});break;case"downloadAttach":this.downloadAttachments(t);break;case"deleteAttach":Crm.userDetails.permissions.hasOwnProperty("Crm_Implied_Delete_Attachments")?this.recordDeletePopup(t,2,"Attachments",this.data.module,this.data.record,this.data.relatedList):_cruxUtils.showCustomAlert({params:{ltPropPrimaryMessage:I18n.getMsg("crm.delete.error"),ltPropSecondaryMessage:I18n.getMsg("crm.security.error"),ltPropButtons:[{type:"accept",text:I18n.getMsg("crm.button.ok"),appearance:"primary"}],ltPropButtonPosition:"right"},show:function(e){e.childComp.querySelector(".alertPrimaryMsg").style="color:#E20000"}})}},attachNameClick:function(e){"link"!=e.extn&&"png"!=e.extn&&!e.$previewUrl||"mp3"==e.extn||"movie"==e.extn||"file"==e.extn||"zip"==e.extn?this.downloadAttachments(e):this.viewAttachments(e,"realtedListImageFileName")},invitedEventsDrop:function(e,t){switch(e){case"edit":Crm.editEntity(event,void 0,{module:"Events",id:t.id,reqFrom:"detailView",from:"relatedlist_new"}),event.preventDefault();break;case"delete":this.recordDeletePopup(t,2,"Events");break;case"disassociate":$L("crm-detail-view-common")[0].component.removeParticipant(this.getData("record")[crmConstants.moduleDisplayField[this.getData("module")][0]],t,this.data.record)}},showHideRelatedFields:function(e,t){if("mouseout"==event.type)return crmui.hideTooltip(),!0;var a,i={},o=$(event.target),s=t.api_name.split(".");if(s.length>1&&(e=e[s[0]]),t.lookup.module&&"se_module"==t.lookup.module.api_name)a=(a=Object.keys(moduleApiMapping).filter((function(t){return moduleApiMapping[t]==e.$se_module}))).length?a[0]:e.$se_module;else if(e[t.api_name]&&e[t.api_name].module||s.length>1&&e[s[1]]&&e[s[1]].module)if(e[t.api_name]&&e[t.api_name].module.api_name||s.length>1&&e[s[1]].module.api_name){var l=s.length>1?e[s[1]].module.api_name:e[t.api_name].module.api_name;a=(a=Object.keys(moduleApiMapping).filter((function(e){return moduleApiMapping[e]==l}))).length?a[0]:l}else a=s.length>1?e[s[1]].module:e[t.api_name].module;else a=(a=Object.keys(moduleApiMapping).filter((function(e){return moduleApiMapping[e]==t.lookup.module.api_name}))).length?a[0]:t.lookup.module.api_name;i.module=a,i.id=s.length>1?e[s[1]].id:e[t.api_name].id,crmLookupBusinessCard.showingSide="showOnRight",renderingUtils.windowWidth-o[0].getBoundingClientRect().right<425&&(crmLookupBusinessCard.showingSide="showOnLeft"),i&&i.module&&i.id&&setTimeout((function(){o.is(":hover")&&crmLookupBusinessCard.getRecordJSon(i.module,i.id,o)}),250)},showIcons:function(e){var t=this.$node.querySelector("#icons_"+e);if(t&&t.classList.remove("vH"),("Attachments"==this.getData("relatedModule")||"Invited_Events"==this.data.relatedList.api_name)&&!this.getData("attachLinkMenuOpen")){this.$node.querySelector("#attachLinks_"+e).classList.remove("vH");var a=this.$node.querySelector("#play_"+e);a&&a.classList.remove("vH")}},hideIcons:function(e){var t=this.$node.querySelector("#icons_"+e);if(t){var a=t.querySelector("lyte-menu");a&&a.ltProp("show")||t.classList.add("vH")}if("Attachments"==this.getData("relatedModule")||"Invited_Events"==this.data.relatedList.api_name){var i=this.$node.querySelector("#attachLinksMenu_"+e);i&&i.ltProp("show")||this.$node.querySelector("#attachLinks_"+e).classList.add("vH");var o=this.$node.querySelector("#play_"+e);o&&!o.classList.contains("icon_pause")&&o.classList.add("vH")}},showSortDropdown:function(e){this.data.sort_by==e.api_name?"asc"==this.data.sort_order?this.setData("sortDetails",["desc","unsort"]):"desc"==this.data.sort_order?this.setData("sortDetails",["asc","unsort"]):this.setData("sortDetails",["asc","desc"]):this.setData("sortDetails",["asc","desc"]),$L("crm-detail-view-common")[0].component.showSortDropdown(this)},showCampaignFilter:function(){this.setData("campaignFilter",!this.data.campaignFilter),this.data.campaignFilter?document.querySelectorAll(this.refreshId).forEach((function(e){e.classList.add("eventNone")})):(document.querySelectorAll(this.refreshId).forEach((function(e){e.classList.remove("eventNone")})),this.setData("pageRequested",[]),this.setData("pageNo",1),this.setData("pageRequested",[]),this.setData("relatedListData",[]),this.campaignFilter=void 0,this.setData("startIndex",0),this.fireRequest(this),this.setData("showCountDiv",!1))},onBodyRowClick:function(){return!0},loadContactsHierarchyView:function(){$L(".canvasPopupDivNonReplace")[0].append($L("#contactTreePopupId")[0]),crmRelatedList.getContactTreeData(this.getData("record").id,this.getData("module"))},showCompetitorPopup:function(e){commonUtils.openCustomLookup(Crm.getCrmBasePath()+"/potentials/ViewCompetitor.do?id="+e.id+"&module=Potentials&returnAnchor=competitorspersonality_"+this.data.relatedList.id,void 0,"topBandPopup")},onButtonClick:function(e){commonUtils.showHideLoadingDiv(!0);var t=this,a=store.peekRecord("custom_button",e);this.requestButtonSend||(this.requestButtonSend=!0,store.triggerAction(moduleRecordMapping[this.data.module].id,"custom_buttons",{button_id:e,type:"POST"},{ids:this.data.record.id},void 0,{related_list_ids:this.data.selectedIds.join(",")}).then((function(i){commonUtils.showHideLoadingDiv(),t.requestButtonSend=!1,t.executeCustomButtons(i.details,e,t.data.record.id,a.position,moduleRecordMapping[t.data.module].id)})).then((function(){t.requestButtonSend=!1}))),event.stopPropagation(),event.preventDefault()},playMp3:function(e){event.preventDefault(),event.stopPropagation();var t=this.$node.querySelector("#audio_"+e),a=this.$node.querySelector("#play_"+e);if(this.data.playingMp3)if(e==this.data.playingMp3)t.pause(),a.setAttribute("lt-prop-title",I18n.getMsg("crm.button.play")),this.setData("playingMp3",void 0);else{this.$node.querySelector("#audio_"+this.data.playingMp3).pause();var i=this.$node.querySelector("#play_"+this.data.playingMp3);i.classList.add("vH"),i.setAttribute("lt-prop-title",I18n.getMsg("crm.button.play")),a.setAttribute("lt-prop-title",I18n.getMsg("crm.button.pause")),t.play(),this.setData("playingMp3",e)}else t.play(),a.setAttribute("lt-prop-title",I18n.getMsg("crm.button.pause")),this.setData("playingMp3",e)}},methods:{navigNext:function(){this.setData("pageNo",this.getData("pageNo")+1),this.data.pageRequested.contains(this.data.pageNo)?this.setRelatedListData(!0,!1):this.fireRequest(this,!0)},onRecordCheckBoxChanged:function(e){e.nextElementSibling.classList.contains("customCheckBox")?Lyte.arrayUtils(this.getData("selectedIds"),"push",e.id):Lyte.arrayUtils(this.getData("selectedIds"),"removeAt",this.getData("selectedIds").indexOf(e.id))},onPageCheckBoxChanged:function(e){var t=this;e.nextElementSibling.classList.contains("customCheckBox")?this.getData("tableData").forEach((function(e){-1==t.getData("selectedIds").indexOf(e.id)&&Lyte.arrayUtils(t.getData("selectedIds"),"push",e.id)})):this.getData("tableData").forEach((function(e){t.getData("selectedIds").indexOf(e.id)>-1&&Lyte.arrayUtils(t.getData("selectedIds"),"removeAt",t.getData("selectedIds").indexOf(e.id))}))},attachLinksOpen:function(e,t,a){this.setData("attachLinkMenuOpen",!0);var i=$L(".cscript-attachment-menubody");a&&$L(a).closest(".canvas-cscript-readonly").length?i.addClass("canvas-cscript-readonly-menu"):i.removeClass("canvas-cscript-readonly-menu")},onAttachMenuClose:function(e){this.setData("attachLinkMenuOpen",!1),$L("#attachLinks_"+e,this.$node)[0].classList.add("vH")},menuOnBeforeOpen:function(e){$L.fastdom.measure((function(){var t=$L("#DetailViewInnerTabs"),a=$L("#wmstoolbar"),i={top:0,bottom:0};t.length&&(i.top=t[0].getBoundingClientRect().bottom),a.length&&(i.bottom=a[0].getBoundingClientRect().top),$L.fastdom.mutate((function(){e.ltProp("boundary",i)}))}))},navigPrevious:function(){this.setData("attachLinkMenuOpen",!1),this.setData("pageNo",this.getData("pageNo")-1),this.setData("moreRecords",!1),this.setRelatedListData(!0,!1)},campaignFilter:function(e,t,a){if(a){var i=e.getFilterQuery();if(0==Object.keys(i))return void _cruxUtils.showCustomMessage({params:{ltPropTransition:'{"animation" : "slideFromTop"}',ltPropMessage:I18n.getMsg("crm.label.empty.value"),ltPropType:"error",ltPropOffset:{top:"50px"}}});this.setData("pageNo",1),this.setData("pageRequested",[]),this.setData("relatedListData",[]),this.setData("startIndex",0),this.campaignFilter=JSON.stringify(i),this.requestFired||this.fireRequest(this,!0,i),this.setFilterCount()}},campaignFilterClear:function(){this.setData("pageRequested",[]),this.setData("pageNo",1),this.setData("pageRequested",[]),this.setData("relatedListData",[]),this.setData("startIndex",0),this.campaignFilter=void 0,this.requestFired||this.fireRequest(this),this.setData("showCountDiv",!1)},filterConditions:function(e){var t=[{name:_cruxUtils.getI18n("is"),api_val:"equal"},{name:_cruxUtils.getI18n("isn't"),api_val:"not_equal"}],a=[{name:_cruxUtils.getI18n("contains"),api_val:"contains"},{name:_cruxUtils.getI18n("doesn't contain"),api_val:"not_contains"}],i=[{name:I18n.getMsg("On"),api_val:"equal"},{name:I18n.getMsg("Before"),api_val:"less_than"},{name:I18n.getMsg("After"),api_val:"greater_than"}];return e&&e.setData("cxPropPlaceHolder",{text:I18n.getMsg("crm.label.filter.typehere"),number:I18n.getMsg("crm.label.filter.typehere"),email:I18n.getMsg("crm.label.filter.typehere"),lookup:I18n.getMsg("crm.label.filter.typehere"),number:I18n.getMsg("crm.label.filter.typehere"),phone:I18n.getMsg("crm.label.filter.typehere"),"text-area":I18n.getMsg("crm.label.filter.typehere"),website:I18n.getMsg("crm.label.filter.typehere"),user:I18n.getMsg("crm.label.none"),picklist:I18n.getMsg("crm.select"),layout:I18n.getMsg("crm.select")}),{52:t,32:t,38:t,36:t,0:a,786:i,200:i,24:i,333:i,14:i,35:a,208:t,209:t,221:t,100:a}}},setFilterCount:function(){var e=this,t={relatedId:this.getData("record").id,relationId:this.getData("relatedList").id,filters:this.campaignFilter};store.triggerAction(moduleRecordMapping[this.getData("module")].id,"count",t).then((function(t){e.setData("showCountValue",t.count)}))},sortRecord:function(e){var t=$L(".lyteMenuSelected")[0].parentElement.id,a=this.data.relatedListFields.filter((function(e){return e.id==t}))[0].api_name;this.sorted=!0,this.setData("sort_order",e),this.setData("sort_by",a),this.setData("pageNo",1),this.setData("pageRequested",[]),this.setData("relatedListData",[]),this.setData("startIndex",0),this.campaignFilter||(this.setData("campaignFilter",!1),this.setData("showCountDiv",!1)),this.fireRequest(this),setTimeout(function(){var i=this.data.relatedList;"unsort"==e?i.$.triggerAction("unsort",{type:"PUT"},{module:moduleApiMapping[this.data.module],layout_id:this.data.layoutId},void 0,{related_list:{sort_order:e,sort_by:{id:t,api_name:a}}}):i.$.triggerAction("customize_sort",{type:"PUT"},{module:moduleApiMapping[this.data.module],layout_id:this.data.layoutId},void 0,{related_list:{sort_order:e,sort_by:{id:t,api_name:a}}})}.bind(this),0)},pushRecordToModule:function(e){e&&e.length&&"Competitors"!=this.getData("relatedList").api_name&&Lyte.arrayUtils(this.data.relatedListData,"push",store.pushPayload(moduleRecordMapping[this.getData("relatedModule")].id,e)),"Competitors"==this.getData("relatedList").api_name&&Lyte.arrayUtils(this.data.relatedListData,"push",e),this.setRelatedListData(!0,!0)},getMultiSelectValues:function(e){var t=this;this.getData("recordGet")&&this.getData("mxnFieldRecordId").length>0&&app.store.makeRequest("findAll",moduleRecordMapping[t.data.relatedModule].id,{ids:this.getData("mxnFieldRecordId").join(",")}).then((function(){Lyte.arrayUtils(t.data.relatedListData,"push",store.pushPayload(t.getData("relatedList").module.id,e)),t.setRelatedListData(!0,!0),t.setData("showNoRecords",!1),t.setData("showLoading",!1)}),(function(){t.permissionDenyMsg(t)}))},setRelatedListData:function(e,t){this.setData("startIndex",10*(this.data.pageNo-1)),this.getData("relatedListData").length&&this.setData("tableData",this.getData("relatedListData").slice(this.getData("startIndex"),this.getData("startIndex")+10)),e&&(Lyte.triggerEvent("relatedListCount",{id:this.data.relatedList.id,api_name:this.data.relatedList.api_name,count:this.getData("relatedListData").length,format:"table",more_records:this.getData("relatedListData").length>10*this.data.pageNo,page:this.data.pageNo}),populateRLCount&&t&&(this.getData("relatedListData").length>10*this.data.pageNo?this.setData("relatedListCount",10*this.data.pageNo+"+"):this.setData("relatedListCount",this.getData("relatedListData").length),populateRLCount(this.data.relatedList.id))),"Attachments"==this.data.relatedList.api_name&&this.resolveThumbnailRequest()},constructFields:function(){"Price_Books"==this.data.relatedList.api_name&&Lyte.arrayUtils(this.getData("relatedListFields"),"push",{field_label:I18n.getMsg("List Price"),api_name:"list_price",ui_type:1,yieldName:"list-price"});var e=this.getData("fieldUiType"),t=this.getData("relatedListFields"),a=this.getData("moduleInfo"),i={};a&&(a.module_name.indexOf("CustomModule")>-1||a.module_name.indexOf("LinkingModule")>-1)&&(this.getData("displayField")[a.module_name]=["Name"]);var o=this.getData("displayField")[this.data.relatedModule]?this.getData("displayField")[this.data.relatedModule]:[],s=t.length,l=[],n=o.length,r=[];"Campaigns"===this.data.relatedModule&&store.peekAll("campaign_status").forEach((function(e){r.push({actual_value:e.name,display_value:e.name,id:e.id})}));for(var d=0;d<s;d++)if("Prediction_Score"!=t[d].api_name&&"Deal_Id"!=t[d].api_name){if("Campaigns"==this.data.relatedModule&&2==t[d].ui_type){var p=store.peekRecord("field",t[d].id);t[d].pick_list_values=p?p.pick_list_values:"Member_Status"===t[d].api_name?r:store.findRecord("field",t[d].id,{module:"Campaigns"}).then((function(e){return e[0].pick_list_values}))}"Full_Name"==t[d].api_name&&(t[d].field_label=I18n.getMsg("custommodule.crmfield.fl.name",a?a.singular_label:"")),"multiselectlookup"==this.data.relatedList.type&&(t[d].api_name.split(".").length>1&&(t[d].yieldName="multiselect"),"Name"==t[d].api_name&&(t[d].yieldName="lookup"));for(var c=0;c<n;c++)(o[c]==t[d].api_name||this.getData("uiTypeLookup")[t[d].ui_type]||o[c]==t[d].api_name.split(".")[1])&&(t[d].api_name.split(".").length>1?t[d].yieldName="multiselect-lookup":t[d].yieldName="lookup");t[d].lookup&&Object.keys(t[d].lookup).length&&(t[d].data_type="lookup"),116==t[d].ui_type&&t[d].formula_return_type&&(t[d].formula={return_type:t[d].formula_return_type}),132==t[d].ui_type&&(t[d].yieldName="multi_module_lookup"),2!==t[d].ui_type&&"2"!==t[d].ui_type||!a||"Activities"!==a.api_name&&"Events"!==a.api_name||(t[d].yieldName="picklist"),999==t[d].ui_type&&(t[d].yieldName="terriority"),"Start_DateTime"==t[d].api_name&&"Invited_Events"==this.data.relatedList.api_name&&(t[d].yieldName="event-date"),"Invited_Events"==this.data.relatedList.api_name&&"Status"==t[d].api_name&&(t[d].yieldName="participant-status"),a&&"Campaigns"==a.api_name&&"Member_Status"==t[d].api_name&&(t[d].yieldName="member-status",t[d].api_name="$member_info.Member_Status",1==t[d].ui_type&&(t[d].ui_type="2",t[d].pick_list_values=r)),"Contact_Roles"==this.data.relatedList.api_name&&"Role"==t[d].api_name&&(t[d].yieldName="contact-role"),t[d].cxPropClass=this.getClassForLVData(t[d]),(!this.data.relatedList.customize_sort||96==t[d].ui_type||"Appointment_For"==t[d].api_name||t[d].ui_type==CrmFieldConstants.TEXTAREA||t[d].ui_type==CrmFieldConstants.TERRITORY||t[d].ui_type==CrmFieldConstants.LAYOUT||t[d].ui_type==CrmFieldConstants.TEXTAREA1||t[d].ui_type==CrmFieldConstants.TEXT||t[d].ui_type==CrmFieldConstants.TAGS||t[d].crypt||"Visits"==this.getData("module")&&"SEID"==t[d].column_name)&&(t[d].cxPropClass="cursorDefault"),t[d].cxPropZcqaSelector="Detail_"+this.data.relatedList.api_name+"_"+t[d].id,i[t[d].api_name]=e[t[d].ui_type],l.push(t[d])}this.setData("fieldMapping",i),this.setData("customfields",l)},getClassForLVData:function(e){var t=e.ui_type;return"SMOWNERID"===e.column_name||"SMCREATORID"===e.column_name||"MODIFIEDBY"===e.column_name?"lv_data_textfield lv_data_username":36==t||77==t||116==t&&"currency"==e.data_type?"lv_data_currency alignright":25==t?"lv_data_email":127==t||1==t||4==t||133==t||9==t||5==t||13==t?"lv_data_textfield":33==t||6==t||7==t||35==t||124==t||200==t?"lv_data_phone":32==t||38==t||52==t||333==t||786==t||14==t||24==t?"lv_data_number":3==t?"lv_data_desc":"lv_data_textfield"},viewAttachments:function(e,t){event.stopPropagation();var a=this;if("png"==e.extn){var i={currentId:e.id,selector:t,downloadImage:!0,fileName:!0,zoom:!0};this.resolveThumbnailRequest().then((function(o){var s=[];a.data.tableData.forEach((function(e){"png"==e.extn&&s.push({downloadUrl:e.$download_url,original_src:e.$previewUrl,fileId:e.$file_id,filename:e.File_Name,src:o[e.id].url,uploadid:e.id,extn:"."+e.File_Name.substring(e.File_Name.lastIndexOf(".")+1,e.File_Name.length)})})),Lyte.Component.render("crm-image-preview",{imageData:s,isEditable:"false",previewConfiguration:i,id:"attachmentpreview"},"body");var l=$L("crm-image-preview#attachmentpreview")[0];l.setMethods({onClose:function(){l.remove()}});var n="realtedListImageFileName"==t?a.$node.querySelector("#attach_"+e.id):document.querySelector("#viewAttach_"+e.id);$L(l).find(".imagePreviewTest")[0].launch(n),commonUtils.showHideLoadingDiv(!1)}))}else e.$previewUrl?"workdrive_link"==e.$internal_type?open(e.$previewUrl):openSheetForExport(e.$previewUrl,"pdf"==e.extn&&"pdfViewPlugin"):open(e.$link_url)},editLinkAttachments:function(e){var t=networkUtils.returnDependencyFiles(["editlinkurl.js"],crmConstants.jsStaticPathForLyte),a=networkUtils.returnDependencyFiles(["mailmerge.css"],crmConstants.cssStaticPathForLyte),i=t.concat(a);Lyte.injectResources(i,void 0,(function(){Lyte.Component.render("crm-linkattachment",{linkUrl:e.$link_url,filename:e.File_Name,module:e.$se_module,record:e.Parent_Id.id,header:I18n.getMsg("crm.customlink.editlink"),method:"edit",isEdit:!0,attachmentId:e.id},"#show"),document.getElementById("showLinkUrlPop").ltProp("show",!0)}))},downloadAttachments:function(e){var t=document.createElement("a");t.style="display: none",this.$node.appendChild(t),t.href=e.$download_url,t.download=e.File_Name,t.click(),t.remove()},resolveThumbnailRequest:function(){var e=this;return this.data.tableData.forEach((function(t){"png"==t.extn&&(e.idVsURL[t.id]||(e.idVsURL[t.id]=e.constructSizeMinimizedImage(t.$previewUrl)))})),Lyte.resolvePromises(e.idVsURL)},openColumnList:function(){if(commonUtils.showHideLoadingDiv(),$L("crm-detail-view-common")[0].component.openColumnList(this,this.refreshColumnList),!crmRelatedList.isNotActivitySubPersonality(this.data.relatedList.personality_name,"Services"===Lyte.Router.getRouteInstance().parent.parent.getDynamicParam()||void 0)){var e=0;$L("crux-column-list")[0].component.getSelectedFields().each((function(t){!0===t.mandatory&&(e+=1)})),crmRelatedList.mandFields[this.data.relatedList.personality_name]=e}delete this.refreshColumnList},saveColumnList:function(e,t){var a,i=this.data.relatedList,o=1;i.fields.forEach((function(t){a=!1,e.forEach((function(e){t.id==e.id&&(a=!0)})),("Campaigns"==i.api_name&&"$member_info.Member_Status"==t.api_name||"Price_Books"==i.api_name&&"list_price"==t.api_name)&&(a=!0),a||e.push({id:t.id,api_name:t.api_name,_delete:null})})),e.forEach((function(e){e._delete||(e.sequence_number=o++)})),i.$.set("fields",e);var s=this;i.$.save(void 0,{module:moduleApiMapping[this.data.module],layout_id:this.data.layoutId}).then((function(){s.setData("pageNo",1),s.setData("relatedListData",[]),s.setData("startIndex",0),s.setData("pageRequested",[]),s.setData("showCountDiv",!1),s.setData("campaignFilter",!1),document.querySelectorAll(s.refreshId).forEach((function(e){e.classList.remove("eventNone")})),s.campaignFilter=void 0,s.setData("relatedListFields",e),s.fireRequest(s,void 0,void 0,!0),t.hidePopover()}),(function(){renderingUtils.displayPermissionDenied()}))},getColumnListData:function(e){if("multiselectlookup"==this.data.relatedList.type){var t=moduleRecordMapping[this.data.relatedList.linkingmodule],a=Lyte.deepCopyObject(moduleRecordMapping[this.data.relatedModule].fields),i=store.peekRecord("field",this.data.relatedList.mxnfield).api_name;if(a.forEach((function(e){e.api_name=i+"."+e.api_name})),moduleRecordMapping[this.data.relatedList.linkingmodule].visibility%2!=0){var o=Lyte.deepCopyObject(t.fields);return o.forEach((function(e){e.field_label=e.field_label+" ("+t.plural_label+")","Name"==e.api_name&&(e.mandatory=!0)})),a.concat(o)}return a}if("picklist_tracker"==this.data.relatedList.action){var s=this.data.moduleInfo.parent_module.fields.filter((function(e){return e.history_tracking})),l=[];return s=s.length?s[0]:void 0,e.forEach((function(e){("NAME"==e.column_name||s&&e.api_name==s.history_tracking.duration_configured_field.api_name)&&(e.mandatory=!0),"LINKINGMXN1"!=e.column_name&&"POTENTIALID"!=e.column_name&&"LASTACTIVITYTIME"!=e.column_name&&l.push(e)})),l}for(var n=e.length,r=[],d=0;d<n;d++)"BEST_TIME"==e[d].column_name||"Visits"==this.data.relatedModule&&"SEID"==e[d].column_name||"Appointments"==this.data.relatedModule&&"RESCHEDULECOUNT"==e[d].column_name||r.push(e[d]);return r},refreshHeader:function(){var e=this;store.findRecord("related_list",e.data.relatedList.id,{module:moduleApiMapping[e.data.module],layout_id:e.data.layoutId,include_inner_details:"fields.ui_type,fields.lookup,fields.formula,fields.field_label,fields.pick_list_values,fields.separator"}).then((function(t){e.setData("relatedListFields",t[0].fields),e.sorted=!1,t[0].sort_by&&(e.sorted=!0,e.setData("sort_by",t[0].sort_by.api_name),e.setData("sort_order",t[0].sort_order)),e.constructFields()}))}},{mixins:["crm-detail-view-utils","crm-view-utils","crm-image-mixin"]}),Lyte.Component.registerHelper("pageSelectedRecords",(function(e,t){for(var a=t.length,i=0;i<a;i++)if(-1==e.indexOf(t[i].id))return!1;return!0})),Lyte.Component.registerHelper("getMultiSelectRecord",(function(e,t,a){var i=t.split(".");return i.length>1?e[i[0]]?e[i[0]][i[1]]:void 0:a.mxnfield?e[store.peekRecord("field",a.mxnfield).multiselectlookup.connectedlookup_apiname]?e[store.peekRecord("field",a.mxnfield).multiselectlookup.connectedlookup_apiname][t]:void 0:e[t]})),Lyte.Component.registerHelper("showLookup",(function(e,t,a){return!!t&&("multiselectlookup"==a.type?!(!e.split(".")[1]||!t.contains(e.split(".")[1])):t.contains(e))})),Lyte.Component.registerHelper("getContactRole",(function(e,t){if(e&&t&&t.length){var a=t.filter((function(t){return t.id==e}));if(a.length)return a[0].display_value}return""})),Lyte.Component.registerHelper("getInvitedEventStatus",(function(e,t){var a;if(e.$send_notification)switch(e.Participants.filter((function(e){return e.participant==t.id}))[0].status){case"yes":a='<em class="greenDisc vmiddle mR5 mT0"></em>'+I18n.getMsg("crm.event.participants.accepted");break;case"no":a='<em class="redDisc vmiddle mR5 mT0"></em>'+I18n.getMsg("crm.label.event.invitation.decline");break;case"maybe":a='<em class="orangeDisc vmiddle mR5 mT0"></em>'+I18n.getMsg("crm.label.event.invitation.may.be");break;case"not_known":a='<em class="noreplyDisc vmiddle mR5 mT0"></em>'+I18n.getMsg("crm.label.event.invitation.sent")}else a='<em class="noreplyDisc vmiddle mR5 mT0"></em>'+I18n.getMsg("crm.label.event.invitation.not.sent");return a})),Lyte.Component.registerHelper("isRecordApproved",(function(e,t){return"multiselectlookup"===t.type&&(e=e[store.peekRecord("field",t.mxnfield).multiselectlookup.connectedlookup_apiname]),null==e.$approval||!(0==e.$approved&&0==e.$approval.resubmit||!(e.$approval.resubmit||e.$approved||e.$review)||e.$stop_processing||"Rejected"==e.$review)})),Lyte.Component.registerHelper("getInvitedEventDate",(function(e){var t=e.Start_DateTime;if((l=e.End_DateTime)&&l.match("T")){l=l.replace(/[+-]\d{2}:\d{2}/,"");var a=new Date(l),i=(l=l.split("T"))[1]?l[1].split(":"):"";i&&(a.setHours(i[0]),a.setMinutes(i[1]));var o=Utils.getDateTimeInUserFormat(a,!0),s=o.slice(0,3);l=o.replace(s,I18n.getMsg(s))}var l,n=Crm.userDetails.DATE_PATTERN.toUpperCase(),r=Crm.userDetails.TIME_FORMAT;return(t.indexOf("AM")>1||t.indexOf("PM")>1)&&(r=r.replace("a","A")),n+=" "+r,t=$L.moment(t,n).getDObj(),l=$L.moment(l,n).getDObj(),t.getFullYear()==l.getFullYear()?t.getMonth()==l.getMonth()&&t.getDate()==l.getDate()?t.getFullYear()!=(new Date).getFullYear()?(t=Utils.convertDateToGivenPattern("DD, M dd yy",t)+" "+Utils.getTimeInUserFormat(t,!0))+" - "+(l=Utils.getTimeInUserFormat(l,!0)):(t=Utils.convertDateToGivenPattern("DD, M dd",t)+" "+Utils.getTimeInUserFormat(t,!0))+" - "+(l=Utils.getTimeInUserFormat(l,!0)):t.getFullYear()!=(new Date).getFullYear()?(t=Utils.convertDateToGivenPattern("DD, M dd yy",t)+" "+Utils.getTimeInUserFormat(t,!0),l=Utils.convertDateToGivenPattern("DD, M dd yy",l)+" "+Utils.getTimeInUserFormat(l,!0),t+" "+I18n.getMsg("crm.label.until")+" "+l):(t=Utils.convertDateToGivenPattern("DD, M dd",t)+" "+Utils.getTimeInUserFormat(t,!0),l=Utils.convertDateToGivenPattern("DD, M dd",l)+" "+Utils.getTimeInUserFormat(l,!0),t+" "+I18n.getMsg("crm.label.until")+" "+l):(t=Utils.convertDateToGivenPattern("DD, M dd yy",t)+" "+Utils.getTimeInUserFormat(t,!0),l=Utils.convertDateToGivenPattern("DD, M dd yy",l)+" "+Utils.getTimeInUserFormat(l,!0),t+" "+I18n.getMsg("crm.label.until")+" "+l)})),Lyte.Component.registerHelper("showEdit",(function(){return void 0!==Crm.userDetails.permissions.Crm_Implied_Create_Attachments&&!0===Crm.userDetails.permissions.Crm_Implied_Create_Attachments?"":"dN"}));
