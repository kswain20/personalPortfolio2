!function(){var e=Handlebars.template,t=Handlebars.templates=Handlebars.templates||{};t.CalendarMonthFilter=e({1:function(e,t,a,i,r){var l=e.escapeExpression,n=null!=t?t:{};return' <option class="month_'+l(e.lambda(t,t))+'" value="'+l(a.increment.call(n,r&&r.index,1,{name:"increment",hash:{},data:r}))+'">'+l(a.getI18n.call(n,t,{name:"getI18n",hash:{},data:r}))+"</option> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l;return' <select id="calendarMonthid" onchange="CrmIntelligence.calendarUpd(this,event,0,undefined,1)"> '+(null!=(l=a.each.call(null!=t?t:{},null!=t?t.months:t,{name:"each",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?l:"")+" </select>"},useData:!0}),t.CalendarYearFilter=e({1:function(e,t,a,i,r){var l=e.lambda,n=e.escapeExpression;return' <option class="year_'+n(l(t,t))+'">'+n(l(t,t))+"</option> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l;return' <select id="calendarYearid" onchange="CrmIntelligence.calendarUpd(this,event,1,undefined,1)"> '+(null!=(l=a.each.call(null!=t?t:{},null!=t?t.years:t,{name:"each",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?l:"")+" </select>"},useData:!0}),t.CrmTemplateOpenRateAfterModification=e({1:function(e,t,a,i,r){var l,n=e.lambda,s=e.escapeExpression,o=null!=t?t:{};return' <div class="crm-font-regular dIB w100p thirdTabMobTrDetail"> <div class="thirdTabModColDetail"> <div id="templateSubColTab_'+s(n(r&&r.index,t))+'" class="thirdTabSubCol fL thirdSubBack templateSubColTabWidth"> <div class="fL cB thirdTabModText crm-font-regular">'+s(n(null!=t?t.Name1:t,t))+'</div> <div class="fL cB thirdTabModNum">'+s(n(null!=t?t.bCount1:t,t))+" "+(null!=(l=a.if_nq.call(o,r&&r.index,"0",{name:"if_nq",hash:{},fn:e.program(2,r,0),inverse:e.noop,data:r}))?l:"")+" </div> </div> "+(null!=(l=a.ifCondLogic.call(o,r&&r.index,"!=","0","&&",r&&r.index,"!=","3",{name:"ifCondLogic",hash:{},fn:e.program(4,r,0),inverse:e.noop,data:r}))?l:"")+' </div> <div class="thirdTabModColDetail"> <div id="templateSubColTabSecond_'+s(n(r&&r.index,t))+'" class="thirdTabSubCol thirdSubBack fL templateSubColTabSecondWidth"> '+(null!=(l=a.ifCondLogic.call(o,r&&r.index,"==","2","&&",null!=t?t.bCount1:t,"!=",null!=t?t.aCount1:t,{name:"ifCondLogic",hash:{},fn:e.program(6,r,0),inverse:e.noop,data:r}))?l:"")+' <div class="fL cB thirdTabModText crm-font-regular  ">'+s(n(null!=t?t.Name1:t,t))+" "+(null!=(l=a.ifCondLogic.call(o,r&&r.index,"==","2","&&",null!=t?t.bCount1:t,"!=",null!=t?t.aCount1:t,{name:"ifCondLogic",hash:{},fn:e.program(8,r,0),inverse:e.noop,data:r}))?l:"")+' </div> <div class="fL cB thirdTabModNum">'+s(n(null!=t?t.aCount1:t,t))+" "+(null!=(l=a.if_nq.call(o,r&&r.index,"0",{name:"if_nq",hash:{},fn:e.program(17,r,0),inverse:e.noop,data:r}))?l:"")+"</div> </div> "+(null!=(l=a.ifCondLogic.call(o,r&&r.index,"!=","0","&&",r&&r.index,"!=","3",{name:"ifCondLogic",hash:{},fn:e.program(19,r,0),inverse:e.noop,data:r}))?l:"")+" </div> </div> "},2:function(e,t,a,i,r){return'<span class="crm-font-regular">('+e.escapeExpression(e.lambda(null!=t?t.bPer1:t,t))+"%)</span>"},4:function(e,t,a,i,r){var l=e.lambda,n=e.escapeExpression;return' <div class="thirdTabSubCol thirdTabSubColNeg fL"> <div class="fL cB thirdTabModText crm-font-regular">'+n(l(null!=t?t.Name2:t,t))+'</div><div class="fL cB thirdTabModNum">'+n(l(null!=t?t.bCount2:t,t))+'<span class="crm-font-regular"> ('+n(l(null!=t?t.bPer2:t,t))+"%)</span></div> </div> "},6:function(e,t,a,i,r){return'<div class="pA forbgYellow"></div>'},8:function(e,t,a,i,r){var l,n=null!=t?t:{};return'<span class="crm-font-bold '+(null!=(l=a.if.call(n,null!=t?t.IsDropped:t,{name:"if",hash:{},fn:e.program(9,r,0),inverse:e.program(11,r,0),data:r}))?l:"")+' mL5">'+e.escapeExpression(e.lambda(null!=t?t.Per:t,t))+'%</span><span class="'+(null!=(l=a.if.call(n,null!=t?t.IsDropped:t,{name:"if",hash:{},fn:e.program(13,r,0),inverse:e.program(15,r,0),data:r}))?l:"")+'"></span> '},9:function(e,t,a,i,r){return"downvoteText "},11:function(e,t,a,i,r){return" upvoteText "},13:function(e,t,a,i,r){return" downVote downClass "},15:function(e,t,a,i,r){return" upVote downClass "},17:function(e,t,a,i,r){return'<span class="crm-font-regular"> ('+e.escapeExpression(e.lambda(null!=t?t.aPer1:t,t))+"%)</span>"},19:function(e,t,a,i,r){var l=e.lambda,n=e.escapeExpression;return' <div class="thirdTabSubCol thirdTabSubColNeg fL"> <div class="fL cB thirdTabModText crm-font-regular">'+n(l(null!=t?t.Name2:t,t))+'</div><div class="fL cB thirdTabModNum">'+n(l(null!=t?t.aCount2:t,t))+' <span class="crm-font-regular">('+n(l(null!=t?t.aPer2:t,t))+"%)</span></div> </div> "},21:function(e,t,a,i,r){var l,n=null!=t?t:{},s=e.escapeExpression,o=e.lambda;return' <div id="templateSubjectDiv"> <div class="criteriaFirstPart  pT10 pB0 "> <div class="creditContentFirstSecDet crm-font-regular fL cB">'+s(a.getI18n.call(n,"crm.wf.di.nofication.template.subject",{name:"getI18n",hash:{},data:r}))+": <span>"+s(o(null!=(l=null!=(l=null!=t?t.Result:t)?l.Template_update:l)?l.old_subject:l,t))+'</span></div> </div> <div class="criteriaSecondPart pT10 pB0 "> <div class="creditContentFirstSecDet crm-font-regular fL cB">'+s(a.getI18n.call(n,"crm.wf.di.nofication.template.subject",{name:"getI18n",hash:{},data:r}))+": <span>"+s(o(null!=(l=null!=(l=null!=t?t.Result:t)?l.Template_update:l)?l.subject:l,t))+"</span></div> </div> </div> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l,n=null!=t?t:{},s=e.escapeExpression;return'<div id="diNotificationDetailCase3"> <div class="dIB w100p mB15"><div class="crm-font-bold secondititle dIB" id="dIchartTitle">'+s(a.getI18n.call(n,"crm.wf.di.usage.effects.on.modification.heading",null!=(l=null!=t?t.Result:t)?l.TemplateName:l,null!=t?t.DroppedOrIncreased:t,null!=(l=null!=(l=null!=t?t.Data:t)?l[2]:l)?l.Per:l,null!=(l=null!=t?t.Result:t)?l.WFOrTemplate:l,{name:"getI18n",hash:{},data:r}))+'</div> <div class="crm-font-regular secNotTitDate">'+s(a.getI18n.call(n,"crm.wf.di.modified.by.wf.rule",null!=(l=null!=t?t.Result:t)?l.ModifiedBy:l,null!=t?t.ModifiedOn:t,{name:"getI18n",hash:{},data:r}))+'</div></div> <div class="crm-font-regular dIB thirdModificationDifTable" style="background-color:#fff"> <div class="crm-font-regular dIB w100p thirdTabModHead"> <div class="crm-font-regular thirdModTitTab">'+s(a.getI18n.call(n,"crm.wf.di.before.modification",{name:"getI18n",hash:{},data:r}))+'</div> <div class="crm-font-regular thirdModTitTab">'+s(a.getI18n.call(n,"crm.wf.di.after.modification",{name:"getI18n",hash:{},data:r}))+'</div> </div>  <div class="thirdTabMobBodyDetailed  crm-font-regular w100p"> '+(null!=(l=a.each.call(n,null!=t?t.Data:t,{name:"each",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?l:"")+" </div> "+(null!=(l=a.if.call(n,null!=(l=null!=t?t.Result:t)?l.Template_update:l,{name:"if",hash:{},fn:e.program(21,r,0),inverse:e.noop,data:r}))?l:"")+' <div id="diNotificationDetailsCase2CriteriaDetails"></div> </div>  </div>'},useData:!0}),t.CrmWFUsageAfterModification=e({1:function(e,t,a,i,r){return" downvoteText "},3:function(e,t,a,i,r){return" upvoteText "},5:function(e,t,a,i,r){return" downVote downClass "},7:function(e,t,a,i,r){return" upVote downClass "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l,n=null!=t?t:{},s=e.escapeExpression;return'<div id="diNotificationDetailsCase2"> <div class="mB15 dIB"> <div class="crm-font-bold secondititle dIB" id="dIchartTitle"> '+s(a.getI18n.call(n,"crm.wf.di.usage.effects.on.modification.wf.usage.heading",null!=(l=null!=t?t.Data:t)?l.LessUsgePercentage:l,null!=t?t.DroppedOrIncreased:t,a.getDisplayModuleName.call(n,null!=(l=null!=t?t.Data:t)?l.Module:l,!1,{name:"getDisplayModuleName",hash:{},data:r}),null!=(l=null!=t?t.Data:t)?l.RuleName:l,{name:"getI18n",hash:{},data:r}))+'</div></div> <div class="secNotFirstPart"> <div class="secNotFirstTit dIB crm-font-regular"><span class="crm-font-regular w100p pL0 thirdModTitTab">'+s(a.getI18n.call(n,"crm.wf.di.before.modification",{name:"getI18n",hash:{},data:r}))+'</span></div> <div class="crm-font-regular secNotTitDate mB5 vH">&npsb;</div> <div class="crm-font-regular secNotCont pT10">'+s(a.getI18n.call(n,"crm.wf.di.processed.modules",a.getDisplayModuleName.call(n,null!=(l=null!=t?t.Data:t)?l.Module:l,!1,{name:"getDisplayModuleName",hash:{},data:r}),null!=(l=null!=t?t.Data:t)?l.UsageBeforeModified:l,{name:"getI18n",hash:{},data:r}))+'</div> </div> <div class="secNotSecPart"> <div class="secNotFirstTit dIB crm-font-regular"> <span class="crm-font-regular pL0 w100p thirdModTitTab">'+s(a.getI18n.call(n,"crm.wf.di.after.modification",{name:"getI18n",hash:{},data:r}))+'</span></div> <div class="crm-font-regular secNotTitDate mB5">'+s(a.getI18n.call(n,"crm.wf.di.modified.by.wf.rule",null!=(l=null!=t?t.Data:t)?l.ModifiedBy:l,null!=t?t.ModifiedOn:t,{name:"getI18n",hash:{},data:r}))+'</div> <div class="crm-font-regular secNotCont pT10">'+s(a.getI18n.call(n,"crm.wf.di.processed.modules",a.getDisplayModuleName.call(n,null!=(l=null!=t?t.Data:t)?l.Module:l,!1,{name:"getDisplayModuleName",hash:{},data:r}),null!=(l=null!=t?t.Data:t)?l.UsageAfterModified:l,{name:"getI18n",hash:{},data:r}))+' <span class="crm-font-bold '+(null!=(l=a.if.call(n,null!=(l=null!=t?t.Data:t)?l.IsDropped:l,{name:"if",hash:{},fn:e.program(1,r,0),inverse:e.program(3,r,0),data:r}))?l:"")+' mL5">'+s(e.lambda(null!=(l=null!=t?t.Data:t)?l.LessUsgePercentage:l,t))+'%</span><span class="'+(null!=(l=a.if.call(n,null!=(l=null!=t?t.Data:t)?l.IsDropped:l,{name:"if",hash:{},fn:e.program(5,r,0),inverse:e.program(7,r,0),data:r}))?l:"")+'"></span></div> </div> <div id="diNotificationDetailsCase2CriteriaDetails"></div> </div>'},useData:!0}),t.CrmWFUsageDetails=e({1:function(e,t,a,i,r){var l=null!=t?t:{},n=e.escapeExpression,s=e.lambda;return' <tr> <td width="20%"> <a data-zcqa="wf_zia_workflow_list_'+n(a.encodeHTML.call(l,null!=t?t.Id:t,{name:"encodeHTML",hash:{},data:r}))+"\"  class=\"link vam cP\" target='_blank' rel='noreferrer noopener' href='"+n(a.getCrmBasePath.call(l,{name:"getCrmBasePath",hash:{},data:r}))+"/ShowSetup.do?tab=automate&subTab=workflow&step=showRule&ruleId="+n(a.encodeJS.call(l,a.encodeURL.call(l,null!=t?t.Id:t,{name:"encodeURL",hash:{},data:r}),{name:"encodeJS",hash:{},data:r}))+"'>"+n(s(null!=t?t.ProcessName:t,t))+'</a> </td> <td class="bb" width="12%">'+n(a.getI18n.call(l,null!=t?t.CreationCriteria:t,{name:"getI18n",hash:{},data:r}))+'</td> <td class="bb" width="10%">'+n(s(null!=t?t.ActionCount:t,t))+"</td> </tr> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l,n=null!=t?t:{},s=e.escapeExpression;return' <div id="diNotificationDetailCase1"> <div class="crm-font-bold  dIB dIworkflowTitle alignleft" id="dIchartTitle">'+s(a.getI18n.call(n,"crm.wf.di.usage.vs.records.body",null!=(l=null!=t?t.Data:t)?l.TotalPercentage:l,null!=(l=null!=t?t.Result:t)?l.TotalCreatedModule:l,null!=(l=null!=t?t.Data:t)?l.PluralLevelName:l,null!=(l=null!=t?t.Result:t)?l.TotalWeeks:l,{name:"getI18n",hash:{},data:r}))+'</div> <div class="leadCreatedSectionCont pR mB50"> <div class="chartC" style="height:250px;position:relative;" data-highcharts-chart="0"></div> <div class="crm-font-bold untochedDealover dIB">'+s(a.getI18n.call(n,"crm.wf.di.unused.records.counts1",null!=(l=null!=t?t.Data:t)?l.PluralLevelName:l,{name:"getI18n",hash:{},data:r}))+'<span class="crm-font-regular labellegentNum">'+s(a.arithResult.call(n,null!=(l=null!=t?t.Result:t)?l.TotalCreatedModule:l,"-",null!=(l=null!=t?t.Result:t)?l.TotalCreatedModuleTouched:l,{name:"arithResult",hash:{},data:r}))+' </span><span class="crm-font-bold labsemb mL3"> '+s(a.getI18n.call(n,"crm.wf.di.unused.records.counts3",null!=(l=null!=t?t.Result:t)?l.TotalCreatedModule:l,{name:"getI18n",hash:{},data:r}))+'</span></div> <div class="crm-font-regular untouchLDivG"> <span class="crm-font-regular mB10 fL cB">'+s(a.getI18n.call(n,"crm.wf.di.usage.executed.workflow.rule",null!=(l=null!=t?t.Data:t)?l.SingularLevelName:l,{name:"getI18n",hash:{},data:r}))+'<span class="crm-font-regular color333">'+s(a.arithResult.call(n,null!=(l=null!=t?t.Result:t)?l.TotalRuleCount:l,"-",null!=(l=null!=t?t.Result:t)?l.RuleNotUsedCount:l,{name:"arithResult",hash:{},data:r}))+' </span> </span> <span class="crm-font-regular fL cB">'+s(a.getI18n.call(n,"crm.wf.di.usage.unused.workflow.rule",{name:"getI18n",hash:{},data:r}))+' <span data-zcqa="wf_zia_unused_rule_count" class="crm-font-regular labellegentNum cP" onclick="CrmIntelligence.showWorkflowUnused(this)">'+s(e.lambda(null!=(l=null!=t?t.Result:t)?l.RuleNotUsedCount:l,t))+'</span> </span> </div> </div> </div> <div id="wfDiPoPForWorkflowRules" class="popforWorkflowAction" style="top: 214px; left: 150px; display: none;"> <div data-zcqa="wf_zia_unusedWf_open" class="jarvisClosebtn svgIcons ico-close-small2" href="javascript:void(0)" onclick="$(\'.popforWorkflowAction\').hide();$(\'.freezwhite\').hide()"></div> <div class="dIB"> <div class="f16 crm-font-bold mB5">'+s(a.getI18n.call(n,"crm.wf.di.unused.workflows.popup.heading",{name:"getI18n",hash:{},data:r}))+'</div> <table border="0" width="100%" cellspacing="0" cellpadding="0" class=" wf_newLineTable newtbHead fontSmooth" style="table-layout:fixed;margin-bottom:0px"> <tbody> <tr> <th width="20%" style="overflow:hidden;" nowrap="" class=""> <div class="pR dIB wf-list"><span class="cP"> <span class="pR10 lh22 ">'+s(a.getI18n.call(n,"crm.workflow.rule.name",{name:"getI18n",hash:{},data:r}))+'</span> </span></div> </th> <th width="12%" nowrap=""> <div class="pR dIB wf-list"><span class="cP"> <span class="pR10 lh22 ">'+s(a.getI18n.call(n,"crm.workflow.rule.label.SetTrigger",{name:"getI18n",hash:{},data:r}))+'</span> </span></div> </th> <th width="10%" style="overflow:hidden;" nowrap=""> <div class="pR dIB wf-list"><span class="cP"> <span class="pR10 lh22 ">'+s(a.getI18n.call(n,"crm.label.action",{name:"getI18n",hash:{},data:r}))+'</span> </span></div> </th> </tr> </tbody> </table> <table border="0" width="100%" cellspacing="0" cellpadding="0" class=" wf_newLineTable newtbBody  fontSmooth" style="table-layout:fixed;margin-bottom:0px"> <tbody> '+(null!=(l=a.each.call(n,null!=(l=null!=t?t.Data:t)?l.RulesDetails:l,{name:"each",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?l:"")+' </tbody> </table> </div> </div> <div data-zcqa="wf_zia_unusedWf_close" class="freezwhite" onclick="CrmIntelligence.hidePop(this)"></div>'},useData:!0}),t.DIRecordsDoesNotHaveAnyFollowup=e({1:function(e,t,a,i,r){var l=e.lambda,n=e.escapeExpression;return' <td data-sorter="false" class="mW100 tableHead "> <a id="moduleHeading_'+n(l(r&&r.index,t))+'" class=""> '+n(l(t,t))+" </a> </td> "},3:function(e,t,a,i,r,l,n){var s,o=e.lambda,d=e.escapeExpression,c=null!=t?t:{};return' <tr id="'+d(o(null!=t?t.Id:t,t))+'" data-cid="detailView" data-zcqa="detailView" class="tdout topband_dv_row"> <td data-sorter="false" class="mW100 scrollColun lv_data_textfield"> <a data-zcqa="wf_zia_record_list_'+d(a.encodeHTML.call(c,null!=t?t.Id:t,{name:"encodeHTML",hash:{},data:r}))+"\" class=\"link vam cP\" target='_blank' rel='noreferrer noopener' href='"+d(a.getCrmBasePath.call(c,{name:"getCrmBasePath",hash:{},data:r}))+"/EntityInfo.do?module="+d(a.encodeJS.call(c,null!=(s=null!=n[1]?n[1].Data:n[1])?s.Module:s,{name:"encodeJS",hash:{},data:r}))+"&id="+d(a.encodeJS.call(c,null!=t?t.Id:t,{name:"encodeJS",hash:{},data:r}))+"'>"+d(o(null!=t?t.Name:t,t))+"</a> </td> "+(null!=(s=a.ifEquals.call(c,null!=(s=null!=n[1]?n[1].Data:n[1])?s.Module:s,"Leads",{name:"ifEquals",hash:{},fn:e.program(4,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "+(null!=(s=a.ifEquals.call(c,null!=(s=null!=n[1]?n[1].Data:n[1])?s.Module:s,"Accounts",{name:"ifEquals",hash:{},fn:e.program(11,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "+(null!=(s=a.ifEquals.call(c,null!=(s=null!=n[1]?n[1].Data:n[1])?s.Module:s,"Potentials",{name:"ifEquals",hash:{},fn:e.program(18,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "+(null!=(s=a.ifEquals.call(c,null!=(s=null!=n[1]?n[1].Data:n[1])?s.Module:s,"Contacts",{name:"ifEquals",hash:{},fn:e.program(34,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" </tr> "},4:function(e,t,a,i,r,l,n){var s,o=null!=t?t:{};return" "+(null!=(s=a.if.call(o,null!=(s=null!=n[1]?n[1].HeadingAvailable:n[1])?s.b:s,{name:"if",hash:{},fn:e.program(5,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "+(null!=(s=a.if.call(o,null!=(s=null!=n[1]?n[1].HeadingAvailable:n[1])?s.c:s,{name:"if",hash:{},fn:e.program(8,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "},5:function(e,t,a,i,r){var l;return'<td data-sorter="false" class="mW100 scrollColun lv_data_textfield">'+(null!=(l=a.if.call(null!=t?t:{},null!=t?t.Company:t,{name:"if",hash:{},fn:e.program(6,r,0),inverse:e.noop,data:r}))?l:"")+"</td>"},6:function(e,t,a,i,r){return e.escapeExpression(e.lambda(null!=t?t.Company:t,t))+" "},8:function(e,t,a,i,r){var l;return'<td data-sorter="false" class="mW100 scrollColun lv_data_email"> '+(null!=(l=a.if.call(null!=t?t:{},null!=t?t.Email:t,{name:"if",hash:{},fn:e.program(9,r,0),inverse:e.noop,data:r}))?l:"")+" </td>"},9:function(e,t,a,i,r){var l=e.lambda,n=e.escapeExpression;return'<a data-cid="dummy" data-zcqa="dummy" class="link" href="mailto:'+n(l(null!=t?t.Email:t,t))+'" >'+n(l(null!=t?t.Email:t,t))+"</a> "},11:function(e,t,a,i,r,l,n){var s,o=null!=t?t:{};return" "+(null!=(s=a.if.call(o,null!=(s=null!=n[1]?n[1].HeadingAvailable:n[1])?s.b:s,{name:"if",hash:{},fn:e.program(12,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "+(null!=(s=a.if.call(o,null!=(s=null!=n[1]?n[1].HeadingAvailable:n[1])?s.c:s,{name:"if",hash:{},fn:e.program(15,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "},12:function(e,t,a,i,r){var l;return'<td data-sorter="false" class="mW100 scrollColun lv_data_textfield"> '+(null!=(l=a.if.call(null!=t?t:{},null!=t?t.Phone:t,{name:"if",hash:{},fn:e.program(13,r,0),inverse:e.noop,data:r}))?l:"")+"</td>"},13:function(e,t,a,i,r){return'<div class="phoneRtl" style="min-width:100%"> '+e.escapeExpression(e.lambda(null!=t?t.Phone:t,t))+" </div> "},15:function(e,t,a,i,r){var l;return'<td data-sorter="false" class="mW100 scrollColun lv_data_email">'+(null!=(l=a.if.call(null!=t?t:{},null!=t?t.Website:t,{name:"if",hash:{},fn:e.program(16,r,0),inverse:e.noop,data:r}))?l:"")+"</td>"},16:function(e,t,a,i,r){var l=e.escapeExpression,n=e.lambda;return' <a data-zcqa="wf_zia_record_list_'+l(a.encodeHTML.call(null!=t?t:{},null!=t?t.WebsiteURL:t,{name:"encodeHTML",hash:{},data:r}))+'" data-cid="dummy" class="link" href="'+l(n(null!=t?t.WebsiteURL:t,t))+'" target="_blank" > '+l(n(null!=t?t.Website:t,t))+" </a> "},18:function(e,t,a,i,r,l,n){var s,o=null!=t?t:{};return" "+(null!=(s=a.if.call(o,null!=(s=null!=n[1]?n[1].HeadingAvailable:n[1])?s.b:s,{name:"if",hash:{},fn:e.program(19,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "+(null!=(s=a.if.call(o,null!=(s=null!=n[1]?n[1].HeadingAvailable:n[1])?s.c:s,{name:"if",hash:{},fn:e.program(22,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "+(null!=(s=a.if.call(o,null!=(s=null!=n[1]?n[1].HeadingAvailable:n[1])?s.d:s,{name:"if",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "+(null!=(s=a.if.call(o,null!=(s=null!=n[1]?n[1].HeadingAvailable:n[1])?s.e:s,{name:"if",hash:{},fn:e.program(28,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "+(null!=(s=a.if.call(o,null!=(s=null!=n[1]?n[1].HeadingAvailable:n[1])?s.f:s,{name:"if",hash:{},fn:e.program(31,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "},19:function(e,t,a,i,r){var l;return' <td data-sorter="false" class="mW100 scrollColun lv_data_textfield"> '+(null!=(l=a.if.call(null!=t?t:{},null!=t?t.Amount:t,{name:"if",hash:{},fn:e.program(20,r,0),inverse:e.noop,data:r}))?l:"")+" </td>"},20:function(e,t,a,i,r){return e.escapeExpression(e.lambda(null!=t?t.Amount:t,t))},22:function(e,t,a,i,r){var l;return' <td data-sorter="false" class="mW100 scrollColun lv_data_email">'+(null!=(l=a.if.call(null!=t?t:{},null!=t?t.Stage:t,{name:"if",hash:{},fn:e.program(23,r,0),inverse:e.noop,data:r}))?l:"")+"</td>"},23:function(e,t,a,i,r){return" "+e.escapeExpression(e.lambda(null!=t?t.Stage:t,t))+" "},25:function(e,t,a,i,r){var l;return' <td data-sorter="false" class="mW100 scrollColun lv_data_textfield"> '+(null!=(l=a.if.call(null!=t?t:{},null!=t?t.ClosingDate:t,{name:"if",hash:{},fn:e.program(26,r,0),inverse:e.noop,data:r}))?l:"")+" </td>"},26:function(e,t,a,i,r){return" "+e.escapeExpression(e.lambda(null!=t?t.ClosingDate:t,t))},28:function(e,t,a,i,r){var l;return' <td data-sorter="false" class="mW100 scrollColun lv_data_textfield"> '+(null!=(l=a.if.call(null!=t?t:{},null!=t?t.AccountName:t,{name:"if",hash:{},fn:e.program(29,r,0),inverse:e.noop,data:r}))?l:"")+" </td>"},29:function(e,t,a,i,r){return" "+e.escapeExpression(e.lambda(null!=t?t.AccountName:t,t))+" "},31:function(e,t,a,i,r){var l;return' <td data-sorter="false" class="mW100 scrollColun lv_data_textfield"> '+(null!=(l=a.if.call(null!=t?t:{},null!=t?t.ContactName:t,{name:"if",hash:{},fn:e.program(32,r,0),inverse:e.noop,data:r}))?l:"")+" </td>"},32:function(e,t,a,i,r){return" "+e.escapeExpression(e.lambda(null!=t?t.ContactName:t,t))},34:function(e,t,a,i,r,l,n){var s,o=null!=t?t:{};return" "+(null!=(s=a.if.call(o,null!=(s=null!=n[1]?n[1].HeadingAvailable:n[1])?s.b:s,{name:"if",hash:{},fn:e.program(35,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "+(null!=(s=a.if.call(o,null!=(s=null!=n[1]?n[1].HeadingAvailable:n[1])?s.c:s,{name:"if",hash:{},fn:e.program(12,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "+(null!=(s=a.if.call(o,null!=(s=null!=n[1]?n[1].HeadingAvailable:n[1])?s.d:s,{name:"if",hash:{},fn:e.program(37,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "},35:function(e,t,a,i,r){var l;return'<td data-sorter="false" class="mW100 scrollColun lv_data_email">'+(null!=(l=a.if.call(null!=t?t:{},null!=t?t.Email:t,{name:"if",hash:{},fn:e.program(9,r,0),inverse:e.noop,data:r}))?l:"")+"</td>"},37:function(e,t,a,i,r){var l;return'<td data-sorter="false" class="mW100 scrollColun lv_data_textfield"> '+(null!=(l=a.if.call(null!=t?t:{},null!=t?t.AccountName:t,{name:"if",hash:{},fn:e.program(29,r,0),inverse:e.noop,data:r}))?l:"")+" </td>"},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r,l,n){var s,o=null!=t?t:{};return' <div id="diNotificationDetailsCase4"> <div class="unTouchedRecordsTableView  w100p  pB20" > <div class="f14 dIB mB10 w100p crm-font-bold">'+e.escapeExpression(e.lambda(null!=t?t.Heading:t,t))+'</div> <table border="0" cellpadding="0" cellspacing="0" data-zcqa="listViewTable" id="listViewTable" class="listview" width="100%" onselectstart="return false;"> <thead> <tr class="tableHeadBg tableHeaderBg" id="listviewHeaderRow"> '+(null!=(s=a.each.call(o,null!=t?t.HeadingVsI18n:t,{name:"each",hash:{},fn:e.program(1,r,0,l,n),inverse:e.noop,data:r}))?s:"")+' </tr> </thead> <tbody id="lvTred"> '+(null!=(s=a.each.call(o,null!=(s=null!=t?t.Data:t)?s.UntouchedRecords:s,{name:"each",hash:{},fn:e.program(3,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" </tbody> </table> </div> </div>"},useData:!0,useDepths:!0}),t.NotificationRenderSummary=e({1:function(e,t,a,i,r){var l,n=e.lambda,s=e.escapeExpression;return' <div class="notificationSummaryDateWise" id="notificationContainer" data-zcqa="notSummaryContainer_'+s(n(r&&r.index,t))+"\" class='w100p'> <div data-zcqa=\"notSummaryDate_"+s(n(r&&r.index,t))+"\" class='alignleft jarvisSmallHead' >"+s(n(null!=t?t.date:t,t))+"</div> "+(null!=(l=a.each.call(null!=t?t:{},null!=t?t.notificationList:t,{name:"each",hash:{},fn:e.program(2,r,0),inverse:e.noop,data:r}))?l:"")+" </div> "},2:function(e,t,a,i,r){var l,n=e.lambda,s=e.escapeExpression,o=null!=t?t:{};return' <div data-zcqa="notSumListContainer_'+s(n(r&&r.index,t))+"\" class='jarvisSectionBox"+(null!=(l=a.ifCond.call(o,null!=t?t.seen:t,"=","true",{name:"ifCond",hash:{},fn:e.program(3,r,0),inverse:e.noop,data:r}))?l:"")+"' data-noti-id ='"+s(n(null!=t?t.id:t,t))+"' data-extrainfo='"+s(n(null!=t?t.extra_info:t,t))+"' data-featureid ='"+s(n(null!=t?t.featureid:t,t))+"' onclick='CrmIntelligence.getNotificationDetails(this);sE(event);' > "+(null!=(l=a.ifCondLogic.call(o,null!=t?t.featureid:t,"=","301","||",null!=t?t.featureid:t,"=","501",{name:"ifCondLogic",hash:{},fn:e.program(5,r,0),inverse:e.program(17,r,0),data:r}))?l:"")+" </div> "},3:function(e,t,a,i,r){return" alreadyClicked"},5:function(e,t,a,i,r){var l;return" "+(null!=(l=a.each.call(null!=t?t:{},null!=t?t.elements:t,{name:"each",hash:{},fn:e.program(6,r,0),inverse:e.noop,data:r}))?l:"")+" "},6:function(e,t,a,i,r){var l;return" "+(null!=(l=a.ifCond.call(null!=t?t:{},null!=t?t.type:t,"=","title",{name:"ifCond",hash:{},fn:e.program(7,r,0),inverse:e.program(9,r,0),data:r}))?l:"")+" "},7:function(e,t,a,i,r){var l,n=e.lambda;return' <div data-zcqa="notSumElement_'+e.escapeExpression(n(r&&r.index,t))+"\" class='jarvisSectionBoxTit dB'>"+(null!=(l=n(null!=t?t.message:t,t))?l:"")+"</div> "},9:function(e,t,a,i,r){var l;return" "+(null!=(l=a.ifCond.call(null!=t?t:{},null!=t?t.type:t,"=","tail",{name:"ifCond",hash:{},fn:e.program(10,r,0),inverse:e.program(12,r,0),data:r}))?l:"")+" "},10:function(e,t,a,i,r){var l,n=e.lambda;return' <div data-zcqa="notSumElement_'+e.escapeExpression(n(r&&r.index,t))+"\" class='jarvisSectionBoxBody'>"+(null!=(l=n(null!=t?t.message:t,t))?l:"")+"</div> "},12:function(e,t,a,i,r){var l,n=e.lambda;return' <div data-zcqa="notSumElement_'+e.escapeExpression(n(r&&r.index,t))+"\" class='jarvisSectionBoxBody "+(null!=(l=a.ifCond.call(null!=t?t:{},null!=t?t.type:t,"=","positive_anomaly",{name:"ifCond",hash:{},fn:e.program(13,r,0),inverse:e.program(15,r,0),data:r}))?l:"")+"'>"+(null!=(l=n(null!=t?t.message:t,t))?l:"")+"</div> "},13:function(e,t,a,i,r){return" positiveAnomalyDiff "},15:function(e,t,a,i,r){return" negativeAnomalyDiff "},17:function(e,t,a,i,r){var l;return" "+(null!=(l=a.each.call(null!=t?t:{},null!=t?t.elements:t,{name:"each",hash:{},fn:e.program(18,r,0),inverse:e.noop,data:r}))?l:"")+" "},18:function(e,t,a,i,r){var l;return" "+(null!=(l=a.ifCond.call(null!=t?t:{},null!=t?t.type:t,"=","title",{name:"ifCond",hash:{},fn:e.program(19,r,0),inverse:e.program(21,r,0),data:r}))?l:"")+" "},19:function(e,t,a,i,r){var l,n=e.lambda;return' <div data-zcqa="notSumElement_'+e.escapeExpression(n(r&&r.index,t))+"\" class='jarvisSectionBoxTit'>"+(null!=(l=n(null!=t?t.message:t,t))?l:"")+"</div> "},21:function(e,t,a,i,r){var l;return" "+(null!=(l=a.ifCond.call(null!=t?t:{},null!=t?t.type:t,"=","body",{name:"ifCond",hash:{},fn:e.program(22,r,0),inverse:e.program(24,r,0),data:r}))?l:"")+" "},22:function(e,t,a,i,r){var l;return' <div data-zcqa="notSumElement_'+e.escapeExpression(e.lambda(r&&r.index,t))+"\" class='jarvisSectionBoxBody'>"+(null!=(l=a.encodeHTML.call(null!=t?t:{},null!=t?t.message:t,{name:"encodeHTML",hash:{},data:r}))?l:"")+"</div> "},24:function(e,t,a,i,r){var l;return" "+(null!=(l=a.ifCond.call(null!=t?t:{},null!=t?t.type:t,"=","tips",{name:"ifCond",hash:{},fn:e.program(25,r,0),inverse:e.noop,data:r}))?l:"")+" "},25:function(e,t,a,i,r){var l,n=e.lambda,s=e.escapeExpression;return' <div data-zcqa="notSumTipContainer_'+s(n(r&&r.index,t))+"\" class='tipContainer'> <div data-zcqa=\"notSumTipMessage_"+s(n(r&&r.index,t))+"\" class='tipMessage'> <div data-zcqa=\"notSumTipTitle_"+s(n(r&&r.index,t))+"\" class='tipTitle mR5'>"+s(a.getI18n.call(null!=t?t:{},"crm.label.convert.tip",{name:"getI18n",hash:{},data:r}))+":</div> "+(null!=(l=n(null!=t?t.message:t,t))?l:"")+" </div> </div> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l;return" "+(null!=(l=a.each.call(null!=t?t:{},null!=t?t.datelist:t,{name:"each",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?l:"")+" "},useData:!0}),t.NotificationSummary=e({1:function(e,t,a,i,r){return' <div data-zcqa="notificationSummaryOuterDiv" > <div data-zcqa="notificationSummaryHeading" class="dIB w100p pR20 vmiddle mB15" style="box-sizing:border-box;margin-bottom:15px !important;"> <div data-zcqa="notificationSummaryMinimize" class="fR cP bold disable"> <span data-zcqa="closeRctItms" onclick="CrmIntelligence.hideDiNotification(event)" title="Close">&mdash;</span> </div> <div data-zcqa="notificationSummaryLogo" class="dIB vmiddle"> </div> <div data-zcqa="notificationSummaryTitle" class="jarvisTitleBig vmiddle dIB"></div> </div> <div data-zcqa="notificationSummaryContainer" id="diNotificationContainer" class="rItemDataSubDiv hide mB10" style="width:100% ; display:block;"> <table class="w100per" border="0" cellpadding="0" cellspacing="0"> <tr> <td> <div data-zcqa="notificationSummaryEmpty" class="" id="recentitems_empty_msg"> </div> </td> </tr> </table> </div> </div> '},3:function(e,t,a,i,r){var l;return' <div data-zcqa="notSumContainerOuter" id = "diScrollContainer" class=\'jarvisScrollContainer oH\' > <div data-zcqa="notSumContainerInner"> '+(null!=(l=e.invokePartial(i.summary,t,{name:"summary",data:r,helpers:a,partials:i,decorators:e.decorators}))?l:"")+" </div> </div> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l,n=null!=t?t:{};return(null!=(l=a.ifCond.call(n,null!=t?t.template:t,"=","skeleton",{name:"ifCond",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?l:"")+" "+(null!=(l=a.ifCond.call(n,null!=t?t.template:t,"=","summaryContainer",{name:"ifCond",hash:{},fn:e.program(3,r,0),inverse:e.noop,data:r}))?l:"")},usePartial:!0,useData:!0}),t.TrendDashboardDateFilter=e({1:function(e,t,a,i,r){return" <option>"+e.escapeExpression(e.lambda(t,t))+"</option> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l,n=e.lambda,s=e.escapeExpression,o=null!=t?t:{};return' <div data-zcqa="dIDateRangeContainer_'+s(n(null!=t?t.dbItemId:t,t))+'" class="dIDateRangeContainer dIB pR mL10" onclick="crmui.hideTooltip()" onmouseover="if(!$(this).find(\'.diUserSettingContainerData\').is(\':visible\')){crmui.showTooltip(\''+s(a.getI18n.call(o,"crm.label.daterange",{name:"getI18n",hash:{},data:r}))+'\',false,\'center\',this)}else{crmui.hideTooltip()}" onmouseout="crmui.hideTooltip()"> <div data-zcqa="dISubModuleconta_'+s(n(null!=t?t.dbItemId:t,t))+'" class="dISubModuleconta pR"  onclick="CrmIntelligence.slider(this, \''+s(n(null!=t?t.dbItemId:t,t))+"');$(this).parent().trigger('mouseout');sE(event)\"> <div data-zcqa=\"dISubModuleTextConta_"+s(n(null!=t?t.dbItemId:t,t))+'" class="dISubModuleTextConta crm-font-regular  selected dateRangeHeader '+s(n(null!=t?t.dbItemId:t,t))+'"> Today </div> </div> <div class="diUserSettingContainerData crm-font-regular" style="left: initial; right: 0px;  display: none;"  onclick="$(\'#Calendar\').hide();sE(event);" > <div class="dIB diUserSettingSubContainer pR oA" > <div class="dIB w100p dIDateRangeContainerUlLi"> <span class="m0 pL30 dIRecentLabelHeader crm-font-regular hide">Recent</span> <ul class="trendDBrecentFilters '+s(n(null!=t?t.dbItemId:t,t))+' p0 m0 w100p dIB hide"> </ul> <span class="m0 pL30 dIRecentLabelHeader  crm-font-regular mT10">'+s(a.getI18n.call(o,"crm.label.timeperiod",{name:"getI18n",hash:{},data:r}))+'</span> <ul class="p0 m0 w100p dIB"> <li class="current dateFilter '+s(n(null!=t?t.dbItemId:t,t))+' m0" onclick="CrmIntelligence.showTodayDrop(this);sE(event);" datetype="current"> <label for="rbCheckidone" class="rbCheckHtml mR10"> <span class="rbHtml mR10"></span> <span data-zcqa="current_'+s(n(null!=t?t.dbItemId:t,t))+'" class="dILstSpn crm-font-regular">'+s(a.getI18n.call(o,"crm.ln.lable.current",{name:"getI18n",hash:{},data:r}))+'</span> <div class="currentPeriod dateFilterDrop '+s(n(null!=t?t.dbItemId:t,t))+' dIrecentSelectDataCont crm-font-regular mL5 mR5"> <select data-zcqa="curfilter_'+s(n(null!=t?t.dbItemId:t,t))+'" onchange="sE(event);"> <option value="week">'+s(a.getI18n.call(o,"crm.emailstats.week",{name:"getI18n",hash:{},data:r}))+'</option> <option value="month">'+s(a.getI18n.call(o,"crm.emailstats.month",{name:"getI18n",hash:{},data:r}))+'</option> <option value="year">'+s(a.getI18n.call(o,"crm.emailstats.year",{name:"getI18n",hash:{},data:r}))+'</option> </select> </div> </label> </li> <li class="last dateFilter '+s(n(null!=t?t.dbItemId:t,t))+' m0" onclick="CrmIntelligence.showTodayDrop(this);sE(event)" datetype="last"> <label data-zcqa="last_'+s(n(null!=t?t.dbItemId:t,t))+'" for="rbCheckidtwo" class="rbCheckHtml mR10"> <span class="rbHtml mR10"></span> <span class="dILstSpn crm-font-regular">'+s(a.getI18n.call(o,"Last",{name:"getI18n",hash:{},data:r}))+'</span> <div class="lastPeriodSteps '+s(n(null!=t?t.dbItemId:t,t))+' dIB mL5 mR5 dIInputSetinRange"> <select data-zcqa="lastcount_'+s(n(null!=t?t.dbItemId:t,t))+'"class="dILastDaysDrop"> '+(null!=(l=a.each.call(o,null!=t?t.range:t,{name:"each",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?l:"")+' </select> </div> <div class="lastPeriod dateFilterDrop '+s(n(null!=t?t.dbItemId:t,t))+' dIB mR5 crm-font-regular dIrecentSelectDataCont"> <select data-zcqa="lastFilter_'+s(n(null!=t?t.dbItemId:t,t))+'" onchange="CrmDashboard.restrictYearPeriodSteps(\''+s(n(null!=t?t.dbItemId:t,t))+'\');sE(event);"> <option value="day">'+s(a.firstLetterCap.call(o,a.getI18n.call(o,"days",{name:"getI18n",hash:{},data:r}),{name:"firstLetterCap",hash:{},data:r}))+'</option> <option value="week">'+s(a.firstLetterCap.call(o,a.getI18n.call(o,"weeks",{name:"getI18n",hash:{},data:r}),{name:"firstLetterCap",hash:{},data:r}))+'</option> <option value="month">'+s(a.firstLetterCap.call(o,a.getI18n.call(o,"months",{name:"getI18n",hash:{},data:r}),{name:"firstLetterCap",hash:{},data:r}))+'</option> <option value="year">'+s(a.firstLetterCap.call(o,a.getI18n.call(o,"crm.label.years",{name:"getI18n",hash:{},data:r}),{name:"firstLetterCap",hash:{},data:r}))+'</option> </select> </div> </label> </li> <li class="custom dateFilter '+s(n(null!=t?t.dbItemId:t,t))+' m0" onclick="CrmIntelligence.showTodayDrop(this);sE(event);" datetype="custom"> <label data-zcqa="custom_'+s(n(null!=t?t.dbItemId:t,t))+'" for="rbCheckidthree" class="rbCheckHtml mR10"> <span class="rbHtml mR10"></span> <span class="dIB vAlignMid ">'+s(a.getI18n.call(o,"Custom",{name:"getI18n",hash:{},data:r}))+'</span> </label> </li> </ul> </div> <div class="w100p dIDateRangeinInputCont"> <div class="dIB w100p trendDBRowSection"> <div class="dIB f14 crm-font-regular trendDBRowSectionLabel">'+s(a.getI18n.call(o,"crm.label.from",{name:"getI18n",hash:{},data:r}))+'</div> <div class="dIB inputTrendDbSectionCont customPeriod startDate '+s(n(null!=t?t.dbItemId:t,t))+'" onclick="sE(event);"> <input data-zcqa="customstart_'+s(n(null!=t?t.dbItemId:t,t))+'" type="text" class="trendDBRowSectionDate" id="trendDBRowSectionFromDate_'+s(n(null!=t?t.dbItemId:t,t))+'"  placeholder="MM/DD/YYYY" onfocus="sE(event);" onclick="CrmIntelligence.showFilterCalendar(event, this, \''+s(n(null!=t?t.dbItemId:t,t))+"');sE(event);\" onchange=\"CrmIntelligence.showDateChangeDropdown('"+s(n(null!=t?t.dbItemId:t,t))+'\', this);sE(event);"> </div> </div> <div class="dIB w100p trendDBRowSection"> <div class="dIB trendDBRowSectionLabel">'+s(a.getI18n.call(o,"crm.label.to",{name:"getI18n",hash:{},data:r}))+'</div> <div class="dIB inputTrendDbSectionCont customPeriod endDate '+s(n(null!=t?t.dbItemId:t,t))+'" onclick="sE(event);"> <input data-zcqa="customend_'+s(n(null!=t?t.dbItemId:t,t))+'" type="text" class="trendDBRowSectionDate " id="trendDBRowSectionToDate_'+s(n(null!=t?t.dbItemId:t,t))+'" placeholder="MM/DD/YYYY" style="" onfocus="sE(event);" onclick="CrmIntelligence.showFilterCalendar(event, this, \''+s(n(null!=t?t.dbItemId:t,t))+"');sE(event);\" onchange=\"CrmIntelligence.showDateChangeDropdown('"+s(n(null!=t?t.dbItemId:t,t))+'\', this);sE(event);"> </div> </div> </div> </div> <div class="dIB w100p mT20 mB20 alignright pR20 brderbox"> <button data-zcqa="datecancel_'+s(n(null!=t?t.dbItemId:t,t))+'" class="dIB newgraybtn bt-smallbtn"  onclick="CrmIntelligence.closeSettingContainer()">'+s(a.getI18n.call(o,"crm.button.cancel",{name:"getI18n",hash:{},data:r}))+'</button> <button data-zcqa="dateapply_'+s(n(null!=t?t.dbItemId:t,t))+'" class="dIB primarybtn bt-smallbtn"  onclick="CrmDashboard.trendDashbboardDateChange(\''+s(n(null!=t?t.dbItemId:t,t))+"', false);$('.diUserSettingContainerData').hide()\">"+s(a.getI18n.call(o,"crm.button.apply",{name:"getI18n",hash:{},data:r}))+'</button> </div> </div> </div> <div class="periodFilterDrop '+s(n(null!=t?t.dbItemId:t,t))+" trendDBRowSectionDateView trendDBRowSectionDate\" onclick='CrmIntelligence.addActiveBorder(this);crmui.hideTooltip();sE(event)' onmouseover=\"if($(this).hasClass('remHidToolTip')){crmui.hideTooltip()}else{crmui.showTooltip('"+s(a.getI18n.call(o,"crm.calendar.freq",{name:"getI18n",hash:{},data:r}))+'\',false,\'center\',this)}" onmouseout="crmui.hideTooltip()"> <select data-zcqa="period_'+s(n(null!=t?t.dbItemId:t,t))+'" id="trendDbViewSelection" onchange="CrmDashboard.trendDashbboardPeriodChange(\''+s(n(null!=t?t.dbItemId:t,t))+"', $(this).val())\" onclick='sE(event)'> <option value=\"day\">"+s(a.getI18n.call(o,"Daily",{name:"getI18n",hash:{},data:r}))+'</option> <option value="week">'+s(a.getI18n.call(o,"Weekly",{name:"getI18n",hash:{},data:r}))+'</option> <option value="month">'+s(a.getI18n.call(o,"Monthly",{name:"getI18n",hash:{},data:r}))+'</option> <option value="year">'+s(a.getI18n.call(o,"Yearly",{name:"getI18n",hash:{},data:r}))+"</option> </select> </div>"},useData:!0}),t.TrendDashboardFeatureSelector=e({1:function(e,t,a,i,r,l,n){var s,o=e.lambda,d=e.escapeExpression,c=null!=t?t:{};return' <button data-zcqa="feature_'+d(o(null!=t?t.dbItemId:t,t))+"_"+d(o(r&&r.index,t))+'"'+(null!=(s=a.if.call(c,r&&r.first,{name:"if",hash:{},fn:e.program(2,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" onclick=\"CrmDashboard.trendDBSeriesChange('"+d(o(null!=n[1]?n[1].dbItemId:n[1],t))+"', "+d(o(r&&r.index,t))+', this)">'+d(a.getI18n.call(c,t,{name:"getI18n",hash:{},data:r}))+"</button> "},2:function(e,t,a,i,r){return'class="dIEmailAnamolySelected crm-font-regular"'},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r,l,n){var s;return' <div class = "dIEmailAnamoly mT10"> '+(null!=(s=a.each.call(null!=t?t:{},null!=t?t.features:t,{name:"each",hash:{},fn:e.program(1,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" </div>"},useData:!0,useDepths:!0}),t.TrendDashboardFilterList=e({1:function(e,t,a,i,r,l,n){var s=e.lambda,o=e.escapeExpression;return' <li data-zcqa="recentfilter_'+o(s(null!=t?t.dbItemId:t,t))+"_"+o(s(r&&r.index,t))+'" class="m0 noneedCheck" data-filter="'+o(s(null!=t?t.filter:t,t))+'" onclick="CrmDashboard.trendDashbboardDateChange(\''+o(s(null!=n[1]?n[1].dbItemId:n[1],t))+"', true, $(this).data('filter'));$(this).parents('.dIDateRangeContainer').find('.diUserSettingContainerData').fadeOut(200);\"> <span class=\"dIB crm-font-regular\"\">"+o(s(null!=t?t.text:t,t))+"</span> </li> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r,l,n){var s;return" "+(null!=(s=a.each.call(null!=t?t:{},null!=t?t.filters:t,{name:"each",hash:{},fn:e.program(1,r,0,l,n),inverse:e.noop,data:r}))?s:"")},useData:!0,useDepths:!0}),t.TrendDashboardMailTypeFilter=e({compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l=e.lambda,n=e.escapeExpression;return' <div data-zcqa="trendDBMailTypeFilter_'+n(l(null!=t?t.dbItemId:t,t))+'" class="trendDBMailTypeFilter dIB pR mL10" onclick="$(\'.diUserListContainerData,.dIMonthRelatedDropdownUl\').hide();$(this).find(\'.diUserListContainerData\').slideDown(200);sE(event)"> <div data-zcqa="dISubModuleconta_'+n(l(null!=t?t.dbItemId:t,t))+'" class="dISubModuleconta pR"> <div data-zcqa="dISubModuleTextConta_'+n(l(null!=t?t.dbItemId:t,t))+'" class="dISubModuleTextConta crm-font-regular mR5"> '+n(a.getI18n.call(null!=t?t:{},null!=t?t.currentType:t,{name:"getI18n",hash:{},data:r}))+' </div> </div> <div data-zcqa="diUserListContainerData_'+n(l(null!=t?t.dbItemId:t,t))+'" class="diUserListContainerData crm-font-regular"> </div> </div> '},useData:!0}),t.TrendDashboardMailTypeSelector=e({1:function(e,t,a,i,r){return' <li class="m0 cB"> '+e.escapeExpression(a.getI18n.call(null!=t?t:{},t,{name:"getI18n",hash:{},data:r}))+" </li> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l;return' <ul class="m0 p0 w100p dIB" onclick="sE(event)"> '+(null!=(l=a.each.call(null!=t?t:{},null!=t?t.type:t,{name:"each",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?l:"")+" </ul>"},useData:!0}),t.TrendDashboardToolTip=e({compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l,n=e.lambda,s=e.escapeExpression;return"<b>"+s(n(null!=(l=null!=t?t.data:t)?l.name:l,t))+"</b></br>"+s(n(null!=(l=null!=t?t.data:t)?l.value:l,t))},useData:!0}),t.TrendDashboardUserFilter=e({compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l=e.lambda,n=e.escapeExpression,s=null!=t?t:{};return' <div data-zcqa="trendDBUserFilter_'+n(l(null!=t?t.dbItemId:t,t))+'" class="dIUserListContainer pR dIB" onclick="CrmDashboard.showTrendDBUserSelector(\''+n(l(null!=t?t.dbItemId:t,t))+"');CrmIntelligence.showUserContainer(this, '"+n(l(null!=t?t.dbItemId:t,t))+'\');sE(event)"> <div data-zcqa="dISubUserCont_'+n(l(null!=t?t.dbItemId:t,t))+'" class="dISubUserCont"> <div data-zcqa="dioneUserConta_'+n(l(null!=t?t.dbItemId:t,t))+'" class="dioneUserConta"> <div data-zcqa="dIUserImage_'+n(l(null!=t?t.dbItemId:t,t))+'" class="dIUserImage hide"> <img src="https://'+n(l(null!=t?t.sampleImage:t,t))+'"/> </div> <div class="userSettings '+n(l(null!=t?t.dbItemId:t,t))+' dIUserNameText crm-font-regular" data-zcqa="dIUserNameText_'+n(l(null!=t?t.dbItemId:t,t))+'" > '+n(l(null!=t?t.userSettings:t,t))+' </div> </div> </div> <div data-zcqa="diUserListContainerData_'+n(l(null!=t?t.dbItemId:t,t))+'" class="diUserListContainerData crm-font-regular '+n(l(null!=t?t.dbItemId:t,t))+'"  onclick="sE(event);CrmIntelligence.hideOtherpops();"> <input data-zcqa="search_'+n(l(null!=t?t.dbItemId:t,t))+'" type="checkbox" class="hide" name="n1" id="sa"> <div data-zcqa="diUserListSubData_'+n(l(null!=t?t.dbItemId:t,t))+'" class="dIB w100p p15 brderbox"> <div data-zcqa="dIUserSearchNewContainer_'+n(l(null!=t?t.dbItemId:t,t))+'" class="mL10 mR10 dIUserSearchNewContainer"> <div data-zcqa="diuserchangeDropdown_'+n(l(null!=t?t.dbItemId:t,t))+'" class="diuserchangeDropdown '+n(l(null!=t?t.dbItemId:t,t))+'" onclick="$(\'.dIuserOpenChange\').show();sE(event);"> '+n(l(null!=t?t.userType:t,t))+' </div> <div data-zcqa="dIuserOpenChange_'+n(l(null!=t?t.dbItemId:t,t))+'" class="dIuserOpenChange '+n(l(null!=t?t.dbItemId:t,t))+' p0"> <ul data-zcqa="usergroup_'+n(l(null!=t?t.dbItemId:t,t))+'" class="p0 m0" id="userOrGroup_'+n(l(null!=t?t.dbItemId:t,t))+'"> <li data-zcqa="user_'+n(l(null!=t?t.dbItemId:t,t))+"\" class=\"pL10 pR10 diuserchangeli dIB selected\" type=\"allusers\" onclick=\"$(this).parent().find('li').removeClass('selected');$(this).addClass('selected');$('.diuserchangeDropdown."+n(l(null!=t?t.dbItemId:t,t))+"').text($(this).text());$('.dIuserOpenChange').hide();CrmDashboard.trendDBUserTypeChange('"+n(l(null!=t?t.dbItemId:t,t))+'\', this);" usertype="user">'+n(a.getI18n.call(s,"Users",{name:"getI18n",hash:{},data:r}))+'</li> <li data-zcqa="group_'+n(l(null!=t?t.dbItemId:t,t))+"\" class=\"pL10 pR10 diuserchangeli dIB\" type=\"group\" onclick=\"$(this).parent().find('li').removeClass('selected');$(this).addClass('selected');$('.diuserchangeDropdown').text($(this).text());$('.dIuserOpenChange').hide();CrmDashboard.trendDBUserTypeChange('"+n(l(null!=t?t.dbItemId:t,t))+'\', this);" usertype="group">'+n(a.getI18n.call(s,"groups",{name:"getI18n",hash:{},data:r}))+'</li> </ul> </div> <div data-zcqa="dIUserInputContainer_'+n(l(null!=t?t.dbItemId:t,t))+'" class="dIB dIUserInputContainer"> <input type="text" class="trendDBUserSearch '+n(l(null!=t?t.dbItemId:t,t))+'"placeholder="'+n(a.getI18n.call(s,"crm.label.search",{name:"getI18n",hash:{},data:r}))+'" onkeyup="$(\'.selectAllUser.'+n(l(null!=t?t.dbItemId:t,t))+"').addClass('hide');CrmIntelligence.inputSearchUser(this);\"> </div> </div> </div> <div data-zcqa=\"diAllCheckBoxContainerSection_"+n(l(null!=t?t.dbItemId:t,t))+'" class="dIB pL15 pR15 brderbox mT10 mB10 w100p diAllCheckBoxContainerSection"> <div data-zcqa="diAllCheckBoxSubSection_'+n(l(null!=t?t.dbItemId:t,t))+'" class="dIB mL5 selectAllUser '+n(l(null!=t?t.dbItemId:t,t))+'"> <input data-zcqa="selall_'+n(l(null!=t?t.dbItemId:t,t))+'" type="checkbox" class="hide" name="dIAllSelectionInputBox" id="userSelectAll_'+n(l(null!=t?t.dbItemId:t,t))+'" onchange="CrmDashboard.trendDBSelectAllUser(\''+n(l(null!=t?t.dbItemId:t,t))+'\')"> <label class="cP" for="dIAllSelectionInputBox" onclick="$(this).prev().click()"> <span></span> <div data-zcqa="dIUserNameText_'+n(l(null!=t?t.dbItemId:t,t))+'" class="dIUserNameText crm-font-regular pR10"> '+n(a.getI18n.call(s,"crm.label.all",{name:"getI18n",hash:{},data:r}))+' </div> </label> </div> <div class="dIB  dIuserselectedCount" > <div data-zcqa="trendDBUserCount_'+n(l(null!=t?t.dbItemId:t,t))+'" id="trendDBUserCount_'+n(l(null!=t?t.dbItemId:t,t))+'"class="dIB  crm-font-regular" > </div> '+n(a.getI18n.call(s,"crm.label.selected",{name:"getI18n",hash:{},data:r}))+' </div> </div> <div data-zcqa="dIUserListScrollContainer_'+n(l(null!=t?t.dbItemId:t,t))+'" class="w100p brderbox dIUserListScrollContainer" onscroll="CrmIntelligence.diUserListScrollAddShad(this)"> <ul id="trendDBUserList_'+n(l(null!=t?t.dbItemId:t,t))+'" class="m0 pR15 pL15 brderbox  pT0 pB0 w100p dIB"> </ul> </div> <div data-zcqa="dICancelApply_'+n(l(null!=t?t.dbItemId:t,t))+'" class="w100p p15 brderbox dIB alignright diUserListActContainer"> <button data-zcqa="usercancel_'+n(l(null!=t?t.dbItemId:t,t))+'" class="newgraybtn "  onclick="$(\'.diUserListContainerData.'+n(l(null!=t?t.dbItemId:t,t))+"').fadeOut(200);$('.dIactiveBorder').removeClass('dIactiveBorder');$('.diUserListContainerData."+n(l(null!=t?t.dbItemId:t,t))+"').find('li').show();$('.diUserListContainerData."+n(l(null!=t?t.dbItemId:t,t))+"').find('input').val('false');CrmDashboard.trendDashbboardUserFilterReset('"+n(l(null!=t?t.dbItemId:t,t))+"');$('.trendDBUserSearch."+n(l(null!=t?t.dbItemId:t,t))+"').val('');\"> "+n(a.getI18n.call(s,"crm.button.cancel",{name:"getI18n",hash:{},data:r}))+' </button> <button data-zcqa="userapply_'+n(l(null!=t?t.dbItemId:t,t))+'" class="primarybtn mR0"  onclick="CrmDashboard.trendDashbboardUserFilterChange(\''+n(l(null!=t?t.dbItemId:t,t))+"');$('.trendDBUserSearch."+n(l(null!=t?t.dbItemId:t,t))+"').val('');\"> "+n(a.getI18n.call(s,"crm.button.apply",{name:"getI18n",hash:{},data:r}))+" </button> </div> </div> </div>"},useData:!0}),t.TrendDashboardUserList=e({1:function(e,t,a,i,r,l,n){var s,o=e.lambda,d=e.escapeExpression;return' <li class="m0 cB" data-id="'+d(o(null!=t?t.id:t,t))+'" > <input type="checkbox" class="hide" name="n'+d(o(r&&r.index,t))+'" id="'+d(o(null!=n[1]?n[1].dbItemId:n[1],t))+"_"+d(o(null!=t?t.id:t,t))+'" onchange="CrmDashboard.trendDBSelectUser(\''+d(o(null!=n[1]?n[1].dbItemId:n[1],t))+'\', this)"> <label data-zcqa="user_'+d(o(null!=n[1]?n[1].dbItemId:n[1],t))+"_"+d(o(r&&r.index,t))+'" class="cP" for="'+d(o(null!=n[1]?n[1].dbItemId:n[1],t))+"_"+d(o(null!=t?t.id:t,t))+'" > <span></span> '+(null!=(s=a.if.call(null!=t?t:{},null!=t?t.photo:t,{name:"if",hash:{},fn:e.program(2,r,0,l,n),inverse:e.noop,data:r}))?s:"")+' <div class="dIUserNameText onlytheUserName crm-font-regular" title="'+d(o(null!=t?t.name:t,t))+'">'+d(o(null!=t?t.name:t,t))+"</div> </label> </li> "},2:function(e,t,a,i,r){return' <div class="dIUserImage"> <img src="'+e.escapeExpression(e.lambda(null!=t?t.photo:t,t))+'"> </div> '},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r,l,n){var s;return" "+(null!=(s=a.each.call(null!=t?t:{},null!=t?t.userlist:t,{name:"each",hash:{},fn:e.program(1,r,0,l,n),inverse:e.noop,data:r}))?s:"")},useData:!0,useDepths:!0}),t.WFDuplicateMailDetails=e({1:function(e,t,a,i,r,l,n){var s,o=null!=t?t:{},d=e.escapeExpression,c=e.lambda;return' <div class="mB10"> <span class="f14 crm-font-regular">'+d(a.getI18n.call(o,"crm.emailstats.templatename",{name:"getI18n",hash:{},data:r}))+' :</span> <span class="mL10 "> \x3c!--<a class="f14 link cP" href="'+d(a.getCrmBasePath.call(o,{name:"getCrmBasePath",hash:{},data:r}))+"/ShowSetup.do?tab=custom&subTab=email&step=showAllTemplates&emailTemplateId="+d(a.encodeURL.call(o,null!=t?t.EncryptedTemplateId:t,{name:"encodeURL",hash:{},data:r}))+'" target="_blank">'+d(c(null!=t?t.TemplateName:t,t))+'</a>--\x3e <link-to lt-prop-class="f14 link cP" lt-prop-route="crm.settings.section.crm-templates" lt-prop-qp=\'{"type" : "email" , "templateId" : "'+d(a.encodeURL.call(o,null!=t?t.EncryptedTemplateId:t,{name:"encodeURL",hash:{},data:r}))+'" }\' lt-prop-target="_blank">'+d(c(null!=t?t.TemplateName:t,t))+'</link-to> </span> </div> <table border="0" width="100%" cellspacing="0" cellpadding="0" class="newtable"> <tbody> <thead> <tr> <th width="40%">'+d(a.getI18n.call(o,"crm.wf.di.duplicate.rule.name",{name:"getI18n",hash:{},data:r}))+"</th> <th>"+d(a.getI18n.call(o,"crm.label.alert.name",{name:"getI18n",hash:{},data:r}))+"</th> </tr> </thead> "+(null!=(s=a.each.call(o,null!=(s=null!=t?t.data:t)?s.Rules:s,{name:"each",hash:{},fn:e.program(2,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" </tbody> </table> "},2:function(e,t,a,i,r,l,n){var s;return" "+(null!=(s=a.each.call(null!=t?t:{},null!=t?t.Alerts:t,{name:"each",hash:{},fn:e.program(3,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "},3:function(e,t,a,i,r,l,n){var s=null!=t?t:{},o=e.escapeExpression,d=e.lambda;return' <tr> <td> <a class="link cP vam wordBreak" href="'+o(a.getCrmBasePath.call(s,{name:"getCrmBasePath",hash:{},data:r}))+"/ShowSetup.do?tab=automate&subTab=workflow&step=showRule&ruleId="+o(a.encodeURL.call(s,null!=n[1]?n[1].RuleId:n[1],{name:"encodeURL",hash:{},data:r}))+'" target="_blank">'+o(d(null!=n[1]?n[1].RuleName:n[1],t))+'</a> </td> <td> <div class="ellipsistext"> <a class="link"  href="'+o(a.getCrmBasePath.call(s,{name:"getCrmBasePath",hash:{},data:r}))+"/ShowSetup.do?tab=automate&subTab=alert&step=showAlert&alertId="+o(a.encodeURL.call(s,null!=t?t.AlertId:t,{name:"encodeURL",hash:{},data:r}))+'" target="_blank">'+o(d(null!=t?t.AlertName:t,t))+"</a> </div> </td> </tr> "},5:function(e,t,a,i,r,l,n){var s,o=null!=t?t:{},d=e.escapeExpression;return' <table border="0" width="100%" cellspacing="0" cellpadding="0" class="newtable"> <thead> <tr> <th width="40%">'+d(a.getI18n.call(o,"crm.wf.di.duplicate.rule.name",{name:"getI18n",hash:{},data:r}))+'</th> <th width="25%">'+d(a.getI18n.call(o,"crm.label.alert.name",{name:"getI18n",hash:{},data:r}))+"</th> <th>"+d(a.getI18n.call(o,"crm.emailstats.templatename",{name:"getI18n",hash:{},data:r}))+"</th> </tr> </thead> <tbody> "+(null!=(s=a.each.call(o,null!=(s=null!=t?t.data:t)?s.Rules:s,{name:"each",hash:{},fn:e.program(6,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" </tbody> </table> "},6:function(e,t,a,i,r,l,n){var s;return" "+(null!=(s=a.each.call(null!=t?t:{},null!=t?t.Alerts:t,{name:"each",hash:{},fn:e.program(7,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "},7:function(e,t,a,i,r,l,n){var s,o=null!=t?t:{},d=e.escapeExpression,c=e.lambda;return" <tr> "+(null!=(s=a.ifCond.call(o,0,"!=",r&&r.index,{name:"ifCond",hash:{},fn:e.program(8,r,0,l,n),inverse:e.program(13,r,0,l,n),data:r}))?s:"")+' <td> <div class="ellipsistext"> <a class="link"  href="'+d(a.getCrmBasePath.call(o,{name:"getCrmBasePath",hash:{},data:r}))+"/ShowSetup.do?tab=automate&subTab=alert&step=showAlert&alertId="+d(a.encodeURL.call(o,null!=t?t.AlertId:t,{name:"encodeURL",hash:{},data:r}))+'" target="_blank">'+d(c(null!=t?t.AlertName:t,t))+'</a> </div> </td> <td> \x3c!--<a class="f14 link cP" href="'+d(a.getCrmBasePath.call(o,{name:"getCrmBasePath",hash:{},data:r}))+"/settings/templates?type=email&templateId="+d(a.encodeURL.call(o,null!=t?t.EncryptedTemplateId:t,{name:"encodeURL",hash:{},data:r}))+'" target="_blank">'+d(c(null!=t?t.TemplateName:t,t))+'</a>--\x3e <link-to lt-prop-class="f14 link cP" lt-prop-route="crm.settings.section.crm-templates" lt-prop-qp=\'{"type" : "email" , "templateId" : "'+d(a.encodeURL.call(o,null!=t?t.EncryptedTemplateId:t,{name:"encodeURL",hash:{},data:r}))+'" }\' lt-prop-target="_blank">'+d(c(null!=t?t.TemplateName:t,t))+"</link-to> </td> </tr> "},8:function(e,t,a,i,r,l,n){var s,o=null!=t?t:{};return" "+(null!=(s=a.ifCond.call(o,a.incre.call(o,r&&r.index,{name:"incre",hash:{},data:r}),"==",null!=(s=null!=n[2]?n[2].Alerts:n[2])?s.length:s,{name:"ifCond",hash:{},fn:e.program(9,r,0,l,n),inverse:e.program(11,r,0,l,n),data:r}))?s:"")+" "},9:function(e,t,a,i,r){return" <td></td> "},11:function(e,t,a,i,r){return' <td class="bB0"></td> '},13:function(e,t,a,i,r,l,n){var s,o=null!=t?t:{};return" "+(null!=(s=a.ifCond.call(o,a.incre.call(o,r&&r.index,{name:"incre",hash:{},data:r}),"==",null!=(s=null!=n[2]?n[2].Alerts:n[2])?s.length:s,{name:"ifCond",hash:{},fn:e.program(14,r,0,l,n),inverse:e.program(16,r,0,l,n),data:r}))?s:"")+" "},14:function(e,t,a,i,r,l,n){var s=null!=t?t:{},o=e.escapeExpression;return' <td> <a class="link cP vam wordBreak" href="'+o(a.getCrmBasePath.call(s,{name:"getCrmBasePath",hash:{},data:r}))+"/ShowSetup.do?tab=automate&subTab=workflow&step=showRule&ruleId="+o(a.encodeURL.call(s,null!=n[1]?n[1].RuleId:n[1],{name:"encodeURL",hash:{},data:r}))+'" target="_blank">'+o(e.lambda(null!=n[1]?n[1].RuleName:n[1],t))+"</a> </td> "},16:function(e,t,a,i,r,l,n){var s=null!=t?t:{},o=e.escapeExpression;return' <td class="bB0"> <a class="link cP vam wordBreak" href="'+o(a.getCrmBasePath.call(s,{name:"getCrmBasePath",hash:{},data:r}))+"/ShowSetup.do?tab=automate&subTab=workflow&step=showRule&ruleId="+o(a.encodeURL.call(s,null!=n[1]?n[1].RuleId:n[1],{name:"encodeURL",hash:{},data:r}))+'" target="_blank">'+o(e.lambda(null!=n[1]?n[1].RuleName:n[1],t))+"</a> </td> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r,l,n){var s,o=null!=t?t:{},d=e.escapeExpression,c=e.lambda;return' <div class="darkSecHead black pB15" id="wfDINotificationHeader" style="font-size: 1.2rem;">'+d(a.getI18n.call(o,"crm.wf.di.duplicate.details.heading",{name:"getI18n",hash:{},data:r}))+'</div> <div class="mB20 content">'+d(c(null!=t?t.Description:t,t))+"</div> "+(null!=(s=a.if.call(o,null!=(s=null!=t?t.data:t)?s.IsSameTemplate:s,{name:"if",hash:{},fn:e.program(1,r,0,l,n),inverse:e.program(5,r,0,l,n),data:r}))?s:"")+' <div class="pT25"> <div class="f12 gray">'+(null!=(s=c(null!=t?t.IgnoreNotificationMsg:t,t))?s:"")+"</div> </div>"},useData:!0,useDepths:!0}),t.ZiaOnboard=e({compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l,n=e.escapeExpression,s=null!=t?t:{};return' <div class="aligncenter p20"> <img src="'+n(e.lambda(t,t))+'" class="mT30 w70per"></img> <p class="f14 mT20">'+(null!=(l=a.getI18n.call(s,"crm.zia.onboard",{name:"getI18n",hash:{},data:r}))?l:"")+'</p> <p class="aligncenter colBlue f14 crm-font-regular mT20"> <link-to lt-prop-route="crm.settings.section.zia.notification" lt-prop-custom> <a href="'+n(a.getCrmBasePath.call(s,{name:"getCrmBasePath",hash:{},data:r}))+'/settings/zia/notification">Configure</a> </link-to> </p> </div>'},useData:!0})}();var crmLicense={valueToReset:"16",pushToSalesAccForReview:!1,editionTrialPopup:function(){var e=Crm.userDetails.LICENSE_TYPE_ACTUAL_NAME,t=Crm.userDetails.profilePage.tryOtherEditionUrl;if("ZohoCRM"!==!Crm.serviceName){Lyte.injectResources(networkUtils.returnDependencyFiles(["crmSlider.css"],null));var a=csrfParamName+"="+encodeURIComponent(csrfToken);(new crmRequestPool).initiate({url:t,data:a,success:function(t){if(t.res&&"reviewSubmitted"===t.res)crmLicense.showReviewPopup(t.edition,!0);else{var a=$("#tryFeaturesDiv"),i=$("body");0!==a.length&&a.remove(),i.append(t),!Crm.userDetails.ISPAID_USER||"Professional"!==e&&"Enterprise"!==e&&"Ultimate"!==e||($(".cir_left").remove(),$(".cir_right").remove()),!Crm.userDetails.ISPAID_USER||"Enterprise"!==e&&"Ultimate"!==e||$(".planlistcon").addClass("flexCenter wAuto");var r=$(".tf_prof").find("ul").find("li");if("China"===Crm.userDetails.DEPLOYMENT&&(r.eq(1).remove(),r.eq(1).remove()),"Free"===Crm.userDetails.LICENSE_TYPE_ACTUAL_NAME&&-1!==t.indexOf("tf_crmplus")){var l;switch(Crm.userDetails.EDITION_NAME){case"Starter":l="tf_str";break;case"Standard":l="tf_std";break;case"Professional":l="tf_prof";break;case"Enterprise":l="tf_entpr";break;case"Ultimate":l="tf_ulti"}if(l){var n=$("."+l);n.addClass("currentTrial"),n.find("input").remove(),n.find("p").remove(),n.append('<span class="dB bold pA crmEdit_startButSty mB20 crmPro_selectTabCol w200">'+I18n.getMsg("crm.current.trial.expiry",elseResult)+"</span>")}}showFreezeLayer(),$("#basic").addClass("blur5px"),i.addClass("oH"),$("#freezeBackGround").css({opacity:"0.8","background-color":"#f6f6f6"})}}}),clearInterval(intvlTrialPopup),Crm.trackSpotLightAction("Try Other Edition Click")}else networkUtils.openUrl(t,"_blank","")},onCloseTrial:function(){$("#tryFeaturesDiv").remove(),hideFreezeLayer(),$("#basic").removeClass("blur5px"),$("body").removeClass("oH"),$("#freezeBackGround").css({opacity:"","background-color":""}),$(".planlistcon").removeClass("flexCenter wAuto")},enableEditionTrial:function(e,t,a){if(commonUtils.showHideLoadingDiv(),$("#tryFeaturesDiv").remove(),"extendYourTrail"===e&&"Starter"===t)return $("#trialExpiryDiv").css("display","none"),hideFreezeLayer(),void crmLicense.editionTrialPopup();var i=Crm.getCrmBasePath()+"/Security.do";if("extendYourTrail"!==e){var r=formData2QueryString(document.forms.editionEvaluation);(new crmRequestPool).initiate({url:i,data:r,success:function(e){-1!==e.indexOf("You cannot access this URL")?renderingUtils.displayPermissionDenied():setTimeout((function(){cookieUtils.setCookie("crmtrialEnabed","Closed",365,"/"),Utils.windowLocationReload()}),500)},error:function(e){555===e.status&&renderingUtils.showCustomAlert(e.responseText)}})}else{r=(r="crmcsrfparam="+encodeURIComponent(csrfToken))+"&selEdition="+t,void 0!==a?r=r+"&actionName="+a:r+="&actionName=newEvaluation&",(new crmRequestPool).initiate({url:i,data:r,success:function(e){-1!==e.indexOf("You cannot access this URL")?renderingUtils.displayPermissionDenied():(Crm.client_tracking("Extend Trial"),setTimeout((function(){cookieUtils.setCookie("crmtrialEnabed","Closed",365,"/"),Utils.windowLocationReload()}),500))},error:function(e){555===e.status&&crmui.showMsgBand("warning",e.responseText,5e3)}})}},enableHigherEditionTrial:function(e){commonUtils.showHideLoadingDiv(),showFreezeLayer();var t=csrfParamName+"="+encodeURIComponent(csrfToken);(new crmRequestPool).initiate({type:"POST",url:Crm.getCrmBasePath()+"/Security.do?actionName=enableHigherEditionTrial&selEdition="+e,data:t,success:function(e){if(-1!==e.indexOf("You cannot access this URL"))renderingUtils.displayPermissionDenied();else{var t=window.location.href;-1!==(t=t.replace(/&higherEditionTry=true|&higherEditionClick=true|&thisEditionFeature=false/g,"")).indexOf("&subTab=emailSettings")&&(t=t.replace("action=null","action=mailSelect"));var a="?";if(-1!==t.indexOf("showonlyonhigheredition")){if(-1!==(t=t.replace(/&showonlyonhigheredition=true/g,"")).indexOf("invenmanagemnt")||-1!==t.indexOf("zia"))t="https://"+RebrandLinkUtil.getProperty("CRMURL")+Crm.getCrmBasePath()+"/ShowTab.do?module=Setup";else{for(var i,r=t.slice(t.indexOf("?")+1).split("&"),l=r.length,n=0;n<l;n++){var s=r[n];-1!==s.indexOf("nextclickid")?i=s:-1===s.indexOf("tab")&&-1===s.indexOf("subTab")&&-1===s.indexOf("messagekey")&&((a="?")?a+=s:a=a+"&"+s)}if(i.length>0){var o=i.substring(i.indexOf("=")+1,i.length).split("_");if(a=a+"&tab="+o[0]+"&subTab="+o[1],o.length>2)a=a+"&innerTab="+o[2];t="https://"+RebrandLinkUtil.getProperty("CRMURL")+Crm.getCrmBasePath()+"/ShowSetup.do"+a}}t=t.replace(/&showonlyonhigheredition=true/g,"")}window.location.replace(t);cookieUtils.setCookie("crmtrialEnabedFrmSetup","Closed",200,"/")}}}),removeFreezeLayer()},upgradeAfterExpiry:function(){$("#trialExpiryDiv").remove();var e=RebrandLinkUtil.getProperty("Brand"),t=Crm.userDetails.manageSubscriptionUrl+"&edition="+Crm.userDetails.EDITION_EVALUATED;"skyDesk"===e&&(t="https://"+RebrandLinkUtil.getProperty("ZohoURL")+"/store/release/crm.html"),document.location.href=t},moveToActualEditionAfterExpiry:function(){Crm.trackSpotLightAction("Trial Expiry alert - Continue in "+Crm.userDetails.LICENSE_TYPE_ACTUAL_NAME+" Edition");var e=csrfParamName+"="+encodeURIComponent(csrfToken);(new crmRequestPool).initiate({type:"POST",url:Crm.getCrmBasePath()+"/License.do?actionType=deleteTrialExpiryKey",data:e,success:function(e){var t=$("#trialExpiryDiv");if("success"===e&&t.length){t.remove();cookieUtils.setCookie("crmtrialCancelled","Closed",365,"/"),Utils.windowLocationReload()}}})},confirmCancelTrial:function(){var e=$("#tabLayer");crmLicense.valueToReset=e.css("z-index"),$("#tryFeaturesDiv").remove(),hideFreezeLayer(),crmui.showPopup("trailConfirmdiv",!0),e.css("z-index","29")},cancelTrial:function(){$("#tabLayer").css("z-index",crmLicense.valueToReset),crmui.hidePopup("trailConfirmdiv",!0);var e=Crm.getCrmBasePath()+"/License.do?actionType=cancelTrial",t=csrfParamName+"="+encodeURIComponent(csrfToken);(new crmRequestPool).initiate({url:e,data:t,success:function(e){-1!==e.indexOf("You cannot access this URL")?renderingUtils.displayPermissionDenied():setTimeout((function(){cookieUtils.setCookie("crmtrialCancelled","Closed",365,"/"),Utils.windowLocationReload()}),500)}},t,(function(e){555===e.status&&renderingUtils.showCustomAlert(e.responseText)}))},removealert:function(){$("#tabLayer").css("z-index",crmLicense.valueToReset),crmui.hidePopup("trailConfirmdiv",!0),removeFreezeLayer()},moveToFree:function(){var e=csrfParamName+"="+encodeURIComponent(csrfToken);(new crmRequestPool).initiate({type:"POST",url:Crm.getCrmBasePath()+"/Security.do?actionName=cancelSubscription",data:e,success:function(e){"success"===e.STATUS&&$("#SubscriptionExpiryDiv").size()&&Utils.windowLocationReload()}})},showMissingFeatures:function(){var e=$("#editionChangePop");if(e.length)e.show();else{var t=csrfParamName+"="+encodeURIComponent(csrfToken);(new crmRequestPool).initiate({type:"POST",url:Crm.getCrmBasePath()+"/Security.do?actionName=missingFeatures",data:t,success:function(e){var t=(0,Handlebars.templates.MissingFeatures)(e);$("body").append(t)}})}},hideMissingFeatures:function(){$("#editionChangePop").hide()},renewSubscription:function(){networkUtils.openUrl("https://"+RebrandLinkUtil.getProperty("STOREURL")+"/html/store/index.html#subscription?serviceId=2&customId="+Crm.userDetails.ZGID)},changeEdition:function(){networkUtils.openUrl("https://"+RebrandLinkUtil.getProperty("STOREURL")+"/html/store/index.html#subscription?serviceId=2&customId="+Crm.userDetails.ZGID+"&renewSubscription=false")},showReviewPopup:function(e,t){var a=networkUtils.returnDependencyFiles(["crm-trial-review.js"],crmConstants.jsStaticPathForLyte),i=networkUtils.returnDependencyFiles(["crm-trial-review.css"],crmConstants.cssStaticPathForLyte),r=a.concat(i);Lyte.injectResources(r,void 0,(function(){Lyte.Component.render("crm-trial-extend-popup",{edition:e},"#show"),Crm.trackSpotLightAction("ReviewPopupShown");var a=document.getElementById("dataSubmitted");t?(a.ltProp("show",!0),a.ltProp("secondaryMessage",I18n.getMsg("crm.license.trial.review.already.submitted",e))):($L("#basic").addClass("bodyBlur"),document.getElementById("extendedTrialModal").ltProp("show",!0),a.ltProp("secondaryMessage",I18n.getMsg("crm.license.trial.review.message.receive",e)));var i={actionType:"pushEditionToSalesAccForReview"};networkUtils.setCsrfParam(i),i.edition=e;var r=Crm.getCrmBasePath()+"/License.do";(new crmRequestPool).initiate({action:r,type:"POST",data:i,success:function(){crmLicense.pushToSalesAccForReview=!1}})}))}},$zoho=$zoho||{salesiq:{values:{},ready:function(){}}},PremiumChat={loadSalesIQ:function(e,a,i,r){if(PremiumChat.fileCount=0,PremiumChat.totalFileSize=0,($zoho={}).salesiq=$zoho.salesiq||{widgetcode:i,values:{},ready:function(){}},!$("#siqiframe").length){var l=document.getElementsByTagName("head")[0],n=document;s=n.createElement("script"),s.type="text/javascript",s.id="zsiqscript",s.defer=!0,s.src=a,t=n.getElementsByTagName("script")[0],t.parentNode.insertBefore(s,t),l.appendChild(s),$zoho.salesiq.ready=function(t){"zohoone"!==e&&$zoho.salesiq.tracking.off();var a=r["Deployment Location"];if(r)if("true"==r.isTrialUser){var i=r.Trial_Edition;"Professional"!=i&&"Old Enterprise"!=i&&"Enterprise"!=i&&"Ultimate"!=i||(a&&"AU"==a?$zoho.salesiq.chat.department(["Zoho CRM Presales AU"]):a&&"IN"==a?$zoho.salesiq.chat.department(["Zoho CRM Presales IN"]):a&&"US"==a&&$zoho.salesiq.chat.department(["Zoho CRM Presales US"]))}else"false"==r.isTrialUser&&"China"!=r["Deployment Location"]&&$zoho.salesiq.chat.department(["Zoho CRM Support"]);$zoho.salesiq.floatbutton.visible("hide"),$zoho.salesiq.visitor.name()||$zoho.salesiq.visitor.name(Crm.userDetails.DISPLAY_NAME),$zoho.salesiq.visitor.email()||$zoho.salesiq.visitor.email(Crm.userDetails.LOGIN_NAME),r&&(r.Crm_Country=Crm.userDetails.COUNTRY_LOCALE?Crm.userDetails.COUNTRY_LOCALE.substr(3):null,r.zuid=Crm.userDetails.ZUID,$zoho.salesiq.visitor.info(r)),$zoho.salesiq.call.cancelled((function(){$zoho.salesiq.floatwindow.visible("hide")})),$zoho.salesiq.floatwindow.minimize((function(){$zoho.salesiq.visitor.ongoingchat()?($(".siq_bR").css("height","inherit"),$zoho.salesiq.floatbutton.visible("show")):$zoho.salesiq.floatbutton.visible("hide"),$L("#featureChat").show()})),$zoho.salesiq.chat.complete((function(e,t){$zoho.salesiq.floatbutton.visible("hide"),t&&"CRM Support"==t.attendername&&($zoho.salesiq.rating.visible("hide"),$zoho.salesiq.feedback.visible("hide")),Crm.timingCheckNeeded&&FeedbackChat.isChatAvailable().then((function(e){e||$zoho.salesiq.floatwindow.visible("hide")}))}));try{salesIQTrackSignup()}catch(e){}}}},invokePremiumChat:function(e,t,a,i,r){FeedbackChat.checkSupport_WorkingDay().then((function(l){if(!l&&r)return renderingUtils.showCustomAlert(I18n.getMsg("crm.premiumsupport.not.supported.hour",RebrandLinkUtil.getProperty("SUPPORTMAILID")),"",!1),!1;if($zoho.salesiq.floatbutton.visible("hide"),t=t||Crm.userDetails.DISPLAY_NAME,a=a||Crm.userDetails.LOGIN_NAME,$zoho.salesiq.visitor.name(t),$zoho.salesiq.visitor.email(a),$zoho.salesiq.chat.agent(e),"Call"===i){if($zoho.salesiq.visitor.ongoingchat())return renderingUtils.showCustomAlert(I18n.getMsg("crm.premiumsupport.chat.ongoing"),"",!1),!1;$zoho.salesiq.call.start(),$zoho.salesiq.floatwindow.visible("show")}else"Chat"===i&&($zoho.salesiq.visitor.question(""),$zoho.salesiq.floatwindow.visible("show",!0,0),$zoho.salesiq.floatwindow.defaultview("Classic"))}))},closeMailPop:function(){$("#feedBackForm").remove()},addFile:function(e){var t=document.createElement("input"),a=document.getElementById("attach_desktop");t.setAttribute("type","file"),t.setAttribute("name","attachments"),t.setAttribute("id","fb_attachFile"),t.setAttribute("style","background: none; right: 0px; left: auto; top: 9px;"),t.setAttribute("class","smFile file0"),t.setAttribute("tabIndex","-1"),t.setAttribute("multiple","true"),t.onchange=function(){PremiumChat.addFile(this)},$(e).hide(),a.appendChild(t);var i=function(e){var t=$(this);$(e).remove(),t.parent(".noteFileName").remove(),PremiumChat.fileCount--,$("#attach_desktop").show(),PremiumChat.fileCount>0?($("#fbAttachFiles").addClass("hide"),$("#fbAttachMoreFiles").removeClass("hide")):($("#fbAttachFiles").removeClass("hide"),$("#fbAttachMoreFiles").addClass("hide"))};if(null!=document.getElementsByName("attachments")[0])for(var r=0;r<$(e).get(0).files.length;r++){var l=$(e).get(0).files[r].name,n=$("<div>",{class:"noteFileName oH font12"});null!=$(e).get(0).files[r]&&(fileSizeEx=$(e).get(0).files[r].size);var s=1e3,o=["Bytes","KB","MB","GB","TB"];if(0===fileSizeEx)return"0 Bytes";var d=parseInt(Math.floor(Math.log(fileSizeEx)/Math.log(s)),10);(fileSizeEx/Math.pow(s,d)).toPrecision(3);fileSize="- ("+(fileSizeEx/Math.pow(s,d)).toPrecision(3)+" "+o[d]+")";var c=$("<span>",{class:"fL flNameSize fontSmoothAntialiased colorblack2",html:$ESAPI.encoder().encodeForHTML(l)+" "+fileSize}),m=$("<span>",{class:"fL mL15 smalledit noteAttachedClose cursorPointer",text:I18n.getMsg("crm.label.remove")});m.click(i),n.append(c),n.append(m),$("#attachMoreFiles").append(n),PremiumChat.totalFileSize=PremiumChat.totalFileSize+fileSizeEx,PremiumChat.fileCount++}return document.getElementsByName("attachments").length-1>=4?(alert(I18n.getMsg("crm.info.attachment.limit")),m.click(),!1):PremiumChat.totalFileSize>10485760||fileSizeEx>10485760?(alert(I18n.getMsg("crm.attach.restriction.rellist")),m.click(),!1):void 0},sendMail:function(){if(void 0===$("#ps_subject").val()||""===$("#ps_subject").val())return alert(I18n.getMsg("crm.support.subject.cannot.be.empty")),!1;var e=Crm.getCrmBasePath()+"/PremiumSupport.do?action=sendMail",t=new FormData;t.append("subject",$("#ps_subject").val()),t.append("summary",$("#ps_summary").val());for(var a=function(e,a){t.append("attachments",a)},i=0;i<document.getElementsByName("attachments").length-1;i++)$.each(document.getElementsByName("attachments")[i].files,a);return t.append(csrfParamName,encodeURIComponent(csrfToken)),$("#feedBackForm").remove(),$.ajax({type:"POST",url:e,processData:!1,contentType:!1,data:t,success:function(e){crmui.showMsgBand("success",I18n.getMsg("crm.email.mail.sent.msg"),3e3)}}),!1}},FeedbackChat={loadChat:function(e,t){FeedbackChat.checkSupport_WorkingDay().then((function(a){if(!a)return renderingUtils.showCustomAlert(I18n.getMsg("crm.chat.not.supported.hour",RebrandLinkUtil.getProperty("SUPPORTMAILID")),"",!1),!1;e?FeedbackChat.isChatAvailable().then((function(e){if(!e)return Lyte.Component.render("crm-chat-outoftime-error",{show:!0,isAdminProfileUser:t},"body"),!1;FeedbackChat.loadChatAfterTimeCheck()}),(function(){FeedbackChat.loadChatAfterTimeCheck()})):FeedbackChat.loadChatAfterTimeCheck()}))},loadChatAfterTimeCheck:function(){try{$zoho.salesiq.visitor.name(Crm.userDetails.DISPLAY_NAME),$zoho.salesiq.visitor.email(Crm.userDetails.LOGIN_NAME),$zoho.salesiq.floatwindow.visible("show")}catch(e){throw showAnimatePopup("live_unavail_alert_popup"),e}},setVisitorInfo:function(e){if($zoho.salesiq.visitor){var t=$zoho.salesiq.visitor.info();t.feature=e,$zoho.salesiq.visitor.info(t)}},getDaysInNumber:function(e){let t={Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6},a="";return e.forEach((function(e){a+=t[e]+","})),a=a.substring(0,a.length-1),a},checkSupport_WorkingDay:function(){let e=RebrandLinkUtil.getProperty("LIVECHAT_WEEKLY_START_TIME"),t=RebrandLinkUtil.getProperty("LIVECHAT_WEEKLY_END_TIME"),a=RebrandLinkUtil.getProperty("LIVECHAT_SUPPORTED_DAYS");return FeedbackChat.checkAndLoadTimingDetails().then((function(){return Crm.timingCheckNeeded&&Crm.ChatSupportTiming&&Crm.ChatSupportTiming.working_days&&Crm.ChatSupportTiming.working_days.days&&(e=Crm.ChatSupportTiming.working_days.from,t=Crm.ChatSupportTiming.working_days.to,a=Crm.ChatSupportTiming.working_days.days),Promise.resolve(FeedbackChat.checkSupport_fromInput(e,t,a))}))},checkSupport_fromInput:function(e,t,a){var i=e.split(":"),r=t.split(":"),l=parseInt(i[0]),n=parseInt(i[1]),s=parseInt(r[0]),o=parseInt(r[1]),d=RebrandLinkUtil.getProperty("DeploymentLocation"),c=!1;null!=d&&"China"==d&&(c=!0);var m=c?-8:-5.5,u=new Date,p=u.getTime()+6e4*u.getTimezoneOffset(),g=new Date(p-36e5*m),v=a.split(","),h=parseInt(v[0]),f=parseInt(v[v.length-1]),y=g.getDay();if(!v.contains(y))return!1;var C=g.getHours(),b=g.getMinutes();if(c){if(!(C>=l&&C<=s))return!1;if(C<17)return!0;if(C==s&&b<=o)return!0}else switch(y){case h:return C>=l&&!(C==l&&b<n);case f:return C<=s&&!(C==s&&b>o);default:return!0}},checkAndLoadTimingDetails:function(){return Crm.timingCheckNeeded?Crm.ChatSupportTiming&&(Crm.ChatSupportTiming.working_days||Crm.ChatSupportTiming.isLoaded)?Promise.resolve(!0):FeedbackChat.loadTimingDetails().then((function(){return Promise.resolve(!0)})):Promise.resolve(!1)},isChatAvailable:function(){return 1!=Crm.userDetails.SUPPORT_TIMING_CHECK_ENABLE?Promise.resolve(!0):Crm.ChatSupportTiming&&(Crm.ChatSupportTiming.from||Crm.ChatSupportTiming.isLoaded)?Promise.resolve(FeedbackChat.timeCheck()):FeedbackChat.loadTimingDetails().then((function(){return Promise.resolve(FeedbackChat.timeCheck())}))},timeCheck:function(){if(!Crm.ChatSupportTiming||!Crm.ChatSupportTiming.from)return!0;let e=Crm.ChatSupportTiming.from.split(":"),t=Crm.ChatSupportTiming.to.split(":"),a=parseInt(e[0]),i=parseInt(e[1]),r=parseInt(t[0]),l=parseInt(t[1]),n=new Date,s=n.getUTCHours(),o=n.getUTCMinutes();if(a>r||a==r&&i>l){if((a>s||a==s&&i>o)&&(s>r||s==r&&o>l))return!1}else if(a>s||a==s&&i>o||s>r||s==r&&o>l)return!1;return!0},loadTimingDetails:function(){var e={url:"crm/v2.2/__internal/users/actions/support_chat_availability_timing",method:"GET",contentType:"application/json"};return store.findAll("dummy",null,!1,!1,e).then((function(e){return Crm.ChatSupportTiming=e.support_chat_availability_timing[0],Crm.ChatSupportTiming.isLoaded=!0,Crm.ChatSupportTiming.working_days&&Crm.ChatSupportTiming.working_days.days&&(Crm.ChatSupportTiming.working_days.days=FeedbackChat.getDaysInNumber(Crm.ChatSupportTiming.working_days.days)),delete Crm.ChatSupportTiming.user,e}),(function(e){return Crm.ChatSupportTiming={isLoaded:!0},e}))},enableTracking:function(){"IN"==RebrandLinkUtil.getProperty("DeploymentLocation")&&Crm.timingCheckNeeded&&$zoho.salesiq.tracking.on()},pathTracking:function(e){"IN"==RebrandLinkUtil.getProperty("DeploymentLocation")&&Crm.timingCheckNeeded&&$zoho.salesiq&&$zoho.salesiq.visitor&&$zoho.salesiq.visitor.customaction(e)}},FingerPrint=FingerPrint||{};FingerPrint.setProperties=function(e,t,a){this.config_properties&&this.config_properties[e]&&(this.config_properties[e][t]=this.config_properties[e][t]||{},"object"==typeof a&&$.extend(FingerPrint.config_properties[e][t],a))},FingerPrint.getFileName=function(e,t){if(FingerPrint.isEnabled&&crmConstants.compression){var a=[],i=e.lastIndexOf(".");return a.push(e.substr(0,i)),a.push(e.substr(i)),null!=t?a[0]+"_"+t+"_"+a[1]:e}return e},FingerPrint.getImageUrl=function(e,t){var a="default"==e?[crmConstants.imgStaticPath,crmConstants.fp_imgStaticPath,crmConstants.cdn_imgStaticPath]:[crmConstants.imagesStaticPathForLyte,crmConstants.fp_imagesStaticPathForLyte,crmConstants.cdn_imagesStaticPathForLyte];if(FingerPrint.isEnabled){var i=FingerPrint.config_properties[e].images?FingerPrint.config_properties[e].images[t]:void 0;return(FingerPrint.isCdnEnabled?a[2]:a[1])+"/"+this.getFileName(t,i)}return a[0]+"/"+t};var crmHistory={length:0,backOneLevel:function(e,t,a){if(!a){var i=$(t).attr("data-params");delete(a=i?JSON.parse(i):{}).clickId,delete a.calleeObj}var r=history.state.data;if(r&&r.backOneLevel){var l=r.backOneLevel.historyIndex,n=Crm.newHistoryArr[l];if(n){if("crm.tab.module.custom-view.list"==n.route&&crmNavig.customViewKey===n.dynamicParams[1]&&("crm.tab.module.entity.detail"===Lyte.Router.getRouteInstance().transition.info.route||"crm.tab.module.entity.canvas"===Lyte.Router.getRouteInstance().transition.info.route)){var s=crmNavig.getRecordNumToId(Lyte.Router.getRouteInstance().transition.info.dynamicParams[1],crmNavig.customViewKey),o=commonUtils.getFromToIndexes(s-1,moduleRecordMapping[n.dynamicParams[0]].per_page),d=crmHistory.getPageDetailsFromIndex(o[0],o[1]);n.queryParams=n.queryParams||{},n.queryParams.page=d.page,n.queryParams.per_page=d.perPage,n.data.fromIndex=o[0],n.data.toIndex=o[1]}var c=Lyte.Router.transitionTo(n);for(var m in n.data&&delete n.data.fetchOnlyBody,c.data=Object.assign({},n.data),a)c.data[m]=a[m]}else crmHistory.handleAptBack()}else{console.error("backOneLevel Not found"),crmHistory.handleAptBack()}},handleAptBack:function(){var e=Lyte.Router.getRouteInstance().transition.info;if(-1!==e.route.indexOf("crm.tab.module"))-1!==e.route.indexOf("crm.tab.module.entity.")?Lyte.Router.transitionTo({route:"crm.tab.module.entity.detail",dynamicParams:[e.dynamicParams[0],e.dynamicParams[1]]}):Lyte.Router.transitionTo({route:"crm.tab.module",dynamicParams:[e.dynamicParams[0]]});else if(-1===e.route.indexOf("crm.settings")||/autoresponders|custom-view|macro|manage-mass-mail/.test(e.route)){var t=e.route.match(/crm.tab.google-adwords|crm.tab.projects|crm.tab.reports|crm.tab.marketplace|crm.tab.forecasts|crm.tab.dashboards|crm.tab.approvals/);t&&t.length>0?Lyte.Router.transitionTo({route:t[0]}):e.queryParams.module?Lyte.Router.transitionTo({route:"crm.tab.module",dynamicParams:[e.queryParams.module]}):Lyte.Router.transitionTo({route:"crm.tab.module",dynamicParams:["Home"]})}else Lyte.Router.transitionTo("crm.settings.index")},backToListView:function(){this.backOneLevel()},getCurrentStateData:function(){return history.state.data},refreshCurrentPage:function(){var e=Lyte.Router.getRouteInstance(),t=e.transition?e.transition.data:{};!0!==t.fromActivityListView&&"cv"!==t.pfrom&&"true"!==t.fromActivityListView||(t.fromDetailView=!0),e.refresh().data=t},getPrevListView:function(){for(var e=Crm.newHistoryArr,t=e.length-1;t>-1;t--){if(/crm.tab.module.custom-view.list|crm.tab.module.custom-view.kanban|crm.global-search|crm.tab.module.actions.approve|crm.tab.module.actions.mass-tools|crm.tab.forecasts.pipeline/.test(e[t].route))return e[t];if("crm.tab.module.begin"===e[t].route&&"Home"===e[t].dynamicParams[0])return e[t]}return!1},back:function(e,t){var a=t&&t.step?t.step:1;$("#taskDetailsPart");a=parseInt(a);var i=$(t);if(t&&i.length){var r=i.attr("data-module");if("Activities"===Crm.activityGrp[r]&&"edit"===window[r].currentStatus&&"true"===$("#iskanbanview").val())return $("#cvEditSave").empty(),hide("cvEditSave"),ActivityMoreInfoContent?$("#entitypopup").html(ActivityMoreInfoContent):taskDetailsview.listAnimation("close"),void(ActivityMoreInfoContent="")}crmHistory.length<=1?crmHistory.handleAptBack():(crmHistory.length=crmHistory.length-a-1,crmHistory.fromProgBack=!0,history.go(-a))},getPageDetailsFromIndex:function(e,t){var a={};e=Number(e),t=Number(t);return isNaN(e)||isNaN(t)||(a.perPage=t-e+1,a.page=t/a.perPage),a},getNewURL:function(e){if(-1===e.indexOf(".do"))return decodeURIComponent(e).indexOf("Voice Of Customer")>-1&&(e=decodeURIComponent(e).replace("Voice Of Customer","voc/analytics")),Crm.getOrgSpecificURL(e);location.pathname;var t=location.search;t=t?JSON.parse('{"'+decodeURI(t.substring(1)).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}'):{};var a=networkUtils.parseUrl(e),i=e.substring(0,e.indexOf(a.action)),r={},l=a.params,n=moduleRecordMapping[l.module],s={accountInfo:"personal-settings",notificationSettings:"sales-signals",viewOrgDetails:"company-details",editFiscal:"fiscal-year",bizhrs:"business-hours",bushrs:"business-hours",holidays:"holidays",currencies:"currencies",emailSettings:"email-settings",aes:"email-sharing",emailParser:"email-parser",emailAuth:"email-auth",bcc:"bcc-dropbox",trackingSettings:"email-insights",orgEmail:"organization-emails",workflow:"workflow-rules",telephony:"telephony",schedules:"schedules",authKey:"phonebridge-token",translation:"translation-settings",translationimporthistory:"translation-history",clientPortal:"client-portal",ZiaOrgConfig:"admin-panel",ZiaSettings:"reminder",ZiaUserConfig:"notification",sentimentModel:"sentiment-model",EventMeetingAuthorize:"meeting"};switch(a.action){case"EditCV":i+="settings/custom-view/"+l.cvid+"/edit?module="+l.module;break;case"GlobalSearch1":i+="search?searchword="+l.searchword,l.sModules&&(i+="&sModules="+l.sModules);break;case"ShowCalendar":i+="calendar?",l.type&&(i+="type="+l.type),l.module&&(i+="&module="+l.sModule),l.obtaineddate&&(i+="&obtaineddate="+l.obtaineddate),l.tdWidthParam&&(i+="&tdWidthParam="+l.tdWidthParam),l.userFetchCnt&&(i+="&userFetchCnt="+l.userFetchCnt),l.isTailLoadCall&&(i+="&isTailLoadCall="+l.isTailLoadCall),l.pageNo&&(i+="&pageNo="+l.pageNo),l.idStr&&(i+="&idStr="+l.idStr),l.searchword&&(i+="&searchword="+l.searchword),l.searchCategory&&(i+="&searchCategory="+l.searchCategory);break;case"tab":"Setup"==l.module?i+="settings/index":"Google Adwords"==l.module||"Google%20Adwords"==l.module||"Google AdWords"==l.module||"Google%20AdWords"==l.module?i+="tab/Google%20AdWords":i=i+"tab/"+l.module;break;case"EntReply":i=Crm.getCrmBasePath()+"/tab/"+l.module+"/"+l.entId+"/send-mail?action="+l.action+"&entityMail="+l.entityMail;break;case"ShowHomePage":i+="tab/Home/begin";break;case"Migration":i+="settings/migration";break;case"CustomReport":-1==i.indexOf("/crm/CustomReport/")&&(i=Crm.getCrmBasePath()+"/tab/Reports/"+l.reportId+"?folderId="+l.folderId+"&repType=tabular");break;case"showMacro":l.ruleId&&(i=i+"settings/macro/"+l.ruleId,l.module&&(i=i+"?module="+l.module));break;case"ShowSetup":switch(-1==(i+="settings/").indexOf("/crm/settings/")&&(i=Crm.getCrmBasePath()+"/settings/"),l.subTab){case"accountInfo":case"notificationSettings":case"viewOrgDetails":case"editFiscal":case"currencies":case"bizhrs":case"aes":case"emailParser":case"emailAuth":case"bcc":case"trackingSettings":case"orgEmail":case"schedules":case"authKey":case"translation":case"translationimporthistory":case"clientPortal":case"pbxreg":case"holidays":i+=s[l.subTab];break;case"emailSettings":i=i+s[l.subTab]+"?action="+l.action,l.isFromSI&&(i=i+"&isFromSI="+l.isFromSI);break;case"telephony":i+=s[l.subTab],validationUtils.isNotEmpty(l.ctiname)?i=i+"/summary/"+l.ctiname:i+="/marketplace";break;case"chat":i=i+"extensions/zoho/"+l.appname;break;case"gameSettings":i+="game-settings";break;case"users":i+=l.subTab,l&&l.reqZUID&&(i+="?reqZUID="+l.reqZUID);break;case"activate":i+="activate-users";break;case"viewUser":i=i+"users/"+l.userId;break;case"bushrs":"viewBusinessHours"==l.action?i+="business-hours":"createShiftHours"==l.action?i+="business-hours/createShiftHours":("viewShiftHours"==l.action||"editShiftHours"==l.action)&&(i=i+"business-hours/"+l.shiftid);break;case"ZiaOrgConfig":case"ZiaUserConfig":case"ZiaSettings":i=i+"zia/"+s[l.subTab];break;case"Groups":i+="groups","viewGroup"==l.action&&(i=i+"/"+l.groupId);break;case"Profiles":i+="profiles",l.profileId&&(i=i+"/"+l.profileId);break;case"Roles":i+="roles",l.roleId&&(i=i+"/"+l.roleId);break;case"SharingSetting":i+="data-sharing";break;case"movetoOrg":i+="allowed-ips";break;case"zmailusers":i+="zmail-users";break;case"enableTerritory":case"assignTerritory":break;case"territoryRules":"territoryRules"===l.action&&(i+="/territory-rules");break;case"modules":if(i+="modules",l.module)if(i=i+"/"+l.module,"formRules"===l.innerTab){if(i+="/layout-rules",l.formRuleId){i=i+"/"+l.formRuleId+"?layoutId="+l.layoutId;break}}else if("layouts"===l.innerTab){if("dependency"===l.isLoadPage){i+="/map-dependency",l.layoutId&&(i=i+"?layoutId="+l.layoutId);break}if("mapping"===l.isLoadPage){i+="/conversion-mapping",l.leadLayoutId&&(i=i+"?leadLayoutId="+l.leadLayoutId);break}if(i=i+"/"+l.innerTab,l.layoutId&&(i=i+"/"+l.layoutId,l.actionType&&"createLayout"===l.actionType)){i+="/clone";break}}else if("moduleInfo"===l.innerTab)i+="/summary";else if("fields"===l.innerTab)l.isFieldPermission?(i+="/field-permissions",l.profileId&&(i=i+"?profileId="+l.profileId)):(i+="/field-listing",l.layoutId&&-1!=l.layoutId&&(i=i+"?layoutId="+l.layoutId));else{if("cusLink"==l.innerTab){i+="/links-and-buttons","createCustomButton"===l.step?i+="/create?component=button":"editCustomButton"===l.step&&(i=i+"/"+l.buttonId),l.layoutId&&-1!=l.layoutId&&(i=i+"?layoutId="+l.layoutId);break}if("validationRules"==l.innerTab){if(i+="/validation-rules",l.validationRuleId){i=i+"/"+l.validationRuleId+"?layoutId="+l.layoutId;break}break}i=i+"/"+l.innerTab}l.step&&(i=i+"/"+l.step),l.buttonId&&(i=i+"/"+l.buttonId),l.component&&(i=i+"/"+l.component);break;case"tabGroup":i+="tab-groups";break;case"webTabs":i+="web-tabs";break;case"inventory":case"mailmerge":case"email":i=i+"templates?type="+("mailmerge"==l.subTab?"mail-merge":l.subTab)+"&","newEmailTemplate"===l.step||"newInventoryTemplate"===l.step?(i+="step=create&",l.templateName&&(i+="templateName="+l.templateName+"&selectedcategory="+l.selectedcategory+"&")):"editEmailTemplate"===l.step||"editInventoryTemplate"===l.step?i+="step=edit&templateId="+l.emailTemplateId+"&":"cloneEmailTemplate"===l.step||"cloneInventoryTemplate"===l.step?i+="step=clone&templateId="+l.emailTemplateId+"&":"showGallery"===l.step||"showInventoryGallery"===l.step?i+="step=showGallery&":"showAllTemplates"!==l.step&&"showInventoryTemplates"!==l.step||!l.emailTemplateId||(i+="templateId="+l.emailTemplateId+"&"),l.module&&(i+="module="+l.module+"&"),l.folder&&(i+="folder="+l.folder),i=i.endsWith("&")?i.substring(0,i.length-1):i;break;case"resellerLgin":i+="copy-customization";break;case"workflow":i+=s[l.subTab],"newRule"==l.step&&(i+="/create",l.module&&(i=i+"?module="+l.module)),l.ruleId&&(i=i+"/"+l.ruleId,l.module&&(i=i+"?module="+l.module)),l.actionId&&(i=i+"?actionId="+l.actionId);break;case"insight":i+="workflow-insights",l.step&&(i=i+"?step="+l.step,l.module&&(i=i+"&module="+l.module),l.processId&&(i=i+"&processId="+l.processId));break;case"process":i+="blueprint","getProcessDetails"==l.action&&l.processId&&(i=i+"/"+l.processId,l.module&&(i=i+"?module="+l.module));break;case"usage":i+="blueprint-usage",l.action&&(i=i+"?action="+l.action,l.reportId&&(i=i+"&reportId="+l.reportId));break;case"setting":i+="blueprint-setting",l.action&&(i=i+"?action="+l.action);break;case"alert":if(i+="workflow-alerts",l.step){switch(l.step){case"newAlert":i+="/create";break;case"viewAlert":case"showAlert":i=i+"/"+l.alertId;break;case"editAlert":i=i+"/"+l.alertId+"/edit"}l.module&&(i=i+"?module="+l.module)}break;case"task":if(i+="workflow-tasks",l.step){switch(l.step){case"newTask":i+="/create";break;case"showTask":i=i+"/"+l.taskId;break;case"editTask":i=i+"/"+l.taskId+"/edit"}l.module&&(i=i+"?module="+l.module)}break;case"fieldUpdate":if(i+="workflow-field-updates",l.step){switch(l.step){case"newFieldUpdate":i+="/create";break;case"showFieldUpdate":i=i+"/"+l.fieldUpdateId;break;case"editFieldUpdate":i=i+"/"+l.fieldUpdateId+"/edit"}l.module&&(i=i+"?module="+l.module)}break;case"webhook":if(i+="workflow-webhooks",l.step){switch(l.step){case"newWebHook":i+="/create";break;case"showWebHook":i=i+"/"+l.webHookId;break;case"editWebHook":i=i+"/"+l.webHookId+"/edit"}l.module&&(i=i+"?module="+l.module)}break;case"wfdeluge":i+="workflow-deluge",l.delugeId&&(i=i+"?delugeId="+l.delugeId);break;case"cfSchedulers":i+="schedules";break;case"webLeads":i+="webform";break;case"autoRespRules":i+="auto-response-rules","viewAutoRespRuleEntries"===l.action?i=i+"?action=viewAutoRespRuleEntries&ruleId="+l.ruleId+"&ruleName="+l.ruleName+"&module="+l.seModule:l.seModule&&(i=i+"?module="+l.seModule);break;case"unsubscribe":i+="unsubscribe-link";break;case"assignmentRules":if(i+="assignment-rules",l.action)switch(l.action){case"viewRules":l.seModule&&(i=i+"?module="+l.seModule);break;case"viewRuleEntries":i=i+"/"+l.ruleId,l.seModule&&(i=i+"?module="+l.seModule);break;case"editRuleEntry":i=i+"/"+l.ruleId,l.seModule&&(i=i+"?module="+l.seModule),l.entryId&&(i=i+"&entryId="+l.entryId)}else l.seModule&&(i=i+"?module="+l.seModule);break;case"escalationRules":if(i+="escalation-rules",l.action)switch(l.action){case"viewEscRuleEntries":i=i+"/"+l.ruleId;break;case"viewEscalationsOfEscRuleEntry":i=i+"/"+l.ruleId+"?entryId="+l.entryId}break;case"approvalProcess":i+="approval-process",l.processId&&(i=i+"/"+l.processId);break;case"scoringRules":i+="scoring-rules";break;case"zohoApps":var o=l.appname;l.appname?"viewInvoiceIntegration"===l.appname?o="finance-suite":"zohomeeting"===l.appname&&(o="meeting"):o="apps",i=i+"extensions/zoho/"+o;break;case"googleUsers":case"googleAdwords":case"googleContacts":case"googleMail":case"googleDocs":case"googleCalendar":case"googleSites":case"googleTasks":i=i+"extensions/google/"+l.subTab.split("google")[1].toLowerCase();break;case"googleApps":i=i+"extensions/google/"+$u.invert(crmHistory.getGAppsRoutevsAction())[l.appname];break;case"googleChromeExt":i+="extensions/google/chrome-ext";break;case"microsoftApps":i+="extensions/microsoft/office-365";break;case"microsoftoutlook":i+="extensions/microsoft/outlook";break;case"microsoftword":i+="extensions/microsoft/word";break;case"twitter":case"facebook":i=i+"extensions/social/"+l.subTab;break;case"googleplus":i+="extensions/social/google-plus";break;case"socialaccounts":i+="extensions/social/brands";break;case"socialadmin":i+="extensions/social/admin-settings";break;case"leadgen":i+="extensions/social/lead-gen";break;case"marketPlace":if(i+="extensions/all",l.nameSpace){i=Object.keys(Events.displayToolName).contains(l.nameSpace)?i+"/meeting-integration?toolname="+l.nameSpace:i+"/"+l.nameSpace;var d="?";for(var c in l)"nameSpace"===c&&"tab"===c&&"subTab"===c||(d+=c+"="+l[c]+"&");d.length>1&&!Object.keys(Events.displayToolName).contains(l.nameSpace)&&(i+=d)}break;case"skyeye":i+="extensions/skyeye";break;case"otherApps":"telephony"==l.appname?(i+="telephony",validationUtils.isNotEmpty(l.ctiname)?i=i+"/summary/"+l.ctiname:i+="/marketplace"):(i+="webInteg/other-apps/otherApps",l.appname&&(i=i+"/"+l.name));break;case"api":var m=l.action||l.step;switch(m){case"developerapi":i+="api";break;case"topUsage":i+="api/usage/graph-view?",i+=(u=l.from||t.from)?"from="+u+"&":"",i+=(p=l.to||t.to)?"to="+p+"&":"",i+=(g=l.period||t.period)?"period="+g+"&":"",i=(i+=(v=l.type||t.type)?"type="+v:"").endsWith("&")||i.endsWith("?")?i.substring(0,i.length-1):i;break;case"statistics":i+="api/usage/table-view?";var u=l.from||t.from,p=l.to||t.to,g=l.period||t.period,v=l.type||t.type,h=l.order||t.order;i+=u?"from="+u+"&":"",i+=p?"to="+p+"&":"",i+=g?"period="+g+"&":"",i+=v?"type="+v+"&":"",i=(i+=h?"order="+decodeURIComponent(h):"").endsWith("&")||i.endsWith("?")?i.substring(0,i.length-1):i;break;case"ModulesList":i+="api/modules";break;case"FieldsList":case"RelatedList":i=i+"api/modules/"+l.module+"?step="+m}break;case"zscKey":i+="zsc-key";break;case"widgets":i+="widgets";break;case"functions":i+="functions";break;case"crmconnectors":i+="connections";break;case"crmvariables":i+="crmvariables",l.variableId?(i=i+"/"+l.variableId,l.groupId&&(i=i+"?groupId="+l.groupId)):l.groupId&&(i=i+"/create?groupId="+l.groupId);break;case"migrate":case"importHistory":i+="import-history";break;case"export":i+="export-data";break;case"backup":i+="data-backup";break;case"storageUsage":i+="storage";break;case"recyclebin":i+="recyclebin";break;case"auditLog":i+="auditlog";break;case"removeSampleData":i+="remove-sample-data";break;case"sandbox":i+="sandbox"}break;case"ShowTab":if("Setup"==l.module)i+="settings/index";else if("Google Adwords"==l.module||"Google%20Adwords"==l.module||"Google AdWords"==l.module||"Google%20AdWords"==l.module)i+="tab/Google%20AdWords";else if("Approvals"==l.module||"Reports"==l.module||"Dashboards"==l.module||"Forecasts"==l.module||"Emails"==l.module||"SalesInbox"==l.module||"Desk"==l.module||"Projects"==l.module)i=i+"tab/"+l.module;else if("Home"==l.module)i+="tab/Home/begin";else if(i=i+"tab/"+l.module,"Feeds"===l.module||"OneFeeds"==l.module)l.action&&(i.indexOf("?")>-1?i+="&action="+l.action:i+="?action="+l.action),l.id&&(i.indexOf("?")>-1?i+="&id="+l.id:i+="?id="+l.id),l.key&&(i.indexOf("?")>-1?i+="&key="+l.key:i+="?key="+l.key);else{if("true"!=l.webTab&&(l.cvid||(l.cvid=n.cvid,l.viewid=n.viewid),i=n.viewid?i+"/custom-view/"+l.cvid+"/canvas/"+n.viewid:i+"/custom-view/"+l.cvid+"/list"),delete l.webTab,delete l.module,delete l.cvid,delete l.viewid,l.fromIndex){var f=this.getPageDetailsFromIndex(l.fromIndex,l.toIndex);i+="?page="+f.page+"&per_page="+f.perPage}l.sortOrderString&&(r.sortOrder=l.sortOrderString,r.sortColumn=l.sortColumnString)}break;case"EntityInfo":i="Activities"!==Crm.activityGrp[l.module]||n.visible?"true"==l.showShared?i+"tab/"+l.module+"/"+l.id+"?showShared=true":i+"tab/"+l.module+"/"+l.id+"/":i+"tab/Activities/"+l.id+"?sub_module="+l.module;break;case"Dashboard":"showDashboard"==l.action&&l.dbId&&(i=i+"tab/Dashboards/"+l.dbId);break;case"CreateEntity":if(i="Activities"==Crm.activityGrp[l.module]?i+"tab/Activities/create?sub_module="+l.module:i+"tab/"+l.module+"/create",-1!=e.indexOf("#"))i=i+"#"+e.split("#")[1];break;case"CloneEntity":i="Activities"==Crm.activityGrp[l.module]?i+"tab/Activities/"+l.id+"/clone?sub_module="+l.module:i+"tab/"+l.module+"/"+l.id+"/clone";break;case"EditEntity":i="Activities"==Crm.activityGrp[l.module]?i+"tab/Activities/"+l.id+"/edit?sub_module="+l.module:i+"tab/"+l.module+"/"+l.id+"/edit";break;case"Import":i+="settings/import";break;case"Template":if("exportPDF"===l.action)i=i+"tab/"+l.module+"/"+l.entityId+"/export-pdf";else i=e;break;case"MassEmailRecords":i=i+"tab/"+l.module+"/actions/mass-email";break;case"IAMSecurityError":i+="iam-security-error";break;case"RoleForecast":case"TerritoryForecast":if(i+="tab/Forecasts","createForecast"==l.action)i+="/create";else if("viewForecast"==l.action){delete l.module,delete l.action;var y=0;for(var c in l)i+=0==y?"?":"&",i+=c+"="+l[c],y++}else"editForecastSettings"==l.action&&(i+="/editSettings");break;case"approvalProcess":if("detailedView"==l.action){if(i+="tab/Approvals/view?entityId="+l.entityId+"&recModule="+l.recModule,l.triggerAction){var C="";"approve"==l.triggerAction?C="Approval":"delete"==l.triggerAction?C="Delete":"reject"==l.triggerAction&&(C="Reject"),i+="&triggerAction="+C}break}default:i=e}return Crm.getOrgSpecificURL(i)},getState:function(){var e={url:window.location.href,title:document.title};return window.history.state?e.data=window.history.state.data:e.data={},e},getGAppsRoutevsAction:function(){return{users:"showZGUsers",contacts:"showZGContacts",mail:"showZGMail",docs:"showZGDocs",calendar:"showZGCal",adwords:"showZGAdword",sites:"showZGSite","chrome-ext":"showChromeExt",tasks:"showZGTask"}}};function quickCreateValidateAction(e,t,a){var i="100%",r=$("#qCreate"),l=r.find(".qcontainer").outerHeight();if("Remind At"===e){if(("Tasks"==(g=$("form[name="+a+"]").find("input[id=quick_module]").val())||"Events"==g)&&getElm(a,"remCheckTask")){var n=null,s=null,o=null,d=null,c=null;if("Tasks"==g){var m=!1;if(getElm(a,"property(Recurring Activity)")&&getElm(a,"property(Recurring Activity)").checked&&(m=!0),getElm(a,"remCheckTask").checked&&!m&&getElm(a,"periodBased")&&!getElm(a,"periodBased").checked){if(!emptyCheck("property(Remind At)","Remind At"))return!1;if(!dateValidate("property(Remind At)","Remind At",""))return!1;if(getElm(a,"property(Due Date)")&&""!=getElm(a,"property(Due Date)").value&&Utils.isValidDate(Crm.userDetails.DATE_PATTERN,getElm(a,"property(Due Date)").value)&&!dateComparison("property(Remind At)","Remind At","property(Due Date)","Due Date","LE"))return!1}if(c=" ",n=getElm(a,"property(Remind At)").value,getElm(a,"periodBased")&&getElm(a,"periodBased").checked&&(c=getElm(a,"remTimeOn").value+" "+getElm(a,"remTimePeriod").value,getElm(a,"remTime").value=c,n=getElm(a,"property(Due Date)").value,getElm(a,"property(Remind At)").value=n,getElm(a,"property(Remind Athour)").value=getElm(a,"property(Remind At1hour)").value,getElm(a,"property(Remind Atminute)").value=getElm(a,"property(Remind At1minute)").value,$("#dateBasedRemindAtTime").val($("#periodBasedRemindAtTime").val()),"HH:mm"!=Crm.userDetails.TIME_FORMAT&&(getElm(a,"property(Remind Atampm)").value=getElm(a,"property(Remind At1ampm)").value,$('[id="Remind At_ampmSpan"]').text($('[id="Remind At1_ampmSpan"]').text()))),s=getElm(a,"property(Remind Athour)").value,o=getElm(a,"property(Remind Atminute)").value,"HH:mm"!=Crm.userDetails.TIME_FORMAT&&(d=getElm(a,"property(Remind Atampm)").value),m)return!0}"Events"==g&&(n=getElm(a,"property(Start DateTime)").value,getElm(a,"property(Recurring Activity)")&&getElm(a,"property(Recurring Activity)").checked&&(n=getElm(a,"property(Start Date1)").value),s=getElm(a,"property(Start DateTimehour)").value,o=getElm(a,"property(Start DateTimeminute)").value,"HH:mm"!=Crm.userDetails.TIME_FORMAT&&(d=getElm(a,"property(Start DateTimeampm)").value),c=getElm(a,"remTime").value);var u=!1,p={date:n,hour:s,minute:o,ampm:d,eventBefore:c};return Activities.checkForReminderDate(p,(function(e){if("true"==e)return $("#reminderValidationMsg").text(I18n.getMsg("crm.noreminder.atspecdate")),u=!1,!1;u=!0,$("[name="+a+"] [id=remindAtInfo]").text($("select[name=alertType] option:selected").text()),$("[name="+a+"] [id=quickRemindChk]").attr("checked",!0),$("[name="+a+"] [id=quickTaskDefault]").css({left:"0px"}),$("[name="+a+"] [id=quickRemindAt]").css({left:i}),quickTask.createReminder()})),0==u?!1:("Tasks"!==g&&$("#remindAtInfo").hasClass("BT")&&$("#remindAtInfo").append('<span class="taskPopDescSpan" >'+n+"  -  "+s+":"+o+" "+(void 0!==d?d:"")+"</span>"),"salesinbox"==Q.source&&r.css("height",l),!0)}}else if("Recurring"===e){var g;if("Tasks"!=(g=$("form[name="+a+"]").find("input[id=quick_module]").val())&&isRecurringActivity(g)&&($("[name="+a+"] [id=qRecInfo]").text($("select[name=period] option:selected").text()),$("[name="+a+"] [id=quickRecurringChk]").prop("checked",!0),$("[name="+a+"] [id=quickTaskDefault]").css({left:"0px"}),$("[name="+a+"] [id=quickRecurring]").css({left:i})),"salesinbox"==Q.source&&r.css("height",l),"Tasks"==g){$("[name="+a+"] [id=recurAtCheckbox]").prop("checked",!0);var v=$("[name='"+a+"'] input[name='property(Recurring Activity)']"),h=$("[name='"+a+"'] input[name='property(Remind At)']");v.length&&h.length&&v.prop("checked")?-1!=a.indexOf("ctiapi")&&(getElm(a,"remTime").className="select",h.attr("class","hide")):h.length;var f=getElm(a,"period").value;if("custom"!=f&&"none"!=f){var y=crmCalendar.getDateObjectFromGivenDateString($("#Crm_Tasks_DUEDATE").val());"daily"==f?getElm(a,"dailyhidden").value=1:"weekly"==f?$("[name="+a+"] input[name='day"+(y.getDay()+1)+"']").prop("checked",!0):"monthly"==f?(getElm(a,"noMonths1").value=1,getElm(a,"monthlyhidden").value=1,getElm(a,"monthly1select").value=y.getDate()):"yearly"==f&&(getElm(a,"yearlyhidden").value=1,getElm(a,"yearmonths").value=y.getMonth(),getElm(a,"yearlydays1select").value=y.getDate())}else"custom"==f&&"none"!=f&&"monthly"==getElm(a,"customPeriod").value&&(getElm(a,"noMonths2").value=getElm(a,"noMonths1").value);return getElm(a,"endRadioOption").value=$('.qc_rec_content [name="qc_rec_ends"]:checked').val(),$("[name="+a+"] input[name='property(Recurring Activity)']").prop("checked")&&$("[name="+a+"] input[name='remCheckTask']").prop("checked")&&"none"!=$("[name="+a+"] select[name='remTaskRepeat']").val()&&quickTask.offReminder(),!0}}else if("All"===e){if(("Events"==t||"Tasks"==t)&&$("[name="+a+"] input[name='property(Recurring Activity)']").prop("checked")&&$("[name="+a+"] input[name='remCheckTask']").prop("checked")&&"none"!=$("[name="+a+"] select[name='remTaskRepeat']").val())return alert(I18n.getMsg("crm.norepreminder.recurring")),!1;if("Tasks"===t&&"custom"==getObj("period").value)switch(getObj("customPeriod").value){case"daily":getObj("weeklyhidden").value=1,getObj("noMonths1").value=1,getObj("noMonths2").value=1;break;case"weekly":getObj("daily111").value=1,getObj("noMonths1").value=1,getObj("noMonths2").value=1;break;case"monthly":getObj("daily111").value=1,getObj("weeklyhidden").value=1;break;case"yearly":getObj("daily111").value=1,getObj("weeklyhidden").value=1,getObj("noMonths1").value=1,getObj("noMonths2").value=1}var C=qComboCount-1;if(C>0)for(var b=1;b<=C;b++)for(var T=0,I=getElm(a,"comboValue"+b).length,w=0;w<I;w++)1==getElm(a,"comboValue"+b).options[w].selected?(getElm(a,"combo"+b).value=0==T?getElm(a,"comboValue"+b).options[w].value:getElm(a,"combo"+b).value+";"+getElm(a,"comboValue"+b).options[w].value,T++):0==T&&(getElm(a,"combo"+b).value="");if("Calls"==t&&getElm(a,"property(Call Duration)")&&(getElm(a,"property(Call Duration)").value=getCallDuration(a)),!formValidate(a))return!1;if("Cases"==t){var L=getElm(a,"property(Case Origin)"),k="property(Email)";if(L)if("Email"==L.options[L.options.selectedIndex].value&&getElm(a,k)&&!emptyCheck(k,"Email"))return!1}document[a],t.toUpperCase().substring(0,t.length-1);var P,D=new RegExp("^comboValue"),M=(I=document[a].elements.length,document[a].elements);for(w=0;w<I;w++)if((P=M[w])&&D.test(P.name)&&-1===a.indexOf("ctiapi"))try{$(P).remove(),w--}catch(e){}return!0}}function selectCreateEntityAction(e,t,a,i){if(i&&-1==a.indexOf("createEntityForm")){var r=i.target;a=$(r).closest("form")[0].name}var l=getObj("comboCount").value;if(t=getObj("module").value,l>0)for(var n=1;n<=l;n++){var s=0;if(getElm(a,"comboValue"+n))for(var o=0;o<getElm(a,"comboValue"+n).length;o++)1==getElm(a,"comboValue"+n).options[o].selected?(getElm(a,"combo"+n).value=0==s?getElm(a,"comboValue"+n).options[o].value:getElm(a,"combo"+n).value+";"+getElm(a,"comboValue"+n).options[o].value,s++):0==s&&(getElm(a,"combo"+n).value="")}if(("Contacts"==t||"Leads"==t)&&getObj("property(Twitter)")){var d=getObj("property(Twitter)").value;if(d.trim().length>50)return alert(I18n.getMsg("crm.tw.err.max.twHandleName",I18n.getMsg(singularModule))),!1;if(d.trim().length<50&&d.trim().length>0){if(!/^[a-zA-Z0-9_]*$/.test(d))return alert(I18n.getMsg("crm.tw.err.twHandleName.patterenCheck",I18n.getMsg(singularModule))),!1}}if("Events"==t){if(getElm(a,"invitees")){var c=getElm(a,"invitees").value.split(","),m=new RegExp("^\\w+((-\\w+)|(\\.\\w+))*\\@[A-Za-z0-9]+((\\.|-)[A-Za-z0-9]+)*\\.[A-Za-z0-9]+$");for(n=0;n<c.length;n++)if(""!=c[n]&&!m.test(trimBoth(c[n])))return alert(I18n.getMsg("crm.email.check",I18n.getMsg(singularModule))),getElm(a,"invitees").focus(),!1}}else if("Cases"==t){var u=getElm(a,"property(Case Origin)");if(u.options[u.options.selectedIndex].value==I18n.getMsg("Email")&&getElm(a,"property(Email)")&&!emptyCheck("property(Email)","Email"))return!1}else if("Leads"==t||"Accounts"==t||"Vendors"==t){var p=getElm(a,"property(Website)")?getElm(a,"property(Website)").value.trim():"";if(null!=p&&""!=p&&!isValidWebURL("Website",p))return!1}else if("Calls"==t)$("#timesData #sdiv").hide(),$(".AmpmnewValues").addClass("hide"),getElm(a,"property(Call Duration)")&&(getElm(a,"property(Call Duration)").value=getCallDuration(a)),getElm(a,"property(Call Start Timehour)")&&(getElm(a,"property(Call Start Timehour)").disabled=!1,getElm(a,"property(Call Start Timeminute)").disabled=!1,getElm(a,"property(Call Start Timeampm)").disabled=!1);else if(Crm.isInventoryModule(t)){if(settotalnoofrows(),!inventoryValidate())return!1;if("Invoices"==t){var g=0;for(o=1;o<=rowCnt;o++)getElm(a,"hdnQtyStock"+o).value<=0&&1==++g&&getElm(a,"txtProduct"+o).value;if(1==g){if(!window.confirm(getElm(a,"confirmvalid").value))return!1}else if(g>1&&!window.confirm(getElm(a,"confirmvalid").value))return!1}var v=getElm(a,"currentSelectedRow");null!=v&&-1!=v.value&&calcTotal(getElm(a,"txtQty"+parseInt(v.value)))}else if("PriceBooks"==t)if(getElm(a,"secDivPricing Details")&&"block"==getElm(a,"secDivPricing Details").style.display||""==getElm(a,"secDivPricing Details").style.display){if(!priceListValidate())return!1;getElm(a,"totalPriceCount").value=priceRowCount}else getElm(a,"totalPriceCount").value=0;else"Potentials"==t&&calculateExpectedRevenue();if(("Events"==t||"Tasks"==t)&&!isRecurringActivity(t))return!1;if("Tasks"==t&&getElm(a,"remCheckTask")){var h=!1;if(getElm(a,"property(Recurring Activity)")&&getElm(a,"property(Recurring Activity)").checked&&(h=!0),getElm(a,"remCheckTask").checked&&!h){if(!emptyCheck("property(Remind At)","Remind At"))return!1;if(!dateValidate("property(Remind At)","Remind At",""))return!1}else getElm(a,"property(Remind At)").value=""}if(("Events"==t||"Tasks"==t)&&getElm(a,"property(Recurring Activity)")&&getElm(a,"property(Recurring Activity)").checked&&getElm(a,"remCheckTask")&&getElm(a,"remCheckTask").checked&&"none"!=getElm(a,"remTaskRepeat").value)return alert(I18n.getMsg("crm.norepreminder.recurring",I18n.getMsg(singularModule))),!1;if(!pageValidate(a))return!1;if(("Tasks"===t||"Events"===t)&&getElm(a,"remCheckTask")&&getElm(a,"remCheckTask").checked||"Calls"===t&&"ScheduleCall"===jQuery("input[name=whichCall]:checked").val()&&getElm(a,"remTime")&&"0"!==getElm(a,"remTime").value){var f,y,C,b,T,I;if("Tasks"==t&&(f=getElm(a,"property(Remind At)").value,T=" ",getElm(a,"property(Recurring Activity)")&&getElm(a,"property(Recurring Activity)").checked&&(f=getElm(a,"property(Start Date1)").value,T=getElm(a,"remTime").value),y=getElm(a,"property(Remind Athour)").value,C=getElm(a,"property(Remind Atminute)").value,"HH:mm"!==Crm.userDetails.TIME_FORMAT&&(b=getElm(a,"property(Remind Atampm)").value),getElm(a,"dtPtn_property(Remind At)").innerHTML),"Events"==t&&(f=getElm(a,"property(Start DateTime)").value,getElm(a,"property(Recurring Activity)")&&getElm(a,"property(Recurring Activity)").checked&&(f=getElm(a,"property(Start Date1)").value),y=getElm(a,"property(Start DateTimehour)").value,C=getElm(a,"property(Start DateTimeminute)").value,"HH:mm"!=Crm.userDetails.TIME_FORMAT&&(b=getElm(a,"property(Start DateTimeampm)").value),getElm(a,"dtPtn_property(Start DateTime)").innerHTML,T=getElm(a,"remTime").value),"Calls"===t&&(f=getObj("property(Call Start Time)").value,y=getObj("property(Call Start Timehour)").value,C=getObj("property(Call Start Timeminute)").value,"HH:mm"!==Crm.userDetails.TIME_FORMAT&&(b=getObj("property(Call Start Timeampm)").value),getObj("dtPtn_property(Call Start Time)").innerHTML,T=getObj("remTime").value),""==f||""==y||""==C)return!1;var w={date:f,hour:y,minute:C,ampm:b,eventBefore:T};if(Activities.checkForReminderDate(w,(function(i){"true"==i?(alert(I18n.getMsg("crm.noreminder.atspecdate",I18n.getMsg(singularModule))),I=!1):"Tasks"==t&&"Create&AddToZG"==e?checkForGTaskList(e,t):viewEntityInfo(e,t,a)})),0==I)return!1}else"Tasks"==t&&"Create&AddToZG"==e?checkForGTaskList(e,t):(crmTab.emptyCache(),viewEntityInfo(e,t,a));return!1}function viewEntityInfo(e,t,a){if(a&&"undefined"!==a&&"null"!==a||(a=$("[name^=createEntityForm]")[0].name),getObj("property(Probability)")&&getObj("property(Probability)").value>100)return alert(I18n.getMsg("crm.create.pbty.check",I18n.getMsg(singularModule))),!1;if(null!=document[a].elements["property(Portal User)"]&&document[a].elements["property(Portal User)"].checked){if(null==document[a].elements["property(Email)"])return alert(I18n.getMsg("crm.alert.portal.email.check",I18n.getMsg(t))),!1;if(!emptyCheck("property(Email)","Email"))return!1}if("Create&New"==e){var i=formData2QueryString(document[a],t),r=Crm.getCrmBasePath()+"/CreateCommonModuleandNew.do";l=(l=i)+"&"+csrfParamName+"="+encodeURIComponent(csrfToken),document.getElementById("iskanbanview")&&"true"===document.getElementById("iskanbanview").value&&(ActivityMoreInfoContent="none"),ajaxNew(r,l)}else if("Create&NewFUTask"==e){i=formData2QueryString(document[a],t),r=Crm.getCrmBasePath()+"/CreateCommonModuleandNew.do";l=(l=i)+"&"+csrfParamName+"="+encodeURIComponent(csrfToken)+"&futask=1",ajaxNew(r,l)}else if("Edit&NewFUTask"==e){i=formData2QueryString(document[a],t),r=Crm.getCrmBasePath()+"/CreateCommonModuleandNew.do";l=(l="ActionType=Edit&"+i)+"&"+csrfParamName+"="+encodeURIComponent(csrfToken)+"&futask=1",ajaxNew(r,l)}else if("Create&AddToZG"==e){i=formData2QueryString(document[a],t),r=Crm.getCrmBasePath()+"/CreateCommonModule.do";l=(l="ActionType=AddToZG&"+i)+"&"+csrfParamName+"="+encodeURIComponent(csrfToken),ajaxNew(r,l)}else if("Edit&New"==e){i=formData2QueryString(document[a],t),r=Crm.getCrmBasePath()+"/CreateCommonModuleandNew.do";l=(l="ActionType=Edit&"+i)+"&"+csrfParamName+"="+encodeURIComponent(csrfToken),ajaxNew(r,l)}else if("Create"==e){i=formData2QueryString(document[a],t),r=Crm.getCrmBasePath()+"/CreateCommonModule.do";l=(l=i)+"&"+csrfParamName+"="+encodeURIComponent(csrfToken),"Events"==t&&(l+="&createdFrom="+$("#createFromHid").val()),taskKanbanViewCache&&"false"!==taskKanbanViewCache?document.getElementById("cvEditSave")&&($("#cvEditSave").empty(),hide("cvEditSave")):(commonUtils.showHideLoadingDiv(),taskDetailsview.listAnimation("close")),ajaxNew(r,l)}else if("Edit"==e){i=formData2QueryString(document[a],t),r=Crm.getCrmBasePath()+"/EditCommonModule.do";var l="lookback=true&ActionType=Edit&"+i;if(iskvFollowupEdit=!0,iskvFollowupTask=!0,getObj("viewType")&&"CalendarView"==getObj("viewType").value){document[a];for(var n,s=t.toUpperCase().substring(0,t.length-1)+"CF",o=new RegExp("^"+s),d=new RegExp("^comboValue"),c=document[a].elements.length,m=document[a].elements,u=0;u<c;u++)if((n=m[u])&&"hidden"==n.type&&("fieldname"==n.name||"dateFields"==n.name||"fieldlabel"==n.name||"fielddatatype"==n.name||"picklistFields"==n.name||"fieldvalues"==n.name||"mapValues"==n.name||"fieldName"==n.name||"fieldLabel"==n.name||"fieldDatatype"==n.name||"fieldUitype"==n.name||"fieldId"==n.name||"fieldTableName"==n.name||"fieldLen"==n.name||n.name.indexOf("uiType_")>=0||o.test(n.name)||d.test(n.name)))try{n.parentNode.removeChild(n),u--}catch(e){}var p=document.createElement("INPUT");p.type="hidden",p.value=encodeURIComponent(csrfToken),p.name=csrfParamName,document[a].appendChild(p),document[a].action=r+"?ActionType=Edit",document[a].method="post",l=l+"&"+csrfParamName+"="+encodeURIComponent(csrfToken),ajaxNew(r,l)}else l=l+"&"+csrfParamName+"="+encodeURIComponent(csrfToken),ajaxNew(r,l)}else if("Clone"==e){i=formData2QueryString(document[a],t),r=Crm.getCrmBasePath()+"/CloneCommonModule.do";l=(l=i)+"&"+csrfParamName+"="+encodeURIComponent(csrfToken),ajaxNew(r,l)}else if("Clone&New"==e){i=formData2QueryString(document[a],t),r=Crm.getCrmBasePath()+"/CloneCommonModuleandNew.do";l=(l=i)+"&"+csrfParamName+"="+encodeURIComponent(csrfToken),ajaxNew(r,l)}return!1}function inventoryValidate(){var e=getObj("totalProductCount").value;if(null!=e&&""!=e&&parseInt(e)<=0||null==e||""==e)return alert(I18n.getMsg("crm.product.select.check",I18n.getMsg(singularModule))),!1;for(var t=1;t<=rowCnt;t++)if(!emptyCheck(getElemById("txtProduct"+t),"Product Name","text"))return!1;return!0}function priceListValidate(){for(var e=1;e<=priceRowCount;e++){if(!emptyCheck("txtFromRange"+e,"From Range"))return!1;if(!emptyCheck("txtToRange"+e,"To Range"))return!1;if(!emptyCheck("txtDiscount"+e,"Discount"))return!1;if(!decimalValidate("txtFromRange"+e,"From Range","any"))return!1;if(!decimalValidate("txtToRange"+e,"To Range","any"))return!1;if(!decimalValidate("txtDiscount"+e,"Discount","any"))return!1;var t=parseFloat(getObj("txtFromRange"+e).value),a=parseFloat(getObj("txtToRange"+e).value);if(a<t)return alert(I18n.getMsg("crm.alert.selected.rangevalue",I18n.getMsg(singularModule))),!1;for(var i=1;i<=priceRowCount;i++)if(e!=i){var r=parseFloat(getObj("txtFromRange"+i).value),l=parseFloat(getObj("txtToRange"+i).value);if(t>=r&&t<=l||a>=r&&a<=l)return alert(I18n.getMsg("crm.alert.selected.rangevalue",I18n.getMsg(singularModule))),!1}}return!0}function isRecurringActivity(e){if(getObj("property(Recurring Activity)")&&1==getObj("property(Recurring Activity)").checked){if("Tasks"==e){if("3"==$('.qc_rec_content [name="qc_rec_ends"]:checked').val()){if(""==getObj("repeatEndDate").value)return alert(I18n.getMsg("crm.recurrence2",I18n.getMsg(e))),getObj("repeatEndDate").focus(),!1;if(!dateValidate("repeatEndDate","End Date",""))return!1;if(!dateComparison("repeatEndDate","End Date","property(Due Date)","Start Date","G"))return!1;var t=new Date(crmCalendar.getDateObjectFromGivenDateString($(getObj("property(Due Date)")).val())),a=new Date(crmCalendar.getDateObjectFromGivenDateString($(getObj("repeatEndDate")).val())),i=t,r=1;if("custom"==(n=getObj("period").value))switch(n=getObj("customPeriod").value){case"daily":r=parseInt(trimBoth(getObj("daily111").value));break;case"weekly":r=parseInt(trimBoth(getObj("weeklyhidden").value));break;case"monthly":r=parseInt(trimBoth(getObj("noMonths1").value))}switch(n){case"daily":if(i.setDate(i.getDate()+r*(crmConstants.recurringEndDateLimit[n]-1)),!Utils.compareDate(a,i))return alert(I18n.getMsg("crm.recurrence.days.exceed",[Utils.getDateInUserDatePattern(i)])),!1;break;case"weekly":if(i.setDate(i.getDate()+r*(crmConstants.recurringEndDateLimit[n]-1)),!Utils.compareDate(a,i))return alert(I18n.getMsg("crm.recurrence.weekly.exceed",[Utils.getDateInUserDatePattern(i)])),!1;break;case"monthly":if(i.setDate(i.getDate()+r*(crmConstants.recurringEndDateLimit[n]-1)/2),!Utils.compareDate(a,i))return alert(I18n.getMsg("crm.recurrence.monthly.exceed",[Utils.getDateInUserDatePattern(i)])),!1;break;case"yearly":if(i.setDate(i.getDate()+r*(crmConstants.recurringEndDateLimit[n]-1)),!Utils.compareDate(a,i))return alert(I18n.getMsg("crm.recurrence.yearly.bulk.exceed",[Utils.getDateInUserDatePattern(i)])),!1}}else if("2"==$('.qc_rec_content [name="qc_rec_ends"]:checked').val()){var l=trimBoth(getObj("repeatEndCount").value);if(getObj("repeatEndCount").value=l.replace(/^0+/,""),""==l||parseInt(l)<=0||isNaN(l))return alert(I18n.getMsg("crm.recurrence6",I18n.getMsg(e))),!1;switch("custom"==(n=getObj("period").value)&&(n=getObj("customPeriod").value),n){case"daily":if(parseInt(l)>365)return alert(I18n.getMsg("crm.recurrence.daily.exceed1")),!1;break;case"weekly":if(parseInt(l)>105)return alert(I18n.getMsg("crm.recurrence.weekly.exceed1")),!1;break;case"monthly":if(parseInt(l)>30)return alert(I18n.getMsg("crm.recurrence.monthly.exceed1")),!1;break;case"yearly":if(parseInt(l)>10)return alert(I18n.getMsg("crm.recurrence.yearly.exceed1")),!1}}}else if("Tasks"!=e){if(""==trimBoth(getObj("property(Start Date1)").value))return alert(I18n.getMsg("crm.recurrence1",I18n.getMsg(e))),getObj("property(Start Date1)").focus(),!1;if(!dateValidate("property(Start Date1)","Start Date",""))return!1;if(""==getObj("property(End Date1)").value)return alert(I18n.getMsg("crm.recurrence2",I18n.getMsg(e))),getObj("property(End Date1)").focus(),!1;if(!dateValidate("property(End Date1)","End Date",""))return!1;if(!dateComparison("property(End Date1)","End Date","property(Start Date1)","Start Date","GE"))return!1}var n=getObj("period").value;if("Tasks"==e&&"custom"==n&&(n=getObj("customPeriod").value),"none"==n)return alert(I18n.getMsg("crm.recurrence3",I18n.getMsg(e))),!1;if("daily"==n){if(""==getObj("dailyhidden").value)return alert(I18n.getMsg("crm.recurrence4",I18n.getMsg(e))),!1;if("2"==getObj("dailyhidden").value){var s=trimBoth(getObj("daily111").value);if(getObj("daily111").value=s.replace(/^0+/,""),""==s||parseInt(s)<=0||isNaN(s))return alert(I18n.getMsg("crm.recurrence6",I18n.getMsg(e))),getObj("daily111").focus(),!1;if(!intValidate("daily111","crm.recurrence10"))return!1}else getObj("daily111")&&(getObj("daily111").value="")}else if("weekly"==n){var o=trimBoth(getObj("weeklyhidden").value);if(getObj("weeklyhidden").value=o.replace(/^0+/,""),""==o||parseInt(o)<=0||isNaN(o))return alert(I18n.getMsg("crm.recurrence6",I18n.getMsg(e))),!1;if(!intValidate("weeklyhidden","crm.recurrence10"))return!1;if("custom"==getObj("period").value){var d="false";for(chkcnt=1;chkcnt<=7;chkcnt++)1==getObj("day"+chkcnt).checked&&(d="true");if("false"==d)return alert(I18n.getMsg("crm.recurrence7",I18n.getMsg(e))),!1}}else if("monthly"==n){if(""==getObj("monthlyhidden").value)return alert(I18n.getMsg("crm.recurrence4",I18n.getMsg(e))),!1;if("1"==getObj("monthlyhidden").value){var c=trimBoth(getObj("noMonths1").value);if(getObj("noMonths1").value=c.replace(/^0+/,""),getObj("noMonths2")&&(getObj("noMonths2").value=""),""==c||parseInt(c)<=0||isNaN(c))return alert(I18n.getMsg("crm.recurrence6",I18n.getMsg(e))),getObj("noMonths1").focus(),!1;if(!intValidate("noMonths1","crm.recurrence10"))return!1}else if("2"==getObj("monthlyhidden").value){var m=trimBoth(getObj("noMonths2").value);if("Tasks"==e&&(m=trimBoth(getObj("noMonths1").value)),getObj("noMonths2").value=m.replace(/^0+/,""),getObj("noMonths1")&&"Tasks"!=e&&(getObj("noMonths1").value=""),""==m||parseInt(m)<=0||isNaN(m))return alert(I18n.getMsg("crm.recurrence6",I18n.getMsg(e))),getObj("noMonths2").focus(),!1;if(!intValidate("noMonths2","crm.recurrence10"))return!1}}else if("yearly"==n&&""==getObj("yearlyhidden").value)return alert(I18n.getMsg("crm.recurrence4",I18n.getMsg(e))),!1;if("Tasks"!=e&&!recurringEventLimitChk(getObj("property(Start Date1)").value,getObj("property(End Date1)").value,getObj("period").value))return!1}return!0}function recurringEventLimitChk(e,t,a){var i="Events",r=!1,l=0,n=crmCalendar.getDateObjectFromGivenDateString(e),s=crmCalendar.getDateObjectFromGivenDateString(t),o=new Date(n);if(!Crm.isHeadless&&crmListView.getObject()&&crmListView.getObject().selectedIds&&null==getObj("entityid")&&(l=crmListView.getObject().selectedIds.length),(document.getElementsByName("property(bulkIds)").length>0&&document.getElementsByName("property(bulkIds)")[0].value.split(";").length>1||l>1)&&(r=!0),"yearly"==a){yrsBetween(e,t);if(o.setDate(o.getDate()+3652.5),r&&!Utils.compareDateandTime(s,o))return alert(I18n.getMsg("crm.recurrence.yearly.bulk.exceed",[Utils.getDateInUserDatePattern(o)])),!1;if(!Utils.compareDateandTime(s,o))return alert(I18n.getMsg("crm.recurrence.yearly.bulk.exceed",[Utils.getDateInUserDatePattern(o)])),!1}else if("monthly"==a){var d;if(number_of_months=monthsBetween(e,t),0==(d="1"==getObj("monthlyhidden").value?getObj("noMonths1").value:getObj("noMonths2").value))return alert(I18n.getMsg("crm.recurrence.repeat.frequency",I18n.getMsg(i))),!1;if(number_of_months/=parseInt(d),o.setMonth(o.getMonth()+30*d),r&&!Utils.compareDateandTime(s,o))return alert(I18n.getMsg("crm.recurrence.monthly.bulk.exceed",[Utils.getDateInUserDatePattern(o)])),!1;if(!Utils.compareDateandTime(s,o))return alert(I18n.getMsg("crm.recurrence.monthly.exceed",[Utils.getDateInUserDatePattern(o)])),!1}else if("weekly"==a){var c=daysBetween(e,t),m=parseInt(c)/7,u=getObj("weeklyhidden").value;if(0==u)return alert(I18n.getMsg("crm.recurrence.repeat.frequency",I18n.getMsg(i))),!1;m/=parseInt(u);var p=0;for(chkcnt=1;chkcnt<=7;chkcnt++)1==getObj("day"+chkcnt).checked&&p++;if(parseInt(m)*parseInt(p),o.setDate(o.getDate()+parseInt(210*parseInt(u))),r&&!Utils.compareDateandTime(s,o))return alert(I18n.getMsg("crm.recurrence.weekly.bulk.exceed",[Utils.getDateInUserDatePattern(o)])),!1;if((o=new Date(n)).setDate(o.getDate()+parseInt(735*parseInt(u))),!Utils.compareDateandTime(s,o))return alert(I18n.getMsg("crm.recurrence.weekly.exceed",[Utils.getDateInUserDatePattern(o)])),!1}else if("daily"==a){c=daysBetween(e,t);var g=1;if("2"==getObj("dailyhidden").value&&(g=getObj("daily111").value),0==g)return alert(I18n.getMsg("crm.recurrence.repeat.frequency",I18n.getMsg(i))),!1;if(c/=parseInt(g),o.setDate(o.getDate()+30*parseInt(g)),r&&!Utils.compareDateandTime(s,o))return alert(I18n.getMsg("crm.recurrence.days.bulk.exceed",[Utils.getDateInUserDatePattern(o)])),!1;if((o=new Date(n)).setDate(o.getDate()+365*parseInt(g)),!Utils.compareDateandTime(s,o))return alert(I18n.getMsg("crm.recurrence.days.exceed",[Utils.getDateInUserDatePattern(o)])),!1}return!0}function addViewRow(e){I18n.getMsg("Tax"),I18n.getMsg("TotalAfterDiscount"),I18n.getMsg("NetTotal"),I18n.getMsg("Discount"),getElemById("shrow1");rowCnt++;var t="";t+='<tr id="hrow'+rowCnt+"\" onmouseover=\"$(this).find('.icon_roundinfo').css('visibility', 'visible')\" onmouseout=\"$(this).find('.icon_roundinfo').css('visibility', 'hidden')\"> <td align=\"left\"> <span id='value_sno"+rowCnt+"' style='padding:3px;'> "+rowCnt+" </span> </td> ",t+="<td> <span id='value_hdnProductName"+rowCnt+"' onmouseover='productDetails.showPrdDetInView("+rowCnt+')\' onmouseout=\'zctt.hidett()\'> <a href="javascript:;" class="f13 link1"> <h3 class="fL openSansSemiBold"> </h3> </a> </span> <div class="h20 pR20">',t+="<p id='value_itemDescription"+rowCnt+'\' class="eliptext fL pR5 itemDescription" style="white-space:normal;height:50;overflow:auto"> </p> </div> </td>',t+='<td class="f13 aligncenter"> <span id=\'value_txtListPrice'+rowCnt+"' class='lineCurrVal'> </span> <span id='value_hdnUnitPrice"+rowCnt+"' style='display:none'> </span> </td>",t+='<td class="f13 aligncenter"> <span id=\'value_txtQty'+rowCnt+"'> </span> <span id='value_hdnQtyStock"+rowCnt+"' style='display:none'> </span> </td> <td class=\"f13 aligncenter\"> <span id='value_hdnTotal"+rowCnt+"' class='lineCurrVal'> </span> </td>",t+='<td class="f13 aligncenter"> <div class="fL alignright w60per"> <span id=\'value_hdnDiscount'+rowCnt+'\' class=\'lineCurrVal\'> </span> </div> <div class="fL alignleft" style="width:40%"> <i class="icon_roundinfo pointer mL5" onclick="productDetails.showDiscountScheme(this,module);sE(event)" style="visibility:hidden"></i></td>',t+='<td class="f13 aligncenter"> <span id=\'value_hdnTax'+rowCnt+"' class='lineCurrVal'> </span> </td> <td class=\"f13 aligncenter\"> <span id='value_hdnNetTotal"+rowCnt+"' class='lineCurrVal'> </span> <span id=\"value_pricingRange"+rowCnt+'" style="display:none"> </span>  </td> </tr>',$("#linesTable").append(t)}function getProdListBody(){var e=getElemById("productList"),t=null;return e&&(t="TABLE"==e.childNodes.item(0).tagName?e.childNodes.item(0).childNodes.item(0):e.childNodes.item(1).childNodes.item(1)),t}function addRow(e,t){var a=I18n.getMsg("Tax"),i=I18n.getMsg("TotalAfterDiscount"),r=I18n.getMsg("NetTotal"),l=I18n.getMsg("Discount"),n=I18n.getMsg("ProductNameLookup"),s=I18n.getMsg("DeleteRow"),o=I18n.getMsg("PriceBookNameLookUp"),d=I18n.getMsg("PrdDescription"),c=!!getElemById("itemDescription1"),m=document.getElementById("currencySymbol_hdnUnitPrice1"),u=m?m.innerHTML:"&nbsp;";if(null==e&&rowCnt>=100)return alert(I18n.getMsg("crm.lineitem.exceeds.alert",I18n.getMsg(["Products",getObj("singularModule").value]))),!1;rowCnt++;var p="oddListRow";rowCnt%2==0&&(p="evenListRow");var g="<tr id=hrow"+rowCnt+" class='"+p+"'>";g+="<td style='padding:3px;' class='tableData' valign='top'><input id='txtProduct"+rowCnt+"' name='property(hdnProductName"+rowCnt+")' type='text' size='17' maxlength='120' readonly='true'/><img src='"+networkUtils.getImageUrl("Products_small_db6976e_.gif",ResourceConstants.CRM)+"' title='"+n+"' onclick=\"newShowLookUp('txtProduct"+rowCnt+"','hdnProductId"+rowCnt+"','','Products','','','vendorName',undefined,undefined,undefined,undefined,undefined,undefined,undefined,event)\" align='absmiddle' style='cursor:hand;cursor:pointer'/></td>",g+="<td style='padding:3px;' class='tableData' valign='top'><input type='text' class='searchlineItem' id='hdnQtyStock"+rowCnt+"' name='property(hdnQtyStock"+rowCnt+")' readonly='true' size='6' maxlength='9'/><input type='hidden' size='6' id='hdnOldQty"+rowCnt+"' name='property(hdnOldQty"+rowCnt+")'/></td>",g+="<td style='padding:3px;' class='tableData' valign='top'><input type=text id='txtQty"+rowCnt+"' name='property(txtQty"+rowCnt+")' size='7' maxlength='9' onBlur='calcTotal(this)' onkeypress='calcTotalOnEnter(this,event);'/></td>",g+="<td rowspan=2 style='padding:3px;' class='tableData' valign='top'><span id='currencySymbol_hdnUnitPrice"+rowCnt+"'>"+u+"</span><input type='text' id='hdnUnitPrice"+rowCnt+"' name='property(hdnUnitPrice"+rowCnt+")' size='7' maxlength='19' readonly='true' class='searchlineItem'/><input type='hidden' id='hdnProductId"+rowCnt+"' name='property(hdnProductId"+rowCnt+")'/><input type='hidden' id='hdnPriceBookId"+rowCnt+"' name='property(hdnPriceBookId"+rowCnt+")'/></td>",g+="<td rowspan=2 class='tableData' valign='top'>",g+="<table>",g+="<tr><td><span id='currencySymbol_txtListPrice"+rowCnt+"'>"+u+"</span><input type=text id='txtListPrice"+rowCnt+"' name='property(txtListPrice"+rowCnt+")' size='10' maxlength='19' onBlur='calcTotal(this.parentNode.parentNode.parentNode.parentNode)' onkeypress='calcTotalOnEnter(this.parentNode.parentNode.parentNode.parentNode,event);'/> <img src='"+networkUtils.getImageUrl("PriceBooks_small_b18a760_.gif",ResourceConstants.CRM)+"' title='"+o+"' onclick=\"newShowLookUp('txtListPrice"+rowCnt+"','hdnPriceBookId"+rowCnt+"','','PriceBooks','','','hdnProductId"+rowCnt+"',undefined,undefined,undefined,undefined,undefined,undefined,undefined,event)\" align='absmiddle' style='cursor:hand;cursor:pointer'/></td></tr>",g+='<tr><td><div class="alignright">(-)<b><a id=\'discountInv'+rowCnt+"' href=\"javascript:;\" onclick=\"displayCoords(this,'discount_div_final','discount','linkCount"+rowCnt+"')\" class='link'>"+l+":</a></b></div></td></tr>",g+="<tr><td class='alignright'>"+i+":</td></tr>",g+='<tr><td><div class="alignright">(+)<b><a id=\'taxInv'+rowCnt+"' href=\"javascript:;\" onclick=\"displayCoords(this,'tax_div_final','tax','linkCount"+rowCnt+"')\" class='link'>"+a+":</a></b></div></td></tr>",g+="<tr><td class='alignright'>"+r+":</td></tr></table></td>",g+="<td rowspan=2 style='padding:3px;' class='tableData'><table><tr><td><input type='text' class='searchlineItem' size='10' readonly='true' id='total"+rowCnt+"' name='property(hdnTotal"+rowCnt+")' /></td></tr>",g+="<tr><td><input type='text' id='discount"+rowCnt+"'  name='property(hdnDiscount"+rowCnt+")' size='10' readonly='true' class='searchlineItem'/></td></tr>",g+="<tr><td><input type='text' id='totalAfterDiscount"+rowCnt+"'  name='property(hdnTotalAfterDiscount"+rowCnt+")' size='10' readonly='true' class='searchlineItem'/></td></tr>",g+="<tr><td><input type='text' id='tax"+rowCnt+"'  name='property(hdnTax"+rowCnt+")' size='10' readonly='true' class='searchlineItem'/></td></tr>",g+="<tr><td><input type='text' id='netTotal"+rowCnt+"'  name='property(hdnNetTotal"+rowCnt+")' size='10' readonly='true' class='searchlineItem'/></td></tr></table></td>",g+="<td rowspan=2 style='padding:3px;' align='center' width='15' class='tableData'><span id='delRow"+rowCnt+"'  title='"+s+"'  class='close1 dIB vam'   onclick='return delRow(this.id)'></span>",g+="&nbsp</td></tr>",g+="<tr id=shrow"+rowCnt+" class='"+p+"'>",g+="<td colSpan='3' class=\"tableData\" style='padding:3px;' valign='top'>",c&&(g+='<span id="indicator_itemDescription'+rowCnt+'"  class="mainleftArrow dIB vam"></span><a href="javascript:;" onclick="toggleDivDisplay(\'div_itemDescription'+rowCnt+"',"+rowCnt+')">&nbsp;'+d+':</a><div id="div_itemDescription'+rowCnt+'" style="visibility:hidden"><textarea id=\'itemDescription'+rowCnt+"' name='property(itemDescription"+rowCnt+")' cols='30' rows='3' maxlength='3000' style=\"width:100%\"></textarea></div>"),g+="</td></tr>",t||(t=getProdListBody());for(var v=new Array(rowCnt-1),h=(new Array(rowCnt-1),new Array(rowCnt-1)),f=new Array(rowCnt-1),y=new Array(rowCnt-1),C=new Array(rowCnt-1),b=new Array(rowCnt-1),T=new Array(rowCnt-1),I=(l=new Array(rowCnt-1),new Array(rowCnt-1)),w=new Array(rowCnt-1),L=new Array(rowCnt-1),k=new Array(rowCnt-1),$=new Array(rowCnt-1),P=1,D=0;P<=rowCnt-1;P++,D++){v[D]=getElemById("txtProduct"+P).value,f[D]=getElemById("txtQty"+P).value,T[D]=getElemById("hdnOldQty"+P).value,C[D]=getElemById("txtListPrice"+P).value,h[D]=getElemById("hdnQtyStock"+P).value,y[D]=getElemById("hdnUnitPrice"+P).value,l[D]=getElemById("discount"+P).value,w[D]=getElemById("tax"+P).value,I[D]=getElemById("netTotal"+P).value,L[D]=getElemById("totalAfterDiscount"+P).value,k[D]=getElemById("total"+P).value,b[D]=getElemById("hdnProductId"+P).value,(S=getElemById("itemDescription"+P))&&($[D]=S.value)}getElemById("productList");g=listTableStart+g+"</table>";var M=getDocumentFragment(g),_=M.childNodes[0].childNodes[0].childNodes[0],E=M.childNodes[0].childNodes[0].childNodes[1];t.appendChild(_),t.appendChild(E);for(P=1,D=0;P<=rowCnt-1;P++,D++){var S;getElemById("txtProduct"+P).value=v[D],getElemById("hdnQtyStock"+P).value=h[D],getElemById("txtQty"+P).value=f[D],getElemById("hdnOldQty"+P).value=T[D],getElemById("hdnUnitPrice"+P).value=y[D],getElemById("txtListPrice"+P).value=C[D],getElemById("discount"+P).value=l[D],getElemById("tax"+P).value=w[D],getElemById("netTotal"+P).value=I[D],getElemById("totalAfterDiscount"+P).value=L[D],getElemById("total"+P).value=k[D],getElemById("hdnProductId"+P).value=b[D],(S=getElemById("itemDescription"+P))&&(S.value=$[D])}return!0}function delRow(e){rowCnt>100?invPdtDeleteWarning(e):deleteInvLineItems(e)}function deleteInvLineItems(e){var t=$("#module").closest("form")[0].name;e=parseInt(e.substr(e.indexOf("w")+1,e.length)),getProdListBody();getProdListBody().removeChild(getObj("hrow"+e)),getProdListBody().removeChild(getObj("shrow"+e));for(var a="<tr class='tableHeadBg' height='20' id='tablehead'>"+getObj("tablehead").innerHTML+"</tr>",i=new Array(rowCnt-1),r=new Array(rowCnt-1),l=new Array(rowCnt-1),n=(new Array(rowCnt-1),new Array(rowCnt-1)),s=new Array(rowCnt-1),o=new Array(rowCnt-1),d=new Array(rowCnt-1),c=new Array(rowCnt-1),m=new Array(rowCnt-1),u=new Array(rowCnt-1),p=new Array(rowCnt-1),g=new Array(rowCnt-1),v=new Array(rowCnt-1),h=new Array(rowCnt-1),f=new Array(rowCnt-1),y=1,C=0;y<=e-1;y++,C++){var b=getElemById("shrow"+y)?getElemById("shrow"+y).innerHTML:"";if(y%2==0)var T="evenListRow";else T="oddListRow";i[C]="<tr id='hrow"+y+"' class='"+T+"'>"+getElemById("hrow"+y).innerHTML+"</tr>",r[C]="<tr id='shrow"+y+"' class='"+T+"'>"+b+"</tr>",a+=i[C]+r[C]+"<tr id='tableline'><td colSpan='8' class='tableRowSep'></td></tr>",l[C]=getElemById("txtProduct"+y).value,n[C]=getElemById("hdnQtyStock"+y).value,s[C]=getElemById("txtQty"+y).value,m[C]=getElemById("hdnOldQty"+y).value,d[C]=getElemById("hdnUnitPrice"+y).value,o[C]=getElemById("txtListPrice"+y).value,u[C]=getElemById("discount"+y).value,v[C]=getElemById("tax"+y).value,p[C]=getElemById("netTotal"+y).value,g[C]=getElemById("totalAfterDiscount"+y).value,h[C]=getElemById("total"+y).value,c[C]=getElemById("hdnProductId"+y).value,(P=getElemById("itemDescription"+y))&&(f[C]=P.value)}for(y=e+1;y<=rowCnt;y++,C++){i[C]=getElemById("hrow"+y).innerHTML,r[C]=getElemById("shrow"+y).innerHTML;var I=i[C];I=replace(I,"hrow"+y,"hrow"+(y-1)),I=replace(I,"hdnProductName"+y,"hdnProductName"+(y-1)),I=replace(I,"txtProduct"+y,"txtProduct"+(y-1)),I=replace(I,"hdnQtyStock"+y,"hdnQtyStock"+(y-1)),I=replace(I,"txtQty"+y,"txtQty"+(y-1)),I=replace(I,"hdnOldQty"+y,"hdnOldQty"+(y-1)),I=replace(I,"hdnUnitPrice"+y,"hdnUnitPrice"+(y-1)),I=replace(I,"txtListPrice"+y,"txtListPrice"+(y-1)),I=replace(I,"discount"+y,"discount"+(y-1)),I=replace(I,"discountInv"+y,"discountInv"+(y-1)),I=replace(I,"hdnDiscount"+y,"hdnDiscount"+(y-1)),I=replace(I,"tax"+y,"tax"+(y-1)),I=replace(I,"taxInv"+y,"taxInv"+(y-1)),I=replace(I,"hdnTax"+y,"hdnTax"+(y-1)),I=replace(I,"totalAfterDiscount"+y,"totalAfterDiscount"+(y-1)),I=replace(I,"hdnTotalAfterDiscount"+y,"hdnTotalAfterDiscount"+(y-1)),I=replace(I,"netTotal"+y,"netTotal"+(y-1)),I=replace(I,"hdnNetTotal"+y,"hdnNetTotal"+(y-1)),I=replace(I,"total"+y,"total"+(y-1)),I=replace(I,"linkCount"+y,"linkCount"+(y-1)),I=replace(I,"delRow"+y,"delRow"+(y-1)),I=replace(I,"hdnProductId"+y,"hdnProductId"+(y-1)),I=replace(I,"hdnPriceBookId"+y,"hdnPriceBookId"+(y-1)),I=replace(I,"hdnTotal"+y,"hdnTotal"+(y-1));var w=r[C];if(w=replace(w,"shrow"+y,"shrow"+(y-1)),w=replace(w,"toggleDivDisplay('div_itemDescription"+y+"',"+y+")","toggleDivDisplay('div_itemDescription"+(y-1)+"',"+(y-1)+")"),w=replace(w,"itemDescription"+y,"itemDescription"+(y-1)),w=replace(w,"indicator_itemDescription"+y,"indicator_itemDescription"+(y-1)),w=replace(w,"prdLineDesc"+y,"prdLineDesc"+(y-1)),(y-1)%2==0)T="evenListRow";else T="oddListRow";i[C]="<tr id='hrow"+(y-1)+"' class='"+T+"'>"+I+"</tr>",r[C]="<tr id='shrow"+(y-1)+"' class='"+T+"'>"+w+"</tr>",a+=i[C]+r[C]+"<tr id='tableline'><td colSpan='8' class='tableRowSep'></td></tr>",l[C]=getElemById("txtProduct"+y).value,n[C]=getElemById("hdnQtyStock"+y).value,s[C]=getElemById("txtQty"+y).value,m[C]=getElemById("hdnOldQty"+y).value,d[C]=getElemById("hdnUnitPrice"+y).value,o[C]=getElemById("txtListPrice"+y).value,u[C]=getElemById("discount"+y).value,v[C]=getElemById("tax"+y).value,p[C]=getElemById("netTotal"+y).value,g[C]=getElemById("totalAfterDiscount"+y).value,h[C]=getElemById("total"+y).value,c[C]=getElemById("hdnProductId"+y).value,(P=getElemById("itemDescription"+y))&&(f[C]=P.value)}getProdListBody();var L=listTableStart+a+"</table>",k=getDocumentFragment(L);getElemById("productList").removeChild(getElemById("productList").children[0]),getElemById("productList").appendChild(k),rowCnt--;for(y=1,C=0;y<=rowCnt;y++,C++){var P;getElemById("txtProduct"+y).value=l[C],getElemById("hdnQtyStock"+y).value=n[C],getElemById("txtQty"+y).value=s[C],getElemById("hdnOldQty"+y).value=m[C],getElemById("hdnUnitPrice"+y).value=d[C],getElemById("txtListPrice"+y).value=o[C],getElemById("discount"+y).value=u[C],getElemById("netTotal"+y).value=p[C],getElemById("totalAfterDiscount"+y).value=g[C],getElemById("tax"+y).value=v[C],getElemById("total"+y).value=h[C],getElemById("hdnProductId"+y).value=c[C],(P=getElemById("itemDescription"+y))&&(P.value=f[C])}calcGrandTotal(t)}function calcRowTotal(e){for(var t=1;t<=rowCnt;t++){var a=getObj("property(hdnTotal"+t+")").value;if(""!=a){getElemById("netTotal"+t).value=a.toString(),getElemById("totalAfterDiscount"+t).value=a.toString();var i,r=parseFloat(getElemById("totalAfterDiscount"+t).value);if(""!=getElemById("discount"+t).value&&(r=null!=getElemById("discount"+t).value?getElemById("totalAfterDiscount"+t).value=a.toString()-parseFloat(getElemById("discount"+t).value):getElemById("totalAfterDiscount"+t).value=a.toString()),"NaN"!=r.toString()&&(getElemById("netTotal"+t).value=(Math.round(100*r)/100).toString()),""!=getElemById("tax"+t).value)"NaN"!=(i=null!=getElemById("tax"+t).value?parseFloat(r)+parseFloat(getElemById("tax"+t).value):parseFloat(r)).toString()&&(getElemById("netTotal"+t).value=(Math.round(100*i)/100).toString())}}calcGrandTotal(e)}function calcGroupTax(e){var t=document.getElementById("group_tax_count").value,a=0;"_final"==e?""!=document.getElementById("subTotal").value&&(a=parseFloat(document.getElementById("subTotal").value)-parseFloat(document.getElementById("txtDiscount").value)):""!=document.getElementById("totalAfterDiscount"+e).value&&(a=parseFloat(document.getElementById("totalAfterDiscount"+e).value));for(var i=0,r=0;r<t;r++)""==document.getElementById("group_tax_percentage"+r).value&&(document.getElementById("group_tax_percentage"+r).value=0),"NaN"!=(i=parseFloat(a)*parseFloat(document.getElementById("group_tax_percentage"+r).value)/100).toString()&&(document.getElementById("group_tax_amount"+r).value=(Math.round(100*i)/100).toString())}function calculateTax(e){var t=$("#module").closest("form")[0].name,a=document.getElementById("group_tax_count").value,i=0;"_final"==e?""!=document.getElementById("subTotal").value&&(i=parseFloat(document.getElementById("subTotal").value)-parseFloat(document.getElementById("txtDiscount").value)):""!=document.getElementById("totalAfterDiscount"+e).value&&(i=parseFloat(document.getElementById("totalAfterDiscount"+e).value));for(var r=0,l=0,n=0;n<a;n++)"NaN"!=(l=parseFloat(i)*parseFloat(document.getElementById("group_tax_percentage"+n).value)/100).toString()&&(document.getElementById("group_tax_amount"+n).value=(Math.round(100*l)/100).toString()),r=Math.round(100*(parseFloat(r)+parseFloat(l)))/100;"_final"==e&&"NaN"!=r.toString()?document.getElementById("txtTax").value=r.toString():"NaN"!=r.toString()&&(document.getElementById("tax"+e).value=r.toString()),calcRowTotal(t),hide("tax_div_final")}function calcTotalOnEnter(e,t){if(13==(t.keyCode?t.keyCode:t.which?t.which:t.charCode)){var a=getObj("currentSelectedRow");if(a){var i=e.parentNode.parentNode,r=parseInt(i.id.substr(i.id.indexOf("w")+1,i.id.length));a.value=r}}return!0}function calcTotal(e){var t=$(e).closest("form")[0].name,a=e.parentNode.parentNode,i=parseInt(a.id.substr(a.id.indexOf("w")+1,a.id.length)),r=getObj("txtQty"+i).value,l=getObj("txtListPrice"+i).value,n=getObj("hdnPriceBookId"+i).value;if(r=r.replace(/,+/g,""),l=l.replace(/,+/g,""),null!=n&&""!=n&&null!=l&&""!=l&&null!=r&&""!=r){var s=Crm.getCrmBasePath()+"/CreateInventory.do?action=getReductionPrice&quantity="+r+"&listPrice="+l+"&bookId="+n+"&isload=true";(new crmRequestPool).initiate({action:s,type:"GET",success:function(e){null!=e&&null!=e&&(getObj("total"+i).value=Math.round(100*parseFloat(e))/100,calcRowTotal(t))}})}else{var o=Math.round(r*l*100)/100;"NaN"!=o.toString()&&(getObj("total"+i).value=parseFloat(o.toString())),calcRowTotal(t)}}function calcGrandTotal(e){e&&"string"!=typeof e?e=$(e).closest("form")[0].name:void 0===e&&(e=$("[name^=createEntityForm]")[0].name);var t=0,a=0;taxTotal=0;for(var i=1;i<=rowCnt;i++){var r=getObj("property(hdnNetTotal"+i+")");""==r.value&&(r.value=0),isNaN(r.value)||(t+=parseFloat(r.value)),taxTotal+=getObj("tax"+i).value}t=Math.round(100*t)/100,getObj("subTotal").value=t.toString(),a=t;var l=getObj("txtDiscount").value;l=l.replace(/,+/g,"");var n=getObj("txtTax").value;n=n.replace(/,+/g,"");var s=getObj("txtAdjustment").value;s=s.replace(/,+/g,"");var o=document[e].elements["property(Discount)"];null!=o&&null!=o.value&&null!=o.value&&""!=o.value&&(a-=parseFloat(l));var d=document[e].elements["property(Tax)"];null!=d&&null!=d.value&&null!=d.value&&""!=d.value&&(a+=parseFloat(n));var c=document[e].elements["property(Adjustment)"];null!=c&&null!=c.value&&null!=c.value&&""!=c.value&&("plus"==getObj("operator").value?a+=parseFloat(s):a-=parseFloat(s)),"NaN"!=a.toString()&&(getObj("grandTotal").value=(Math.round(100*a)/100).toString())}function roundValue(e){if(e.indexOf(".")<0)e+=".00";else{var t=e.substring(e.indexOf(".")+1,e.length);t.length>2?e=e.substring(0,e.indexOf("."))+"."+t.substring(0,2):1==t.length&&(e+="0")}return e}function copyMapLocation(e){"Contacts"==getObj("module").value?"Other to Mailing"==e?(getObj("property(Mailing Street)")&&getObj("property(Other Street)")&&(getObj("property(Mailing Street)").value=getObj("property(Other Street)").value),getObj("property(Mailing City)")&&getObj("property(Other City)")&&(getObj("property(Mailing City)").value=getObj("property(Other City)").value),getObj("property(Mailing State)")&&getObj("property(Other State)")&&(getObj("property(Mailing State)").value=getObj("property(Other State)").value),getObj("property(Mailing Zip)")&&getObj("property(Other Zip)")&&(getObj("property(Mailing Zip)").value=getObj("property(Other Zip)").value),getObj("property(Mailing Country)")&&getObj("property(Other Country)")&&(getObj("property(Mailing Country)").value=getObj("property(Other Country)").value)):"Mailing to Other"==e&&(getObj("property(Mailing Street)")&&getObj("property(Other Street)")&&(getObj("property(Other Street)").value=getObj("property(Mailing Street)").value),getObj("property(Mailing City)")&&getObj("property(Other City)")&&(getObj("property(Other City)").value=getObj("property(Mailing City)").value),getObj("property(Mailing State)")&&getObj("property(Other State)")&&(getObj("property(Other State)").value=getObj("property(Mailing State)").value),getObj("property(Mailing Zip)")&&getObj("property(Other Zip)")&&(getObj("property(Other Zip)").value=getObj("property(Mailing Zip)").value),getObj("property(Mailing Country)")&&getObj("property(Other Country)")&&(getObj("property(Other Country)").value=getObj("property(Mailing Country)").value)):"Shipping to Billing"==e?(getObj("property(Billing Street)")&&getObj("property(Shipping Street)")&&(getObj("property(Billing Street)").value=getObj("property(Shipping Street)").value),getObj("property(Billing City)")&&getObj("property(Shipping City)")&&(getObj("property(Billing City)").value=getObj("property(Shipping City)").value),getObj("property(Billing State)")&&getObj("property(Shipping State)")&&(getObj("property(Billing State)").value=getObj("property(Shipping State)").value),getObj("property(Billing Code)")&&getObj("property(Shipping Code)")&&(getObj("property(Billing Code)").value=getObj("property(Shipping Code)").value),getObj("property(Billing Country)")&&getObj("property(Shipping Country)")&&(getObj("property(Billing Country)").value=getObj("property(Shipping Country)").value)):"Billing to Shipping"==e&&(getObj("property(Billing Street)")&&getObj("property(Shipping Street)")&&(getObj("property(Shipping Street)").value=getObj("property(Billing Street)").value),getObj("property(Billing City)")&&getObj("property(Shipping City)")&&(getObj("property(Shipping City)").value=getObj("property(Billing City)").value),getObj("property(Billing State)")&&getObj("property(Shipping State)")&&(getObj("property(Shipping State)").value=getObj("property(Billing State)").value),getObj("property(Billing Code)")&&getObj("property(Shipping Code)")&&(getObj("property(Shipping Code)").value=getObj("property(Billing Code)").value),getObj("property(Billing Country)")&&getObj("property(Shipping Country)")&&(getObj("property(Shipping Country)").value=getObj("property(Billing Country)").value))}function pageValidate(e,t){singularModule=getElm(e,"singularModule")?getElm(e,"singularModule").value:"";for(var a=getElm(e,"fieldname").value.split(";"),i=getElm(e,"fielddatatype").value.split(";"),r=getElm(e,"fieldlabel").value.split(";"),l=0;l<a.length;l++){var n=i[l].split("~");if("M"==n[1]){if(getElm(e,"property(Recurring Activity)")&&1==getElm(e,"property(Recurring Activity)").checked){if(getElm(e,"property(Start DateTimetime)")){var s=!1;if(2!=(o=getElm(e,"property(Start DateTimetime)").value.split(":")).length&&(s=!0),o[0]>=0&&o[0]<24&&o[1]>=0&&o[1]<=59||(s=!0),""==getElm(e,"property(Start DateTimetime)").value.trim()||s)return alert(I18n.getMsg("crm.recurrence8",I18n.getMsg(Crm.getModuleDisplayName(!1,!0,!0)))),getElm(e,"property(Start DateTimetime)").focus(),!1}if(getElm(e,"property(End DateTimetime)")){var o;s=!1;if(2!=(o=getElm(e,"property(End DateTimetime)").value.split(":")).length&&(s=!0),o[0]>=0&&o[0]<24&&o[1]>=0&&o[1]<=59||(s=!0),""==getElm(e,"property(End DateTimetime)").value.trim()||s)return alert(I18n.getMsg("crm.recurrence9",I18n.getMsg(Crm.getModuleDisplayName(!1,!0,!0)))),getElm(e,"property(End DateTimetime)").focus(),!1}}if(getElm(e,"property(Recurring Activity)")&&1==getElm(e,"property(Recurring Activity)").checked&&("property(Start DateTime)"==a[l]||"property(End DateTime)"==a[l]))continue;if("Call"!==singularModule||"property(DurationInMinute)"!==a[l]&&"property(DurationInSecond)"!==a[l]&&"property(Call Duration)"!==a[l]){if(null!=getElm(e,a[l])&&!emptyCheck(a[l],r[l],void 0,e,t))return!1}else if("ScheduleCall"!==(0!=$("input[name=whichCall]:checked").length?$("input[name=whichCall]:checked").val():"")&&null!=getObj(a[l])&&!emptyCheck(a[l],r[l]))return!1}switch(n[0]){case"O":case"V":case"C":break;case"E":if(null!=getElm(e,a[l])&&0!=getElm(e,a[l]).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length&&!emailValidate(a[l],r[l],e))return!1;break;case"DT":if(null!=getElm(e,a[l])&&0!=getElm(e,a[l]).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length){if(void 0===n[3])var d="OTH";else d=n[3];if(!dateTimeValidate(a[l],n[2],r[l],d))return!1;if(n[4]&&!dateTimeComparison(a[l],n[2],r[l],n[5],n[6],n[7],n[4],e))return!1}break;case"D":if(null!=getElm(e,a[l])&&0!=getElm(e,a[l]).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length){if(void 0===n[2])d="OTH";else d=n[2];if(!dateValidate(a[l],r[l],d,e))return!1;if(n[3]&&!dateComparison(a[l],r[l],n[4],n[5],n[3]))return!1}break;case"T":if(null!=getElm(e,a[l])&&0!=getElm(e,a[l]).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length){if(void 0===n[2])var c="OTH";else c=n[2];if(!timeValidate(a[l],r[l],c,e))return!1;if(n[3]&&!timeComparison(a[l],r[l],n[4],n[5],n[3],e))return!1}break;case"I":case"B":if(null!=getElm(e,a[l])&&0!=getElm(e,a[l]).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length){if(!intValidate(a[l],r[l],e))return!1;if(n[2]&&!numConstComp(a[l],r[l],n[2],n[3],e))return!1}break;case"DE":if(null!=getElm(e,a[l])&&0!=getElm(e,a[l]).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length){if(void 0===n[2])var m="any";else m=n[2];if(!decimalValidate(a[l],r[l],m))return!1;if(n[2]&&!numConstComp(a[l],r[l],n[2],n[3],e))return!1}break;case"N":if(null!=getElm(e,a[l])&&0!=getElm(e,a[l]).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length){if(void 0===n[2])m="any";else m=n[2];if(!numValidate(a[l],r[l],m,e))return!1;if(n[3]&&!numConstComp(a[l],r[l],n[3],n[4],e))return!1}break;case"P":if(null!=getElm(e,a[l])&&0!=getElm(e,a[l]).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length&&!phoneValidate(a[l],r[l],e))return!1;break;case"W":if(null!=getElm(e,a[l])&&0!=getElm(e,a[l]).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length&&!isValidWebURL(r[l],getElm(e,a[l]).value,"inline",getElm(e,a[l])))return!1}if(("property(Question)"===a[l]||"property(Solution)"===a[l]||"property(Answer)"===a[l]||"property(Internal Comments)"===a[l]||"property(Add Comment)"===a[l]||"property(Description)"===a[l])&&!maxLengthCheck(a[l]))return!1}if("Call"===singularModule&&!1===validateCallTime2(e))return!1;return!0}function create(e,t,a,i,r){getObj("mapValues")&&(getObj("mapValues").value="");var l=encodeURIComponent(getObj("entityName").value),n=Crm.getCrmBasePath()+"/Create.do?module="+e+"&entityid="+t+"&entityname="+l+"&returnAnchor="+a+"&primmodule="+i;null!=r&&(n=Crm.getCrmBasePath()+"/Create.do?module="+e+"&entityid="+t+"&entityname="+l+"&returnAnchor="+a+"&primmodule="+i+"&listRelationId="+r),"Accounts"!=i||"Quotes"!=e&&"SalesOrders"!=e&&"Invoices"!=e&&"Contacts"!=e?"Quotes"!=i||"SalesOrders"!=e&&"Invoices"!=e?"SalesOrders"==i&&"Invoices"==e?n=Crm.getCrmBasePath()+"/FillEntityObject.do?fillUpModule=SalesOrders&operation=create&module="+e+"&entityid="+t+"&entityname="+l+"&primmodule="+i+"&returnAnchor="+a:"Vendors"==i&&"Contacts"==e?n=Crm.getCrmBasePath()+"/FillEntityObject.do?fillUpModule=Vendors&operation=create&module="+e+"&entityid="+t+"&entityname="+l+"&primmodule="+i+"&returnAnchor="+a:(null!=getObj("cvid").value&&(n=n+"&cvid="+getObj("cvid").value+"&recordNum="+getObj("recordNum").value),n=n+"&relmodule="+i):n=Crm.getCrmBasePath()+"/FillEntityObject.do?fillUpModule=Quotes&operation=create&module="+e+"&entityid="+t+"&entityname="+l+"&primmodule="+i+"&returnAnchor="+a:n=Crm.getCrmBasePath()+"/FillEntityObject.do?fillUpModule=Accounts&operation=create&module="+e+"&entityid="+t+"&entityname="+l+"&primmodule="+i+"&returnAnchor="+a,params=params+"&"+csrfParamName+"="+encodeURIComponent(csrfToken),ajaxNew(n,params)}function addMultiValue(e,t,a,i,r,l,n){var s=Crm.getCrmBasePath()+"/ShowMultiValuesForAdd.do?moduleid="+e+"&frommodule="+t+"&tomodule="+a+"&returnAnchor="+i+"&parentCurrencyISOCode="+r+"&parentER="+l+"&pname="+i.split("_")[0].toUpperCase();n&&(s+="&rid="+n),commonUtils.openCustomLookup(s,void 0,"topBandPopup")}function editAllValues(e,t,a,i,r,l,n){var s=Crm.getCrmBasePath()+"/ShowMultiValuesForAdd.do?moduleid="+e+"&frommodule="+t+"&tomodule="+a+"&EditAll=true&parentCurrencyISOCode="+i+"&parentER="+r;l&&(s+="&rid="+l+"&pname="+n),commonUtils.openCustomLookup(s,void 0,"topBandPopup")}function massActionDelete(e,t,a,i,r,l,n,s,o){massAction(e,t,a,crmListView.getObject().module,r=r||crmListView.getObject().dispCvName,crmListView.getObject().cvId,crmListView.getObject().fromIndex,crmListView.getObject().toIndex,crmListView.getObject().currentOption)}function massAction(e,t,a,r,l,n,s,o,d,c,m,u){var p,g=document.showcvdetails;crmListView.getObject().isWorkFlowRequired&&crmListView.getObject().isWorkFlowRequired,void 0!==m&&(g=m[0]);var v=!1,h=0,f=!0;if(null!=g?f=!1:u&&"potentialpipeline"===u?(g=document.TransferWizardForm,f=!1):($("#listWFWebHookTable").length>0||$("#detailViewWebHookTable").length>0)&&(f=!1),1==f)1==customViewObject.isStageView?(count=0,Object.keys(crmTab.getFromCache(r).stageBoardDetails).forEach((function(e){count+=crmTab.getFromCache(r).stageBoardDetails[e].body.length})),noofrows=count):1==customViewObject.isPredictView?(count=0,Object.keys(crmTab.getFromCache(r).predictData).forEach((function(e){count+=crmTab.getFromCache(r).predictData[e].body.length})),noofrows=count):noofrows=customViewObject.isPrivacyListView?customViewObject.body.length:crmTab.getFromCache(r).body.length,0==noofrows&&(noofrows=crmTab.getFromCache(r).address.address_jsonarrayObj.length),p=customViewObject.isPrivacyListView?customViewObject.selectedIds.length:crmTab.getFromCache(r).selectedIds.length,(v=customViewObject.isPrivacyListView?customViewObject.doMassActioninScheduler&&customViewObject.doMassActioninScheduler.length:crmTab.getFromCache(r).doMassActioninScheduler)&&(h=customViewObject.isPrivacyListView?customViewObject.totalCount.length:crmTab.getFromCache(r).totalCount);else{if(!$("[name=chk]"))return;noofrows=$("[name=chk]").length,p=$("[name=chk]:checked").length}var y="",C=I18n.getMsg("confirmforecast"),b="",T=document.showcvdetails?document.showcvdetails.module.value:"";if(1==noofrows){if(0==p)return alert(I18n.getMsg("crm.alert.select.one",I18n.getMsg(r))),!1;if(1==f)y=customViewObject.selectedIds[0];else{var I=$("[name=chk]")[0].value.split("&&||");y=I[0];b=I[1]}if(document.showcvdetails&&(g.idlist.value=y,g.namelist.value=b),"printmailinglabels"==e)return!0;if(0==f&&(g.action=Crm.getCrmBasePath()+"/"+t+".do?"+a),"massdelete"==e)if("Forecasts"==T){if(!window.confirm(C))return!1;g.method="post",g.innerHTML+=document.deleteForm.innerHTML,g.submit()}else{var w=Events.checkEventAvailToSendCancel(y,"Events",(function(e){e||(e=!1);var t={cancelMailNeeded:e,skipAlert:!0};return Callonclickofbutton2(Crm.getCrmBasePath()+"/DeleteFromCV.do",r,y,l,n,s,o,d,void 0,t),!1}));if(!w){if("undefined"!=typeof event&&(O=renderingUtils.getTargetElem(event)),O&&!$(O).hasClass("fromDeletePopup")){var L=!isRelatedRecordsModule(r)||l&&l.includes("Review")?"":I18n.getMsg("crm.warning.related.modules",getAllRelatedChildModulesPluralLabel(r));(N=$("#actionMenu"))&&N.hide(),showDeletePopup(I18n.getMsg("crm.warning.move.to.trash"),"crm.button.delete","",L,O)}else{var k={skipAlert:!0};Callonclickofbutton2(Crm.getCrmBasePath()+"/DeleteFromCV.do",r,y,l,n,s,o,d,void 0,k)}return!1}}else if("bulktask"==e)Q.selectAction("BulkTask");else{if("changeowner"==e)return newShowLookUp("assignedto","SalesManId","Assigned To","ownername","listview"),!1;if("sendmail"==e)if("Potentials"==r){var P=Crm.getCrmBasePath()+"/ShowTemplates.do?idlist="+y+"&module="+r,D=document.getElementById("loadingDiv");$("#loadingDiv").empty(),D.style.zIndex=30,freezeBackground(),new AjaxAPI({id:"loadingDiv",url:P,callbackfn:function(){mailsetCenter("loadingDiv"),thirdPartyUtils.bindSelect2("#templateId")}}).post()}else{var M;M=1==f?y:getObj("idlist").value.split(";")[0],EntSendMail(r,M,"listview")}else if("updateresponse"==e){P=Crm.getCrmBasePath()+"/SelectResponder.do?module="+r;document.getElementById("loadingDiv").style.zIndex=30,freezeBackground();k={};new AjaxAPI({id:"loadingDiv",url:P,params:k,callbackfn:function(){mailsetCenter("loadingDiv")}}).get()}else if("mailMerge"==e){var _=crmListView.getObject().sortColumnString,E=crmListView.getObject().sortOrderString;if(_.indexOf("##")>-1&&(_=_.split("##",1)),c&&"CONVERTEDVIEWS"==c||"MYCONVERTEDVIEWS"==c)return alert(I18n.getMsg("crm.mailmerge.cvsupport",I18n.getMsg(r))),!1;P=Crm.getCrmBasePath()+"/MailMerge.do?";P+=j="action=mergeAction&idlist="+y+"&module="+r+"&previous_sort_column="+_+"&previous_sort_order="+E;var S=csrfParamName+"="+encodeURIComponent(csrfToken);mR(P,(function(e){getObj("lookupdiv").style.display="block",getObj("lookupdiv").style.zIndex=30,getObj("lookupdiv").style.width="550px",freezeBackground(),$("#lookupdiv").empty(),getObj("lookupdiv").innerHTML=e,mailsetCenter("lookupdiv"),JSEvalScript(getObj("lookupdiv")),thirdPartyUtils.bindSelect2($(".newSelect").find("select"))}),S)}else if("runRules"==e){P=Territory.territoryAction+"runRules",k="idsList="+y+"&module="+r+"&"+Territory.csrf();var x=objectUtils.getKeys(crmListView.startIndex).sort()[0];crmListView.getObject().fromIndex=x,crmListView.getObject().toIndex=parseInt(x)+parseInt(crmListView.getObject().currentOption)-1,mR(P,(function(e){crmListView.reloadCurrentListView()}),k)}else if("makepublic"==e||"makeprivate"==e)if(y.split(";").length>100){var B="makepublic"===e?"crm.email.sharing.custom.limit1":"crm.email.sharing.custom.limit2";crmui.showMsgBand("error",I18n.getMsg(B,100),3e3)}else{P=Crm.getCrmBasePath()+"/ZMailConfig.do?",k="action="+e+"&idlist="+y+"&module="+r+"&"+csrfParamName+"="+encodeURIComponent(csrfToken);mR(P,(function(e){$("#bulkUpdateSuccess").empty(),getObj("bulkUpdateSuccess").innerHTML=e,mailsetCenter("bulkUpdateSuccess"),setTimeout((function(){hide("bulkUpdateSuccess"),deSelectAll(),getObj("allcheck")&&(getObj("allcheck").checked=!1)}),2e3)}),k)}else if("executeMacro"==e)u="campView"===u?u:"",getElemById("requestFrom")&&(u=getElemById("requestFrom").value),Macro.showMacroExecDialog(a,r,y,u);else if("convert"==e){if(p>Crm.userDetails.massConvertLimit)return void renderingUtils.showCustomAlert(I18n.getMsg("crm.listview.maximum.convert.alert",Crm.userDetails.massConvertLimit));showMassConvertDialog(r,y)}else g.method="post",g.submit()}}else{if(0==noofrows)return!1;if(0==p)return null==r&&(r=""),alert(I18n.getMsg("crm.alert.select.one",I18n.getMsg(r))),!1;if(1==f)y=crmListView.getObject().selectedIds.join(";");else{var R=$("[name=chk]");for(i=0;i<noofrows;i++)if(R[i].checked){var A=(I=R[i].value.split("&&||"))[0],F=I[1];y=""==y?A:y+";"+A,b=F+"&&##"+b}document.showcvdetails&&(g.idlist.value=y,g.namelist.value=b)}if("printmailinglabels"==e)return!0;if(document.showcvdetails&&(g.action=Crm.getCrmBasePath()+"/"+t+".do?"+a),"massdelete"==e)if("Forecasts"==T){if(!window.confirm(C))return!1;g.method="post",g.innerHTML+=document.deleteForm.innerHTML,g.submit()}else{var O;w=Events.checkEventAvailToSendCancel(y,"Events",(function(e){e||(e=!1);var t=!1;v&&h>Crm.massOperationWorkflowLimit&&(handleIgnoreWorkFlowPopupForDelete(Crm.getCrmBasePath()+"/DeleteFromCV.do",r,y,l,n,s,o,d,a),t=!0);var a={cancelMailNeeded:e,skipAlert:!0,isWfTriggerCheckReq:t};return Callonclickofbutton2(Crm.getCrmBasePath()+"/DeleteFromCV.do",r,y,l,n,s,o,d,void 0,a),!1}));if(!w){if("undefined"!=typeof event&&(O=renderingUtils.getTargetElem(event)),O&&!$(O).hasClass("fromDeletePopup")){if(("Accounts"===r||"Contacts"===r)&&customViewObject.isZBCustomModuleEnabled)return void getAlertContent(e,O);var N;L=!isRelatedRecordsModule(r)||l&&l.includes("Review")?"":I18n.getMsg("crm.warning.related.modules",getAllRelatedChildModulesPluralLabel(r));(N=$("#actionMenu"))&&N.hide(),showDeletePopup(I18n.getMsg("crm.warning.move.to.trash"),"crm.button.delete","",L,O),v&&Crm.trackSpotLightAction("Mass Scheduler - Delete Clicked",{Module:r})}else{var U=!1;v&&h>Crm.massOperationWorkflowLimit&&(handleIgnoreWorkFlowPopupForDelete(Crm.getCrmBasePath()+"/DeleteFromCV.do",r,y,l,n,s,o,d,k),U=!0,!0);k={skipAlert:!0,isWfTriggerCheckReq:U};Callonclickofbutton2(Crm.getCrmBasePath()+"/DeleteFromCV.do",r,y,l,n,s,o,d,void 0,k),(1==U||"true"==U||h<=Crm.massOperationWorkflowLimit)&&v&&Crm.trackSpotLightAction("Mass Scheduler - Delete Confirmed",{Module:r})}return!1}}else if("bulktask"==e)Q.selectAction("BulkTask");else{if("changeowner"==e)return crmTab.getFromCache(r).doMassActioninScheduler?(newShowLookUp("assignedto","SalesManId","Assigned To","ownername","customview"),Crm.trackSpotLightAction("Mass Scheduler - Change Owner Clicked",{Module:r})):newShowLookUp("assignedto","SalesManId","Assigned To","ownername","listview"),!1;if("sendmail"==e){if("true"===window.isSandboxAcc){var z=window.event||arguments.callee.caller.arguments[0];return z.stopPropagation(),renderingUtils.displayPermissionDenied(null,null,I18n.getMsg("crm.sandbox.error.email")),!1}var q;if(1==p)return q=1==f?crmTab.getFromCache(r).selectedIds[0]:getObj("idlist").value.split(";")[0],EntSendMail(r,q,"listview"),!0;if("L"!=Crm.userDetails.LICENSE_TYPE&&"N"!=Crm.userDetails.LICENSE_TYPE&&"F"!=Crm.userDetails.LICENSE_TYPE)if(Crm.userDetails.MassMailUnificationEnabled)networkUtils.loadFeatureScripts(["zohocrm_massmail_unification.js"],(function(){MassMailUnificationUtil.showMassMailPop(r,"LV",y)}));else{showAnimatePopup("massMailstatsPop");P=Crm.getCrmBasePath()+"/ShowTemplates.do?module="+r,k={idlist:y},D=document.getElementById("massMailstatsPop");$("#massMailstatsPop").empty(),new AjaxAPI({id:"massMailstatsPop",url:P,params:k,callbackfn:function(){}}).post()}else sendMailPermissionAlert()}else if("ziaReminder"==e)crmBstTime.showZiaReminderSettingsforListView(r,n);else if("convert"==e){if(p>Crm.userDetails.massConvertLimit)return void renderingUtils.showCustomAlert(I18n.getMsg("crm.listview.maximum.convert.alert",Crm.userDetails.massConvertLimit));showMassConvertDialog(r,y)}else if("updateresponse"==e){P=Crm.getCrmBasePath()+"/SelectResponder.do?module="+r;document.getElementById("loadingDiv").style.zIndex=30,freezeBackground();k={};new AjaxAPI({id:"loadingDiv",url:P,params:k,callbackfn:function(){mailsetCenter("loadingDiv")}}).get()}else if("mailMerge"==e){_=crmListView.getObject().sortColumnString,E=crmListView.getObject().sortOrderString;if(_.indexOf("##")>-1&&(_=_.split("##",1)),c&&("CONVERTEDVIEWS"==c||"MYCONVERTEDVIEWS"==c))return alert(I18n.getMsg("crm.mailmerge.cvsupport",I18n.getMsg(r))),!1;P=Crm.getCrmBasePath()+"/MailMerge.do?";var j="action=mergeAction&module="+r+"&previous_sort_column="+_+"&previous_sort_order="+E,V={idlist:y};V[csrfParamName]=encodeURIComponent(csrfToken),P+=j,mR(P,(function(e){getObj("lookupdiv").style.display="block",getObj("lookupdiv").style.zIndex=30,getObj("lookupdiv").style.width="550px",freezeBackground(),$("#lookupdiv").empty(),getObj("lookupdiv").innerHTML=e,mailsetCenter("lookupdiv"),JSEvalScript(getObj("lookupdiv")),thirdPartyUtils.bindSelect2($(".newSelect").find("select"))}),V)}else if("runRules"==e){P=Territory.territoryAction+"runRules",k="idsList="+y+"&module="+r+"&"+Territory.csrf(),x=objectUtils.getKeys(crmListView.startIndex).sort()[0];crmListView.getObject().fromIndex=x,crmListView.getObject().toIndex=parseInt(x)+parseInt(crmListView.getObject().currentOption)-1,mR(P,(function(e){crmListView.reloadCurrentListView()}),k)}else if("makepublic"==e||"makeprivate"==e)if(y.split(";").length>100){B="makepublic"===e?"crm.email.sharing.custom.limit1":"crm.email.sharing.custom.limit2";crmui.showMsgBand("error",I18n.getMsg(B,100),3e3)}else{P=Crm.getCrmBasePath()+"/ZMailConfig.do?",k="action="+e+"&idlist="+y+"&module="+r+"&"+csrfParamName+"="+encodeURIComponent(csrfToken);loadAjaxTab(""),mR(P,(function(e){commonUtils.showHideLoadingDiv(),$("#bulkUpdateSuccess").empty(),getObj("bulkUpdateSuccess").innerHTML=e,show("bulkUpdateSuccess"),mailsetCenter("bulkUpdateSuccess"),setTimeout((function(){hide("bulkUpdateSuccess"),deSelectAll(),1==f?$("#checkAll").attr("class","customCheckBox"):getObj("allcheck")&&(getObj("allcheck").checked=!1)}),2e3)}),k)}else if("executeMacro"==e)u="campView"===u?u:"",getElemById("requestFrom")&&(u=getElemById("requestFrom").value),Macro.showMacroExecDialog(a,r,y,u);else if("downloadVcard"==e){P=Crm.getCrmBasePath()+"/BCCDropbox.do?action=downloadCustomModuleVCard";j="&idlist="+y+"&module="+r,downloadVcardAction(P,j)}else g.method="post",g.submit()}}}function handleIgnoreWorkFlowPopupForDelete(e,t,a,i,r,l,n,s,o){var d="deleteWorkflowHandleSave('"+Crm.getCrmBasePath()+"/DeleteFromCV.do','"+$ESAPI.encoder().encodeForHTMLAttribute($ESAPI.encoder().encodeForJavaScript(t))+"','"+$ESAPI.encoder().encodeForHTMLAttribute($ESAPI.encoder().encodeForJavaScript(a))+"','"+$ESAPI.encoder().encodeForHTMLAttribute($ESAPI.encoder().encodeForJavaScript(i))+"','"+$ESAPI.encoder().encodeForHTMLAttribute($ESAPI.encoder().encodeForJavaScript(r))+"','"+$ESAPI.encoder().encodeForHTMLAttribute($ESAPI.encoder().encodeForJavaScript(l))+"','"+$ESAPI.encoder().encodeForHTMLAttribute($ESAPI.encoder().encodeForJavaScript(n))+"','"+$ESAPI.encoder().encodeForHTMLAttribute($ESAPI.encoder().encodeForJavaScript(s))+"')",c="<input type='button' data-zcqa='btn_MassDeleteWorkflowPopupOk' value='"+I18n.getMsg("crm.mass.actions.ok.proceed")+"' class='redbtn fromDeletePopup' id='buttonMassDeleteWorkflowOk' name='buttonMassDeleteWorkflowOkName' onclick=\""+d+'">',m=getWorkflowPopUpContent(c,"handleIgnoreWorkFlowPopupForDeleteCancel",t);$("#massActionWorkFlowPopUp").html(m)}function deleteWorkflowHandleSave(e,t,a,i,r,l,n,s){hideAnimatePopup("massActionWorkFlowPopUp"),Callonclickofbutton2(Crm.getCrmBasePath()+"/DeleteFromCV.do",t,a,i,r,l,n,s,void 0,{skipAlert:!0}),Crm.trackSpotLightAction("Mass Scheduler - Delete Workflow Ok Proceed",{Module:t})}function handleIgnoreWorkFlowPopupForDeleteCancel(e){hideAnimatePopup("massActionWorkFlowPopUp",!0),removeFreezeLayer(),Crm.trackSpotLightAction("Mass Scheduler - Delete Workflow Cancel",{Module:e})}function createAction(){var e=getObj("module").value,t=Crm.getCrmBasePath()+"/Create.do?module="+e;ajaxNew(t)}function createActionByModule(e){var t=Crm.getCrmBasePath()+"/Create.do?module="+e;"Events"==e&&(t=Crm.getCrmBasePath()+"/Create.do?createdFrom=listView&module="+e),ajaxNew(t)}function setDiscount(e,t){var a=0;if(document.getElementById("discountType").value=e,""==document.getElementById("discount_percentage_final").value&&(document.getElementById("discount_percentage_final").value=0),"amount"==e){if(getObj("discount_amount_final").style.visibility="visible",getObj("discount_percentage_final").style.visibility="hidden",getObj("discount_percentage_final").value="0",!decimalValidate("discount_amount_final","Discount","any"))return!1;a=document.getElementById("discount_amount_final").value}else if("percentage"==e){if(getObj("discount_percentage_final").style.visibility="visible",getObj("discount_amount_final").style.visibility="hidden",getObj("discount_amount_final").value="0",!decimalValidate("discount_percentage_final","Discount","any"))return!1;"_final"==t?""!=document.getElementById("subTotal").value&&(a=parseFloat(document.getElementById("subTotal").value)*parseFloat(document.getElementById("discount_percentage_final").value)/100):""!=document.getElementById("total"+t).value&&(a=parseFloat(document.getElementById("total"+t).value)*parseFloat(document.getElementById("discount_percentage_final").value)/100)}else getObj("discount_amount_final").style.visibility="hidden",getObj("discount_percentage_final").style.visibility="hidden",getObj("discount_percentage_final").value="0",getObj("discount_amount_final").value="0",a=0;document.getElementById("discount_type_final").value=a}function calculateDiscount(e){var t=$("#module").closest("form")[0].name;setDiscount(document.getElementById("discountType").value,e);var a=document.getElementById("discount_type_final").value;"_final"==e&&"NaN"!=a.toString()?document.getElementById("txtDiscount").value=a:"NaN"!=a.toString()&&(document.getElementById("discount"+e).value=a),calcRowTotal(t),hide("discount_div_final")}function displayCoords(e,t,a,i){var r=i.substr(i.indexOf("t")+1);if((freezeBackground(),document.getElementById(t).style.display="block",$(t).empty(),document.getElementById(t).innerHTML=I18n.getMsg("loading")+"..","discount_final"!=a&&"sh_tax_div_title"!=a&&"tax_final"!=a)&&""==document.getElementById("txtProduct"+r).value)return alert(I18n.getMsg("crm.product.select.check",I18n.getMsg(singularModule))),document.getElementById("FreezeLayer")&&document.body.removeChild(document.getElementById("FreezeLayer")),document.getElementById(t).style.display="none",!1;if("discount"==a){var l=Crm.getCrmBasePath()+"/DiscountCal.do?curr_row="+r;mR(l,(function(e){$(t).empty(),document.getElementById(t).innerHTML=e,$("#discount_div_title_final").empty(),document.getElementById("discount_div_title_final").innerHTML="<b>"+I18n.getMsg("setDiscountFor")+" : "+document.getElementById("total"+r).value+"</b>",getObj("discount_amount_final").style.visibility="hidden",getObj("discount_percentage_final").style.visibility="hidden"}))}else if("tax"==a);else if("discount_final"==a){l=Crm.getCrmBasePath()+"/DiscountCal.do?curr_row=_final";mR(l,(function(e){$(t).empty(),document.getElementById(t).innerHTML=e,$("#discount_div_title_final").empty(),document.getElementById("discount_div_title_final").innerHTML="<b>"+I18n.getMsg("setDiscountFor")+" : "+document.getElementById("subTotal").value+"</b>",getObj("discount_amount_final").style.visibility="hidden",getObj("discount_percentage_final").style.visibility="hidden"}))}else"sh_tax_div_title"==a&&($("#sh_tax_div_title").empty(),document.getElementById("sh_tax_div_title").innerHTML="<b>Set S&H Tax for : "+document.getElementById("shipping_handling_charge").value+"</b>");var n=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop;getObj(t).style.zIndex=50,getObj(t).style.top=n+200+"px",getObj(t).style.left="50%"}function calculateExpectedRevenue(){var e=0;pbty=0;var t=getObj("property(Amount)");if(getObj("value_Expected Revenue"))t&&""!=t.value&&!isNaN(t.value)&&(e=parseFloat(t.value)),getObj("value_Probability")&&""!=getObj("value_Probability").innerHTML&&(pbty=parseFloat(getObj("value_Probability").innerHTML)),getObj("value_Expected Revenue").innerHTML=roundValue((e*(pbty/100)).toString()),getObj("headervalue_Expected Revenue")&&(getObj("headervalue_Expected Revenue").innerHTML=roundValue((e*(pbty/100)).toString()));else{t&&""!=t.value&&!isNaN(t.value)&&(e=parseFloat(t.value));var a=getObj("property(Stage)");if(a&&""!=a.options[a.selectedIndex].value){var i=a.options[a.selectedIndex].value;i=i.indexOf(":")>-1?i.split(":")[0]:a.options[a.selectedIndex].dataset.val,pbty=parseFloat(i)}if(getObj("property(Probability)")&&""!=getObj("property(Probability)").value&&(pbty=parseFloat(getObj("property(Probability)").value)),getObj("property(Expected Revenue)")){var r=0;0!=e&&0!=pbty&&(r=roundValue((e*(pbty/100)).toString())),getObj("property(Expected Revenue)").value=r}getObj("headervalue_Expected Revenue")&&(getObj("headervalue_Expected Revenue").innerHTML=r)}}function addRange(){var e=I18n.getMsg("deleteRange");priceRowCount++;var t="<tr id=hrow"+priceRowCount+">";t+="<td class=\"tableData\" style='padding:3px;' valign='top'><input id='txtFromRange"+priceRowCount+"' name='property(fromRange"+priceRowCount+")' type='text' size='17' maxlength='19'></td>",t+="<td class=\"tableData\" style='padding:3px;' valign='top'><input id='txtToRange"+priceRowCount+"' name='property(toRange"+priceRowCount+")' type='text' size='17' maxlength='19'></td>",t+="<td class=\"tableData\" style='padding:3px;' valign='top'><input type='text' id='txtDiscount"+priceRowCount+"'  name='property(discount"+priceRowCount+")' size='19' maxlength='19' /></td>",t+="<td style='padding:3px;' align='center' width='15' class='tableData'><img id='delRange"+priceRowCount+"' align='absmiddle' title='"+e+"' src='"+networkUtils.getImageUrl("del_3f73c4a_.gif",ResourceConstants.CRM)+"'  onclick='delRange(this.id)' class='pointer'></td>",t+="</tr>";for(var a=getPriceListBody(),i=new Array(priceRowCount-1),r=new Array(priceRowCount-1),l=new Array(priceRowCount-1),n=1,s=0;n<=priceRowCount-1;n++,s++)r[s]=getObj("txtToRange"+n).value,i[s]=getObj("txtFromRange"+n).value,l[s]=getObj("txtDiscount"+n).value;$("#pricingList").empty(),getObj("pricingList").innerHTML=listTableStart+a.innerHTML+t+"<tr><td colSpan='8' class='tableRowSep'></td></tr></table>";for(n=1,s=0;n<=priceRowCount-1;n++,s++)getObj("txtFromRange"+n).value=i[s],getObj("txtToRange"+n).value=r[s],getObj("txtDiscount"+n).value=l[s]}function getPriceListBody(){if("TABLE"==getObj("pricingList").childNodes.item(0).tagName)var e=getObj("pricingList").childNodes.item(0).childNodes.item(0);else e=getObj("pricingList").childNodes.item(1).childNodes.item(1);return e}function delRange(e){e=parseInt(e.substr(e.lastIndexOf("e")+1,e.length));getPriceListBody().removeChild(getObj("hrow"+e));for(var t="<tr class='tableHeadBg' height='20' id='tablehead'>"+getObj("tablehead").innerHTML+"</tr>",a=new Array(priceRowCount-1),i=new Array(priceRowCount-1),r=new Array(priceRowCount-1),l=new Array(priceRowCount-1),n=1,s=0;n<=e-1;n++,s++)a[s]="<tr id='hrow"+n+"'>"+getObj("hrow"+n).innerHTML+"</tr><tr id='tableline'><td colSpan='8' class='tableRowSep'></td></tr>",t+=a[s],r[s]=getObj("txtToRange"+n).value,i[s]=getObj("txtFromRange"+n).value,l[s]=getObj("txtDiscount"+n).value;for(n=e+1;n<=priceRowCount;n++,s++){a[s]=getObj("hrow"+n).innerHTML;var o=a[s];o=replace(o,"hrow"+n,"hrow"+(n-1)),o=replace(o,"txtFromRange"+n,"txtFromRange"+(n-1)),o=replace(o,"fromRange"+n,"fromRange"+(n-1)),o=replace(o,"txtToRange"+n,"txtToRange"+(n-1)),o=replace(o,"toRange"+n,"toRange"+(n-1)),o=replace(o,"txtDiscount"+n,"txtDiscount"+(n-1)),o=replace(o,"discount"+n,"discount"+(n-1)),o=replace(o,"delRange"+n,"delRange"+(n-1)),a[s]="<tr id='hrow"+(n-1)+"'>"+o+"</tr><tr id='tableline'><td colSpan='8' class='tableRowSep'></td></tr>",t+=a[s],r[s]=getObj("txtToRange"+n).value,i[s]=getObj("txtFromRange"+n).value,l[s]=getObj("txtDiscount"+n).value}$("#pricingList").empty(),getObj("pricingList").innerHTML=listTableStart+t+"</table>",priceRowCount--;for(n=1,s=0;n<=priceRowCount;n++,s++)getObj("txtFromRange"+n).value=i[s],getObj("txtToRange"+n).value=r[s],getObj("txtDiscount"+n).value=l[s]}function addViewRange(){if(priceRowCount++,priceRowCount%2==0)var e="<tr id=hrow"+priceRowCount+" class='evenBg'>";else e="<tr id=hrow"+priceRowCount+" class='value'>";e+="<td style='padding:3px;' ><div><span id='value_fromRange"+priceRowCount+"'></span></div></td>",e+="<td style='padding:3px;' ><div><span id='value_toRange"+priceRowCount+"'></span></div></td>",e+="<td style='padding:3px;' ><div><span id='value_discount"+priceRowCount+"'></span></div></td>",e+="</tr></table></td>",$("#pricingList").empty(),getObj("pricingList").innerHTML=viewTableStart+getPriceListBody().innerHTML+e+"<tr><td colSpan='8' class='tableRowSep'></td></tr></table>"}function fieldValidate(e,t,a,i,r,l,n,s,o){if(e=null!=s?I18n.getMsg(e,I18n.getMsg(s)):I18n.getMsg(e,I18n.getMsg(singularModule)),!emptyCheck(t,e,void 0,void 0,o))return!1;var d=t;userDateFormat=getObj("dtPtn").value;var c=a.split("~");switch(c[0]){case"O":case"V":case"C":break;case"E":if(null!=getObj(d)&&0!=getObj(d).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length&&!emailValidate(d,e,void 0,o))return!1;break;case"DT":if(null!=getObj(d)&&0!=getObj(d).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length){if(void 0===c[3])var m="OTH";else m=c[3];if("undefined"!=r){if(!(u=validateExecDay(d,i,l,n))&&!dateTimeValidate(d,r,e,m,void 0,o))return!1}else{if(c[2]=d,!dateTimeValidate(d,c[2],e,m,void 0,o))return!1;if(c[4]&&!dateTimeComparison(d,c[2],e,c[5],c[6],c[7],c[4],void 0,o))return!1}}break;case"D":if(null!=getObj(d)&&0!=getObj(d).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length){if(void 0===c[2])m="OTH";else m=c[2];var u;if(!(u=validateExecDay(d,i,l,n))&&!dateValidate(d,e,m,void 0,void 0,o))return!1;if(!u&&c[3]&&!dateComparison(d,e,c[4],c[5],c[3]))return!1}break;case"T":if(null!=getObj(d)&&0!=getObj(d).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length){if(void 0===c[2])var p="OTH";else p=c[2];if(!timeValidate(d,e,p,void 0,o))return!1;if(c[3]&&!timeComparison(d,e,c[4],c[5],c[3],void 0,o))return!1}break;case"I":if(null!=getObj(d)&&0!=getObj(d).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length){if(!intValidate(d,e,void 0,o))return!1;if(c[2]&&!numConstComp(d,e,c[2],c[3],void 0,o))return!1;if(e==I18n.getMsg("Probability")&&(s===moduleRecordMapping.Potentials.singular_label||s===moduleRecordMapping.Deals.singular_label)){var g=$("[id='"+d+"']").val();if(g>100)return void renderingUtils.showCustomAlert(I18n.getMsg("crm.criteria.editor.probability.value.exceed"));if(g<0)return void renderingUtils.showCustomAlert(I18n.getValueForFields("crm.field.valid.check",e))}}break;case"B":if(null!=getObj(d)&&0!=getObj(d).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length){if(!intValidate(d,e,void 0,o))return!1;if(c[2]&&!numConstComp(d,e,c[2],c[3],void 0,o))return!1}break;case"DE":if(null!=getObj(d)&&0!=getObj(d).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length){if(void 0===c[2])var v="any";else v=c[2];if(!decimalValidate(d,e,v,void 0,o))return!1;if(c[2]&&!numConstComp(d,e,c[2],c[3],void 0,o))return!1}break;case"N":if(null!=getObj(d)&&0!=getObj(d).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length){if(void 0===c[2])v="any";else v=c[2];if(!numValidate(d,e,v,void 0,o))return!1;if(c[3]&&(numConstComp(d,e,c[3],c[4]),o))return!1}break;case"P":if(null!=getObj(d)&&0!=getObj(d).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length&&!phoneValidate(d,e,void 0,o))return!1;break;case"W":if(null!=getObj(d)&&0!=getObj(d).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length&&!isValidWebURL(e,getObj(d).value,o,getObj(d)))return!1}return!0}function showDownloadBulkVcardPop(e,t){new AjaxAPI({id:"downloadVcardPop",url:e,params:t,callbackfn:function(){freezeBackground(),mailsetCenter("downloadVcardPop")}}).post()}function downloadRecordBccVCard(e,t,a){var i=Crm.getCrmBasePath()+"/BCCDropbox.do?action=downloadCustomModuleVCard";param="&idlist="+t+"&module="+e,a&&(param+="&individualRecord="+a),downloadVcardAction(i,param)}function validateExecDay(e,t,a,i){if(t){var r=getObj(e).value;if((r=r.replace(/ /g,""))!=crmConstants.executionDayFormula&&r!=crmConstants.executionTimeFormula)return!1;if(null!=i){var l="";if(null!=a&&""!=a&&(l=a),isNaN(getObj(l+"execDayCount"+i).value))return!1}else if(isNaN(getObj("execDayCount").value))return!1;return!0}return!1}function toggleDivDisplay(e,t){var a=getObj(e);if(a){var i="indicator_itemDescription"+t;"visible"==a.style.visibility?(a.style.visibility="hidden",getObj(i)&&(getObj(i).className="mainleftArrow")):(a.style.visibility="visible",getObj(i)&&(getObj(i).className="maindownArrow"))}}function sendMailPermissionAlert(){$("#lookupdiv").empty();var e=I18n.getMultipleMsg([{key:"crm.sendmail.upgrade",params:""},{key:"crm.upgrade.feature.access.msg",params:""},{key:"crm.store.upgrade",params:""},{key:"crm.button.cancel",params:""}]),t=e["crm.sendmail.upgrade"],a=e["crm.upgrade.feature.access.msg"],i=e["crm.store.upgrade"],r=e["crm.button.cancel"];getObj("lookupdiv").style.display="block",getObj("lookupdiv").style.zIndex=30,getObj("lookupdiv").style.width="550px",freezeBackground(),mailsetCenter("lookupdiv"),JSEvalScript(getObj("lookupdiv")),getObj("lookupdiv").innerHTML="<div style='text-align:left;'><div class='p30'>"+t+"<br><br>"+a+"<br><br><input type='button' value='"+i+"' onclick='removeFreezeLayer(),openNewTab(\""+Crm.getCrmBasePath()+"/Security.do?actionName=manageSubscription&fm=tp\",\"subscription\");' class='button'>&nbsp;&nbsp;<input type='button' class='button' value='"+r+"' onclick=\"getObj('lookupdiv').innerHTML='';getObj('lookupdiv').style.display='none';removeFreezeLayer()\"></div></div>"}function invPdtDeleteWarning(e){gblid=e,freezeBackground(),mailsetCenter("InventoryWarningDiv")}function sendConsentMail(e){if("L"!=Crm.userDetails.LICENSE_TYPE&&"N"!=Crm.userDetails.LICENSE_TYPE&&"F"!=Crm.userDetails.LICENSE_TYPE){showAnimatePopup("massMailstatsPop");var t=Crm.getCrmBasePath()+"/ShowTemplates.do?module="+e,a={idlist:crmListView.getObject().selectedIds.join(";"),consent:"true"};document.getElementById("massMailstatsPop");$("#massMailstatsPop").empty(),new AjaxAPI({id:"massMailstatsPop",url:t,params:a,callbackfn:function(){}}).post()}else sendMailPermissionAlert()}function controlPercentagefieldValue(e,t){switch(t.keyCode){case 8:case 9:case 13:case 16:case 39:case 37:break;default:var a=$(e),i=a.val(),r=a.data("maxlength"),l=i.length,n=a.data("uitype");if(setTimeout((function(){if(e.value){var t=e.value.length;-1==e.value.indexOf(".")&&t>l&&(e.value=e.value.substr(0,r))}}),10),e.value&&e.value.substring(e.selectionStart,e.selectionEnd))break;if(-1!=i.indexOf(".")&&(l&&l--,190==t.keyCode)){36!=n&&143!=n&&144!=n&&145!=n&&t.preventDefault();break}if(l>=r){if(190==t.keyCode&&-1==i.indexOf("."))break;if((t.ctrlKey||t.metaKey)&&(65==t.which||67==t.which||88==t.which||90==t.which))break;t.preventDefault()}}}crmHistory.locationOrigin=window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.host,Crm.menu={setupScrollBind:!1,menusInDisplay:{},init:function(){var e=$(document);e.on("onBeforeClose",(function(e){var t=$(renderingUtils.getTargetElem(e));t.hide(),"divMacro"==t.attr("id")&&(thirdPartyUtils.unbindChildPerfectScroll(t),t.empty()),delete Crm.menu.menusInDisplay[t.attr("id")]})),e.on("menuItemClicked",(function(e,t){var a=$(renderingUtils.getTargetElem(e)).parents("div").eq(0);Crm.menu.hideMenu(t,a.id)})),e.click((function(e){var t=jQuery(".showPickList");t.is(e.target)||0!==t.has(e.target).length||$(".pickList-pop").removeClass("active").fadeOut()}))},setupDropDown:function(e,t){hideMenu(event);var a=$("#newSettingsDropDown");if($(".prfImg").removeClass("icnfilter"),"undefined"!=typeof CrmPlusLib&&CrmPlusLib.isLoadedInCrmplusFrame)CrmPlusLib.showSidePanel(),sE(event);else{if(Crm.userDetails.RTL_ENABLED)a.css({right:"auto",left:"5px"});else{$(t),$(window);$(".newSettingsDropDown .SocialArrow").css({left:"auto",right:"16.5px"})}$("#conditionalFieldRightSection").length&&(Crm.userDetails.RTL_ENABLED?$("#conditionalFieldRightSection").css("left","-650px"):$("#conditionalFieldRightSection").css("right","-650px")),$("#validationRuleRightSection").length&&$("#validationRuleRightSection").hide()}0!=$("#susbcriptionInfo").length&&""==$("#susbcriptionInfo").html().trim()&&$("#susbcriptionInfo").remove(),0!=$("#susbcriptionInfo").length&&1==$("#susbcriptionInfo").find(".topsettingslink").length&&0==!$("#susbcriptionInfo").find(".susbscriptionLink").length&&($("#susbcriptionInfo").css("border",""),$("#susbcriptionInfo").removeClass("pB7 pT7")),$("#profileIcon").attr("onclick","hideMenu(event);")},createMenu:function(e,t,a){document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop;var i=$(a);if("object"!=typeof t)t={id:t};var r=t.clickSelector?t.clickSelector:"li",l=customViewObject.isCampaignAddMemberListView&&"columnList"===t.id?$("#lv_table_holder #columnList"):$("#"+t.id);if(this.menusInDisplay[t.id]=!0,!l[0]){var n=document.createElement("div");for(var s in l=$(n),t)"menuItems"!==s&&l.attr(s,t[s]);for(var o=t.menuItems,d=o.length,c=document.createElement("ul"),m=0;m<d;m++){var u=o[m],p=document.createElement("li"),g=document.createElement("a"),v=$(g);v.html(I18n.getMsg(u.label)).data(u.data).attr({class:"link",href:"javascript:void(0);"}),this.attachEvent(v),p.appendChild(g),c.appendChild(p)}n.appendChild(c),document.body.appendChild(n)}!1!==t.setDefaultPos&&("runMacro"==i.attr("id")&&"forecastdbtn"!=i.closest("#forecastdbtn").attr("id")||this.positionMenu(e,l,t.fitInWindow)),setTimeout((function(){l.trigger("onBeforeShow",e),0!=t.hideOnMenuClick&&l.find(r).each((function(){$(this).click((function(e){$(this).trigger("menuItemClicked",e)}))}));var a=!1;if(store.peekAll("module").forEach((function(e){"Projects"===e.api_name&&e.visible&&(a=!0)})),a)if("undefined"!=typeof businessCardJson&&businessCardJson.isProjectTask)$("#addtoZprojects").hide(),Crm.menu.showCreateMenuDrpDown(l);else{var i=Lyte.Router.getRouteInstance(),n=i.parent.parent.getDynamicParam();if(null===n||"Activities"!==n&&"Tasks"!==n)$("#addtoZprojects").hide(),$("#septorProjects").hide(),Crm.menu.showCreateMenuDrpDown(l);else{var s=i.queryParams;if(s&&(!s.contains("sub_module")||s.contains("sub_module")&&"Tasks"===i.getQueryParams().sub_module)||"Tasks"===n){var o=[],d=networkUtils.returnDependencyFiles(["crm-project-sync-task.js"],crmConstants.jsStaticPathForLyte),c=networkUtils.returnDependencyFiles(["crm-zprojects-sync-task.css"],crmConstants.cssStaticPathForLyte);o=o.concat(d.concat(c)),Lyte.injectResources(o,void 0,(function(){var e=Lyte.Router.getRouteInstance().parent.getDynamicParam();void 0!==e&&store.findAll("crm-project-sync-task",{task_id:e},!1).then((function(e){var t=$("#addtoZprojects"),a=$("#septorProjects");e&&null!==e.firstSelectedProject&&"TASK_NOT_SYNCED"===e.code&&0==$("#subvalue_RECURRING").text().length?(a.show(),t.show()):(a.hide(),t.hide()),Crm.menu.showCreateMenuDrpDown(l)}),(function(){$("#addtoZprojects").hide(),$("#septorProjects").hide(),Crm.menu.showCreateMenuDrpDown(l)}))}))}else $("#addtoZprojects").hide(),$("#septorProjects").hide(),Crm.menu.showCreateMenuDrpDown(l)}}else $("#addtoZprojects").hide(),$("#septorProjects").hide(),Crm.menu.showCreateMenuDrpDown(l)}),100)},showCreateMenuDrpDown:function(e){e.is(":visible")||(e.show(),$("#columnlistsearch").focus(),"undefined"!=typeof columnListVDropDown&&($("input[value='CrmTask:ISCALLBILLABLE:Billable:']").closest("li").remove(),1==columnListVDropDown?$("#columnList").css("min-width",$("#columnList .ddMenus").outerWidth()):columnListVDropDown=!1))},attachEvent:function(e){e.click((function(e){$(this).parents("li").eq(0).trigger("menuItemClicked",e)}))},positionMenu:function(e,t,a){var i=$(renderingUtils.getTargetElem(e)),r=i.offset(),l=$(t),n=$(window),s=$("#cvpadding"),o=$("#detailViewButtonLayerDiv");r.top+=i[0].offsetHeight,n.width()<l.width()+r.left&&(r.left=r.left+i[0].offsetWidth-l.width()),a&&n.height()<r.top+t.height()+(isChatEnabled?26:0)&&(r.top=r.top-i[0].offsetHeight-l.height());var d=r.top-s.outerHeight();if(o.length&&1==Crm.userDetails.detailView_newUI&&null!=Crm.userDetails.detailView_newUI&&"columnList"!=$(t).attr("id")){var c=o.outerHeight(),m=0;"undefined"!=typeof CrmPlusImpl&&CrmPlusImpl.isLoadedInCrmplus()&&(m=35),$("#zbModuleTabLayer").is(":visible")||$("#zohoExpenseTabLayer").is(":visible")?r.top=r.top-(c+100-m):r.top=r.top-(c+60-m)}t.css({position:"absolute",display:"none",top:r.top+"px",left:r.left+"px"}),0==$("#copyListviewHeaderDiv").is(":visible")&&1==s.hasClass("pFixed")&&1==columnListVDropDown&&t.css({position:"absolute",display:"none",top:d+"px",left:r.left+"px"})},hideMenu:function(e,t){if(t)(i=$("#"+t)).is(":visible")&&i.trigger("onBeforeClose",e);else for(var a in this.menusInDisplay){var i;if(this.menusInDisplay[a])(i="columnList"===a&&customViewObject.isCampaignAddMemberListView?$("#lv_table_holder #columnList"):$("#"+a)).is(":visible")&&i.trigger("onBeforeClose",e)}$("#profileIcon").attr("onclick","Crm.menu.setupDropDown(event, this); slidelt('frmSetupClick'); sE(event);$('#editionTrialDiv').hide();")},globalHideMenu:function(e){var t=Lyte.Router.getRouteInstance()?Lyte.Router.getRouteInstance().transition.target:"";if(["crm.tab.module.create","crm.tab.module.entity.edit","crm.tab.module.entity.clone","crm.tab.newForecasts.list","crm.tab.newForecasts.view","crm.tab.newForecasts.edit","crm.tab.newForecasts.create","crm.tab.newForecasts.bread-crum","crm.tab.newForecasts.clone"].contains(t)&&Lyte.Router.getRouteInstance().lyteConvertionSupported&&e)Lyte.registeredMixins["crm-create-mixin"].createglobalhide(e);else{var a=$("#eventMultipleRemindersDiv"),i=$("#nTsaveAsDraft"),r=i.is(":visible");a.length>0&&a.is(":visible")&&a.hide(),(ue=$(".cm-icon"))&&ue.removeClass("cm-icon-active"),(pe=$(".crm-wms-icon")).length&&pe.removeClass("footIconActive"),$(".prfImg").addClass("icnfilter");var l=null;l=(l=renderingUtils.getTargetElem(e))||document.getElementById("show");var n=$(l),s=$("#qCreate"),o=0,d=$(".clickDropDown");if(l&&"showMenu"!=l.id&&"showSubMenu"!=l.id&&"export"!=l.id&&"locateMap"!=l.id&&"copyAddress"!=l.id&&"btnExport"!=l.id&&"moreTools"!=l.id&&"btnConvert"!=l.id&&"newAttach"!=l.id&&"sndMail_Top"!=l.id&&"sndMail_Buttom"!=l.id){$("#ddm, .IP_search_userslist").hide(),n.hasClass("fieldLiP")||n.closest("li").hasClass("fieldLiP")||$(".fieldLiP").removeClass("selectedLis");var c=$("#diNotificationDiv"),m=s.hasClass("ziaForEmailsCheck"),u=s.hasClass("cns");m||$(".etTrendsWrapper").length||u||$(".etTrendsWrapperCNS").length||$(".cxPermissionDeniedAlert").length||c.is(":visible")&&(CrmIntelligence.toFooter(c),CrmIntelligence.hideDiNotification());var p=document.getElementById("viewFeatures");if(p&&e&&"none"!==p.style.display&&!e.target.classList.contains("msg-board-icon-active")&&"stackedNumber"!==e.target.id&&"msgBoardDisplay"!==e.target.id&&"What's new in Zoho CRM"!==e.target.innerText&&"a"!==e.target.localName&&"img"!==e.target.localName){var g=document.querySelector("#msgBoardDisplay .msg-board-icon"),v=document.getElementById("mics_stacked_carpet"),h=document.getElementById("mics_stacked_backdrop");p.style.display="none",g.classList.remove("msg-board-icon-active"),v.style.display="none",h.style.display="none";var f=$L("html"),y=document.getElementById("stNotes");y&&"block"===y.style.display?f.addClass("oH"):f.removeClass("oH")}var C=$("#surveyicon");if(C.hasClass("surveyFeedbackIconActive")&&0===$(".listHoverRed").length&&0===$(".listHoverOrange").length&&0===$(".listHoverGreen").length){var b=$("#surveyPopup");b.hide(),b.css({bottom:"-500px"}),$("#bad,#ok,#good,#great,#perfect,#buttons,#commentdiv").addClass("dN"),C.removeClass("surveyFeedbackIconActive").addClass("surveyFeedbackIcon"),$("#sf_Rating li").removeClass(),$("#later").removeClass("dN")}var T=$("#popupnew"),I=!1,w=document.getElementById("services-deleteProfile");if(e&&w){var L=$("crm-services-deleteprofile");w.ltProp("show")&&(I=!0),L[0].getData("isPopUpNew")||(I=!0,L[0].setData("isPopUpNew",!0))}var k=!($(".commonRightPanel").length||!Lyte.Router.getRouteInstance())&&Lyte.Router.getRouteInstance().transition.preservePopup,P=document.getElementById("iskanbanview");k||!T.is(":visible")||P&&"true"===P.value||"true"===T[0].getAttribute("nofreezeover")&&!$("#FreezeLayer").is(":visible")||$L("#memStatusDeleteWarningPop").length||I||(T.attr("style","").hide(),removeFreezeLayer());var D=$("#recentMailsDiv")[0];if(D&&"block"==D.style.display){for(var M=e||window.event,_=M.target||M.srcElement,E=$("#rmStatusMesg"),S=$("#Crm_Tasks_DUEDATE");_;){if("calenDiv"==_.id||S.length>0&&E.length>0){var x=1;break}_=_.parentNode}x||(document.body.removeChild(D),$(".mailIc").attr("class","mailIc"))}}var B,R=$L("#predictedPopover",$L("crm-target-deals-popover"));!R||!R.length||e&&e.target&&"INPUT"===e.target.nodeName||R[0].ltProp("show",!1),$("#eventViewPopup").is(":visible")&&!($("#callDateSpanEdit").is(":visible")||l&&0!==n.parents("#eventCreatePopup").length||l&&"cancelEventBtn"===l.id||l&&"delEveFromQV"===l.id||"editbtn"===at&&"calendar"===tt)&&Events.closeQuickView(),(B=$(".wid_calSettings_opts")).length>0&&B.is(":visible")&&B.hide(),(B=$(".wid_calCreate_opts")).length>0&&B.is(":visible")&&B.hide();var A=$("#wid_calCreate_opts_menu");A.length>0&&A.is(":visible")&&A.hide();var F=$("#wf_action_failureReasons");F.length>0&&F.is(":visible")&&WFInsights.hideFailureReasons();var O=$("[id^='eventActionsMenu_sec']");O.is(":visible")&&O.hide(),!getElemById("Crm_Events_ENDDATETIME_TimeOption_List")||"block"!==getElemById("Crm_Events_ENDDATETIME_TimeOption_List").style.display&&""!==getElemById("Crm_Events_ENDDATETIME_TimeOption_List").style.display||$("#Crm_Events_ENDDATETIME_TimeOption_List").remove(),!getElemById("Crm_Events_STARTDATETIME_TimeOption_List")||"block"!==getElemById("Crm_Events_STARTDATETIME_TimeOption_List").style.display&&""!==getElemById("Crm_Events_STARTDATETIME_TimeOption_List").style.display||$("#Crm_Events_STARTDATETIME_TimeOption_List").remove(),!getElemById("time_List")||"block"!==getElemById("time_List").style.display&&""!==getElemById("time_List").style.display||$("#time_List").remove();var N=$("#calUserSelectionPop");N.length>0&&N.is(":visible")&&calView.closeUserSelComponent();var U=getElemById("searchCategoryDiv");if(U&&"block"==U.style.display&&(1==(o+=1)?U.style.display="block":2==o&&(U.style.display="none",o=0)),0!=d.length&&(d.removeClass("clickDropDown").addClass("normalDropDown"),$(".ddM").each((function(){"block"==$(this).css("display")&&$(this).hide()})),$(".settingIconH").removeClass("settingIconH").addClass("settingIcon")),$("#Macro_TaskCreatePopup, .Macro_containerDiv").find(".focusEleField").removeClass("focusEleField"),void 0!==e&&"searchUserLookup"!==$(e.target).attr("name")&&$('[name="searchUserLookup"]').closest(".labelValCreate").removeClass("focusEleField"),$("#campaignTypeSummaryDetails").remove(),!Crm.isHeadless){var z=Notes.mentionedCommentIds.length;if(z>0){for(var q=0;q<z;q++){var j=Notes.mentionedCommentIds[q];j.startsWith("feed_")&&Notes.destroyMentionsComponent(j)}Notes.mentionedCommentIds.length=0}}var V=$("#showOneFeed");V.is(":visible")&&V.hide();var H=$("#feedsGroupMembersDiv");H.is(":visible")&&H.hide(),!0===$(".followers").is(":visible")&&this.hideFollowers("flrs","followers"),$(".feedDeleteAction").css({display:"none"});var W=$("#Calendar")[0];if(W&&"block"==W.style.display&&"block"!=s[0].style.display&&!tkveventajax){var Q=document.getElementById("headertextarea_End DateTime"),G=document.getElementById("headertextarea_Call Start Time"),Z=document.getElementById("headertextarea_Start DateTime");Q&&""!==Q.innerHTML.trim()&&"textbox_Start DateTime"!==l.id&&($("#headertextarea_End DateTime").empty(),document.getElementById("headerdisplayvalue_End DateTime").style.display="inline",itsonview=!1),G&&""!==G.innerHTML.trim()&&($("#headertextarea_Call Start Time").empty(),document.getElementById("headervalue_Call Start Time").style.display="inline",itsonview=!1),Z&&""!==Z.innerHTML.trim()&&"textbox_Start DateTime"!==l.id&&($("#headertextarea_Start DateTime").empty(),document.getElementById("headerdisplayvalue_Start DateTime").style.display="inline",itsonview=!1),("calenderDueDate"!==l.id&&"headervaluetkv_Due Date"!==l.id||Q&&""===Q.innerHTML)&&crmCalendar.close()}var J=$(".moreOptionRow"),Y=$(".callMoreOptionNew");Y.is(":visible")&&(Y.hide(),J.removeClass("moreOptionRow"));var K=$(".appMoreOptionNew");K.is(":visible")&&($("#dvinner").removeClass("moreOpt_prevent_scroll"),K.remove(),J.removeClass("moreOptionRow"));var X=$(".calculaterInfo .calculatedValue");if(X.length&&(X.html(""),$(".calculaterInfo").css({display:"none"})),l&&"showMenu"!=l.id&&"showSubMenu"!=l.id&&"export"!=l.id&&"locateMap"!=l.id&&"copyAddress"!=l.id&&"btnExport"!=l.id&&"moreTools"!=l.id&&"btnConvert"!=l.id&&"newAttach"!=l.id&&"sndMail_Top"!=l.id&&"sndMail_Buttom"!=l.id){var ee=$("div[name='ownerNameLookup']"),te=l.parentElement;if(l.getAttribute&&"searchUserLookupUl"!==l.getAttribute("name")&&"ownerNameLookupSpan"!==l.getAttribute("name")&&"searchUserLookup"!==l.getAttribute("name")&&ee[0]&&/block|/.test(ee[0].style.display)&&!/hostSearch/.test(l.id)&&"hostSrcBox"!==l.id&&"Crm_Events_SMOWNERID"!==l.id&&(!te||"searchUserLookup"!==te.getAttribute("name"))){ee.hide(),$(".popup-model-content,.pp-content").removeClass("oH");var ae=ee.attr("data-fieldName");$('input[id^="hostSearch_temp_searchuser"]').removeAttr("onclick");var ie=$("#"+ae),re=ie.prev("input");ae&&null!=re.val()&&""===re.val()&&ie.children("ul").children("input").css("display",""),$(".focusFieldNewUpdate").removeClass("focusFieldNewUpdate")}if(/hostSearch/.test(l.id)){var le=$("#"+l.id),ne=le.is("[readonly]"),se=le.parent().parent().attr("id");ne?$("#ownerNameLookup_"+se).css("display","none"):$("#ownerNameLookup_"+se).css("display","")}}if(!Crm.isHeadless&&crmNTC.isSignalDetailViewVisible()){void 0!==l&&"signalDetailViewClose"===l.id&&crmNTCDetailView.closeDetailView(),"undefined"===l.id||"signalsActivityDiv"===l.id||s.is(":visible")&&$("#eventCreatePopup").is(":visible")&&$("#createEditCallDiv").is(":visible")||(getElemById("signalsActivityDiv").style.display="none")}else if($("#notificationscontainer").hasClass("open")){crmNTCGlobal.closeGlobalNotifications(),$(".notifiactionIcon").removeClass("notifiactionIconH"),$("#notifications_inner").empty(),AcsApi.resetBadgeCount("UNS");var oe=$("#signalsActivityDiv");oe.is(":visible")&&oe.hide()}Crm.menu.hideMenu(e);var de=document.querySelector("crm-p2p-referral");if(de&&de.component){var ce=de.component;!0===ce.getData("showReferralPanel")&&ce.hideReferralPopupComplete()}$(".customUrl,.ctiAddRecord,#ctiapi_unknown_add_associate,div[id^=entityPhnoDiv_]").hide();var me=$("#createsubmenu")[0];if(l&&"createsubmenu"!=l.id&&me&&"block"==me.style.display&&(me.style.display="none"),"crm.tab.module.custom-view.list"!=t){$("[data-close=true]").hide();var ue,pe,ge=$("#columnList");"block"==ge.css("display")&&(ge.removeClass("columnListForHeader columnListForFixHeader"),$("#listviewHeaderRow #addColumn").removeClass("addColumnActive")),$("#weekdayList").is(":visible")&&pushComponent.cancelWeekDaysDiv(),(ue=$(".cm-icon")).hasClass("cm-icon-active")&&ue.removeClass("cm-icon-active"),(pe=$(".crm-wms-icon")).length&&pe.removeClass("footIconActive"),$(".freezeTransparent").is(":visible")&&CMB.hideRelatedListColumns();var ve=$("#alphaSearch");"block"==$("#alphaRefTable #alphaTable").css("display")&&1==ve.hasClass("alphaSearchActive")&&ve.removeClass("alphaSearchActive");var he=$(".NodeContextMenu"),fe=$(".linkContextMenu");if("block"!=fe.css("display")&&"block"!=he.css("display")||(he.hide(),fe.hide()),"true"==$(".userbcpopup").is(":visible")&&$("#userBCDiv").hide(),l&&"showMenu"!=l.id&&"showSubMenu"!=l.id&&"export"!=l.id&&"locateMap"!=l.id&&"copyAddress"!=l.id&&"btnExport"!=l.id&&"moreTools"!=l.id&&"btnConvert"!=l.id&&"newAttach"!=l.id&&"sndMail_Top"!=l.id&&"sndMail_Buttom"!=l.id){var ye=$("#customizedd")[0];ye&&"block"==ye.style.display&&(ye.style.display="none",$("#CustomizeTools").attr("class","newgraybtndd moredot"));var Ce=$("#menu")[0];Ce&&"block"==Ce.style.display&&(crmTab.li=void 0,crmTab.liSelected=void 0,$(document).unbind("keyup.menSrchBind"),$("body").removeClass("oH"),Ce.style.display="none",document.getElementById("showMenu").className="",$("#menu_more").removeClass("menuMoreOn"));var be=$("#dropDownMenu")[0];be&&"block"==be.style.display&&(be.style.display="none");var Te=getElemById("containerDIV"),Ie=getElemById("territorydrop");if(Te&&"block"==Te.style.display&&"territorysearch"!=l.id&&(Te.style.display="none"),!Ie||""!=Ie.style.display&&"block"!=Ie.style.display||"territorysearch"==l.id||(Ie.style.display="none"),n){var we=n.closest("div"),Le=getElemById("optionsHolder");Le&&"block"==Le.style.display&&(0==we.length||!we.attr("id")||0!=we.length&&"optionsHolder"!=we.attr("id")&&-1==we.attr("id").indexOf("combo")&&0==$(Le).has(we).length)&&CustomView.hideDropdown(Le)}var ke=getElemById("forecastSettings");ke&&"fcsettings"!=l.id&&"forecastSettings"!=l.id&&l.parentNode&&"assignment"!=l.parentNode.id&&"radio"!=l.parentNode.id&&"block"==ke.style.display&&(ke.style.display="none");var $e=getElemById("suggestDetails");$e&&"suggestDetails"!=l.id&&"suggest"!=l.id&&l.parentNode&&"fcName"!=l.parentNode.id&&"previous"!=l.parentNode.id&&""==$e.style.display&&($e.style.display="none");var Pe=getElemById("surveys"),De=getElemById("dulplicate_title");Pe&&(Pe.style.display="none",De&&(De.style.display="none"));var Me=getElemById("customrecord");Me&&(Me.style.display="none");var _e=getElemById("territoryDropdown");_e&&"territorytooltip"!=l.id&&l.parentNode&&"territorytooltip"!=l.parentNode.id&&"territoryField"!=l.id&&"territorysearch"!=l.id&&"selectField"!=l.id&&("block"==_e.style.display||""==_e.style.display)&&(_e.style.display="none");var Ee=getElemById("forecastQC");Ee&&"quarterDiv"!=l.id&&l.parentNode&&"quarterDiv"!=l.parentNode.id&&("block"==Ee.style.display||""==Ee.style.display)&&(Ee.style.display="none");var Se=getElemById("foreYear");Se&&"yearDiv"!=l.id&&l.parentNode&&"yearDiv"!=l.parentNode.id&&("block"==Se.style.display||""==Se.style.display)&&(Se.style.display="none"),l.parentNode&&"remove"!=l.parentNode.classname&&"tableHeadBg"!=l.parentNode.classname&&$("#territorydetails").css("display","none");var xe=$(".pb_feildpopOption");1==xe.length&&xe.remove();var Be=$(".pb_feildpopOptionRL");Be.length>0&&(Be.hide().removeClass("fixedRelatedDiv"),thirdPartyUtils.bindPerfectScroll(".add_transition"));var Re=$("#combo")[0];"fontDropDown"!=l.id&&"fontname"!=l.id&&Re&&"block"==Re.style.display&&(Re.style.display="none");var Ae=$("#workflowMenu")[0];"addAction"!=l.id&&Ae&&"block"==Ae.style.display&&(Ae.style.display="none");var Fe=$("#gadgetsMenu")[0];"accounts"==l.id||!Fe||"leads"==l.id||"contacts"==l.id||"tasks"==l.id||"block"!=Fe.style.display||l.id.indexOf("gadgets_")>-1||(Fe.style.display="none");var Oe=$("#externalIframe")[0],Ne=$("#mailPageLayoutFooter")[0];null==Oe&&Ne&&(Ne.className="");var Ue=$("#summaryEdit")[0];Ue&&(Ue.onclick(),setTimeout((function(){$("body > .select2-container--open").remove()}),5));var ze=$("#newMenu")[0];if(ze&&"block"==ze.style.display){ze.style.display="none";do{ze=ze.previousSibling}while(ze&&1!=ze.nodeType);ze.className="normalDropDown"}var qe=$("#editEntityIamgeDiv")[0];qe&&"block"==qe.style.display&&($(qe).empty(),qe.style.display="none");var je=$("#leftPanelCalendarP")[0],Ve=$("#sCalenDar")[0];je&&"block"==je.style.display&&(je.style.display="none",Ve.className="svgIconsImg newCalendarIcon");var He=$("#h2")[0];He&&"block"==He.style.display&&(He.style.display="none");var We=$("#detailddMenu")[0];We&&"block"==We.style.display&&(We.style.display="none",We.parentNode.className="normalDropDown");var Qe=$("#dropDownMenuCnt")[0];Qe&&"block"==Qe.style.display&&(Qe.style.display="none",Qe.parentNode.className="normalDropDown convertBtn");var Ge=$("#businessCardDiv")[0];Ge&&"block"==Ge.style.display&&document.body.removeChild(Ge);var Ze=$("#tooltip-zc")[0];Ze&&(Ze.style.display="none");var Je=renderingUtils.targetElement(e);Je&&"textbox_Due Date"!==Je.id&&"calenderDueDate"!==Je.id&&"headervaluetkv_Due Date"!==Je.id&&document.getElementById("headertextarea_Due Date")&&""!==document.getElementById("headertextarea_Due Date").innerHTML.trim()&&"none"===document.getElementById("headervaluetkv_Due Date").style.display&&($("#headertextarea_Due Date").empty(),document.getElementById("headervaluetkv_Due Date").style.display="inline-block",itsonview=!1);var Ye=$(".sort_div");Ye&&Ye.is(":visible")&&Ye.hide();var Ke=Ae;Ke&&"none"!=Ke.style.display&&"addAction"!=l.id&&(Ke.style.display="none"),Ke=null}if(getElemById("invitation")&&("block"==getElemById("invitation").style.display||""==getElemById("invitation").style.display)){getElemById("invitation").style.display="none";var Xe=$("#myInvites");Xe.removeClass("invNotSel");var et=$("#myinvitationCnt").val();""!==et&&void 0!==et&&parseInt(et)<=0&&Xe.remove()}!getElemById("invStatusDropdown")||"block"!=getElemById("invStatusDropdown").style.display&&""!=getElemById("invStatusDropdown").style.display||(getElemById("invStatusDropdown").style.display="none"),!getElemById("invStatusDropdownFromDetailMenu")||"block"!=getElemById("invStatusDropdownFromDetailMenu").style.display&&""!=getElemById("invStatusDropdownFromDetailMenu").style.display||(getElemById("invStatusDropdownFromDetailMenu").style.display="none"),!getElemById("eventActionsMenu")||"block"!=getElemById("eventActionsMenu").style.display&&""!=getElemById("eventActionsMenu").style.display||(getElemById("eventActionsMenu").style.display="none"),!getElemById("addAttOptions")||"block"!=getElemById("addAttOptions").style.display&&""!=getElemById("addAttOptions").style.display||(getElemById("addAttOptions").style.display="none"),!getElemById("calUsersList")||"block"!=getElemById("calUsersList").style.display&&""!=getElemById("calUsersList").style.display||(getElemById("calUsersList").style.display="none");var tt="",at="";if(l){at=n.attr("data-cid");var it=n.attr("data-params");it&&(tt=(it=JSON.parse(it)).from)}var rt=$("#twistatuschangepopup")[0];rt&&jQuery(rt).is(":visible")&&"twistatusimgicon"!==l.id&&"lily_status_icon"!==l.id&&($(rt).empty(),rt.style.display="none");var lt=$("#aclayer")[0];lt&&"block"==lt.style.display&&(lt.style.display="none");var nt=$("#feedback_top")[0];nt&&"block"==nt.style.display&&(nt.style.display="none");var st=$("#pmrlstact_d")[0];if(st){st.style.display="none",$("#lstact_d").empty();var ot=$("#dtl_nxt_st")[0];ot&&(ot.value="0")}var dt=getElemById("selectUsersMenuList");if(dt&&"block"==dt.style.display&&(dt.style.display="none"),Crm.listRId){var ct=$("#"+Crm.listRId[0]+"_"+Crm.listRId[1]);-1!==Crm.listRId[0].indexOf("TASKS")&&-1!==Crm.listRId[0].indexOf("EVENTS")&&-1!==Crm.listRId[0].indexOf("APPOINTMENTS")&&-1!==Crm.listRId[0].indexOf("CALLS")&&"hidden"!=ct.css("visibility")&&ct.addClass("newRlEdit").removeClass("selectRlEdit").css("visibility","hidden")}if($("div[id^='customRelatedListMenuDiv']").length>0){var mt=$("[id^='rlDropDown']");mt.removeClass("selectRlEdit"),mt.addClass("newRlEdit"),mt.css("visibility","hidden"),$("div[id^='customRelatedListMenuDiv']").hide()}$("div[id^='customizeCustomTab_']").length>0&&($("[id^='settingIcon_']").removeClass("settingIconH"),$("[id^='settingIcon_']").addClass("settingIcon"),$("div[id^='customizeCustomTab_']").hide());var ut=$("#webformWidth"),pt=$("#fieldPropPick"),gt=$(".fieldProp li");ut&&"block"==ut.css("display")&&($("#frmwidth").val($("#formWidth").val()),ut.css("display","none"),pt.css("display","none"),gt.removeClass("active"));var vt=$("#webformfa");vt&&"block"==vt.css("display")&&(vt.css("display","none"),pt.css("display","none"),gt.removeClass("active"));var ht=$("#webformff");ht&&"block"==ht.css("display")&&(ht.css("display","none"),pt.css("display","none"),gt.removeClass("active"));var ft=$("#webformfs");ft&&"block"==ft.css("display")&&(ft.css("display","none"),pt.css("display","none"),gt.removeClass("active"));var yt=$("#moreusrs");yt[0]&&"block"==yt.css("display")&&yt.css("display","none"),getElemById("userList")&&"block"==getElemById("userList").style.display&&($("#userList").css("display","none"),$("#assignToUser").removeClass("Fld"));var Ct=$("#rguserslistcon");Ct[0]&&"block"==Ct.css("display")&&Ct.css("display","none");var bt=$("#rolediv");bt[0]&&"block"==bt.css("display")&&bt.css("display","none");var Tt=$("#grpdiv");Tt[0]&&"block"==Tt.css("display")&&Tt.css("display","none");var It=$(".userListPopMore");It&&"block"==It.css("display")&&It.css("display","none"),$(".settingNewIcon").removeClass("settingNewIconH");var wt=$("#headervaluetkv_Venue");if(wt&&"none"==wt.css("display")&&Je&&"textbox_Venue"!==Je.id&&"venuetask"!==Je.id&&"headervaluetkv_Venue"!==Je.id&&"Related_photo"!==Je.id){wt.css("display","block");var Lt=$("#headertextarea_Venue");Lt&&(Lt.html(""),itsonview=!1)}var kt=$("#headervaluetkv_Subject");if(kt&&"none"==kt.css("display")&&Je&&"textbox_Subject"!==Je.id&&"headervaluetkv_Subject"!==Je.id){kt.css("display","block");var $t=$("#headertextarea_Subject");$t&&($t.html(""),itsonview=!1)}var Pt=$("#kvvalues_Status"),Dt=$("#kanbanTaskDetailctn div"),Mt=$(".pDown");void 0!==Pt[0]&&!Pt.hasClass("hide")&&Je&&"kvfieldvalue_Status"!==Je.id&&"tkvdownarrow"!==Je.id&&(Pt.addClass("hide"),Mt.removeClass("active"),Dt.eq(0).removeAttr("style"),itsonview=!1);var _t=$("#kvvalues_Priority");void 0!==_t[0]&&!_t.hasClass("hide")&&Je&&"kvfieldvalue_Priority"!==Je.id&&"tkvdownarrow"!==Je.id&&(_t.addClass("hide"),Mt.removeClass("active"),Dt.eq(0).removeAttr("style"),itsonview=!1),document.getElementById("kvvalues_Call Type")&&!$('[id="kvvalues_Call Type"]').hasClass("hide")&&Je&&"kvfieldvalue_Call Type"!==Je.id&&($('[id="kvvalues_Call Type"]').addClass("hide"),Dt.eq(0).removeAttr("style"),itsonview=!1);var Et=$(".moreactionlist");Et&&"block"==Et.css("display")&&"undefined"!=TaskKanbanView.tkvMoreAction&&1===TaskKanbanView.tkvMoreAction?(Et.css("display","none"),TaskKanbanView.tkvMoreAction=0):Et&&"block"==Et.css("display")&&(TaskKanbanView.tkvMoreAction=1);var St=$("#showLdSettings");"block"==St.css("display")&&St.fadeOut(),$("#signalSettingsHelpWrap").is(":visible")&&crmNTCSettings.closeSignalSettingHelpDiv(),!Crm.isHeadless&&SalesSignalsWrapper.isSignalIFrameOpen&&"signalsIframe"!==window.name&&window.signalsIframe&&SalesSignals.closeGlobalNotifications();var xt=$("#showLdhelpSettings");"block"==xt.css("display")&&xt.fadeOut(),$("#dateListDropDown").addClass("hide");var Bt=$(".ap"),Rt=Bt.length;$("#serviceDurationsUL").is(":visible")&&$("body").css({overflow:"auto"});for(q=0;q<Rt;q++){var At=$(Bt[q]);"block"==At.css("display")&&At.css("display","none")}var Ft=$("#rep_runreportPop"),Ot=$("#rep_runreportPop1"),Nt=$(".rep_selectedRow"),Ut=$(".freezeLayerdrop");"block"==Ft.css("display")&&(Ft.hide(),Ut.hide(),Nt.removeClass("rep_selectedRow").closest("td").trigger("onmouseleave"),thirdPartyUtils.bindPerfectScroll("#reportsConta",{wheelSpeed:1})),"block"==Ot.css("display")&&(Ot.hide(),Ut.hide(),Nt.removeClass("rep_selectedRow").closest("td").trigger("onmouseleave"),thirdPartyUtils.bindPerfectScroll("#reportsConta",{wheelSpeed:1})),"block"==Ft.css("display")&&(Nt.removeClass("rep_selectedRow").closest("td").trigger("mouseleave"),Ft.hide(),Ut.hide(),thirdPartyUtils.bindPerfectScroll("#reportsConta",{wheelSpeed:1}));var zt=$(".newCustomDropDownContainer ul");zt.length&&zt.slideUp();var qt=$(".dropdownOptionsList");qt.length&&(qt.hide(),$(".selectedCustomSpan").removeClass("selectedCustomSpan"));var jt=$("#ModuleListDiv");jt.is(":visible")&&jt.hide();var Vt=$("#layoutListDiv");Vt[0]&&"block"==Vt.css("display")&&(Vt.css("display","none"),$("#existLayoutNameDiv").toggleClass("bb0"));var Ht=$(".showAct");Ht.hasClass("showAct")&&Ht.removeClass("borAct");var Wt=$("#toolsId");Wt.is(":visible")&&Wt.slideUp(100);var Qt=$("#importDiv");Qt.is(":visible")&&Qt.slideUp(100);var Gt=$("#importRevampDiv");Gt.is(":visible")&&Gt.slideUp(100);var Zt=$("#impRelatedToDiv");if($("#crmFieldDropDown").is(":visible")&&!Zt.is(":visible")){$("#crmFieldDropDown .custom_select_Dropdown").scrollTop(0),$("#crmFieldDropDown .custom_select_Dropdown").find(".crmCustomeFielddorpGray").removeClass("crmCustomeFielddorpGray"),$("#crmFieldDropDown").hide(),$(".ITF-container .itb-body-class").css("overflow","auto"),$("#crmFieldDropDown").unbind("keydown"),$(".dropDownIcon").find(".iconKeyDown").show();var Jt=$("#fieldChooseDiv.crmFieldMappingHoverClass input");if(Import.currentFieldmapSysRef&&""!=Import.currentFieldmapSysRef){var Yt=$("#crmFieldDropDown").find("span[data-sysRefName='"+Import.currentFieldmapSysRef+"']"),Kt=Yt.attr("data-i18nLabel");if(Yt&&Yt.length>0){if(Yt.hasClass("showmore_PolymorphicField")){var Xt=$("#impRelatedToDiv"),ea=Xt.find(".polymorphic_modules option:selected"),ta=Xt.find(".polymorpicLookupFieldFindBy option:selected"),aa=ea.val();Kt+=aa&&"All"!==aa?" ("+ea.text()+" --\x3e "+ta.text()+")":" ("+ta.text()+")"}else if(Yt.hasClass("showmore_Sublist")){var ia=$("input[id='fieldChoose'][data-sysRefName='"+Import.currentFieldmapSysRef+"']").attr("data-findBy");null!=ia&&""!=ia&&(subListObj=Yt.find("li[data-sysRefName="+ia+"]"),subListObj&&subListObj.length>0&&(Kt+=" ("+subListObj.text()+")"))}Jt.prop("value",Kt).attr("value",Kt)}}else Jt.prop("value","").attr("value","");$("#mappedFieldsList").find("strong").show(),$("#mappingFieldMoreContent").hide(),$("#crmFieldDropDown .custom_select_Dropdown").find(".appendTemporary").remove(),$("#mappedFieldsList li").removeClass("pointerOnMappedField").attr("style",""),Jt.blur(),Import.mappedFieldScroll=0,Import.chooseFieldChoosen=0,Import.crmCustomDropScrollTop=0,Import.dorpOpenStatus=0,Import.addAddional=0,1!==Import.crmCustomeDrop?Import.crmCustomeDrop=0:Import.crmCustomeDrop=1}if($("#importWarningMess").is(":visible")&&($("#importWarningMess").hide(),Import.crmCustomeDrop=0),$("#crmFieldDataformatDropdown").is(":visible")){var ra=$("#crmFieldDataformatDropdown");ra.find(".crmCustomeFielddorpGray").removeClass("crmCustomeFielddorpGray"),ra.find(".dataFormateDropDownNew").scrollTop(0),ra.hide();var la=$("#dataFormatButton.crmFieldMappingHoverClass input");if(la.blur(),$(".dropDownIcon").find(".iconKeyDown").show(),Import.currentSelectedDataformat&&""!=Import.currentSelectedDataformat){var na=ra.find("li[data-format='"+Import.currentSelectedDataformat+"']");na&&na.length>0&&la.prop("value",na.text()).attr("value",na.text())}else la.prop("value","").attr("value","");$(".ITF-container .itb-body-class").css("overflow","auto"),ra.unbind("keydown"),Import.crmCustomDropScrollTop=0}!$("#importMappingDiv").is(":visible")||$("#createNewFieldlist").is(":visible")||$("#crmFieldDataformatDropdown").is(":visible")||$("#crmFieldDropDown").is(":visible")||$(".ITF-container .itb-body-class").css("overflow","auto");var sa=$("#alphaTable");sa.is(":visible")&&"alphaSearch"!=n.attr("id")&&sa.slideUp(100);var oa=$("#btntoolsId");oa.is(":visible")&&oa.hide(),$(".remindersOptions").is(":visible")&&($(".remindersOptions").slideUp(100),$(".selectBoxInput").removeClass("SlctListAtv"));var da=$(".btntoolsIdList");da.is(":visible")&&da.hide();var ca=$(".feedFilterlist"),ma=$(".moduleSection"),ua=$(".feedfiltermodules");$("#tempctnList").length>0&&0==$(".mailmergeListSection").length&&($(".nteditdeleteIcon").removeClass("dBImp"),$(".ntfolderSettings").removeClass("disableIcohide"),"function"==typeof template.closeAssociate&&template.closeAssociate(),$("#nTshareFolder").is(":visible")||$("#moveToFolder").hide(),ma.removeClass("bdre3e2"),ca.hide(),ua.removeClass("feedfilterfocus")),($("#galleryHead").length>0||$(".editEmailTemp").length>0)&&(ma.removeClass("bdre3e2"),ca.hide(),ua.removeClass("feedfilterfocus")),$("#verificationPop").is(":visible")&&orgemail.hideVerificationPopup(),$("#templateAlertsPop").is(":visible")&&template.hideAnimatePopup("templateAlertsPop",!0),$("#templateName").length>0&&($(".editTempName,.nTSubsection").removeClass("editorTopScale").removeClass("subScale"),$("#cTmoduleName,.nTfavicn,#nTtoplink").show());var pa=$("#LDPOP");pa.length&&pa.is(":visible")&&CrmTracking.minimizePop();var ga=$("#emailEditor").contents().find("#surveys");"none"!=ga.css("display")&&(ga.hide(),$("#emailEditor").contents().find("#dulplicate_title").hide());var va=$(".customDropDown");va.length&&va.addClass("hide");var ha=$(".customButtonDom");ha.length&&(ha.hide(),$(document).scroll((function(){ha.hide()}))),$(".customUrl,.ctiAddRecord,#ctiapi_unknown_add_associate,div[id^=entityPhnoDiv_]").hide(),$("#viewCvariablesPOP").addClass("hide");var fa=document.querySelectorAll(".bCardPop"),ya=fa.length;for(q=0;q<ya;q++){var Ca=fa[q];Ca&&Ca.ltProp("show")&&Ca.ltProp("show",!1)}var ba=$("#HomePage_Selector");ba.length&&ba.is(":visible")&&ba.removeClass("hvw-active"),l&&!n.hasClass("inputfieldsection")&&$(".commonDrop").addClass("hide"),$(".inputfieldsection").removeClass("inputHighlight");var Ta=$("#setup_new_ContentDiv");$(".activeUserList").is(":visible")||!0!==Crm.menu.setupScrollBind||0===Ta.length||(Ta[0].removeEventListener("scroll",(function(){})),Crm.menu.setupScrollBind=!1),$(".TeamSettingDiv").is(":visible")&&($(".TeamSettingDiv").hide(),$(".TeamSettingDivSub").hide()),$(".thisisNewTool").is(":visible")&&$(".thisisNewTool").hide(),$("#zesLocateApnInfo").is(":visible")&&$("#zesLocateApnInfo").remove(),$("#zesUserEditOptions").is(":visible")&&($("#zesUserEditOptions").remove(),$(".zesUserHighlight").find(".zesUsersMoreIcon").addClass("vh"),$(".zesUserHighlight").removeClass("zesUserHighlight")),($(".zesViewAppMore").is(":visible")||$(".zesMobViewApp").is(":visible"))&&($(".zesViewAppMore").addClass("dN").removeAttr("style"),$(".zesMobViewApp").addClass("dN").removeAttr("style")),$("#zesEnrUserDet").is(":visible")&&$("#zesEnrUserDet").remove(),$("#zesUsersAppList").is(":visible")&&$("#zesUsersAppList").addClass("dN").removeAttr("style"),$(".zesSelOption").is(":visible")&&$(".zesSelOption").addClass("dN"),$(".zesDeleteDeviceIcon").is(":visible")&&$(".zesDeleteDeviceIcon").addClass("dN"),$("#wf_Container_p").length>0&&($(".wf_active_time").removeClass("wf_active_time"),$(".wf_moreIc").removeClass("wf_activeMore"),$(".wfActUlList,[id*=mailAndChatList]").hide()),$(".change_quote_tweet").is(":visible")&&$(".change_quote_tweet").hide();var Ia=$("#setup_new_ContentDiv");if($("#socCreateRule").is(":visible")){var wa=$L("#socAssignmentRules").closest(".socAssignRules");wa.length&&(wa.removeClass("socAssignRulesActive"),wa.find(".soc_assign_name").removeAttr("style"),wa.find("crm-social-assignment-rules")[0].remove(),$L(".socEditCriteria, .socDelCriteria").removeClass("socInEdit"),$L("#socCreateRule").removeClass("socCriteriaOpened"),$L(".socAddNwCir").removeClass("eventNone"))}$("#editionTrialDiv").is(":visible")&&$("#editionTrialDiv").hide(),$(".diNewToolTipForBestTime").is(":visible")&&crmBstTime.showOrHideBestTimeToolTip(0,0),Crm.isHeadless||hideUserBusinessCard(),"object"==typeof ZCampaigns&&ZCampaigns.hideWebinarToolTip();var La=$("#socMonitorMore");La.is(":visible")&&(La.addClass("dN").removeAttr("style"),$(".socMoreIconActive").removeClass("socMoreIconActive")),$("li.subformList").removeClass("subFrmAct subFrmActDumy"),$("#cusDropDownWrapper").is(":visible")&&$("#cusDropDownWrapper").css("display","none");var ka=$("#nTerrMsg");ka.is(":visible")&&ka.css("display","none"),$(".zesSelOption").is(":visible")&&$(".zesSelOption").addClass("dN"),$(".dItimesdiv").is(":visible")&&($(".dItimesdiv").hide(),$("#bestTimeListFilterId").hide());var $a=$("#socFilterByBrands");$a.is(":visible")&&($a.addClass("dN"),$(".socChooseBrand").removeClass("socChooseBrandActive")),($a=$("#socFilterByNetworks")).is(":visible")&&$a.addClass("dN");var Pa=$("#socDeskDepartmentDiv");Pa.is(":visible")&&($("#socConvoContent").removeAttr("style"),Pa.addClass("dN").removeAttr("style"));var Da=$("#socFilNwLists");Da.is(":visible")&&Da.addClass("dN"),$("#socColumnType").is(":visible")&&zsoTab.addColumnClose(),$("#socComposePost").is(":visible")&&crmui.hidePopup("socComposePost");var Ma=$("#socDeleteNwPosts");Ma.is(":visible")&&Ma.remove(),$("#reauth_alert").is(":visible")&&"undefined"!=typeof zsoTab&&zsoTab.closeReauthAlert(),$("#socViewConvPopup").is(":visible")&&zsoTab.viewConvoClose("socViewConvPopup"),$("#socLikeCountPopup").is(":visible")&&zsoTab.viewConvoClose("socLikeCountPopup");var _a=$(".socEntityDropDown");_a.is(":visible")&&_a.addClass("dN");var Ea=$("#lv_stageview"),Sa=$("#stageView_create_act");Ea.length&&Sa.hasClass("act-menu-opened")&&($(".stageview-data-container li").removeClass("liclicked"),Sa.removeClass("act-menu-opened")),$(".customDDList_withbtn").is(":visible")&&$(".customDDList_withbtn").hide();var xa=$("#ldealInfo");xa.is(":visible")&&xa.remove();var Ba=$("#AvailableRecords");Ba.is(":visible")&&Ba.css("display","none");var Ra=$("#ApprovalAvailableRecords");Ra.is(":visible")&&Ra.css("display","none"),$(".profOptionList").is(":visible")&&$(".profOptionList").hide(),$("#emailUserList").is(":visible")&&$("#emailUserList").hide();var Aa=$(".editDealOptions");Aa.is(":visible")&&Aa.hide(),$("#mailParser").is(":visible")&&mailparser.resetDropdown(),$("#mailParsePopup").is(":visible")&&mailparser.closePop("mailParsePopup"),$("[id=chooseTime]").is(":visible")&&($("[id=chooseTime]").remove(),Ia.removeClass("oHImp")),$(".shiftHoursDD").is(":visible")&&($(".shiftHoursDD").hide(),$("#selectCustomDDAddUser").closest("td").removeClass("wf_setFocus")),$("#shiftUserDelList").is(":visible")&&$("#shiftUserDelList").hide(),$("#shiftUserDelList1").is(":visible")&&$("#shiftUserDelList1").hide(),$("#shiftUserDelList2").is(":visible")&&$("#shiftUserDelList2").hide();var Fa=$(".customSelectVal");Fa.is(":visible")&&Fa.hide().removeClass("bottomFix");var Oa=$(".primarybtn_ddList");Oa.is(":visible")&&Oa.hide(),$(".dItimesdiv").is(":visible")&&($(".dItimesdiv").hide(),$("#bestTimeListFilterId").hide()),$(".diLaterTimeDiv").is(":visible")&&($(".clikedLaterbtn").removeClass("clikedLaterbtn"),$(".diLaterTimeDiv").hide()),$(".dICallTimerDiv").is(":visible")&&($(".dICallTimerDiv").hide(),$(".callBtnSel").removeClass("callBtnSel")),$(".reminderPauseDatesPopup").is(":visible")&&$(".reminderPauseDatesPopup").hide();var Na,Ua,za=$("#moreActionSbox");(za.is(":visible")||$("#usersSb").is(":visible"))&&(za.hide(),$("#usersSb").hide()),(Na=$(".sandboxLinkedPop:visible")).length>0&&($(".linkedCounts").removeClass("snd_sel"),$(".sandboxLinkedPop").addClass("dN")),$(".sbCustomeTooltip:visible").length>0&&$(".sbCustomeTooltip").remove(),(Na=$(".filterOptionContainer:visible")).length>0&&sandbox.closeDateFieldPopup(Na),(Ua=$(".addDevList:visible")).length>0&&Ua.hide(),(Ua=$(".addDevList:visible")).length>0&&Ua.hide();var qa=$(".addDevListMore:visible");qa.length>0&&qa.addClass("vh");var ja=$(".calSchDD .more-opt-list");ja.is(":visible")&&(ja.hide(),$(".calSchDD .moreIcon").css({opacity:"0",visibility:"hidden"})),$(".subFrmRemoveInfoPop:visible").length>0&&CrmSubform.firstTimeDeleteInfoHide();var Va=$(".userListPopup_BH");Va.is(":visible")&&Va.hide(),0==$(".newpopup").is(":visible")&&$(".taxActiveElement").removeClass("taxActiveElement"),$("#social_dmm_popup:visible").length>0&&$("#social_dmm_popup").hide();var Ha=$("#filter_div");Ha.is(":visible")&&Ha.hide(),$(".subFrmAggTablWrapper").length>0&&($(".aggFldTabl").removeClass("pF"),$("#dvinner").scrollLeft()>0&&$(".subFrmAggTablWrapper").css("max-width",$("#dvinner").width()+$("#dvinner").scrollLeft())),$("#zohoSurveySelect").is(":visible")&&($("#zohoSurveySelect").addClass("dN"),"undefined"!=typeof ZSurvey&&ZSurvey.searchClose&&ZSurvey.searchClose());var Wa=$(".zCampOpiontDD");Wa.length>0&&(Wa.remove(),$("#lp_rellist").find("li").removeClass("whiteBg"));var Qa=$("#columnList.fromModuleLookup"),Ga=$(".lookupErrorMsg").is(":visible");if(Qa.length>0&&!Ga&&void 0!==ge&&""!==ge)$L("crm-entity-lookup")[0].component.cancelLookupPopClose();var Za=$("#preferences");if(Za.find(".popup_cont").is(":visible")){var Ja=Za.find(".popup_cont:visible"),Ya=Ja.find("ul");Ya.css({top:"-400px"}),Ja.slideUp(),"restrict_tpt_select"==Ya.parent().attr("id")&&($(".privacyContentSection").css("margin-bottom",""),Ja.off("webkitTransitionEnd transitionend msTransitionEnd"),Ja.on("webkitTransitionEnd transitionend msTransitionEnd",(function(){$("#preferences").find(".popup_cont:visible");$(".sensitiveSelection").off("select2:opening.gdpr");var e=$(".select2OpenManualStop");e.length>0&&(e.select2("open"),e.removeClass("select2OpenManualStop"))})))}var Ka=$(".customUserDiv");Ka.is(":visible")&&Ka.hide(),(Ka=$(".customChannelDiv")).is(":visible")&&Ka.hide();var Xa=$("#zSurveyUsersTooltip");Xa.is(":visible")&&Xa.addClass("dN")}$("#Macro_TaskCreatePopup, .Macro_containerDiv").find(".focusEleField").removeClass("focusEleField"),void 0!==e&&"searchUserLookup"!==$(e.target).attr("name")&&$('[name="searchUserLookup"]').closest(".labelValCreate").removeClass("focusEleField"),$("#cNdropFilesId").closest(".labelValCreate").removeClass("focusEleField");var ei=$L("#exportChanges");if(ei.length&&ei.e.ltProp("show",!1),1==Crm.userDetails.detailView_newUI&&null!=Crm.userDetails.detailView_newUI){$("#comboBox").removeClass("selNotesDrop");$("#moreOptionsDiv"),$(".moreOptions");$(".btnSelected").removeClass("btnSelected")}var ti=$(".wfReportsDiv");0===$("#calendarCont").length&&$(".calBodyBg").removeClass("calBodyBg"),r&&i.addClass("hide"),(ti=$(".ltUsers_drpDown")).length>0&&ti.addClass("dN");var ai=$(".feedboxDelete");ai.length>0&&ai.removeClass("feedboxdeleteActive")}},hideFollowers:function(e,t){$("."+t).hide()},showPickList:function(){$(".pickList-pop").hasClass("active")?$(".pickList-pop").removeClass("active").hide():$(".pickList-pop").addClass("active").show()}};var ConsentLawBasisUpdates=function(){function e(){crmui.showPopup("updateConsenttype"),thirdPartyUtils.bindSelect2(".lawFulSelect");var e="",t=$("#cautionmsg"),a=$(".reasonTextWrap");if(void 0!==customViewObject.privacyDetails&&(e=customViewObject.privacyDetails.status),"Not Applicable"===e){$("#massUpdateselect").find("#removeNotApplicable_0").remove(),$("#selectopt").removeClass("dN");var i=I18n.getMsg("crm.consent.reasontype.select");0===$("#massUpdateselect").find("#selectopt").length&&$("#massUpdateselect").prepend('<option id="selectopt" value="Select">'+i+"</option>"),$(".lawFulSelect").val("Select").trigger("change"),a.addClass("dN"),t.addClass("dN")}else{i=ConsentLawBasisUpdates.consentLawBasis.lawful_picklists.not_applicable[0]["Not Applicable"];0===$("#massUpdateselect").find("#removeNotApplicable_0").length&&$("#massUpdateselect").prepend('<option id="removeNotApplicable_0" value="Not Applicable">'+i+"</option>"),$(".lawFulSelect").val("Not Applicable").trigger("change"),a.addClass("dN"),t.removeClass("dN"),$("#massUpdateselect").find("#selectopt").remove()}thirdPartyUtils.bindSelect2(".lawFulSelect")}function t(e){var t=Lyte.Router.getRouteInstance().routeName,a=$("#lawfulbasissavebtn");a.attr("disabled",!1),a.prev().attr("disabled",!1),"list"==t?crmListView.reloadCurrentListView():e?(Events.isPageLayoutModified=!0,CrmPrivacyDashboard.reloadCurrentListView()):crmListView.selectAllEntity("",$(".selCountIcon dIB"))}return{updateConsentType:function(){if(0===$("#updateConsenttype").length){var t={"X-ZCSRF-TOKEN":csrfParamName+"="+csrfToken};(new crmRequestPool).initiate({action:"/crm/v2/Consents/lawful_basis",headers:t,type:"GET",success:function(t){ConsentLawBasisUpdates.consentLawBasis=t;var a=Handlebars.templates.updateConsentType;$("#show").append(a(t)),e()}})}else e()},updateConsentstatusAllRecords:function(){var e=$("#lawfulbasissavebtn");e.attr("disabled",!0);var a="",i="",r="",l=$("#reqOptionDetailview"),n=l.length>0,s=customViewObject.isPrivacyListView,o="";if(o=n?detailView.currentModule?detailView.currentModule:$L("#module")[0].value:customViewObject.module,"true"===$("#disabledPrivacyStatus").val())i="Not Applicable";else{var d=$(".lawFulSelect option:checked"),c=d.length;if(1==c)i=d.val(),d.html();else for(var m=0;m<c;m++){var u=d[m].value,p=d[m].outerText;"Select"!==u&&(i=u,p)}}if(n)a=detailView.entityId?detailView.entityId:$L("#entityId")[0].value;else{var g=customViewObject.selectedIds.length;for(m=0;m<g;m++)a=customViewObject.selectedIds[m]+","+a;a=a.substring(0,a.length-1)}var v="";if($(".textReason").length>1){var h=$(".textReason")[1];v=$(h).val()}else v=$(".textReason").val();if("Pending"!==i&&""!==v&&(r=v),void 0!==e){var f=e.prev();void 0!==f&&f.attr("disabled",!0)}var y={};y.module=o,y.entityIds=a,y.Consent_Status=i,y.Lawful_Reason=r;var C=[];C.push(y);var b={consent_details:C},T={"X-ZCSRF-TOKEN":csrfParamName+"="+csrfToken},I=new crmRequestPool;commonUtils.showHideLoadingDiv(!0),I.initiate({action:"/crm/v2/Consents/update/data_processing",data:JSON.stringify(b),headers:T,type:"POST",success:function(e){if("success"===e.consent_details.success){if(n&&null!=detailView.currentModule&&"crm.tab.module.entity.canvas"!==Lyte.Router.getRouteInstance().transition.info.route&&crmTab.deleteFromCache(detailView.currentModule),isWFSchedulerUser()&&e.isWFScheduler)return;if(l.length>0)return $(".notRequiredProcess").addClass("dN"),DataPrivacy.refreshDataPrivacyView(),$("#consentLawfuldetails").remove(),commonUtils.showHideLoadingDiv(),void(n&&(detailView.isDataPrivacyModified=!0));crmui.hidePopup("updateConsenttype"),removeFreezeLayer(),crmui.showMsgBand("success",I18n.getMsg("crm.massupdate.updatedsuccesfully"),"4000",""),t(s),commonUtils.showHideLoadingDiv(),"Pending"===i?($(".consentEdit").removeClass("consentTypeEdit"),$(".afterDeactivateConsent").removeClass("notAConsent")):($(".consentEdit").addClass("consentTypeEdit"),$(".afterDeactivateConsent").addClass("notAConsent"))}},error:function(e){403==e.status&&(crmui.hidePopup("updateConsenttype"),removeFreezeLayer(),renderingUtils.showAlertMsg(I18n.getMsg("crm.security.error"),"error"),commonUtils.showHideLoadingDiv())}}),Crm.trackSpotLightAction("GDPR - Data Processing Basis Updated",{Module:o,Type:i,"Basis Type":"Lawfull Basis"})},reasonSelected:function(e){var t=$(e).val(),a=$(".reasonTextWrap"),i=$("#lawfulbasissavebtn");$("#reqOptionDetailview").is(":visible")&&(i=$(".reasonSaveBtn")),"Select"!==t?i.attr("disabled",!1):(i.attr("disabled",!0),a.addClass("dN")),"Pending"!==t&&"Select"!==t&&"Not Applicable"!==t?(a.removeClass("dN").show(),$(".textReason").val("").removeClass("dN"),detailView.scrollDataProcessingPop()):"Pending"===t&&"Select"===t&&"Not Applicable"!==t||a.addClass("dN")},afterchangeToggle:t,showDataProcessingPopup:e}}(),massActionNotification={hideMassOperationProgressDiv:function(){$("#massOperationProgressDiv").css({bottom:"-400px"});var e=$(".massOperationProgressIcon");e.removeClass("activeProgress"),e.parent().css({top:"","border-top":""})},showProgressDiv:function(){var e=$(".massOperationProgressIcon");e.hasClass("activeProgress")?massActionNotification.hideMassOperationProgressDiv():(Crm.menu.globalHideMenu(),hideFeedBackPopup(),$("#massOperationProgressDiv").css({bottom:"26px"}),e.addClass("activeProgress"),e.parent().css({top:"-1px","border-top":"1px solid #fff"}))},showMassOperationProgress:function(e){var t=$("#wmsstatusbar"),a=$("#ProgressIconDiv"),i=t.find("tr"),r=$("#massOperationJobsDiv"),l=r.find(".massJobHover"),n=$("#job_"+e.jobId),s=$("#massOperationProgressDiv"),o=s.find(n);if(i.find(a).length<=0){i.prepend("<td style='border-left: 1px solid #ddd;' id='massProgress'><div class='vam pR h30' style='padding: 5px; display: table-cell; bottom: 0px; top: -1px; border-top: 1px solid #fff;'><div id='ProgressIconDiv' data-zcqa='massActionProgressIcon' class='massOperationProgressIcon cP pR activeProgress'  onclick='massActionNotification.showProgressDiv()' onmouseover='' data-title='Mass Operation'></div></div></td>");var d=$("#touricon");($("#wldpop").length>0||d.length>0)&&$("#massProgress").css({"border-right":"1px solid #ddd"}),d.length>0&&d.parent().find("span").css({"padding-left":"10px"})}var c=$("#progressAreaDiv_"+e.jobId),m=$("#processedCountSpan_"+e.jobId),u=$("#totalCountSpan_"+e.jobId),p=$("#massOperationTitle"),g=e.moduleLabel;if(e.moduleLabel=moduleRecordMapping[e.moduleLabel].plural_label,0===s.find("div").length){Handlebars.registerPartial("massOperationQueuedJobs",Handlebars.templates.massOperationQueuedJobs);var v=Handlebars.templates.massOperationProgress(e);s.html(v);var h="",f="";switch(p=$("#massOperationTitle"),e.actionType){case 1:case 7:case 8:h="crm.mass.actions.update",f="crm.mass.actions.update.action";break;case 2:h="crm.mass.actions.delete",f="crm.mass.actions.delete.action";break;case 3:h="crm.mass.actions.transfer",f="crm.mass.actions.transfer.action";break;case 4:h="crm.blueprint.mass.actions.titlekey",f="crm.blueprint.mass.actions.preparing.actionkey";break;case 6:case 11:h="crm.blueprint.flowchange.wms.titlekey",f="crm.blueprint.flowchange.wms.preparing.actionkey";break;case 9:p=$("#massOperationTitle"),f="crm.reviewprocess.deactivate.action.wms.preparing";break;case 10:p=$("#massOperationTitle"),f="crm.reviewprocess.update.action.wms.preparing"}var y="";if(s.find(l).length>1)h="crm.mass.actions.common.title",y=I18n.getMsg(h);else{var C=I18n.getMsg(h);y=6===e.actionType||11===e.actionType?I18n.getMsg("crm.blueprint.flowchange.wms.progress.title",[C]):4===e.actionType?I18n.getMsg("crm.blueprint.mass.actions.progress.title",[C]):9===e.actionType?I18n.getMsg("crm.reviewprocess.deactivate.wms.preparing"):10===e.actionType?I18n.getMsg("crm.reviewprocess.update.wms.preparing"):I18n.getMsg("crm.mass.actions.progress.title",[C])}if(s.find(p).text(y),1===e.status){var b=I18n.getMsg(f),T=I18n.getMsg("crm.mass.actions.preparing",[b]);$("#prepareMsg_"+e.jobId).text(T)}s.css({bottom:"26px"}).show(),$(".massOperationProgressIcon").addClass("activeProgress").parent().css({top:"-1px","border-top":"1px solid #fff"})}else if(5===e.status||4===e.status){c.addClass("dN");var I="",w="",L="";switch(e.actionType){case 1:4!==e.status?(I=I18n.getMsg("crm.mass.actions.mass.updated.done",[e.processedCount,e.moduleLabel]),Crm.trackSpotLightAction("Mass Scheduler - Mass update completed",{Module:e.module})):(w=I18n.getMsg("crm.mass.actions.mass.update.job"),Crm.trackSpotLightAction("Mass Scheduler - Mass Update Failed",{Module:e.module})),L="crm.mass.actions.update";break;case 2:4!==e.status?(I=I18n.getMsg("crm.mass.actions.mass.deleted.done",[e.processedCount,e.moduleLabel]),Crm.trackSpotLightAction("Mass Scheduler - Delete completed",{Module:e.module})):(w=I18n.getMsg("crm.mass.actions.mass.delete.job"),Crm.trackSpotLightAction("Mass Scheduler - Delete Failed",{Module:e.module})),L="crm.mass.actions.delete";break;case 3:4!==e.status?(I=I18n.getMsg("crm.mass.actions.mass.transfered.done",[e.processedCount,e.moduleLabel,e.ownerName]),Crm.trackSpotLightAction("Mass Scheduler - Change Owner completed",{Module:e.module})):(w=I18n.getMsg("crm.mass.actions.mass.transfer.job"),Crm.trackSpotLightAction("Mass Scheduler - Change Owner Failed",{Module:e.module})),L="crm.mass.actions.transfer";break;case 4:4!==e.status?(I=I18n.getMsg("crm.mass.actions.mass.updated.done",[e.processedCount,e.moduleLabel]),Crm.trackSpotLightAction("Mass Scheduler - Remapping State completed",{Module:e.module})):(w=I18n.getMsg("crm.blueprint.mass.actions.preparing.actionkey"),Crm.trackSpotLightAction("Mass Scheduler - Remapping State Failed",{Module:e.module})),L="crm.blueprint.mass.actions.titlekey";break;case 6:if(4!==e.status){var k="";"exit"===e.flowAction?k="crm.blueprint.flowchange.wms.exit.success":"remap"===e.flowAction&&(k="crm.blueprint.flowchange.wms.update.success"),I=I18n.getMsg(k,[e.processedCount,e.moduleLabel]),Crm.trackSpotLightAction("Mass Scheduler - Blueprint FlowChange Action completed",{Module:e.module,FlowAction:e.flowAction})}else w=I18n.getMsg("crm.blueprint.flowchange.wms.preparing.actionkey"),Crm.trackSpotLightAction("Mass Scheduler - Blueprint FlowChange Action Failed",{Module:e.module});L="crm.blueprint.flowchange.wms.titlekey";break;case 7:case 8:4!==e.status?(I=I18n.getMsg("crm.mass.actions.mass.updated.done",[e.processedCount,e.moduleLabel]),Crm.trackSpotLightAction("Mass Scheduler - Pipeline transfer completed",{Module:e.module})):(w=I18n.getMsg("crm.mass.actions.mass.update.job"),Crm.trackSpotLightAction("Mass Scheduler - Pipeline transfer Failed",{Module:e.module}));break;case 9:4!==e.status&&(w=I18n.getMsg("crm.rp.wms.error.deactivate.action")),L="crm.rp.wms.error.title";break;case 10:4!==e.status&&(w=I18n.getMsg("crm.rp.wms.error.field.update")),L="crm.rp.wms.error.title";break;case 11:if(4!==e.status){k="push_in"===e.massAction?"blueprint.settings.records.include":"blueprint.settings.records.exclude";I=I18n.getMsg(k,[e.added_count||0,e.totalCount])}L="crm.blueprint.flowchange.wms.titlekey"}var P=I18n.getMsg("crm.mass.actions.refresh2",[e.moduleLabel,e.jobId]),D=I18n.getMsg(L);if(s.find(l).length>0){var M,_;if(4===e.status)I=I18n.getMsg("crm.mass.actions.failed",[w,e.moduleLabel]),M=6===e.actionType||11===e.actionType?I18n.getMsg("crm.blueprint.flowchange.wms.failed.title",[D]):4===e.actionType?I18n.getMsg("crm.blueprint.mass.actions.failed.title",[D]):7===e.actionType||8===e.actionType?I18n.getMsg("crm.pipeline.transfer.failure"):I18n.getMsg("crm.mass.actions.failed.title",[D]),p.text(M);else _=6===e.actionType||11===e.actionType?I18n.getMsg("crm.blueprint.flowchange.wms.completed.title",[D]):4===e.actionType?I18n.getMsg("crm.blueprint.mass.actions.completed.title",[D]):7===e.actionType||8===e.actionType?I18n.getMsg("crm.pipeline.transfer.success"):9===e.actionType?I18n.getMsg("crm.reviewprocess.deactivate.wms.completed"):10===e.actionType?I18n.getMsg("crm.reviewprocess.update.wms.completed"):I18n.getMsg("crm.mass.actions.completed.title",[D]),p.text(_)}else{4===e.status&&(I=I18n.getMsg("crm.mass.actions.failed",[w,e.moduleLabel]));var E="crm.mass.actions.common.title",S=I18n.getMsg(E);p.text(S)}$("#prepareMsg_"+e.jobId).text("");var x=$("#completedMsgDiv_"+e.jobId),B=x.find("span"),R=$("#clearLink");if(B.html($ESAPI.encoder().encodeForHTML(I)),4===e.status&&B.css("color","rgb(221, 0, 0)"),x.show(),o.find(m).text(e.processedCount),o.find(u).text(e.totalCount),5===e.status){var A=Lyte.Router.getRouteInstance().transition.info.route;(-1!==A.indexOf("crm.tab.module.custom-view.kanban")||-1!==A.indexOf("crm.tab.module.custom-view.list")&&crmTab.getFromCache(g)&&crmTab.getFromCache(g).cvId==e.cvId)&&$("#refreshMsg_"+e.jobId).html(P)}if(s.css({bottom:"26px"}).show(),$(".massOperationProgressIcon").addClass("activeProgress").parent().css({top:"-1px","border-top":"1px solid #fff"}),"undefined"!=typeof customViewObject&&Object.keys(customViewObject).length>0){var F=crmTab.getFromCache(g);if(F&&e.cvId===F.cvId&&(F.moreActions.splice(F.moreActions.indexOf("hideSelectAllRecords"),1),customViewObject.cvId===e.cvId)){var O=$("#selectAllRecords");O.length>0&&(customViewObject.showSelectAll=!0),"customCheckBoxChecked"===$("#checkAll").attr("class")&&(customViewObject.showSelectAll=!0,O.show())}}n.find(R).css("visibility","visible")}else if(0===s.find(n).length){var N=s.find(r),U=Handlebars.templates.massOperationQueuedJobs(e),z=N.find(n);z.length>0?z.replaceWith(U):N.prepend(U);E="crm.mass.actions.common.title",S=I18n.getMsg(E);p.text(S)}else{if(0!==e.processedCount&&$("#prepareMsg_"+e.jobId).text(""),o.find(c).find(".slidercont .slidercolor").css({width:e.perCentageCompleted+"%"}),o.find(m).text(e.processedCount),o.find(u).text(e.totalCount),s.find(l).length>1){E="crm.mass.actions.common.title",S=I18n.getMsg(E);p.text(S)}s.show()}}},QuickActionSelObj=void 0,Q={source:void 0,actionDetails:{isCompleted:!0},loadResponse:function(e,t,a,i){var r="salesinbox"==Q.source?Q.actionDetails:"undefined"!=typeof EmailTabHomeUtil&&EmailTabHomeUtil.dragAndDropObject?EmailTabHomeUtil.dragAndDropObject:{};if($("#crmEmailOuterContainerDiv").is(":visible")&&!$("#qCreateOuter").is(":visible")&&!r.isCompleted&&("UnMatched"===r.fromMod&&"Potentials"===r.toMod||"Leads"===r.fromMod&&"Potentials"===r.toMod)&&Q.renameQCreateId(),-1!=e.indexOf("SECURITY_ERROR_403::::INSUFFICIENT"))alert(I18n.getMsg("crm.security.error",""));else{var l=$("#entityInfoOuterDiv").offset(),n=$(Q.anchor).offset(),s=renderingUtils.windowHeight;getElemById("qCreate");if($("#qCreate").empty().css("margin","").addClass("newActivitesPopupStyleEle"),document.getElementById("qCreate").innerHTML=e,EvalInnerScript(document.getElementById("qCreate")),$("#qCreate").find(".tabDivCreate").on("click",(function(e){var t=renderingUtils.getTargetElem(e);if(!$(t).hasClass("textField")){var a=$(this).find(".textField").eq(0);a.attr("data-uitype");"SELECT"!=a.prop("tagName")||a.prop("disabled")||a.select2("open"),$(this).find("select").length||a.focus()}})),"RelatedList"===Q.callFrom||"listview"===Q.callFrom){if(renderingUtils.positionArrow(Q.currElem,"qCreate",void 0,"qcpopuparrow",Q.clickPosObj),$("#qcFieldsContent").height()>$(window).height()){var o=$(window).height()-30;o=$("#qCreate").find(".bottomLayer").outerHeight()?o-$("#qCreate").find(".bottomLayer").outerHeight():o,$(".qcFields").css("max-height",o+"px")}if($("#Zia_CreateCall").hasClass("BT")&&($("#qCreate").hide().fadeIn(300),crmBstTime.setBestTimeValueforCall()),($("#Zia_CreateTask").hasClass("BT")||$("#Zia_CreateTaskCall").hasClass("BT")||$("#Zia_CreateTaskMail").hasClass("BT"))&&($("#qCreate").hide().fadeIn(300),crmBstTime.setBestTimeValueforTask()),"Tasks"==(f=$("#qCreate")).find("#quick_module").val()&&f.width(545),t){if(addTempFreezeLayer(),f.css("z-index",30),$("#signalDetailViewClose").length>0&&$("#ntcInnerDivContent").length>0){var d=$(".temp_freezelayer");d.removeClass("zI28"),d.css("z-index","33"),f.css("z-index","34")}var c=Utils.getDateInUserDatePattern(new Date(a));if("Call"==i){$("#Crm_Calls_SUBJECT").val(t),$("#whichCall3").attr("checked","checked"),$("#whichCall3").trigger("click");var m=new Date(a),u=Utils.getDateTimeInUserFormat(m).split(" "),p=u.length;$("#qCreate").addClass("qCreateCallCenter"),$('[data-cid="logCall"]').removeClass("BT");a="am"==u[p-1].toLocaleLowerCase()||"pm"==u[p-1].toLocaleLowerCase()?u[p-2]:u[p-1];$("[id='Call Start TimedateTime']").attr("value",a).effect("highlight",{},1e3),$('[name="property(Call Start Time)"]').val(c).effect("highlight",{},1e3);var g=a.split(":");$('[name="property(Call Start Timehour)"]').val(g[0]),$('[name="property(Call Start Timeminute)"]').val(g[1]);var v=$("[id='Call Start Time_ampmSpan']");if(v.length){var h=I18n.getMsg("AM")==u[p-1].toLocaleUpperCase()?"AM":"PM";v.text(I18n.getMsg(u[p-1].toLocaleUpperCase())),$('[name="property(Call Start Timeampm)"]').val(h)}}else $("#task_subject").val(t),$("#Crm_Tasks_DUEDATE").val(c)}}else if("ListView"===Q.callFrom){var f;setQListPos(),"Tasks"==(f=$("#qCreate")).find("#quick_module").val()&&f.width(545)}else if("recentMailView"===Q.callFrom){$("#qCreate").css({display:"block",position:"absolute",width:"475px",zIndex:"40"});var y=document.getElementById("addFWTask")?document.getElementById("addFWTask"):document.getElementById("addFWTask1"),C=$(y).offset().left-$("#qCreate").outerWidth()-20,b=findPosY(y);$("#qCreate").css({left:C,top:b-38})}else if("zcampaignView"===Q.callFrom){$("#qCreate").css({display:"block",position:"absolute",width:"475px",zIndex:"40"}),$(".qcpopuparrow.qcRight").removeClass("qcRight").addClass("qcLeft");y=document.getElementById("lookupdiv"),C=findPosX(y),b=findPosY(y);$("#qCreate").css({left:C+229,top:b+27})}else if("Social"===Q.callFrom)crmSocial.dispQuickCreate();else if("krp"===Q.callFrom){var T=$("#qCreate");if($(".commonRightPanel").length){var I=T.find("#quick_module").val(),w="0";if($("#crmEmailOuterContainerDiv").is(":visible"))if(r.isCompleted||"UnMatched"!==r.fromMod||"Potentials"!==r.toMod)if(r.isCompleted||"Leads"!==r.fromMod||"Potentials"!==r.toMod)"Tasks"==I?T.width(545):"Calls"==I?T.width(475):$("#qCreate").css({display:"block",position:"absolute",width:"385px",zIndex:"40"});else{var L=$("#qCreateTopSection_Convert");L.show(),$("#qCreateOuter").css({display:"block",position:"absolute",width:"385px",zIndex:"40"}),$("#qCreate").show();var k=L.outerHeight();L.css({top:"-"+k+"px"})}else{if("Contacts"!==I)return $("#qCreateTopSection_Convert").hide(),$("#qCreateOuter").find(".QcArrowup").animate({left:"255px"},300),$("#qCreate").show(),$("#qCreateOuter").find(".roundSection_Head.contact").removeClass("bgColoractive").addClass("bgColordisabled"),$("#qCreateOuter").find(".roundSection_Head.potential").addClass("bgColoractive"),!0;$("#qCreateTopSection_Convert").hide(),$("#qCreateOuter").find(".roundSection_Head.contact").addClass("bgColoractive"),$("#qCreate").show(),$("#qCreateOuter").css({display:"block",position:"absolute",width:"385px",zIndex:"40"})}else $("#qCreate").css({display:"block",position:"absolute",width:"265px",zIndex:"40"}),w=n.left-277;if(n){$("#qCreate").css({display:"block",position:"absolute",width:"385px",zIndex:"40"});var P=n.top-40;$("#qCreate").css({left:w+"px",top:P+"px"})}if("Contacts"==I||"Leads"==I?($$rightPanel.autoPopulateEntityInformation(I),T.hasClass("outlookqCreate")&&T.css({left:l.left+72+"px",top:"65px"})):"Potentials"!==I&&$("#qCreate").hasClass("outlookqCreate")&&($("#krp_activities_create_new").show(),$$rightPanel.setPopupPosition($("#krp_activities_create_new"))),$(EmailTabHomeUtil.Loading).hide(),$(EmailTabHomeUtil.Loading).removeAttr("data-zcqa"),$("#crmEmailOuterContainerDiv").is(":visible")){if(!r.isCompleted&&("UnMatched"===r.fromMod&&"Potentials"===r.toMod||"Leads"===r.fromMod&&"Potentials"===r.toMod)){$("#qCreateOuter").hide();var D="Leads"===r.fromMod&&"Potentials"===r.toMod;setTimeout((function(){mailsetCenterNew("qCreateOuter",D),$("#qCreateOuter").show()}),1)}else mailsetCenterNew("qCreate");var M=$("#qCRScrollContainer").height(),_=$(".qcrScrollinner").height();parseInt(M+20)<_&&$(".qcscrollBtmButton").addClass("QcShadowTopNew"),$("#qCreate").addClass("qcFromEmail")}}else{T.css({display:"block",position:"absolute",width:"475px",zIndex:"40"});w=n.left-(T.outerWidth()+10),P=n.top-40;T.css({left:w+"px",top:P+"px"});var E=T.outerHeight(),S=T.offset();E+S.top+26>s&&(T.css("top",S.top-(E+S.top+26-s)),S=T.offset()),$("#qCreate .qcpopuparrow").css({display:"block",top:n.top-S.top-2}),$(".qcpopuparrow").css("z-index","0")}}else if("crmEmail"===Q.callFrom){EmailTabHomeUtil.CloseSuccDiv=1,$("#qCreate").css({display:"block",position:"absolute",width:"385px",zIndex:"40"});w=n.left-277,P=n.top;$("#qCreate").css({left:w+"px",top:P+"px"}),$("#qCreate").addClass("qcFromEmail");var x=$("#qCreate #noteContentTxtInSalesinbox");x.is(":visible")&&setTimeout((function(){x.focus()}),10)}else if("calendar"===Q.callFrom){if($(".qcFields").css("max-height","360px"),$("#qCreate").css({display:"block",position:"absolute",width:"475px",zIndex:"24"}),renderingUtils.triggerEvent("click",$("#whichCall3")),$("#whichCallDiv").hide(),Q.isFromCalTop){var B=getElemById("addEventBtnFromCal"),R=$(B).offset(),A=$("#qCreate").outerWidth(),F=B.offsetHeight;$("#qCreate").offset();$("#qCreate").css({top:R.top+F+10,left:R.left-A+140}),$(".qcpopuparrow").css({top:"",left:A-140+10}).attr("class","arrwTop")}else renderingUtils.positionArrow(void 0,"qCreate",void 0,"qcpopuparrow",Events.clickPosObj),$("#qCreate").addClass("callsQuickCreatecalender");var O=new Date(Events.callStartTime);O.getMinutes()<30?O.setMinutes(0):O.setMinutes(30);c=Utils.getDateInUserDatePattern(O);var N=Utils.getTimeStringWithAmPm(O);$(getElemById("Call Start TimedateTime")).attr("value",N.hrs+":"+N.mins),getObj("property(Call Start Time)").value=c,getObj("property(Call Start Timehour)").value=N.hrs,getObj("property(Call Start Timeminute)").value=N.mins,getElemById("Call Start Time_ampmSpan")&&($("#Call Start Time_ampmSpan").empty(),getElemById("Call Start Time_ampmSpan").innerHTML=I18n.getMsg(N.meridiem.toUpperCase()),getObj("property(Call Start Timeampm)").value=N.meridiem.toUpperCase());var U=Crm.userDetails.USER_ID;if(calView.isMultiUserView)U=Events.callHostId;else U=$("#loadedCalendarUserIds").val();$("#qownerName_select").val(U),"monthview"===calView.currCalView&&Events.callDuplicateCheckHandler("Call Start Time");var z=$("#wid_calCreate_opts_menu");z.length>0&&z.is(":visible")&&z.hide()}else"salessignals"===Q.callFrom?(crmNTC.positionQcreatePopup(B),renderingUtils.positionArrow(Q.currElem,"qCreate",void 0,"qcpopuparrow",Q.clickPosObj)):"global"===Q.callFrom&&(freezeBackground(),$("#"+Q.formName).hide(),setTimeout((function(){mailsetCenter(Q.formName),$("#"+Q.formName).show()}),10),$(".qcpopuparrow").hide());"NewCall"===Q.operation&&$("#qownerName_select").attr("onchange","Events.callDuplicateCheckHandler('Call Start Time')")}document.forms.createEntityForm&&(document.forms.createEntityForm.name="createEntityForm"+Crm.formCounter,Crm.formCounter++),$("#task_subject").focus(),Q.currElem=void 0},create:function(e,t,a,i,r,l,n,s){if(Crm.userDetails.isStorageLimitReached)Crm.showStorageExceedPopup("new_record","#topBandPopup");else{Crm.userDetails.isPhoneNoNewView&&Crm.loadPhoneFieldComponentJSFiles(),Q.close(),s?Q.entityInfo={name:a,id:t,email:s,module:e}:Q.actionDetails.email?Q.entityInfo={name:Q.actionDetails.name,id:t,email:Q.actionDetails.email,module:e,account:Q.actionDetails.account,phone:Q.actionDetails.phone}:Q.entityInfo=void 0,a=encodeURIComponent(escapeToHTML(a)),0!==$("#qCreate").length&&(freezeBackground(),$("#FreezeLayer").css("opacity",".1")),renderingUtils.ShakeDivInfreeze("qCreate","left",20,100);var o=getObj("pmrlstact_d");o&&(o.style.display="none");var d=Crm.getCrmBasePath()+"/QCreate.do?module="+e+"&entityid="+t+"&entityname="+a+"&returnAnchor="+i+"&primmodule="+r;null!=l&&(d=Crm.getCrmBasePath()+"/QCreate.do?module="+e+"&entityid="+t+"&entityname="+a+"&returnAnchor="+i+"&primmodule="+r+"&listRelationId="+l),"Accounts"!=r||"Quotes"!=e&&"SalesOrders"!=e&&"Invoices"!=e&&"Contacts"!=e?"Quotes"!=r||"SalesOrders"!=e&&"Invoices"!=e?"SalesOrders"==r&&"Invoices"==e?d=Crm.getCrmBasePath()+"/QCreate.do?fillUpModule=SalesOrders&operation=create&module="+e+"&entityid="+t+"&entityname="+a+"&primmodule="+r+"&returnAnchor="+i:"Vendors"==r&&"Contacts"==e?d=Crm.getCrmBasePath()+"/QCreate.do?fillUpModule=Vendors&operation=create&module="+e+"&entityid="+t+"&entityname="+a+"&primmodule="+r+"&returnAnchor="+i:"Social"!=r||"Contacts"!=e&&"Leads"!=e?"Emails"===r?(Q.anchor=i,d=Crm.getCrmBasePath()+"/QCreate.do?fillUpModule=Emails&operation=create&module="+e+"&returnAnchor=krp&primmodule="+r):null!=getObj("cvid").value&&(d=d+"&cvid="+getObj("cvid").value+"&recordNum="+getObj("recordNum").value):d=Crm.getCrmBasePath()+"/QCreate.do?fillUpModule=Social&operation=create&module="+e+"&brid="+t+"&connectionid="+l+"&primmodule="+r+"&network="+i:d=Crm.getCrmBasePath()+"/QCreate.do?fillUpModule=Quotes&operation=create&module="+e+"&entityid="+t+"&entityname="+a+"&primmodule="+r+"&returnAnchor="+i:d=Crm.getCrmBasePath()+"/QCreate.do?fillUpModule=Accounts&operation=create&module="+e+"&entityid="+t+"&entityname="+a+"&primmodule="+r+"&returnAnchor="+i,"Social"==r?Q.callFrom="Social":"Emails"==r?(Q.callFrom="krp",$("#crmEmailOuterContainerDiv").is(":visible")||$("#FreezeLayer").addClass("transparentFreeze"),$("#qCreate").draggable({containment:"#show",cursor:"move"})):Q.callFrom="",Crm.isFromSalesInbox&&(d+="&isFromSalesInbox=true"),d=d+"&relmodule="+r+"&fromCreate=QuickCreate",n&&(d=d+"&layoutId="+n),Q.url=d;var c={};networkUtils.setCsrfParam(c),mR(d,Q.loadResponse,c),$(".outlookqCreate").length&&$$rightPanel.setFocusForOutlookCustomPane()}},createPotentialForContact:function(e,t,a,i,r,l,n){if(Crm.userDetails.isStorageLimitReached)Crm.showStorageExceedPopup("new_record","#topBandPopup");else{Crm.userDetails.isPhoneNoNewView&&Crm.loadPhoneFieldComponentJSFiles(),t=encodeURIComponent(escapeToHTML(t)),Q.close(),0!==$("#qCreate").length&&(freezeBackground(),$("#FreezeLayer").css("opacity",".1")),renderingUtils.ShakeDivInfreeze("qCreate","left",20,100);var s="krp"===r?$$rightPanel.currentModule:getObj("module").value,o=Crm.getCrmBasePath()+"/QCreate.do?module=Potentials&accountid="+a+"&entityid="+e+"&entityname="+t+"&returnAnchor="+r+"&primmodule=Contacts&relmodule="+s;o+="krp"===r?"&accountname="+encodeURIComponent(escapeToHTML(i)):"&accountname="+encodeURIComponent(escapeToHTML(Q.getVal(i))),o+=this.getCvidAndRecordNum(),Crm.isFromSalesInbox&&(o+="&isFromSalesInbox=true"),null!=n&&(o=o+"&layoutId="+n),Q.url=o,Q.callFrom="krp"===r?r:"",Q.anchor="krp"===r?$("#krp_potential_create_new"):"";var d={};if(networkUtils.setCsrfParam(d),mR(o+"&fromCreate=QuickCreate",Q.loadResponse,d),void 0===Crm.userDetails.VALIDATIONRULEAVAILABLE||!0===Crm.userDetails.VALIDATIONRULEAVAILABLE&&Crm.userDetails.VRINVOLVEDMODULES.contains("Potentials")){var c=Crm.getCrmBasePath()+"/QCreate.do?module=Potentials";null!=n&&(c=c+"&layoutId="+n),Crm.downloadValidationRules(c,"Potentials")}$(".outlookqCreate").length&&$$rightPanel.setFocusForOutlookCustomPane()}},getCvidAndRecordNum:function(){var e=$("#cvid").length>0!=null?$("#cvid").val():null,t=$("#recordNum").length>0!=null?$("#recordNum").val():null,a="";return null!=e&&(a+="&cvid="+e),null!=t&&"NaN"!=t&&NaN!=t&&(a+="&recordNum="+t),a},changeLayoutForQuickCreate:function(e,t,a,i,r,l){if(CFRExec.flushQCDataForMod("qc_previousModeTempHolder"),"Accounts"===e)"Potentials"===t?Q.create("Potentials",i,$("#headervalue_ACCOUNTNAME").text().trim(),a,e,r,l):"Contacts"===t?Q.create("Contacts",i,$("#headervalue_ACCOUNTNAME").text().trim(),a,e,r,l):"Notes"===t&&selectAction("Notes",a);else if("Contacts"===e){if("Potentials"===t)if($(".commonRightPanel").length){var n=$("#accountName"),s=$("#entityName"),o=$("#accountId");Q.createPotentialForContactKV(i,s.val(),o&&o.val()?o.val():"",n&&n.val()?n.val():"",a,e,r,l)}else Q.createPotentialForContact(i,null!=getObj("subvalue_CONTACTID")?getObj("subvalue_CONTACTID").innerHTML:$("#entityName").val(),$("#rp_parent").find("#accountId").val()?$("#rp_parent").find("#accountId").val():"",$("#rp_parent").find("#accountName").val()?$("#rp_parent").find("#accountName").val():"",a,r,l)}else"Potentials"===e||"Quotes"===e?"Notes"===t&&selectAction("Notes",a):"Vendors"===e?"Contacts"===t?Q.create("Contacts",i,getObj("subvalue_VENDORNAME").innerHTML,a,e,r,l):"Products"===t&&Q.create("Products",i,getObj("subvalue_VENDORNAME").innerHTML,a,e,r,l):"Products"===e?"Contacts"===t?Q.create("Contacts",i,$("#headervalue_PRODUCTNAME").text().trim(),a,e,r,l):"Potentials"===t&&Q.create("Potentials",i,$("#headervalue_PRODUCTNAME").text().trim(),a,e,r,l):"Cases"===e?"Notes"===t&&selectAction("Notes",a):"Social"!==e&&"Emails"!==e||"Contacts"!==t&&"Leads"!==t||Q.create(t,i,"",a,e,r,l)},selectAction:function(e,t,a,i,r,l,n,s,o){if(Crm.userDetails.isStorageLimitReached)Crm.showStorageExceedPopup("new_record","#topBandPopup");else if(Crm.userDetails.isPhoneNoNewView&&Crm.loadPhoneFieldComponentJSFiles(),Q.currElem=renderingUtils.getTargetElem(o),"NewCall"==e&&isNewCallView)Crm.globalCreate(o,r,s);else{Q.close(!1),0!==$("#qCreate").length&&(freezeBackground(),$("#FreezeLayer").css("opacity",".1")),renderingUtils.ShakeDivInfreeze("qCreate","left",20,100);var d="";r&&"rp"==r&&(r=void 0),Q.clickPosObj=Events.getPositionObjFromEvent(o);var c,m,u=getObj("pmrlstact_d");u&&(u.style.display="none"),c=(m=$("input[name=relmodule]")).length?m.val():getObj("property(module)")?getObj("property(module)").value:getObj("module")?getObj("module").value:null;var p=getObj("id")?getObj("id").value:null;if(null==p&&$("input[name=id]").length>0&&(p=$("input[name=id]").val()),"NewTask"==e){"recentMailView"==r?(p=i,c=a,showLoadingImage="false"):"krp"!==r&&"salessignals"!==r&&"crmEmail"!==r||(p=i,c="Emails"===a?n:a),!p&&$(s).attr("data-relid")&&(i=p=$(s).attr("data-relid"),c=a);var g=Crm.getCrmBasePath()+"/QCreate.do?module=Tasks&id="+p+"&relmodule="+c+"&primmodule="+a+"&entityid="+i;g+="krp"===r||"salessignals"===r||"crmEmail"===r?"&returnAnchor="+r:"&returnAnchor="+t,g+="listview"===r?"&from=listview":"",g+=this.getCvidAndRecordNum(),quickTask.init()}else if("BulkTask"==e){var v=getIdsAndNames();g="";if(l&&"undefined"!=l)r="zcampaignView",d="secmod="+n+"&bulkCreate=bulkTask&actType=Tasks&idlist="+v.idList+"&namelist="+encodeURIComponent(v.nameList),g=Crm.getCrmBasePath()+"/QCreate.do?module=Tasks";else if(void 0!==r&&"forecast"===r)d="secmod=Potentials&bulkCreate=bulkTask&actType=Tasks&from=listview",g=Crm.getCrmBasePath()+"/QCreate.do?module=Tasks&cvid="+moduleRecordMapping.Potentials.cvid;else{r="ListView";var h=getObj("ismapview")?getObj("ismapview").value:null;null!=h&&1==h&&(r="mapmarker"),d="secmod="+crmListView.getObject().module+"&bulkCreate=bulkTask&actType=Tasks&from=listview",g=Crm.getCrmBasePath()+"/QCreate.do?module=Tasks&cvid="+getObj("cvid").value}if("forecast"===r){var f=customViewObject.selectedIds;1==f.length&&(d+="&singleSelectId="+f[0])}else{var y=crmListView.getObject().selectedIds,C=$("#listView_"+crmListView.getObject().selectedIds[0]).text(),b=crmListView.getObject().module;void 0!==y&&1==y.length&&-1!==["Accounts","Contacts","Potentials"].indexOf(b)&&(d+="&singleSelectId="+crmListView.getObject().selectedIds[0],d+="&modname="+encodeURIComponent(C))}quickTask.init()}else{if("NewEvent"==e){var T="stageView"===r?r:"rightPannel";return Events.globalCreate(o,T,s),!0}if("NewCall"==e){var I=t;if($("#relatedPageContent").length){var w=crmRelatedList.personalityArr;pArr="string"==typeof w?w.split("||"):[];for(var L=0;L<pArr.length;L++)if("activityhistorypersonality"===pArr[L].split("_")[0]){I=pArr[L];break}}"krp"!==r&&"calendar"!==r&&"salessignals"!==r||(p=i,c=a),!p&&$(s).attr("data-relid")&&(i=p=$(s).attr("data-relid"),c=a);g=Crm.getCrmBasePath()+"/QCreate.do?module=Calls&id="+p+"&relmodule="+c+"&primmodule="+a+"&entityid="+i;g+="krp"===r||"calendar"===r||"salessignals"===r?"&returnAnchor="+r:"&returnAnchor="+I,g+="listview"===r?"&from=listview":"",g+=this.getCvidAndRecordNum(),$(".outlookqCreate").length&&(g+="&isfromOutlookRightPanel=true")}else if("NewNote"==e){"krp"!==r&&"crmEmail"!==r||(p=i,c=a);g=Crm.getCrmBasePath()+"/QCreate.do?module=Notes&id="+p+"&relmodule="+c+"&primmodule="+a+"&entityid="+i;g+="krp"===r||"crmEmail"===r?"&returnAnchor="+r:"&returnAnchor="+t}}if(Crm.isFromSalesInbox&&(g+="&isFromSalesInbox=true"),Q.url=g,Q.anchor=t,Q.operation=e,Q.callFrom=r,d=d+"&crmcsrfparam="+csrfToken,mR(g+"&fromCreate=QuickCreate",Q.loadResponse,d),null!=e&&"NewTask"==e&&(void 0===Crm.userDetails.VALIDATIONRULEAVAILABLE||!0===Crm.userDetails.VALIDATIONRULEAVAILABLE&&Crm.userDetails.VRINVOLVEDMODULES.contains("Tasks"))){var k=Crm.getCrmBasePath()+"/QCreate.do?module=Tasks";Crm.downloadValidationRules(k,"Tasks")}}},getVal:function(e){var t="";return e&&e.length>=2?t=$(e[0]).text():e&&(t=$(e).text()),t=encodeURIComponent(t)},close:function(e){Crm.VR&&delete Crm.VR,CFRExec.flushQCDataForMod("qc_previousModeTempHolder");var t=$("#bestTimeListFilterId");if(t.length&&($("#sdiv").hide(),t.hide()),QuickActionSelObj=void 0,"undefined"!=typeof crmSocial&&2===crmSocial.frozen?crmSocial.frozen=0:$("#crmEmailOuterContainerDiv").is(":visible")||removeFreezeLayer(),"Tasks"===$("#quick_module").val()&&quickTask.init(),$("#crmEmailOuterContainerDiv").is(":visible")){var a=$("#quick_module").val();if($("#qCreate").is(":visible")&&($("#qCreate").html("").css("height",""),$("#qCreate").removeClass("qcFromEmail"),$("#FreezeLayer").remove()),"Potentials"===a||"Contacts"===a){var i="salesinbox"==Q.source?Q.actionDetails:"undefined"!=typeof EmailTabHomeUtil&&EmailTabHomeUtil.dragAndDropObject?EmailTabHomeUtil.dragAndDropObject:{};Q.renameQCreateId(!0),i.isCompleted=!0}}else $("#qCreate").empty();$("#qCreate").removeClass("callsQuickCreatecalender"),$("#popupnew").hide(),!1!==e&&Q.hideObjId&&(Crm.menu.menusInDisplay[Q.hideObjId]=!0,$("#"+Q.hideObjId).css("z-index",300),Q.hideObjId=void 0),$("#topBandPopup").is(":visible")&&hideAnimatePopup("topBandPopup",!0),$(".qCreateCallCenter").removeClass("qCreateCallCenter"),$(".eventActionsMenu a, .quickCreateLink a").removeClass("quickCreateLinkAct")},mapObj:{NewTask:"task",NewCall:"calls",NewEvent:"event"},renameQCreateId:function(e){if(e){var t=$("#qCreateOuter");t.find(".QcArrowup").animate({left:"148px"},300),t.find(".roundSection_Head.contact").removeClass("bgColordisabled").addClass("bgColoractive"),t.find(".roundSection_Head.potential").removeClass("bgColoractive"),$("#qCreateOld").length&&($("#qCreate").attr("id","qCreateNew"),$("#qCreateOld").attr("id","qCreate"),t.hide())}else $("#qCreate").attr("id","qCreateOld"),$("#qCreateNew").attr("id","qCreate")},createPotentialForContactKV:function(e,t,a,i,r,l,n,s,o){if(Crm.userDetails.isStorageLimitReached)Crm.showStorageExceedPopup("new_record","#topBandPopup");else{Crm.userDetails.isPhoneNoNewView&&Crm.loadPhoneFieldComponentJSFiles();var d="salesinbox"==Q.source?Q.actionDetails:"undefined"!=typeof EmailTabHomeUtil&&EmailTabHomeUtil.dragAndDropObject?EmailTabHomeUtil.dragAndDropObject:{};t=encodeURIComponent(escapeToHTML(t)),(d.isCompleted||"UnMatched"!==d.fromMod||"Potentials"!==d.toMod)&&Q.close(),0!==$("#qCreate").length&&(freezeBackground(),$("#FreezeLayer").css({opacity:".5","background-color":"#000"})),renderingUtils.ShakeDivInfreeze("qCreate","left",20,100);var c="krp"===r?"salesinbox"==Q.source&&d&&d.fromMod?d.fromMod:$$rightPanel.currentModule:getObj("module").value;l=null!=l?l:"Contacts",c="UnMatched"===c?"Contacts":c;var m=Crm.getCrmBasePath()+"/QCreate.do?module=Potentials&accountid="+a+"&entityid="+e+"&entityname="+t+"&returnAnchor="+r+"&primmodule="+l+"&relmodule="+c;if("krp"===r&&"object"==typeof i&&(i=Q.getVal(i)),m+="krp"===r?"&accountname="+encodeURIComponent(escapeToHTML(i)):"&accountname="+encodeURIComponent(escapeToHTML(Q.getVal(i))),"krp"===r&&1===$("#mailcontainertable").length){var u=o?"etLeadNContactMailsUl":$("#mailcontainertable td:not(.notcurrenttd)").find(".mailpageul").attr("id");if("etPontentialMailsUl"===u){var p=EmailTabHomeUtil.MessageIdInView;Q.actionDetails&&Q.actionDetails.messageId&&(p=Q.actionDetails.messageId),m+="&createPotentialFrom=Potentials_"+p}else"etLeadNContactMailsUl"!==u&&"etUnMatchedMailsUl"!==u||(m+="&createPotentialFrom=Contacts");var g=$("#"+EmailTabHomeUtil.detailViewParent).find("#"+EmailTabHomeUtil.currentThreadMailDetailContainer);o=o||$(g).find(".fromAddr").val(),m+="&fromAddress="+encodeURIComponent(o),m+=null!=n?"&keyValueId="+n:""}d.isCompleted||"Leads"!==d.fromMod||"Potentials"!==d.toMod||(m+="&convertToPotentail=true"),Crm.isFromSalesInbox&&(m+="&isFromSalesInbox=true"),m+=this.getCvidAndRecordNum(),s&&(m=m+"&layoutId="+s),Q.url=m,Q.callFrom="krp"===r?r:"",Q.anchor="krp"===r?$("#krp_potential_create_new"):"";var v={};networkUtils.setCsrfParam(v),mR(m+"&fromCreate=QuickCreate",Q.loadResponse,v),$("#qCreate").hasClass("outlookqCreate")&&$$rightPanel.setPopupPosition($("#krp_potential_create_new"))}},clickPosObj:"",currElem:"",url:"",entityInfo:void 0,loadCallBack:"",anchor:"",operation:"",callFrom:"",isFromCalTop:!1};function selectAction(e,t,a,i,r,l){if(Crm.userDetails.isStorageLimitReached&&"NewTask"===e)Crm.showStorageExceedPopup("new_record","#topBandPopup");else{var n=$(renderingUtils.getTargetElem(l));"ACTIVITYPERSONALITY"==n.parent().attr("data-options")?(Q.hideObjId=n.parent().attr("id"),n.parent().css("z-index",1),Crm.menu.menusInDisplay[Q.hideObjId]&&delete Crm.menu.menusInDisplay[Q.hideObjId],renderingUtils.stopEvent(l)):hideMenu();var s="";s=getObj("property(module)")?getObj("property(module)").value:getObj("module").value;var o=getObj("id").value;if(document.viewentityform&&"_blank"==document.viewentityform.target&&(document.viewentityform.target="_self"),"Edit"==e)if("Events"==s)Crm.addToHistory(void 0,void 0,{clickId:"editbtn",module:"Events",id:o,calleeObj:"Crm"});else{var d="";getObj("cvid")&&null!=getObj("cvid").value&&(d="&cvid="+getObj("cvid").value+"&recordNum="+getObj("recordNum").value);var c=Crm.getCrmBasePath()+"/Edit.do?module="+s+"&id="+o+d;ajaxNew(c)}else if("Delete"==e){if("Events"==s)Events.valDeleteEvent(o,!0);else if("Accounts"==s){c=Crm.getCrmBasePath()+"/MassDelete.do?module="+s+"&id="+o;document.deleteForm.action=c,document.deleteForm.submit()}}else if("NewTask"==e)Q.selectAction(e,t,a,i,"RelatedList",void 0,void 0,void 0,l);else if("NewFollowUpTask"==e){var m=document.getElementById("relNEID").value;c=Crm.getCrmBasePath()+"/Create.do?isftask=true&module=Tasks&id="+m+"&relmodule="+a+"&returnAnchor="+t+"&primmodule="+a+"&entityid="+i+"&cvid="+getObj("cvid").value+"&recordNum="+getObj("recordNum").value;ajaxNew(c)}else if("NewCall"==e)Q.selectAction(e,t,a,i,"RelatedList",void 0,void 0,void 0,l);else if("Competitor"==e){c=Crm.getCrmBasePath()+"/potentials/NewCompetitor.do?module=Potentials&title_key=crm.title.create.competitor&returnAnchor="+t+"&id="+(document.viewentityform?document.viewentityform.id.value:$L("#id")[0].value)+"&cvid="+(document.viewentityform?document.viewentityform.cvid.value:$L("#cvid")[0].value)+"&recordNum="+$L("#recordNum")[0].value;r&&(c+="&rid="+r),commonUtils.openCustomLookup(c,void 0,"topBandPopup")}else if("Clone"==e){c=Crm.getCrmBasePath()+"/Clone.do?module="+s+"&id="+o;ajaxNew(c)}else if("Convert"==e){c=Crm.getCrmBasePath()+"/leads/Convert.do?module="+s+"&id="+o+"&convertstatus="+document.viewentityform.convertstatus.value;ajaxNew(c)}else{if("Duplicate Leads"==e||"Duplicate Contacts"==e||"Duplicate Accounts"==e||"Duplicate Vendors"==e)return doAjaxUpdate("show",Crm.getCrmBasePath()+"/EntityDuplicate.do?module="+s+"&id="+o+"&findDupFldName="+getObj("findDupFldName").value),!1;if("Project"==e)return void ZProjects.handleProjectsQCreate("Create",o,s);if("Associate Project"==e)return void ZProjects.handleProjectsQCreate("Associate",o,s);if("MailMerge"==e){c=Crm.getCrmBasePath()+"/MailMerge.do?";var u="action=mergeAction&idlist="+escape(detailView.entityId)+"&module="+s,p=csrfParamName+"="+encodeURIComponent(csrfToken);c+=u,mR(c,(function(e){getObj("lookupdiv").style.zIndex=30,getObj("lookupdiv").style.width="550px",freezeBackground(),$(getObj("lookupdiv")).empty(),getObj("lookupdiv").innerHTML=e,mailsetCenter("lookupdiv"),JSEvalScript(getObj("lookupdiv")),thirdPartyUtils.bindSelect2($(".newSelect").find("select"))}),p)}else if("manageShare"===e||"viewShare"===e){var g=$("#shareDetailPage"),v=document.getElementsByName("recordsharing")[0];if(void 0===g.attr("disabled")&&(void 0===v||void 0===v.disabled||!1===v.disabled)){g.attr("disabled",!0),void 0!==v&&(v.disabled=!0);for(var h=moduleRecordMapping[s].profiles,f=[],y=[],C=[],b="(profile:in:",T=h.length,I=0;I<T;I++)"Administrator"!==h[I].name&&(y.push(h[I].id),f.push(h[I].name));var w={};1===y.length?(b="(profile:equals:"+f[0].toString().replace("(","\\(").replace(")","\\)")+")",w.comparator="equal",w.field="profile.id",w.value=y[0]):(w.value=y,w.comparator="in",w.field="profile.id",b=b+f.join(",").replace("(","\\(").replace(")","\\)")+")"),C.push(w),C.push("and");var L=$(".DetailViewInnerPage");if("Tasks"!==s&&"Calls"!==s&&"Events"!=s||(L=$(".task-detailview")),"viewShare"===e)u="view=summary&sharedTo="+Crm.userDetails.USER_ID+"&approved=both";var k=detailView.entityId,P=networkUtils.returnDependencyFiles(["crm-detailview-share-modal.js","lyte-hovercard.js"],crmConstants.jsStaticPathForLyte);P=(P=P.concat(networkUtils.returnDependencyFiles(["crm-detailview-share-modal.css"],crmConstants.lessStaticPathForLyte))).concat(networkUtils.returnDependencyFiles([networkUtils.getI18nJSUrl("recordlevelsharing")],crmConstants.jsStaticPath)),commonUtils.showHideLoadingDiv(!0),Lyte.resolvePromises({roles:store.findAll("role",null,!1,!0),filesResolved:Lyte.injectResources(P),shareData:store.triggerAction("entity","share",{param:u,type:"GET",module:moduleRecordMapping[s].api_name,entityId:k}),moduleInfo:store.peekRecord("module",moduleRecordMapping[s].id),recordInfo:new Promise((function(e){var t=store.peekRecord(moduleRecordMapping[s].id,k);t?e(t):store.findRecord(moduleRecordMapping[s].id,k).then((function(t){e(t[0])}))}))}).then((function(t){commonUtils.showHideLoadingDiv(!1);var a={comparator:"not_equal",field:"role.name"},i=t.roles.filter((function(e){if(!e.reporting_to)return e}))[0];a.value=i.name,C.push(a);var r={type:"SubordinateRoleUsers",role_id:i.id,include_lite_users:!0},l=[{users:Array.from(new Set([Crm.userDetails.USER_ID,t.recordInfo.Owner.id])),roles:[i.id],groups:[]}];L.append('<div id="shareContactPopup"></div>');var n=Lyte.Component.render("crm-detailview-share-modal",{userCriteria:C,searchCriteria:b,queryParam:r,module:s,entityId:k,shareData:t.shareData,moduleInfo:t.moduleInfo,excludeModel:l,excludeMembers:l,forceFetch:!0},"#shareContactPopup");"viewShare"===e?n.show(!0):n.show(!1)}),(function(e){commonUtils.showHideLoadingDiv(!1);var t=JSON.parse(e.responseText);g.removeAttr("disabled"),void 0!==v&&(v.disabled=!1),"403"==e.status||"400"==e.status?"Scheduler is running"===t.message?(L.append('<div id="shareContactPopup"></div>'),Lyte.Component.render("crm-detailview-share-modal",{onProcess:!0,moduleInfo:{singular_label:moduleRecordMapping[s].singular_label}},"#shareContactPopup"),$L("#crm-detailview-share-modal")[0].ltProp("show",!0)):renderingUtils.displayPermissionDenied():crmui.showMsgBand("error",I18n.getMsg("crm.mb.alert.complete.operation.later"),36e4)}))}}else document.viewentityform.action=Crm.getCrmBasePath()+"/Create.do?module="+e+"&returnAnchor="+t,document.viewentityform.submit()}}}function setQListPos(){if($("#listviewButtonLayerDiv").length||$("#listviewButtonLayer").length){var e=$(document).scrollTop(),t=getElemById("qCreate"),a=getElemById("moreAct");top=$("#tabLayer").offset().top+$("#tabLayer").outerHeight(),$([t]).css({display:"block",position:"absolute",width:"475px"}),t.style.zIndex="100";var i="qcRight",r="qcLeft";Crm.userDetails.RTL_ENABLED&&(i="qcLeft",r="qcRight"),$(".qcpopuparrow").removeClass(i).addClass(r),t.style.height="auto";var l=findPosX(a),n=findPosY(a);l+=$(a).outerWidth(),$(".qcLeft").css({top:"12px",left:"-10px"}),t.style.left=l+"px",top<=e?t.style.top=n+e+"px":t.style.top=n+"px"}}function qap(e){var t=getElemById("qCreate");$([t]).css({display:"block",position:"absolute",width:"475px"}),t.style.zIndex="100",t.style.height="auto";var a=findPosX(getElemById("rightPanel")),i=findPosY(e);QuickActionSelObj=e,Crm.userDetails.RTL_ENABLED?t.style.left=a+getElemById("rightPanel").offsetWidth+"px":(a-=t.offsetWidth,t.style.left=a+20+"px");var r=getObj("detailrelatedMainlinks");if(r&&"fixed"==r.style.position){var l=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop;t.style.top=l+i-37+"px"}else t.style.top=i-37+"px"}function isFieldInMoreSection(e){return 0!=$("#moreFieldSlider").find("*[name='"+e+"']").length}function quickCreateFieldsValidate(e){singularModule=getObj("singularModule")?getObj("singularModule").value:"";for(var t=0;t<fieldname.length;t++)if(isFieldInMoreSection(fieldname[t])){if("M"==(e=fielddatatype[t].split("~"))[1]&&!emptyCheck(fieldname[t],fieldlabel[t]))return!1;switch(e[0]){case"O":case"V":case"C":break;case"E":if(null!=getObj(fieldname[t])&&0!=getObj(fieldname[t]).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length&&!emailValidate(fieldname[t],fieldlabel[t]))return!1;break;case"DT":if(null!=getObj(fieldname[t])&&0!=getObj(fieldname[t]).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length){if(void 0===e[3])var a="OTH";else a=e[3];if(!dateTimeValidate(fieldname[t],e[2],fieldlabel[t],a))return!1;if(e[4]&&!dateTimeComparison(fieldname[t],e[2],fieldlabel[t],e[5],e[6],e[7],e[4]))return!1}break;case"D":if(null!=getObj(fieldname[t])&&0!=getObj(fieldname[t]).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length){if(void 0===e[2])a="OTH";else a=e[2];if(!dateValidate(fieldname[t],fieldlabel[t],a))return!1;if(e[3]&&!dateComparison(fieldname[t],fieldlabel[t],e[4],e[5],e[3]))return!1}break;case"T":if(null!=getObj(fieldname[t])&&0!=getObj(fieldname[t]).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length){if(void 0===e[2])var i="OTH";else i=e[2];if(!timeValidate(fieldname[t],fieldlabel[t],i))return!1;if(e[3]&&!timeComparison(fieldname[t],fieldlabel[t],e[4],e[5],e[3]))return!1}break;case"I":case"B":if(null!=getObj(fieldname[t])&&0!=getObj(fieldname[t]).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length){if(!intValidate(fieldname[t],fieldlabel[t]))return!1;if(e[2]&&!numConstComp(fieldname[t],fieldlabel[t],e[2],e[3]))return!1}break;case"DE":if(null!=getObj(fieldname[t])&&0!=getObj(fieldname[t]).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length){if(void 0===e[2])var r="any";else r=e[2];if(!decimalValidate(fieldname[t],fieldlabel[t],r))return!1;if(e[3]&&!numConstComp(fieldname[t],fieldlabel[t],e[2],e[3]))return!1}break;case"N":if(null!=getObj(fieldname[t])&&0!=getObj(fieldname[t]).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length){if(void 0===e[2])r="any";else r=e[2];if(!numValidate(fieldname[t],fieldlabel[t],r))return!1;if(e[3]&&!numConstComp(fieldname[t],fieldlabel[t],e[3],e[4]))return!1}break;case"P":if(null!=getObj(fieldname[t])&&0!=getObj(fieldname[t]).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length&&!phoneValidate(fieldname[t],fieldlabel[t]))return!1;break;case"W":if(null!=getObj(fieldname[t])&&0!=getObj(fieldname[t]).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length&&!isValidWebURL(fieldlabel[t],getObj(fieldname[t]).value))return!1}}return!0}function clearMoreFieldValues(e){var t;if("object"==typeof Crm.moreFldNameVsValue[e])for(t in Crm.moreFldNameVsValue[e]){var a=Crm.moreFldNameVsValue[e][t],i=$("[name='"+t+"']");"checkbox"==i.attr("type")?i.prop("checked",a):i.val(a)}}function chkModSel(e){if(e)var t=$(e).closest("form")[0].name;else t=$("[name^=createEntityForm]")[0].name;var a,i=getElm(t,"leContModSel");"Calls"===$('input[name="property(module)"]').val()&&(i=$("input[id^='leContModSel']")),$("#leadCntModLukup").css({visibility:"visible"}),"select-one"==i.type?$('#leContModSel option[value="'+$(e).val()+'"]').attr("id")&&"toberemoved"==$('#leContModSel option[value="'+$(e).val()+'"]').attr("id")&&($("#leContModName").val($('#leContModSel option[value="'+$(e).val()+'"]').attr("dispname")),$("#leContModId").val($('#leContModSel option[value="'+$(e).val()+'"]').attr("idVal")),$("#leadCntModLukup").css({visibility:"hidden"})):"radio"==i[0].type&&i[1].checked&&"toberemoved"==$(i[1]).attr("toberemoved")&&($("#leContModName").val($(i[1]).attr("dispname")),$("#leContModId").val($(i[1]).attr("idVal")),$("#leadCntModLukup").css({visibility:"hidden"})),"select-one"==i.type?a=i.options[i.options.selectedIndex].value:"radio"==i[0].type&&(a=(i=document[t].elements["property(leContModSel)"])[0].checked?i[0].value:i[1].value);var r=document[t].elements["property(modsel)"];r&&("Contacts"==a?(r.disabled=!1,document[t].elements["property(modname)"].disabled=!1,getElm(t,"modNameImg").style.visibility="visible",$("#leadCntModLukup").css({visibility:"visible"}),""==document[t].elements.modid.value&&$('#modsel option[value="Accounts"]').prop("selected",!0),thirdPartyUtils.bindSelect2("select#modsel"),$("select#modsel").trigger("change.select2")):(r.disabled=!0,document[t].elements["property(modname)"].disabled=!0,getElm(t,"modNameImg").style.visibility="hidden",""==document[t].elements.modid.value&&$('#modsel option[value="Accounts"]').prop("selected",!0),$("select#modsel").trigger("change.select2")))}function handleKRPResponses(e,t){var a="salesinbox"==Q.source?Q.actionDetails:"undefined"!=typeof EmailTabHomeUtil&&EmailTabHomeUtil.dragAndDropObject?EmailTabHomeUtil.dragAndDropObject:{};var i=a.dropedElement?a.dropedElement.find("[name='entityId']"):$([]),r=i.parent();if(!a.isCompleted&&"UnMatched"===a.fromMod&&"Potentials"===a.toMod&&"Potentials"!==e.module)return(l=document.createElement("input")).setAttribute("type","hidden"),$(l).attr({name:"relEntityId",value:e.entityId}),r.append($(l)),Q.createPotentialForContactKV(e.entityId,e.entityName,e.accountId,e.accountName,"krp",void 0,e.keyValueId,void 0,a.fromAddr),!0;if($("#qCreate").html("").hide(),$("#qCreateTopSection_Convert").hide(),$("#qCreateTopSection").parent().hide(),!a.isCompleted&&a.dropedElement&&(a.dropedElement.find("[name='module']").val(e.module),e.entityId&&i.val(e.entityId),"Potentials"===e.module)){var l,n="Leads"===(a&&a.fromMod)?e.potentialId:e.potentials[0].potentialId;if(i.val(n),("Contacts"===a.fromMod||"Leads"===a.fromMod)&&"Potentials"===a.toMod)(l=document.createElement("input")).setAttribute("type","hidden"),$(l).attr({name:"relEntityId",value:e.contactId}),r.append($(l))}var s=$("#mailcontainertable td:not(.notcurrenttd)").find(".mailpageul").attr("id");"Emails"===e.primmodule?(EmailTabHomeUtil.postEntityCreate(e,t),a.isCompleted||("UnMatched"!==a.fromMod||"Leads"!==a.toMod&&"Contacts"!==a.toMod||(a.isCompleted=!0),EmailTabHomeUtil.reloadOnEntityCreationFromUnMatched()),"Potentials"===e.module&&(Q.renameQCreateId(!0),$("#qCreateOuter").find(".QcArrowup").css({left:"148px"}),"etLeadNContactMailsUl"!==(s=a.isCompleted?s:"etLeadNContactMailsUl")&&"etUnMatchedMailsUl"!==s||(EmailTabHomeUtil.shouldReloadView=!0,$("#emaildetailresult:visible").length>0&&EmailTabHomeUtil.reloadOnEntityCreationFromUnMatched()),"etUnMatchedMailsUl"!==s&&$$rightPanel.refreshOnCreatingNewEntity("Potentials",e))):"Potentials"===e.module?(Q.renameQCreateId(!0),$("#qCreateOuter").find(".QcArrowup").css({left:"148px"}),"etLeadNContactMailsUl"!==(s=a.isCompleted?s:"etLeadNContactMailsUl")&&"etUnMatchedMailsUl"!==s||(EmailTabHomeUtil.shouldReloadView=!0,$("#emaildetailresult:visible").length>0&&EmailTabHomeUtil.reloadOnEntityCreationFromUnMatched()),"etUnMatchedMailsUl"!==s&&$$rightPanel.refreshOnCreatingNewEntity("Potentials",e)):"Tasks"!==e.module&&"Calls"!==e.module||$$rightPanel.refreshOnCreatingNewEntity("Activities",e)}function handleCrmEmailResponses(e){$("#qCreate").html("").hide(),"Tasks"===(e=$.parseJSON(e)).module&&EmailActionHandling.postSentMailFollowUp(e.module,e)}var template={storeCurEl:"",associateEl:"",isSearch:!1,keepFocus:!1,callback:"",templateIdentifier:"",isTemplateComponent:!1,inventory:!1,editorType:"",lastSearchStr:"",featureName:"",popToClose:"",popzindex:"",leftListText:"",noimagesrc:"",unLimitedTemplate:!1,isTemplatePreview:!1,templatePresent:!0,templatesperpage:100,previousliObj:"",mailmergeAvail:!1,inventoryavail:!1,count:0,attachLimit:0,viewEmailTemplateId:"",crmurl:"",tempOnboard:!1,clearTourTime:0,isTemplateEditorEnabled:!1,lastclickedEditorObj:void 0,currLocation:"",tempEditorOnboard:!1,invEditorOnboard:!1,mergeTagInProductTable:!1,mergeTagInSubformTable:!1,curSubformTableModule:void 0,formsIntegEnabled:!1,isSurveyEnabled:!1,isCrmCampaignMail:!1,relatedModule:"",orchestrationMergeFields:"",selectedFields:[],moduleFieldsListDom:"",removeInlineImgOnload:!0,setlistViewPage:function(){var e=renderingUtils.windowHeight,t=$("#nTTemplateListDIV"),a=t.offset().top,i=$(".tempRight"),r=$(".leftCtnTemp"),l=i.offset().top,n=$(".folderStructure"),s=$("#foldSholder"),o=$(".bottomSettingsbar"),d=n.offset().top,c=o.outerHeight(),m=$(".tempOnBoard_three").offset(),u=m.left-25,p=m.top-15,g=$(".templateMsgOnboard"),v=g.innerHeight();i.length>0&&r.length>0&&r.is(":visible")&&r.height(e-Math.round(l+32+14));var h=$("#templatePreviewSection");n.length>0&&s.length>0&&n.is(":visible")&&n.length>0&&o.length>0&&(s.height(e-Math.round(d+c+26+25)),thirdPartyUtils.unbindPerfectScroll("#foldSholder"),thirdPartyUtils.bindPerfectScroll("#foldSholder"),s.addClass("oH"));var f=$(".folderListCtn");i.length>0&&f.length>0&&f.is(":visible")&&f.height(e-Math.round(l+32+14)),$(".tempLW").length>0&&template.refreshListScroll(),g.is(":visible")&&($(".pulse_dot3").css({left:u,top:p}),1==$(".tempScreenView3").length&&g.css({left:u+11,top:p-(v-11)})),$("#tempCtnArea").length>0&&h.length>0&&t.length>0&&h.css({height:e-(Math.round(a)+44),top:a})},listViewScroll:function(){$("#tempctnList").scrollTop()>0?$(".tempTableHead").addClass("nTHeadShadow"):$(".tempTableHead").removeClass("nTHeadShadow"),template.checkDocumentBottom()&&template.templatePresent&&(template.templatePresent=!1,template.loadNextTemplates())},listViewPreviewFrameHt:function(){var e=$("#previewIframe"),t=$("#mtpwheader").outerHeight()+$("#nTpFoot").outerHeight();t?e.css({height:renderingUtils.windowHeight-Math.round(e.offset().top+t)}):e.css({height:renderingUtils.windowHeight-Math.round(e.offset().top+160)})},listViewScroll:function(){$("#tempctnList").scrollTop()>0?$(".tempTableHead").addClass("nTHeadShadow"):$(".tempTableHead").removeClass("nTHeadShadow"),template.checkDocumentBottom()&&template.templatePresent&&(template.templatePresent=!1,template.loadNextTemplates())},checkDocumentBottom:function(){var e=$("#tempctnList");return e.scrollTop()+e.innerHeight()+80>=e[0].scrollHeight},tempCtnAreaScroll:function(){$(".templateCtnArea").length>0&&($("#templatePreviewSection .tempCtnArea").offset().top>$(".templateInner").offset().top?$("#templatePreviewSection .pwheader").addClass("nTHeadShadow"):$("#templatePreviewSection .pwheader").removeClass("nTHeadShadow"))},nTSearchTempFocus:function(e){if(!template.isTemplateComponent){var t=$(e);""!==t.val()||t.hasClass("w240Imp")?t.removeClass("w240Imp"):t.addClass("w240Imp")}},nTSearchTempBlur:function(e){if(!template.isTemplateComponent){var t=$(e);""!==t.val()||t.hasClass("selectNearSearch")?t.addClass("w240Imp"):t.removeClass("w240Imp")}},showComp_PreviewTemplate:function(e){$(".templistSection").addClass("previewAdded");var t=Crm.getCrmBasePath()+"/Template.do?step=previewTemplate",a=csrfParamName+"="+encodeURIComponent(csrfToken),i=$(e).closest("tr").attr("templateId");a+="&templateId="+encodeURIComponent(i),a+="&from=templateComponent",a+="&inventory="+template.inventory,template.templatePostCall("comp_previewTemplate",t,a)},tableCtnOver:function(e){if(!$(e).hasClass("cCheckSel")){$(e).find(".tdbottom").css("display","none");var t=$(e).prev();t.find(".tdbottom").css("display","none"),$(e).find(".rightLabel,.tempPreview,.tempPreviewNew").removeClass("vh"),$(e).addClass("selectedRow"),t.addClass("beforeSelected")}},tableCtnOut:function(e){!0!==$(e).find('input[type="checkbox"]').is(":checked")&&$(e).find(".rightLabel").addClass("vh"),$(e).find(".tdbottom").css("display","");var t=$(e).prev();t.find(".tdbottom").css("display",""),$(e).find(".tempPreview,.tempPreviewNew").addClass("vh"),$(e).removeClass("selectedRow"),t.removeClass("beforeSelected")},editPreviewNew:function(e){var t=$(e).closest("tr").attr("templateid");void 0===t&&(t=$(e).parent().attr("templateId"));if(template.isTemplateComponent||Crm.trackSpotLightAction("Template - Edit Template"),template.isTemplateComponent||template.isTemplatePreview){var a=Crm.getCrmBasePath()+"/ShowSetup.do?tab=custom&subTab=email&step=editEmailTemplate&emailTemplateId="+t;template.inventory&&(a=Crm.getCrmBasePath()+"/ShowSetup.do?tab=custom&subTab=inventory&step=editInventoryTemplate&emailTemplateId="+t),template.isTemplatePreview?template.compClosePreviewPop():template.hideAnimatePopup("templatePreviewDIV"),openNewTab(a,"template")}else{template.removePreviewHistory(),template.inventory?Lyte.Router.transitionTo({route:"crm.settings.section.crm-templates",queryParams:{type:"inventory",step:"edit",templateId:t}}):Lyte.Router.transitionTo({route:"crm.settings.section.crm-templates",queryParams:{type:"email",step:"edit",templateId:t}});var i="crm.templates.email.templates";template.inventory&&(i="crm.label.inventory.template"),document.title=I18n.getMsg("crm.title.general",[I18n.getMsg(i,Crm.partnerName),Crm.partnerName])}thirdPartyUtils.bindSelect2("#selectFolders"),$(".tempAnimated").removeClass("tempAnimated"),$(".w0Imp").removeClass("w0Imp")},searchInAllFolders:function(e){var t=$("#nTSearchTemp");if(e&&(t.val(""),$("#nTcloseIcon").css("display","none"),template.lastSearchStr=""),e||!e&&""!==t.val().trim()){if(template.isTemplateComponent){var a=$("#nTfolderOptions");a.val(a.find("option").eq(0).val()),thirdPartyUtils.bindSelect2("#nTfolderOptions")}else{var i=$("#folderSortable"),r=i.find("li");r.removeClass("selectedFolder"),i.find("li a").addClass("color333"),$(r.eq(0)).addClass("selectedFolder").find("a").removeClass("color333")}if(!template.isTemplateComponent){var l=$("#folderSortable .selectedFolder").attr("folderId"),n=$("#templatemodules").val();"All Modules"===n&&(n=void 0),"All Templates"===l&&(l=void 0),template.inventory;var s="crm.templates.email.templates";template.inventory&&(s="crm.label.inventory.template"),document.title=I18n.getMsg("crm.title.general",[I18n.getMsg(s,Crm.partnerName),Crm.partnerName])}template.searchTemplate(t[0],template.lastSearchStr,!0)}},showTemplate:function(e,t){""!==$(t).val()?$("#nTcloseIcon").css("display",""):$("#nTcloseIcon").css("display","none");var a=t.value;setTimeout((function(){template.searchTemplate(t,a)}),500)},searchTemplate:function(e,t,a){if(t===e.value&&(a||t!==template.lastSearchStr)&&(a||""!==template.lastSearchStr.trim()||""!==t.trim())){if(template.lastSearchStr=e.value,t===template.lastSearchStr){var i=void 0;i=template.isTemplateComponent?$("#nTfolderOptions").val():$("#folderSortable .selectedFolder").attr("folderId");var r="true"===$("#consentTemplatesOnly").val(),l=$("#templatemodules").val(),n=Crm.getCrmBasePath()+"/Template.do?step=searchEmailTemplates",s=csrfParamName+"="+encodeURIComponent(csrfToken);"undefined"!=typeof automationActions&&null!==automationActions.isBulkEmail&&automationActions.isBulkEmail&&(s+="&skiptemplatesnames="+encodeURIComponent("consent_linked,unsubscribe_linked,zurvey_linked")),i&&(s+="&selectedfolder="+encodeURIComponent(i)),s+="&selectedmodule="+encodeURIComponent(l),""!==e.value.trim()&&(s+="&searchText="+encodeURIComponent(e.value)),s+="&inventory="+template.inventory,r&&(s+="&consentTemplatesOnly=true"),s+=template.addFilterTagsParams(),""!==template.relatedModule&&(s+="&relatedModule="+encodeURIComponent(template.relatedModule)),template.isTemplateComponent||""===e.value||"All Templates"!==i&&"Favorite"!==i&&"SharedWithMe"!==i&&"CreatedByMe"!==i&&"Associated"!==i?template.isSearch=!1:template.isSearch=!0;var o={};template.isTemplateComponent&&(s+="&from=templateComponent",a&&""===$("#nTSearchTemp").val().trim()&&(o.isRefresh=!0)),template.templatePostCall("search",n,s,o)}$("#nTsearchResults").html("'"+$ESAPI.encoder().encodeForHTML(t)+"'")}},closeSearchResults:function(){$("#searchMoreDIV").css("display","none"),template.refreshListScroll()},refreshListScroll:function(){var e=$("#tempctnList");e.height(renderingUtils.windowHeight-Math.round(e.offset().top+32+16)),thirdPartyUtils.unbindPerfectScroll("#tempctnList"),thirdPartyUtils.bindPerfectScroll("#tempctnList",{wheelSpeed:1,wheelPropagation:!0,suppressScrollX:!1}),e.addClass("oH"),thirdPartyUtils.bindPerfectScrollUpdate("#tempctnList")},refreshTemplatesList:function(){template.searchInAllFolders(!0)},loadNextTemplates:function(){var e=void 0;e=template.isTemplateComponent?$("#nTfolderOptions").val():$("#folderSortable .selectedFolder").attr("folderId");var t=$("#templatemodules").val(),a="true"===$("#consentTemplatesOnly").val(),i=Crm.getCrmBasePath()+"/Template.do?step=loadNextTemplates",r=csrfParamName+"="+encodeURIComponent(csrfToken);"undefined"!=typeof automationActions&&null!==automationActions.isBulkEmail&&automationActions.isBulkEmail&&(r+="&skiptemplatesnames="+encodeURIComponent("consent_linked,unsubscribe_linked,zurvey_linked")),e&&(r+="&selectedfolder="+encodeURIComponent(e)),r+="&selectedmodule="+encodeURIComponent(t),a&&(r+="&consentTemplatesOnly=true"),r+=template.addFilterTagsParams();var l=$("#nTSearchTemp").val();if(""!==l.trim()&&(r+="&searchText="+encodeURIComponent(l)),r+="&inventory="+template.inventory,template.isTemplateComponent){(o=$("#sortByNameComp")).hasClass("sortTDesc")?r+="&sort=desc_name":o.hasClass("sortTAsc")&&(r+="&sort=asc_name")}else{var n=$("#OrderByModified"),s=$("#OrderByUsage"),o=$("#OrderByName");n.find(".dArwNewUpOn").hasClass("dArwNewUpOff")&&!n.find(".dArwNewDownOn").hasClass("dArwNewDownOff")?r+="&sort=desc_modified":n.find(".dArwNewDownOn").hasClass("dArwNewDownOff")&&!n.find(".dArwNewUpOn").hasClass("dArwNewUpOff")?r+="&sort=asc_modified":s.find(".dArwNewUpOn").hasClass("dArwNewUpOff")&&!s.find(".dArwNewDownOn").hasClass("dArwNewDownOff")?r+="&sort=desc_usage":s.find(".dArwNewDownOn").hasClass("dArwNewDownOff")&&!s.find(".dArwNewUpOn").hasClass("dArwNewUpOff")?r+="&sort=asc_usage":o.find(".dArwNewUpOn").hasClass("dArwNewUpOff")&&!o.find(".dArwNewDownOn").hasClass("dArwNewDownOff")?r+="&sort=desc_name":o.find(".dArwNewDownOn").hasClass("dArwNewDownOff")&&!o.find(".dArwNewUpOn").hasClass("dArwNewUpOff")&&(r+="&sort=asc_name")}template.isTemplateComponent&&(r+="&from=templateComponent");var d=(template.isTemplateComponent?$(".chTempTable"):$(".tempTableCtn")).find("tr");r+="&fromIndex="+(parseInt(d.length)+1),template.templatePostCall("loadNextTemplates",i,r)},setWhiteFreezeLayer:function(){$("#freezeBackGround").css({opacity:"0.2",backgroundColor:"#000"})},titleForEllipsis:function(e){$(e).off("mouseenter").on("mouseenter",(function(){var e=$(this);e.removeAttr("title"),this.offsetWidth<Math.floor(this.scrollWidth)&&this.offsetWidth!==Math.floor(this.scrollWidth)&&e.attr("title",$.trim(e.text()))}))},listTemplatesByFolder:function(){var e=$("#nTfolderOptions").val(),t=$("#templatemodules").val(),a="true"===$("#consentTemplatesOnly").val(),i=Crm.getCrmBasePath()+"/Template.do?step=getTemplatesList",r=csrfParamName+"="+encodeURIComponent(csrfToken);"undefined"!=typeof automationActions&&null!==automationActions.isBulkEmail&&automationActions.isBulkEmail&&(r+="&skiptemplatesnames="+encodeURIComponent("consent_linked,unsubscribe_linked,zurvey_linked")),e&&(r+="&selectedfolder="+encodeURIComponent(e)),r+="&selectedmodule="+encodeURIComponent(t),r+="&from=templateComponent",r+="&inventory="+template.inventory,r+="&consentTemplatesOnly="+a,r+=template.addFilterTagsParams();var l=$("#parentModule").val();validationUtils.isNotEmpty(l)&&(r+="&parentModule="+l),template.templatePostCall("templatelist",i,r),$("#nTSearchTemp").val(""),$("#nTcloseIcon").css("display","none"),template.lastSearchStr="",template.isSearch=!1},makeFavorite:function(e){var t;t=!$(e).hasClass("selectedFav");var a=void 0;a=template.isTemplateComponent?$("#nTfolderOptions").val():$("#folderSortable .selectedFolder").attr("folderId");var i={};i.selectedfolder=a,i.isfavorite=t,i.currElem=$(e);var r=$(e).closest("tr");i.selectedRow=r;var l=Crm.getCrmBasePath()+"/Template.do?step=makeFavorite",n=csrfParamName+"="+encodeURIComponent(csrfToken);n+="&inventory="+template.inventory,n+="&isFavorite="+encodeURIComponent(t),n+="&emailTemplateId="+encodeURIComponent(r.attr("templateid")),template.templatePostCall("favorite",l,n,i)},makeFavoriteFont:function(e,t){var a=$(e),i=!0;i=!a.hasClass("selectedFav");var r={};r.isfavorite=i,r.currElem=a,r.selectedFont=t;var l=Crm.getCrmBasePath()+"/Template.do?step=makeFavoriteFont",n=csrfParamName+"="+encodeURIComponent(csrfToken);n+="&inventory="+template.inventory,n+="&isFavoriteFont="+encodeURIComponent(i),n+="&selectedFont="+encodeURIComponent(r.selectedFont),template.templatePostCall("favoriteFont",l,n,r)},selList:function(e){$("#zpfontnameDD .nTselToolbarList").removeClass("sel"),$(e).closest("li").addClass("sel")},unSelList:function(e){$(e).closest("li").removeClass("sel")},closePreview:function(e,t){if($("#tabSection").css("opacity","1"),template.relatedModule="",template.isTemplateComponent||"comp_preview"===t||"preview"===t)"preview"!==t?(template.hideAnimatePopup("templatePreviewDIV"),$(".templistSection").removeClass("previewAdded")):(template.isTemplateComponent||template.isTemplatePreview||template.restoreEditorselection(),template.compCloseComponentPop());else{var a=$(".tempTableCtn");if($("#tempctnList").add(a.find("tr td").eq(0)).css("width",""),a.removeClass("tdhide"),$(".tempAnimated").removeClass("tempAnimated"),$("#nTattachArea").removeClass("tempAnimated"),$(".leftCtnPreview").hide(),"closeEdit"!==t&&$(".templistSection").hasClass("previewAdded")){if($(".tempTable").find("tbody").find("tr").removeClass("selectedRow beforeSelected cSelect cbefSelect cCheckSel"),"tempCheckHeader"!==e.attr("id")){var i=e.closest("tr");i.addClass("cSelect"),i.prev().addClass("beforeSelected cbefSelect")}}else"closeEdit"===t&&a.find("tbody").find("tr").removeClass("selectedRow beforeSelected cSelect cbefSelect cCheckSel");template.removePreviewHistory(),setTimeout((function(){template.setlistViewPage()}),400),$(".templistSection").removeClass("previewAdded");var r=$(".tempLeft, .setupleftmenutd, #setup_new_leftmenuDiv");r.add(".leftCtnTemp").css("display","").removeClass("w0Imp"),$(".bottomSettingsbar").clearQueue().stop(!0).fadeIn(700),r.add(".moduleSection,.moveDeleteSection,#tabSection").css("display",""),$("#nTTemplateListDIV #templatePreviewSection #templatePreviewSectionContent").html("")}var l=$("#result #searchMoreDIV");l.length>0&&""!==$("#result #nTSearchTemp").val()&&l.css("display",""),$(".mm-main-container").is(":visible")&&($("#followUppopup").is(":visible")||$("#freezeBackGround").hide()),0===$("#nTTemplateListDIV").length&&1===$("#emailEntityComposepopup").length&&(Crm.userDetails.isNewEditor&&EmailLaunchUtil.isComposeActive()?EmailUtil.hideEditorFreezeLayer():removeFreezeLayer())},mtAtachOpen:function(){var e=$(".mailtempAttach");template.isTemplatePreview||template.isTemplateComponent?e.css({top:$("#tempCtnArea").position().top}):e.css({top:$("#tempCtnArea").offset().top-5}),$(".previewPageTabOuter").find("ul").slideUp(100),e.slideDown(300)},mtAtachClose:function(){var e=$(".mailtempAttach");e.length>0&&e.slideUp()},compCreateNewTemplate:function(){var e={type:"email",step:"new",module:$("#templatemodules").val(),fromComponent:"true"};""!==template.relatedModule&&(e.relatedModule=template.relatedModule),template.inventory&&(e.type="inventory"),template.isTemplateEditorEnabled&&(e.step="showGallery"),$("#templateRefreshLink").css("display","");var t=Lyte.Router.getURL({route:"crm.settings.section.crm-templates",queryParams:e,dynamicParams:[]});openNewTab(t,"template")},selectTemplate:function(e,t){var a=$(e),i=a.closest("tr"),r=null,l=document.getElementById("emailTemplateId");null!==l&&(l.classList.value=""),e.classList.contains("zurvey_linked")&&null!==l&&l.classList.add("zurvey_linked"),e.classList.contains("unsubscribe_linked")&&null!==l&&l.classList.add("unsubscribe_linked"),e.classList.contains("consent_linked")&&null!==l&&l.classList.add("consent_linked"),r="followup"===t?$("#followUppopup #"+template.templateIdentifier):$("#"+template.templateIdentifier);var n=template.featureName;if("Macro_Dtl"===n&&(n="Macro"),r.length>0){var s;s="preview"!==t?i.attr("templateId"):a.attr("templateId"),r.val(s),r.attr("encid",s);var o=r.siblings(".templateName").find("a");if("preview"!==t?(o.attr("class","choosedtemplateName"),o.html($ESAPI.encoder().encodeForHTML(a.find(".comp_nTtempName").text().trim()))):o.html($ESAPI.encoder().encodeForHTML(a.attr("templateName"))),template.titleForEllipsis(o),o.attr({onclick:"template.showTemplatePreview('"+s+"','"+n+"','"+template.popToClose+"');return false",href:Crm.getCrmBasePath()+"/settings/templates?type=email&templateId="+s}),r.siblings(".clearTemplate").css("display",""),template.compCloseComponentPop(),void 0!==template.callback&&""!==template.callback)new Function(template.callback)();var d=$("#mailServerTypeDiv_comp1"),c=$("#mailServerTypeDiv_comp2");if("WebForm"===template.featureName){c.addClass("hide"),d.removeClass("hide");var m=d.find("#crmMailServerType");d.find("#smtpMailServerType").is(":checked")||m.is(":checked")||m.click()}else if("WebFormAck"===template.featureName){d.addClass("hide"),c.removeClass("hide");var u=c.find("#crmMailServerType");c.find("#smtpMailServerType").is(":checked")||u.is(":checked")||u.click()}else"AutoResponse"===template.featureName&&(d.removeClass("hide"),d.show());if("WorkFlowAlert"!==template.featureName&&"ProcessFlow"!==template.featureName&&"wizard"!==template.featureName&&"ApprovalProcess"!==template.featureName){if($("."+template.templateIdentifier+"_fromTR").css("display",""),"none"===$("."+template.templateIdentifier+"_replyLink").css("display")){$("."+template.templateIdentifier+"_replyTR").css("display","");var p=$("."+template.templateIdentifier+"_replyType");if("4"===p.val()){var g=p.siblings(".otherEmailWarning"),v=[];v[0]=g.attr("replyToDueDays");var h=r.find("option:selected").text().trim();v[1]=Crm.getCrmBasePath()+"/ShowSetup.do?action=orgEmail&tab=general&subTab=orgEmail&email="+h,v[2]=$ESAPI.encoder().encodeForHTML(h),v[3]=Crm.appName;var f=I18n.getMsg("crm.template.other.emails.warning.msg.new",v);"false"===g.attr("orgEmailAvail").trim()&&(f=I18n.getMsg("crm.template.other.emails.warning.msg_free.new",v)),g.find(".otherEmailWarningMsg").html(f),g.css("display","")}}if("ConsentMail"===template.featureName||"MassMail"===template.featureName||"reminderToOwner"===template.featureName){var y=$(".snd_btn");y.removeClass("parOpacity"),"ConsentMail"===template.featureName?y.attr("onclick",'sendQuickMail("true")'):template.isCrmCampaignMail?y.attr("onclick","sendQuickMail(false, true)"):y.attr("onclick","sendQuickMail()")}if("ConsentMail"===template.featureName||"MassMail"===template.featureName||"MassMail_Tool"===template.featureName){var C=i.find(".comptemplateFromAddress"),b=i.find(".comptemplateReplyAddress"),T=C.attr("fromAddress"),I=C.attr("fromEmail"),w=C.attr("fromType"),L=b.attr("replyAddress"),k=b.attr("replyEmail"),P=b.attr("replyType");template.addFromReplyToAddressFromTemplate(T,I,w,L,k,P)}}}},addFromReplyToAddressFromTemplate:function(e,t,a,i,r,l){var n=$("#fromAddress"),s=$("#fromType"),o=$("#replyToAddress"),d=$("#replyType");(n.find(".templateAddress").remove(),o.find(".templateAddress").remove(),""!==e&&"$(Record.Owner.Email)"!==e.trim()&&"$(Current.User.Email)"!==e.trim())&&$("<optgroup class='templateAddress' label='"+I18n.getMsg("crm.template.template.emails")+"'><option value='"+e+"' type='"+a+"'>"+$ESAPI.encoder().encodeForHTML(t)+"</option></optgroup>").appendTo(n);""!==i&&$("<optgroup class='templateAddress' label='"+I18n.getMsg("crm.template.template.emails")+"'><option value='"+i+"' type='"+l+"'>"+$ESAPI.encoder().encodeForHTML(r)+"</option></optgroup>").appendTo(o);null===n.val()&&(n.find("option").eq(0).prop("selected",!0),s.val("0")),null===o.val()&&(o.val(""),d.val("")),n.next(".select2").remove(),thirdPartyUtils.bindSelect2(n,{minimumResultsForSearch:1/0}),o.next(".select2").remove(),thirdPartyUtils.bindSelect2(o,{minimumResultsForSearch:1/0})},selectAddress:function(e,t,a,i,r,l){var n=$("#fromAddress"),s=$("#fromType"),o=$("#replyToAddress"),d=$("#replyType");n.val(e),s.val(t),o.val(a),d.val(i);var c=$("#smtpFromAddress");c.length>0&&c.val(r);var m=$("#smtpReplytoAddress");m.length>0&&m.val(l),null===n.val()&&(n.find("option").eq(0).prop("selected",!0),s.val("0")),null===c.val()&&c.find("option").eq(0).prop("selected",!0),null===o.val()&&(o.val(""),d.val("")),null===m.val()&&m.val(""),n.next(".select2").remove(),thirdPartyUtils.bindSelect2(n,{minimumResultsForSearch:1/0}),c.length>0&&(c.next(".select2").remove(),thirdPartyUtils.bindSelect2(c,{minimumResultsForSearch:1/0}),m.next(".select2").remove(),thirdPartyUtils.bindSelect2(m,{minimumResultsForSearch:1/0})),o.next(".select2").remove(),thirdPartyUtils.bindSelect2(o,{minimumResultsForSearch:1/0}),""===o.val()&&($("#replyToTR").css("display","none"),$("#replyToLink").css("display","")),""===m.val()&&($("#smtpReplytoTR").css("display","none"),$("#smtpReplyToLink").css("display",""))},setFromAddress:function(e){if("CRM"===$(e).val())$(".smtpAddressPopWin").addClass("hide"),$(".defaultTemplateEmailLoader").removeClass("hide");else{var t=$("#smtpFromAddress"),a=$("#smtpReplytoAddress");a.val(a.val()),t.val(t.val()),$("#mailServerTypeDiv_comp1").hasClass("hide")?$("#smtpAddressPopWin_comp2").removeClass("hide").show():$("#smtpAddressPopWin_comp1").removeClass("hide").show(),$(".emailTemplateId_replyLink").show(),$(".defaultTemplateEmailLoader").addClass("hide"),$("[name=webtoleadForm]").html()||$(".smtpAddressPopWin").removeClass("hide");var i=$(e).attr("purpose");if(i){var r=$("#smtpReplytoTR_"+i);r.hasClass("hide")||"none"===r.css("display")?$("#smtpReplyToLink_"+i).removeClass("hide").css("display",""):$("#smtpReplyToLink_"+i).addClass("hide")}t.length>0&&(t.next(".select2").remove(),thirdPartyUtils.bindSelect2(t,{minimumResultsForSearch:1/0}),a.next(".select2").remove(),thirdPartyUtils.bindSelect2(a,{minimumResultsForSearch:1/0})),""===a.val()&&($("#smtpReplytoTR").css("display","none"),$("#smtpReplyToLink").css("display",""))}},showServerDetails:function(){$("#mailServerTypeDiv").removeClass("hide")},compCloseComponentPop:function(){"Macro"!==template.featureName&&"ConsentMail"!==template.featureName&&"MassMail"!==template.featureName&&"reminderToOwner"!==template.featureName&&"AutoResponder_Pop"!==template.featureName&&"WebForm"!==template.featureName&&"ApprovalProcess"!==template.featureName&&"ApprovalProcess_RE1"!==template.featureName&&"ApprovalProcess_RE2"!==template.featureName&&"viewTemplate_fz"!==template.featureName?template.hideAnimatePopup("templateComponentDIV",!0):template.hideAnimatePopup("templateComponentDIV"),template.hideAnimatePopup("templatePreviewDIV"),$(document.body).css("overflow","auto"),""!==template.popToClose&&""!==template.popzindex&&$("#"+template.popToClose).css("z-index",template.popzindex),$("#templateComponentDIV,#templatePreviewDIV").empty()},compClosePreviewPop:function(){"Macro"!==template.featureName&&"ConsentMail"!==template.featureName&&"MassMail"!==template.featureName&&"reminderToOwner"!==template.featureName&&"AutoResponder_Pop"!==template.featureName&&"WebFormNotify"!==template.featureName&&"WebForm"!==template.featureName&&"WebFormAck"!==template.featureName&&"ApprovalProcess"!==template.featureName&&"ApprovalProcess_RE1"!==template.featureName&&"ApprovalProcess_RE2"!==template.featureName&&"viewTemplate_fz"!==template.featureName?template.hideAnimatePopup("templatePreviewDIV",!0):template.hideAnimatePopup("templatePreviewDIV"),$(document.body).css("overflow","auto"),""!==template.popToClose&&""!==template.popzindex&&$("#"+template.popToClose).css("z-index",template.popzindex)},newshowtt:function(e,t,a){var i=renderingUtils.windowHeight,r=$(e),l=$(e).outerHeight(),n=r.height(),s=r.attr("overtext"),o=$(".tooltip-temp"),d=$("#templatePreviewDIV").offset().left,c=r.offset().left,m=r.offset().top,u=r.innerHeight(),p=r.outerHeight(),g=r.outerWidth(),v=$("#emailEditor").offset().top;o.html($ESAPI.encoder().encodeForHTML(s));var h=o.outerHeight(),f=o.outerWidth();if(o.removeClass("ddHelpTTcen_top ddToolEditor sIqWrap w400"),"center"===t&&void 0===a)if($(e).closest("div").has(".prevActBtn")){if(o.text().length<=20)var y=c-d;else y=c-d-o.innerWidth();var C=m+l+6;o.show()}else y=c+11-f/2,C=m+l+6;else if("left"===t&&void 0===a)y=c+11,C=m+l+10;else if("right"===t&&"bottom"===a){y=c-o.innerWidth()/2,C=m+l+17;var b=i-($("#wmschatbar").outerHeight()+17);o.removeClass("bottomTip"),isChatEnabled&&C+28>=b&&(o.addClass("bottomTip"),C=m-37),o.removeClass("TTcen_top TTcen_bot TTcen_left"),o.addClass("TTright_bot")}else if("center"===t&&"top"===a){y=c+11-f/2,C=m-(l+h-2);o.removeClass("TTright_bot TTcen_bot TTcen_left"),o.addClass("TTcen_top")}else if("center"===t&&"bottom"===a){y=c+15-f/2;if(!0===isChatEnabled)if(i-28<=(C=m+(h+u+28))){var C=m-h-16;o.removeClass("TTright_bot TTcen_bot TTcen_left"),o.addClass("TTcen_top")}else C=m+(h+u)+3,r.hasClass("sIq")&&(C=m+40+(h+u),y=c+3-f/2,o.addClass("sIqWrap w400")),o.removeClass("TTright_bot TTcen_top TTcen_left"),o.addClass("TTcen_bot");else if(i<=(C=m+h+u)){C=m-h-16;o.removeClass("TTright_bot TTcen_bot TTcen_left"),o.addClass("TTcen_top")}else{C=m+(h+u)+3;o.removeClass("TTright_bot TTcen_top TTcen_left"),o.addClass("TTcen_bot")}}else if("left"===t&&"bottom"===a){y=c,C=m+(h+u);if("galback"===r.attr("id")){C=m+(n+7);o.addClass("TTleft_top")}else C=m+(h+u);o.removeClass("TTright_bot TTcen_top TTcen_left TTcen_bot TTleft_top")}else if("center"===t&&"bottomMD"===a){y=c-f/2+16,C=m+(h+u-8);o.removeClass("TTright_bot TTcen_top TTcen_left"),o.addClass("TTcen_bot")}else if("center"===t&&"left"===a){y=c-(f+10),C=m+h/2;o.removeClass("TTright_bot TTcen_top TTcen_top"),o.addClass("TTcen_left")}else if("center"===t&&"leftAsso"===a){y=c-(f+10),C=m+h/2-7;o.removeClass("TTright_bot TTcen_top TTcen_top"),o.addClass("TTcen_left")}else if("center"===t&&"top1"===a){y=c+15-f/2,C=m-h-6;o.removeClass("TTright_bot TTcen_bot TTcen_left"),o.addClass("TTcen_top")}if(r.hasClass("nTascWrap")&&$(".associatePopup").is(":visible"))o.hide();else if(r.closest("#templateTakeTourEdit").length>0){o.removeClass("TTright_bot TTcen_bot TTcen_left"),o.addClass("TTcen_top ddToolEditor");var T=m+v-(h/2+p/2+10);y=c+g/2-f/2;r.hasClass("tHelp")?o.addClass("ddHelpTTcen_top"):o.removeClass("ddHelpTTcen_top"),o.css({top:T+"px",left:y+"px"}).clearQueue().stop().delay(500).fadeIn()}else o.css({top:C+"px",left:y+"px"}).clearQueue().stop().delay(500).fadeIn()},newhidett:function(){$(".tooltip-temp").clearQueue().stop().delay(100).hide()},setCustomTab:function(e){$("#nTcustominnerTab").remove();var t="";t+='<table id="nTcustominnerTab" class="w100per" cellspacing="0" cellpadding="0">',t+="<tbody>",t+="<tr>",t+='<td class="pL25 pR20  font22 fontsmoothAuto col333 mT5" id="mailTemp" style="width: 10%;white-space: nowrap;">'+I18n.getMsg("crm.label.templates")+"</td>",t+='<td class="w90per">',t+='<div class="oH" style="height: 60px;">',t+='<div id="tabSection" style="overflow: hidden;padding: 13px 0;">',t+='<div class="fL mT3">',t+='<ul class="m0 p0 nTTabClass oH secondaryTabNewView" id="nTTabClass">',t+="<li class='m0 p0 fL' id='emailTemplates' data-zcqa='custom_email' data-permission='true' >",t+="<link-to lt-prop-route='crm.settings.section.crm-templates' lt-prop-qp='{\"type\" : \"email\" }'>"+I18n.getMsg("Email")+"</link-to></li>",template.inventoryAvail?t+="<li class='m0 p0 fL' id='inventoryTemplates' data-zcqa='custom_inventory' data-permission='true'>":t+="<li style='pointer-events:none;opacity:0.2' class='m0 p0 fL' id='inventoryTemplates' data-zcqa='custom_inventory' data-permission='true'>",t+="<link-to lt-prop-route='crm.settings.section.crm-templates' lt-prop-qp='{\"type\" : \"inventory\" }'>"+I18n.getMsg("Inventory")+"</link-to></li>",template.mailmergeAvail?t+="<li class='m0 p0 fL' id='mailmergeTemplates'  data-zcqa='custom_mailmerge'  data-permission='true'>":t+="<li style='pointer-events:none;opacity:0.2' class='m0 p0 fL' id='mailmergeTemplates'  data-zcqa='custom_mailmerge'  data-permission='true' >",t+="<link-to lt-prop-route='crm.settings.section.crm-templates' lt-prop-qp='{\"type\" : \"mail-merge\" }' lt-prop-custom><a>"+I18n.getMsg("crm.mail.merge")+"</a></link-to></li>",t+="</ul>",t+="</div>",t+="</div>",t+="</div>",t+="</td>",t+="</tr>",t+="</tbody>",t+="</table>";var a=$(t);$("#setupInnerLinks").hide(),$("#result").prepend(a),"email"===e?$("#emailTemplates").addClass("seltab"):"inventory"===e?$("#inventoryTemplates").addClass("seltab"):"mailmerge"===e&&$("#mailmergeTemplates").addClass("seltab")},showEmptyTemplateMsg:function(){var e=void 0,t=void 0;if(template.isTemplateComponent?(e=$(".chTempTable"),t=$("#nTfolderOptions").val()):(e=$(".tempTableCtn"),t=$("#folderSortable .selectedFolder").attr("folderId")),e.find("tr").length<=0){$("#searchMoreDIV").css("display","none");var a="<div  class='f22 color_7 crm-font-regular pT40 aligncenter'>";a+="<div class='emptyTemplatesMsg'>",a+="</div>",a+="<div class='f13 pT8 crm-font-regular searchInAllFolders' style='display:none'><a class='cP' onclick='template.searchInAllFolders()'>"+I18n.getMsg("crm.template.listview.search.empty.msg")+"</a></div>",a+="</div>",$("#tempctnList").html(a),""!==$("#nTSearchTemp").val().trim()?("All Templates"!==t&&$(".searchInAllFolders").css("display",""),$(".emptyTemplatesMsg").html(I18n.getMsg("crm.template.listview.search.no.results"))):template.inventory?$(".emptyTemplatesMsg").html(I18n.getMsg("crm.template.listview.no.inv.templates.msg")):$(".emptyTemplatesMsg").html(I18n.getMsg("crm.template.listview.no.templates.msg"))}},convertAsSysRefName:function(e){var t=template.mergefields;return CrmConvertMergeFields.convertMergeFieldsAsRequiredFormat(e,mergeFieldsConstants.fromlabel_to_api,t,!1,!1)},showEmailAnalyticsDetails:function(e){var t=Crm.getCrmBasePath()+"/Template.do?step=emailTrackingDetails",a=csrfParamName+"="+encodeURIComponent(csrfToken);a+="&templateId="+encodeURIComponent($(e).attr("templateId")),template.templatePostCall("emailTrackingDetails",t,a)},closeSearch:function(e,t){$(e).hide(),template.isTemplateComponent?$("#"+t).val("").keyup():$("#"+t).val("").removeClass("w240Imp").keyup()},showAnimatePopup:function(e,t){setTimeout((function(){$("#"+e).show()}),10),t&&showFreezeLayer(),setTimeout((function(){$("#"+e).addClass("zcrm-show").find(".popup-model-header").addClass("bxShTp"),"templateAlertsPop"===e&&$("#templateAlertsPop").is(":visible")&&$("#freezeBackGround").removeAttr("onclick")}),300)},hideAnimatePopup:function(e,t){t&&(Crm.userDetails.isNewEditor&&EmailLaunchUtil.isComposeActive()?EmailUtil.hideEditorFreezeLayer():hideFreezeLayer());var a=$("#"+e),i=a.height(),r=$("#freezeBackGround");"templateAlertsPop"===e&&(template.restoreEditorselection(!0),r[0].setAttribute("onclick","javascript:sE(event);")),$("#followUppopup").is(":visible")&&r.show(),"nTcancelPop"!==e&&"nTbackToGalleyPop"!==e&&"nTEmailAnalyticsDIV"!==e||template.restoreEditorselection(),$("#nTsaveBtn").removeClass("pEvents"),a.css({top:"-"+2*i+"px"}),setTimeout((function(){$(".zcrm-show").removeClass("freezeEvt"),a.removeClass("zcrm-show").css({top:"0px",display:"none"}).width("")}),200)},ascdsc:function(e){var t=!0;if(template.isTemplateComponent){var a=$("#sortByNameComp");a.removeClass("sortTName"),a.hasClass("sortTAsc")?(a.removeClass("sortTAsc"),a.addClass("sortTDesc"),t=!1):a.hasClass("sortTDesc")?(a.addClass("sortTAsc"),a.removeClass("sortTDesc"),t=!0):(a.addClass("sortTAsc"),t=!0)}else{var i=$(".ascdsc");0===i.index(e)?(i.eq(1).find(".dArwNewUpOn").addClass("dArwNewUpOff"),i.eq(1).find(".dArwNewDownOn").addClass("dArwNewDownOff"),i.eq(2).find(".dArwNewUpOn").addClass("dArwNewUpOff"),i.eq(2).find(".dArwNewDownOn").addClass("dArwNewDownOff")):1===i.index(e)?(i.eq(0).find(".dArwNewUpOn").addClass("dArwNewUpOff"),i.eq(0).find(".dArwNewDownOn").addClass("dArwNewDownOff"),i.eq(2).find(".dArwNewUpOn").addClass("dArwNewUpOff"),i.eq(2).find(".dArwNewDownOn").addClass("dArwNewDownOff")):(i.eq(0).find(".dArwNewUpOn").addClass("dArwNewUpOff"),i.eq(0).find(".dArwNewDownOn").addClass("dArwNewDownOff"),i.eq(1).find(".dArwNewUpOn").addClass("dArwNewUpOff"),i.eq(1).find(".dArwNewDownOn").addClass("dArwNewDownOff"));var r=$(e).find(".dArwNewUpOn");r.hasClass("dArwNewUpOff")?(r.removeClass("dArwNewUpOff"),$(e).find(".dArwNewDownOn").addClass("dArwNewDownOff"),t=!0):($(e).find(".dArwNewDownOn").removeClass("dArwNewDownOff"),r.addClass("dArwNewUpOff"),t=!1)}var l=void 0;l=template.isTemplateComponent?$("#nTfolderOptions").val():$("#folderSortable .selectedFolder").attr("folderId");var n=$("#templatemodules").val(),s="true"===$("#consentTemplatesOnly").val(),o=Crm.getCrmBasePath()+"/Template.do?step=sortTemplatesList",d=csrfParamName+"="+encodeURIComponent(csrfToken);"undefined"!=typeof automationActions&&null!==automationActions.isBulkEmail&&automationActions.isBulkEmail&&(d+="&skiptemplatesnames="+encodeURIComponent("consent_linked,unsubscribe_linked,zurvey_linked")),d+="&inventory="+template.inventory,s&&(d+="&consentTemplatesOnly=true"),d+=template.addFilterTagsParams(),"OrderByModified"===e.id?d+=t?"&sort=asc_modified":"&sort=desc_modified":"OrderByUsage"===e.id?d+=t?"&sort=asc_usage":"&sort=desc_usage":"OrderByName"!==e.id&&"sortByNameComp"!==e.id||(d+=t?"&sort=asc_name":"&sort=desc_name"),template.isTemplateComponent&&(d+="&from=templateComponent"),l&&(d+="&selectedfolder="+encodeURIComponent(l)),d+="&selectedmodule="+encodeURIComponent(n);var c=$("#nTSearchTemp").val();""!==c.trim()&&(d+="&searchText="+encodeURIComponent(c)),template.templatePostCall("ascdsc",o,d)},templatePostCall:function(e,t,a,i){var r=new crmRequestPool;commonUtils.showHideLoadingDiv(!0),r.initiate({action:t,type:"POST",data:a,success:function(t){if(commonUtils.showHideLoadingDiv(!1),"templatelist"===e||"search"===e||"loadNextTemplates"===e||"ascdsc"===e){if("templatelist"===e||"search"===e)if(template.isTemplateComponent)$("#sortByNameComp").removeClass("sortTAsc sortTDesc").addClass("sortTName");else{var a=$("#OrderByModified"),r=$("#OrderByUsage"),l=a.find(".dArwNewUpOn");l.hasClass("dArwNewUpOff")||l.addClass("dArwNewUpOff");var n=a.find(".dArwNewDownOn");n.hasClass("dArwNewDownOff")||n.addClass("dArwNewDownOff");var s=r.find(".dArwNewUpOn");s.hasClass("dArwNewUpOff")||s.addClass("dArwNewUpOff");var o=r.find(".dArwNewDownOn");o.hasClass("dArwNewDownOff")||o.addClass("dArwNewDownOff");var d=$("#OrderByName"),c=d.find(".dArwNewUpOn");c.hasClass("dArwNewUpOff")||c.addClass("dArwNewUpOff");var m=d.find(".dArwNewDownOn");m.hasClass("dArwNewDownOff")||m.addClass("dArwNewDownOff")}if("loadNextTemplates"!==e){var u=!0,p=$(t).find("tr").length;p<1&&(u=!1),p<template.templatesperpage?template.templatePresent=!1:template.templatePresent=!0;var g=$("#tempctnList");g.html(t);var v=void 0;if(template.isTemplateComponent)v=$("#nTfolderOptions").val();else(I=$("#tempCheckHeader")).attr("checked",!1),template.listChecked(I),v=$("#folderSortable .selectedFolder").attr("folderId");var h=$("#searchMoreDIV");h.css("display","none");var f=$("#nTSearchTemp");f.length>0&&""!==f.val().trim()&&u?(h.css("display",""),"All Templates"===v?$(".searchAllLink").css("display","none"):$(".searchAllLink").css("display","")):!u&&f.length>0&&""!==f.val().trim()&&("All Templates"!==v&&$(".searchInAllFolders").css("display",""),$(".emptyTemplatesMsg").html(I18n.getMsg("crm.template.listview.search.no.results")));var y=$("#templateRefreshLink");template.isTemplateComponent&&y.is(":visible")&&void 0!==i&&i.isRefresh&&y.css("display","none"),template.refreshListScroll(),g.scrollTop(0),$("#nTTemplateListDIV").find(".nteditIcon").on("click",(function(){template.editPreviewNew(this)}))}else{var C=document.createElement("div"),b=document.createElement("table"),T=document.createElement("tbody");b.appendChild(T),C.appendChild(b),$(T).html(t),$(C).find("tr").length<template.templatesperpage?template.templatePresent=!1:template.templatePresent=!0;var I=$("#tempCheckHeader");if(!template.isTemplateComponent&&(I.is(":checked")||""!==template.viewEmailTemplateId))for(var w=$(C).find("tr"),L=w.length,k=0;k<L;k++){var P=$(w.eq(k));I.is(":checked")&&"1"===P.attr("category")&&(P.find('input[type="checkbox"]').attr("checked",!0).addClass("selected"),P.find(".rightLabel").removeClass("vh"),P.addClass("cCheckSel")),""!==template.viewEmailTemplateId&&P.attr("templateId")===template.viewEmailTemplateId&&P.remove()}if((template.isTemplateComponent?$(".chTempTable"):$(".tempTableCtn")).find("tbody").append($(b).find("tbody").html()),!template.isTemplateComponent){var D=$('.tempTableCtn input[type="checkbox"]:checked').length;1===D?$("#selectedTemp").html(D+" "+I18n.getMsg("crm.template.listview.selected.msg1")):$("#selectedTemp").html(D+" "+I18n.getMsg("crm.template.listview.selected.msg2"))}$(C).remove(),template.templatePresent||template.showEmptyTemplateMsg()}}else if("favorite"===e){var M=i.isfavorite;v=void 0;v=template.isTemplateComponent?$("#nTfolderOptions").val():$("#folderSortable .selectedFolder").attr("folderId");var _=i.selectedfolder,E=i.currElem;if(_===v&&(E.hasClass("selectedFav")?E.removeClass("selectedFav"):E.addClass("selectedFav"),"Favorite"===_&&!M)){if(!template.isTemplateComponent){var S=i.selectedRow.find('input[type="checkbox"]');S.is(":checked")&&(S.attr("checked",!1),template.listChecked(S))}var x=!1;if(i.selectedRow.nextAll("tr").length<10&&(x=!0),i.selectedRow.remove(),!template.isTemplateComponent&&$('.tempTableCtn input[type="checkbox"]:checked').length<=0)(I=$("#tempCheckHeader")).attr("checked",!1),template.listChecked(I);x&&template.templatePresent?(template.templatePresent=!1,template.loadNextTemplates()):template.templatePresent||template.showEmptyTemplateMsg()}}else if("favoriteFont"===e){var B;E=i.currElem;(B="htmlEditor"==template.editorType?E.parents("#ze_fontfamily").find("li").find("span"):E.parents("#zpfontnameDD").find("li").find("span")).removeClass("selectedFav dIB"),B.addClass("dN");M=i.isfavorite;var R="Arial, Helvetica, sans-serif";if(template.inventory?"htmlEditor"===template.editorType&&(R="times new roman,times,serif"):"htmlEditor"===template.editorType&&(R="Verdana,arial,Helvetica,sans-serif"),M?(E.removeClass("dN"),E.addClass("selectedFav dIB"),R="htmlEditor"===template.editorType?E.parent().attr("fntnme"):E.prev().attr("fntface")):(E.removeClass("selectedFav dIB"),E.addClass("dN")),"dragdropEditor"===template.editorType){var A=$("iframe[name=emailEditor]").contents();if(!template.inventory)A.find("#contentOuter").css({"font-family":R});A.find("#contentInner").css({"font-family":R})}else{(A=$("iframe[name=emailEditor]").contents().find(".ze_area").contents().find(".ze_body")).css({"font-family":R})}}else if("comp_previewTemplate"===e){if(0===(O=$("#templatePreviewDIV")).length){var F=document.createElement("div");F.setAttribute("id","templatePreviewDIV"),F.setAttribute("class","nTpop zcrm-modal zcrm-effect w900"),document.body.appendChild(F),O=$("#templatePreviewDIV")}O.html(t),"sendMail"===template.featureName&&$(".nteditIcon").css("display","none"),template.showAnimatePopup("templatePreviewDIV")}else if("emailTrackingDetails"===e){var O;if(0===(O=$("#templateAnalyticsDIV")).length){var N=document.createElement("div");N.setAttribute("id","templateAnalyticsDIV"),N.setAttribute("class","nTpop zcrm-modal zcrm-effect w700"),document.body.appendChild(N),O=$("#templateAnalyticsDIV")}O.html(t),($(".mm-main-container").length||$("#showMassMail").length)&&O.css({"z-index":"250"}),template.showAnimatePopup("templateAnalyticsDIV")}else template.templatePostCallActions(e,i,t)}})},showTemplatePreview:function(e,t,a,i,r){commonUtils.showHideLoadingDiv(!0);var l=Crm.getCrmBasePath()+"/Template.do?step=previewTemplate";"WorkFlowAlert"===t&&(template.relatedModule=template.getRelatedModule(t));var n=csrfParamName+"="+encodeURIComponent(csrfToken);i?(l=Crm.getCrmBasePath()+"/Template.do?step=galleryTemplatePreview",n+="&templateName="+encodeURIComponent(r.templateName),n+="&module="+encodeURIComponent(r.module),n+="&selectedcategory="+encodeURIComponent(r.category),n+="&inventory="+template.inventory):"zeeditor"===t||"zceditor"===t?(l=Crm.getCrmBasePath()+"/Template.do?step=editorTemplatePreview",n+="&content="+encodeURIComponent(r.content),n+="&editorMode="+encodeURIComponent(r.editorMode),n+="&templateName="+encodeURIComponent(r.templateName),n+="&subject="+encodeURIComponent(r.subject),n+="&inventory="+template.inventory,n+="&from="+t,"zceditor"===t&&template.inventory&&(n+="&headerFooterInfo="+encodeURIComponent(r.headerFooterInfo),n+="&pageInfo="+encodeURIComponent(r.pageInfo))):(n+="&templateId="+e,n+="&from=templatePreview"),(new crmRequestPool).initiate({action:l,type:"POST",data:n,success:function(e){if(commonUtils.showHideLoadingDiv(!1),template.featureName=t,""!==a){template.popToClose=a;var i=$("#"+a);template.popzindex=i.css("z-index"),""!==template.popzindex&&i.css("z-index","20")}var r=$("#templatePreviewDIV");if(0===r.length){var l=document.createElement("div");l.setAttribute("id","templatePreviewDIV"),l.setAttribute("class","nTpop zcrm-modal zcrm-effect w900"),document.body.appendChild(l),r=$("#templatePreviewDIV")}r.html(e),"sendMail"===t&&$(".nteditIcon").css("display","none"),"Macro"!==t&&"ConsentMail"!==t&&"MassMail"!==t&&"reminderToOwner"!==t&&"AutoResponder_Pop"!==t&&"WebFormNotify"!==t&&"WebForm"!==t&&"WebFormAck"!==t&&"ApprovalProcess"!==t&&"ApprovalProcess_RE1"!==t&&"ApprovalProcess_RE2"!==t&&"viewTemplate_fz"!==t?setTimeout((function(){Crm.userDetails.isNewEditor&&EmailLaunchUtil.isComposeActive()?(template.showAnimatePopup("templatePreviewDIV",!1),EmailUtil.showEditorFreezeLayer()):(template.showAnimatePopup("templatePreviewDIV",!0),template.setWhiteFreezeLayer())}),400):setTimeout((function(){template.showAnimatePopup("templatePreviewDIV")}),400)},error:function(){commonUtils.showHideLoadingDiv(!1),renderingUtils.displayPermissionDenied()}})},showTemplateList:function(e,t,a,i,r,l,n,s,o,d){var c;commonUtils.showHideLoadingDiv(!0);var m=null!=l&&""!==l&&("true"===l||!0===l);"Macro"!==e&&"Macro_Dtl"!==e||(r=$("#module").val()),"WorkFlowAlert"===e?(r=$("#alertModule").val(),template.relatedModule=template.getRelatedModule(e)):"wizard"===e?r=document.querySelector("crm-wizard-builder").component.data.primaryModule.module_name:"ProcessFlow"===e?r=ProcessBuilder.Transition.Module:"MassMailSch"===e&&(r=$("#modList").val());var u=Crm.getCrmBasePath()+"/Template.do?step=showAllTemplates",p=csrfParamName+"="+encodeURIComponent(csrfToken);""!==r&&"null"!==r&&(p+="&module="+encodeURIComponent(r)),p+="&from=templateComponent",""!==template.relatedModule&&(p+="&relatedModule="+encodeURIComponent(template.relatedModule)),validationUtils.isEmptyString(n)||(p+="&fltrTagKey="+n,validationUtils.isEmptyString(s)||(p+="&fltrTagValue="+s)),validationUtils.isEmptyString(o)||(p+="&surveyName="+$ESAPI.encoder().encodeForURL(o)),m&&(p+="&consentTemplatesOnly=true"),"undefined"!=typeof automationActions&&null!==automationActions.isBulkEmail&&automationActions.isBulkEmail&&(p+="&skiptemplatesnames="+encodeURIComponent("consent_linked,unsubscribe_linked,zurvey_linked"));var g=$("#parentModule").val();validationUtils.isNotEmpty(g)&&(p+="&parentModule="+g),(new crmRequestPool).initiate({action:u,type:"POST",data:p,success:function(r){var l;commonUtils.showHideLoadingDiv(!1),""!==i&&(l=$("#"+i),c=l.css("z-index"));var n=$("#templateComponentDIV");if(0===n.length){var s=document.createElement("div");s.setAttribute("id","templateComponentDIV"),s.setAttribute("class","nTpop selectTemplate zcrm-modal zcrm-effect w700"),document.body.appendChild(s),n=$("#templateComponentDIV")}n.html(r),"wizard"===e&&n.css({"z-index":"10001"}),template.callback=a,template.templateIdentifier=t,template.isTemplateComponent=!0,template.featureName=e,template.isCrmCampaignMail=d,"sendMail"===e&&$("#createNewTempCompBtn").css("display","none"),""!==i&&(template.popToClose=i,template.popzindex=c,""!==template.popzindex&&l.css("z-index","20")),"Macro"!==e&&"ConsentMail"!==e&&"MassMail"!==e&&"reminderToOwner"!==e&&"AutoResponder_Pop"!==e&&"WebForm"!==e&&"ApprovalProcess"!==e&&"ApprovalProcess_RE1"!==e&&"ApprovalProcess_RE2"!==e?Crm.userDetails.isNewEditor&&EmailLaunchUtil.isComposeActive()?(template.showAnimatePopup("templateComponentDIV",!1),EmailUtil.showEditorFreezeLayer()):(template.showAnimatePopup("templateComponentDIV",!0),$("#freezeBackGround").css({"background-color":"#3a3a3a"})):template.showAnimatePopup("templateComponentDIV"),setTimeout((function(){$("#nTSearchTemp").focus()}),350);var o=$("#nTfolderOptions");o.next(".select2").remove(),thirdPartyUtils.bindSelect2(o)}})},getRelatedModule:function(e){var t,a;if("WorkFlowAlert"===e){if(a=$("#alertModule").val(),wfmergefield&&(wfmergefield.setActionType("EmailNotification"),(t=wfmergefield.getRelatedModule())&&t.indexOf("Orchestration")>-1))return t;if(wfNew&&"function"==typeof wfNew.getWFTriggerModule){var i=wfNew.getWFTriggerModule();t?t==i&&(t=i):t=i}}return a&&(t=t!=a?t:void 0),t||""},clearTemplate:function(e,t){var a=$("#"+e),i=a.siblings(".templateName").find("a");a.val(""),i.text(""),i.attr("onclick","return false"),i.attr("href","javascript:void(0)"),a.siblings(".clearTemplate").css("display","none"),$("."+e+"_fromTR").css("display","none");var r=$("."+e+"_replyTR");(r.css("display","none"),r.siblings(".otherEmailWarning").css("display","none"),void 0!==t)&&new Function(t)();$("#mailServerTypeDiv_comp1").addClass("hide"),$("#mailServerTypeDiv_comp2").addClass("hide")},showReplyTo:function(e,t){$(e).css("display","none");var a=$("#"+t);a.css("display",""),a.removeClass("hide")},setAddressType:function(e,t){var a=$(e).find("option:selected"),i=a.attr("type");if($(e).hasClass(t+"_from"))$("."+t+"_fromType").val(i);else{$("."+t+"_replyType").val(i);var r=$(e).closest("tr").siblings(".otherEmailWarning");if("4"===i){var l=[];l[0]=r.attr("replyToDueDays"),l[1]=Crm.getCrmBasePath()+"/ShowSetup.do?action=orgEmail&tab=general&subTab=orgEmail&email="+a.text().trim(),l[2]=a.text().trim(),l[3]=Crm.appName;var n=I18n.getMsg("crm.template.other.emails.warning.msg.new",l);"false"===r.attr("orgEmailAvail").trim()&&(n=I18n.getMsg("crm.template.other.emails.warning.msg_free.new",l)),r.find(".otherEmailWarningMsg").html(n),r.css("display","")}else r.css("display","none")}},removeEventBindings:function(){window.removeEventListener("beforeunload",template.windowonunload),document.removeEventListener("keydown",template.documentonkeydown),"undefined"!=typeof editor&&(editor=void 0)},validateTemplateNameSubject:function(){var e=$("#templateName"),t=$("#templateAlertsPop").find(".tempalertmsg"),a=$("#tempSuNamVal");if(""===e.val().trim())return t.text(I18n.getMsg("crm.template.name.empty.check")),a.val("templateName"),template.showAnimatePopup("templateAlertsPop",!0),!1;var i=getClrTxtPtnResChars(e.val()).join(", ");if(""!==i)return t.text(I18n.getMsg("crm.clearTextPattern.validationFail.alert",[I18n.getMsg("crm.label.name"),i])),a.val("templateName"),template.showAnimatePopup("templateAlertsPop",!0),!1;if(e.val().length>e.attr("maxlength"))return t.text(I18n.getMsg("crm.template.editor.name.len.check",e.attr("maxlength"))),a.val("templateName"),template.showAnimatePopup("templateAlertsPop",!0),!1;if(!template.inventory){var r=$("#templateSubject"),l=r.text().trim();if(""===l)return t.text(I18n.getMsg("crm.template.subject.empty.check")),a.val("templateSubject"),template.showAnimatePopup("templateAlertsPop",!0),!1;if(l.length>r.attr("maxlength"))return t.text(I18n.getMsg("crm.template.editor.sub.len.check",r.attr("maxlength"))),a.val("templateSubject"),template.showAnimatePopup("templateAlertsPop",!0),!1}var n=template.getEditorContent(),s=template.oldContentLength(),o=commonUtils.formatDecimalValue(template.contentlength,0);if(n.length>template.contentlength&&n.length>s)return t.text(I18n.getMsg("crm.template.email.content",o)),a.val(""),template.showAnimatePopup("templateAlertsPop",!0),!1;if(-1!==n.indexOf("${ConsentForm.")&&n.indexOf("${ConsentForm.")!==n.lastIndexOf("${ConsentForm."))return t.text(I18n.getMsg("crm.ConsentForm.linklimit.template")),a.val(""),template.showAnimatePopup("templateAlertsPop",!0),!1;if(-1!==n.indexOf("${userSignature}")&&n.indexOf("${userSignature}")!==n.lastIndexOf("${userSignature}"))return t.text(I18n.getMsg("crm.template.content.signature.valid")),a.val(""),template.showAnimatePopup("templateAlertsPop",!0),!1;var d=n.indexOf("${Unsubscribe");if(-1!==d&&d!==n.lastIndexOf("${Unsubscribe"))return t.text(I18n.getMsg("crm.unsubscription.linklimit.template")),a.val(""),template.showAnimatePopup("templateAlertsPop",!0),!1;if(-1===d&&"email"===Lyte.Router.getRouteInstance().getQueryParams().type&&template.mandateUnsubLink){var c=$("#templateUnsubLinkAlertsPop");return t=c.find(".tempalertmsg"),c.find(".headerMsg").text(I18n.getMsg("crm.email.preference.mandatory.unsublink.header")),t.text(I18n.getMsg("crm.email.preference.mandatory.unsublink.message")),template.showAnimatePopup("templateUnsubLinkAlertsPop",!0),!1}return!0},showVerisonHistoryChart:function(e,t){var a=0;0!==t.chartCount2&&(a=parseInt(t.chartCount1)/(1*parseInt(t.chartCount2))*100,a=parseFloat(a.toFixed(1))),$(e).highcharts({chart:{type:"pie",height:"185",width:"185",marginTop:"0"},title:{text:"<div style='font-size:1.6rem;color: #111111;font-weight: bold;'>"+t.chartType+"</div>",align:"center",y:10,style:{fontSize:"16px",fontWeight:"bold"}},plotOptions:{pie:{startAngle:0,dataLabels:{enabled:!1},enableMouseTracking:!1},series:{dataLabels:{formatter:function(){if(this.key===t.chartLabel)return this.percentage+"%"},style:{color:"#333",fontSize:"14px",fontWeight:"bold"},verticalAlign:"middle",enabled:!0,distance:-36}}},subtitle:{text:"<span style='font-size:1.3rem;color: #999999;margin-right: 3px;white-space: nowrap;'>"+t.allVersionPerc+" on all versions </span><div style='color: #333333;text-align:center;font-size:1.3rem;'>"+t.chartLabel+" : "+t.subtitlecount+"</div>",align:"center",useHTML:!0,verticalAlign:"bottom",y:-10,x:0,style:{color:"#333",fontSize:"12px"}},credits:{enabled:!1},series:[{size:"50%",innerSize:"78%",data:[{name:t.chartLabel,y:a,color:t.chartLabelColor},{name:"option2",y:100-a,color:"#cccccc"}]}]})},showVerisonHistoryZChart:function(e,t){networkUtils.returnDependencyFiles(["CrmChartUtil.js"],crmConstants.jsStaticPath);var a=0;0!==t.chartCount2&&(a=parseInt(t.chartCount1)/(1*parseInt(t.chartCount2))*100,a=parseFloat(a.toFixed(1)));var i=document.getElementById(e);i.style.width="185px",i.style.height="185px";var r={legend:{enabled:!1,colors:[t.chartLabelColor,"#cccccc"]},chart:{plot:{plotoptions:{pie:{innerRadius:"78%",events:{enabled:"false"}}}}},tooltip:{enabled:!1},metadata:{axes:{x:[0],y:[[1]],tooltip:[0,1]},columns:[{dataindex:0,columnname:"StatsLabel",datatype:"ordinal"},{dataindex:1,columnname:"option2",datatype:"numeric"}]},seriesdata:{chartdata:[{type:"pie",data:[[[t.chartLabel,a],["option2",100-a]]]}]},canvas:{title:{text:t.chartType,hAlign:"center",fontSize:16,fontWeight:"normal",fontColor:"#333333",marginTop:5},subtitle:{show:!0,text:t.allVersionPerc+" on all versions",x:35,y:142,fontColor:"#999999"},border:{show:!1}},notes:{enabled:!0,chartValues:[{x:80,y:85,type:"customNote"}],options:{customNote:{htmlEl:"<div style='border-radius:10px;background-color:white;text-align:center;font-size:14px'>"+t.allVersionPerc+"</div>"}}},credits:{enabled:!0,hAlign:"center",vAlign:"bottom",text:t.chartLabel+" : "+t.subtitlecount,fontColor:"#333333",fontSize:13}};setTimeout((function(){CrmChartUtil.renderChart(i,r)}),400)},addFilterTagsParams:function(){var e=$("#fltrTagKey").val(),t=$("#fltrTagValue").val(),a="";if(validationUtils.isEmptyString(e)||(a+="&fltrTagKey="+e,validationUtils.isEmptyString(t)||(a+="&fltrTagValue="+t)),"ZSURVEY"===e){var i=$("#surveyName").val();a+="&surveyName="+$ESAPI.encoder().encodeForURL(i)}return a},setAttributesForInlineImg:function(e,t){e&&(e.setAttribute("src",e.getAttribute("origsrc")),t?e.setAttribute("onload",'parent.template.onLoadInlineImg(this,"'+t+'")'):"htmlEditor"===template.editorType?e.setAttribute("onload","parent.parent.template.onLoadInlineImg(this)"):e.setAttribute("onload","parent.template.onLoadInlineImg(this)"),e.removeAttribute("origsrc"))},onLoadInlineImg:function(e,t){e.removeAttribute("onload");var a=template.getInlineImgs("[origsrc]");(a=a[0])?template.setAttributesForInlineImg(a,t):template.removeOnLoadForInlineImg()},removeOnLoadForInlineImg:function(){if(template.removeInlineImgOnload){template.removeInlineImgOnload=!1;for(var e=template.getInlineImgs("img"),t=e.length,a=0;a<t;a++){var i=e[a],r=i.getAttribute("onload");r&&r.includes("onLoadInlineImg")&&i.removeAttribute("onload")}}},getInlineImgs:function(e){var t,a=$("iframe[id=previewIframe]");if(a.length>0)t=a.contents().find(e);else if("htmlEditor"===template.editorType&&editor){var i=$("iframe[name=emailEditor]").contents().find("#ze_htmlview");t=i.is(":visible")?i.find("iframe").contents().find(e):editor.doc.querySelectorAll(e)}else if("dragdropEditor"===template.editorType){var r=$("iframe[name=emailEditor]");r.length>0&&(t=r.contents().find(e))}return t},triggerInlineImgReqs:function(e,t){var a=6,i=e.getElementsByTagName("img"),r=i.length;r<=10&&(a=r);for(var l=0;l<a;l++){var n=i[l];n.hasAttribute("origsrc")&&template.setAttributesForInlineImg(n,t)}template.removeInlineImgOnload=!0},replaceInlineImgs:function(e,t){var a=e;void 0===t&&(t=!1);for(var i,r=template.noimagesrc.trim().replace(template.noimagesrc.trim().substring(template.noimagesrc.trim().indexOf("zc-noimage")+10),""),l=new RegExp(/(<img([^>]*).*?>)/g);i=l.exec(e);){var n=i[1],s=null;if(t)(o=new RegExp(/origsrc=\\?"([^\\"]+)\\?"/).exec(n))&&o.length>0&&(s=(s=n.replace(template.noimagesrc,o[1])).replace(" "+o[0],""));else if(!n.includes("origsrc")){var o;if((o=new RegExp(/src=\\?"([^\\"]+)\\?"/).exec(n))&&o.length>0&&!o[1].includes(r)){var d=o[0].replace(o[1],template.noimagesrc);s=n.replace(o[0],d+" orig"+o[0])}}s&&(a=a.replace(n,s))}return a},addRemoveConentEditable:function(){$("#previewIframe").contents().find(".sandboxDiffChanges").attr("contentEditable",!0),setTimeout((function(){$("#previewIframe").contents().find(".sandboxDiffChanges").removeAttr("contentEditable")}),500)},templatesE1:function(e){if(!e)e=window.event;e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()}},gS={cobavailUsrEmailJson:void 0,frmPage:void 0,companyDetailsPopShown:!1,userTimeZone:"",orgSubmit:function(e,t,a){if(commonUtils.showHideLoadingDiv(),gS.orgNameValidate()){$("#"+e).addClass("op5 eventNone"),loadAjaxTab("","lightblue");var i=Crm.getCrmBasePath()+"/OrgConfig.do?actionName=updateOrgDetailsFrmCOB",r=$("#frmSignup").val(),l=$("#userTimeZone").val(),n=formData2QueryString(document.profilePageCOBForm);l!=this.userTimeZone&&Crm.client_tracking("Customer OnBoarding - TimeZone Changed",{"Timezone changed To":l}),"true"==a?(n=n+"&"+csrfParamName+"="+encodeURIComponent(csrfToken)+"&frmSignup="+r+"&populateSampleData=true",Crm.trackSpotLightAction("Customer OnBoarding - Explore With Sample Data"),Crm.client_tracking("Customer OnBoarding - Explore With Sample Data")):(n=n+"&"+csrfParamName+"="+encodeURIComponent(csrfToken)+"&frmSignup="+r+"&populateSampleData=false",Crm.trackSpotLightAction("Customer OnBoarding - Explore CRM"),Crm.client_tracking("Customer OnBoarding - Explore CRM")),(new crmRequestPool).initiate({action:i,data:n,success:function(e){if(a){var t=e.modVsCanvasId;t&&(moduleRecordMapping.Leads.viewid=t.Leads,moduleRecordMapping.Products.viewid=t.Products,moduleRecordMapping.Potentials.viewid=t.Potentials,moduleRecordMapping.Contacts.viewid=t.Contacts,moduleRecordMapping.Accounts.viewid=t.Accounts)}if(commonUtils.showHideLoadingDiv(!1),Crm.userDetails.orgTimeZone=l,crmui.hidePopup("cobdiv"),Crm.trackSpotLightAction("Customer OnBoarding - Profile Page Update"),Crm.client_tracking("Customer OnBoarding - Profile Page Update"),newSignupPageUnload&&window.removeEventListener("beforeunload",newSignupPageUnload),e.orgName&&(Crm.userDetails.orgName=e.orgName),e.mobilePage&&(window.location=Crm.getCrmBasePath()+"/mobilepage"),e.reloadPage)return window.location=window.location.href,window.opener&&window.opener.location.reload(),!1;e.IAM_EMAILCONFIGURE_URL?(networkUtils.openUrl(e.IAM_EMAILCONFIGURE_URL+"&serviceurl="+window.location.href,"_self"),Lyte.Component.render("crm-mobile-footer",{url:e.IAM_EMAILCONFIGURE_URL,crmVerifyEmailPop:!0},"body"),$("#deactivatebtn").val("Verifying...")):($("#FreezeLayer").removeClass("welcomeFreez"),$("#cobdiv").removeClass("welcomeContainer"))}})}return!1},basicProfile:function(e,t){var a=Crm.getCrmBasePath()+"/CustomerOnBoarding.do?tab=basicProfile&action=showProfilePage&frm="+e+"&isFreeUsr="+t;(new crmRequestPool).initiate({type:"POST",action:a,success:function(e){var t=$("#cobdiv"),a=$("#industType").val(),i=$("#cobdiv .pop-content");if(i.html(e),i.removeClass("zcrm-content"),commonUtils.showHideLoadingDiv(!1),"undefined"!=typeof CrmPlusImpl&&CrmPlusImpl.isLoadedInCrmplus())t.css("cssText","top:0px");else{var r=(renderingUtils.windowHeight-t.height())/2;t.css("cssText","top:"+r+"px !important")}crmui.showPopup("cobdiv"),t.addClass("welcomeContainer"),t.css("top",""),$("#FreezeLayer").addClass("welcomeFreez"),setTimeout((function(){$("#orgName").focus()}),100),thirdPartyUtils.bindSelect2($(".welcomeContainer .oBSelectBox"));var l=i.find(".welcomeInputStyle input"),n=l.length;l.on("focus",(function(){var e=$(this),t=e.parent().find(".fieldTransLabel");""===e.val()&&t.addClass("addedTrans")})),l.on("blur",(function(){var e=$(this),t=e.parent().find(".fieldTransLabel");""===e.val()&&t.removeClass("addedTrans")}));for(var s=0;s<n;s++){var o=$(l).eq(s),d=o.parent().find(".fieldTransLabel");""!==o.val()?d.addClass("addedTrans"):d.removeClass("addedTrans")}null!=a&&""!=a&&$("#industryType").val(a).trigger("chosen:updated")}}),$(window).ready((function(){Crm.trackSpotLightAction("Customer OnBoarding - Profile Page"),Crm.client_tracking("Customer OnBoarding - Profile Page")})),gS.companyDetailsPopShown=!0},welcomeOBMethod:function(e){!0===$(".dataSamplePopulatedCOB").prop("checked")?gS.orgSubmit("profileDetailBtn2",e,"true"):gS.orgSubmit("profileDetailBtn",e)},viewPop3:function(e){-1===jQuery.inArray("mail",usernameNotNeeded)&&commonUtils.checkUsernameNeeded((function(){"setup"==e?Utils.windowLocationReload(!0):gS.viewPopMailConfig()}),"mail")},viewPopMailConfig:function(){loadAjaxTab("","lightblue");var e=new crmRequestPool,t=Crm.getCrmBasePath()+"/CustomerOnBoarding.do?tab=emailInteg&action=mailAccConfig";e.initiate({type:"POST",action:t,success:function(e){var t=$("#cobdiv"),a=$("#alertDiv");commonUtils.showHideLoadingDiv(),$("#helpdesk").hasClass("cobclicked")?(t.show(),$("#cobdiv .zcrm-content").html(e),a.remove(),t.append(a)):$("#result").html(e)}}),Crm.trackSpotLightAction("Customer OnBoarding - Add Pop Account")},useExistingMailBox:function(e,t){var a="COB",i=$(t).attr("accId");$("#helpdesk").hasClass("cobclicked")||(a="setup");var r=Crm.getCrmBasePath()+"/CustomerOnBoarding.do?tab=emailInteg&action=useExistingMailBox&mailAddr="+e+"&accId="+i+"&frm="+a;(new crmRequestPool).initiate({type:"POST",action:r,success:function(e){$("#zmailAccountId").val(i),(e.indexOf("success")>-1||e.indexOf("crm.label.pop.multiorg")>-1)&&(Lyte.Router.getRouteInstance().transitionTo("crm.settings.section.email-settings",{action:"zmail"}),removeFreezeLayer())}}),Crm.trackSpotLightAction("Customer OnBoarding - Existing Mail Configured")},viewimapConfig:function(e,t,a){if($("#sub_emailSettings").hasClass("sel")){var i=I18n.getMsg("cob.alreadyin.setup.mailpage");crmui.showMsgBand("warning",i,5e3)}else{if($("#helpdesk").addClass("cobclicked"),"Pop3"==(e=$("#service").val()))var r={pageTitle:"Zoho Mail ",clickId:"general_emailSettings",tab:"comm",subTab:"emailSettings",calleeObj:"crmSetup",action:"checkConfiguration",conf:"true",service:e,frmPage:"COB",freshConf:a},l={url:Crm.getCrmBasePath()+"/ZMailConfig.do",params:r,title:"crm.label.email.integration",frmPage:"COB"};else r={pageTitle:"crm.label.imap.integration",clickId:"general_emailSettings",tab:"comm",subTab:"emailSettings",calleeObj:"crmSetup",action:"showConfig",conf:"true",service:e,frmPage:"COB",freshConf:a,imapuname:t},l={url:Crm.getCrmBasePath()+"/specific/IMAPAction.do",params:r,title:"crm.label.imap.integration",frmPage:"COB"};crmSetup.loadInnerPageResponse(l,r,"comm","emailSettings")}},showless:function(e,t){gS.emailintclk("COB",e,t)},populateSampleData:function(e,t){loadAjaxTab("","lightblue");var a=new crmRequestPool,i="&"+csrfParamName+"="+encodeURIComponent(csrfToken)+"&type="+e;t&&(i=i+"&emailList="+encodeURIComponent(t));var r=Crm.getCrmBasePath()+"/CustomerOnBoarding.do?tab=basicProfile&action=populateSampleData";a.initiate({type:"POST",action:r,data:i,success:function(e){if(commonUtils.showHideLoadingDiv(),e.indexOf("ERROR::::")>-1){var t=e.split("ERROR:::");return crmui.showMsgBand("warning",t,5e3),!1}$("#AddSampleDataFrmHome").hide(),$("#sampleDateInProgressHomeCommon").show(),"frmHome"==gS.frmPage?$("#sampleDateInProgressHome").hide():crmui.showMsgBand("warning",I18n.getMsg("cob.sampledata.population.scheduled"),5e3),crmui.hidePopup("cobdiv")}})},scheduleDataPopulation:function(){if(validateSampleEmails()){var e=$("#userType").val();gS.populateSampleData(e,sampleCOBEmailList),Crm.trackSpotLightAction("Customer OnBoarding - Sample Data Added",{Type:e}),Crm.client_tracking("Customer OnBoarding - Sample Data Added",{Type:e})}},orgNameValidate:function(){var e,t,a=!0;$(".errorFieldP").removeClass("errorFieldP"),$(".errorMsgDesc").remove();var i,r,l=document.profilePageCOBForm.orgName.value,n=document.profilePageCOBForm.orgPhone,s=document.profilePageCOBForm.userEmail,o=$("#orgPhone"),d=$("#orgName"),c=$("#userEmail");return n&&(i=document.profilePageCOBForm.orgPhone.value),s&&(r=document.profilePageCOBForm.userEmail.value),null==l||""==l.trim()?(t=d,e=I18n.getValueForFields("crm.field.empty.check","Company"),Crm.showErrorMsg(e,t,"coborgName"),Crm.trackSpotLightAction("COB - Company Name Alert"),Crm.client_tracking("COB - Company Name Alert"),d.focus(),a=!1):(null!=l&&""!=l&&0!=l.replace(/^\s+/g,"").replace(/\s+$/g,"").length||(t=d,e=I18n.getValueForFields("crm.field.empty.check","Company"),Crm.showErrorMsg(e,t,"coborgName"),Crm.trackSpotLightAction("COB - Company Name Alert"),Crm.client_tracking("COB - Company Name Alert"),d.focus(),a=!1),!s||validationUtils.isValidEmail(r)&&""!=r||(t=c,e=I18n.getValueForFields("crm.field.valid.check","Email"),Crm.showErrorMsg(e,t,"Email"),Crm.trackSpotLightAction("COB - User Email Alert"),Crm.client_tracking("COB - User Email Alert"),c.focus(),a=!1),n&&(!validationUtils.isValidPhoneNo(o,i)||i.length<6)&&(t=o,e=I18n.getValueForFields("crm.field.valid.check","Phone"),Crm.showErrorMsg(e,t,"Phone"),Crm.trackSpotLightAction("COB - Phone Number Alert"),Crm.client_tracking("COB - Phone Number Alert"),o.focus(),a=!1)),a},emailintclk:function(e,t,a){if("COB"==e&&$("#sub_emailSettings").hasClass("sel")){$("#helpdesk").removeClass("cobclicked");var i=I18n.getMsg("cob.alreadyin.setup.mailpage");crmui.showMsgBand("warning",i,5e3)}else{var r=$("#helpdesk");loadAjaxTab("","lightblue"),r.hasClass("cobclicked")||(e="setup");var l=Crm.getCrmBasePath()+"/CustomerOnBoarding.do?tab=emailInteg&action=mailConfigMainPage&frm="+e;null==a&&(l+="&freshConf=true"),(new crmRequestPool).initiate({type:"POST",action:l,success:function(e){commonUtils.showHideLoadingDiv();var i=$("#otherIMAP");if(r.hasClass("cobclicked")){$("#cobdiv .pop-content").html(e);var l=renderingUtils.windowOuterHeight-100;if($("#cobdiv .popup-padding").css({maxHeight:l,overflow:"auto"}),$("body").addClass("oH"),crmui.showPopup("cobdiv"),null!=t){"other"==t?$(".migImap").trigger("click"):$(".mig"+t).trigger("click"),$("#service").val(t),$("#frmService").val(t),$("#acnt_select").hide();var n=i.find("#"+t);n.addClass("flag"),n.show(),i.fadeIn(),$("#cobdiv #imapUsername").val(a),"true"===$("#isOAuthConf").val()&&($("#cobdiv #imapPassword").val("*********"),$("#cobdiv #imapUsername, #cobdiv #imapPassword").attr("readonly",!0))}}else $("#result").html(e)}})}},hideAnimateCOBalert:function(){$("#helpdesk").hasClass("cobclicked")||hideFreezeLayer(),crmui.hidePopup("cobdiv_alert")},hideAnimateGLS:function(){$("#helpdesk").hasClass("cobclicked")&&$("body").removeClass("oH"),crmui.hidePopup("cobdiv_alert")},focusFields_cob:function(e){$(".labelValCreate").removeClass("focusEleField"),$(e).closest(".labelValCreate,.tabDiv").addClass("focusEleField"),"saveCancelSpan"==$(e).next().attr("id")&&$(e).off("blur",removeFocusClass)}};function slidelt(e){var t=$("#helpdesk");t.removeClass("r0").addClass("_r390"),"frmSetupClick"!=e&&t.addClass("cobclicked"),t.removeClass("active"),$(".cobStartShow").hide(),$(".cobStartHide").show(),$("body").removeClass("oH"),$("#cobouterdiv").css({width:"60px",right:"-60px"})}var Territory={};Territory.territoryAction=Crm.getCrmBasePath()+"/TerritoryConfig.do?action=",Territory.forcastAction=Crm.getCrmBasePath()+"/TerritoryForecast.do?action=",Territory.rolefcAction=Crm.getCrmBasePath()+"/RoleForecast.do?action=",Territory.deleteInfo={},Territory.currentInfo={},Territory.terrNameRegex=/[^~`#%^&*()+={}[\]|\;",'!<>\\]/g,Territory.editMode=!1,Territory.isValidated=!1,Territory.territoryUserIds,Territory.delForecastDet,Territory.csrf=function(){return csrfParamName+"="+encodeURIComponent(csrfToken)},Territory.init=function(){Territory.templates={userTemplStr:"{{#each this}}<tr><td width='60%'>{{NAME}}</td><td><input type='text' pre-data='' cur-data=''  id='userTarget_{{USERID}}' class='inputTxtBox floatL mt5 w120' maxlength='15' value='' /><span onclick='Territory.showPreviousTarget(this, event);' class='iconInfo mL8 mT10 fromTemp vam'></span></td></tr>{{/each}}",territoryTemplStr:"<li class='lightGreyBg p0 dIB pR5 mR5 mt5' id='li{{TERRITORYID}}' title='{{NAME}}'><label class='pR5 pB5 mt5 pL10 floatL gray2'>{{NAME}}</label><a class='dbBtnClose floatL mt5' href='javascript:;' onclick=\"Territory.deleteTerritoriesFromCriteria('{{TERRITORYID}}')\" ><span alt='' class='dbBtnCloseBorder dIB vam ico-close-small svgIcons'></span></a></li>"},Territory.usersTemplate=Handlebars.compile(Territory.templates.userTemplStr),Territory.terrTemplate=Handlebars.compile(Territory.templates.territoryTemplStr)},Territory.hideDiv=function(){var e=this.rolefcAction+"updateToHide";mR(e,(function(e){"false"!=e&&($("#activationInfo").hide(),$("#newFcLink").show())}))},Territory.compareOldValues=function(e,t){var a,i=$("#oldDuration").val(),r=$("#oldFiscal").val(),l=$("#oldFieldId").val(),n=$("#displayMode").val(),s=e.value,o=t.value,d=$("#fiscalStart").val(),c=$("input:radio[name=fYDisplay]:checked").val();return(i!=s||r!=d||l!=o||n!=c)&&(a=!0),1==i&&1==s&&l==o&&(a=!1),a},Territory.checkChangeInRole=function(){var e=$("#oldRoleId").val(),t=$("#roleId").val(),a=getElemById("removeUser");if(e!=t&&a){if("block"!=a.style.display)return Territory.showTerritoryPopup("removeUser"),!1;var i=$('select[id="changedManagerId"]').val();$('input[name="changedManagerId"]').val(i)}return!0},Territory.setUserTerritoryIds=function(){var e="";if(getElemById("territoryLookup")){var t=getElemById("userTerritoryIds").value,a=getElemById("managedids").value,i=(a=(a=a.trim()).substr(0,a.length)).split(","),r=[];$("#territoryLookup input:checked").each((function(){var e=this.id;e=e.replace("check",""),r.push(e)}));for(var l=0;l<i.length;l++)-1==r.indexOf(i[l])&&r.push(i[l]);var n=(t=t.trim()).length>0?t.length-1:0;t.lastIndexOf(",")<n&&(n+=1);for(var s=(t=t.substr(0,n)).split(","),o=0;o<s.length;o++)""!=s[o]&&-1==r.indexOf(s[o])&&-1==i.indexOf(s[o])&&(e+=s[o]+",");$("#removedTerritories").val(e),this.territoryUserIds=r.join(",")}},Territory.checkUserTerritory=function(){var e=getElemById("removeUser");if(e&&"block"==e.style.display)return this.isValidated=!0,$("#userTerritoryIds").val(Territory.territoryUserIds),this.setRemoveUserValues(","),!0;this.setUserTerritoryIds();var t=$("#removedTerritories").val();return null==t||""==t||this.isValidated?(this.isValidated=!0,Territory.territoryUserIds&&($("#userTerritoryIds").val(Territory.territoryUserIds),Territory.territoryUserIds=void 0),!0):(this.isValidated=!0,!1)},Territory.showRemoveTerritoryPopup=function(e){var t=$("#removedTerritories").val();if(null!=t&&""!=t){var a=Territory.territoryAction+"removeTerritory&territoryIds="+t+"&userId="+e;mR(a,(function(e){getElemById("topBandPopup")&&Territory.removeTerrLookup("topBandPopup"),"false"!=e?($("#removepopup").html(e),Crm.userDetails.RTL_ENABLED&&$("#removeUser .select").addClass("chosen-rtl"),thirdPartyUtils.bindSelect2("#removeUser .select"),$(".chosen-single").css("width","190px"),$(".chosen-drop").css("width","198px"),$(".chosen-search input").css("width","163px"),Territory.showTerritoryPopup("removeUser")):(getElemById("removedTerritories").value="",$("#userTerritoryIds").val(Territory.territoryUserIds),updateUserDetails())}))}},Territory.territoryList=function(){Lyte.Router.getRouteInstance().transitionTo("crm.settings.section.territories.index-territories")},Territory.newTerritory=function(e){var t={};null!=e&&""!=e&&(t.parentId=encodeURIComponent(e)),Lyte.Router.getRouteInstance().transitionTo("crm.settings.section.territories.create-territory","",t)},Territory.editTerritory=function(e){Lyte.Router.transitionTo({route:"crm.settings.section.territories.edit-territory",dynamicParams:[e]})},Territory.showDeletePopup=function(e,t){this.deleteInfo.name=t,this.deleteInfo.id=e;var a=$("#li_"+e+" li");if($("#showDeleteName").text(t),delete this.deleteInfo.terrNames[e],0==a.length)$("#withoutTransfer").show(),$("#transfer, #withTransfer").hide(),$("#transferbut").val(I18n.getMsg("crm.button.deleteterritory"));else{$("#withoutTransfer").hide(),$("#transfer,#withTransfer").show(),$("#transferbut").val(I18n.getMsg("crm.button.transfer.and.delete.territory")),this.deleteInfo.newObject=$.extend(!0,{},this.deleteInfo.terrNames);for(var i=0;i<a.length;i++){var r=a[i].id.replace("li_","");delete this.deleteInfo.terrNames[r]}this.setTerritoryNamesAsOption()}this.showTerritoryPopup("deletePopup"),thirdPartyUtils.bindSelect2($(".newSelect").find("select"))},Territory.cancelDelTerritory=function(e){"none"==$("#withoutTransfer").css("display")&&(this.deleteInfo.terrNames=this.deleteInfo.newObject),this.cancelTerritoryPopup(e)},Territory.setTerritoryNamesAsOption=function(){var e=this.deleteInfo.terrNames.sortedList,t=document.createElement("option"),a=$("#transferTo");$("#transferTo option[value=none]").nextAll().remove();for(var i=0;i<e.length;i++){var r=e[i],l=this.deleteInfo.terrNames[r];null!=l&&a.append($(t).clone().attr({value:r}).html(l.nameToDisplay))}},Territory.deleteTerritory=function(){var e=getElemById("transferTo");if(e&&"none"==$("#withoutTransfer").css("display")&&"none"==e.value)return e.focus(),alert(I18n.getMsg("crm.territory.choose.transferto")),!1;var t,a=this.territoryAction+"deleteTerritory";t=!newForecastsEnabled&&$("#deleteForecast").prop("checked");var i="territoryId="+this.deleteInfo.id+"&deletedName="+encodeURIComponent(this.deleteInfo.name)+"&"+this.csrf()+"&deleteForecast="+t;e&&"none"!=e.value&&(i+="&transferTo="+e.value),this.cancelDelTerritory("deletePopup"),mR(a,(function(e){if("false"==trimBoth(e))alert("unable to process the request");else{if("DELETED"==trimBoth(e)){var t=$("#li_"+Territory.deleteInfo.id);t.hasClass("listHierarchy")&&t.prev().addClass("listHierarchy"),t.remove()}else{var a=getElemById("result");$(a).empty(),a.innerHTML=e,EvalInnerScript(a)}var i=Territory.deleteInfo.name+"  "+I18n.getMsg("crm.territory.delete.success.msg");$("#success").text(i),$("#deletedMsg").fadeIn().delay(1e3).fadeOut("slow"),$.scrollTo("#deletedMsg",{axis:"y",duration:1e3,offset:-100,onAfter:function(){}})}}),i)},Territory.disableTerritory=function(){var e=this.territoryAction+"disable";this.doUpdateForm("result",this.csrf(),!1,!1,e),this.cancelTerritoryPopup("disable"),$("#sub_assignTerritory, #sub_territoryRules").css("display","none")},Territory.defineOrEnableTerritory=function(e,t){var a=e?"enableTerritory":"defineTerritories",i=this.territoryAction+a;doAjaxUpdate("result",i,this.csrf()),t&&"resume"==$(t).attr("data-id")&&($("#sub_assignTerritory, #sub_territoryRules").css("display","block"),$("#assign").show(),$("#rules").show()),Crm.userDetails.TMENABLED=1},Territory.createTerritoryHierarchy=function(e,t){this.cancelTerritoryPopup("Activation"),$(t).prop("disabled",!0);var a=this.territoryAction+"createHierarchy",i="mode="+e+"&"+this.csrf();doAjaxUpdate("result",a,i),$("#sub_assignTerritory, #sub_territoryRules").css("display","block"),$("#assign").show(),$("#rules").show()},Territory.redirectToTerritoryAssignMent=function(e,t){if(void 0===e&&(e=getElemById("parentId").value),getElemById("module"))t=getElemById("module").value;this.cancelTerritoryPopup("redirect");var a={actiontype:"territoryassignment",filter:"territory",territoryids:e,module:t};1!==e&&(a.includechild=1),Lyte.Router.transitionTo({route:"crm.settings.section.territory-assign"}).data=a},Territory.changeModule=function(e){var t=Crm.getCrmBasePath()+"/TerritoryAssignment.do?actiontype=search",a="module="+e;this.doUpdateForm("result",a,!0,!1,t)},Territory.togglePotentialRule=function(){var e=$("#potentialRule");"block"===e.css("display")?(e.slideUp(),$("#potArrow").addClass("upArrow").removeClass("downArrow"),setTimeout((function(){e.stop(!0,!0).hide()}),400)):(e.slideDown(),$("#potArrow").addClass("downArrow").removeClass("upArrow"),setTimeout((function(){e.stop(!0,!0).show()}),400))},Territory.toggleLeadRule=function(){var e=$("#leadRule");"block"===e.css("display")?(e.slideUp(),$("#leadArrow").addClass("upArrow").removeClass("downArrow"),setTimeout((function(){e.stop(!0,!0).hide()}),400)):(e.slideDown(),$("#leadArrow").addClass("downArrow").removeClass("upArrow"),setTimeout((function(){e.stop(!0,!0).show()}),400),1==$("#assignrulediv").length&&crmui.resizePopup("assignrulediv"))},Territory.toggleTerritory=function(e){var t=$("#div"+e),a=$("#img_"+e);"block"==t.css("display")?(t.slideUp(500),setTimeout((function(){t.stop(!0,!0).hide()}),400),a.removeClass("expand2").addClass("collapse2")):(t.slideDown(500),setTimeout((function(){t.stop(!0,!0).show()}),400),a.removeClass("collapse2").addClass("expand2"))},Territory.expandAllTerritories=function(){for(var e=$("#parentId").val(),t=$("#div"+e),a=$("#div"+e+" div"),i=0;i<a.length;i++){var r=a[i].id;r=r.replace("div","");var l=$("#div"+r).slideDown(500);setTimeout((function(){l.stop(!0,!0).show()}),400),$("#img_"+r).removeClass("collapse2").addClass("expand2")}t.slideDown(500),setTimeout((function(){t.stop(!0,!0).show()}),400),$("#img_"+e).removeClass("collapse2").addClass("expand2")},Territory.collapseAllTerritories=function(){for(var e=$("#parentId").val(),t=$("#div"+e),a=$("#div"+e+" div"),i=0;i<a.length;i++){var r=a[i].id;r=r.replace("div","");var l=$("#div"+r).slideUp(500);setTimeout((function(){l.stop(!0,!0).hide()}),400),$("#img_"+r).removeClass("expand2").addClass("collapse2")}t.slideUp(500),setTimeout((function(){t.stop(!0,!0).hide()}),400),$("#img_"+e).removeClass("expand2").addClass("collapse2")},Territory.editParent=function(){var e=$("#parentTerritory").text();this.editMode=!0;var t="<input type='text' id='textbox_parent' onkeydown=\"handleButton('save',event)\" maxlength='50' value='"+$ESAPI.encoder().encodeForHTMLAttribute(e)+"' class='inputTxtBox mt5'>";t+="<input type='button' id='save' value='"+I18n.getMsg("Save")+"' class='saveLink' onclick='Territory.saveParent()'>",t+="<input type='button' id='cancel' value='"+I18n.getMsg("Cancel")+"' class='saveLink' onclick='Territory.cancelParent()'>",$("#parent").html(t),$("#parentTerritory").hide()},Territory.cancelParent=function(){var e=$("#old_parent").val();$("#parentTerritory").show().text(e),$("#parent").html(""),this.editMode=!1},Territory.showTerritorySettings=function(){var e=$("#forecastSettings"),t=$("#slidePopUp");e.css("display","block"),e.height(t[0].scrollHeight),$("#innerSlideWrapper").height(t[0].scrollHeight)},Territory.showEnable=function(){var e=$("#oldPotAssignment").val();if(0!==(e=parseInt(e))){var t,a,i,r=$("#enableT");$("#slidePopUp").animate({left:"-570px"}),r.animate({left:"0px"});var l=[];l.push(moduleRecordMapping.Potentials.singular_label),l.push(moduleRecordMapping.Potentials.plural_label),1===e?(t=I18n.getMsg("crm.territory.label.disable.rule",I18n.getMsg(l)),a=I18n.getMsg("crm.territory.note.disable.rule",I18n.getMsg(l)),i=I18n.getMsg("crm.button.understand.disable.now")):(t=I18n.getMsg("crm.territory.label.reenable.rule",I18n.getMsg(l)),a=I18n.getMsg("crm.territory.note.reenable.rule",I18n.getMsg(l)),i=I18n.getMsg("crm.button.yes.understand")),freezeBackground(),$("#FreezeLayer").css("opacity",".1"),renderingUtils.ShakeDivInfreeze("forecastSettings","up",20,100),$("#reenable").text(t),$("#reenablenote").text(a),$("#butValue").val(i),$("#forecastSettings,#innerSlideWrapper").height(r[0].scrollHeight)}else Territory.updateTerritorySettings()},Territory.cancelEnable=function(){var e=$("#slidePopUp");$("#enableT").animate({left:"937px"}),e.animate({left:"0px"}),$("#forecastSettings,#innerSlideWrapper").height(e[0].scrollHeight),removeFreezeLayer()},Territory.updateTerritorySettings=function(){var e=$("#oldPotAssignment").val(),t=1===(e=parseInt(e))?2:1;if(t!==e){var a=this.territoryAction+"updatePotRuleSettings",i={};i.potRule=t,i.crmcsrfparam=encodeURIComponent(csrfToken),mR(a,(function(e){if("false"===trimBoth(e))alert("unable to process the request");else{$("#oldPotAssignment").val(t);var a,i=$("#spanValue"),r=[];r.push(moduleRecordMapping.Potentials.singular_label),1===t?(i.text(I18n.getMsg("crm.label.enabled")),i.next("a").text(I18n.getMsg("crm.button.disable")),a=I18n.getMsg("crm.territory.success.msg.enable.rule",I18n.getMsg(r))):(i.text(I18n.getMsg("Disabled")),i.next("a").text(I18n.getMsg("crm.button.enable")),a=I18n.getMsg("crm.territory.success.msg.disable.rule",I18n.getMsg(r))),crmui.showMsgBand("success",a,4e3,"")}}),i)}this.cancelEnable(),$("#forecastSettings,#innerSlideWrapper").height($("#slidePopUp")[0].scrollHeight),$("#forecastSettings").hide()},Territory.checkTerritoryname=function(e,t){var a=e.value,i=getClrTxtPtnResChars(a,this.terrNameRegex).join(", ");if(""!=i){var r=[];return r.push(t),r.push(i),i.length,alert(I18n.getMsg("crm.clearTextPattern.validationFail.alert",I18n.getMsg(r))),e.focus(),!1}return""!=trimBoth(a)||(renderingUtils.displayErrorDiv("territoryName",t,"crm.field.empty.check"),e.focus(),!1)},Territory.saveParent=function(){var e=$("#old_parent").val(),t=getElemById("textbox_parent"),a=trimBoth(t.value);if(e!=a){var i=getElemById("parentId").value;if(!this.checkTerritoryname(t,I18n.getMsg("crm.label.territory.name")))return!1;var r=this.territoryAction+"updateParent",l="territoryId="+i+"&territoryName="+a+"&"+this.csrf();mR(r,(function(e){"false"==trimBoth(e)?alert("unable to process the request"):($("#parentTerritory").show().text(a),$("#parent").html(""),$("#old_parent").val(a))}),l),this.editMode=!1}else this.cancelParent()},Territory.doUpdateForm=function(e,t,a,i,r,l,n,s,o){var d="";null!=r?d=t:(r=getAttr(t,"action"),d=formData2QueryString(t)),void 0!==o&&(d+="&hierarchyDetails="+encodeURIComponent(JSON.stringify(o)));var c=getElemById(e);l&&(d+="&criteria="+encodeURIComponent(JSON.stringify(l))),void 0!==n&&n&&(d+="&potcriteria="+encodeURIComponent(JSON.stringify(n))),s&&(d+="&leadcriteria="+encodeURIComponent(JSON.stringify(s))),null!=a&&1==a&&(d+="&"+this.csrf());var m=t&&t.name?t.name:"",u=t&&t.territoryId?t.territoryId.value:"";mR(r,(function(e){var t=e.split("###")[0].trim(),a=e.split("###")[1];if("AssignCriteria"===m&&"NO_CHANGE"!==t){var l=JSON.parse(e),n=l.CriteriaString,s=$("#li_"+u);s.find(".terroritoryRulesDropdown").eq(0).show().html(n),s.find(".terplace").eq(0).addClass("crm-font-bold");var o=$("#mo"+u);if(0===n.length)s.find(".terroritoryRulesDropdown").eq(0).hide(),o.html(""),o.append("<a class='f11 fblink fL mL20' style='color: #6d99c6;' href='javascript:void(0);' onclick=\"Territory.assignRule('"+u+"', 'assign',this)\">"+I18n.getMsg("crm.territory.assign.rule")+"</a>");else if(o.length>0)o.find(".fblink").eq(0).text(I18n.getMsg("crm.territory.hide.rule"));else if(0==o.length){var d=s.find(".terplace").eq(0);d.next("a").remove(),d.after("<span class='pL10 floatL' id='mo"+u+"' style='visibility:hidden'><a class='f11 fblink fL mL20' style='color: #6d99c6;' href='javascript:void(0);' onclick='Territory.showOrHideTerritoryRule(this)'>"+I18n.getMsg("crm.territory.hide.rule")+"</a><a class='f11 fblink fL lh35 mL20' style='color: #6d99c6;' href='javascript:void(0);' data-params='{\"isLAEnabled\" : "+$("#isLAEnabled").val()+"}' data-cid='editTerrRule' onclick=\"Territory.assignRule('"+u+"', 'edit', this)\">"+I18n.getMsg("crm.territory.edit.rule")+"</a></span>")}if(l.accCrtChanged||l.potCrtChanged||l.leadCrtChanged){var p=l.module;getElemById("parentId").value=l.territoryId,getElemById("module").value=p,$("#redirectMsg").empty(),getElemById("redirectMsg").innerHTML=I18n.getMsg("crm.territory.msg.changed.rule",I18n.getMsg(moduleRecordMapping[p].plural_label)),getElemById("redirectBut").value=I18n.getMsg("crm.button.runrules",I18n.getMsg(moduleRecordMapping[p].plural_label)),Territory.showTerritoryPopup("redirect")}}else if("NO_CHANGE"===t)i=!1;else if(e.indexOf("ALREADY_EXSISTS_ERROR")>=0){var g=e.split("###");getElemById("errorMsg");$("#territoryName").length>0?renderingUtils.displayErrorDiv("territoryName","crm.label.parent.territory",g[1]):$("#roleName").length>0&&renderingUtils.displayErrorDiv("roleName","crm.security.role.name",g[1]),i=!0}else if(e.indexOf("REPORTSTO_ROLE_DELETED")>=0){g=e.split("###"),getElemById("errorMsg");$("#reportsTo").length>0&&renderingUtils.displayErrorDiv("reportsTo","crm.security.role.reportsTo",g[1]),i=!0}else{if("REACHED_MAX_LIMIT"===t)return renderingUtils.showCustomAlert(I18n.getMsg("crm.territory.alert.add",a)),!1;if(e.indexOf("REACHED_MAX_USER_LIMIT")>=0){g=e.split("###");return renderingUtils.showCustomAlert(I18n.getMsg("crm.territory.alert.add.users",g[1])),!1}if("SHOW_NO_RECORDS_ALERT"===t)$("#advancedsearchArrowN").addClass("nextDisabled"),alert(I18n.getMsg("crm.new.label.no.records"));else{if(e.indexOf("TERRITORY_NOT_FOUND")>=0)return renderingUtils.showCustomAlert(I18n.getMsg("crm.territories.delete.territories")),!1;if(e.indexOf("ENCRYPTED_FIELDS_IN_CRITERIA")>=0)return renderingUtils.showCustomAlert(I18n.getMsg("crm.forecast.encryption.error.msg")),$("#custom_alert_button").prop("disabled",!1),!1;if("false"===t)alert("unable to process the request");else if(e.indexOf("misMatchType")>0){var v=JSON.parse(e);networkUtils.loadFeatureScripts(["zohocrm_forecastTemplate.js",networkUtils.getI18nJSUrl("reportingtopopup")],(function(){Handlebars.registerPartial("role_change",Handlebars.templates.role_branch_change);var e=$("#roleChangePopUp");e.length>0&&e.remove(),$("#show").append(Handlebars.templates.role_branch_change(v));var t=$("#roleDD"),a=[];t.children().each((function(){var e=$(this).val();a.contains(e)?$(this).remove():a.push(e)})),showAnimatePopup("roleChangePopUp"),userSelect(),t.trigger("change"),$("#subOrdinateList").hide()}))}else{$(c).empty(),c.innerHTML=e,EvalInnerScript(c);var h=$(c);if(("createRole"===m||"editRoleForm"===m)&&h.find("#roleid").length>0&&null!=h.find("#roleid").val()&&""!==h.find("#roleid").val()&&"null"!==h.find("#roleid").val())Lyte.Router.getRouteInstance().transitionTo("crm.settings.section.roles.view-role",h.find("#roleid").val()).data={data:e}}}}null!=i&&1==i&&(0!=(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop)&&$.scrollTo("#basic",{axis:"y",duration:1e3,offset:-50}));"TerritoryForm"===m&&-1==e.indexOf("ALREADY_EXSISTS_ERROR")&&(Lyte.Router.transitionTo({route:"crm.settings.section.territories.index-territories"}).cachedResponse=$(c).html()),r.indexOf("disable")>-1&&(Crm.userDetails.TMENABLED=2)}),d)},Territory.setTerritoryCV=function(e,t){t=null==t?0:t;var a,i={module:crmListView.getObject().module,cvid:crmListView.getObject().cvId},r=crmListView.getObject().searchletter;i.territoryId=e,1==t&&(a=!0),i.updateCV=!0,i.webTab="false",i[csrfParamName]=csrfToken,r&&"All"!=r&&(i.searchletter=r),i.clearCache=!0;var l=Lyte.Router.getRouteInstance().transition.info.route;Lyte.Router.transitionTo({route:l,dynamicParams:[i.module,i.cvid,crmListView.getObject().viewid],queryParams:{territory_id:e,include_child:a}}).data=i},Territory.territoryLookUp=function(e,t,a,i){var r="";if("assignTerritory"==e){var l=$("#id").val();null!=l&&(r="&seId="+l+"&module="+$("#module").val())}var n=this.territoryAction+"territoryLookup&operation="+e+"&hideParent="+t+"&fieldname="+a+"&fieldid="+i+r;mR(n,(function(e){var t=$("<div>");t.html(e),t.find("br").remove(),$("#topBandPopup").html(t),$("#FLEEMsgError").length&&t.addClass("whiteBg p20"),freezeBackground(),showAnimatePopup("topBandPopup")}))},Territory.hideMouseOver=function(e,t){var a=$("#leadRuleSelect");a.is(":visible")&&e==a.data("territoryId")||(jQuery("#mo"+e).css("visibility","hidden"),t&&((t=$(t)).removeClass("hover"),t.find("span").eq(0).removeClass("link1")))},Territory.showParentRules=function(){var e=this.territoryAction+"viewParent",t=getElemById("parentId").value;mR(e,(function(e){$("#topBandPopup").html(e),showAnimatePopup("topBandPopup")}),"parentId="+t)},Territory.assignRule=function(e,t,a){var i=this.territoryAction+"assignRule";a=$(a);void 0===e&&(e=a.data("territoryId"));var r="territoryId="+e+"&mode="+encodeURIComponent(t);if("editTerrRule"==a.data("cid")&&JSON.parse(a.attr("data-params")).isLAEnabled){var l=a.offset().top,n=a.offset().left;return $("#leadRuleSelect").data("territoryId",e),$("#accRuleSelect").data("territoryId",e),void $(".settingsDropDownPopup").css({top:l+30,left:n}).show()}mR(i,(function(t){$("#assignrulediv").empty(),$("#assignrulediv")[0].innerHTML=t,crmui.showPopup("assignrulediv",!0),$("#editTerritoryRuleSelect").hide(),$("#mo"+e).css("visibility","hidden"),"leadRuleSelect"===a.data("cid")?($("#accountRuleAssign").hide(),$("#potRuleAssign").hide()):$("#leadRuleAssign").hide(),EvalInnerScript(getElemById("assignrulediv"))}),r)},Territory.assignTerritory=function(e,t,a,i){removeFreezeLayer();var r="",l=$("#module").val(),n=$("#id").val(),s=$("#entityName").val(),o=this.territoryAction+"manualAdd",d="seId="+encodeURIComponent(n)+"&territoryId="+e+"&territoryName="+encodeURIComponent(t)+"&entityname="+encodeURIComponent(s)+"&module="+l+"&"+this.csrf();if("canvas"===Lyte.Router.getRouteInstance().routeName){var c={data:{Territories:[{id:e}]}};store.peekRecord(moduleRecordMapping[l].id,n).$.triggerAction("assign_territories",{type:"POST"},!1,!1,c).then((function(e){store.findRecord(moduleRecordMapping[l].id,n,{approved:"both"}).then((function(e){e[0]&&Lyte.triggerEvent("update_territories",e[0].Territories?e[0].Territories:e[0].Territory?e[0].Territory:void 0)}))}))}else crmTab.deleteFromCache(l),mR(o,(function(e){var t=e.split("###");if("false"!==t){$("#"+i).append(t[1]);var n=$("#"+a);""!=n.text()?(r=n.text()+", "+$ESAPI.encoder().encodeForHTML(t[0]),n.html(r)):n.html($ESAPI.encoder().encodeForHTML(t[0]));var s=$("#seTerritoryCount").val();s=parseInt(s)+1,("Potentials"==l&&""!=e||s>=Crm.userDetails.TERRITORIES_PER_RECORD)&&$(".show-panel").hide(),$("#seTerritoryCount").val(s),refreshFollowDiv()}}),d),getElemById("seterritories").style.display="";this.cancelTerritoryPopup("topBandPopup")},Territory.removeManually=function(e){var t=$("#id").val(),a=$("#module").val(),i=$("#entityName").val(),r=this.territoryAction+"manualDelete",l="territoryId="+e+"&seId="+t+"&entityname="+encodeURIComponent(i)+"&module="+a+"&"+this.csrf();mR(r,(function(t){if(0!=t){$("#tr_"+e).remove(),crmTab.deleteFromCache(a);var i=[],r=0;$("#territoryprops tr.remove").each((function(){i[r]=$(this).find("div:first").text(),r++}));var l=i.join(", ");$("#seterritories").text(l);var n=$("#seTerritoryCount").val();n=parseInt(n)-1,("Potentials"==a||n<Crm.userDetails.TERRITORIES_PER_RECORD)&&$(".show-panel").show(),$("#seTerritoryCount").val(n)}}),l)},Territory.setTerritoryValue=function(e,t,a,i){removeFreezeLayer(),$("#"+a).val(e),$("#"+i).val(t),this.cancelTerritoryPopup("topBandPopup"),Territory.checkParentOrg()},Territory.checkParentOrg=function(){var e=getElemById("orgterrid").value,t=getElemById("parentId").value;getElemById("viewparentrule").style.visibility=t===e?"hidden":"visible"},Territory.showTerritoryPopup=function(e){var t=$("#profileEditPopup");crmui.showPopup(e,!0),"removeUser"==e&&t.is(":visible")&&t.css("z-index","10")},Territory.cancelTerritoryPopup=function(e){if($("#"+e).hasClass("zcrm-effect"))hideAnimatePopup(e);else{crmui.hidePopup(e);var t=$("#profileEditPopup");"removeUser"==e&&t.is(":visible")&&t.css("z-index","249")}this.isValidated=!1},Territory.disableTerritoryUsingKey=function(e,t){if(8==e.keyCode&&""==$("#territorysearch").val()){var a=$("#"+t).find("li:visible:last");if("background-image:none;"==a.attr("style")){var i=a.attr("id");i=i.replace("li",""),a.removeAttr("style"),"territories"==t?this.deleteTerritoriesFromCriteria(i,e):this.removeterritory(i,e)}else a.attr("style","background-image:none;")}},Territory.deleteTerritoriesFromCriteria=function(e,t){return $("#li"+e).remove(),$("#"+e).addClass("active").removeClass("sel").show(),$("#child label").hasClass("disabled")&&($("#child label").removeClass("disabled"),$("#child input").prop("disabled",!1),$("#child input").prop("checked",!1)),predefined=!1,t&&stopEvent(t),!1},Territory.setTerritoryValues=function(){for(var e=$("#territories li"),t="",a=0;a<e.length;a++){t+=e[a].id.replace("li","")+","}t=t.substr(0,t.length-1);var i=getElemById("includechild");i&&1==i.checked&&(i.value=1),$("#territoryids").val(t)},Territory.setTarget=function(){for(var e="",t="",a=$("#individualTarget input"),i=0;i<a.length;i++){var r=a[i],l=r.id;if(!numValidate(r.id,"target",""))return!1;e+=l.replace("user_","")+";",t+=r.value+";"}return $("#indiviualUsers").val(e),$("#indiviualTargets").val(t),!0},Territory.childTerritoryTarget=function(){for(var e="",t="",a="",i="",r=$("#childTerritory tr input[type='text']"),l=0;l<r.length;l++){var n=r[l],s=n.id;if(!numValidate(n.id,"target",""))return!1;if(-1!=s.indexOf("target"))a+=s.replace("target_","")+";",i+=n.value+";";else if(-1!=s.indexOf("manager")){var o=$("#"+s).attr("array");e=s.replace("manager"+o+"_",""),t=n.value,o=parseInt(o)+1,$("#childTerritoryUsers"+o).val(e),$("#usersTarget"+o).val(t)}}return $("#childTerritories").val(a),$("#childTargets").val(i),!0},Territory.assignTargetstoArray=function(){var e=$("#index").val();e=parseInt(e);for(var t=childArr[e],a=t[0],i=t[1],r=$("#userTarget input"),l=0;l<r.length;l++){var n=r[l],s=n.id;if(!numValidate(n.id,"target",""))return!1;s=s.replace("userTarget_",""),a[l]=s,i[l]=n.value}t[0]=a,t[1]=i,childArr[e]=t;var o=$("#actionval").val();$("#"+o).hide()},Territory.showUsers=function(e,t){$("#childMembers").html("");var a=$(e).offset(),i=a.left,r=a.top,l=getElemById(t);l.style.display="",l.style.left=i-200+"px",l.style.top=r+23+"px";var n=e.getAttribute("array"),s=JSON.parse(e.getAttribute("data-userinfo")),o=Territory.usersTemplate(s);if($("#childMembers").append(o),$("#index").val(n),null!=childArr[n])for(var d=childArr[n],c=(d[0],d[1]),m=d[2],u=d[3],p=$("#userTarget input"),g=0;g<p.length;g++){var v=p[g],h=m[g]?m[g]:"",f=u[g]?u[g]:"";v.setAttribute("pre-data",f),v.setAttribute("cur-data",h),null==c[g]||""==c[g]?v.value="":v.value=c[g]}},Territory.showPreviousTarget=function(e,t){stopEvent(t);var a=$(e).position(),i=a.left,r=a.top,l=getElemById("suggestDetails");if(l.style.display="",$(e).hasClass("fromTemp")){var n=$("#actionval").val(),s=$("#"+n).position();i=s.left+i,r=s.top+r}if(l.style.left=i+40+"px",l.style.top=r-26+"px",Crm.userDetails.RTL_ENABLED){var o=$("#suggestDetails").outerWidth();l.style.left=i-o+"px",l.style.top=r-26+"px"}var d=$(e).prev("input[type=text]").attr("cur-data"),c=$(e).prev("input[type=text]").attr("pre-data");if(null!=d&&""!=d?(d=JSON.parse(d),$("#current_pipe").html(d.pipeline),$("#current_achieved").html(d.closed)):($("#current_pipe").html(0),$("#current_achieved").html(0)),null!=c&&""!=c){c=JSON.parse(c);var m=this.getFcNamesAsOptions(c);$("#fcName").append(m).addClass("newSelect");var u=$("#previous").val();this.changePrevDetails(u,c)}else $("#previous_target").html(0),$("#previous_achieved").html(0),$("#previous_pipe").html(0)},Territory.changePrevDetails=function(e,t){var a=t[e];if(null!=a){var i=a.target?a.target:0,r=a.closed?a.closed:0,l=a.pipeline?a.pipeline:0;$("#previous_target").html(i),$("#previous_achieved").html(r),$("#previous_pipe").html(l)}else $("#previous_target").html(0),$("#previous_achieved").html(0),$("#previous_pipe").html(0)},Territory.getFcNamesAsOptions=function(e){var t=e.sortedList;$("#previous").remove();for(var a=document.createElement("select"),i=document.createElement("option"),r=$(a).attr({id:"previous"}),l=0;l<t.length;l++){var n=t[l];r.append($(i).clone().attr({value:n}).text(n))}return r.change((function(){Territory.changePrevDetails(this.value,e)})),r},Territory.saveForecast=function(e,t){if(!this.setTarget())return!1;if(!this.childTerritoryTarget())return!1;if(getElemById(t)&&!numValidate(t,"target",""))return!1;$("#saveForeBut").prop("disabled",!0);for(var a=$("#childTerritory a"),i="",r="",l=0;l<a.length;l++){var n=a[l].id,s=$("#"+n).attr("array");if(null!=childArr[s]){var o=childArr[s];i=o[0].join(";"),r=o[1].join(";")}s=parseInt(s)+1,$("#childTerritoryUsers"+s).val(i),$("#usersTarget"+s).val(r)}return"CreateForecast"==getAttr(e,"name")&&Crm.trackSpotLightAction("Forecast Created"),this.doUpdateForm("show",e,!0,!0),getElemById("fclookup")&&this.cancelTerritoryPopup("fclookup"),!1},Territory.cancelTerrMembersTarget=function(){var e=$("#actionval").val();$("#"+e).hide()},Territory.cancelDiv=function(){getElemById("fclookup")?(this.cancelTerritoryPopup("fclookup"),this.cancelTerrMembersTarget()):window.history.back()},Territory.computeForecast=function(e,t,a){var i;i=t?this.rolefcAction:this.forcastAction,i+="compute";var r="fcYear="+$("#fcYear").val()+"&fcQuarter="+$("#fcQuarter").val()+"&module=Forecasts&isload=false";r+=t?"&roleId=":"&territoryId=",r+=e+"&"+this.csrf(),null!=a&&1==a&&(r+="&computeForAll=true"),mR(i,(function(e){var t=getElemById("show");$(t).empty(),t.innerHTML=e,EvalInnerScript(t)}),r)},Territory.editForecastSetting=function(e,t){var a;t?Lyte.Router.transitionTo({route:"crm.tab.forecasts.editSettings"}):(a=e?this.rolefcAction:this.forcastAction,a+="forecastSettings&module=Forecasts&isload=false",ajaxNew(a))},Territory.cancelFCAction=function(e,t){var a;t?window.history.back():(a=e?this.rolefcAction:this.forcastAction,a+="startPage&module=Forecasts&isload=false",ajaxNew(a))},Territory.showParamConfirmation=function(e){var t=$("#forecastField option:selected").text(),a=$("#targetPeriod option:selected").text(),i=[];i.push($ESAPI.encoder().encodeForHTML(t)),i.push(a);var r=e?"crm.forecast.param.change.note2":"crm.label.forecast.settings.note";r=I18n.getMsg(r,I18n.getMsg(i,Crm.moduleInfo.Leads.translatedSingularLabel)),$("#confirmmsg").html(r),this.showTerritoryPopup("forecastsettingpopup")},Territory.addForecastToHistory=function(e){var t={mode:$("#mode").val(),fcYear:$("#fcYear").val(),fcQuarter:$("#fcQuarter").val()};"territoryId"==e?t.territoryId=$("#territoryId").val():t.roleId=$("#roleId").val(),Lyte.Router.transitionTo({route:"crm.tab.forecasts.index",queryParams:t}).data={cachedResponse:$("#show").val()}},Territory.viewChildForecast=function(e,t,a,i){var r={};t=null==t?$("#"+e).val():t,i=null==i?$("#mode").val():i,a=null==a&&null!=i&&"viewUser"==i?$("#ownerId").val():a,"territoryId"==e?r.territoryId=t:r.roleId=t,null!=a&&""!=a&&(r.ownerId=a),r.fcYear=$("#fcYear").val(),r.fcQuarter=$("#fcQuarter").val(),r.mode=i,Lyte.Router.transitionTo({route:"crm.tab.forecasts.index",queryParams:r})},Territory.setQuota=function(e,t,a){var i={};"setTarget"==t?(i.fcYear=$("#fcYear").val(),i.fcQuarter=$("#fcQuarter").val(),"TerritoryForecast"==e?i.territoryId=$("#territoryId").val():i.roleId=$("#roleId").val(),Lyte.Router.transitionTo({route:"crm.tab.forecasts.create",queryParams:i})):Lyte.Router.transitionTo({route:"crm.tab.forecasts.create"}).data={action:e}},Territory.showPipeline=function(e,t,a,i,r,l){var n={};null!=a&&""!=a&&(n.ownerId=a),null!=r&&"true"==r&&(n.isParent=r),null!=i&&1==i&&(n.closed="true"),null!=l&&1==l&&(n.others="true"),1==e?n.roleId=t:n.territoryId=t,n.fcYear=$("#fcYear").val(),n.fcQuarter=$("#fcQuarter").val(),n.parModule="Forecasts";var s=localStorage.getItem("rangeValueForPipeline");s&&!isNaN(parseInt(s))&&(n.rangeValue=s),Lyte.Router.transitionTo({route:"crm.tab.forecasts.pipeline",queryParams:n})},Territory.editForecast=function(e,t,a,i,r){var l,n=$("#mode").val(),s=$("#fcYear").val(),o=$("#fcQuarter").val();l=null!=i&&1==i?this.rolefcAction+"editRoleForecast&roleId=":this.forcastAction+"editTerritoryForecast&territoryId=",l+=t+"&fcYear="+s+"&fcQuarter="+o+"&mode="+a+"&prevMode="+n+"&module=Forecasts",null!=r&&(l=l+"&prevTerritoryId="+r),mR(l,(function(t){if("NO_CHILDS"==trimBoth(t))$(e).hide();else if("NO_USERS"==trimBoth(t))$(e).hide();else{freezeBackground(),$("#fclookup").empty(),getElemById("fclookup").innerHTML=t,EvalInnerScript(getElemById("fclookup"));var a=getElemById("childContainer"),i=getElemById("individualContainer");a?(a.style.height="350px",a.style.overflow="auto",getElemById("childTerritory").style.width="97%"):i&&(i.style.height="350px",i.style.overflow="auto"),$("#fclookup").addClass("ppTop is-scroll"),crmui.showPopup("fclookup")}}))},Territory.adjustWidth=function(e){if(getElemById(e)){var t=$("#"+e).width();(t=0==$("#"+e).val().length?25:6*$("#"+e).val().length+10)>425&&(t=440),$("#"+e).css("width",t+"px")}},Territory.toShowDefaultValue=function(e,t){t=null==t?"territorysearch":t,0==e&&($("#"+t).val($("#"+t).attr("data-holder")),this.adjustWidth(t))},Territory.getNamesAndConcat=function(e,t){for(var a=[],i=$("input[name=chk]:checked"),r=0;r<i.length;r++){var l=i[r],n=$(l).attr(e);a.push(n)}return{nameList:a.join(t)}},Territory.createBulkTask=function(){var e=this.getNamesAndConcat("pot-name","&&##"),t="&secmod="+$("#module").val()+"&bulkCreate=bulkTask&actType=Tasks&idlist="+$("#id").val()+"&namelist="+encodeURIComponent(e.nameList);t=t+"&crmcsrfparam="+csrfToken;var a=Crm.getCrmBasePath()+"/QCreate.do?module=Tasks&fromCreate=QuickCreate";mR(a,(function(e){0!==$("#qCreate").length&&(freezeBackground(),$("#FreezeLayer").css("opacity",".1")),renderingUtils.ShakeDivInfreeze("qCreate","left",20,100),$("#qCreate").empty(),$("#qCreate")[0].innerHTML=e;var t=$("#qCreate");t.css("display","block");var a=getElemById("pipelinebut"),i=findPosX(a),r=findPosY(a);t[0].style.left=i+106+"px",t[0].style.top=r-28+"px",EvalInnerScript(t[0]),$(".qcpopuparrow").addClass("qcLeft").removeClass("qcRight")}),t)},Territory.sendBulkMail=function(){var e=getElemById("module").value;if(1==getNoOfSelected(document.TransferWizardForm)){var t=this.getNamesAndConcat("data-owner",";");openPopUp("entreplyWin",this,Crm.getOrgSpecificURL(Crm.getCrmBasePath()+"/mailer/EntReply.do?action=sendReminder&userIds="+t.nameList+"&module="+e+"&entId="+getElemById("id").value),"entsend",1335,666,"toolbar=no,statusbar=no,menubar=no,directories=no,resizable=yes,scrollbars=yes")}else{var a=getElemById("id").value;getElemById("idlist").value=a;var i=Crm.getCrmBasePath()+"/ShowTemplates.do?idlist="+a+"&module="+e+"&remainderMail=true",r=getElemById("massMailstatsPop");$(r).empty(),r.style.display="block",r.style.zIndex=100,showAnimatePopup("massMailstatsPop"),mR(i,(function(e){$(r).empty(),r.innerHTML=e,manipulateScriptElems(r)}))}},Territory.constructOptionsForQuarter=function(e,t){if("none"!=e){for(var a,i=t[e],r=$("#fcQuarter").val(),l=0;l<i.length;l++){var n=i[l].split("##");r==n[1]?a+="<option value='"+n[1]+"' Selected >":a+="<option value='"+n[1]+"'>",a+=n[0]+"</option>"}$("#fcQuarter option[value=none]").nextAll().remove(),$("#fcQuarter option[value=none]").after(a)}},Territory.createForecast=function(e,t,a){var i="",r=$("#fcYear").val(),l=$("#fcQuarter").val(),n=$("#"+t).val();null!=r&&null!=l&&null!=n&&"none"!=r&&"none"!=l&&"none"!=n&&""!=n?(i=a?this.rolefcAction:this.forcastAction,i+="ajaxCall&fcYear="+r+"&fcQuarter="+l+"&"+t+"="+n+"&module="+e):$("#qutoaDIV").empty(),""!=i&&mR(i,(function(e){var t=getElemById("qutoaDIV");$(t).empty(),t.innerHTML=e,EvalInnerScript(t)}))},Territory.changeFcOwner=function(e,t,a,i){var r=a,l=Crm.getCrmBasePath()+"/Role.do?action=changeManager",n="roleId="+i+"&fctownerId="+e+"&"+this.csrf();(new crmRequestPool).doAjax(l,(function(l){if("true"==l&&($("#owner"+i).text(t),$("#"+a).data("ownerid",e),r.indexOf("addManager")>-1)){var n=r.replace("addManager","changeManager");$("#"+r).addClass("changeUserIcon floatL fbllink f12 lh38 mT10 svgIcons ico-search-users changeIconTerritoryNew").attr("id",n)}}),n,(function(e){555==e.status&&renderingUtils.showCustomAlert(e.responseText)}))},Territory.changeManager=function(e,t,a,i){var r="",l=a,n=this.territoryAction+"changeManager",s="userId="+e+"&territoryId="+i+"&"+this.csrf();(new crmRequestPool).doAjax(n,(function(n){if("true"==n){var s=$ESAPI.encoder().encodeForJavaScript(t);if($("#owner"+i).text(t).attr("onmouseover",'crmui.toolTip_show(this,"center","'+s+'");'),$("#"+a).data("ownerid",e),l.indexOf("addManager")>-1){var o=l.replace("addManager","changeManager");r=I18n.getMsg("crm.territory.add.manager.success.msg"),$("#"+l).addClass("changeUserIcon floatL fbllink f12 lh38 mT10 svgIcons ico-search-users changeIconTerritoryNew").attr("id",o)}else r=I18n.getMsg("crm.territory.change.manager.success.msg");crmui.showMsgBand("success",r,2e3,"")}}),s,(function(e){555==e.status&&renderingUtils.showCustomAlert(e.responseText)}))},Territory.setParamsForPipeline=function(){var e="";getElemById("territoryId")?e="&territoryId="+getElemById("territoryId").value:getElemById("roleId")&&(e="&roleId="+getElemById("roleId").value),getElemById("ownerId")&&(e+="&ownerId="+getElemById("ownerId").value);var t=getElemById("isParent");e+=t?"&isParent="+t.value:"",e+="&fcYear="+getElemById("fcYear").value+"&fcQuarter="+getElemById("fcQuarter").value+"&frmidx="+getElemById("frmidx").value+"&toidx="+getElemById("toidx").value+"&rangeValue="+getElemById("rangeValue").value,this.currentInfo.pipelineInfo=e},Territory.showTerritoryFilter=function(e,t){if("none"==$("#territoryfilter").css("display")){var a=$("#territoryfilter,#cvbutton").slideDown(500);setTimeout((function(){a.stop(!0,!0).show()}),400);var i=$("#criteria,#displayrecords").slideUp(500);setTimeout((function(){i.stop(!0,!0).hide()}),400);var r=$("#customviewselect").fadeOut(500);setTimeout((function(){r.stop(!0,!0).hide()}),400)}},Territory.showCriteria=function(){if("none"==$("#criteria").css("display")){$("#criteria,#cvbutton").slideDown(500);var e=$("#customviewselect").fadeOut(500);setTimeout((function(){e.stop(!0,!0).hide()}),400);var t=$("#territoryfilter,#displayrecords").slideUp(500);setTimeout((function(){t.stop(!0,!0).hide()}),400)}},Territory.removeterritory=function(e,t){$("#territorysearch").autocomplete("close"),$("#"+e).removeClass("dN");var a=$("#territoryuserIds").val(),i=getElemById("li"+e);if(i){i.style.display="none";for(var r=(a=a.substr(0,a.length-1)).split(";"),l=0;l<r.length;l++)r[l]==e&&i.setAttribute("remove","yes")}return stopEvent(t),!1},Territory.setUserValues=function(){for(var e=$("#territoryUserDropdown").find("ul").find("li"),t="",a="",i=e.length,r=0;r<i;r++){var l=e[r],n=$(l).data("value");"yes"==l.getAttribute("remove")?a+=n+";":""==l.style.display&&(t+=n+";")}var s=$("#old_ownerId").val();""!=s&&-1==t.indexOf(s+";")&&(t+=s);n=$(l).data("value");$("#removeduserIds").val(a),$("#territoryuserIds").val(t)},Territory.changeOwner=function(){var e=$("#territoryManagerDropdown")[0].component.getData("cxPropSelectedUser");e&&($("#territoryOwnerName").val(e.full_name),$("#ownerId").val(e.id))},Territory.checkTerritory=function(){this.setUserValues();var e=$("#removeduserIds").val();return"block"==getElemById("removeUser").style.display?(this.setRemoveUserValues(";"),!0):null==e||""==e},Territory.showRemoveUsersPopup=function(){var e=$("#removeduserIds").val(),t=$("#territoryId").val();if(null!=e&&null!=t&&""!=e){var a="",i=$("#old_ownerId").val();null!=i&&""!=i&&(a="&managerId="+i);var r=Territory.territoryAction+"removeUsers&userId="+e+"&territoryId="+t+a;mR(r,(function(e){if("false"==e)return Territory.doUpdateForm("result",document.TerritoryForm,!0,!1),!1;$("#removepopup").html(e),Crm.userDetails.RTL_ENABLED&&$("#removeUser .select").addClass("chosen-rtl"),thirdPartyUtils.bindSelect2("#removeUser .select"),$(".chosen-single").css("width","190px"),$(".chosen-drop").css("width","198px"),$(".chosen-search input").css("width","163px"),Territory.showTerritoryPopup("removeUser")}))}},Territory.catchEnter=function(e){$("#"+e).keypress((function(e){13==e.which&&e.preventDefault()}))},Territory.setRemoveUserValues=function(e){var t="";if(getElemById("removepopup"))for(var a=$("#removepopup .select"),i=0;i<a.length;i++){var r=a[i];r.id.replace("change_","");t+=r.value+e}$("#newOwnerIds").val(t),hide("removeUser")},Territory.showCvDiv=function(){if("none"==$("#customviewselect").css("display")){var e=$("#customviewselect").fadeIn(500);setTimeout((function(){e.stop(!0,!0).show()}),400);var t=$("#criteria,#displayrecords,#cvbutton,#territoryfilter").slideUp(500);setTimeout((function(){t.stop(!0,!0).hide()}),400),$("#cvid").val(""),$(".SelectedOption").text(I18n.getMsg("crm.select"))}},Territory.showChilds=function(e){var t=$(e).offset(),a=$(e).next("div");a.css({top:t.top-84}),a.show(),a.one("mouseenter",(function(){$(this).show()})).one("mouseleave",(function(){$(this).hide()}))},Territory.hideChild=function(e){$(e).next("div").hide()},Territory.setUserTerritoryValues=function(){for(var e=$("#managedids").val(),t=(e=e.substr(0,e.length-1)).split(","),a=0;a<t.length;a++)$("#check"+t[a]).prop("checked",!0).prop("disabled",!0);for(var i=$("#userTerritoryIds").val(),r=(i=i.substr(0,i.length-1)).split(","),l=0;l<r.length;l++){var n=r[l];$("#check"+n).prop("checked",!0)}},Territory.getCvRecords=function(){var e=$("#cvid").val();if(null!=e&&""!=e)return this.doUpdateForm("result",document.AssignmentRuleForm,!0,!0),!1;var t=$("#displayrecords").slideUp(500);setTimeout((function(){t.stop(!0,!0).hide()}),400)},Territory.validateAssignment=function(e){var t;return this.setTerritoryValues(),$("#criteria:visible").length?(t=Search.getCriteriaDetails())?($("#criteriajson").val(""),Territory.doUpdateForm("result",document.AssignmentRuleForm,!0,!1,void 0,t),!1):(renderingUtils.stopEvent(event),!1):(e=null==e||e,this.doUpdateForm("result",document.AssignmentRuleForm,!0,e),!1)},Territory.runRule=function(){$("#runrule").val("true"),this.cancelTerritoryPopup("assignmentRuleMsg"),this.validateAssignment(!1)},Territory.showTerritorySuggest=function(e,t,a,i){var r=$(e).val().trim().toLowerCase(),l=getElemById(i),n=getElemById("noMoreTerritory"),s=$("#"+a+" a.active, a.search"),o=0;currSechExtMatCnt=0;for(var d=0;d<s.length;d++){var c=s[d],m=c.innerHTML.toLowerCase();""==r||-1!=m.indexOf(r)?($(c).addClass("active").removeClass("search").show(),l&&(l.style.display="none"),o++,m.trim()===r&&currSechExtMatCnt++):$(c).removeClass("active").addClass("search").hide()}0==o&&l&&n&&"block"!=n.style.display&&(l.style.display="")},Territory.doHighLight=function(e,t,a,i){if(t||(t=curElem),t.length){if(e)var r=$(e);else{a=0;r=$(resultsObj)}i||(i=315);var l=r.scrollTop(),n=i+l,s="rightPanelInfo"===r.attr("id")?t.offset().top:t.position().top,o=(s=s+l-a)+t.outerHeight()+a;o>=n?r.scrollTop(o-i>0?o-i:0):s<l&&r.scrollTop(s)}},Territory.key_up=function(){var e;showing?curElem&&(e=curElem.prevAll("a.active").first()).length>0&&(curElem.removeClass("hoverhighlight"),curElem=e,curElem.addClass("hoverhighlight"),this.doHighLight()):this.showResults()},Territory.key_down=function(){var e;showing?curElem&&!isFirst&&(e=curElem.nextAll("a.active").first()).length>0&&(curElem.removeClass("hoverhighlight"),curElem=e,curElem.addClass("hoverhighlight"),this.doHighLight()):this.showResults()},Territory.addSelected=function(){if(curElem&&curElem.length){var e=curElem.attr("id");if(getElemById("li"+e))isFirst=!0;else{var t=curElem.text(),a={TERRITORYID:e,NAME:t};if($("#territories").hasClass("mT20")||$("#territories").addClass("mT20"),e<=0){var i=$("#territories li"),r=i.length;if(r>0){if(!confirm(I18n.getMsg("crm.alert.territory.pre.views",I18n.getMsg(t))))return!1;for(var l=0;l<r;l++){var n=i[l].id.replace("li","");this.deleteTerritoriesFromCriteria(n)}this.showTerritories(e,a),$(resultsObj).hide(),showing=!1}else this.showTerritories(e,a);predefined=!0,$("#child label").addClass("disabled"),$("#child input").prop("disabled",!0)}else $("#child label").hasClass("disabled")&&($("#child label").removeClass("disabled"),$("#child input").prop("disabled",!1)),this.showTerritories(e,a),predefined=!1}}},Territory.showTerritories=function(e,t){$("#"+e).removeClass("active hoverhighlight search").addClass("sel").hide(),$("#territories").append(Territory.terrTemplate(t))},Territory.showResults=function(){predefined||($(resultsObj).show(),showing=!0,0==$("#territorydrop a:visible").length?$("#noMoreTerritory").show():$("#noMoreTerritory").hide())},Territory.registerEvents=function(e,t,a){var i=$(e),r=$(t),l=$(a);i.on("click",(function(){Territory.showResults()})),l.on("focus",(function(){Territory.showResults()})),l.on("blur",(function(){curElem&&curElem.length&&(curElem.removeClass("hoverhighlight"),isFirst=!0)})),l.on("keydown",(function(e){Territory.eventChecker(e,t.id)})),l.on("keyup",(function(e){Territory.showTerritorySuggest(this,e,"territorydrop","noMatchUsers")})),r.on("mouseenter",(function(e){var t,a=e.target;(t=$(a).hasClass("active")?$(a):$(a).parents(".active").first()).length&&(curElem=t,curElem.addClass("hoverhighlight"))})),r.off("click").on("click",(function(e){var a,i=e.target;(a=$(i).hasClass("active")?$(i):$(i).parents(".active").first()).length&&showing&&(curElem=a,Territory.addSelected(),$(t).hide(),showing=!1)})),r.on("mouseleave",(function(e){target=$(e.target).hasClass("active")?$(e.target):$(e.target).parents(".active").first(),target&&curElem.removeClass("hoverhighlight")}))},Territory.hideRows=function(){for(var e=$("#territories li"),t=e.length,a=0;a<t;a++){var i=e[a].id.replace("li","");$("#"+i).removeClass("active hoverhighlight search").addClass("sel").hide(),i<=0&&(predefined=!0,$("#child label").addClass("disabled"),$("#child input").prop("disabled",!0))}},Territory.showTerritoryList=function(e,t,a){containerObj=getElemById(e),resultsObj=getElemById(t),searchObj=getElemById(a),bindEvents||(this.registerEvents(containerObj,resultsObj,searchObj),bindEvents=!0,Territory.showResults())},Territory.registerOverEvents=function(){$(".selDumy").mouseenter((function(){$(this).addClass("forecastHovr"),$(this).mouseleave((function(){$(this).removeClass("forecastHovr")}))}))},Territory.eventChecker=function(e,t){switch(e.keyCode){case 38:e.preventDefault(),Territory.key_up();break;case 40:e.preventDefault(),Territory.key_down();break;case 13:showing&&(Territory.addSelected(),curElem=curElem.nextAll("a.active").first(),0==curElem.length&&(curElem=curElem.prevAll("a.active").first()),curElem.addClass("hoverhighlight"),$(resultsObj).hide(),showing=!1)}isFirst&&(curElem=$("#"+t+" a:visible").first(),curElem.addClass("hoverhighlight"),isFirst=!1)},Territory.showOrHideTerritoryRule=function(e){(e=$(e)).hasClass("viewRule")?(e.removeClass("viewRule").html(I18n.getMsg("crm.territory.hide.rule")),e.closest("li").children().find(".terroritoryRulesDropdown:first").slideDown(),e.parent().prev("a").addClass("crm-font-bold")):(e.parent().prev("a").removeClass("crm-font-bold"),e.addClass("viewRule").html(I18n.getMsg("crm.territory.view.rule")),e.closest("li").children().find(".terroritoryRulesDropdown:first").slideUp())},Territory.initAutoComplete=function(){thirdPartyUtils.bindSelect2("#access"),$("body").off("click").click((function(e){e.target&&"terrDIV"!==e.target.id&&e.target.parentNode&&"territoryuser"!==e.target.parentNode.id&&($("#containerDIV").addClass("dN"),Territory.toShowDefaultValue($("#territoryuser li:visible").length))})),Territory.toShowDefaultValue($("#territoryuser li:visible").length)},Territory.showTerritoryDropdown=function(e,t){sE(t),$(".showAct").removeClass("borAct"),$(e).find(".showAct").addClass("borAct"),$("#territoryDropdown").show();var a=getElemById("optionsHolder");a&&"block"===a.style.display&&CustomView.hideDropdown(a)},Territory.removeTerrLookup=function(e){this.cancelTerritoryPopup(e),$("#territoryLookup").remove()},Territory.showForecastDelMessage=function(e,t,a,i,r){var l,n=[];if(n.push($("#fcQuarter").find("option[selected]").text()),n.push($("#fcYear").val()),n.push(moduleRecordMapping.Forecasts.singular_label),i){var s=$(a).closest("tr");Territory.delForecastDet={deletedObj:s,roleOrTerritoryId:r,forecastId:i},n.push(e),n.push($ESAPI.encoder().encodeForHTML(t)),$("#deletedCheck").css("display",""),l=I18n.getMsg("crm.warning.remove.deleted.forecast",n),$("#warningMsg").next("ul").css("display","none")}else Territory.delForecastDet=void 0,$("#deletedCheck").css("display","none"),l=I18n.getMsg("crm.warning.delete.organisation.forecast",n),$("#warningMsg").next("ul").css("display","");freezeBackground(),$("#Warningdiv").css({display:"block",zindex:98}),mailsetCenter("Warningdiv"),$("#showDeleteName").text(t),$("#warningMsg").html(l)},Territory.deleteForecast=function(e){var t=JSON.parse($(e).attr("data-params")),a=Crm.getCrmBasePath()+"/"+$(e).attr("data-fctype")+".do",i=1;Territory.delForecastDet&&(i=2,$("#deleteAllForecasts").prop("checked")&&(i=3),t.roleOrTerritoryId=Territory.delForecastDet.roleOrTerritoryId,t.forecastId=Territory.delForecastDet.forecastId),t.deleteMode=i,t.crmcsrfparam=encodeURIComponent(csrfToken),mR(a,(function(e){Territory.updateForecastValues(i,e)}),t,(function(e){alert("Unable to process the request")}))},Territory.updateForecastValues=function(e,t){if(1===e){var a=getElemById("show");$(a).empty(),a.innerHTML=t,EvalInnerScript(a)}else{var i=Territory.delForecastDet.deletedObj.siblings("tr").length;if(1===i)Territory.delForecastDet.deletedObj.parents("table").eq(1).remove();else if(3===i||2===i)Territory.delForecastDet.deletedObj.remove(),$("#totalProp").remove();else{var r,l,n=Territory.getCurrencyObj($("#target").text()),s=Territory.getForecastValues(n,Territory.delForecastDet.deletedObj),o=Territory.getForecastValues(n);for(var d in o)o[d]=o[d]-s[d];if(o.target>0){r=o.closed/o.target*100;var c=o.target-o.closed-o.pipeline;$("#quotaPercent").text(r.toFixed(1)),c>0&&(l=c/o.target*100,$("#shortPercent").text(l.toFixed(1)))}o=Territory.formatNumtoCurrency(o,n),$("#target").text(o.target),$("#pipeline").text(o.pipeline),$("#closed").text(o.closed),Territory.delForecastDet.deletedObj.remove()}Territory.delForecastDet=void 0}$("#Warningdiv").css("display","none"),removeFreezeLayer()},Territory.getForecastValues=function(e,t){var a={},i=t?$(t).find("td"):$("#totalProp").find("td");return a.target=i.eq(1).text().trim(),a.closed=i.eq(2).text().trim(),a.pipeline=i.eq(3).text().trim(),a=Territory.formatCurrencytoNum(a,e)},Territory.formatNumtoCurrency=function(e,t){var a=t.decimals,i=t.symbol,r=t.format.split("|")[0],l=t.format.split("|")[1];for(var n in e){var s=e[n]||0,o=parseInt(s=Math.abs(s||0).toFixed(a),10)+"",d=(d=o.length)>3?d%3:0;e[n]=i+(d?o.substr(0,d)+r:"")+o.substr(d).replace(/(\d{3})(?=\d)/g,"$1"+r)+(a?l+Math.abs(s-o).toFixed(a).slice(2):"")}return e},Territory.formatCurrencytoNum=function(e,t){var a=t.format.split("|"),i="[\\"+a[0]+"]";for(var r in i=new RegExp(i,"g"),e){var l=0,n=e[r];n&&(n=(n=n.replace(t.symbol,"").replace(i,"").replace(a[1],".")).replace(new RegExp("[-]\\s*"),"-"),n=parseFloat(n),l=isNaN(n)?0:n.toFixed(t.decimals)),e[r]=l}return e},Territory.showOrHideDelIcon=function(e,t){$(e).children("a").eq(0).toggle(t)},Territory.getCurrencyObj=function(e){var t={};if(t.format=",|.",t.decimals=2,Crm.userDetails.defaultOrgCurrency&&Crm.userDetails.DEFAULT_ORG_CURRENCY?(t.symbol=Crm.userDetails.defaultOrgCurrency,Crm.userDetails.DEFAULT_ORG_CURRENCY&&Crm.userDetails.DEFAULT_ORG_CURRENCY.format&&(t.format=Crm.userDetails.DEFAULT_ORG_CURRENCY.format)):Crm.userDetails.BASE_CURRENCY&&Crm.userDetails.CURRENCY_DETAILS[Crm.userDetails.BASE_CURRENCY]&&(t=Crm.userDetails.CURRENCY_DETAILS[Crm.userDetails.BASE_CURRENCY]),void 0!==Crm.userDetails.defaultRoundOff&&(t.decimals=parseInt(Crm.userDetails.defaultRoundOff)),!t.symbol&&e){var a=(e=e.trim()).match(/^.*?(?=[0-9])/);t.symbol=a[0]}return t};var CrmPageLayout=CrmPageLayout||{};CrmPageLayout.profileDetails=CrmPageLayout.profileDetails?CrmPageLayout.profileDetails:{},CrmPageLayout.layoutIdNameMap=CrmPageLayout.layoutIdNameMap?CrmPageLayout.layoutIdNameMap:{},CrmPageLayout.allLayoutIdNameMap=CrmPageLayout.allLayoutIdNameMap?CrmPageLayout.allLayoutIdNameMap:{},CrmPageLayout.usedLayoutNames=CrmPageLayout.usedLayoutNames?CrmPageLayout.usedLayoutNames:{},CrmPageLayout.profileIdVSDefaultLayout=CrmPageLayout.profileIdVSDefaultLayout?CrmPageLayout.profileIdVSDefaultLayout:{},CrmPageLayout.newProfileIdVSDefaultLayout=CrmPageLayout.newProfileIdVSDefaultLayout?CrmPageLayout.newProfileIdVSDefaultLayout:{},CrmPageLayout.profileLayoutTypeMap=CrmPageLayout.profileLayoutTypeMap?CrmPageLayout.profileLayoutTypeMap:{},CrmPageLayout.profileVSLayout=CrmPageLayout.profileVSLayout?CrmPageLayout.profileVSLayout:{},CrmPageLayout.layoutVsWizard=CrmPageLayout.layoutVsWizard?CrmPageLayout.layoutVsWizard:{},CrmPageLayout.profileVsWizard=CrmPageLayout.profileVsWizard?CrmPageLayout.profileVsWizard:{},CrmPageLayout.wizardVsName=CrmPageLayout.wizardVsName?CrmPageLayout.wizardVsName:{},CrmPageLayout.layoutOperation=CrmPageLayout.layoutOperation?CrmPageLayout.layoutOperation:void 0,CrmPageLayout.systemLayoutId=CrmPageLayout.systemLayoutId?CrmPageLayout.systemLayoutId:void 0,CrmPageLayout.topVal=CrmPageLayout.topVal?CrmPageLayout.topVal:void 0,CrmPageLayout.editTop=CrmPageLayout.editTop?CrmPageLayout.editTop:[],CrmPageLayout.layoutId=CrmPageLayout.layoutId?CrmPageLayout.layoutId:void 0,CrmPageLayout.newLayoutList=CrmPageLayout.newLayoutList?CrmPageLayout.newLayoutList:{},CrmPageLayout.removedLayoutList=CrmPageLayout.removedLayoutList?CrmPageLayout.removedLayoutList:{},CrmPageLayout.currProfileIdList=CrmPageLayout.currProfileIdList?CrmPageLayout.currProfileIdList:[],CrmPageLayout.newProfileList=CrmPageLayout.newProfileList?CrmPageLayout.newProfileList:[],CrmPageLayout.removedProfileList=CrmPageLayout.removedProfileList?CrmPageLayout.removedProfileList:[],CrmPageLayout.activeLayoutCnt=CrmPageLayout.activeLayoutCnt?CrmPageLayout.activeLayoutCnt:0,CrmPageLayout.totalLayoutCnt=CrmPageLayout.totalLayoutCnt?CrmPageLayout.totalLayoutCnt:0,CrmPageLayout.maxLayoutCnt=CrmPageLayout.maxLayoutCnt?CrmPageLayout.maxLayoutCnt:0,CrmPageLayout.nonStandardSystemGivenLayoutCount=CrmPageLayout.nonStandardSystemGivenLayoutCount?CrmPageLayout.nonStandardSystemGivenLayoutCount:0,CrmPageLayout.module=CrmPageLayout.module?CrmPageLayout.module:void 0,CrmPageLayout.tabId=CrmPageLayout.tabId?CrmPageLayout.tabId:void 0,CrmPageLayout.isMPLAvailable=CrmPageLayout.isMPLAvailable?CrmPageLayout.isMPLAvailable:void 0,CrmPageLayout.isSubformAvailable=CrmPageLayout.isSubformAvailable?CrmPageLayout.isSubformAvailable:void 0,CrmPageLayout.mplOnBoardingStatus=CrmPageLayout.mplOnBoardingStatus?CrmPageLayout.mplOnBoardingStatus:void 0,CrmPageLayout.isMPLInGracePeriod=CrmPageLayout.isMPLInGracePeriod?CrmPageLayout.isMPLInGracePeriod:void 0,CrmPageLayout.isMainMenuHidden=CrmPageLayout.isMainMenuHidden?CrmPageLayout.isMainMenuHidden:void 0,CrmPageLayout.isPrivateFieldAvailable=CrmPageLayout.isPrivateFieldAvailable?CrmPageLayout.isPrivateFieldAvailable:void 0,CrmPageLayout.isHipaaFieldAvailable=CrmPageLayout.isHipaaFieldAvailable?CrmPageLayout.isHipaaFieldAvailable:void 0,CrmPageLayout.createPageLayout=function(e){if("Events"==CrmPageLayout.module||"Calls"==CrmPageLayout.module||"Tasks"==CrmPageLayout.module||"Users"==CrmPageLayout.module){var t="activities";return"Users"==CrmPageLayout.module&&(t="users"),CrmPageLayout.showMsgBand($("#moduleCustomizationDiv"),"alert",I18n.getMsg("crm."+t+".no.layout"),1e3),!1}CrmPageLayout.profileDetails={};var a=null;if(null!=e?a=e:1==CrmPageLayout.activeLayoutCnt&&(a=CrmPageLayout.systemLayoutId),null==a){var i=$(document.createDocumentFragment()),r={},l=[];for(t in CrmPageLayout.layoutIdNameMap)r[CrmPageLayout.layoutIdNameMap[t]]=t,null!=CrmPageLayout.layoutIdDetailsMap[t]&&12===CrmPageLayout.layoutIdDetailsMap[t].source||l.push(CrmPageLayout.layoutIdNameMap[t]);for(var n=(l=l.sort((function(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())}))).length,s=0;s<n;s++){var o=l[s];if(r.hasOwnProperty(o)&&null!=r[o]){var d=r[o],c=$("#layout_"+d);if(c.length>0&&(c.find(".Act").length>0||"JobSheets"==CrmPageLayout.module)||0==c.length){var m=$("<option>",{value:d,text:o});d==CrmPageLayout.systemLayoutId&&m.prop("selected",!0),m.attr("data-zcqa","MPL_layout_"+o),i.append(m)}}}CrmModule.ppFromTop("existLayoutInfoDiv");var u=$("#existLayoutId");u.children().remove().end(),u.append(i)}else{var p=CrmPageLayout.module;Lyte.Router.getRouteInstance().transitionTo("crm.settings.section.modules.module.layouts.clone-layout",p,a)}},CrmPageLayout.showLayoutSettings=function(){CrmModule.hide("existLayoutInfoDiv");var e=CrmPageLayout.module;Lyte.Router.getRouteInstance().transitionTo("crm.settings.section.modules.module.layouts.clone-layout",e,$("#existLayoutId").val())},CrmPageLayout.validateLayoutConfig=function(e){CrmPageLayout.removeErrorAlert();var t=!0,a=$("#disp_LayoutName").val().trim(),i=!1,r=CML.splCharCheckForTab(a),l=!1;if(void 0!==CML.layoutLabelRegex&&CML.layoutLabelRegex.test(a.toLowerCase())&&(l=!0),a.length>0&&(i=CrmPageLayout.checkDuplicateLayoutName(a)),(0==a.length||i||!r||l)&&$.isEmptyObject(CrmPageLayout.profileDetails))(n=$("#disp_LayoutName1")).val(a),r?i?(n.addClass("errFieldBdr"),$("#duplicateErrorTR").show()):l&&($("#layoutErrorDiv").text(I18n.getMsg("crm.label.layoutname.sykw")),n.addClass("errFieldBdr"),$("#duplicateErrorTR").show()):($("#layoutErrorDiv").text(I18n.getMsg("crm.mb.module.splc")),n.addClass("errFieldBdr"),$("#duplicateErrorTR").show()),$("#cm_heading").hide(),$("#mpLabel").text(I18n.getMsg("crm.label.layout.permission.title")),$("#profileNote").text(I18n.getMsg("crm.label.layout.permission.desc")),$("#saveMPBtn").attr("onClick","CrmPageLayout.saveCloneLayoutOnFinalSave("+e+")"),CML.showModuleInfoNPermission("layoutInfonPer","builder",CrmPageLayout.tabId,"edit","save"),$("#proModName").text(""),$("#renameLayoutTable").parent().addClass("pB0").css("margin-bottom","-15px"),t=!1;else if(0==a.length||i||!r){var n;(n=$("#disp_LayoutName1")).val(a),r?i&&(n.val(a),n.addClass("errFieldBdr"),$("#duplicateErrorTR").show()):($("#layoutErrorDiv").text(I18n.getMsg("crm.mb.module.splc")),n.addClass("errFieldBdr"),$("#duplicateErrorTR").show()),CML.showModuleInfoNPermission("layoutInfo","builder",CrmPageLayout.tabId,"edit","save"),$("#saveMPBtn").attr("onClick","CrmPageLayout.saveCloneLayoutOnFinalSave("+e+")"),$("#renameLayoutTable").parent().removeClass("pB0"),t=!1}else $.isEmptyObject(CrmPageLayout.profileDetails)&&($("#profileNote").text(I18n.getMsg("crm.label.layout.permission.desc")),CML.showModuleInfoNPermission("modpermission","builder",a,"edit","save"),$("#proModName").text(a),$("#saveMPBtn").attr("onClick","CrmPageLayout.saveCloneLayoutOnFinalSave("+e+")"),t=!1);return t},CrmPageLayout.saveCloneLayoutOnFinalSave=function(e){var t=!0,a=!0,i=$("#saveMPBtn");i.addClass("inActiveSec");var r=$("#modulePermissionDiv"),l=r.find(".fieldErrMsg");if(void 0!==$("#infoNPermissionDiv").find(".errFieldBdr")&&(r.find(".errFieldBdr").removeClass("errFieldBdr"),l.remove()),!CML.checkIfError())return i.removeClass("inActiveSec"),!1;var n=$("#layoutNameInfoDiv");if(n.is(":visible")){var s=$("#disp_LayoutName1"),o=s.val().trim();0==o.length?(s.addClass("errFieldBdr"),$("#layoutErrorDiv").text(I18n.getMsg("crm.alert.enter.layout.name")),$("#duplicateErrorTR").show(),t=!1):CrmPageLayout.checkDuplicateLayoutName(o)?(s.addClass("errFieldBdr"),$("#layoutErrorDiv").text(I18n.getMsg("crm.label.layoutname.dupl")),$("#duplicateErrorTR").show(),t=!1):CML.splCharCheckForTab(o)?null!=CML.layoutLabelRegex&&CML.layoutLabelRegex.test(o.toLowerCase())?($("#layoutErrorDiv").text(I18n.getMsg("crm.label.layoutname.sykw")),s.addClass("errFieldBdr"),$("#duplicateErrorTR").show(),t=!1):(s.removeClass("errFieldBdr"),$("#duplicateErrorTR").hide()):($("#layoutErrorDiv").text(I18n.getMsg("crm.mb.module.splc")),s.addClass("errFieldBdr"),$("#duplicateErrorTR").show(),t=!1)}if(r.is(":visible")){var d=$("#profileId");if(CrmPageLayout.validateProfile()||0===d.val().length){if(a=!1,0==l.length){var c=$(CMBElement.errPropertyFld);d.siblings("span").addClass("errFieldBdr").after(c.html(I18n.getMsg("crm.custom.module.no.profile.selected.alert1")))}}else t&&(CrmPageLayout.profileDetails.newPIds=d.val())}t&&a?(n.is(":visible")&&$("#disp_LayoutName").val(s.val()),CrmPageLayout.savePageLayout("finalSave",e)):i.removeClass("inActiveSec"),Crm.trackSpotLightAction("MPL Created",{Module:CrmPageLayout.module})},CrmPageLayout.validateProfile=function(){return null==$("#profileId").val()},CrmPageLayout.doneLayoutPermission=function(){var e=$("#profileId");if(CrmPageLayout.validateProfile()||0===e.val().length){if(0==$("#modulePermissionDiv").find(".fieldErrMsg").length){var t=$(CMBElement.errPropertyFld);e.siblings("span").addClass("errFieldBdr").after(t.html(I18n.getMsg("crm.custom.module.no.profile.selected.alert1")))}return!1}CrmModule.hide("infoNPermissionDiv"),CrmPageLayout.profileDetails.newPIds=e.val(),e.siblings("span").removeClass("errFieldBdr")},CrmPageLayout.checkDuplicateLayoutName=function(e){return CrmPageLayout.usedLayoutNames.contains(e.toLowerCase())},CrmPageLayout.showOrHideBusinessCard=function(e){var t=$("#dvBusinessCardVisibility"),a=t.find(".radio_button"),i=$(".businessCardDetails");a.hasClass("on_state")?(a.removeClass("on_state").addClass("off_State"),t.find(".white_ball").removeClass("fR").addClass("fL"),$("#bcVisible").val("false"),i.find(".fieldCountAlert, .linkCol, .detailViewBusinessCardFields").hide(),i.find(".detaiViewBCFieldsMessage").show(),e&&(CMB.isDetailViewBCVisible=!1),$(".popup-model-content").hide(),$(".bcfieldslimit, .bcfieldnote").hide(),$(".dv_bcfieldsmsg").show()):(a.removeClass("off_State").addClass("on_state"),t.find(".white_ball").removeClass("fL").addClass("fR"),$("#bcVisible").val("true"),i.find(".fieldCountAlert, .linkCol, .detailViewBusinessCardFields").show(),i.find(".detaiViewBCFieldsMessage").hide(),e&&(CMB.isDetailViewBCVisible=!0),$(".popup-model-content").show(),$(".bcfieldslimit, .bcfieldnote").show(),$(".dv_bcfieldsmsg").hide()),Events.isPageLayoutModified=!0,$("#saveBtn,#saveCloseBtn").removeClass("inActiveSec")},CrmPageLayout.validateLayoutProfile=function(){var e=$("#profileSelectDiv"),t=$("#layoutProfileId"),a=t.siblings("span");if(e.length>0){if(null===t.val()||0===t.val().length)return 0==$("#errorMsg_profile").length&&(a.addClass("errFieldBdr"),0===t.siblings(".fieldErrMsg").length&&a.after($(CMBElement.errPropertyFld).html(I18n.getMsg("crm.custom.module.no.profile.selected.alert1")))),!1;$("#errorMsg_profile").remove()}return!0},CrmPageLayout.validateJobSheetLayoutName=function(){var e=!0,t=$("#disp_LayoutName"),a=t.val().trim(),i=$("#jobSheetLayoutErrorDiv");return 0===i.length&&(t.after('<div class="fieldErrMsg mT5 f12 crm-font-regular fontSmooth" style="display:none" id="jobSheetLayoutErrorDiv"><fmt:message key="crm.label.layoutname.dupl"></fmt:message></div>'),i=$("#jobSheetLayoutErrorDiv")),0==a.length?(t.addClass("errFieldBdr"),i.text(I18n.getMsg("crm.alert.enter.layout.name")),e=!1):CrmPageLayout.checkDuplicateLayoutName(a)?(t.addClass("errFieldBdr"),i.text(I18n.getMsg("crm.label.layoutname.dupl")),e=!1):CML.splCharCheckForTab(a)?null!=CML.layoutLabelRegex&&CML.layoutLabelRegex.test(a.toLowerCase())?(i.text(I18n.getMsg("crm.label.layoutname.sykw")),t.addClass("errFieldBdr"),e=!1):(i.remove(),t.removeClass("errFieldBdr")):(i.text(I18n.getMsg("crm.mb.module.splc")),t.addClass("errFieldBdr"),e=!1),e||i.show(),e},CrmPageLayout.savePageLayout=function(e,t,a){var i={},r={},l={};CMB.completeModuleInfo={},CMB.completeSubformInfo={};var n=$("#h_modnm").val();if("JobSheets"===CrmPageLayout.module&&CMB.getMandatoryFieldCountForSection($("#layoutholder_add").find(".sectionli")))return CrmModule.toggleBusy("WarningDiv",!0),crmui.hidePopup("WarningDiv"),CMB.resetDeletePopup(),document.getElementById("noMandatoryError").ltProp("show",!0),!1;if(!CML.validateSubFormMaxRowEntries(n))return CrmSubform.showSubformLimitWarning(),!1;if(Crm.userDetails.isMandatorySubFormEnabled){var s=$(".subformList"),o=s.length,d=!1;$(CMBElement.errPropertyFld).removeClass("pA dIB").addClass("fL mL10 left0");for(var c=0;c<o;c++){var m=s.eq(c),u=m.find(".sectioncontainer").data(),p=m.find(".subFormTbl");if(void 0!==u&&u.isSubformMandatory&&void 0!==p&&p.find("td").length<1){var g=m.find("div.sectioncontainer");g.removeClass("errFieldBdr"),g.find(".fieldErrMsg").remove(),m.find("#subFrmErrorInfoDiv").remove(),g.next().html("");var v=g.find(".sectionlabel"),h=v.find("input.sectionlabelfield");v.find(".subFrmErrorDiv").remove(),d=!0,$("<div/>",{id:"subFrmErrorInfoDiv",class:"errInfoDiv p5 dIB f11 crm-font-regular mL5 errDesc alignleft nonmandatory",style:"background-color: #ffeceb",text:I18n.getMsg("crm.mb.mandatory.subform.empty.fields",u.label)}).insertAfter(g),h.addClass("errFieldBdr nonmandatory"),g.trigger("click"),h.removeAttr("selev")}}if(!0===d)return!1}var f=!1;if("clone"==CrmPageLayout.layoutOperation&&"firstSave"==e&&"JobSheets"!==CrmPageLayout.module?f=CrmPageLayout.validateLayoutConfig(t):"clone"==CrmPageLayout.layoutOperation&&"firstSave"==e&&"JobSheets"===CrmPageLayout.module?f=CrmPageLayout.validateJobSheetLayoutName():"edit"!=CrmPageLayout.layoutOperation&&"finalSave"!=e||(f=!0),"Potentials"===CrmPageLayout.module&&null!=CMB.historyTrackingDeals&&(CMB.historyTrackingDeals.followedUnSavedFieldLabels=[]),!CML.checkIfError()||!f)return!1;crmSetup.loaderDots();var y=$("#layoutTabId").val();r.tabId=y,"clone"==CrmPageLayout.layoutOperation?(r.baseLayoutId=CrmPageLayout.layoutId,r.layoutName=$("#disp_LayoutName").val().trim()):null==CrmPageLayout.layoutId?(r.layoutId=$("#currentLayoutId").val(),null!=CrmPageLayout.layoutOperation?r.layoutOperation=CrmPageLayout.layoutOperation:r.layoutOperation="layoutEdit"):r.layoutId=CrmPageLayout.layoutId,i.layoutInfo=r;var C=$("#loadingDotId"),b=CML.fetchMBDataForLayout();if(!b&&void 0!==b)return C.length>0&&(CML.removeLoaderDots(),C.remove()),CrmModule.hideBg(),!1;var T=!1,I=!1;validationUtils.isEmpty(CMB.completeModuleInfo)||(T=!0,i.completeMBInfo=CMB.completeModuleInfo,I=CMB.isPickListTrackerTouched(CMB.completeModuleInfo)),validationUtils.isEmpty(CMB.completeSubformInfo)||(T=!0,i.completeSubformInfo=CMB.completeSubformInfo),"clone"===CrmPageLayout.layoutOperation&&"JobSheets"!==CrmPageLayout.module&&(i.profileDetails=CrmPageLayout.profileDetails);var w=$("#moduleCustomizationDiv");if("edit"==CrmPageLayout.layoutOperation&&!T)return $("#formulaExpValidationPopup").is(":visible")||(CrmModule.showInnerTabs(),CrmPageLayout.showMsgBand(w,"success",I18n.getMsg("crm.label.no.changes"),4e3),CrmModule.hideBg()),C.length>0&&(CML.removeLoaderDots(),C.remove()),a&&a.callBack(a.firstParam,a.secondParam,!0),!1;$("#lay_saveBtn,#lay_saveBtn1").addClass("inActiveSec"),l.crmcsrfparam=$('[name="crmcsrfparam"]').val(),l.module=CrmPageLayout.module,l.layoutInfo=JSON.stringify(i);var L=Crm.getCrmBasePath()+"/PageLayout.do?operation="+CrmPageLayout.layoutOperation,k=$("#layoutNameSpan").text(),P=k,D=null;(CrmPageLayout.isMPLAvailable||CrmPageLayout.isMPLInGracePeriod)&&"Tasks"!==l.module&&"Events"!==l.module&&"Calls"!==l.module?(D="crm.label.layout.updated.succuess",""==k&&(D="crm.label.creator.updated.successMsg"),P=k):(D="crm.module.update.success",P=$("#ModuleListUL option:selected").text(),"Users"!==CrmPageLayout.module&&"JobSheets"!==CrmPageLayout.module||(P=CrmPageLayout.module)),"clone"===CrmPageLayout.layoutOperation?(k=r.layoutName,L+="&action=saveNewLayout",D="crm.label.layout.created.succuess",P=k):L+="&action=saveModifiedLayout",jQuery.ajax({type:"POST",url:L,data:l,dataType:"json",success:function(e){var i=$("#moduleCustomizationDiv");if(void 0!==e.ERROR&&(CrmModule.toggleBusy("WarningDiv",!0),crmui.hidePopup("WarningDiv"),CMB.resetDeletePopup(),CrmPageLayout.showMsgBand(i,"error",e.ERROR,4e3)),null!=e.isTracked){var r="PickList Tracker ";r=1==e.isTracked?r+"Enabled":r+"Disabled",Crm.trackSpotLightAction(r,{Module:CrmPageLayout.module})}if("undefined"!=typeof crmLookupBusinessCard&&(crmLookupBusinessCard.result=null),I&&CMB.removeoraddModuleLabels(CMB.completeModuleInfo),"Leads"===CrmPageLayout.module&&null!=e.uniqueFldDetailsJson&&$("#uniqueFldDetailsJson").val(JSON.stringify(e.uniqueFldDetailsJson)),void 0!==moduleRecordMapping[CrmPageLayout.module]){var l=store.peekRecord("module",moduleRecordMapping[CrmPageLayout.module].id),n=l.fields;if(n=n&&Array.isArray(n)?Array.from(n):n,!Crm.isActivitySplitDone&&("Calls"==CrmPageLayout.module||"Tasks"==CrmPageLayout.module||"Events"==CrmPageLayout.module)){var s=store.peekRecord("module",moduleRecordMapping.Activities.id),o=s.fields;(o=o&&Array.isArray(o)?Array.from(o):o)&&o.forEach((function(e){store.unloadRecord("field",e.id)})),s.fields=void 0}n&&n.forEach((function(e){store.unloadRecord("field",e.id)})),store.unloadAll("layout"),l.fields=void 0,store.clearCachedQuery("field",{module:moduleRecordMapping[CrmPageLayout.module].api_name,type:"all",service:"Reports"})}store.peekAll("module").filterBy({generated_type:"linking"}).forEach((function(e){store.unloadRecord("module",e.id)})),store.findAll("module").then((function(){if(CrmModule.showInnerTabs(),Events.isPageLayoutModified=!1,e.successDomIDsObject){var i=JSON.stringify(e.successDomIDsObject);if(i.indexOf("MXNDUMMYCOLUMN")>-1&&(crmTab.reloadTabMenu(),CMB.updateLinkingModuleInModuleBuilder(e.successDomIDsObject),CMB.reloadModuleDropDownForMPL()),i.indexOf("userLookupField")>-1&&CMB.handlingSpotTrackingForUserLookupField(e),"Appointments"===e.modName&&i.indexOf("SEID")>-1){var r=$("crux-column-list")[0].component;r.data.cxPropSelectedFields=r.getSelectedFields()}}var l=!1;if(e.subFormResObj){var n=Object.keys(e.subFormResObj);if(e.subFormResObj.lineItemFormulaCalcFlow&&(Crm.userDetails.lineItemFormulaCalcFlow=e.subFormResObj[n].lineItemFormulaCalcFlow),n.contains("SFLIMIT")||n.contains("SFDEL"))l=!0,CrmSubform.showSubformLimitWarning(Object(e.subFormResObj));else if(n.contains("SFADDNEW_LATER"))l=!0,CrmPageLayout.showMsgBand($("#moduleCustomizationDiv"),"alert",e.subFormResObj.SFADDNEW_LATER,5e3);else if(n.contains("SFWIZARDCONFLICT"))l=!0,CrmPageLayout.showMsgBand($("#moduleCustomizationDiv"),"alert",e.subFormResObj.SFWIZARDCONFLICT,5e3);else for(var s=n.length,o=0;o<s;o++)l=CrmPageLayout.UpdateModifiedSubformLayoutResponse(CMB.completeSubformInfo[n[o]],e.subFormResObj[n[o]])||l}return CrmPageLayout.UpdateModifiedLayoutResponse(l,e,k,D,P,t,a),"Events"===CrmPageLayout.module&&Activities.resetReminderSection(),!1})),"undefined"!=typeof Customization&&Customization&&!1===Customization.canvasRefresh[e.modName]&&(Customization.canvasRefresh[e.modName]=!0)},error:function(){return CrmPageLayout.showMsgBand(w,"alert",I18n.getMsg("crm.label.module.operation.fail"),4e3),C.length>0&&(CML.removeLoaderDots(),C.remove()),CrmModule.hideBg(),CrmModule.toggleBusy("WarningDiv",!0),crmui.hidePopup("WarningDiv"),CMB.resetDeletePopup(),!1}}),12===r.layoutSource&&Crm.trackSpotLightAction("Integration Layout Edited",{layoutName:r.layoutName});var M="";M=t?"ModuleBuilder save and close clicked":"ModuleBuilder save clicked",Crm.trackSpotLightAction(M),Crm.client_tracking(M)},CrmPageLayout.UpdateModifiedLayoutResponse=function(e,t,a,i,r,l,n){var s=!0;void 0!==t.convertLeadMapLengthCheck&&(CrmPageLayout.convertLeadMapLengthCheck=t.convertLeadMapLengthCheck),void 0!==t.connectedModuleVsLengthCheckJSON&&(CrmPageLayout.connectedModuleVsLengthCheckJSON=t.connectedModuleVsLengthCheckJSON,CrmPageLayout.connectedModule=t.connectedModule);var o=$("#infoNPermissionDiv");if(void 0!==t.EXP)o.is(":visible")&&CrmModule.hide("infoNPermissionDiv"),CrmPageLayout.showMsgBand($("#moduleCustomizationDiv"),"alert",t.EXP,4e3);else if(null!=t.RES)o.is(":visible")&&CrmModule.hide("infoNPermissionDiv"),CrmPageLayout.showMsgBand($("#moduleCustomizationDiv"),"alert",t.RES,4e3);else if(null!=t.EXD)o.is(":visible")&&CrmModule.hide("infoNPermissionDiv"),CrmPageLayout.showMsgBand($("#moduleCustomizationDiv"),"alert",t.EXD,4e3);else if(void 0!==t.LAY||void 0!==t.MPR){o.is(":visible")||CML.showModuleInfoNPermission("layoutInfonPer","builder",CrmPageLayout.tabId,"edit","save");var d=o;if(void 0!==t.LAY){var c=d.find("#disp_LayoutName1");d.find("#layoutErrorDiv").text(t.LAY),d.find("#duplicateErrorTR").show(),c.addClass("errFieldBdr")}if(void 0!==t.MPR){var m=$(CMBElement.errPropertyFld);d.find("ul.chosen-choices").addClass("errFieldBdr").after(m.text(t.MPR))}}else if(void 0!==t.WRNG||e){if(CML.handleWarningsOnSave(t),o.is(":visible")&&CrmModule.hide("infoNPermissionDiv"),void 0!==t.status&&"error"===t.status)CrmPageLayout.showMsgBand($("#moduleCustomizationDiv"),"alert",t.MSG,4e3);else if(!e){"clone"===CrmPageLayout.layoutOperation&&(CrmPageLayout.layoutId=t.lastLayoutId,CrmPageLayout.layoutOperation="edit");var u=t.MSG;void 0!==t.SCH&&(u+=" "+t.SCH),CrmModule.toggleBusy("WarningDiv",!0),crmui.hidePopup("WarningDiv"),CMB.resetDeletePopup(),CrmPageLayout.showMsgBand($("#moduleCustomizationDiv"),"error",u,4e3)}}else if("clone"===CrmPageLayout.layoutOperation){if(void 0!==t.error)return CrmPageLayout.showMsgBand($("#moduleCustomizationDiv"),"alert",t.error,4e3),!1;l?(Lyte.Router.getRouteInstance().transitionTo({route:"crm.settings.section.modules.module.layouts.index-layouts",dynamicParams:[t.modName]}),$("#mainMenuTabDiv").show()):Lyte.Router.getRouteInstance().transitionTo({route:"crm.settings.section.modules.module.layouts.view-layout",dynamicParams:[t.modName,t.lastLayoutId]}),CrmPageLayout.showMsgBand($("#moduleCustomizationDiv"),"success",I18n.getMsg(i,$ESAPI.encoder().encodeForHTML(r)),4e3)}else{u=I18n.getMsg(i,r);"Users"===CrmPageLayout.module&&l&&(void 0!==t.MSG&&(u=t.MSG),parent.window.close()),void 0!==t.SCH&&(u+=" "+t.SCH);var p,g=$("#layoutTabId").val();if(l)p={tabId:g,tab:crmHistory.getCurrentStateData().tab,subTab:crmHistory.getCurrentStateData().subTab,innerTab:crmHistory.getCurrentStateData().innerTab,module:crmHistory.getCurrentStateData().module,calleeObj:"crmSetup"},Lyte.Router.getRouteInstance().transitionTo({route:"crm.settings.section.modules.module.layouts.index-layouts",dynamicParams:[t.modName]}),$("#mainMenuTabDiv").show(),CrmPageLayout.showMsgBand($("#moduleCustomizationDiv"),"success",u,4e3);else if(p={tabId:g,opearation:"edit",tab:crmHistory.getCurrentStateData().tab,subTab:crmHistory.getCurrentStateData().subTab,innerTab:crmHistory.getCurrentStateData().innerTab,module:crmHistory.getCurrentStateData().module,layoutId:CrmPageLayout.layoutId},s=!1,n){var v=p;n.callBack(n.firstParam,n.secondParam,v)}else CMB.reloadModuleContent(g,void 0,p),CrmPageLayout.showMsgBand($("#moduleCustomizationDiv"),"success",u,4e3);n?n.callBack(n.firstParam,n.secondParam,!0):CrmPageLayout.showMsgBand($("#moduleCustomizationDiv"),"success",u,4e3)}null!=t.newlyCreatedFieldsCount&&(Crm.trackSpotLightAction("Custom Field Created",{Count:t.newlyCreatedFieldsCount,Module:CrmPageLayout.module}),Crm.client_tracking("Custom Field Created",{Count:t.newlyCreatedFieldsCount,Module:CrmPageLayout.module})),CML.handlingSpotTrackingForSubforms();var h=!1;if(!0===Crm.isCpqActivated()&&void 0!==t.subFormResObj){var f=Object.keys(t.subFormResObj);if(void 0!==f&&f.length>0)for(var y=f.length,C=0;C<y;C++){var b=t.subFormResObj[f[C]];if(void 0!==b&&void 0!==b.WRNG&&b.WRNG instanceof Object){var T=b.WRNG;for(var I of Object.keys(T)){var w=T[I];if(void 0!==w&&w instanceof Object&&w.hasOwnProperty("pricing_rules")&&void 0!==w.pricing_rules&&w.pricing_rules.length>0){h=!0;break}}}}}if(s){!1===h&&CrmModule.hideBg();var L=$("#loadingDotId");L.length>0&&(CML.removeLoaderDots(),L.remove())}},CrmPageLayout.UpdateModifiedSubformLayoutResponse=function(e,t){var a=$("#infoNPermissionDiv"),i=!0,r=void 0!==e.completeMBInfo?e.completeMBInfo.subFormProperties.deid:e.subFormProperties.deid,l=$('.sectioncontainer[deid="'+r+'"]'),n=l.closest("li.sectionli"),s=!1;if(void 0!==t.MOD){a.is(":visible")&&CrmModule.hide("infoNPermissionDiv");var o="";if("object"==typeof t.MOD)for(var d in t.MOD)o=o+t.MOD[d]+" ";else o=t.MOD;CML.handleWarningOfSubformModName(o,n),CrmPageLayout.showMsgBand($("#moduleCustomizationDiv"),"alert",I18n.getMsg("crm.label.module.operation.fail"),4e3),s=!0}else if(Crm.userDetails.isMandatorySubFormEnabled&&void 0!==t.SMEF){o="";if("object"==typeof t.SMEF)for(var d in t.SMEF)o=o+t.SMEF[d]+" ";else o=t.SMEF;CML.handleWarningOfMandatorySubformWithEmptyField(o,n,l),CrmPageLayout.showMsgBand($("#moduleCustomizationDiv"),"alert",I18n.getMsg("crm.label.module.operation.fail"),4e3),s=!0}else if(void 0!==t.EXP)a.is(":visible")&&CrmModule.hide("infoNPermissionDiv"),CrmPageLayout.showMsgBand($("#moduleCustomizationDiv"),"alert",t.EXP,4e3);else if(void 0!==t.RES)a.is(":visible")&&CrmModule.hide("infoNPermissionDiv"),CrmPageLayout.showMsgBand($("#moduleCustomizationDiv"),"alert",t.RES,4e3);else if(void 0!==t.EXD)a.is(":visible")&&CrmModule.hide("infoNPermissionDiv"),CrmPageLayout.showMsgBand($("#moduleCustomizationDiv"),"alert",t.EXD,4e3);else if(void 0!==t.LAY||void 0!==t.MPR){a.is(":visible")||CML.showModuleInfoNPermission("layoutInfonPer","builder",CrmPageLayout.tabId,"edit","save");var c=a;if(void 0!==t.LAY){var m=c.find("#disp_LayoutName1");c.find("#layoutErrorDiv").text(t.LAY),c.find("#duplicateErrorTR").show(),m.addClass("errFieldBdr")}if(void 0!==t.MPR){var u=$(CMBElement.errPropertyFld);c.find("ul.chosen-choices").addClass("errFieldBdr").after(u.text(t.MPR))}}else if(void 0!==t.WRNG){var p=!1,g=[],v="<ul class='listDisc'>",h="",f=t.WRNG;for(var d of Object.keys(f)){var y=f[d];if(void 0!==y&&y instanceof Object&&y.hasOwnProperty("pricing_rules")&&void 0!==y.pricing_rules&&y.pricing_rules.length>0&&y.hasOwnProperty("name")&&void 0!==y.name){p=!0,h=y.name;for(var C=y.pricing_rules,b=C.length,T=0;T<b;T++){var I=C[T],w=I.name,L=I.id,k=I.isLengthMismatched,P=I.isDecimalMismatched;!0!==k||g.includes("mxlen")||g.push("mxlen"),!0!==P||g.includes("decimal")||g.push("decimal"),v+='<li class="p3"><a  target="_blank" href="'+Crm.getCrmBasePath()+"/settings/zohocpq/priceRules/"+L+'/edit">'+$ESAPI.encoder().encodeForHTML(w)+"</a></li>"}v+="</ul>";break}}if(!0===p){var D,M="";g.includes("mxlen")&&(M+=I18n.getMsg("crm.custom.module.max.digits.allowed")),g.includes("decimal")&&(M+=""===M?I18n.getMsg("crm.label.number.decimal.places"):","+I18n.getMsg("crm.label.number.decimal.places")),"List Price"===h?D=I18n.getMsg("List Price"):"Discount"===h&&(D=I18n.getMsg("Discount"));var _=networkUtils.returnDependencyFiles([networkUtils.getI18nJSUrl("CPQModuleBuilder")]);Lyte.injectResources(_,void 0,(function(){$("#cpqPriceRulehead").html(I18n.getMsg("crm.cpq.settings.pricerules")).show(),$("#cpqPriceRulediv").html(v).show();var e,t=$("#deletefield");1===g.length?e=I18n.getMsg("cpq.rules.property.singular"):g.length>1&&(e=I18n.getMsg("cpq.rules.property.plural")),t.find("#delfldhd").html(I18n.getMsg("cpq.rules.propertiesedit.head",[D,e])),t.find("#deleteInfo1").html(I18n.getMsg("cpq.rules.propertiesedit.desc",M)),crmui.showPopup("deletefield")}))}else if(CML.handleWarningsOnSubformSave(t,n),a.is(":visible")&&CrmModule.hide("infoNPermissionDiv"),void 0!==t.status&&"error"===t.status)CrmPageLayout.showMsgBand($("#moduleCustomizationDiv"),"alert",t.MSG,4e3);else{var E=t.MSG;void 0!==t.SCH&&(E+=" "+t.SCH),CrmPageLayout.showMsgBand($("#moduleCustomizationDiv"),"error",E,4e3)}}else void 0!==t.SFPROP?(a.is(":visible")&&CrmModule.hide("infoNPermissionDiv"),CML.handleWarningOfSubformModName(t.SFPROP,n),CrmPageLayout.showMsgBand($("#moduleCustomizationDiv"),"alert",I18n.getMsg("crm.label.module.operation.fail"),4e3),s=!0):i=!1;return s||(Crm.updatePermission(t),CML.handlingSpotTrackingForSubformModule(n,t)),i},CrmPageLayout.viewLayoutActions=function(e,t){var a=$("#layout_"+e),i=a.find(".inAct"),r=$("#ModuleListUL").val(),l=$("#settings_"+e),n=l.closest("div.pR").position();$(".wid_calSettings_opts").remove();var s=CrmPageLayout.layoutIdDetailsMap[e].source,o=!1,d=!1;"true"==isSandboxAcc&&$("#mapDepend").hide(),10===s||11===s?o=!0:12==s&&(d=!0);var c=!1,m=!1;2===Crm.userDetails.ORG_TYPE?m=!0:3===Crm.userDetails.ORG_TYPE&&(c=!0);var u=$("#renameLayout");u.attr("data-zcqa","MPL_renameLayout_"+t),u.off("click"),c&&1===Crm.moduleInfo[CrmPageLayout.module].genType||!c&&!m&&o?(u.addClass("disableModule"),u.attr("mbtooltip",I18n.getMsg("crm.not.supported.extension",4e3)),u.on({mouseenter:function(){void 0!==u.attr("mbtooltip")&&CrmModule.newshowtt(u.attr("mbtooltip"))},mouseleave:function(){CrmModule.newhidett()}})):(u.removeAttr("mbtooltip"),u.show(),i.length>0?u.addClass("disableModule"):(u.removeClass("disableModule"),u.on("click",(function(){CrmPageLayout.editLayoutName("list",e)}))));var p=$("#editLayout");if(p.attr("data-zcqa","MPL_editLayout_"+t),p.off("click"),i.length>0)p.closest("link-to").attr("lt-prop-route",""),p.addClass("disableModule");else{var g=p.closest("link-to");p.removeClass("disableModule"),"jobsheet-layouts"===Lyte.Router.getRouteInstance().routeName?g.attr("lt-prop-route","crm.settings.section.modules.module.layouts.view-layout").attr("lt-prop-dp",'["JobSheets","'+e+'"]').attr("onclick","javascript:Lyte.Router.transitionTo('crm.settings.section.modules.module.layouts.view-layout','JobSheets','"+e+"')"):g.attr("lt-prop-route","crm.settings.section.modules.module.layouts.view-layout").attr("lt-prop-dp",'["'+r+'","'+e+'"]').attr("onclick","javascript:Lyte.Router.transitionTo('crm.settings.section.modules.module.layouts.view-layout','"+r+"','"+e+"')")}var v=$("#setPerm");v.attr("data-zcqa","MPL_setPerm_"+t),v.off("click"),"JobSheets"==CrmPageLayout.module?v.hide():i.length>0?v.addClass("disableModule"):(v.removeClass("disableModule"),v.on("click",(function(){if(CrmPageLayout.totalLayoutCnt>1)CrmPageLayout.showLayoutPermission("list",e,t);else{var a={};a.crmcsrfparam=$('[name="crmcsrfparam"]').val(),a.module=CrmPageLayout.module;var i=Crm.getCrmBasePath()+"/PageLayout.do?action=getModulePermissions";(new crmRequestPool).doAjax(i,(function(e){var t=$("#infoNPermissionDiv"),a=t.find("#modulePermissionDiv");a.remove(),t.find("#layoutNameInfoDiv").hide().after(e),(a=t.find("#modulePermissionDiv")).find("#tabId").val(CrmPageLayout.tabId),a.find("#p_modnm").val(CrmPageLayout.module);var i=moduleRecordMapping[CrmPageLayout.module];a.find("#proModName").text(i.pluralLabel),a.find("#returnpage").val("layoutlist"),t.find("#saveLayoutName").attr("onclick","javascript:CML.updateModuleInfoNPermission('edit','layoutlist');"),CrmModule.toggleBusy("infoNPermissionDiv",!0),CrmModule.ppFromTop("infoNPermissionDiv"),thirdPartyUtils.bindSelect2(t.find("select"));for(var r=[],l=a.find("option:selected"),n=l.length,s=0;s<n;s++)r.push(l.eq(s).val());CML.currentProfileIdList=r,CML.addedProfileIdList=[],CML.removedProfileIdList=[],$("#permNoteForModInfo").remove();var o=$("#profileId");o.off().on("select2:select",(function(e){CML.addProfileToList(e.params.data.id)})),o.on("select2:unselect",(function(e){event.stopPropagation(),CML.removeProfileFromList(e.params.data.id)}))}),a)}})));var h=$("#cloneLayout");h.attr("data-zcqa","MPL_cloneLayout_"+t),h.off("click"),i.length>0?h.addClass("disableModule"):CrmPageLayout.totalLayoutCnt-CrmPageLayout.nonStandardSystemGivenLayoutCount>=CrmPageLayout.maxLayoutCnt?(h.addClass("disableModule"),h.on({mouseenter:function(){CrmModule.newshowtt(I18n.getMsg("crm.alert.layout.limit.reached.clone",CrmPageLayout.maxLayoutCnt-1))},mouseleave:function(){CrmModule.newhidett()}})):c&&1===Crm.moduleInfo[CrmPageLayout.module].genType?(h.addClass("disableModule"),h.on({mouseenter:function(){CrmModule.newshowtt(I18n.getMsg("crm.not.supported.extension",4e3))},mouseleave:function(){CrmModule.newhidett()}})):(h.removeClass("disableModule"),h.on("click",(function(){CrmPageLayout.createPageLayout(e)}))),"Tasks"==CrmPageLayout.module||"Events"==CrmPageLayout.module||"Calls"==CrmPageLayout.module||"Services"==CrmPageLayout.module||"Appointments"==CrmPageLayout.module||"JobSheets"==CrmPageLayout.module||d?h.hide():h.show();var f=$("#mapDepend"),y=$("#layoutOptSep1");if(f.attr("data-zcqa","MPL_mapDepend_"+t),f.off("click"),"JobSheets"==CrmPageLayout.module?f.hide():i.length>0?f.addClass("disableModule"):(f.removeClass("disableModule"),f.on("click",(function(){CML.loadPageHere("dependency",CrmPageLayout.module,e,t,"layoutsList")}))),"Leads"===r||"true"!==isSandboxAcc&&("Quotes"===r||"SalesOrders"===r)){var C=$("#convLeadMap");C.attr("data-zcqa","MPL_convLeadMap_"+t),C.off("click"),i.length>0?(C.addClass("disableModule"),y.show()):(C.removeClass("disableModule"),C.on("click",(function(){CML.loadPageHere("mapping",r,e,t,"layoutsList")}))),C.show(),y.show()}if("Potentials"==r){var b=$("#stageProp");b.attr("data-zcqa","MPL_stageProp_"+t),b.off("click"),i.length>0?b.addClass("disableModule"):(b.removeClass("disableModule"),b.on("click",(function(){CMB.showSpecialFieldPopup("StageProbability","true",e,"true")}))),b.show()}var T=$("#delLayout");T.attr("data-zcqa","MPL_delLayout_"+t),T.off("click"),"false"!==a.attr("isSystemLayout")||c||m||!o?"false"!==a.attr("isSystemLayout")||d?(T.hide(),$("#layoutOptSep2").hide()):(T.on("click",(function(){hideMenu(),CrmPageLayout.showLayoutActionPop(e,t,"delete"),sE(event)})),T.removeAttr("mbtooltip"),T.removeClass("disableModule"),T.show(),$("#layoutOptSep2").show()):(T.addClass("disableModule"),T.attr("mbtooltip",I18n.getMsg("crm.not.supported.extension",4e3)),T.on({mouseenter:function(){void 0!==T.attr("mbtooltip")&&CrmModule.newshowtt(T.attr("mbtooltip"))},mouseleave:function(){CrmModule.newhidett()}}),T.show());var I=$("#layoutActionsDiv"),w=null,L=n.top-10;w=Crm.userDetails.RTL_ENABLED?n.left-150:n.left+35,l.closest("td").append(I),I.css({top:L,left:w}).show()},CrmPageLayout.getSelectedProfiles=function(e){if(""==CrmPageLayout.newProfileList&&""==CrmPageLayout.removedProfileList){if("list"===e||"builderList"===e)return CrmPageLayout.removeProfileInfoDiv(),CrmPageLayout.showMsgBand($("#moduleCustomizationDiv"),"success",I18n.getMsg("crm.label.no.changes"),4e3),!1;if("activateLayout"===e)return!0}else CrmPageLayout.newProfileList.length>0&&(CrmPageLayout.profileDetails.newPIds=CrmPageLayout.newProfileList),CrmPageLayout.removedProfileList.length>0&&(CrmPageLayout.profileDetails.deletedPIds=CrmPageLayout.removedProfileList);return!0},CrmPageLayout.saveLayoutPermission=function(e,t){var a={},i={};if(CrmPageLayout.validateLayoutProfile()&&CrmPageLayout.getSelectedProfiles(e)){var r=$("#moduleCustomizationDiv");if("activateLayout"==e&&CrmPageLayout.activeLayoutCnt-CrmPageLayout.nonStandardSystemGivenLayoutCount>=CrmPageLayout.maxLayoutCnt)return CrmPageLayout.showMsgBand(r,"alert",I18n.getMsg("crm.alert.layout.activate.limit.reached",CrmPageLayout.maxLayoutCnt-1),4e3),CrmPageLayout.removeProfileInfoDiv(),!1;a.profileDetails=CrmPageLayout.profileDetails,i.crmcsrfparam=$('[name="crmcsrfparam"]').val(),i.module=$("#ModuleListUL").val(),i.layoutId=CrmPageLayout.layoutId,i.pageType=e,i.permissionInfo=JSON.stringify(a);var l=Crm.getCrmBasePath()+"/PageLayout.do?action=updatePermission";jQuery.ajax({type:"POST",url:l,data:i,dataType:"html",success:function(a){if(-1!=a.indexOf('id="FLEEMsgError"')){var i=document.createElement("div");i.innerHTML=a;var l=i.getElementsByClassName("title")[0];if(l)return l=l.innerText,CrmModule.hide("crmLayoutPerDiv"),void CrmPageLayout.showMsgBand(r,"error",l,4e3)}if("layoutActionInfoDiv"==t)CrmModule.hide("crmLayoutPerDiv"),setTimeout((function(){"list"!==e&&"activateLayout"!==e||($("#layoutActionInfoDiv").html(a),CrmModule.ppFromTop("layoutActionDiv"))}),500);else{if(CrmModule.hide("crmLayoutPerDiv"),"list"!==e&&"activateLayout"!==e||$("#customizationDiv").html(a),CrmPageLayout.removedProfileList.length>0)for(var n=CrmPageLayout.removedProfileList.length,s=0;s<=n;s++)CrmPageLayout.currProfileIdList.removeFirstOccurenceOfElement(CrmPageLayout.removedProfileList[s]),"builderList"===e&&CMB.nCHolder.layoutPerIds.removeFirstOccurenceOfElement(CrmPageLayout.removedProfileList[s]);CrmPageLayout.newProfileList.length>0&&(CrmPageLayout.currProfileIdList=CrmPageLayout.currProfileIdList.concat(CrmPageLayout.newProfileList),"builderList"===e&&(CMB.nCHolder.layoutPerIds=CMB.nCHolder.layoutPerIds.concat(CrmPageLayout.newProfileList))),CrmPageLayout.newProfileList=[],CrmPageLayout.removedProfileList=[],"list"==e||"builderList"==e?CrmPageLayout.showMsgBand(r,"success",I18n.getMsg("crm.label.permission.modified.success"),4e3):(e="activateLayout")&&CrmPageLayout.showMsgBand(r,"success",I18n.getMsg("crm.label.layout.activated.succuess",$("#pLayoutName").text()),4e3)}},error:function(){return CrmPageLayout.showMsgBand(r,"alert",I18n.getMsg("crm.label.module.operation.fail"),4e3),!1}})}},CrmPageLayout.showLayoutActionPop=function(e,t,a){var i={};i.layoutId=e,i.layoutName=t;var r=$("#ModuleListUL").val();i.module=r,i.operation=a;var l=Crm.getCrmBasePath()+"/PageLayout.do?action=showActionPage";jQuery.ajax({type:"GET",url:l,data:i,success:function(i){"object"==typeof i&&i.isUsedInPortals?("delete"===a?(i.headerContent=I18n.getMsg("layouts.delete.portals.error.header",t),i.bodyContent=I18n.getMsg("layouts.delete.portals.error.desc")):(i.headerContent=I18n.getMsg("layouts.disable.portals.error.header",t),i.bodyContent=I18n.getMsg("layouts.disable.portals.error.desc")),i.buttonContent=I18n.getMsg("crm.button.ok.got.it"),i.isNotAllowedToUnSelectModules=!0,Lyte.Component.render("crm-permission-denied-pop-up",i,"body"),$L("#permissionDeniedPopup").e.ltProp("show",!0)):"object"==typeof i?("delete"===a?$("#deletefield #deleteInfo1").html(I18n.getMsg("crm.layout.delete.deny.message")):($("deletefield #delfldhd").empty(),$("#deletefield #delfldhd").innerHTML=I18n.getMsg("crm.layout.deactivate.deny.title"),$("#deletefield #deleteInfo1").html(I18n.getMsg("crm.layout.deactivate.info",$ESAPI.encoder().encodeForHTML(t)))),deleteCRFWarning(e,i.usedPlaces,r,void 0,void 0,!1)):($("#layoutActionInfoDiv").html(i),CrmModule.ppFromTop("layoutActionDiv"))}})},CrmPageLayout.deleteLayout=function(e){var t={};t.crmcsrfparam=$('[name="crmcsrfparam"]').val(),t.layoutId=e,t.module=CrmPageLayout.module;var a=Crm.getCrmBasePath()+"/PageLayout.do?action=deleteLayout";jQuery.ajax({type:"POST",url:a,data:t,dataType:"html",success:function(e){CrmPageLayout.deleteExtraSubformLayout(t.layoutId),$("#customizationDiv").html(e),CrmModule.hide("layoutActionDiv"),CrmPageLayout.showMsgBand($("#moduleCustomizationDiv"),"success",I18n.getMsg("crm.label.layout.deleted.succuess",$("#layoutName").text()),4e3)}})},CrmPageLayout.triggerLayoutAction=function(){var e=$("#operation").val(),t=$("#layoutOpt").val(),a=$("#moduleCustomizationDiv"),i=$("#layoutName").text();if("none"==t)return CrmPageLayout.showMsgBand(a,"success",I18n.getMsg("crm.label.layout.deleted.alert",i),4e3),!1;var r={};if(r.crmcsrfparam=$('[name="crmcsrfparam"]').val(),r.oldLayoutId=$("#oldLayoutId").val(),r.newLayoutId=t,r.module=$("#ModuleListUL").val(),r.operation=e,r.isProfileAvailable=$("#isProfileAvailable").val(),r.isRecordAss=$("#isRecordAss").val(),moduleRecordMapping.Potentials&&CrmPageLayout.module===moduleRecordMapping.Potentials.module_name&&!$("#pipelineInfo").hasClass("dN")){var l=$("#pipeOpt").val(),n=$("#stageOpt").val();if("none"==l)return CrmPageLayout.showMsgBand(a,"success",I18n.getMsg("crm.massupdate.pipeline.msg"),4e3),!1;if("none"===n||"-None-"===n)return CrmPageLayout.showMsgBand(a,"success",I18n.getMsg("crm.massupdate.stage.msg"),4e3),!1;r.pipeline=l,r.stage=n}var s=Crm.getCrmBasePath()+"/PageLayout.do?action=deleteOrstatusLayout";jQuery.ajax({type:"POST",url:s,data:r,dataType:"html",success:function(l){CrmModule.hide("layoutActionDiv");var n=I18n.getMsg("crm.alert.layout.layoutId.fail"),s=I18n.getMsg("crm.alert.layout.delete.permission"),o=I18n.getMsg("crm.alert.layout.status.permission"),d=I18n.getMsg("crm.layout.delete.not.allowed");if(-1!=l.indexOf("usedPlaces"))CrmPageLayout.showMsgBand(a,"error",I18n.getMsg("crm.alert.invalid.action"),4e3);else if(-1==l.indexOf(n)&&-1==l.indexOf(s)&&-1==l.indexOf(o)&&-1==l.indexOf(d)){if(-1!=l.indexOf('id="FLEEMsgError"')){var c=document.createElement("div");c.innerHTML=l;var m=c.getElementsByClassName("title")[0];if(m)return m=m.innerText,void CrmPageLayout.showMsgBand(a,"error",m,4e3)}$("#customizationDiv").html(l),"delete"==e?(CrmPageLayout.deleteExtraSubformLayout(r.oldLayoutId),CrmPageLayout.showMsgBand(a,"success",I18n.getMsg("crm.label.layout.deleted.succuess",i),4e3),Crm.trackSpotLightAction("MPL Deleted",{Module:CrmPageLayout.module})):CrmPageLayout.showMsgBand(a,"success",I18n.getMsg("crm.label.layout.deactivate.succuess",i),4e3),store.unloadRecord("layout",t)}}})},CrmPageLayout.scrollPos=function(){var e=CrmPageLayout.topVal,t=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop,a=$("#builder_btnDivisionIn"),i=$("#builder_btnDivision2"),r=$(document),l=r.height(),n=renderingUtils.windowHeight+r.scrollTop();if(a.css({width:CML.layoutWidth-62}),i.css({visibility:"hidden"}),e<=t){var s=$("#formcomponentcontainerdiv .subformUnusedFields:visible"),o=$("#moduleBuilderForm");$("#layoutNameDiv").addClass("plFormfixed").css({top:"-20px"}),$("div#layoutRenamediv").css({position:"fixed",top:"50px"});var d=$("#plHead"),c=$("#formcomponentcontainerdiv");d.addClass("plFormfixed1"),c.addClass("plFormfixed1"),$("#layHd").css({"z-index":"19"}),s&&s.length>0&&CrmSubform.subformInfoTootltip($(".subformActiveTrashInfo")),c.css({top:CrmPageLayout.editTop[1]}),"FIXED"===Crm.userDetails.SKIN_INFO.LAYOUT_TYPE?($("#moduleSubHead").addClass("formfixed1").css({width:CML.layoutWidth-67,top:CrmPageLayout.editTop[1]}),d.css({"padding-top":CrmPageLayout.editTop[1],top:"0",background:"#fff",width:CML.layoutWidth-60})):($("#moduleSubHead").addClass("formfixed1").css({width:CML.layoutWidth-46,top:CrmPageLayout.editTop[1]}),d.css({"padding-top":CrmPageLayout.editTop[1],top:"0",background:"#fff",width:CML.layoutWidth-40})),o.css({"padding-top":CrmPageLayout.editTop[2]})}else CrmPageLayout.posReset(),a.css({width:CML.layoutWidth-62}),s&&s.length>0&&CrmSubform.subformInfoTootltip($(".subformActiveTrashInfo"));l-180<=n&&(a.css({width:CML.layoutWidth}),i.css({visibility:"visible"}))},CrmPageLayout.posReset=function(){$("#layoutNameDiv").removeClass("plFormfixed"),$("div#layoutRenamediv").css({position:"static"}),$("#layHd").css({"z-index":"1"});var e=$("#plHead");e.removeClass("plFormfixed1"),$("#formcomponentcontainerdiv").removeClass("plFormfixed1"),"FIXED"===Crm.userDetails.SKIN_INFO.LAYOUT_TYPE?(e.css({"padding-top":"0",top:"0",width:CML.layoutWidth-62}),$("#moduleSubHead").css({width:CML.layoutWidth-67}).removeClass("formfixed1")):(e.css({"padding-top":"0",top:"0",width:CML.layoutWidth-41}),$("#moduleSubHead").css({width:CML.layoutWidth-46}).removeClass("formfixed1")),$("#moduleBuilderForm").css({"padding-top":"0px"})},CrmPageLayout.bottomBtn=function(){$(".modSub .newListViewEdit").height()+$(".modSub").offset().top+120-renderingUtils.windowHeight<=(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop)?$("#fldPerm").removeClass("fldPerm").removeAttr("style"):setTimeout((function(){$("#fldPerm").addClass("fldPerm")}),10)},CrmPageLayout.searchLayBtn=function(){var e=$(".modSub");if($(".modSub .newListViewEdit").height()+e.offset().top+120-renderingUtils.windowHeight<=(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop))$("#savLayout").removeClass("fldPerm").removeAttr("style");else{var t=e.width();setTimeout((function(){$("#savLayout").addClass("fldPerm").width(t)}),10)}},CrmPageLayout.convertMapBtn=function(e){var t=$("#"+e);t.height()+t.offset().top+120-renderingUtils.windowHeight<=(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop)?$(".floatCont").removeClass("fldPerm").removeAttr("style"):$(".floatCont").addClass("fldPerm")},CrmPageLayout.showMsgBand=function(e,t,a,i){crmui.showMsgBand(t,a,i,e)},CrmPageLayout.showLayoutAssignmentPop=function(){CrmPageLayout.resetLayoutAssignmentAttr();var e={};e.module=$("#ModuleListUL").val();var t=Crm.getCrmBasePath()+"/PageLayout.do?action=showLayoutAssignment";jQuery.ajax({type:"GET",url:t,data:e,dataType:"html",success:function(e){$L("#layout_landing_right").removeScroll(),$("#layoutActionInfoDiv").html(e),thirdPartyUtils.bindSelect2(".set_layoutType_Details"),CrmModule.ppFromTop("layoutAssign"),$("#layoutAssign").css({overflow:"","max-height":""})}})},CrmPageLayout.showAddNewLayout=function(e,t){var a=0,i=$("#profile_"+e);for(key in CrmPageLayout.layoutIdNameMap)(0===!i.find("#layoutDiv_"+key).length||t&&12===CrmPageLayout.layoutIdDetailsMap[key].source)&&a++;a<objectUtils.getKeys(CrmPageLayout.layoutIdNameMap).length&&i.find("#addLayout").show()},CrmPageLayout.hideAddNewLayout=function(e){$("#profile_"+e).find("#addLayout").hide()},CrmPageLayout.showAddLayoutPop=function(e,t,a){var i=$(document.createDocumentFragment()),r={},l=[];for(key in CrmPageLayout.layoutIdNameMap)r[CrmPageLayout.layoutIdNameMap[key]]=key,l.push(CrmPageLayout.layoutIdNameMap[key]);l=l.sort((function(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())}));for(var n=$("#profile_"+e),s=n.find("#addLayout"),o=s.position(),d=o.left+s.width(),c=o.top-5,m=l.length,u=0;u<m;u++){var p=l[u];if(r.hasOwnProperty(p)&&null!=r[p]){var g=r[p];if(a&&12===CrmPageLayout.layoutIdDetailsMap[g].source){$("#lay_"+g).closest("tr").remove();continue}0==!n.find("#layoutDiv_"+g).length?$("#lay_"+g).closest("tr").remove():0==$("#lay_"+g).length?i.append('<tr><td width="15"> <input data-zcqa="MPL_layoutName_'+$ESAPI.encoder().encodeForHTML(p)+'" id="lay_'+g+'" type="checkbox"></td><td><label for="lay_'+g+'">'+$ESAPI.encoder().encodeForHTML(p)+"</label></td></tr>"):$("#lay_"+g).prop("checked",!1)}}$("#layoutListTable").append(i);var v=$("#addLayoutDiv");v.css({top:c,left:d}).show();var h=v.height();renderingUtils.windowHeight-h<c+30&&(v.css({top:c-h}),$("#addLayoutDiv .arrwRight").css({bottom:"18px"}));var f=v.find("#layoutListTable tr"),y=v.find("#searchLayout");f.length>5?(y.show(),$(f).show(),y.css("width",f.css("width")).val("")):y.hide();var C=$("#associateLayout");C.off("click"),C.on("click",(function(){CrmPageLayout.associateNewLayout(e,t)}))},CrmPageLayout.associateNewLayout=function(e,t){var a=null,i=[],r=[],l=$("#profile_"+e);for(key in CrmPageLayout.layoutIdNameMap)if($("#lay_"+key).is(":checked")){if(0==l.find("#layoutDiv_"+key).length){r.push(key);var n=CrmPageLayout.profileVSLayout[e];if(null==n||n.contains(key)){for(var s=[],o=CrmPageLayout.removedLayoutList[e],d=o.length,c=0;c<d;c++)o[c]!=key&&s.push(o[c]);""==s?CrmPageLayout.removedLayoutList={}:CrmPageLayout.removedLayoutList[e]=s}else null!=CrmPageLayout.newLayoutList[e]?CrmPageLayout.newLayoutList[e].push(key):(i.push(key),CrmPageLayout.newLayoutList[e]=i)}}else $("#layoutDiv_"+key).length>0&&(a=key);if(0!=r.length){d=r.length;var m=l.find(".profLayout_type_container").last();for(c=0;c<d;c++){var u=$("#layoutDiv_"+a).clone();u.find("input").attr("data-zcqa","radio_"+CrmPageLayout.profileIdNameMap[e]+"_"+CrmPageLayout.layoutIdNameMap[r[c]]),u.attr("id","layoutDiv_"+r[c]),u.attr("onmouseover","CrmPageLayout.showRemoveLayout('"+e+"','"+r[c]+"',"+t+")"),u.attr("onmouseout","CrmModule.newhidett();CrmPageLayout.hideRemoveLayout('"+e+"','"+r[c]+"',"+t+")"),u.find(".tagit-close").attr("onClick","CrmModule.newhidett();CrmPageLayout.removeLayout('"+e+"','"+r[c]+"',"+t+")"),u.find("#layoutName").text(CrmPageLayout.layoutIdNameMap[r[c]]),u.find(".css-checkbox").attr({id:"radio_"+r[c]+"_"+t,name:"radio_"+e,checked:!1,onClick:"CrmPageLayout.assignDefaultLayout('"+e+"','"+r[c]+"',"+t+")"}),u.find(".radGroup1").attr("for","radio_"+r[c]+"_"+t);var p=u.find("select.set_layoutType_Details");if(p&&p.length){p.empty().attr({id:"layouttype_"+e+"_"+r[c],onchange:"CrmPageLayout.assignLayoutType('"+e+"','"+r[c]+"',this)"});var g=document.createElement("option");g.text=I18n.getMsg("crm.button.layout.assignment.regular.layout"),g.value=r[c],p[0].add(g),CrmPageLayout.profileLayoutTypeMap[e]=CrmPageLayout.profileLayoutTypeMap[e]?CrmPageLayout.profileLayoutTypeMap[e]:{},CrmPageLayout.profileLayoutTypeMap[e][r[c]]=r[c];var v=CrmPageLayout.layoutVsWizard[r[c]];if(v){var h=document.createElement("OPTGROUP");h.setAttribute("label",I18n.getMsg("crm.settings.wizards"));var f=!1;v.forEach((function(t){if(CrmPageLayout.profileVsWizard[e]&&CrmPageLayout.profileVsWizard[e].contains(t)){var a=document.createElement("option");a.text=CrmPageLayout.wizardVsName[t],a.value=t,h.appendChild(a),f=!0}})),f&&p[0].add(h)}}$(u).insertAfter(m),$(u).wrapAll("<div class='profLayout_type_container' />"),$(u).find(".select2").remove(),thirdPartyUtils.bindSelect2(".set_layoutType_Details")}}$("#addLayoutDiv").hide()},CrmPageLayout.getAssociatedLayoutCount=function(e){var t=$("#profile_"+e),a=0;for(key in CrmPageLayout.layoutIdNameMap)0==!t.find("#layoutDiv_"+key).length&&a++;return a},CrmPageLayout.showRemoveLayout=function(e,t,a){var i=CrmPageLayout.getAssociatedLayoutCount(e),r=$("#profile_"+e);i>1&&!$("#radio_"+t+"_"+a).is(":checked")&&r.find("#layoutDiv_"+t).find(".tagit-close").show()},CrmPageLayout.showDefaultLayoutTooltip=function(e,t,a){CrmPageLayout.getAssociatedLayoutCount(e)>1&&!$("#radio_"+t+"_"+a).is(":checked")&&CrmModule.newshowtt(I18n.getMsg("crm.tooltip.assign.default.layout"))},CrmPageLayout.hideRemoveLayout=function(e,t){$("#profile_"+e).find("#layoutDiv_"+t).find(".tagit-close").hide()},CrmPageLayout.validateRemoval=function(e,t){var a=$("#profile_"+e).find(".profLayout").not("#layoutDiv_"+t);if(a.length<1)return!1;for(var i=a.length,r=0;r<i;r++)if($(a[r]).find("input[type='radio']").is(":checked"))return!0;return!1},CrmPageLayout.removeLayout=function(e,t){var a=$("#layAssErrorAlert");if(!CrmPageLayout.validateRemoval(e,t))return a.show(0).delay(5e3).hide(0),!1;var i=0;for(var r in CrmPageLayout.profileVSLayout)if(0==!$("#profile_"+r).find("#layoutDiv_"+t).length&&2==++i)break;if(i<=1)return a.show(0).delay(5e3).hide(0),!1;$("#profile_"+e).find("#layoutDiv_"+t).parent().remove();var l=[];if(CrmPageLayout.profileVSLayout[e].contains(t))null!=CrmPageLayout.removedLayoutList[e]?CrmPageLayout.removedLayoutList[e].push(t):(l.push(t),CrmPageLayout.removedLayoutList[e]=l);else{for(var n=[],s=CrmPageLayout.newLayoutList[e],o=s.length,d=0;d<o;d++)s[d]!=t&&n.push(s[d]);""==n?CrmPageLayout.newLayoutList={}:CrmPageLayout.newLayoutList[e]=n}},CrmPageLayout.saveLayoutAssignment=function(){var e={},t={},a=$("#moduleCustomizationDiv");if($.isEmptyObject(CrmPageLayout.newLayoutList)&&validationUtils.isEmpty(CrmPageLayout.profileLayoutTypeMap)&&$.isEmptyObject(CrmPageLayout.removedLayoutList)&&$.isEmptyObject(CrmPageLayout.newProfileIdVSDefaultLayout))return CrmPageLayout.showMsgBand(a,"success",I18n.getMsg("crm.label.no.changes"),4e3),$L("#layout_landing_right").scroll(),CrmModule.hide("layoutAssign"),!1;$.isEmptyObject(CrmPageLayout.newLayoutList)||(e.newLayoutList=CrmPageLayout.newLayoutList),$.isEmptyObject(CrmPageLayout.removedLayoutList)||(e.removedLayoutList=CrmPageLayout.removedLayoutList),$.isEmptyObject(CrmPageLayout.newProfileIdVSDefaultLayout)||(e.newProfileIdVSDefaultLayout=CrmPageLayout.newProfileIdVSDefaultLayout),validationUtils.isEmpty(CrmPageLayout.profileLayoutTypeMap)||(e.profileLayoutTypeMap=CrmPageLayout.profileLayoutTypeMap),t.crmcsrfparam=$('[name="crmcsrfparam"]').val(),t.tabId=$("#layoutTabId").val(),t.module=$("#ModuleListUL").val(),t.completeLayoutAssInfo=JSON.stringify(e);var i=Crm.getCrmBasePath()+"/PageLayout.do?action=saveLayoutAssignment";jQuery.ajax({type:"POST",url:i,data:t,dataType:"html",success:function(e){$L("#layout_landing_right").scroll(),CrmModule.hide("layoutAssign"),$("#customizationDiv").html(e),CrmPageLayout.showMsgBand(a,"success",I18n.getMsg("crm.label.changes.success"),4e3)}})},CrmPageLayout.assignDefaultLayout=function(e,t){CrmPageLayout.profileIdVSDefaultLayout[e]!=t?CrmPageLayout.newProfileIdVSDefaultLayout[e]=t:delete CrmPageLayout.newProfileIdVSDefaultLayout[e]},CrmPageLayout.removeIntegrationLayout=function(e){for(var t=new Array,a=e.length,i=0;i<a;i++){var r=e[i];12!=r.SOURCE&&t.push(r)}return t},CrmPageLayout.showLayoutPopup=function(e,t,a){var i={};i.module=e,i.layoutId=t;var r=Crm.getCrmBasePath()+"/PageLayout.do?action=showPageLayoutPopup";r=Crm.getPortalURL(r),jQuery.ajax({type:"GET",url:r,data:i,dataType:"json",success:function(i){i.module=e,i.entityId=a,i.selectedLayoutId=t,i.layout_jsonarrayObj=CrmPageLayout.removeIntegrationLayout(i.layout_jsonarrayObj),$("#lookupdiv").html($(Handlebars.templates.PageLayoutPopup(i))).addClass("newShowLayoutPopup"),freezeBackground(),mailsetCenter("lookupdiv")}}),Crm.trackSpotLightAction("MPL - Change Layout From Record Click",{Module:e})},CrmPageLayout.changePageLayout=function(e,t){var a=$("[name=pageLayout_radio]:checked"),i=a.attr("id"),r=a.attr("value"),l={reqFrom:"detailView",module:e,id:t,layoutId:i=i.substr(0,i.indexOf("_")),layoutName:r};$("#lookupdiv").hide(),removeFreezeLayer(),"crm.tab.module.entity.canvas"===Lyte.Router.getRouteInstance().transition.info.route&&(Crm.layoutReqFrom="canvas"),Lyte.Router.transitionTo({route:"crm.tab.module.entity.edit",dynamicParams:[e,t]}).data=l,Crm.trackSpotLightAction("MPL - Change Layout From Record Save",{Module:e})},CrmPageLayout.handlePotentialLayouts=function(){var e=$("#pipelineInfo"),t=$("#pipeOpt"),a=$("#layoutOpt").val(),i=$("#pipelineTransferMsg"),r=$("#deleteBtn");r&&r.addClass("inActLab"),t.find(".pipeOptions").remove(),e.addClass("dN"),i.addClass("dN"),r&&"none"!=a&&(commonUtils.showHideLoadingDiv(!0),store.findRecord("layout",a,{module:Crm.moduleInfo.Potentials.apiname}).then((function(l){for(var n=l[0].sections.length-1,s=l[0].sections,o=s.length,d=0;d<o;d++){var c=s[d].fields.filterBy({column_name:"PIPELINE"});if(c.length&&c[0][a]&&c[0][a].pick_list_values&&c[0][a].pick_list_values.length){var m="";e.removeClass("dN"),i.removeClass("dN"),CrmPageLayout.MultiPipelineOptionsTemplate||(CrmPageLayout.MultiPipelineOptionsTemplate=Handlebars.compile('{{#each optionValues}}{{#ifNotEquals "-None-" this.display_value}}<option class="{{../optionClass}}" value="{{this.display_value}}" data-zcqa="MPL_transRecords_{{this.display_value}}">{{this.display_value}}</option>{{/ifNotEquals}}{{/each}}')),m+=CrmPageLayout.MultiPipelineOptionsTemplate({optionClass:"pipeOptions",optionValues:c[0][a].pick_list_values}),t.append(m),t.val("none").trigger("change");break}d==n&&r.removeClass("inActLab")}commonUtils.showHideLoadingDiv()})))},CrmPageLayout.getStageOptions=function(){var e=$("#stageOpt"),t=$("#pipeOpt").val(),a=$("#layoutOpt").val();if(e.find(".stageOptions").remove(),"none"!=t)for(var i=store.peekAll("layout").filterBy({id:a})[0].sections,r=i.length,l=0;l<r;l++){var n=i[l].fields.filterBy({column_name:"PIPELINE"});if(0!=n.length){for(var s=n[0][a].pick_list_values,o=s.length,d=0;d<o;d++)if(s[d].display_value===t&&s[d].maps){for(var c="",m=s[d].maps,u=m.length,p={},g=store.peekAll("field").filterBy({column_name:"STAGE"})[0].api_name,v=0;v<u;v++)if(m[v].api_name===g){p=m[v];break}c+=CrmPageLayout.MultiPipelineOptionsTemplate({optionClass:"stageOptions",optionValues:p.pick_list_values}),e.append(c),e.val("none").trigger("change");break}break}}else e.val("none").trigger("change")},CrmPageLayout.activateTransferButton=function(e){var t="delete"==e?$("#deleteBtn"):"statusChange"==e?$("#statusBtn"):null;if(t){var a=$("#stageOpt").val();"none"!=a&&"-None-"!=a?t.removeClass("inActLab"):t.addClass("inActLab")}},CrmPageLayout.activateButton=function(e){"Potentials"==CrmPageLayout.module&&Crm.userDetails.isMultiPipelineActivated&&"delete"===e?CrmPageLayout.handlePotentialLayouts():"delete"==e?"none"!=$("#layoutOpt").val()?$("#deleteBtn").removeClass("inActLab"):$("#deleteBtn").addClass("inActLab"):"statusChange"==e&&("none"!=$("#layoutOpt").val()?$("#statusBtn").removeClass("inActLab"):$("#statusBtn").addClass("inActLab"))},CrmPageLayout.showLayoutPermission=function(e,t,a){CrmPageLayout.profileDetails={};var i={};""!=a&&null!=a||(a=$("#layoutNameSpan").text()),CrmPageLayout.posReset(),i.module=CrmPageLayout.module,i.pageType=e,null!=t&&(i.layoutId=t,CrmPageLayout.layoutId=t),jQuery.ajax({type:"GET",url:Crm.getCrmBasePath()+"/PageLayout.do?action=showPermissionPage",data:i,dataType:"html",success:function(e){CrmPageLayout.newProfileList=[],CrmPageLayout.removedProfileList=[],$("#layoutActionInfoDiv").html("").html(e),$("#pLayoutName").text(a),CrmModule.ppFromTop("crmLayoutPerDiv"),thirdPartyUtils.bindSelect2("#layoutProfileId",{no_results_text:I18n.getMsg("crm.no.profile.found"),placeholder_text_multiple:I18n.getMsg("crm.label.select.profiles.click")});var t=$("#layoutProfileId");t.on("select2:select",(function(e){CrmPageLayout.associateNewProfile(e.params.data.id)})),t.on("select2:unselect",(function(e){if(CrmPageLayout.validateRemovingLayout(e.params.data.id))CrmPageLayout.removeProfile(e.params.data.id);else{var t=$("#layoutProfileId");t.find("option[value="+e.params.data.id+"]").prop("selected",!0),t.select2()}}))}})},CrmPageLayout.validateRemovingLayout=function(e){return CrmPageLayout.profileIdVSDefaultLayout[e]==CrmPageLayout.layoutId?($("#defalutLayoutInfo").show(),!1):($("#defalutLayoutInfo").hide(),!0)},CrmPageLayout.associateNewProfile=function(e){if($("#defalutLayoutInfo").hide(),null==CrmPageLayout.currProfileIdList||CrmPageLayout.currProfileIdList.contains(e)){for(var t=[],a=CrmPageLayout.removedProfileList,i=a.length,r=0;r<i;r++)a[r]!=e&&t.push(a[r]);CrmPageLayout.removedProfileList=""==t?[]:t}else CrmPageLayout.newProfileList.push(e)},CrmPageLayout.removeProfile=function(e){if(null==CrmPageLayout.currProfileIdList||CrmPageLayout.currProfileIdList.contains(e))CrmPageLayout.removedProfileList.push(e);else{for(var t=[],a=CrmPageLayout.newProfileList,i=a.length,r=0;r<i;r++)a[r]!=e&&t.push(a[r]);CrmPageLayout.newProfileList=""==t?[]:t}},CrmPageLayout.removeProfileInfoDiv=function(){CrmModule.hide("crmLayoutPerDiv"),setTimeout((function(){$("#layoutActionInfoDiv").empty()}),1e3)},CrmPageLayout.editLayoutName=function(e,t,a){var i=null;CrmPageLayout.removeErrorAlert(),null!=e&&"list"==e?(i=$("#layoutName_"+t).text().trim(),CML.showModuleInfoNPermission("layoutInfo","list",CrmPageLayout.tabId,"edit","save"),$("#saveLayoutName").attr("onClick","CrmPageLayout.saveLayoutName('"+e+"','"+t+"','"+i+"')")):(i=$("#layoutNameSpan").text().trim(),void 0!==a&&a?($("#saveMPBtn").attr("onClick","CrmPageLayout.saveLayoutName('"+e+"',undefined,'"+i+"',"+a+")"),CML.showModuleInfoNPermission("layoutInfo","builder",void 0,void 0,"save")):($("#saveMPBtn").attr("onClick","CrmPageLayout.saveLayoutName('"+e+"','"+t+"','"+i+"')"),CML.showModuleInfoNPermission("layoutInfo","builder",CrmPageLayout.tabId,"edit","save"))),$("#disp_LayoutName1").val(i),CrmPageLayout.triggerSavetbn("#infoNPermissionDiv","#disp_LayoutName1",".newSaveBtn")},CrmPageLayout.saveLayoutName=function(e,t,a,i){var r=$("#disp_LayoutName1"),l=r.val().trim(),n=$("#layoutErrorDiv"),s=$("#duplicateErrorTR"),o=$("#moduleCustomizationDiv");if(a===l)return CrmModule.hide("infoNPermissionDiv"),CrmPageLayout.showMsgBand(o,"success",I18n.getMsg("crm.label.no.changes"),4e3),!1;if(""==l)return r.addClass("errFieldBdr"),r.focus().select(),n.text(I18n.getMsg("crm.alert.enter.layout.name")),s.show(),!1;if(void 0===i||!i){var d=CrmPageLayout.usedLayoutNames.slice(0,CrmPageLayout.usedLayoutNames.length);if(d.removeFirstOccurenceOfElement(a.toLowerCase()),d.contains(l.toLowerCase()))return r.addClass("errFieldBdr"),r.focus().select(),n.text(I18n.getMsg("crm.label.layoutname.dupl")),s.show(),!1}if(!CML.splCharCheckForTab(l))return r.addClass("errFieldBdr"),r.focus().select(),n.text(I18n.getMsg("crm.mb.module.splc")),s.show(),!1;if("list"!==e&&void 0!==CML.layoutLabelRegex&&CML.layoutLabelRegex.test(l.toLowerCase()))return r.addClass("errFieldBdr"),r.focus().select(),n.text(I18n.getMsg("crm.label.layoutname.sykw")),s.show(),!1;if(void 0!==i&&i)CrmModule.hide("infoNPermissionDiv"),$("#layoutNameSpan").text(l),CMB.nCHolder.isLayoutRenamed=!0;else{var c={};c.crmcsrfparam=$('[name="crmcsrfparam"]').val(),c.layoutId=t,c.layoutName=l,CrmPageLayout.systemLayoutId==t&&(c.systemLayoutId=CrmPageLayout.systemLayoutId),jQuery.ajax({type:"POST",url:Crm.getCrmBasePath()+"/PageLayout.do?action=updateLayoutName&module="+CrmPageLayout.module,dataType:"text",data:c,success:function(i){void 0!==(i=JSON.parse(i)).WRNG?CrmPageLayout.showMsgBand(o,"error",i.WRNG.layoutName,4e3):void 0!==i.ERROR?CrmPageLayout.showMsgBand(o,"error",i.ERROR,4e3):(CrmPageLayout.layoutIdNameMap[t]=i.layoutName,CrmPageLayout.allLayoutIdNameMap[t]=i.layoutName,CrmPageLayout.usedLayoutNames.removeFirstOccurenceOfElement(a.toLowerCase()),CrmPageLayout.usedLayoutNames.push(i.layoutName.toLowerCase()),"list"==e?($("#layoutNameTD_"+t).attr("title",i.layoutName),$("#layoutName_"+t).find(".moduleNameMPL").html(i.layoutName)):($("#layoutListDiv").find("ul").find(".result-selected").html(i.layoutName),$("#layoutNameSpan").html(i.layoutName)),CrmModule.hide("infoNPermissionDiv"),CrmPageLayout.showMsgBand($("#moduleCustomizationDiv"),"success",I18n.getMsg("crm.label.layoutname.updated.sucess"),4e3),store.peekRecord("module",moduleRecordMapping[CrmPageLayout.module].id).custom_view=void 0)},error:function(){return CrmPageLayout.showMsgBand($("#moduleCustomizationDiv"),"alert",I18n.getMsg("crm.label.module.operation.fail"),4e3),!1}})}},CrmPageLayout.removeErrorAlert=function(){$("#duplicateErrorTR").hide(),$("#disp_LayoutName1").removeClass("errFieldBdr")},CrmPageLayout.showLayoutActions=function(e){if("Users"===CrmPageLayout.module)return!1;if(CrmPageLayout.totalLayoutCnt>=1)$("#settings_"+e).addClass("activeMenu");else{var t=$("#layoutsListDIV table tr[name='layout_list']");t.addClass("defRow"),t.children().find("#chngStatus a").addClass("defaultcursor")}},CrmPageLayout.hideLayoutActions=function(e){CrmPageLayout.totalLayoutCnt>=1&&($("#settings_"+e).removeClass("activeMenu"),$("#layoutActionsDiv").hide())},CrmPageLayout.showLayoutList=function(){$("#moduleRelatedDropDown").hide(),$("#existLayoutNameDiv").toggleClass("bb0");var e=$("#createLayout");CrmPageLayout.totalLayoutCnt-CrmPageLayout.nonStandardSystemGivenLayoutCount>=CrmPageLayout.maxLayoutCnt?(e.addClass("disableModule"),e.off("click"),e.on({mouseenter:function(){CrmModule.newshowtt(I18n.getMsg("crm.alert.layout.limit.reached",CrmPageLayout.maxLayoutCnt-1))},mouseleave:function(){CrmModule.newhidett()}})):3===Crm.userDetails.ORG_TYPE&&1===Crm.moduleInfo[CrmPageLayout.module].genType?(e.addClass("disableModule"),e.off("click"),e.on({mouseenter:function(){CrmModule.newshowtt(I18n.getMsg("crm.not.supported.extension",4e3))},mouseleave:function(){CrmModule.newhidett()}})):CrmPageLayout.isMPLAvailable?e.on("click",(function(){CrmPageLayout.createPageLayout()})):(e.addClass("disableModule"),e.off("click"),e.on({mouseenter:function(){CrmModule.newshowtt(I18n.getMsg("crm.alert.layout.grace.period"),!0)},mouseleave:function(){CrmModule.newhidett()}})),"JobSheets"===CrmPageLayout.module&&e.hide(),$("#layoutListDiv").show();var t=$("#layoutListUL").width();$("#searchLayout").css({width:t-30})},CrmPageLayout.enableChangeBtn=function(e){e==$("#prevLayoutId").val()?$("#okBtn").addClass("disabled").prop("disabled",!0):$("#okBtn").removeClass("disabled").prop("disabled",!1)},CrmPageLayout.showMoreLayouts=function(e){void 0!==CMB.newTooltipTimeoutId&&clearTimeout(CMB.newTooltipTimeoutId),$("#hovertooltip,#hovertransitiontooltip").hide();var t=$(e);CMB.showTooltip(t.next(".moreusers").html(),t)},CrmPageLayout.hideMoreLayouts=function(e){clearTimeout(CMB.newTooltipTimeoutId),CMB.newTooltipTimeoutId=setTimeout((function(){0===$("#hovertooltip:hover").length&&$("#hovertooltip").hide()}),200),$(e).next(".moreusers").addClass("hide")},CrmPageLayout.openLayout=function(e,t){var a,i="Crm_"+t+"_LAYOUTID";$("#"+i).val()||(i="layoutDetails"),a=$(".changeDefLayout").hasClass("hide")?Crm.getCrmBasePath()+"/settings/modules/"+t+"/layouts/"+$("#zCampIntegLayout").val():Crm.getCrmBasePath()+"/settings/modules/"+t+"/layouts/"+$("#"+i).val(),$(e).attr("href",a)},CrmPageLayout.resetLayoutAssignmentAttr=function(){CrmPageLayout.newLayoutList={},CrmPageLayout.removedLayoutList={},CrmPageLayout.newProfileIdVSDefaultLayout={},CrmPageLayout.profileLayoutTypeMap={}},CrmPageLayout.resetChanges=function(){CrmPageLayout.layoutIdNameMap={},CrmPageLayout.usedLayoutNames={},CrmPageLayout.profileIdVSDefaultLayout={},CrmPageLayout.newProfileIdVSDefaultLayout={},CrmPageLayout.profileLayoutTypeMap={},CrmPageLayout.profileVSLayout={},CrmPageLayout.editTop=[],CrmPageLayout.newLayoutList={},CrmPageLayout.removedLayoutList={},CrmPageLayout.currProfileIdList=[],CrmPageLayout.newProfileList=[],CrmPageLayout.removedProfileList=[],CrmPageLayout.activeLayoutCnt=0,CrmPageLayout.totalLayoutCnt=0,CrmPageLayout.maxLayoutCnt=0,CrmPageLayout.layoutOperation=void 0,$("body").removeClass("builder_page_body")},CrmPageLayout.searchLayoutByName=function(){var e=$("#searchLayout").val().trim().toLowerCase();if(e.length>1)for(var t=$("#layoutListUL").find("li"),a=t.length,i=0;i<a;i++){var r=t.eq(i),l=r.html();null!=l&&""!=l&&(-1==(l=l.toLowerCase()).indexOf(e)?r.hide():r.show())}else $("#layoutListUL").find("li").show()},CrmPageLayout.triggerSavetbn=function(e,t,a){$(e).find(t).on("keyup",(function(t){13==t.which&&$(e).find(a).trigger("click")}))},CrmPageLayout.openCreateOrEditfldPopup=function(){var e=CrmPageLayout.layout_jsonarrayObj;if(e.activeLayoutCnt>1){for(var t=e.layout_jsonarrayObj.length,a=$(document.createDocumentFragment()),i=0;i<t;i++){var r=e.layout_jsonarrayObj[i];if(!0===r.STATUS){var l=$("<option>",{value:r.LAYOUTID,text:r.LAYOUTNAME});"true"===r.ISSYSTEMLAYOUT&&l.prop("selected",!0),l.attr("data-zcqa","MPL_layout_"+r.LAYOUTNAME),a.append(l)}}var n=$("#selectLayoutDiv");CrmModule.ppFromTop("selectLayoutDiv");var s=n.find("#allExistingLayoutIds");n.find("#saveMPBtn").attr("onclick","CrmPageLayout.openLayoutFromFieldsPage(this)"),s.children().remove().end(),s.append(a)}else Lyte.Router.getRouteInstance().transitionTo("crm.settings.section.modules.module.layouts.view-layout",$("#ModuleListUL").val(),e.sysLayoutId)},CrmPageLayout.openLayoutFromFieldsPage=function(e){CrmModule.hide("selectLayoutDiv");var t=$("#ModuleListUL").val(),a=$(e).closest("#selectLayoutDiv").find("#allExistingLayoutIds").val();Lyte.Router.getRouteInstance().transitionTo("crm.settings.section.modules.module.layouts.view-layout",t,a)},CrmPageLayout.cancelBuilder=function(){var e=!1,t=$("#mplay_cancelBtn").attr("data-params");t&&(e="showLayoutTab"==JSON.parse(t).action),moduleRecordMapping[CrmPageLayout.module]&&e?Lyte.Router.getRouteInstance().transitionTo("crm.settings.section.modules.module.layouts.index-layouts",CrmPageLayout.module):Lyte.Router.getRouteInstance().transitionTo("crm.settings.section.modules")},CrmPageLayout.deleteExtraSubformLayout=function(e){if(store.peekRecord("layout",e)){var t=store.peekRecord("layout",e).child_layouts?store.peekRecord("layout",e).child_layouts:[];store.unloadRecord("layout",e),t[0]&&t.forEach((function(e){store.unloadRecord("layout",e)}))}},CrmPageLayout.configureAppointments=function(e){return"ask_appointment_provider_to_complete"===e.when_duration_exceeds?e.ask_app_provider=!0:e.ask_app_provider=!1,"create_deal"===e.when_appointment_completed?e.create_deal=!0:e.create_deal=!1,e},CrmPageLayout.showOrHideJobsheetLayout=function(){$("#jobSheetLayoutsLI").hide()},CrmPageLayout.assignLayoutType=function(e,t,a){CrmPageLayout.profileLayoutTypeMap[e]=CrmPageLayout.profileLayoutTypeMap[e]?CrmPageLayout.profileLayoutTypeMap[e]:{},CrmPageLayout.profileLayoutTypeMap[e][t]=a.value};var mergeFieldsConstants={variable:"variable",system:"system",custom_lookup:"custom_lookup",system_module_lookup:"system_module_lookup",system_field_lookup:"system_field_lookup",unrelated_module:"unrelated_module",polymorphic_lookup:"polymorphic_lookup",subform_module:"subform_module",fromlabel_to_api:"labeltoapi",fromlabel_to_id:"labeltoid",fromapi_to_label:"apitolabel",Lookup:"Lookup:",mxn_lookup:"mxn_lookup",multilevel_lookup:"multilevel_lookup",mxn:"mxn"},CrmConvertMergeFields={getUnsupportedMergeFields:function(e,t,a,i){var r,l=new RegExp(/\$\{([^\{|^\}]*)\}/g);i&&(l=new RegExp(/\#\{([^\{|^\}]*)\}/g));var n="${"+I18n.getMsg("crm.template.email.unsupported.merge.field")+"}",s=[];for((e.indexOf("${Unsupported_Field}")>-1||e.indexOf(n)>-1)&&s.push(n);r=l.exec(e);){var o=r[0],d=r[1].split("."),c=d[0];if("ZSURVEY"===c||"Datarequest"===c)CrmConvertMergeFields.isModuleAvail(a,c)||s.push(o);else if(d.length>1){CrmConvertMergeFields.getModuleAndFieldInfo(a,d,t)||s.push(o)}else"userSignature"!==c&&"companyLogo"!==c&&"serialNumber"!==c&&s.push(o)}return s},getFieldsUsedInContent:function(e,t,a,i,r){var l,n=[],s=new RegExp(/\$\{([^\{|^\}]*)\}/g);for(r&&(s=new RegExp(/\#\{([^\{|^\}]*)\}/g));l=s.exec(e);){var o=l[1].split("."),d=o[0];if("Datarequest"!==d&&"ZSURVEY"!==d&&o.length>1){var c=CrmConvertMergeFields.getModuleAndFieldInfo(a,o,t);if(c){var m=c.field,u=m.data_type;if(i&&!i.includes(u))continue;n.push(m)}}}return n},getFieldsUsedInContent:function(e,t,a,i,r){var l,n=[],s=new RegExp(/\$\{([^\{|^\}]*)\}/g);for(r&&(s=new RegExp(/\#\{([^\{|^\}]*)\}/g));l=s.exec(e);){var o=l[1].split("."),d=o[0];if("Datarequest"!==d&&"ZSURVEY"!==d&&o.length>1){var c=CrmConvertMergeFields.getModuleAndFieldInfo(a,o,t);if(c){var m=c.field,u=m.data_type;if(i&&!i.includes(u))continue;n.push(m)}}}return n},convertMergeFieldsAsRequiredFormat:function(e,t,a,i,r){var l=new RegExp(/\$\{([^\{|^\}]*)\}/g);r&&(l=new RegExp(/\#\{([^\{|^\}]*)\}/g));for(var n,s,o=0,d=e;s=l.exec(e);){var c=s[0],m=s[1].split("."),u=m[0];if(t===mergeFieldsConstants.fromapi_to_label&&(u=u.substring(1)),"Datarequest"!==u&&"ZSURVEY"!==u)if(m.length>1){var p=CrmConvertMergeFields.getModuleAndFieldInfo(a,m,t);if(p){var g=p.module,v=p.field,h=p.lookuprelfield;n=c.length;var f=CrmConvertMergeFields.getConvertedMergeField(g,v,h,t,i,r,p.multiLevelModule,p.parentMod);d=d.substring(0,s.index+o)+f+d.substring(l.lastIndex+o),o+=f.length-n}}else if("userSignature"===u||"companyLogo"===u||"serialNumber"===u||"${Current Record}"===e||"${!CURRENTRECORD}"===e){n=c.length;var y=r?"#{":"${";if(y=t===mergeFieldsConstants.fromlabel_to_api?y+"!":y,t===mergeFieldsConstants.fromlabel_to_api&&"${Current Record}"===e)return"${!CURRENTRECORD}";if(t===mergeFieldsConstants.fromapi_to_label&&"${!CURRENTRECORD}"===e){if(v=wfmergefield.getFieldObj(wfmergefield.getMainModule(),"CURRENTRECORD"))return y+v.field_label+"}"}else f=y+u+"}";d=d.substring(0,s.index+o)+f+d.substring(l.lastIndex+o),o+=f.length-n}}return d},getConvertedMergeField:function(e,t,a,i,r,l,n,s){var o,d,c,m,u,p,g=CrmConvertMergeFields.getReplaceField(t,i);if(CrmConvertMergeFields.isStaticField(t)){if(i===mergeFieldsConstants.fromlabel_to_id)return"${"+t.id+"}";if(i===mergeFieldsConstants.fromapi_to_label)return"${"+t.field_label+"}"}if(g){var v,h,f,y,C,b,T,I=e.type,w=e.display_name,L=e.api_name,k=e.name,$=e.id,P=e.lookup_details;P&&(v=e.parent_module_api_name,h=P.api_name,f=P.display_label,y=P.id,c=I===mergeFieldsConstants.custom_lookup||I===mergeFieldsConstants.system_field_lookup,m=I===mergeFieldsConstants.subform_module||I===mergeFieldsConstants.system_module_lookup||I===mergeFieldsConstants.custom_lookup||I===mergeFieldsConstants.system_field_lookup,d=I===mergeFieldsConstants.polymorphic_lookup,u=I===mergeFieldsConstants.mxn_lookup,p=!(!n||!s)),a&&(p?(v=s.api_name,h=e.api_name,L=a.api_name,b=void 0,w=n.display_name):(C=a.api_name,b=a.field_label,T=a.id)),I===mergeFieldsConstants.variable&&i===mergeFieldsConstants.fromlabel_to_id&&(k=$);var D=l?"#{":"${";if(i===mergeFieldsConstants.fromlabel_to_id)o=p?D+v+"."+h+"."+L+"."+g+"}":u?D+v+"."+y+"."+g+"}":c?D+mergeFieldsConstants.Lookup+y+"."+g+"}":D+k+(T?"."+T:"")+"."+g+"}";else if(i===mergeFieldsConstants.fromapi_to_label)if(r){var M=CrmConvertMergeFields.getConvertedMergeField(e,t,a,mergeFieldsConstants.fromlabel_to_api,!1,l),_=document.createElement("span");_.setAttribute("value",M),_.contentEditable=!1;var E="";E=c?mergeFieldsConstants.Lookup+f+" - "+g:w+(b?" - "+b:"")+" - "+g,"variable"===e.type&&"Deluge"===wfmergefield.actionName&&(E=I18n.getMsg("crm.crmvariables.new",Crm.appName)+" - "+E),_.textContent=E,_.style.color="cornflowerblue",_.setAttribute("class","mergespan"),_.title=E,o=_.outerHTML}else o=c?D+mergeFieldsConstants.Lookup+f+"."+g+"}":u?D+v+"."+f+"."+g+"}":D+w+(b?"."+b:"")+"."+g+"}";else i===mergeFieldsConstants.fromlabel_to_api&&(p&&(o=D+"!"+v+"."+h+"."+L+"."+g+"}"),o=u&&v?D+"!"+v+"."+h+"."+g+"}":d&&v?D+"!"+v+"."+h+"->"+L+"."+g+"}":m&&v?D+"!"+v+"."+h+"."+g+"}":D+"!"+L+(C?"."+C:"")+"."+g+"}")}return o},isStaticField:function(e){return["CURRENTRECORD"].indexOf(e.id)>=0},getModuleAndFieldInfo:function(e,t,a){var i,r,l=t.length,n=0,s=t[0],o=!1;a===mergeFieldsConstants.fromapi_to_label&&(s=s.substring(1)),a!==mergeFieldsConstants.fromlabel_to_api&&a!==mergeFieldsConstants.fromlabel_to_id||s.startsWith(mergeFieldsConstants.Lookup)&&(s=s.substring(7),o=!0);var d=!1;do{var c=CrmConvertMergeFields.getModuleandFieldsObj(e,s,o,!1,!1,a);if(i=c,c){var m=n+1,u=t[m];if(u=CrmConvertMergeFields.replaceHtmlEncodedChars(u),a===mergeFieldsConstants.fromapi_to_label){var p=u.split("->");if(p.length>1)c=CrmConvertMergeFields.getModuleandFieldsObj(e,p[1],!1,!1,!1,a),u=t[++m];else if(!CrmConvertMergeFields.isOrchestrationModule(c.module.name)){var g=CrmConvertMergeFields.getFieldObject(c,u,a);if(g&&g.lookup_module){var v=g.api_name,h=CrmConvertMergeFields.getModuleandFieldsObj(e,g.lookup_module.api_name,!1,!1,!0,mergeFieldsConstants.fromapi_to_label,v);h&&m<l-1&&(c=h,u=t[++m])}}}var f=c.module;if("mxn"===f.type&&l>2){s=t[1];o=!0,n++;continue}var y=CrmConvertMergeFields.getFieldInfoFromFieldPart(e,c,u,a,t,m,l);if(y)(a!==mergeFieldsConstants.fromlabel_to_api||f.lookup_details&&f.type!==mergeFieldsConstants.custom_lookup&&f.type!==mergeFieldsConstants.system_field_lookup||f.lookup_details&&t[0].startsWith(mergeFieldsConstants.Lookup)||!f.lookup_details&&!t[0].startsWith(mergeFieldsConstants.Lookup))&&(d=!0),d&&((r=y).module=f,y.multiLevelModule&&(r.parentMod=i.module,n++));else if("Unsubscribe"===f.name){var C=CrmConvertMergeFields.getUnsubscribeFieldInfo(a,u);C&&((r=C).module=f)}}s+="."+t[++n]}while(n<l-1&&!d);return r},getFieldInfoFromFieldPart:function(e,t,a,i,r,l,n){var s,o,d=CrmConvertMergeFields.getFieldObject(t,a,i);if(d&&d.lookup_module&&l<n-1){var c=!d.lookup_module.mutilevel_lookup;t=CrmConvertMergeFields.getModuleandFieldsObj(e,d.lookup_module.api_name,!1,c,!1,mergeFieldsConstants.fromapi_to_label),o=d,d=void 0,a=""}return d&&l===n-1?(s={}).field=d:l<n-1&&t&&(""!==a&&(a+="."),a+=r[++l],(s=CrmConvertMergeFields.getFieldInfoFromFieldPart(e,t,a,i,r,l,n))&&o&&(s.lookuprelfield=o,t.module.type===mergeFieldsConstants.multilevel_lookup&&(s.multiLevelModule=t.module))),s},isModuleAvail:function(e,t){var a,i,r=e.mergefields;if(r)for(var l=r.length,n=0;n<l;n++){if((a=r[n]).module.name===t){i=!0;break}}return!!i&&a},getModuleandFieldsObj:function(e,t,a,i,r,l,n){var s,o=!1;t=CrmConvertMergeFields.replaceHtmlEncodedChars(t);var d=e.mergefields;i&&(d=template&&template.fetchMergeFieldsAPIJson?template.fetchMergeFieldsAPIJson(t).mergefields:e.lookuprelmergefields);if(d)for(var c=d.length,m=0;m<c;m++){var u=(s=d[m]).module;if("Datarequest"!==u.name){var p=u.api_name;"Execution_Info"!==p||"Execution_Info"!==t&&"Execution Info"!==t||(p=t);var g,v,h=u.display_name,f=u.name,y=u.lookup_details;if(y&&(g=y.display_label,v=y.api_name),l===mergeFieldsConstants.fromapi_to_label){if(p===t){if(!r){o=!0;break}if(u.type!==mergeFieldsConstants.system_module_lookup&&u.type!==mergeFieldsConstants.subform_module&&u.type!==mergeFieldsConstants.custom_lookup&&u.type!==mergeFieldsConstants.system_field_lookup)continue;if(!n){o=!0;break}if(r&&n===v){o=!0;break}}else if(v===t&&u.type===mergeFieldsConstants.mxn_lookup){o=!0;break}}else if(l===mergeFieldsConstants.fromlabel_to_api||l===mergeFieldsConstants.fromlabel_to_id)if(a){if(g===t){o=!0;break}}else{if(h===t){o=!0;break}if(u.type===mergeFieldsConstants.mxn&&(f===t||p===t)){o=!0;break}}}}return o?s:void 0},getFieldObject:function(e,t,a){var i,r=e.sections,l=r.length,n=a===mergeFieldsConstants.fromlabel_to_api,s=a===mergeFieldsConstants.fromlabel_to_id,o=a===mergeFieldsConstants.fromapi_to_label,d=!1;t=CrmConvertMergeFields.replaceHtmlEncodedChars(t);for(var c=0;c<l;c++){for(var m=r[c].fields,u=m.length,p=0;p<u;p++)if(i=m[p],n||s){if(t===i.field_label){d=!0;break}}else if(o&&t===i.api_name){d=!0;break}if(d)break}return d?i:void 0},getReplaceField:function(e,t){var a;return t===mergeFieldsConstants.fromlabel_to_api?a=e.api_name:t===mergeFieldsConstants.fromapi_to_label?a=e.field_label:t===mergeFieldsConstants.fromlabel_to_id&&(a=e.id),a},getAllModulesAndFields:function(e){for(var t=e.modules,a=e.details,i=a.length,r=t.length,l=[],n={},s=0;s<r;s++)for(var o=t[s],d=o.name,c=0;c<i;c++){var m=a[c],u=m.module;if(d===u.name){var p={},g={};g.id=u.id,g.name=u.name,g.api_name=u.api_name,g.singular_label=u.singular_label,g.display_name=o.display_name,g.custom_module=u.custom_module;var v=o.type;g.type=v,g.lookup_details=o.lookup_details,g.parent_module_api_name=o.parent_module_api_name,p.module=g;var h=m.sections;p.sections=h,l.push(p);break}}return n.mergefields=l,n},convert:function(e,t,a){var i,r,l,n,s,o,d="${"+I18n.getMsg("crm.template.email.unsupported.merge.field")+"}",c="";c=a?new RegExp(/(\#\{)(.+?)\.(.+?)\}/g):new RegExp(/\$\{serialNumber\}|\$\{userSignature\}|\$\{companyLogo\}|\$\{Unsupported_Field\}|(\$\{)(.+?)\.(.+?)\}/g);var m,u=["&amp;","&#39;","&quot;","&lt;","&gt;","&nbsp;","%28","%29","%3C","%3E","%20","%7B","%7D","%27"],p=["&","'",'"',"<",">"," ","(",")","<",">"," ","{","}","'"],g=e,v=0,h="";for(e=e.replace(d,"${Unsupported_Field}");i=c.exec(e);){r=i[2],l=i[3],s=null,o=null;var f=r;if(null!=r){r.startsWith(mergeFieldsConstants.Lookup)&&(r=r.substring(7)),m=r.length+l.length;for(var y=u.length,C=0;C<y;C++){var b=new RegExp(u[C],"g");r=r.replace(b,p[C]),l=l.replace(b,p[C]),f=f.replace(b,p[C])}if((s=f.startsWith(mergeFieldsConstants.Lookup)?t[mergeFieldsConstants.Lookup+r]:t[r])&&(s=s.label),!s){var T=l.split("."),I=T.length-1;for(C=0;I--;)if(r=r+"."+T[C],C++,(s=f.startsWith(mergeFieldsConstants.Lookup)?t[mergeFieldsConstants.Lookup+r]:t[r])&&(s=s.label),s){l=f.startsWith(mergeFieldsConstants.Lookup)?l.substring(r.length-f.length+7):l.substring(r.length-f.length);break}}(n=f.startsWith(mergeFieldsConstants.Lookup)?t[mergeFieldsConstants.Lookup+r]:t[r])&&(n=n.field)&&(o=n[l],h.indexOf(o)>-1||isNaN(o)||(h=h+o+",",isNaN(s)||(h=h+s+","))),null==o&&(o=l),null!=s&&f.startsWith(mergeFieldsConstants.Lookup)?(g=g.substring(0,i.index+2+v)+f.substring(0,7)+s+"."+o+"}"+g.substring(c.lastIndex+v),v+=s.length+o.length-m):null!=s&&(g=g.substring(0,i.index+2+v)+s+"."+o+"}"+g.substring(c.lastIndex+v),v+=s.length+o.length-m)}}return{content:g,fieldIds:h}},getUnsupportedFieldsList:function(e,t,a,i){var r,l,n,s,o,d,c="${"+I18n.getMsg("crm.template.email.unsupported.merge.field")+"}",m="${Unsupported_Field}",u="";u=a?new RegExp(/(\#\{)(.+?)\.(.+?)\}/g):new RegExp(/\$\{serialNumber\}|\$\{userSignature\}|\$\{companyLogo\}|\$\{Unsupported_Field\}|\$\{ZSURVEY\.(.+?)\}|\$\{(.+?)\.(.+?)\}|\$\{Campaigns\.Registration URL\}/g);var p=["&amp;","&#39;","&quot;","&lt;","&gt;","&nbsp;","%28","%29","%3C","%3E","%20","%7B","%7D","%27"],g=["&","'",'"',"<",">"," ","(",")","<",">"," ","{","}","'"],v=[];for((e=e.replace(c,m)).indexOf(m)>-1&&v.push(c);r=u.exec(e);){l=r[2],n=r[3],o=null,d=null;var h=l;if(("Datarequest"!==l||-1===r[0].search(/\$\{Datarequest\.[a-zA-Z_]+\}/))&&null!=l){l.startsWith(mergeFieldsConstants.Lookup)&&(l=l.substring(7));for(var f=p.length,y=0;y<f;y++){var C=new RegExp(p[y],"g");l=l.replace(C,g[y]),n=n.replace(C,g[y]),h=h.replace(C,g[y])}if((o=h.startsWith(mergeFieldsConstants.Lookup)?t[mergeFieldsConstants.Lookup+l]:t[l])&&(o=o.label),!o){var b=n.split("."),T=b.length-1;for(y=0;T--;)if(l=l+"."+b[y],y++,(o=h.startsWith(mergeFieldsConstants.Lookup)?t[mergeFieldsConstants.Lookup+l]:t[l])&&(o=o.label),o){n=h.startsWith(mergeFieldsConstants.Lookup)?n.substring(l.length-h.length+7):n.substring(l.length-h.length);break}}o?((s=h.startsWith(mergeFieldsConstants.Lookup)?t[mergeFieldsConstants.Lookup+l]:t[l])&&(s=s.field)&&(d=s[n]),null==d&&(i?v.push(l+" - "+n):v.push(r[0]))):i?v.push(l+" - "+n):v.push(r[0])}}return v},fetchMergeFieldsAPIJson:function(e,t,a,i,r,l){var n={};n.module=e,t&&(n.relatedmodules=t),i&&(n.type=i),n.includelookups=a,commonUtils.showHideLoadingDiv(!0),(new crmRequestPool).initiate({action:"/crm/v2/settings/mergefields",type:"GET",headers:{"X-ZCSRF-TOKEN":csrfParamName+"="+csrfToken},data:n,success:function(e){commonUtils.showHideLoadingDiv(!1);var t=CrmConvertMergeFields.getAllModulesAndFields(e.mergefields);l&&l(t,r)}})},fetchMergeFieldsAPIJsonForLookups:function(e,t){var a,i=e.join(","),r={};return r.modules=i,t&&(r.type=t),commonUtils.showHideLoadingDiv(!0),(new crmRequestPool).initiate({action:"/crm/v2/settings/lookupmergefields",type:"GET",headers:{"X-ZCSRF-TOKEN":csrfParamName+"="+csrfToken},data:r,async:!1,success:function(e){commonUtils.showHideLoadingDiv(!1),a=CrmConvertMergeFields.getAllModulesAndFields(e.mergefields)}}),a},getMergeFieldsofDataType:function(e,t,a,i,r){for(var l=(a=JSON.parse(JSON.stringify(a))).mergefields,n=l.length,s=0;s<n;s++){for(var o=l[s].module,d=o.name,c=!o.lookup_details&&e&&d==e,m=l[s].sections,u=m.length,p=0;p<u;p++){var g=m[p],v=g.fields,h=CrmConvertMergeFields.filterFieldsArrForDataType(o,c,t,v,i,r);h.length<1?(m.splice(p,1),p--,u--):g.fields=h}m.length<1&&(l.splice(s,1),s--,n--)}return a},getFieldJSONFromMergeFieldJSON:function(e,t,a){for(var i=e.mergefields,r=i.length,l=0;l<r;l++){if(i[l].module.name===t)for(var n=i[l].sections,s=n.length,o=0;o<s;o++)for(var d=n[o].fields,c=d.length,m=0;m<c;m++){var u=d[m];if(u.id===a)return JSON.parse(JSON.stringify(u))}}},removeUnsupportedMultilevels:function(e,t){var a=$L("crm-orchestration-builder").e[0].component;if(t=a.currentStateData)for(var i=Lyte.registeredMixins.orchestration_validation.getOrchestrationModule(),r=t.instanceType,l=t.instanceIndex,n=t.statetransId,s=e.mergefields,o=s.length,d=0;d<o;d++){if(s[d].module.name===i){for(var c=s[d].sections,m=c.length,u=0;u<m;u++){var p=c[u],g=p.fields.filter((function(e){if(e.multilevel)for(var t=e.multilevel_props,i=1;i<=10;i++){var s=t["level"+i];if(!s)break;var o=s.type;if(a.isActionInstanceType(o)){var d,c=t["level"+(i-1)];if(n&&c.id===n)if("instant_action"!==o&&(d=a.getInstanceIndexFromSection(o),o=a.getInstanceTypeFromSection(o)),o===r){if("instant_action"===r||l===d)return!1}else if("instant_action"===r&&"instant_action"!==o)return!1}}return!0}));g.length<1?(c.splice(u,1),u--,m--):p.fields=g}c.length<1&&(s.splice(d,1),d--,o--)}}},removeUnsupportedModules:function(e,t){for(var a=e.mergefields,i=a.length,r=0;r<i;r++){var l=a[r].module;CrmConvertMergeFields.presentinJSONArray(l.name,t)&&(a.splice(r,1),i--,r--)}},presentinJSONArray:function(e,t){for(var a=t.length,i=0;i<a;i++)if(t[i]===e)return!0;return!1},isOrchestrationModule:function(e){return e.indexOf("Orchestration")>-1},filterFieldsArrForDataType:function(e,t,a,i,r,l){return i.filter((function(i){if(i.supported_places){if(a&&!CrmConvertMergeFields.presentinJSONArray(a,i.supported_places))return!1;i.show=!0}var n=!1;if(r&&"text"!==r&&"textarea"!==r){n=CrmConvertMergeFields.isDataTypeSupported(i,r,t);var s=r.split(":")[0];"lookup"!==s&&"desk_ticket"!==s&&CrmConvertMergeFields.isSecondLevelLookupSupported(e.name,i)&&(n=!0)}else n=!0;var o=!0;return l&&!CrmConvertMergeFields.showFieldForBinding(e,t,r,i)&&(o=!1),"undefined"!=typeof mergeField&&mergeField.filterCallBack&&(o=mergeField.filterCallBack(e,r,i)),!(!n||!o)&&(i.show=!0,!0)}))},showFieldForBinding:function(e,t,a,i){var r=e.name;return!!("CURRENTRECORD"===i.id&&a&&a.indexOf("lookup")>=0)||(!(!a||!a.startsWith("lookup:"))||(CrmConvertMergeFields.isUserField(a)?"Users"!=r||!e.lookup_details:!!i.show&&!(!t&&!i.showinlookup)))},isSecondLevelLookupSupported:function(e,t){if(t&&t.multilevel&&133==t.ui_type&&t.lookup_module&&CrmConvertMergeFields.isOrchestrationModule(e)){var a=t.lookup_module.id,i=store.peekRecord("module",a);return!!i&&"Modules"!==i.module_name}return!1},isDataTypeSupported:function(e,t,a){if("desk_ticket"===t)return e.field_label.includes("> Trigger - Desk")&&e.field_label.endsWith("> Ticket ID");if(t&&null!=t&&"text"!==t&&"textarea"!==t){var i=t.split(":");if(CrmConvertMergeFields.isUserField(t)&&CrmConvertMergeFields.isUserField(e.data_type))return!0;if(i[0]===e.data_type&&CrmConvertMergeFields.isMergeFieldAvailableForThisType(e)){if("lookup"===i[0]){if(i.length>1){var r=i[1];if(e.lookup_module&&null!=e.lookup_module){if(automationActions.getTabNameByAPIName(e.lookup_module.api_name)===r)return!0}else if("CURRENTRECORD"===e.id&&r===wfmergefield.getMainModule()&&a)return!0;return!1}return!0}return!0}return!1}return!0},isUserField:function(e){return-1!==["ownerlookup","userlookup"].indexOf(e)},isMergeFieldAvailableForThisType:function(e){var t=e.data_type;return"208"!==e.ui_type||"bigint"!==t},getMessage:function(e){var t=e,a=$("#divToProcessContent");a.html(t.html());var i=a.find("div");i.length>0&&i.each((function(){var e=$(this);e.replaceWith("<br>"+e.html())}));var r=a.find("span.mergespan");r.length>0&&r.each((function(){var e=$(this),t=this.getAttribute("value");e.replaceWith($ESAPI.encoder().encodeForHTML(t))}));var l=a.find("span");return l.length>0&&l.each((function(){var e=$(this);e.replaceWith(e.html())})),a.html()},removeMergeSpans:function(e){var t=$("<div/>");t.html(e);var a=t.find("span.mergespan");return a.length>0?(a.each((function(){var e=$(this),t=this.getAttribute("value");t||(t=this.getAttribute("title")),e.replaceWith($ESAPI.encoder().encodeForHTML(t))})),t.html()):e},replaceHtmlEncodedChars:function(e){for(var t=["&amp;","&#39;","&quot;","&lt;","&gt;","&nbsp;","%28","%29","%3C","%3E","%20","%7B","%7D","%27"],a=["&","'",'"',"<",">"," ","(",")","<",">"," ","{","}","'"],i=t.length,r=0;r<i;r++){var l=new RegExp(t[r],"g");e=e.replace(l,a[r])}return e},isMultiLevelAllowed:function(e){return CrmConvertMergeFields.isOrchestrationModule(e)},encodeMergeField:function(e){for(var t,a,i=new RegExp(/((<a ([^<]*|[^>]*))(.*?>.*?<\/a>)|(\$\{([^\{|^\}]*)\})|(<span class="unsupportMergeField"(.*?)<\/span>))/g),r=0,l=e;a=i.exec(e);){var n=a[5];n&&(t=n.length,n=CrmConvertMergeFields.replaceHtmlEncodedChars(n),n=$ESAPI.encoder().encodeForHTML(n),l=l.substring(0,a.index+r)+n+l.substring(i.lastIndex+r),r+=n.length-t)}return l},removeMergeFieldsInStr:function(e){for(var t,a,i=e,r=new RegExp(/\$\{([^\}].*?)\}/g),l=0;a=r.exec(e);){var n=a[0];n&&(t=n.length,n="",i=i.substring(0,a.index+l)+n+i.substring(r.lastIndex+l),l+=n.length-t)}return i},getUnsubscribeFieldInfo:function(e,t){var a=template.unsubscribeMergeFields;if(a)for(var i=a.length,r={},l=0;l<i;l++){var n=a[l];if(e===mergeFieldsConstants.fromapi_to_label){if(n.api_name===t)return r.field=n,r}else if((e===mergeFieldsConstants.fromlabel_to_api||e===mergeFieldsConstants.fromlabel_to_id)&&n.field_label===t)return r.field=n,r}},getAllFieldsForModule:function(e,t){var a={};if(t)for(var i=t.length,r=0;r<i;r++){var l=t[r];if(l.module.name===e){a.sections=l.sections;break}}return a}};!function(){var e=Handlebars.template,t=Handlebars.templates=Handlebars.templates||{};t.AddLinkForEmailCompose=e({compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l,n=null!=t?t:{},s=e.escapeExpression;return'<div class="addLinkPop" id="addLinkPop" style="display:none;" value=""> <div class="ze_pop_header pB20 removeForSalesIqLink" style="height: 30px;"> <h4 class="pL0 pT0 f20" id="addLinkName"></h4> </div> <div class="mB20 zclnktab" id="zp_ConsentFormtab" style="display:none;"> <div class="textFld tabDivCreate newmandatory crm-font-regular" id="edtConsentFormLink"> <div class="labelTabCreate pT0 pB0 pR fL f15">'+s(a.getI18n.call(n,"crm.consent.language",{name:"getI18n",hash:{},data:r}))+'</div> <div class="labelValCreate pB0 pR pT0 fL cP f15" id="ConsentFormSelectValDiv" onclick="inSplnk.fnLanguageList(\'addLinkPop\', event,\'ConsentFormSelectValDiv\');"> <span class="dIB pR pR25 mT3" id="ConsentFormSelectVal" value="">'+s(a.getI18n.call(n,"crm.select",{name:"getI18n",hash:{},data:r}))+'</span> </div> <span class="errMsg" id="errorMsgSelectLink" style="display: none;">'+s(a.getI18n.call(n,"crm.ConsentForm.select.alert",{name:"getI18n",hash:{},data:r}))+'</span> <div class="clearB"></div> </div> </div> <div class="mB20 zclnktab crm-font-regular"" id="zp_SalesIqLink" style="display:none;"> <span class=" dIB vam" id="popupHead">'+s(a.getI18n.call(n,"crm.salesiq.insert.label.link",{name:"getI18n",hash:{},data:r}))+"</span> <div class='textFld cFix  tabDivCreate m0 newmandatory' id='ze_lnkUrlTab'> <div class='labelTabCreate  pL5 pR fL f15'> <label>"+s(a.getI18n.call(n,"zc.editor.enter.weburl",{name:"getI18n",hash:{},data:r}))+"</label> </div> <div class=\"labelValCreate no-hvr-ln fL crm-font-regular f15\" style=\"border-bottom: 1px solid transparent !important;\"> <input id='ze_lnkurl' data-zcqa='ze_linkUrl' type='text' placeholder='http://www.example.com' style=\"border: 0 none; width: 95%;\" onkeyup='EmailSendingUtil.fnUpdateSIQTracking();' onblur='EmailSendingUtil.fnUpdateSIQTracking();'/> </div> <span class='errMsg' id='errMsgUrl' style='display: none;'></span> <div class='clearB'></div> </div> <div class=\"tabDivCreate\"> <div class=\"labelTabCreate pL5 fL f15\" style=\"width: 100%;\"><span>"+s(a.getI18n.call(n,"zc.editor.salesiq.param.hint",{name:"getI18n",hash:{},data:r}))+'</span></div> </div> <div class="tabDivCreate"> <div> \x3c!--textarea readonly="" id="siqTrackingEnabledURL" value="" class="sIq_txtAra" style=" width: 95%;min-height: 60px;resize: vertical; padding: 10px; line-height: 20px;overflow: auto;border: 1px dashed #DDD; color: #7a7a7a;transition: all .2s ease-in-out;background: #f8f8f8;font-size:1.4rem;"></textarea--\x3e <div  id="siqTrackingEnabledURL" class="sIq_txtAra" data-zcqa="siqTrackingEnabledURL"> <span id="siq_Url"></span><span id="siq_trackingParam" class="siq_trackingParam"></span> </div> </div> </div> </div> <div class="mB20 zclnktab" id="zp_DataRequesttab" style="display:none;"> <div class="textFld edtDataRequestLink mB20" style="border: none;" > <div class="labelTabCreate pT0 pB0 pR fL newmandatory">'+s(a.getI18n.call(n,"crm.datarequest.type",{name:"getI18n",hash:{},data:r}))+'</div> <div class="labelValCreate pB0 pR pT0 fL" id="DataRequestSelectValDiv"> '+(null!=(l=e.invokePartial(i.DataRequestLinkTypes,null!=t?t.types:t,{name:"DataRequestLinkTypes",data:r,helpers:a,partials:i,decorators:e.decorators}))?l:"")+' </div> <div class="clearB"></div> </div> <div class="textFld tabDivCreate newmandatory" > <div class="labelTabCreate pT0 pB0 pR fL">'+s(a.getI18n.call(n,"crm.label.language",{name:"getI18n",hash:{},data:r}))+'</div> <div class="labelValCreate pT0 pB0 pR fL cP" id="DataRequestLanguageSelectValDiv" onclick="inSplnk.fnLanguageList(\'addLinkPop\', event,\'DataRequestLanguageSelectValDiv\');"> <span class="dIB pR pR25 mT3" id="DataRequestLanguageSelectVal" value="">'+s(a.getI18n.call(n,"crm.select",{name:"getI18n",hash:{},data:r}))+'</span> </div> <span class="errMsg" id="errorMsgDataRequestLink" style="display: none;">'+s(a.getI18n.call(n,"crm.datarequest.lang.select.alert",{name:"getI18n",hash:{},data:r}))+'</span> <div class="clearB"></div> </div> </div> <div class="mB20 zclnktab" id="zp_unsubscribetab" style="display:none;"> <div class="textFld tabDivCreate newmandatory" id="edtUnsubLink"> <div class="labelTabCreate pT0 pB0 pR fL">'+s(a.getI18n.call(n,"crm.unsubscription.link",{name:"getI18n",hash:{},data:r}))+'</div> <div class="labelValCreate pR pT0 fL cP" id="unsubSelectValDiv" onclick="inSplnk.showUnsubscriptionList(\'addLinkPop\', event,\'unsubSelectValDiv\',false);"> <span class="dIB pR pR25 mT3" id="unsubSelectVal" value="">'+s(a.getI18n.call(n,"crm.select",{name:"getI18n",hash:{},data:r}))+'</span> </div> <span class="errMsg" id="errorMsgUnsubSelectLink" style="display: none;">'+s(a.getI18n.call(n,"crm.unsubscription.select.alert",{name:"getI18n",hash:{},data:r}))+'</span> <div class="clearB"></div> </div> </div> <div class="ze_botpart pB0 fR"> <input type="button" value="'+s(a.getI18n.call(n,"crm.button.cancel",{name:"getI18n",hash:{},data:r}))+'" id="zp_AddLinkCancel" data-zcqa="zp_AddLinkCancel" class="newgraybtn" onclick="CustomizeEditor.hideAddLinkPop();"> <input type="button" value="'+s(a.getI18n.call(n,"crm.button.save",{name:"getI18n",hash:{},data:r}))+'" id="zp_AddLinkSave" data-zcqa="zp_AddLinkSave" class="primarybtn" onclick="CustomizeEditor.saveLink();"> </div> </div> <div class="ConsentLanguages pA crm-font-regular f14 drpDwn" style="z-index:1002;display: none;"></div> <div class="unsubsList pA crm-font-regular f14 drpDwn" style="z-index:1002;display: none;"></div> <div class="ze_freeze" id="custom_freeze" style="z-index:30;display:none;"></div> <div class="zcrm-modal zcrm-effect w500" id="existingLinkRemoveConfirm" value=""> <div class="zcrm-content"> <div class="popup-model-content pB0"> <div id="removeConfInfo"></div> </div> <div class="popup-model-footer"> <input type="button" value="'+s(a.getI18n.call(n,"crm.button.cancel",{name:"getI18n",hash:{},data:r}))+'" data-zcqa="zp_ConsentFormlinkCancel" class="newgraybtn" onclick="CustomizeEditor.hideLinkRemoveConfirm();"> <input type="button" value="'+s(a.getI18n.call(n,"crm.button.remove",{name:"getI18n",hash:{},data:r}))+'" data-zcqa="zp_ConsentFormlinkSave" class="redbtn" onclick="CustomizeEditor.linkRemoveConfirmation();"> </div> </div> </div> <div class="existCheckPop zclnktab" id="existCheckPop" style="display:none;"> <div class="pT0" style="height: 30px;"> <span class="ze_closeimg" onclick="CustomizeEditor.hideExistCheckPop();"></span> <h4 class="pL0 pT0 mT0 pB0" id="existCheckPopHead"></h4> </div> <div id="existCheckPopMsg"></div> </div> '},usePartial:!0,useData:!0}),t.CreateIntermediatePage=e({1:function(e,t,a,i,r){var l=e.lambda,n=e.escapeExpression;return' <div class="zCreateOption mR30"> <span class="zCreateOptionImg dIB mB15"></span> <span class="dB ttUpper f15 mB10">'+n(l(null!=t?t.campaignType:t,t))+'</span> <link-to lt-prop-id="submenu_Campaigns" data-zcqa="dash_submenu_Campaigns" lt-prop-route="crm.tab.module.create" lt-prop-dp=\'["Campaigns"]\' lt-prop-qp=\'{"fromIntermediatePage":"true", "layoutId":"'+n(l(null!=t?t.layoutId:t,t))+'"}\'> <button class="primarybtn mR0">Create</button> </link-to> </div> '},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l;return'<div id="rwb" class="rwb"> <div class="cvpadding"> <div class="set_mw"> <table width="100%" border="0" cellspacing="0" cellpadding="0"> <tbody> <tr> <td id="heading_icon" class="Campaigns-titleIcon"></td> <td id="heading_title" class="dvTitle pL30 pR30"> <table border="0" cellspacing="0" cellpadding="0"> <tbody> <tr> <td class="vmiddle">Create Campaign</td> </tr> </tbody> </table> </td> <td class="alignright pR30"> <span class="svgIcons ico-close op5 cP dIB"></span> </td> </tr> </tbody> </table> </div> </div> <div class="p30"> <div class="txt-ctr mT80"> '+(null!=(l=a.each.call(null!=t?t:{},t,{name:"each",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?l:"")+" </div> </div> </div>"},useData:!0}),t.DataRequestLinkTypes=e({1:function(e,t,a,i,r){var l=e.lambda,n=e.escapeExpression;return' <li class="DataReqLi"> <label class="p0 mR5 pointer"> <input type="checkbox" class="DataReqChkbx hide" data-param="'+n(l(null!=t?t.param:t,t))+'" onclick="inSplnk.selectDataRequest(this)"> <span class="mR10 floatL mT1 ecwCheckBx"></span> <span class="pointer p0 f14 floatL ecwCheckBx">'+n(l(null!=t?t.value:t,t))+"</span> </label> </li> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l,n=null!=t?t:{},s=e.escapeExpression;return'<div class="DataRequestList mT0 ecwComposeDataReq" id="DataRequestList" style="border: 1px solid #f0f0f0;width: 98%;"> <div class="surProfRoleAll lightGreyBg cP" id="selectAllRequestOpt"> <label class="p0 pointer floatL mT3 mR5"> <input type="checkbox" class="DataReqChkbxAll hide" onchange="inSplnk.selectAllDataRequest(this)"> <span class="mR10 floatL mT1 ecwCheckBx"></span> <span class="pointer p0 f14 floatL ecwCheckBx">'+s(a.getI18n.call(n,"crm.select.all",{name:"getI18n",hash:{},data:r}))+'</span> <div class="clearB"></div> </label> <div class="clearB"></div> </div> <ul class="m0" style="display:block;color:#111 !important;"> '+(null!=(l=a.each.call(n,null!=t?t.data:t,{name:"each",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?l:"")+' </ul> </div> <span class="errMsg" id="errorMsgDataRequestType" style="display: none;position: relative;">'+s(a.getI18n.call(n,"crm.datarequest.datareq.select.alert",{name:"getI18n",hash:{},data:r}))+"</span>"},useData:!0}),t.DragDropDataReq=e({1:function(e,t,a,i,r){var l=e.lambda,n=e.escapeExpression,s=null!=t?t:{};return' <li> <label class="p0 mR5 pointer"> <input type="checkbox" id="'+n(l(null!=t?t.id:t,t))+"_"+n(l(r&&r.index,t))+'"  class="'+n(l(null!=t?t.inputBox:t,t))+' hide" data-param="'+n(l(null!=t?t.param:t,t))+'" onclick="templateConsent.selectDataRequest(\''+n(a.encodeJS.call(s,null!=t?t.id:t,{name:"encodeJS",hash:{},data:r}))+"','"+n(a.encodeJS.call(s,null!=t?t.inputBox:t,{name:"encodeJS",hash:{},data:r}))+'\')"> <span class="mR10 floatL mT1"></span> <span class="pointer p0 f14 floatL">'+n(l(null!=t?t.value:t,t))+"</span> </label> </li> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l,n=e.lambda,s=e.escapeExpression,o=null!=t?t:{};return'<div class="zclnktab" id=\''+s(n(null!=t?t.checkBoxId:t,t))+'_DataRequest\'> <div class="textFld noBdr edtDataRequestLink" id="edtDataRequestLink"> <div class="labelTabCreate newmandatory pL5 pR fL">'+s(a.getI18n.call(o,"crm.datarequest.type",{name:"getI18n",hash:{},data:r}))+'</div> <div class="labelValCreate fL" id="DataRequestSelectValDiv" style="min-height: 45px;"> <div class="DataRequestList mT0" id="'+s(n(null!=t?t.checkBoxId:t,t))+'_dataRequestList" style="border: 1px solid #f0f0f0;width: 98%;"> <div class="surProfRoleAll lightGreyBg cP" id="selectAllRequest_'+s(n(null!=t?t.checkBoxId:t,t))+'"> <label class="p0 pointer floatL mT3 mR5"> <input type="checkbox" id="'+s(n(null!=t?t.checkBoxId:t,t))+'_dataReqChkbxAll" class="checkAllData hide" onchange="templateConsent.selectAllDataRequest(this, \''+s(a.encodeJS.call(o,null!=t?t.inputBox:t,{name:"encodeJS",hash:{},data:r}))+'\')"> <span class="mR10 floatL mT1"></span> <span class="pointer p0 f14 floatL">'+s(a.getI18n.call(o,"crm.select.all",{name:"getI18n",hash:{},data:r}))+'</span> <div class="clearB"></div> </label> <div class="clearB"></div> </div> <ul class="m0" style="display:block"> '+(null!=(l=a.each.call(o,null!=(l=null!=t?t.types:t)?l.data:l,{name:"each",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?l:"")+' </ul> </div> <span class="errMsg" id="'+s(n(null!=t?t.checkBoxId:t,t))+'errorMsgDataRequestType" style="display: none;position: relative;">'+s(a.getI18n.call(o,"crm.datarequest.datareq.select.alert",{name:"getI18n",hash:{},data:r}))+'</span> </div> <div class="clearB"></div> </div> <div class="textFld tabDivCreate newmandatory" id="edtDataRequestLanguage"> <div class="labelTabCreate pL5 pR fL">'+s(a.getI18n.call(o,"crm.label.language",{name:"getI18n",hash:{},data:r}))+'</div> <div class="labelValCreate fL cP" id="'+s(n(null!=t?t.langId:t,t))+'Div" onclick="inSplnk.fnLanguageList(\''+s(a.encodeJS.call(o,null!=t?t.editorName:t,{name:"encodeJS",hash:{},data:r}))+"', event,'"+s(n(null!=t?t.langId:t,t))+'Div\');"> <span class="dIB pR pR25 selLanguage" id="'+s(n(null!=t?t.langId:t,t))+'" value="">'+s(a.getI18n.call(o,"crm.select",{name:"getI18n",hash:{},data:r}))+'</span> </div> <span class="errMsg" id="'+s(n(null!=t?t.checkBoxId:t,t))+'errorMsgDataRequestLink" style="display: none;">'+s(a.getI18n.call(o,"crm.datarequest.lang.select.alert",{name:"getI18n",hash:{},data:r}))+'</span> <div class="clearB"></div> </div> </div> '},useData:!0}),t.EmailTemplateSubformFieldList=e({1:function(e,t,a,i,r){var l;return" "+(null!=(l=a.each.call(null!=t?t:{},null!=t?t.fields:t,{name:"each",hash:{},fn:e.program(2,r,0),inverse:e.noop,data:r}))?l:"")+" "},2:function(e,t,a,i,r){var l;return" "+(null!=(l=a.ifCond.call(null!=t?t:{},null!=t?t.show:t,"=",!0,{name:"ifCond",hash:{},fn:e.program(3,r,0),inverse:e.noop,data:r}))?l:"")+" "},3:function(e,t,a,i,r){var l=e.lambda,n=e.escapeExpression;return' <div class="tblLblDiv clearAfter"> <label class="dB" for="'+n(l(null!=t?t.id:t,t))+'"> <input type="checkbox" data-zcqa="'+n(l(null!=t?t.id:t,t))+'" id="'+n(l(null!=t?t.id:t,t))+'" value="'+n(l(null!=t?t.field_label:t,t))+'" onclick="parent.template.BuilderImpl.validateSubformFieldAdd(this)" class="checkFilter newcheckboxfilternew vmiddle"> <span class="mL2 color3 f14 middle cP filterLabel" field_id="'+n(l(null!=t?t.id:t,t))+'" title="'+n(l(null!=t?t.field_label:t,t))+'"><span class="dIB filterLabel_Ctn ellipsistext" title="'+n(l(null!=t?t.field_label:t,t))+'">'+n(l(null!=t?t.field_label:t,t))+"</span></span> </label> </div> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l;return null!=(l=a.each.call(null!=t?t:{},null!=t?t.sections:t,{name:"each",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?l:""},useData:!0}),t.EncryptionNotification=e({compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l=e.escapeExpression;return'<li id="encryptionMsg'+l(e.lambda(null!=t?t.id:t,t))+'" class="m0 p20 scheduledDataList"> <div class="progressBarAnime dN"> <p id="encProgMsg" class="pB20 pR pL8"></p> <div class="pR progBarWarp"> <div class="progBarWheel"> </div> </div> </div> <div class="schedularMsg dN w95per"> <span class="closeIconScheduler cP" onclick="Encryption.closeNotification(this)"></span> <p id="encComMsg" class="pB5 pL10 pR"></p> <a href="javascript:void(0)" class="f13 mL2 pL10 uline1 viewInfoTbl"  onclick="Encryption.showViewInfo(this)">'+l(a.getI18n.call(null!=t?t:{},"crm.encryption.view.info",{name:"getI18n",hash:{},data:r}))+'</a> <div class="f11 viewInfoData wbba " style="display: none;"> </div> </div> </li>'},useData:!0}),t.EncryptionPopup=e({compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l;return'<div id="ENCNOTIFICATION" class="schedularProgress-pop pF"> <div class="schedularPop-Header"> <h2 class="f17 pR10 schedularMsg">'+e.escapeExpression(a.getI18n.call(null!=t?t:{},"crm.notify.encryption.progress.title",{name:"getI18n",hash:{},data:r}))+'<a href="javascript:;" class="dB fR minimizeSchedularPop pR mT5" onclick="Encryption.encPopClose()"></a></h2> </div> <ul class="m0 pL20 pR20 scheduledList"> '+(null!=(l=e.invokePartial(i.EncryptionNotification,t,{name:"EncryptionNotification",data:r,helpers:a,partials:i,decorators:e.decorators}))?l:"")+" </ul> </div>"},usePartial:!0,useData:!0}),t.ExportPopUp=e({compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l=null!=t?t:{},n=e.escapeExpression;return' <div class=" newPopup oH" id="EXPORTPOP" style="position: fixed; right: 20px; width: 380px; z-index: 1000"> <div class="chatPopTitle p10 f14 lh20" style="text-align: center; cursor: pointer" onclick="crmExportWMSMsg.exportPopup(this)"> <span id="callTitleSpan" class="pL5"> '+n(a.getI18n.call(l,"crm.report.export.title.status",{name:"getI18n",hash:{},data:r}))+' </span> <div class="summinusdiv" style="height: 25px; width: 25px; float: right; cursor: pointer;" onclick="crmExportWMSMsg.callHide(this);sE(event);"> <img id="export_spacer" src="'+n(a.img_link.call(l,{name:"img_link",hash:{},data:r}))+'/spacer_e17b417_.gif" class="dropArrowforreport fR" title="Hide Business Card"> </div> <div class="sumplusdiv" style="height: 25px; width: 25px; float: right; display: none; cursor: pointer;" onclick="crmExportWMSMsg.callShow(this);sE(event);"> <img id="export_spacer" src="'+n(a.img_link.call(l,{name:"img_link",hash:{},data:r}))+'/spacer_e17b417_.gif" class="dropArrowforreport fR" title="Show Business Card" style="background-color: transparent;"> </div> </div> <div class="ChatContains" style="max-height: 295px; overflow-y: scroll; overflow-x: hidden; width: 380px"> <div class ="chatDiv"> <div class="chatContainer pR" style="width: 340px"> <div id="businessView"> <div> <div class="ExportFileName FileName bold fL  mB10 mL15 " style="color: #000; font-size:1.4rem; width: 150px; text-overflow: ellipsis; overflow: hidden; float: left; white-space: nowrap;"></div> <div data-zcqa="div_DownloadAuditLog" class="cB  Downstatus f12 mL15" style="color: #777; font-weight: normal;display: inline-block"> <span class="fL"> '+n(a.getI18n.call(l,"crm.report.export.start.msg",{name:"getI18n",hash:{},data:r}))+' </span> <img id="export_loading" src="'+n(a.img_link.call(l,{name:"img_link",hash:{},data:r}))+'/loading_599c9b1_.gif" align="absmiddle" class="fL mT7" /> <a class="cancellink fR bt-smallnewgraybtn newgraybtn" onclick="crmExportWMSMsg.callCancel(this);sE(event);" style="cursor: pointer;">'+n(a.getI18n.call(l,"crm.button.cancel",{name:"getI18n",hash:{},data:r}))+'</a> <a class="downloadingLink primarybtn bt-smallprimarybtn" style="display:none;">'+n(a.getI18n.call(l,"crm.view.attachment.downloading",{name:"getI18n",hash:{},data:r}))+'</a> <div class="slidercontainer fL pR mT3" style="display: none; margin-left: 10px; overflow: hidden"> <div class="slidercolor pA"></div> </div> </div> </div> <div></div> </div> <span class="exportCloseIcon svgIcons ico-close-small2 dIB cP pA" style="display: none"></span> </div> </div> </div> </div> '},useData:!0}),t.InsertLinkInTemplates=e({1:function(e,t,a,i,r){var l,n=null!=t?t:{},s=e.escapeExpression;return' <div class="textFld  tabDivCreate"> <div class="labelTabCreate pL5 pR fL"> '+s(a.getI18n.call(n,"zc.editor.button.linktype",{name:"getI18n",hash:{},data:r}))+' </div> <div onclick="fnshowlinks(event,this);" class="temSelLink f14 labelValCreate cP fL" selectedType="zp_urlLink" id="temSelLink"> <span class="dIB pR pR25 sellinkTypes"  id="selectlinkTypes">'+s(a.getI18n.call(n,"zc.editor.url",{name:"getI18n",hash:{},data:r}))+"</span> </div> <div class=\"clearB\"></div> </div> <div class=\"cmpfrm1\"> <div class='textFld cFix  tabDivCreate m0 newmandatory zclnktab' id='ze_lnkTextTab'> <div class='labelTabCreate  pL5 pR fL'> <label>"+s(a.getI18n.call(n,"ze.editor.selected.text",{name:"getI18n",hash:{},data:r}))+"</label> </div> <div class='labelValCreate fL'> <input type='text' class='w80' data-zcqa='ze_linkText' id='ze_selTxt'></input> </div> <span class='errMsg' id='errorMsgText' style='display: none;'></span> <div class='clearB'></div> </div> <div class='textFld cFix  tabDivCreate m0 newmandatory zclnktab' id='ze_lnkUrlTab'> <div class='labelTabCreate  pL5 pR fL'> <label>"+s(a.getI18n.call(n,"crm.field.label.url",{name:"getI18n",hash:{},data:r}))+"</label> </div> <div class='labelValCreate fL'> <input id='ze_lnkurl' data-zcqa='ze_linkUrl' type='text' placeholder='http://www.example.com' class='w80' onkeyup='inSplnk.fnUpdateSIQTracking();' onblur='inSplnk.fnUpdateSIQTracking();'/> </div> <span class='errMsg' id='errMsgUrl' style='display: none;'></span> <div class='clearB'></div> </div> <div class='textFld cFix tabDivCreate m0 zclnktab' id='ze_lnkUrlToolTipTab'> <div class='labelTabCreate pL5 pR fL'> <label>"+s(a.getI18n.call(n,"ze.editor.title.tool.tip",{name:"getI18n",hash:{},data:r}))+"</label> </div> <div class='labelValCreate fL'> <input type='text' maxlength='50' data-zcqa='ze_linkTitle' id='ze_urlTitle' class='w80'></input> </div> </div> <div class='textFld cFix tabDivCreate m0 newmandatory zclnktab' id='ze_lnkEmailTab' style='display:none;'> <div class='labelTabCreate pL5 pR fL'> <label>"+s(a.getI18n.call(n,"crm.email.chk",{name:"getI18n",hash:{},data:r}))+"</label> </div> <div class='labelValCreate fL'> <input type='text' data-zcqa='ze_linkEmail' id='ze_lnkemail' class='w80'></input> </div> <span class='errMsg' id='errorMsgEmail' style='display: none;'></span> <div class='clearB'></div> </div> <div class='textFld cFix  tabDivCreate m0 zclnktab' id='ze_lnkSubjectTab' style='display:none;'> <div class='labelTabCreate pL5 pR fL'> <label>"+s(a.getI18n.call(n,"crm.label.subject",{name:"getI18n",hash:{},data:r}))+"</label> </div> <div class='labelValCreate fL'> <input type='text' data-zcqa='ze_linkSubject' id='ze_lnksubject' class='w80'></input> </div> <span class='errMsg' id='errorMsgSbjt' style='display: none;'></span> <div class='clearB'></div> </div> <div class='textFld cFix tabDivCreate m0 zclnktab' id='ze_lnkEmailToolTipTab' style='display:none;'> <div class='labelTabCreate pL5 pR fL'> <label>"+s(a.getI18n.call(n,"ze.editor.title.tool.tip",{name:"getI18n",hash:{},data:r}))+"</label> </div> <div class='labelValCreate fL'> <input type='text' maxlength='50' data-zcqa='ze_linkTitle' id='ze_emailTitle' class='w80'></input> </div> </div> <div class='textFld cFix tabDivCreate m0 newmandatory zclnktab' id='ze_lnkConsentTab' style='display:none;'> <div class='labelTabCreate  pL5 pR fL'> <label>"+s(a.getI18n.call(n,"crm.consent.language",{name:"getI18n",hash:{},data:r}))+"</label> </div> <div class='labelValCreate fL cP' id='ConsentFormSelectValDiv' onclick='inSplnk.fnLanguageList(\"ze_link\",event,\"ConsentFormSelectValDiv\");'> <span class='dIB pR pR25' id='ConsentFormSelectVal' value=''>"+s(a.getI18n.call(n,"crm.select",{name:"getI18n",hash:{},data:r}))+"</span> </div> <span class='errMsg' id='errorMsgSelectLink' style='display: none;'>"+s(a.getI18n.call(n,"crm.ConsentForm.select.alert",{name:"getI18n",hash:{},data:r}))+"</span> <div class='clearB'></div> </div> "+(null!=(l=e.invokePartial(i.dataRequestLink,null!=t?t.dataReqDiv:t,{name:"dataRequestLink",data:r,helpers:a,partials:i,decorators:e.decorators}))?l:"")+" <div class='textFld cFix tabDivCreate m0 newmandatory zclnktab' id='ze_lnkUnsubsTab' style='display:none;'> <div class='labelTabCreate  pL5 pR fL'> <label>"+s(a.getI18n.call(n,"crm.unsubscription.link",{name:"getI18n",hash:{},data:r}))+"</label> </div> <div class='labelValCreate fL cP' id='unsubSelectValDiv' onclick='inSplnk.showUnsubscriptionList(\"ze_link\",event,\"unsubSelectValDiv\",true);'> <span class='dIB pR pR25' id='unsubSelectVal' value=''>"+s(a.getI18n.call(n,"crm.select",{name:"getI18n",hash:{},data:r}))+"</span> </div> <span class='errMsg' id='errorMsgUnsubSelectLink' style='display: none;'>"+s(a.getI18n.call(n,"crm.unsubscription.select.alert",{name:"getI18n",hash:{},data:r}))+"</span> <div class='clearB'></div> </div> "},3:function(e,t,a,i,r){var l=null!=t?t:{},n=e.escapeExpression;return" <div class=\"cmpfrm1\"> <div class='textFld cFix  tabDivCreate m0 newmandatory zclnktab' id='ze_lnkTextTab'> <div class='labelTabCreate  pL5 pR fL'> <label>"+n(a.getI18n.call(l,"ze.editor.selected.text",{name:"getI18n",hash:{},data:r}))+"</label> </div> <div class='labelValCreate fL'> <input type='text' class='w80' data-zcqa='ze_linkText' id='ze_selTxt'></input> </div> <span class='errMsg' id='errorMsgText' style='display: none;'></span> <div class='clearB'></div> </div> <div class='textFld cFix  tabDivCreate m0 newmandatory zclnktab' id='ze_lnkUrlTab'> <div class='labelTabCreate  pL5 pR fL'> <label>"+n(a.getI18n.call(l,"crm.field.label.url",{name:"getI18n",hash:{},data:r}))+"</label> </div> <div class='labelValCreate fL'> <input id='ze_lnkurl' data-zcqa='ze_linkUrl' type='text' placeholder='http://www.example.com' class='w80'/> </div> <span class='errMsg' id='errMsgUrl' style='display: none;'></span> <div class='clearB'></div> </div> "},5:function(e,t,a,i,r){var l;return" "+(null!=(l=e.invokePartial(i.zFormsLink,t,{name:"zFormsLink",data:r,helpers:a,partials:i,decorators:e.decorators}))?l:"")+" "},7:function(e,t,a,i,r){return' <div class="mB30 zclnktab" style="display: none;" id="ze_ZohoSurveytab"></div> '},9:function(e,t,a,i,r){var l=null!=t?t:{},n=e.escapeExpression;return' <div class="mT20" id="salesiqtrackparamdiv"> <label class="newCustomchkbox-md" for="enableSIQTracking"> <input type="checkbox" id=\'enableSIQTracking\' class="mCheckbox" data-zcqa=\'enableSIQTracking\' onclick="inSplnk.fnToggleSIQTracking();"> <span class="mCheckboxSpan"></span> <span class="col666 dIB f15 mL5 vam" for="enableSIQTracking">'+n(a.getI18n.call(l,"crm.salesiq.allow.tracking.param",{name:"getI18n",hash:{},data:r}))+'</span> </label> <span class="dIB vat"><i class="dIB  ico-info2 vat mT4 svgIcons sIq"  onmouseenter="window.parent.template.newshowtt(this,\'center\',\'bottom\');" onmouseleave="window.parent.template.newhidett()"  id="siqParamHintIcon" data-zcqa="siqParamHintIcon" overtext=\''+n(a.getI18nwithoutParamI18n.call(l,"crm.salesiq.allow.tracking.param.hint",null!=t?t.primaryNameFieldLabelForHint:t,null!=t?t.primaryEmailFieldLabelForHint:t,{name:"getI18nwithoutParamI18n",hash:{},data:r}))+'\'></i></span> <div class="sIq_desk pR"> \x3c!--textarea readonly="" id="siqTrackingEnabledURL" value="" class="sIq_txtAra"></textarea--\x3e <div class="sIq_Txtwrap"> <div  id="siqTrackingEnabledURL" class="sIq_txtAra" data-zcqa="siqTrackingEnabledURL"> <span id="siq_Url"></span><span id="siq_trackingParam" class="siq_trackingParam"></span> </div> </div> </div> </div> <div class="ze_freeze" id="custom_freeze" style="display:none;background-color: #000;height: 100%;opacity: .5;filter: Alpha(opacity = 50);position: absolute;width: 99.4%;width: 100%;left: 0;top: 0;"></div> '},11:function(e,t,a,i,r){var l=null!=t?t:{},n=e.escapeExpression;return' <li id="zp_ConsentFormLink" class="" data-zcqa="ze_consentMode" onclick="fnlnktabclick(\'zp_ConsentFormLink\');">'+n(a.getI18n.call(l,"crm.consent.form.link",{name:"getI18n",hash:{},data:r}))+'</li> <li id="zp_DataRequestLink" class=""  data-zcqa="ze_dataReqMode"  onclick="fnlnktabclick(\'zp_DataRequestLink\');">'+n(a.getI18n.call(l,"crm.datarequest.link",{name:"getI18n",hash:{},data:r}))+"</li> "},13:function(e,t,a,i,r){return' <li id="zp_DoubleOptInLink" class=""  data-zcqa="ze_DoubleOptInMode"  onclick="fnlnktabclick(\'zp_DoubleOptInLink\');">'+e.escapeExpression(a.getI18n.call(null!=t?t:{},"crm.doubleoptin.link",{name:"getI18n",hash:{},data:r}))+"</li> "},15:function(e,t,a,i,r){return' <li id="zp_ZohoFormLink" style="display:block" data-zcqa="zp_ZohoFormLink" onclick="fnlnktabclick(\'zp_ZohoFormLink\',\'3\');">Zoho Forms</li> '},17:function(e,t,a,i,r){return' <li id="zp_ZohoSurveyLink" style="display:block" data-zcqa="zp_ZohoSurveyLink" data-params=\'{"action":"surveyDetails","from":"editorAddToElem","editorType":"htmlEditor"}\' onclick="fnlnktabclick(\'zp_ZohoSurveyLink\',\'4\');">Zoho Survey</li> '},19:function(e,t,a,i,r){var l=null!=t?t:{};return' <li id="zp_ZohoWebinarLink" style="display:block" data-zcqa="zp_ZohoWebinarLink" onclick="fnlnktabclick(\'zp_ZohoWebinarLink\',\'4\');">'+e.escapeExpression(a.getI18n.call(l,"zwebinar.registration.url.dynamic",a.getIntegrationName.call(l,"ZOHO_WEBINAR",{name:"getIntegrationName",hash:{},data:r}),{name:"getI18n",hash:{},data:r}))+"</li> "},21:function(e,t,a,i,r){return' <li id="zp_unsubscriptionLink" class="linkTypes"  data-zcqa="ze_unsubscribeMode"  onclick="fnlnktabclick(\'zp_unsubscriptionLink\');">'+e.escapeExpression(a.getI18n.call(null!=t?t:{},"crm.unsubscription.link",{name:"getI18n",hash:{},data:r}))+"</li> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l,n=null!=t?t:{},s=e.escapeExpression;return"<div class='zcrm-content p30 pL40 pR40 ze_link_editor'> <div class='popup-model-header f20 crm-font-bold fs pB20 bxShTp'>"+s(a.getI18n.call(n,"ze.editor.addlink",{name:"getI18n",hash:{},data:r}))+"</div> <div class='popup-model-content noBdr f16 fontsmoothAuto'> "+(null!=(l=a.unless.call(n,null!=t?t.isPrivacyEditor:t,{name:"unless",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?l:"")+" "+(null!=(l=a.if.call(n,null!=t?t.isPrivacyEditor:t,{name:"if",hash:{},fn:e.program(3,r,0),inverse:e.noop,data:r}))?l:"")+" "+(null!=(l=a.if.call(n,null!=t?t.formsIntegEnabled:t,{name:"if",hash:{},fn:e.program(5,r,0),inverse:e.noop,data:r}))?l:"")+" "+(null!=(l=a.if.call(n,null!=t?t.isSurveyEnabled:t,{name:"if",hash:{},fn:e.program(7,r,0),inverse:e.noop,data:r}))?l:"")+" "+(null!=(l=a.ifCondLogic.call(n,null!=t?t.isLiveDeskEnabled:t,"==",!0,"&&",null!=t?t.isLiveDeskSupportedModule:t,"==",!0,{name:"ifCondLogic",hash:{},fn:e.program(9,r,0),inverse:e.noop,data:r}))?l:"")+" <div class='popup-model-footer txtrht pT30'> <input type='button' value='"+s(a.getI18n.call(n,"crm.button.cancel",{name:"getI18n",hash:{},data:r}))+"' data-zcqa='ze_linkCancel' id='lnkcancel'  class='newgraybtn'></input> <input type='button' value='"+s(a.getI18n.call(n,"crm.button.save",{name:"getI18n",hash:{},data:r}))+'\' id=\'lnksve\' data-zcqa=\'ze_linkSave\' class=\'primarybtn\'></input> </div> </div> </div> <div id="showlinkTypes" style=\'display: none;\' class="f14 zeLinkTypes pA whiteBg"> <ul class="p0 m0"> <li id="zp_urlLink" class="valSel selectType"  data-zcqa="ze_urlMode" onclick="fnlnktabclick(\'zp_urlLink\');">'+s(a.getI18n.call(n,"zc.editor.url",{name:"getI18n",hash:{},data:r}))+'</li> <li id="zp_mailLink" class=""  data-zcqa="ze_emailMode" onclick="fnlnktabclick(\'zp_mailLink\');">'+s(a.getI18n.call(n,"zc.editor.email",{name:"getI18n",hash:{},data:r}))+"</li> "+(null!=(l=a.if.call(n,null!=t?t.isprivacyEnabled:t,{name:"if",hash:{},fn:e.program(11,r,0),inverse:e.noop,data:r}))?l:"")+" "+(null!=(l=a.if.call(n,null!=t?t.isDoubleOptInEnabled:t,{name:"if",hash:{},fn:e.program(13,r,0),inverse:e.noop,data:r}))?l:"")+" "+(null!=(l=a.if.call(n,null!=t?t.formsIntegEnabled:t,{name:"if",hash:{},fn:e.program(15,r,0),inverse:e.noop,data:r}))?l:"")+" "+(null!=(l=a.if.call(n,null!=t?t.isSurveyEnabled:t,{name:"if",hash:{},fn:e.program(17,r,0),inverse:e.noop,data:r}))?l:"")+" "+(null!=(l=a.if.call(n,null!=t?t.isWebinarEnabled:t,{name:"if",hash:{},fn:e.program(19,r,0),inverse:e.noop,data:r}))?l:"")+" "+(null!=(l=a.if.call(n,null!=t?t.isUnsubscribeSupport:t,{name:"if",hash:{},fn:e.program(21,r,0),inverse:e.noop,data:r}))?l:"")+' </ul> </div> <div class="zcrm-modal zcrm-effect" id="nTsIqCancelPop" style="max-width: 395px !important;z-index: 1000;"> <div class="zcrm-content " style="overflow:visible"> <div> <div class="popup-model-content-siq pB0" style="overflow:visible;"> <div class="siq-header">'+s(a.getI18n.call(n,"ze.editor.exist.siq.param.head",{name:"getI18n",hash:{},data:r}))+'</div> <div class="pT15 color666 f16 alttext siq-txt-cont" id="folderTitle6 content"><div class="siq-txt-cont-inner">'+(null!=(l=a.getI18n.call(n,"ze.editor.exist.siq.param",{name:"getI18n",hash:{},data:r}))?l:"")+'</div></div> <div class="popup-model-footer-siq"> <input type="button" value="'+s(a.getI18n.call(n,"ze.editor.exist.siq.yes.replace",{name:"getI18n",hash:{},data:r}))+'" class="primarybtn mR0 vat cP siq-btn-padding" onclick="inSplnk.fnTrackProceedConfirm();" data-zcqa="proceedAddSIQParam"> <input type="button" value="'+s(a.getI18n.call(n,"ze.editor.exist.siq.no.keep.old",{name:"getI18n",hash:{},data:r}))+'" class="newgraybtn siq-btn-padding" onclick="inSplnk.fnHideConfirmPopup();" data-zcqa="removeAddSIQParam"> <div style="clear:both"></div> </div> <input type="hidden" id="conflictSource" value="" ></input> </div> </div> </div> </div> '},usePartial:!0,useData:!0}),t.MultipleFieldsEdit=e({1:function(e,t,a,i,r){return' <div id="multipleFieldsEditPop" class="ppTop is-scroll w900 newPopupStyleEle" style="top:0px;width: 1100px;box-shadow: 0 5px 15px rgba(0,0,0,.5);"> <div class="bPPopupFreezLayer"></div> '},3:function(e,t,a,i,r){return" </div> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l,n=null!=t?t:{},s=e.escapeExpression,o=e.lambda;return(null!=(l=a.unless.call(n,null!=t?t.SkipContainer:t,{name:"unless",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?l:"")+' <div class="pp-header f21 crm-font-regular bxShTp" style="word-wrap: break-word;">'+s(a.getI18n.call(n,"crm.automation.process.update.fields",{name:"getI18n",hash:{},data:r}))+'</div> <div class="bp_inner_rlTab"> <input type="hidden" value="'+s(o(null!=(l=null!=t?t.data:t)?l.module:l,t))+'" id="multipleFieldEditModule"></input> <input type="hidden" value="'+s(o(null!=(l=null!=t?t.data:t)?l.entityId:l,t))+'" id="multipleFieldEditEntityId"></input> <input type="hidden" value="'+s(o(null!=(l=null!=t?t.data:t)?l.transitionRelId:l,t))+'" id="multipleFieldEditTransRelId"></input> <ul class="commentabmenu bpRLcommentabmenu" id="duringTabs"></ul> </div> <div id="duringTabDivs" class="duringTabDivsClass"> </div> <div class="pp-footer"> <input id="cancel" type="button" data-zcqa="multipleFieldEditCancelBtn" value="'+s(a.getI18n.call(n,"crm.button.cancel",{name:"getI18n",hash:{},data:r}))+'" onclick="ProcessFlow.cancelMulitipleFieldsEdit()" class="newgraybtn"> <input type="button" data-zcqa="multipleFieldEditSaveBtn" id="multipleFieldEditSaveBtn" value="'+s(a.getI18n.call(n,"crm.button.save",{name:"getI18n",hash:{},data:r}))+'" onclick="ProcessFlow.saveMulitipleFieldsEdit()" class="primarybtn readOnlyMode fR" style="display: inline-block;"> </div> '+(null!=(l=a.unless.call(n,null!=t?t.SkipContainer:t,{name:"unless",hash:{},fn:e.program(3,r,0),inverse:e.noop,data:r}))?l:"")+" "},useData:!0}),t.PicklistReplaceValue=e({compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l,n=null!=t?t:{},s=e.escapeExpression;return'<div id="rls-contSharStaLoad-pop" class="pF schedularProgress-pop"> <div class="schedularPop-Header"> <h2 class="f17 pR10">'+s(a.getI18n.call(n,"crm.picklist.notification.title",{name:"getI18n",hash:{},data:r}))+'<a href="javascript:;" class="dB fR minimizeSchedularPop pR mT5" onclick="crmExportWMSMsg.showHidePicklistSchedulerDiv();"></a></h2> </div> <ul class="m0 pL20 pR20 scheduledList"> <li class="m0 p20 scheduledDataList picklistReplaceList" id ="picklist_pop_'+s(e.lambda(null!=t?t.jobId:t,t))+'"> <div class="picklist_progress progressBarAnime"> <p class="pB20 pR pL8">'+(null!=(l=a.getI18n.call(n,"crm.picklist.notification.progress.msg",a.encodeHTML.call(n,null!=(l=null!=t?t.pickListDetails:t)?l.fromValueStr:l,{name:"encodeHTML",hash:{},data:r}),a.encodeHTML.call(n,null!=(l=null!=t?t.pickListDetails:t)?l.toValueStr:l,{name:"encodeHTML",hash:{},data:r}),{name:"getI18n",hash:{},data:r}))?l:"")+'</p> <div class="pR progBarWarp"> <div class="progBarWheel"></div> </div> </div> </li> </ul> </div>'},useData:!0}),t.PopupLayout=e({1:function(e,t,a,i,r){var l;return(null!=(l=a.each.call(null!=t?t:{},null!=(l=null!=t?t.header:t)?l.classes:l,{name:"each",hash:{},fn:e.program(2,r,0),inverse:e.noop,data:r}))?l:"")+" "},2:function(e,t,a,i,r){var l;return" "+(null!=(l=e.lambda(t,t))?l:"")+" "},4:function(e,t,a,i,r){return" "},6:function(e,t,a,i,r){var l;return"&nbsp;-&nbsp;<span class='color2 f14'>"+e.escapeExpression(e.lambda(null!=(l=null!=t?t.header:t)?l.subtext:l,t))+"</span>"},8:function(e,t,a,i,r){var l,n=e.lambda,s=e.escapeExpression,o=null!=t?t:{};return' <input  type="button" class="'+s(n(null!=t?t.class_type:t,t))+'" '+(null!=(l=a.if_eq.call(o,null!=t?t.disabled:t,!0,{name:"if_eq",hash:{},fn:e.program(9,r,0),inverse:e.noop,data:r}))?l:"")+" "+(null!=(l=a.if.call(o,null!=t?t.id:t,{name:"if",hash:{},fn:e.program(11,r,0),inverse:e.noop,data:r}))?l:"")+" "+(null!=(l=a.each.call(o,null!=t?t.attributes:t,{name:"each",hash:{},fn:e.program(2,r,0),inverse:e.noop,data:r}))?l:"")+'value="'+s(n(null!=t?t.value:t,t))+'" '+(null!=(l=a.if.call(o,null!=t?t.click_text:t,{name:"if",hash:{},fn:e.program(13,r,0),inverse:e.noop,data:r}))?l:"")+"> "},9:function(e,t,a,i,r){return"disabled "},11:function(e,t,a,i,r){return' id="'+e.escapeExpression(e.lambda(null!=t?t.id:t,t))+'" '},13:function(e,t,a,i,r){return' onclick="'+e.escapeExpression(e.lambda(null!=t?t.click_text:t,t))+'" '},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l,n=null!=t?t:{},s=e.lambda,o=e.escapeExpression;return'<div class="newPopup ppTop '+(null!=(l=a.if.call(n,null!=(l=null!=t?t.header:t)?l.classes:l,{name:"if",hash:{},fn:e.program(1,r,0),inverse:e.program(4,r,0),data:r}))?l:"")+' is-scroll newInputStyleEle newPopupStyleEle pL0 pR0" id="'+o(s(null!=(l=null!=t?t.header:t)?l.id:l,t))+'" style="display: none;"> <div class="pp-header" id="cm_title">'+o(s(null!=(l=null!=t?t.header:t)?l.title:l,t))+" "+(null!=(l=a.isNotEmpty.call(n,null!=(l=null!=t?t.header:t)?l.subtext:l,{name:"isNotEmpty",hash:{},fn:e.program(6,r,0),inverse:e.noop,data:r}))?l:"")+'</div> <div class="pp-content"> '+(null!=(l=s(null!=t?t.body:t,t))?l:"")+' </div> <div class="pp-footer '+o(s(null!=(l=null!=t?t.footer:t)?l.alignment:l,t))+'"> '+(null!=(l=a.each.call(n,null!=(l=null!=t?t.footer:t)?l.buttons:l,{name:"each",hash:{},fn:e.program(8,r,0),inverse:e.noop,data:r}))?l:"")+" </div> </div>"},useData:!0}),t.ProcessMergeFields=e({1:function(e,t,a,i,r){return" dN "},3:function(e,t,a,i,r){var l=e.lambda,n=e.escapeExpression;return' <option value="'+n(l(null!=t?t.id:t,t))+'">'+n(l(null!=t?t.label:t,t))+"</option> "},5:function(e,t,a,i,r){return' <p class="pL10 pR10 pT5  crm-font-regular color_5 f12 aligncenter">'+e.escapeExpression(a.getI18n.call(null!=t?t:{},"crm.import.no.fields.found",{name:"getI18n",hash:{},data:r}))+"</p> "},7:function(e,t,a,i,r,l,n){var s,o=null!=t?t:{},d=e.lambda,c=e.escapeExpression;return' <ul class="modulesFields m0 p0 col333 fontSmooth" '+(null!=(s=a.ifCond.call(o,r&&r.key,"=",null!=n[1]?n[1].Module:n[1],{name:"ifCond",hash:{},fn:e.program(8,r,0,l,n),inverse:e.program(10,r,0,l,n),data:r}))?s:"")+' modName="'+c(d(null!=(s=null!=t?t.module:t)?s.display_name:s,t))+'" id="'+c(d(r&&r.key,t))+'_ModuleFields"> '+(null!=(s=a.each.call(o,null!=t?t.sections:t,{name:"each",hash:{},fn:e.program(12,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" </ul> "},8:function(e,t,a,i,r){return""},10:function(e,t,a,i,r){return'style="display:none"'},12:function(e,t,a,i,r,l,n){var s,o=null!=t?t:{};return" "+(null!=(s=a.if_gt_len.call(o,null!=n[1]?n[1].sections:n[1],1,{name:"if_gt_len",hash:{},fn:e.program(13,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "+(null!=(s=a.each.call(o,null!=t?t.fields:t,{name:"each",hash:{},fn:e.program(15,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "},13:function(e,t,a,i,r){return' <li class="mergeSections font13 col999 ttUpper mT15  pR20">'+e.escapeExpression(e.lambda(null!=t?t.name:t,t))+"</li> "},15:function(e,t,a,i,r,l,n){var s;return" "+(null!=(s=a.ifCond.call(null!=t?t:{},null!=t?t.show:t,"=",!0,{name:"ifCond",hash:{},fn:e.program(16,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "},16:function(e,t,a,i,r,l,n){var s=e.lambda,o=e.escapeExpression;return" <li class='mergeOptions cP pT5 pB5 pL20' moduleid='"+o(s(e.data(r,2)&&e.data(r,2).key,t))+"' val='"+o(s(null!=t?t.id:t,t))+'\' onclick="mergeField.setMergeValue(this);">'+o(s(null!=t?t.field_label:t,t))+"</li> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r,l,n){var s,o=null!=t?t:{};return'<div id="mergeValuesDIV" class="alignleft brad2 pA whiteBg fontsmoothAuto bdrdedede bshEE pB5 zI10 bpDuringMF mergeFldCls" onclick="sE(event);" style="max-height:235px;width:150px;" data-close="true"> <i class="setDDPopupAbG" style="left: 6px;"><i class="setDDPopupA"></i></i> <ul class="pL0 pR0 pB0 m0" id="searchMergeValues" style="display:none"></ul> <div class="" id="listMergeValues"> <div id="moduleOptionsList" class=\'bdrBd7d7 newSelect dropDwnMxWdth '+(null!=(s=a.ifCond.call(o,a.arrayLength.call(o,null!=t?t.modulesJSON:t,{name:"arrayLength",hash:{},data:r}),"<",1,{name:"ifCond",hash:{},fn:e.program(1,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'\'> <select id="moduleOptions" onchange="mergeField.changeMergevalues(this)"> '+(null!=(s=a.each.call(o,null!=t?t.modulesJSON:t,{name:"each",hash:{},fn:e.program(3,r,0,l,n),inverse:e.noop,data:r}))?s:"")+' </select> </div> <div class="oA" style="max-height:180px";> '+(null!=(s=a.ifCond.call(o,a.arrayLength.call(o,null!=t?t.modulesJSON:t,{name:"arrayLength",hash:{},data:r}),"<",1,{name:"ifCond",hash:{},fn:e.program(5,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "+(null!=(s=a.each.call(o,null!=t?t.mergeFieldJSON:t,{name:"each",hash:{},fn:e.program(7,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" </div> </div> </div> "},useData:!0,useDepths:!0}),t.UnusedPicklistValues=e({1:function(e,t,a,i,r){var l,n=e.lambda,s=e.escapeExpression;return' <li class="f12"> <label class="newCustomchkbox-md"> <input type="checkbox" value="'+s(n(null!=t?t.value:t,t))+'" data-uvcid="item" id="'+s(n(null!=t?t.id:t,t))+'" data-defval="'+s(n(null!=t?t.reference_value:t,t))+'" data-color="'+s(n(null!=t?t.color:t,t))+'"> <span class="vam chkbxIcon"></span> <span class="dIB vam mL10 unusedPicklistValLabel">'+s(n(null!=t?t.value:t,t))+"</span> </label> "+(null!=(l=a.if_eq.call(null!=t?t:{},null!=t?t.visible:t,!0,{name:"if_eq",hash:{},fn:e.program(2,r,0),inverse:e.program(5,r,0),data:r}))?l:"")+" </li> "},2:function(e,t,a,i,r){var l,n=null!=t?t:{},s=e.escapeExpression;return" <span onmouseenter=\"crmui.showTooltip({content: '<p style=&quot;color: #b7d7e8;&quot;>"+s(a.getI18n.call(n,"crm.picklist.unused.layout",{name:"getI18n",hash:{},data:r}))+"</p>"+(null!=(l=a.each.call(n,null!=t?t.layouts:t,{name:"each",hash:{},fn:e.program(3,r,0),inverse:e.noop,data:r}))?l:"")+'\',isHTML: true,position: \'Left\'});" onmouseleave="crmui.hideTooltip();" class="addAlert"></span> <span class="deletAlert-icon fR mR15" onmouseenter="crmui.showTooltip({content: \''+s(a.getI18n.call(n,"crm.picklist.used.info",{name:"getI18n",hash:{},data:r}))+"',position: 'Left'});\" onmouseleave=\"crmui.hideTooltip();\"></span> "},3:function(e,t,a,i,r){return"<p>"+e.escapeExpression(a.encodeHTML.call(null!=t?t:{},null!=t?t.name:t,{name:"encodeHTML",hash:{},data:r}))+"</p>"},5:function(e,t,a,i,r){var l=null!=t?t:{},n=e.escapeExpression;return' <span class="delet-icon fR mR15" data-uvcid="deleteUnused" onclick="CMB.ValidatePicklistDeleteOption(\''+n(a.encodeJS.call(l,null!=t?t.fieldid:t,{name:"encodeJS",hash:{},data:r}))+"','"+n(a.encodeJS.call(l,null!=t?t.id:t,{name:"encodeJS",hash:{},data:r}))+"','"+n(a.encodeJS.call(l,null!=t?t.value:t,{name:"encodeJS",hash:{},data:r}))+"');\"></span> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l,n=null!=t?t:{},s=e.escapeExpression;return'<span class="f15 unuse pL30 pR40 boxBB dIB w100per" data-uvcid="goPageBack"> <span class="mL10">'+s(a.getI18n.call(n,"crm.picklist.unused",{name:"getI18n",hash:{},data:r}))+'</span> <a href="javascript:;" class="f13 fR cP" id="chkSlt" data-uvcid="selectAll">'+s(a.getI18n.call(n,"crm.picklist.unused.select",{name:"getI18n",hash:{},data:r}))+'</a> </span> <div class="unused_values_list pp-content importDiv" style="display: flex;"> <ul id="useList" class="useList"> '+(null!=(l=a.each.call(n,t,{name:"each",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?l:"")+' </ul> </div> <div class="popup-model-footer alignright pp-footer unUsedpkFooter"> <button id ="addUnusedoptions" disabled class="primarybtn globalCancel fR mR0 mT15" data-uvcid="addUnused">'+s(a.getI18n.call(n,"crm.button.add",{name:"getI18n",hash:{},data:r}))+"</button> </div>"},useData:!0}),t.blockListWarning=e({compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l=null!=t?t:{},n=e.escapeExpression;return'<div id="blockListWarning" class="newpopup is-scroll ppTop aligncenter showPpTop w500 newInputStyleEle newPopupStyleEle" style="height: auto;overflow: visible;"> <div class="pp-header"></div> <div class="pp-content f15 color_5 pB0 alignleft">'+n(a.getI18n.call(l,"crm.add.blocklist.record.warning.msg",{name:"getI18n",hash:{},data:r}))+'</div> <div class="pp-footer aligncenter"> <button data-zcqa=\'proceed\' class="redbtn">'+n(a.getI18n.call(l,"crm.yes.proceed",{name:"getI18n",hash:{},data:r}))+"</button> <button data-zcqa='cancel' class=\"newgraybtn\" onclick=\"removeFreezeLayer();$('#blockListWarning').remove();$('#searchCreatePopup').removeClass('blockListPopOverride');\">"+n(a.getI18n.call(l,"crm.consent.lawbasis.cancel",{name:"getI18n",hash:{},data:r}))+"</button> </div> </div>"},useData:!0}),t.clientPortalUserLocaleInformation=e({1:function(e,t,a,i,r,l,n){var s,o=null!=t?t:{},d=e.escapeExpression;return" "+(null!=(s=a.ifEquals.call(o,null!=t?t.id:t,"gseparator",{name:"ifEquals",hash:{},fn:e.program(2,r,0,l,n),inverse:e.noop,data:r}))?s:"")+' <tr class="selectBoxSelect2"> <td>'+d(a.getI18n.call(o,null!=t?t.title:t,{name:"getI18n",hash:{},data:r}))+'</td> <td> <div class="newSelect"> <select id="'+d(e.lambda(null!=t?t.id:t,t))+'" tabindex="-1" class="select2-hidden-accessible" aria-hidden="true" '+(null!=(s=a.ifEquals.call(o,null!=t?t.id:t,"dseparator",{name:"ifEquals",hash:{},fn:e.program(4,r,0,l,n),inverse:e.noop,data:r}))?s:"")+(null!=(s=a.ifEquals.call(o,null!=t?t.id:t,"gseparator",{name:"ifEquals",hash:{},fn:e.program(6,r,0,l,n),inverse:e.noop,data:r}))?s:"")+"> "+(null!=(s=a.each.call(o,null!=t?t.optionsArray:t,{name:"each",hash:{},fn:e.program(8,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" </select> </div> </td> </tr> "},2:function(e,t,a,i,r){return' <tr><td nowrap="" colspan="2" class="proximas alignLeftImp">'+e.escapeExpression(a.getI18n.call(null!=t?t:{},"crm.label.pref.numberformat",{name:"getI18n",hash:{},data:r}))+"</td></tr> "},4:function(e,t,a,i,r){return'onchange="CPMF.chdecimal()"'},6:function(e,t,a,i,r){return'onchange="CPMF.chgrouping()"'},8:function(e,t,a,i,r,l,n){var s,o=e.lambda,d=e.escapeExpression,c=null!=t?t:{};return' <option data-zcqa="'+d(o(null!=t?t.value:t,t))+'_option" value="'+d(o(null!=t?t.value:t,t))+'" '+(null!=(s=a.ifEquals.call(c,null!=n[1]?n[1].id:n[1],"dseparator",{name:"ifEquals",hash:{},fn:e.program(9,r,0,l,n),inverse:e.noop,data:r}))?s:"")+(null!=(s=a.ifEquals.call(c,null!=n[1]?n[1].id:n[1],"gseparator",{name:"ifEquals",hash:{},fn:e.program(9,r,0,l,n),inverse:e.noop,data:r}))?s:"")+(null!=(s=a.if.call(c,null!=t?t.selected:t,{name:"if",hash:{},fn:e.program(11,r,0,l,n),inverse:e.noop,data:r}))?s:"")+">"+d(o(null!=t?t.displayName:t,t))+"</option> "},9:function(e,t,a,i,r){return'data-option="'+e.escapeExpression(e.lambda(null!=t?t.actualvalue:t,t))+'"'},11:function(e,t,a,i,r){return"selected"},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r,l,n){var s;return' <table class="wf_form_UI wf_form_focus mT0" cellspacing="0" cellpadding="0" width="100%"> <tbody> '+(null!=(s=a.each.call(null!=t?t:{},null!=t?t.userLocaleJSONArray:t,{name:"each",hash:{},fn:e.program(1,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" </tbody> </table>"},useData:!0,useDepths:!0}),t.clientPortalUserLocaleList=e({1:function(e,t,a,i,r){var l=e.lambda,n=e.escapeExpression;return' <li data-zcqa="'+n(l(null!=t?t.actual_value:t,t))+'_option" class="selValLanguage pR '+n(l(null!=t?t.actual_value:t,t))+'" onclick="inSplnk.fnLanguageSelect(this);" value="'+n(l(null!=t?t.actual_value:t,t))+'">'+n(l(null!=t?t.display_value:t,t))+"</li> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l;return'<ul class="listSelectVal cP m0 p0 whiteBg oA"> '+(null!=(l=a.each.call(null!=t?t:{},null!=t?t.pick_list_values:t,{name:"each",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?l:"")+" </ul>"},useData:!0}),t.commonProfilePermissionPopup=e({1:function(e,t,a,i,r){return" -"+e.escapeExpression(e.lambda(null!=t?t.module:t,t))+" "},3:function(e,t,a,i,r){return" <div id='defaultProfileInfo' class='plErrMsg mT10' style='display:none;'> "+e.escapeExpression(a.getI18n.call(null!=t?t:{},null!=t?t.defaultProfileInfoMessageKey:t,{name:"getI18n",hash:{},data:r}))+" </div> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l,n=e.lambda,s=e.escapeExpression,o=null!=t?t:{};return"<div class='newPopup' id='"+s(n(null!=t?t.popupId:t,t))+"'> <div class='modBld' id='cm_heading'> <div style='position:absolute;display:none;' id='permissionError' class='errorAlert'></div> <div class='formBldPopHd' id='cm_title'>"+s(a.getI18n.call(o,null!=t?t.titleKey:t,{name:"getI18n",hash:{},data:r}))+" "+(null!=(l=a.if.call(o,null!=t?t.module:t,{name:"if",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?l:"")+"</div> </div> <div class='crm-font-regular f13 color_3 p30' id='cm_per_desc'> "+s(a.getI18n.call(o,null!=t?t.contentKey:t,{name:"getI18n",hash:{},data:r}))+" <div class='mT5' style='width:500px;'> <table width='100%' border='0' cellspacing='0'> <tbody> <tr> <td valign='top'></td> <td valign='top'> <div id='profileSelectDiv'> <div class='cchosen customSelectFrm'> <select multiple name='profileId' id='"+s(n(null!=t?t.featureName:t,t))+"ProfileSelect' class='chosen-select' style='width: 350px;'> </select> </div> </div> </td> </tr> </tbody> </table> </div> "+(null!=(l=a.if.call(o,null!=t?t.defaultProfileInfoMessageKey:t,{name:"if",hash:{},fn:e.program(3,r,0),inverse:e.noop,data:r}))?l:"")+" </div> <div class='popup-model-footer alignRight tgl'> <input type='button' class='newgraybtn' id='"+s(n(null!=t?t.cancelButtonId:t,t))+"' data-zcqa='"+s(n(null!=t?t.cancelButtonzcqa:t,t))+"' value='"+s(a.getI18n.call(o,"crm.button.cancel",{name:"getI18n",hash:{},data:r}))+"'></input> <input type='button' class='newSaveBtn' id='"+s(n(null!=t?t.saveButtonId:t,t))+"' data-zcqa='"+s(n(null!=t?t.saveButtonzcqa:t,t))+"' value='"+s(a.getI18n.call(o,"crm.button.save",{name:"getI18n",hash:{},data:r}))+"'></input> </div> </div>"},useData:!0}),t.criteriaEditor=e({1:function(e,t,a,i,r){return'class="hide"'},3:function(e,t,a,i,r,l,n){var s;return" "+(null!=(s=a.each.call(null!=t?t:{},t,{name:"each",hash:{},fn:e.program(4,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "},4:function(e,t,a,i,r,l,n){var s;return' \x3c!--optgroup label="'+e.escapeExpression(e.lambda(r&&r.key,t))+'" style="border:none"--\x3e '+(null!=(s=a.each.call(null!=t?t:{},t,{name:"each",hash:{},fn:e.program(5,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" \x3c!--/optgroup--\x3e "},5:function(e,t,a,i,r,l,n){var s;return" "+(null!=(s=a.ifCondLogic.call(null!=t?t:{},null!=t?t.display_type:t,"!=",0,"||",null!=n[3]?n[3].source:n[3],"==","blueprint",{name:"ifCondLogic",hash:{},fn:e.program(6,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "},6:function(e,t,a,i,r,l,n){var s;return" "+(null!=(s=a.isNotPartOf.call(null!=t?t:{},"LATITUDE,EMAILTEMPLATEID",null!=t?t.column_name:t,{name:"isNotPartOf",hash:{},fn:e.program(7,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "},7:function(e,t,a,i,r,l,n){var s,o=e.lambda,d=e.escapeExpression,c=null!=t?t:{};return" <option col="+d(o(null!=t?t.column_name:t,t))+' module="'+d(o(null!=t?t.module:t,t))+'" id="'+d(a.getDataType.call(c,t,{name:"getDataType",hash:{},data:r}))+'" value="'+(null!=(s=a.if.call(c,null!=n[3]?n[3].addModulePrefix:n[3],{name:"if",hash:{},fn:e.program(8,r,0,l,n),inverse:e.noop,data:r}))?s:"")+d(o(null!=t?t.api_name:t,t))+'" '+(null!=(s=a.ifEquals.call(c,null!=t?t.data_type:t,"currency",{name:"ifEquals",hash:{},fn:e.program(11,r,0,l,n),inverse:e.noop,data:r}))?s:"")+' data-params="'+d(a.getFieldDetails.call(c,t,{name:"getFieldDetails",hash:{},data:r}))+'" data-enc="'+d(o(null!=t?t["data-enc"]:t,t))+'" '+(null!=(s=a.ifEquals.call(c,null!=t?t.data_type:t,"predefined",{name:"ifEquals",hash:{},fn:e.program(13,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "+(null!=(s=a.if.call(c,null!=t?t.decimal_place:t,{name:"if",hash:{},fn:e.program(15,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "+(null!=(s=a.ifCond.call(c,null!=t?t.disabled:t,"=",!0,{name:"ifCond",hash:{},fn:e.program(18,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "+(null!=(s=a.ifCond.call(c,null!=t?t.tooltip:t,"!=",void 0,{name:"ifCond",hash:{},fn:e.program(20,r,0,l,n),inverse:e.noop,data:r}))?s:"")+">"+d(o(null!=t?t.display_label:t,t))+(null!=(s=a.ifNotEquals.call(c,e.data(r,2)&&e.data(r,2).index,0,{name:"ifNotEquals",hash:{},fn:e.program(22,r,0,l,n),inverse:e.noop,data:r}))?s:"")+"</option> "},8:function(e,t,a,i,r,l,n){var s;return null!=(s=a.if.call(null!=t?t:{},e.data(r,1)&&e.data(r,1).key,{name:"if",hash:{},fn:e.program(9,r,0,l,n),inverse:e.noop,data:r}))?s:""},9:function(e,t,a,i,r,l,n){return e.escapeExpression(e.lambda(e.data(r,1)&&e.data(r,1).key,t))+"."},11:function(e,t,a,i,r){return"currency='true'"},13:function(e,t,a,i,r){var l=e.lambda,n=e.escapeExpression;return'comparator="'+n(l(null!=t?t.comparator:t,t))+'" val="'+n(l(null!=t?t.value:t,t))+'"'},15:function(e,t,a,i,r){var l;return null!=(l=a.ifNotEquals.call(null!=t?t:{},null!=t?t.decimal_place:t,null,{name:"ifNotEquals",hash:{},fn:e.program(16,r,0),inverse:e.noop,data:r}))?l:""},16:function(e,t,a,i,r){return'data-decimal-length="'+e.escapeExpression(e.lambda(null!=t?t.decimal_place:t,t))+'"'},18:function(e,t,a,i,r){return"disabled"},20:function(e,t,a,i,r){return"tooltip='"+e.escapeExpression(e.lambda(null!=t?t.tooltip:t,t))+"'"},22:function(e,t,a,i,r,l,n){var s;return null!=(s=a.if.call(null!=t?t:{},null!=n[3]?n[3].suffixModule:n[3],{name:"if",hash:{},fn:e.program(23,r,0,l,n),inverse:e.noop,data:r}))?s:""},23:function(e,t,a,i,r){return" ( "+e.escapeExpression(a.getDisplayModuleName.call(null!=t?t:{},null!=t?t.module:t,!1,{name:"getDisplayModuleName",hash:{},data:r}))+" )"},25:function(e,t,a,i,r){return""},27:function(e,t,a,i,r){return" <span id='searchstampmSpan' class='ampmSpan'  ampm='AM' >"+e.escapeExpression(a.getI18n.call(null!=t?t:{},"AM",{name:"getI18n",hash:{},data:r}))+"</span> <input type='hidden' id='searchstampm' value='AM' class='searchampm'> "},29:function(e,t,a,i,r){return" <span id='searchetampmSpan' data-zcqa='searchetampmSpan1' class='ampmSpan' ampm='AM' >"+e.escapeExpression(a.getI18n.call(null!=t?t:{},"AM",{name:"getI18n",hash:{},data:r}))+"</span><input type='hidden' id='searchetampm' data-zcqa='searchetampm1' value='AM' class='searchampm'> "},31:function(e,t,a,i,r){return'hideOperator="true"'},33:function(e,t,a,i,r,l,n){var s;return" "+(null!=(s=a.each.call(null!=t?t:{},t,{name:"each",hash:{},fn:e.program(34,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "},34:function(e,t,a,i,r,l,n){var s;return' \x3c!--optgroup label="'+e.escapeExpression(e.lambda(r&&r.key,t))+'" style="border:none"--\x3e '+(null!=(s=a.each.call(null!=t?t:{},t,{name:"each",hash:{},fn:e.program(35,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" \x3c!--/optgroup--\x3e "},35:function(e,t,a,i,r,l,n){var s;return" "+(null!=(s=a.ifCondLogic.call(null!=t?t:{},null!=t?t.column_name:t,"!=","EMAILTEMPLATEID","&&",null!=t?t.sys_ref_name:t,"!=","Pricing_Details",{name:"ifCondLogic",hash:{},fn:e.program(36,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "},36:function(e,t,a,i,r,l,n){var s;return" "+(null!=(s=a.ifCondLogic.call(null!=t?t:{},null!=t?t.display_type:t,"!=",0,"||",null!=n[3]?n[3].source:n[3],"==","blueprint",{name:"ifCondLogic",hash:{},fn:e.program(7,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "},38:function(e,t,a,i,r){return e.escapeExpression(a.encodeHTML.call(null!=t?t:{},null!=t?t.localePattern:t,{name:"encodeHTML",hash:{},data:r}))},40:function(e,t,a,i,r){return"1"},42:function(e,t,a,i,r){return e.escapeExpression(a.encodeHTML.call(null!=t?t:{},null!=t?t.currentPattern:t,{name:"encodeHTML",hash:{},data:r}))},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r,l,n){var s,o=e.lambda,d=e.escapeExpression,c=null!=t?t:{};return' <div class="pwie"> <div id=\'criteriaDiv'+d(o(null!=t?t.suffix:t,t))+'\' class="crtEditorDiv"> <table class="newFormContBlk" cellpadding="0" cellspacing="0" width="100%" class="mt5"> <tr> <td valign="top"> <div > <table  style="display:none"> <tbody> <tr id="searchcriteria0" data-index=\'0\'> <td style="opacity:1;" '+(null!=(s=a.if.call(c,null!=t?t.hideOperator:t,{name:"if",hash:{},fn:e.program(1,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'> <div class="wf_slideDownUp_Div" style="height: auto; opacity: 1; overflow: visible;"> <div class="andOrOp" style="opacity: 1; height: auto;"> <label id="matchConditionLabel" class="cus_cb_label" onClick="wfForm.setOprSel_new(this,\''+d(a.encodeJS.call(c,null!=t?t.suffix:t,{name:"encodeJS",hash:{},data:r}))+'\');"> <input type="checkbox" id="condition_inp'+d(o(null!=t?t.suffix:t,t))+'" class="cus_cb_inp" onClick="sE(event);" checked> <span class="cus_cb_sp"> <span id="matchCndtnAnd'+d(o(null!=t?t.suffix:t,t))+'" class="cus_cb_and alink">'+d(a.getI18n.call(c,"crm.label.and",{name:"getI18n",hash:{},data:r}))+'</span> <span id="matchCndtnOr'+d(o(null!=t?t.suffix:t,t))+'" class="cus_cb_or alink">'+d(a.getI18n.call(c,"crm.label.or",{name:"getI18n",hash:{},data:r}))+'</span> </span> </label> <select id="match'+d(o(null!=t?t.suffix:t,t))+'"  class="hide searchMatch" onChange="Search.changeOprValPattern_new(this, \''+d(a.encodeJS.call(c,null!=t?t.suffix:t,{name:"encodeJS",hash:{},data:r}))+'\')"> <option value="and" data-val="AND" selected>'+d(a.getI18n.call(c,"crm.label.and",{name:"getI18n",hash:{},data:r}))+'</option> <option value="or" data-val="OR">'+d(a.getI18n.call(c,"crm.label.or",{name:"getI18n",hash:{},data:r}))+'</option> </select> </div> <input type="text" id="patternNum'+d(o(null!=t?t.suffix:t,t))+'" class="searchMatchText" value=\'1\' readOnly> </div> </td> <td width=""> <div class="wf_slideDownUp_Div" style="height: auto; opacity: 1; overflow: visible;"> <div class=\'wf_chosen_ui\' onmouseover = "Search.hideCS(this)"> <input type="hidden" id="previousSelectedValue'+d(o(null!=t?t.suffix:t,t))+'" value=""> <select id="searchfield" class="searchfld" onChange="Search.changeField_new(this);wfForm.setSltVal(this);"> <option value="none" id="text">'+d(a.getI18n.call(c,"None",{name:"getI18n",hash:{},data:r}))+"</option> "+(null!=(s=a.each.call(c,null!=t?t.fields:t,{name:"each",hash:{},fn:e.program(3,r,0,l,n),inverse:e.noop,data:r}))?s:"")+' </select> </div> <div> </td> <td valign="top"> <div class="wf_slideDownUp_Div" style="height: auto; opacity: 1; overflow: visible;"> <div class=\'wf_chosen_ui\' id=\'textcondition\'> <select id="textcondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);" disabled>'+(null!=(s=a.formConditions.call(c,"TXTCOND1","true",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'enc_textcondition\' style="display:none"> <select id="enc_textcondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);" disabled>'+(null!=(s=a.formConditions.call(c,"ENCTXTCOND1","true",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'booleancondition\' style="display:none"> <select id="booleancondition" class="searchcond"><option value="equal">'+d(a.getI18n.call(c,"is",{name:"getI18n",hash:{},data:r}))+'</option></select> </div> <div class=\'wf_chosen_ui\' id=\'defaultcondition\' style="display:none"> <select id="defaultcondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);">'+(null!=(s=a.formConditions.call(c,"DEFAULT","true",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'servicestatuscondition\' style="display:none"> <select id="servicestatuscondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);">'+(null!=(s=a.formConditions.call(c,"SERVICESTATUSCOND",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'defwithemptycondition\' style="display:none"> <select id="defwithemptycondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);">'+(null!=(s=a.formConditions.call(c,"DEFAULT","true",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'datecondition\' style="display:none"> <select id="datecondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);">'+(null!=(s=a.formConditions.call(c,"DATETIMECOND1","true",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'enc_datecondition\' style="display:none"> <select id="enc_datecondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);">'+(null!=(s=a.formConditions.call(c,"ENCTXTCOND1","true",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'numcondition\' style="display:none"> <select id="numcondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);">'+(null!=(s=a.formConditions.call(c,"NUMCOND1","true",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'durationcondition\' style="display:none"> <select id="durationcondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);">'+(null!=(s=a.formConditions.call(c,"NUMCOND1",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'enc_numcondition\' style="display:none"> <select id="enc_numcondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);">'+(null!=(s=a.formConditions.call(c,"ENCNUMCOND1","true",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'cscondition\' style="display:none"> <select id="cscondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);">'+(null!=(s=a.formConditions.call(c,"CS",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'consentcondition\' style="display:none"> <select id="consentcondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);">'+(null!=(s=a.formConditions.call(c,"CONSENTCOND",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'tagcondition\' style="display:none"> <select id="tagcondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);">'+(null!=(s=a.formConditions.call(c,"DEFAULT","true",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'predefinedcondition\' style="display:none"> <select id="predefinedcondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);" disabled>'+(null!=(s=a.formConditions.call(c,"PREDEFINED","true",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'stagecond\' style="display:none"> <select id="stagecond" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);" disabled>'+(null!=(s=a.formConditions.call(c,"STAGECOND","true",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> </div> </td> <td valign="top" width="360" class="wf_field_type_td" id="wf_field_type_td"> <div class="wf_slideDownUp_Div tr_cnt_1" style="height: auto; opacity: 1; overflow: visible;"> <div class="wf_chosen_ui fL mR10 cri_cr_md_fl wAuto"  id="ageindayscond" style=\'display:none\'> <select id="ageindayscondition" data-zcqa="ageindayscondition1" onchange="wfForm.setSltVal(this);">'+(null!=(s=a.formConditions.call(c,"AGEINDAYSCOND1",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class="wf_chosen_ui fL mR10 cri_cr_md_fl wAuto"  id="lengthconddiv" style=\'display:none\'> <select id="lengthcondition" data-zcqa="lengthcondition1" onchange="Search.changeNOCCondition(this);wfForm.setSltVal(this);">'+(null!=(s=a.formConditions.call(c,"NUMCOND1",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div id="searchval_div" class=\'pR userDiv\'> <div data-zcqa="currencyCode" id="currencyCode" class="fL mT10 dN mR5">'+d(a.getUserDetail.call(c,"BASE_CURRENCY",{name:"getUserDetail",hash:{},data:r}))+'</div> <input id="temp_searchcampcv" type="text" class="w342 newinputText fL dN" size="30" readonly> <span id="campCvLookup" class="searchHide" style="position:absolute; right:10px; top:7px;"> <img id="campCvImg" data-zcqa="campCvImg1" src="'+d(a.img_link.call(c,{name:"img_link",hash:{},data:r}))+"/spacer_e17b417_.gif\" class=\"Campaigns-small\" width=\"17\" height=\"17\" border=\"0\" title=\"Campaign Name Lookup\" align=\"absmiddle\" onClick=\"return Search.campLookup_new(this)\"> </span> <div class=\"dateTimeFlds fL\" style=\"display:none\"> <input type='hidden' id='searchsthour' class='searchhour' data-zcqa='searchsthour1' value='01'> <input type='hidden' id='searchstminute' class='searchmin' data-zcqa='searchstminute1' value='00'> <span class='newtimefrmt newinputText rmvBrdrLft fL newDTFld'> <input type='text' id=\"searchstime\" fldlabel='searchst@{pattern}' onClick='sE(event);' value='01:00' maxlength='5' class='textField ddTime searchtime newSrchView'></input> "+(null!=(s=a.ifNotEquals.call(c,null!=t?t.userTimeFormat:t,"HH:mm",{name:"ifNotEquals",hash:{},fn:e.program(27,r,0,l,n),inverse:e.noop,data:r}))?s:"")+' </span> </div> <div id="endTimeFields" style="display:none" class="cri_divdatetime endDateFld fL"> <input size="15" id="searchenddate" data-zcqa="searchenddate1" type="text" class="newinputText fL searchdate"  placeholder="'+d(a.getUserDetail.call(c,"DATE_PATTERN",{name:"getUserDetail",hash:{},data:r}))+"\" onClick=\"showCalen(this.id,undefined, undefined, undefined, true)\"> <div class=\"dateTimeFlds fL\" style=\"display:none\"> <input type='hidden' id='searchethour' class='searchhour' data-zcqa='searchethour1' value='01'> <input type='hidden' id='searchetminute' class='searchmin' data-zcqa='searchetminute1' value='00'> <span class='newtimefrmt newinputText rmvBrdrLft fL newDTFld'> <input type='text' id=\"searchetime\" data-zcqa=\"searchetime1\" fldlabel='searchet@{pattern}'  onClick='sE(event);' maxlength='5' value=\"01:00\" class='textField ddTime searchtime newSrchView'></input> "+(null!=(s=a.ifNotEquals.call(c,null!=t?t.userTimeFormat:t,"HH:mm",{name:"ifNotEquals",hash:{},fn:e.program(29,r,0,l,n),inverse:e.noop,data:r}))?s:"")+' </span> </div> </div> <div id="endNumFields" style="display:none" class="cri_divdatetime endDateFld fL"> <input type="text" placeholder=\''+d(a.getI18n.call(c,"crm.gcal.capsto",{name:"getI18n",hash:{},data:r}))+'\' class="w342 newinputText fL searchdate" id="searchEndValue" class="searchvalue" readonly="readonly" onpaste="return Search.handleSearchValPaste(this,event);"> </div> </div> </div> </td> <td class="alignleft" valign="top" id="addOrRemoveCriTD"> <div class="wf_slideDownUp_Div tr_cnt_1" style="height: auto; opacity: 1; overflow: visible;"> <a id="check1" class=\'removeCriteria\' onClick=\'Search.removeCriteria_new(this,"'+d(o(null!=t?t.suffix:t,t))+'");return false;\'/></a> <a id="addRow" class="addCriteria" onClick="Search.addCriteria_new(\''+d(o(null!=t?t.maxCrtCnt:t,t))+"','', '', undefined, this,'"+d(o(null!=t?t.suffix:t,t))+'\');" /></a> </div> </td> </tr> </tbody> </table> <table id="searchlayer_new'+d(o(null!=t?t.suffix:t,t))+'" border="0" cellpadding="0" cellspacing="0" class="newApCriteriaTable newCriUi newSrchView" '+(null!=(s=a.if.call(c,null!=t?t.hideOperator:t,{name:"if",hash:{},fn:e.program(31,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'> <tbody> <tr id="searchcrt1" class="searchcrt" data-index=\'1\'> <td style="opacity:1;" '+(null!=(s=a.if.call(c,null!=t?t.hideOperator:t,{name:"if",hash:{},fn:e.program(1,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'> <div class="wf_slideDownUp_Div" style="height: auto; opacity: 1; overflow: visible;"> <input type="hidden" id="match" value=""> <input type="text" id="patternNum'+d(o(null!=t?t.suffix:t,t))+'" class="searchMatchText" value=\'1\' readOnly> </div> </td> <td width=""> <div class="wf_slideDownUp_Div" style="height: auto; opacity: 1; overflow: visible;"> <div class=\'wf_chosen_ui\' onmouseover = "Search.hideCS(this)"> <input type="hidden" id="previousSelectedValue'+d(o(null!=t?t.suffix:t,t))+'" value=""> <select id="searchfield" class="searchfld" onChange="Search.changeField_new(this);wfForm.setSltVal(this);"> <option value="none" id="text">'+d(a.getI18n.call(c,"None",{name:"getI18n",hash:{},data:r}))+"</option> "+(null!=(s=a.each.call(c,null!=t?t.fields:t,{name:"each",hash:{},fn:e.program(33,r,0,l,n),inverse:e.noop,data:r}))?s:"")+' </select> </div> <div> </td> <td valign="top"> <div class="wf_slideDownUp_Div" style="height: auto; opacity: 1; overflow: visible;"> <div class=\'wf_chosen_ui\' id=\'textcondition\'> <select id="textcondition" class="searchcond searchcondition" onChange="Search.changeCondition(this);wfForm.setSltVal(this);" disabled>'+(null!=(s=a.formConditions.call(c,"TXTCOND1","true",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'enc_textcondition\' style="display:none"> <select id="enc_textcondition" class="searchcond searchcondition" onChange="Search.changeCondition(this);wfForm.setSltVal(this);" disabled>'+(null!=(s=a.formConditions.call(c,"ENCTXTCOND1","true",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'booleancondition\' style="display:none"> <select id="booleancondition" class="searchcond"><option value="equal">'+d(a.getI18n.call(c,"is",{name:"getI18n",hash:{},data:r}))+'</option></select> </div> <div class=\'wf_chosen_ui\' id=\'defaultcondition\' style="display:none"> <select id="defaultcondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);">'+(null!=(s=a.formConditions.call(c,"DEFAULT","true",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'servicestatuscondition\' style="display:none"> <select id="servicestatuscondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);">'+(null!=(s=a.formConditions.call(c,"SERVICESTATUSCOND",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'defwithemptycondition\' style="display:none"> <select id="defwithemptycondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);">'+(null!=(s=a.formConditions.call(c,"DEFAULT","true",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'datecondition\' style="display:none"> <select id="datecondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);">'+(null!=(s=a.formConditions.call(c,"DATETIMECOND1","true",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'enc_datecondition\' style="display:none"> <select id="enc_datecondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);">'+(null!=(s=a.formConditions.call(c,"ENCTXTCOND1","true",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'numcondition\' style="display:none"> <select id="numcondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);">'+(null!=(s=a.formConditions.call(c,"NUMCOND1","true",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'durationcondition\' style="display:none"> <select id="durationcondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);">'+(null!=(s=a.formConditions.call(c,"NUMCOND1",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'enc_numcondition\' style="display:none"> <select id="enc_numcondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);">'+(null!=(s=a.formConditions.call(c,"ENCNUMCOND1","true",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'cscondition\' style="display:none"> <select id="cscondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);">'+(null!=(s=a.formConditions.call(c,"CS",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'consentcondition\' style="display:none"> <select id="consentcondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);">'+(null!=(s=a.formConditions.call(c,"CONSENTCOND",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'neartocondition\' style="display:none"> <select id="neartocondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);"><option value="near_to">'+d(a.getI18n.call(c,"Near By",{name:"getI18n",hash:{},data:r}))+'</option></select> </div> <div class=\'wf_chosen_ui\' id=\'tagcondition\' style="display:none"> <select id="tagcondition" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);">'+(null!=(s=a.formConditions.call(c,"DEFAULT","true",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'predefinedcondition\' style="display:none"> <select id="predefinedcondition" class="searchcond searchcondition" onChange="Search.changeCondition(this);wfForm.setSltVal(this);" disabled>'+(null!=(s=a.formConditions.call(c,"PREDEFINED","true",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class=\'wf_chosen_ui\' id=\'stagecond\' style="display:none"> <select id="stagecond" class="searchcond" onChange="Search.changeCondition(this);wfForm.setSltVal(this);" disabled>'+(null!=(s=a.formConditions.call(c,"STAGECOND","true",{name:"formConditions",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> </div> </td> <td valign="top" width="360" class="wf_field_type_td" id="wf_field_type_td"> <div class="wf_slideDownUp_Div tr_cnt_1" style="height: auto; opacity: 1; overflow: visible;"> <div class="wf_chosen_ui fL mR10 cri_cr_md_fl wAuto"  id="ageindayscond" style=\'display:none\'> <select id="ageindayscondition" data-zcqa="ageindayscondition1" onchange="wfForm.setSltVal(this);">'+(null!=(s=a.getDateTimeCVFilters.call(c,"AGEINDAYSCOND1",{name:"getDateTimeCVFilters",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div class="wf_chosen_ui fL mR10 cri_cr_md_fl wAuto"  id="lengthconddiv" style=\'display:none\'> <select id="lengthcondition" data-zcqa="lengthcondition1" onchange="Search.changeNOCCondition(this);wfForm.setSltVal(this);">'+(null!=(s=a.getDateTimeCVFilters.call(c,"NUMCOND1",{name:"getDateTimeCVFilters",hash:{},fn:e.program(25,r,0,l,n),inverse:e.noop,data:r}))?s:"")+'</select> </div> <div id="searchval_div" class=\'pR userDiv\'> <div data-zcqa="currencyCode" id="currencyCode" class="fL mT10 dN mR5">'+d(a.getUserDetail.call(c,"BASE_CURRENCY",{name:"getUserDetail",hash:{},data:r}))+'</div> <input type="text" class="w342 newinputText fL searchdate criteriaDateInput" id="searchValue" class="searchvalue" readonly="readonly" onpaste="return Search.handleSearchValPaste(this,event);"> <div id="userComponentDiv'+d(o(null!=t?t.suffix:t,t))+"_0\"> <crm-multiuserdd-wrapper placeholder='"+d(a.getI18n.call(c,"crm.label.select.user",{name:"getI18n",hash:{},data:r}))+"' id=\"temp_searchuser"+d(o(null!=t?t.suffix:t,t))+'" zcqa="temp_searchuser'+d(o(null!=t?t.suffix:t,t))+'" class="userNameObj multiuserDD" selected-users="" selected-names="" field-id="searchValue"> </crm-multiuserdd-wrapper> </div> <input id="temp_searchcampcv" type="text" class="w342 newinputText fL dN" size="30" readonly> <span id="campCvLookup" class="searchHide" style="position:absolute; right:10px; top:7px;"> <img id="campCvImg" data-zcqa="campCvImg1" src="'+d(a.img_link.call(c,{name:"img_link",hash:{},data:r}))+"/spacer_e17b417_.gif\" class=\"Campaigns-small\" width=\"17\" height=\"17\" border=\"0\" title=\"Campaign Name Lookup\" align=\"absmiddle\" onClick=\"return Search.campLookup_new(this)\"> </span> <div class=\"dateTimeFlds fL\" style=\"display:none\"> <input type='hidden' id='searchsthour' class='searchhour' data-zcqa='searchsthour1' value='01'> <input type='hidden' id='searchstminute' class='searchmin' data-zcqa='searchstminute1' value='00'> <span class='newtimefrmt newinputText rmvBrdrLft fL newDTFld'> <input type='text' id=\"searchstime\" fldlabel='searchst@{pattern}' onClick='sE(event);' value='01:00' maxlength='5' class='textField ddTime searchtime newSrchView'></input> "+(null!=(s=a.ifNotEquals.call(c,null!=t?t.userTimeFormat:t,"HH:mm",{name:"ifNotEquals",hash:{},fn:e.program(27,r,0,l,n),inverse:e.noop,data:r}))?s:"")+' </span> </div> <div id="endTimeFields" style="display:none" class="cri_divdatetime endDateFld fL"> <input size="15" id="searchenddate" data-zcqa="searchenddate1" type="text" class="newinputText fL searchdate"  placeholder="'+d(a.getUserDetail.call(c,"DATE_PATTERN",{name:"getUserDetail",hash:{},data:r}))+"\" onClick=\"showCalen(this.id,undefined, undefined, undefined, true)\"> <div class=\"dateTimeFlds fL\" style=\"display:none\"> <input type='hidden' id='searchethour' class='searchhour' data-zcqa='searchethour1' value='01'> <input type='hidden' id='searchetminute' class='searchmin' data-zcqa='searchetminute1' value='00'> <span class='newtimefrmt newinputText rmvBrdrLft fL newDTFld criteriaTimeInput'> <input type='text' id=\"searchetime\" data-zcqa=\"searchetime1\" fldlabel='searchet@{pattern}'  onClick='sE(event);' maxlength='5' value=\"01:00\" class='textField ddTime searchtime newSrchView'></input> "+(null!=(s=a.ifNotEquals.call(c,null!=t?t.userTimeFormat:t,"HH:mm",{name:"ifNotEquals",hash:{},fn:e.program(29,r,0,l,n),inverse:e.noop,data:r}))?s:"")+' </span> </div> </div> <div id="endNumFields" style="display:none" class="cri_divdatetime endDateFld fL"> <input type="text" placeholder=\''+d(a.getI18n.call(c,"crm.gcal.capsto",{name:"getI18n",hash:{},data:r}))+'\' class="w342 newinputText fL searchdate" id="searchEndValue" class="searchvalue" readonly="readonly" onpaste="return Search.handleSearchValPaste(this,event);"> </div> </div> </div> </td> <td class="alignleft" valign="top" id="addOrRemoveCriTD"> <div class="wf_slideDownUp_Div tr_cnt_1" style="height: auto; opacity: 1; overflow: visible;"> <a id="check1" class=\'removeCriteria\' onClick=\'Search.removeCriteria_new(this,"'+d(o(null!=t?t.suffix:t,t))+'");return false;\' style="display:none;"/></a> <a id="addRow" class="addCriteria" onClick="Search.addCriteria_new(\''+d(o(null!=t?t.maxCrtCnt:t,t))+"','', '', undefined, this,'"+d(o(null!=t?t.suffix:t,t))+'\');" /></a> </div> </td> </tr> <tr style="display:none" class="criPatternTab" id=\'critTable'+d(o(null!=t?t.suffix:t,t))+'\'> <td colspan="0" valign="top"></td> <td colspan="3" class="vat pR0"> <div class="w100per oH new_pat_edtr" id="changePattern'+d(o(null!=t?t.suffix:t,t))+'"> <table cellpadding="0" cellspacing="0" border="0" class="new_criPattern w100per"> <tr class="wf_no_focus"> <td > <span class="wf_form_lab dIB vam">'+d(a.getI18n.call(c,"Criteria Pattern",{name:"getI18n",hash:{},data:r}))+'</span> </td> <td> <span class="pL0 dIB vam color_3 crm-font-regular cri_pattern" style="max-width: 67%;" id="pattern'+d(o(null!=t?t.suffix:t,t))+'">'+(null!=(s=a.if.call(c,null!=t?t.currentPattern:t,{name:"if",hash:{},fn:e.program(38,r,0,l,n),inverse:e.program(40,r,0,l,n),data:r}))?s:"")+'</span> <a href="javascript:;" data-zcqa="editPattern_previousSelected" class="mL10 link1 f13 crm-font-regular dIB vam" id="editPattern'+d(o(null!=t?t.suffix:t,t))+'" onClick="Search.changePattern(\''+d(a.encodeJS.call(c,null!=t?t.maxCrtCnt:t,{name:"encodeJS",hash:{},data:r}))+"', '"+d(a.encodeJS.call(c,null!=t?t.suffix:t,{name:"encodeJS",hash:{},data:r}))+"');return false;\">"+d(a.getI18n.call(c,"crm.label.edit.criteria.pattern",{name:"getI18n",hash:{},data:r}))+'</a> <a href="javascript:;" data-zcqa="logintooltipid_previousSelected" id="logintooltipid" class="iconHelp mT1 mL10 vam" onmouseover="crmui.toolTip_show(this,\'center\',\''+d(a.getI18n.call(c,"crm.label.context.help",{name:"getI18n",hash:{},data:r}))+'\');" onmouseout="crmui.toolTip_hide();" onClick="openHelp(\''+d(a.getHelpUrl.call(c,"help.change.criteria.pattern",{name:"getHelpUrl",hash:{},data:r}))+'\');return false;"></a> </td> </tr> </table> </div> <div class="new_pat_edtr" id="newpattern'+d(o(null!=t?t.suffix:t,t))+'" style="display:none" > <table id="new_pat_edtr_pattn" cellpadding="0" cellspacing="0" border="0" class="new_criPattern w100per mT0 wf_form_focus wf_form_UI" onclick="sE(event);"> <tr> <td class="vat"> <div class="wf_form_lab vam" >'+d(a.getI18n.call(c,"Criteria Pattern",{name:"getI18n",hash:{},data:r}))+'</div> </td> <td class="pR"> <div class="newinputText p0 vam new_pattern_ui"> <textarea data-zcqa="patternVal_previousSelected" id="patternVal'+d(o(null!=t?t.suffix:t,t))+'" class="patternVal dB resizeNone" rows="1" style="width:67%; border:none; " >'+(null!=(s=a.if.call(c,null!=t?t.currentPattern:t,{name:"if",hash:{},fn:e.program(42,r,0,l,n),inverse:e.program(40,r,0,l,n),data:r}))?s:"")+'</textarea> </div> <div class="alignright dIB vam pA" id="updatePattern'+d(o(null!=t?t.suffix:t,t))+'" style="right: 0px;bottom: 7px;"> <a href="javascript:;" data-zcqa="saveChangePattern_previousSelected" id="saveChangePattern'+d(o(null!=t?t.suffix:t,t))+'" class="link1 f13 crm-font-regular" onClick="Search.savePattern(\''+d(a.encodeJS.call(c,null!=t?t.suffix:t,{name:"encodeJS",hash:{},data:r}))+"', true);\">"+d(a.getI18n.call(c,"crm.button.save",{name:"getI18n",hash:{},data:r}))+'</a> <a href="javascript:;" data-zcqa="cancelChangePattern_previousSelected" id="cancelChangePattern'+d(o(null!=t?t.suffix:t,t))+'" class="greyText mL5 f13 crm-font-regular" onClick="Search.cancelChangePattern(\''+d(a.encodeJS.call(c,null!=t?t.suffix:t,{name:"encodeJS",hash:{},data:r}))+"', true); return false;\">"+d(a.getI18n.call(c,"crm.button.cancel",{name:"getI18n",hash:{},data:r}))+'</a> </div> <div class="clearB"></div> </td> </tr> </table> </div> </td> </tr> </tbody> </table> </div></td></tr></table> </div> '},useData:!0,useDepths:!0}),t.crmFormFields=e({1:function(e,t,a,i,r){var l,n=e.lambda,s=e.escapeExpression,o=null!=t?t:{};return' <div class="tabDivCreate" id=\''+s(n(null!=t?t.fieldDiv:t,t))+"' style='"+s(n(null!=t?t.style:t,t))+"'> <div class=\"labelTabCreate pL5 pR "+(null!=(l=a.if_eq.call(o,null!=t?t.mandate:t,"true",{name:"if_eq",hash:{},fn:e.program(2,r,0),inverse:e.noop,data:r}))?l:"")+'" id="'+s(n(null!=t?t.valueLabel:t,t))+'_label">'+s(n(null!=t?t.displaylabel:t,t))+'</div><div class="labelValCreate mL45"> <input type="text" '+(null!=(l=a.if_nq.call(o,null!=t?t.readOnly:t,"true",{name:"if_nq",hash:{},fn:e.program(4,r,0),inverse:e.noop,data:r}))?l:"")+' class="textField" style="width:100%" id=\''+s(n(null!=t?t.labelId:t,t))+"' "+(null!=(l=a.if_eq.call(o,null!=t?t.readOnly:t,"true",{name:"if_eq",hash:{},fn:e.program(6,r,0),inverse:e.noop,data:r}))?l:"")+" data-maxlength='"+s(n(null!=t?t.maxlength:t,t))+"' onblur='"+s(n(null!=t?t.blurfn:t,t))+"' maxlength='"+s(n(null!=t?t.maxlength:t,t))+"' placeholder='"+s(n(null!=t?t.i18fieldType:t,t))+"' data-decimalLength='"+s(n(null!=t?t.decimalLength:t,t))+"' data-zcqa='"+s(n(null!=t?t.labelId:t,t))+"' data-contenttype='"+s(n(null!=t?t.contentType:t,t))+"' data-displaylabel='"+s(n(null!=t?t.displaylabel:t,t))+"' data-i18fieldtype='"+s(n(null!=t?t.i18fieldType:t,t))+"' data-mandate='"+s(n(null!=t?t.mandate:t,t))+"' data-readonly='"+s(n(null!=t?t.readOnly:t,t))+"'  value='"+s(n(null!=t?t.defaultValue:t,t))+"'> </div> </div> "},2:function(e,t,a,i,r){return"newmandatory"},4:function(e,t,a,i,r){return' onfocus="setFocusClass(this);" '},6:function(e,t,a,i,r){return"readonly"},8:function(e,t,a,i,r){var l,n=e.lambda,s=e.escapeExpression,o=null!=t?t:{};return' <div class="tabDivCreate" id=\''+s(n(null!=t?t.fieldDiv:t,t))+"'> <div class=\"labelTabCreate pL5 pR "+(null!=(l=a.if_eq.call(o,null!=t?t.mandate:t,"true",{name:"if_eq",hash:{},fn:e.program(2,r,0),inverse:e.noop,data:r}))?l:"")+'" id="'+s(n(null!=t?t.valueLabel:t,t))+'_label">'+s(n(null!=t?t.displaylabel:t,t))+'</div><div class="labelValCreate mL45"> <span id="currencySymbol_'+s(n(null!=t?t.fieldDiv:t,t))+'" class="inpPrefix" style="opacity:0.6;">&nbsp;</span> <input type="text" '+(null!=(l=a.if_nq.call(o,null!=t?t.readOnly:t,"true",{name:"if_nq",hash:{},fn:e.program(4,r,0),inverse:e.noop,data:r}))?l:"")+' class="textField" style="width:90%" id=\''+s(n(null!=t?t.labelId:t,t))+"' "+(null!=(l=a.if_eq.call(o,null!=t?t.readOnly:t,"true",{name:"if_eq",hash:{},fn:e.program(6,r,0),inverse:e.noop,data:r}))?l:"")+" data-maxlength='"+s(n(null!=t?t.maxlength:t,t))+"' onblur='"+s(n(null!=t?t.blurfn:t,t))+"' maxlength='"+s(n(null!=t?t.maxlength:t,t))+"' placeholder='"+s(n(null!=t?t.i18fieldType:t,t))+"' data-decimalLength='"+s(n(null!=t?t.decimalLength:t,t))+"' data-zcqa='"+s(n(null!=t?t.labelId:t,t))+"' data-contenttype='"+s(n(null!=t?t.contentType:t,t))+"' data-displaylabel='"+s(n(null!=t?t.displaylabel:t,t))+"' data-i18fieldtype='"+s(n(null!=t?t.i18fieldType:t,t))+"' data-mandate='"+s(n(null!=t?t.mandate:t,t))+"' data-readonly='"+s(n(null!=t?t.readOnly:t,t))+"'  value='"+s(n(null!=t?t.defaultValue:t,t))+"'> </div> </div> "},10:function(e,t,a,i,r){var l,n=e.lambda,s=e.escapeExpression,o=null!=t?t:{};return' <div class="tabDivCreate" id=\''+s(n(null!=t?t.fieldDiv:t,t))+"'> <div class=\"labelTabCreate pL5 pR "+(null!=(l=a.if_eq.call(o,null!=t?t.mandate:t,"true",{name:"if_eq",hash:{},fn:e.program(2,r,0),inverse:e.noop,data:r}))?l:"")+'" id="'+s(n(null!=t?t.valueLabel:t,t))+'_label">'+s(n(null!=t?t.displaylabel:t,t))+'</div><div class="labelValCreate mL45"> <textarea '+(null!=(l=a.if_nq.call(o,null!=t?t.readOnly:t,"true",{name:"if_nq",hash:{},fn:e.program(4,r,0),inverse:e.noop,data:r}))?l:"")+' class="textField" style="width:100%" id=\''+s(n(null!=t?t.labelId:t,t))+"' maxlength='"+s(n(null!=t?t.maxlength:t,t))+"' data-maxlength='"+s(n(null!=t?t.maxlength:t,t))+"' data-zcqa='"+s(n(null!=t?t.labelId:t,t))+"' data-contenttype='"+s(n(null!=t?t.contentType:t,t))+"' data-displaylabel='"+s(n(null!=t?t.displaylabel:t,t))+"' data-mandate='"+s(n(null!=t?t.mandate:t,t))+"' data-i18fieldtype='"+s(n(null!=t?t.i18fieldType:t,t))+"' data-readonly='"+s(n(null!=t?t.readOnly:t,t))+"' >"+s(n(null!=t?t.defaultValue:t,t))+"</textarea> </div> </div> "},12:function(e,t,a,i,r){var l,n=e.lambda,s=e.escapeExpression,o=null!=t?t:{};return' <div class="tabDivCreate" id=\''+s(n(null!=t?t.fieldDiv:t,t))+"'> <div class=\"labelTabCreate pL5 pR "+(null!=(l=a.if_eq.call(o,null!=t?t.mandate:t,"true",{name:"if_eq",hash:{},fn:e.program(2,r,0),inverse:e.noop,data:r}))?l:"")+"\" id='"+s(n(null!=t?t.valueLabel:t,t))+"_label'>"+s(n(null!=t?t.displaylabel:t,t))+'</div><div class="labelValCreate mL45"> <input data-fieldType="dateField" data-showExecution=\''+s(n(null!=t?t.showexecution:t,t))+"' placeholder='"+s(n(null!=t?t.datePattern:t,t))+"' data-datePattern='"+s(n(null!=t?t.datePattern:t,t))+"' onblur='"+s(n(null!=t?t.blurfn:t,t))+'\' type="text" '+(null!=(l=a.if_nq.call(o,null!=t?t.readOnly:t,"true",{name:"if_nq",hash:{},fn:e.program(4,r,0),inverse:e.noop,data:r}))?l:"")+' class="textField" data-i18fieldtype=\''+s(n(null!=t?t.i18fieldType:t,t))+"' style=\"width:100%\" id='"+s(n(null!=t?t.labelId:t,t))+"'  maxlength=\"100\" data-zcqa='"+s(n(null!=t?t.labelId:t,t))+"' data-contenttype='"+s(n(null!=t?t.contentType:t,t))+"' data-mandate='"+s(n(null!=t?t.mandate:t,t))+"' data-displaylabel='"+s(n(null!=t?t.displaylabel:t,t))+"' data-readonly='"+s(n(null!=t?t.readOnly:t,t))+"' "+(null!=(l=a.if_eq.call(o,null!=t?t.readOnly:t,"true",{name:"if_eq",hash:{},fn:e.program(13,r,0),inverse:e.noop,data:r}))?l:"")+" value='"+s(n(null!=t?t.defaultValue:t,t))+"'> </div> </div> "},13:function(e,t,a,i,r){return" readonly "},15:function(e,t,a,i,r){var l,n=e.lambda,s=e.escapeExpression,o=null!=t?t:{};return' <div class="tabDivCreate" id=\''+s(n(null!=t?t.fieldDiv:t,t))+"'> <div class=\"labelTabCreate pL5 pR "+(null!=(l=a.if_eq.call(o,null!=t?t.mandate:t,"true",{name:"if_eq",hash:{},fn:e.program(2,r,0),inverse:e.noop,data:r}))?l:"")+"\" id='"+s(n(null!=t?t.valueLabel:t,t))+"_label'>"+s(n(null!=t?t.displaylabel:t,t))+'</div><div class="labelValCreate mL45"> <input type="text" data-fieldType="dateField" data-showExecution=\''+s(n(null!=t?t.showexecution:t,t))+"' data-contenttype='"+s(n(null!=t?t.contentType:t,t))+"' data-mandate='"+s(n(null!=t?t.mandate:t,t))+"' onblur='"+s(n(null!=t?t.blurfn:t,t))+"' placeholder='"+s(n(null!=t?t.datePattern:t,t))+"'  data-displaylabel='"+s(n(null!=t?t.displaylabel:t,t))+"' data-i18fieldtype='"+s(n(null!=t?t.i18fieldType:t,t))+"' data-datePattern='"+s(n(null!=t?t.datePattern:t,t))+'\' type="text" '+(null!=(l=a.if_nq.call(o,null!=t?t.readOnly:t,"true",{name:"if_nq",hash:{},fn:e.program(4,r,0),inverse:e.noop,data:r}))?l:"")+' class="textField"  id="'+s(n(null!=t?t.labelId:t,t))+'"  maxlength="100" data-zcqa=\''+s(n(null!=t?t.labelId:t,t))+"' data-readonly='"+s(n(null!=t?t.readOnly:t,t))+"' value='"+s(n(null!=t?t.defaultValue:t,t))+'\'> <input type="text" data-fieldType="timeField" type="text" '+(null!=(l=a.if_nq.call(o,null!=t?t.readOnly:t,"true",{name:"if_nq",hash:{},fn:e.program(16,r,0),inverse:e.noop,data:r}))?l:"")+" placeholder='"+s(n(null!=t?t.timePattern:t,t))+"'class=\"textField "+(null!=(l=a.if.call(o,null!=t?t.addClass:t,{name:"if",hash:{},fn:e.program(18,r,0),inverse:e.noop,data:r}))?l:"")+'"  id="'+s(n(null!=t?t.labelId:t,t))+'_TimeOption"  maxlength="100" data-zcqa=\''+s(n(null!=t?t.labelId:t,t))+"' data-contenttype='"+s(n(null!=t?t.contentType:t,t))+"' data-displaylabel='"+s(n(null!=t?t.displaylabel:t,t))+"' data-mandate='"+s(n(null!=t?t.mandate:t,t))+"' data-readonly='"+s(n(null!=t?t.readOnly:t,t))+"' readonly='"+s(n(null!=t?t.readOnly:t,t))+"' value='"+s(n(null!=t?t.timevalue:t,t))+"'> </div> </div> "},16:function(e,t,a,i,r){return" "},18:function(e,t,a,i,r){return e.escapeExpression(e.lambda(null!=t?t.addClass:t,t))},20:function(e,t,a,i,r){var l,n=e.lambda,s=e.escapeExpression,o=null!=t?t:{};return' <div class="tabDivCreate" id=\''+s(n(null!=t?t.fieldDiv:t,t))+"'> <div class=\"labelTabCreate pL5 pR "+(null!=(l=a.if_eq.call(o,null!=t?t.mandate:t,"true",{name:"if_eq",hash:{},fn:e.program(2,r,0),inverse:e.noop,data:r}))?l:"")+"\" id='"+s(n(null!=t?t.valueLabel:t,t))+"_label'>"+s(n(null!=t?t.displaylabel:t,t))+'</div><div class="labelValCreate mL45"> <input type="checkbox" id=\''+s(n(null!=t?t.labelId:t,t))+"' data-zcqa='"+s(n(null!=t?t.labelId:t,t))+"' data-contenttype='"+s(n(null!=t?t.contentType:t,t))+"' data-displaylabel='"+s(n(null!=t?t.displaylabel:t,t))+"' data-mandate='"+s(n(null!=t?t.mandate:t,t))+"' data-i18fieldtype='"+s(n(null!=t?t.i18fieldType:t,t))+"' data-readonly='"+s(n(null!=t?t.readOnly:t,t))+"' "+(null!=(l=a.if_eq.call(o,null!=t?t.readOnly:t,"true",{name:"if_eq",hash:{},fn:e.program(13,r,0),inverse:e.noop,data:r}))?l:"")+" "+(null!=(l=a.if_eq.call(o,null!=t?t.defaultValue:t,"true",{name:"if_eq",hash:{},fn:e.program(21,r,0),inverse:e.noop,data:r}))?l:"")+"> <span></span> </div> </div> "},21:function(e,t,a,i,r){return" checked "},23:function(e,t,a,i,r){var l,n=e.lambda,s=e.escapeExpression,o=null!=t?t:{};return' <div class="tabDivCreate" id=\''+s(n(null!=t?t.fieldDiv:t,t))+"'> <div class=\"labelTabCreate pL5 pR "+(null!=(l=a.if_eq.call(o,null!=t?t.mandate:t,"true",{name:"if_eq",hash:{},fn:e.program(2,r,0),inverse:e.noop,data:r}))?l:"")+'" id="'+s(n(null!=t?t.valueLabel:t,t))+'_label">'+s(n(null!=t?t.displaylabel:t,t))+'</div><div class="labelValCreate mL45"> <select type="text" '+(null!=(l=a.if_nq.call(o,null!=t?t.readOnly:t,"true",{name:"if_nq",hash:{},fn:e.program(4,r,0),inverse:e.noop,data:r}))?l:"")+' onclick="'+s(n(null!=t?t.onclick:t,t))+'" class="select" width="100%" onchange=\''+s(n(null!=t?t.onchange:t,t))+"'  id='"+s(n(null!=t?t.labelId:t,t))+"' data-maxlength='"+s(n(null!=t?t.maxlength:t,t))+"'  data-decimalLength='"+s(n(null!=t?t.decimalLength:t,t))+"' data-zcqa='"+s(n(null!=t?t.labelId:t,t))+"' data-contenttype='"+s(n(null!=t?t.contentType:t,t))+"' data-displaylabel='"+s(n(null!=t?t.displaylabel:t,t))+"' data-i18fieldtype='"+s(n(null!=t?t.i18fieldType:t,t))+"' data-mandate='"+s(n(null!=t?t.mandate:t,t))+"' data-readonly='"+s(n(null!=t?t.readOnly:t,t))+"' onblur='"+s(n(null!=t?t.blurfn:t,t))+"' value='"+s(n(null!=t?t.defaultValue:t,t))+"'> "+(null!=(l=a.each.call(o,null!=t?t.selectDetails:t,{name:"each",hash:{},fn:e.program(24,r,0),inverse:e.noop,data:r}))?l:"")+" </select> </div> </div> "},24:function(e,t,a,i,r){var l=e.lambda,n=e.escapeExpression;return" <option value='"+n(l(null!=t?t.selectValue:t,t))+"'>"+n(l(null!=t?t.selectOption:t,t))+"</option> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l,n=null!=t?t:{};return(null!=(l=a.if_eq.call(n,null!=t?t.type:t,"text",{name:"if_eq",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?l:"")+" "+(null!=(l=a.if_eq.call(n,null!=t?t.type:t,"currency",{name:"if_eq",hash:{},fn:e.program(8,r,0),inverse:e.noop,data:r}))?l:"")+" "+(null!=(l=a.if_eq.call(n,null!=t?t.type:t,"textarea",{name:"if_eq",hash:{},fn:e.program(10,r,0),inverse:e.noop,data:r}))?l:"")+" "+(null!=(l=a.if_eq.call(n,null!=t?t.type:t,"date",{name:"if_eq",hash:{},fn:e.program(12,r,0),inverse:e.noop,data:r}))?l:"")+" "+(null!=(l=a.if_eq.call(n,null!=t?t.type:t,"datetime",{name:"if_eq",hash:{},fn:e.program(15,r,0),inverse:e.noop,data:r}))?l:"")+" "+(null!=(l=a.if_eq.call(n,null!=t?t.type:t,"checkbox",{name:"if_eq",hash:{},fn:e.program(20,r,0),inverse:e.noop,data:r}))?l:"")+" "+(null!=(l=a.if_eq.call(n,null!=t?t.type:t,"select",{name:"if_eq",hash:{},fn:e.program(23,r,0),inverse:e.noop,data:r}))?l:"")+' <div class="clearB"></div> '},useData:!0}),t.crmSetUpInnerHeader=e({1:function(e,t,a,i,r){var l=e.escapeExpression;return' <div class="fR" style="margin-top:3px;">  <a data-zcqa="lnk_wf_help" class="fL f13 crm-font-regular color_9 mL5" id="context-helplink" style="margin-top:1px;" onClick="openHelp(\''+l(e.lambda(null!=t?t.helpURL:t,t))+'\')" href="javascript:void(0);">'+l(a.getI18n.call(null!=t?t:{},"crm.label.context.help",{name:"getI18n",hash:{},data:r}))+'</a> </div> <div class="cB"></div> '},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l,n=null!=t?t:{},s=e.escapeExpression;return' <div class="setup-space"> <div class="posrel"> <h2 class="fL darkMainHead">'+s(a.getI18n.call(n,null!=t?t.title:t,{name:"getI18n",hash:{},data:r}))+"</h2> "+(null!=(l=a.ifCond.call(n,null!=t?t.helpURL:t,"!=","",{name:"ifCond",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?l:"")+' </div> <p class="content mB30 w70per">'+s(a.getI18n.call(n,null!=t?t.description:t,{name:"getI18n",hash:{},data:r}))+"</p> "},useData:!0}),t.dataRequestLink=e({compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l,n=null!=t?t:{},s=e.escapeExpression;return'<div class="mt10 mB30 zclnktab" id="ze_DataRequesttab" style=\'display:none;\'> <div class="textFld noBdr edtDataRequestLink" id="edtDataRequestLink"> <div class="labelTabCreate newmandatory pL5 pR fL">'+s(a.getI18n.call(n,"crm.datarequest.type",{name:"getI18n",hash:{},data:r}))+'</div> <div class="labelValCreate fL" id="DataRequestSelectValDiv" style="min-height: 45px;"> '+(null!=(l=e.invokePartial(i.DataRequestLinkTypes,null!=t?t.types:t,{name:"DataRequestLinkTypes",data:r,helpers:a,partials:i,decorators:e.decorators}))?l:"")+' </div> <div class="clearB"></div> </div> <div class="textFld tabDivCreate newmandatory" id="edtDataRequestLanguage"> <div class="labelTabCreate pL5 pR fL">'+s(a.getI18n.call(n,"crm.label.language",{name:"getI18n",hash:{},data:r}))+'</div> <div class="labelValCreate fL cP" id="DataRequestLanguageSelectValDiv" onclick="inSplnk.fnLanguageList(\''+s(a.encodeJS.call(n,null!=t?t.editorName:t,{name:"encodeJS",hash:{},data:r}))+'\', event,\'DataRequestLanguageSelectValDiv\');"> <span class="dIB pR pR25" id="DataRequestLanguageSelectVal" value="">'+s(a.getI18n.call(n,"crm.select",{name:"getI18n",hash:{},data:r}))+'</span> </div> <span class="errMsg" id="errorMsgDataRequestLink" style="display: none;">'+s(a.getI18n.call(n,"crm.datarequest.lang.select.alert",{name:"getI18n",hash:{},data:r}))+'</span> <div class="clearB"></div> </div> </div> '},usePartial:!0,useData:!0}),t.kpi=e({compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l=e.lambda,n=e.escapeExpression,s=null!=t?t:{};return'<div class="dashboardContent dash_kpi dIB w100p" id="dashboardContent1"> <div class="fL divSmallbox"> \x3c!--div class="color_2 fL headText crm-font-bold  w100p alignleft">'+n(l(null!=t?t.chartTitle:t,t))+'</div--\x3e <div class="fL w100p"> <div class="fL w100p"> <span class="fs kpi_amount fL">'+n(a.getkpiData.call(s,t,0,{name:"getkpiData",hash:{},data:r}))+'</span> <span class="fL pR mL10 '+n(l(null!=t?t.imgClass:t,t))+'"></span> <span class="mL3 '+n(l(null!=t?t.className:t,t))+' crm-font-regular">'+n(l(null!=t?t.percent:t,t))+'</span> </div> <div class="cB  fL  crm-font-regular alignleft w100p kpi_Last mT10">'+n(l(null!=t?t.comparingRange:t,t))+" "+n(a.getkpiData.call(s,t,1,{name:"getkpiData",hash:{},data:r}))+"</div> </div> </div> </div>"},useData:!0}),t.kpiDateColTemplate=e({1:function(e,t,a,i,r){var l;return" "+(null!=(l=a.each.call(null!=t?t:{},t,{name:"each",hash:{},fn:e.program(2,r,0),inverse:e.noop,data:r}))?l:"")+" "},2:function(e,t,a,i,r){var l,n=null!=t?t:{};return" <optgroup label='"+e.escapeExpression(a.getModuleLabel.call(n,r&&r.key,{name:"getModuleLabel",hash:{},data:r}))+"' style='border:none'> "+(null!=(l=a.each.call(n,t,{name:"each",hash:{},fn:e.program(3,r,0),inverse:e.noop,data:r}))?l:"")+" </optgroup> "},3:function(e,t,a,i,r){var l=e.lambda,n=e.escapeExpression;return" <option value='"+n(l(null!=t?t.table_name:t,t))+":"+n(l(null!=t?t.column_name:t,t))+":"+n(l(null!=t?t.actual_label:t,t))+"'>"+n(l(null!=t?t.field_label:t,t))+"</option> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l;return null!=(l=a.each.call(null!=t?t:{},t,{name:"each",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?l:""},useData:!0}),t.kpiFieldsTemplate=e({1:function(e,t,a,i,r){return' <option value=""> '+e.escapeExpression(a.getI18n.call(null!=t?t:{},"crm.macro.label.chooseDate",{name:"getI18n",hash:{},data:r}))+" </option> "},3:function(e,t,a,i,r,l,n){var s;return" "+(null!=(s=a.each.call(null!=t?t:{},t,{name:"each",hash:{},fn:e.program(4,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "},4:function(e,t,a,i,r,l,n){var s;return" "+(null!=(s=a.each.call(null!=t?t:{},t,{name:"each",hash:{},fn:e.program(5,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "},5:function(e,t,a,i,r,l,n){var s;return" "+(null!=(s=a.ifNotEquals.call(null!=t?t:{},null!=t?t.column_name:t,"LATITUDE",{name:"ifNotEquals",hash:{},fn:e.program(6,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "},6:function(e,t,a,i,r,l,n){var s;return" "+(null!=(s=a.checkColType.call(null!=t?t:{},t,null!=n[3]?n[3].dataType:n[3],{name:"checkColType",hash:{},fn:e.program(7,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "},7:function(e,t,a,i,r){var l=e.lambda,n=e.escapeExpression;return' <option value="'+n(l(null!=t?t.table_name:t,t))+":"+n(l(null!=t?t.column_name:t,t))+":"+n(l(null!=t?t.actual_label:t,t))+'">'+n(l(null!=t?t.field_label:t,t))+"</option> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r,l,n){var s,o=null!=t?t:{};return(null!=(s=a.ifEquals.call(o,null!=t?t.dataType:t,"date",{name:"ifEquals",hash:{},fn:e.program(1,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "+(null!=(s=a.each.call(o,null!=t?t.fields:t,{name:"each",hash:{},fn:e.program(3,r,0,l,n),inverse:e.noop,data:r}))?s:"")},useData:!0,useDepths:!0}),t.logoutSurvey=e({compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l,n=e.lambda,s=e.escapeExpression,o=null!=t?t:{};return'<div id="surveyPopup" onclick="sE(event)" class="zcrm-surveyModal"> <div class="zcrm-content"> <form id="surveyForm" action="'+s(n(null!=t?t.url:t,t))+'"> <div class="popup-model-content pR" style="max-height:700px;padding:35px;min-width:700px;transition: 0.3s all;"> <span id="later" class="cP pA" style="color:#007eff;top:20px;right:25px;">'+s(n(null!=t?t.message:t,t))+'</span> <div class="f22">'+s(a.getI18n.call(o,"crm.logout.survey.hiuser",null!=t?t.name:t,{name:"getI18n",hash:{},data:r}))+'</div> <div class="f17 mT15" style="line-height: 26px;">'+s(a.getI18n.call(o,"crm.logout.survey.question.new",null!=(l=null!=t?t.Crm:t)?l.appName:l,{name:"getI18n",hash:{},data:r}))+'</div> <div class="mT5"> <span class="f12 dIB" style="color:#999;">'+s(a.getI18n.call(o,"crm.logout.survey.notlikely",{name:"getI18n",hash:{},data:r}))+'</span> <ul id="sf_Rating" class="dIB" style="margin-left: 0px;"> <li>0</li> <li>1</li> <li>2</li> <li>3</li> <li>4</li> <li>5</li> <li>6</li> <li>7</li> <li>8</li> <li>9</li> <li>10</li> </ul> <span class="mL5 f12 dIB" style="color:#999;">'+s(a.getI18n.call(o,"crm.logout.survey.likely",{name:"getI18n",hash:{},data:r}))+'</span> </div> <div id="bad" class="mT20 dN" > <div class="f17 mT20">'+s(a.getI18n.call(o,"crm.logout.survey.bad.message2",{name:"getI18n",hash:{},data:r}))+'</div> </div> <div id="ok" class="mT20 dN" > <div class="f17 mT20">'+s(a.getI18n.call(o,"crm.logout.survey.ok.message2",{name:"getI18n",hash:{},data:r}))+'</div> </div> <div id="good" class="mT20 dN"> <div class="f17 mT20">'+s(a.getI18n.call(o,"crm.logout.survey.good.message2",{name:"getI18n",hash:{},data:r}))+'</div> </div> <div id="great" class="mT20 dN" > <div class="f17 mT20">'+s(a.getI18n.call(o,"crm.logout.survey.great.message2",{name:"getI18n",hash:{},data:r}))+'</div> </div> <div id="perfect" class="mT20 dN" > <div class="f17 mT20">'+s(a.getI18n.call(o,"crm.logout.survey.perfect.message2.new",null!=(l=null!=t?t.Crm:t)?l.appName:l,{name:"getI18n",hash:{},data:r}))+'</div> </div> <div id="commentdiv" class="sf_textFieldDiv mT10 dN"> <textarea id="comments" name="comments" class="sf_textField" style="height:25px" onfocus="$(\'.sf_textFieldDiv\').addClass(\'sf_textFieldDivFocus\')" onblur="$(\'.sf_textFieldDiv\').removeClass(\'sf_textFieldDivFocus\')" onkeyup="$(this).css(\'height\',\'25px\').css(\'height\', this.scrollHeight);"></textarea> </div> <div id="buttons" class="mT25 dN"> <input class="primarybtn" type="submit" value="'+s(a.getI18n.call(o,"crm.button.submit",{name:"getI18n",hash:{},data:r}))+'"> </div> <div id="bad_message" class="f22 mL30 pR dN aligncenter"><span class="sf_sorry_bg mR5"></span>'+s(a.getI18n.call(o,"crm.logout.survey.bad.message1",{name:"getI18n",hash:{},data:r}))+'</div> <div id="good_message" class="f22 mL30 pR dN aligncenter"><span class="sf_thanks_bg mR5"></span>'+s(a.getI18n.call(o,"crm.logout.survey.good.message1",{name:"getI18n",hash:{},data:r}))+'</div> <div id="perfect_message" class="f22 mL30 pR dN aligncenter"><span class="sf_thanksMadeOurDay_bg mR5"></span>'+s(a.getI18n.call(o,"crm.logout.survey.perfect.message1",{name:"getI18n",hash:{},data:r}))+'</div> <input type="hidden" id="score" name="score"></input> <input type="hidden" id="actionName" name="actionName"></input> </div> </form> </div> </div> '},useData:!0}),t.picklistReplaceCompletedNotification=e({1:function(e,t,a,i,r){var l,n=null!=t?t:{},s=e.escapeExpression,o=e.lambda;return' <div class="schedularMsg"> <p class="pB5 pL10 succesIcoSchedular pR">'+(null!=(l=a.getI18n.call(n,"crm.picklist.notification.success.msg",a.encodeHTML.call(n,null!=(l=null!=t?t.pickListDetails:t)?l.fromValueStr:l,{name:"encodeHTML",hash:{},data:r}),a.encodeHTML.call(n,null!=(l=null!=t?t.pickListDetails:t)?l.toValueStr:l,{name:"encodeHTML",hash:{},data:r}),{name:"getI18n",hash:{},data:r}))?l:"")+'</p> <a href="#" class="f13 mL2 pL10 uline1 viewInfoTbl" onclick="crmExportWMSMsg.showPicklistinfo(this);">'+s(a.getI18n.call(n,"crm.picklist.notification.info",{name:"getI18n",hash:{},data:r}))+'</a> <div class=" f13 viewInfoData" style="display: none;"> <span class="color_9 pB5 dIB">'+s(a.getI18n.call(n,"crm.picklist.notification.table.title",{name:"getI18n",hash:{},data:r}))+'</span> <table width="70%"> <tbody> <tr> <td class="pR"><span class="updatesListTTl">'+s(a.getI18n.call(n,"crm.picklist.notification.col.records",{name:"getI18n",hash:{},data:r}))+"</span></td> <td>"+s(o(null!=(l=null!=(l=null!=t?t.pickListDetails:t)?l.count_details:l)?l.records:l,t))+'</td> </tr> <tr> <td class="pR"><span class="updatesListTTl">'+s(a.getI18n.call(n,"crm.picklist.notification.col.criteria",{name:"getI18n",hash:{},data:r}))+"</span></td> <td>"+s(o(null!=(l=null!=(l=null!=t?t.pickListDetails:t)?l.count_details:l)?l.criteria:l,t))+'</td> </tr> <tr> <td class="pR"><span class="updatesListTTl">'+s(a.getI18n.call(n,"crm.picklist.notification.col.dependency",{name:"getI18n",hash:{},data:r}))+"</span></td> <td>"+s(o(null!=(l=null!=(l=null!=t?t.pickListDetails:t)?l.count_details:l)?l.workflow:l,t))+'</td> </tr> <tr> <td class="pR"><span class="updatesListTTl">'+s(a.getI18n.call(n,"crm.picklist.notification.col.workflow",{name:"getI18n",hash:{},data:r}))+"</span></td> <td>"+s(o(null!=(l=null!=(l=null!=t?t.pickListDetails:t)?l.count_details:l)?l.fielddep:l,t))+"</td> </tr> </tbody> </table> </div> </div> "},3:function(e,t,a,i,r){var l,n=null!=t?t:{};return' <div class="schedularMsg"> <p class="pB5 pL10 failedIcoSchedular pR">'+(null!=(l=a.getI18n.call(n,"crm.picklist.notification.error.msg",a.encodeHTML.call(n,null!=(l=null!=t?t.pickListDetails:t)?l.fromValueStr:l,{name:"encodeHTML",hash:{},data:r}),a.encodeHTML.call(n,null!=(l=null!=t?t.pickListDetails:t)?l.toValueStr:l,{name:"encodeHTML",hash:{},data:r}),{name:"getI18n",hash:{},data:r}))?l:"")+"</p> </div> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l;return" "+(null!=(l=a.if_eq.call(null!=t?t:{},null!=t?t.status:t,5,{name:"if_eq",hash:{},fn:e.program(1,r,0),inverse:e.program(3,r,0),data:r}))?l:"")},useData:!0}),t.picklistReplacePopup=e({compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l=null!=t?t:{},n=e.escapeExpression;return'<div id="popup-modifi" class="newPopup is-scroll showPpTop" style="min-width:410px;width:410px;z-index: 110!important;top: 162px!important;"> <div class="pp-content pB0 bbdd"> <div id="opnAct" class="w100per"> <div class="w100per"> <span class="f21 replaceHdrPickList">'+n(a.getI18n.call(l,"crm.picklist.replace",{name:"getI18n",hash:{},data:r}))+'</span> </div> <span class="f14 col222 mT25 dIB w100per">'+n(a.getI18n.call(l,"crm.picklist.replace.from",{name:"getI18n",hash:{},data:r}))+'</span> <input id="replaceIn" disabled class="noAbs textField inpPick p5 color_7 f14 mT10 pT8 pB8 cD" name="options" maxlength="235" value="Option 1" data-oldval="Option 1" type="text"> <span class="f14 col222 mT20 dIB w100per">'+n(a.getI18n.call(l,"crm.picklist.replace.to",{name:"getI18n",hash:{},data:r}))+'</span> <div class="newSelect mT10"> <select id="picOption"> </select> </div> <div class="w100per mT30"> <input type="button" class="primarybtn mB20" value="'+n(a.getI18n.call(l,"crm.picklist.replace",{name:"getI18n",hash:{},data:r}))+'" onClick="CMB.replaceClick();$(\'#FreezeLayer\').css({\'z-index\': \'\'});"> <input type="button" class="newgraybtn" value="'+n(a.getI18n.call(l,"crm.button.cancel",{name:"getI18n",hash:{},data:r}))+"\" onclick=\"$('#popup-modifi').remove();$('#FreezeLayer').css({'z-index': ''});\"> </div> </div> </div> <div class=\"pp-footer alignleft\"> <span class=\"f12 w100per dIB color_9 cD\"> "+n(a.getI18n.call(l,"crm.picklist.replace.info1",{name:"getI18n",hash:{},data:r}))+' <span class="mL6">'+n(a.getI18n.call(l,"crm.picklist.replace.info2",{name:"getI18n",hash:{},data:r}))+'</span> </span> <span class="f12 dIB mT10 color_9 cD"> '+n(a.getI18n.call(l,"crm.picklist.replace.info3",{name:"getI18n",hash:{},data:r}))+' </span> <span class="f12 dIB mT10 color_9 cD"> - '+n(a.getI18n.call(l,"crm.picklist.replace.info5",{name:"getI18n",hash:{},data:r}))+" </span> </div> </div>"},useData:!0}),t.picklistTableDiv=e({1:function(e,t,a,i,r){var l=e.lambda,n=e.escapeExpression;return' <th class="alignleft">'+n(l(null!=t?t[0]:t,t))+'</th> <th class="alignright">'+n(l(null!=t?t[1]:t,t))+"</th> <th></th> "},3:function(e,t,a,i,r,l){var n,s=e.lambda,o=e.escapeExpression;return' <tr> <td> <span class="picklistDragIcon vam dIB"></span> </td> <td class="pL0"> <input type="text" value="'+o(s(null!=(n=l[0][0])?n.value:n,t))+'" readonly="readonly" class="f12 optionName"></input> </td> <td class="alignright"> <input type="text" maxlength=\'3\' onkeyup=\'CMB.validateSetAllowedTime(this);CrmModule.enableSaveButton(this)\' onkeypress=\'return event.charCode >= 48 && event.charCode <= 57\' id="'+o(s(null!=(n=l[0][0])?n.uniqueid:n,t))+'" value="'+o(s(null!=(n=l[0][0])?n.allowedTime:n,t))+'" class="f12 allowedTimeInput daysCount w40 alignright" /> </td> <td> <span class="picklistAddIcon vam dIB"></span> </td> </tr> '},5:function(e,t,a,i,r){return' <tr> <td colspan="4" class="aligncenter"> <a href="javascript:;" id="otherLayoutValues" class="dB p5 fontsmooth" onclick="CMB.showOtherLayoutOptions();"><span class="downArrowBlue dIB vam"></span></a> </td> </tr> '},7:function(e,t,a,i,r){var l;return' <div class=\'otherLayoutCtn\' id=\'otherLayoutCtn\' style=\'display: none;\'> <table cellpadding="0" cellspacing="0" class="picklistAllowedTimeTabl f11 w100per" id="otherLayoutPicklistTable"> <tbody> '+(null!=(l=a.each.call(null!=t?t:{},null!=t?t.otherLayoutOptions:t,{name:"each",hash:{},fn:e.program(8,r,1),inverse:e.noop,data:r}))?l:"")+" </tbody> </table> </div> "},8:function(e,t,a,i,r){var l=e.lambda,n=e.escapeExpression;return' <tr> <td> <span class="picklistDragIcon vam dIB"></span> </td> <td class="pL0"> <input type="text" value="'+n(l(null!=t?t.value:t,t))+'" readonly="readonly" class="f12 optionName"></input> </td> <td class="alignright"> <input type="text" maxlength=\'3\' onkeyup=\'CMB.validateSetAllowedTime(this);CrmModule.enableSaveButton(this)\' onkeypress=\'return event.charCode >= 48 && event.charCode <= 57\' id="'+n(l(null!=t?t.uniqueId:t,t))+'" value="'+n(l(null!=t?t.allowedTime:t,t))+'" class="f12 allowedTimeInput daysCount w40 alignright" /> </td> <td> <span class="picklistAddIcon vam dIB"></span> </td> </tr> '},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r,l){var n,s=null!=t?t:{};return' <div id="picklistTableDiv" class="picklistAllTimeTablWrap mT10"> <table cellpadding="0" cellspacing="0" class="picklistAllowedTimeTabl f11" id="picklistTableHeadings"> <thead> <tr class="crm-font-bold"> <th></th> '+(null!=(n=a.with.call(s,null!=t?t.heading:t,{name:"with",hash:{},fn:e.program(1,r,0,l),inverse:e.noop,data:r,blockParams:l}))?n:"")+' </tr> </thead> </table> <div class="picklistAllowedTimeScrl"> <table cellpadding="0" cellspacing="0" class="picklistAllowedTimeTabl f11" id="currLayoutPicklistTable"> <tbody> '+(null!=(n=a.each.call(s,null!=t?t.currLayoutOptions:t,{name:"each",hash:{},fn:e.program(3,r,1,l),inverse:e.noop,data:r,blockParams:l}))?n:"")+" "+(null!=(n=a.ifNotEquals.call(s,null!=(n=null!=t?t.otherLayoutOptions:t)?n.length:n,0,{name:"ifNotEquals",hash:{},fn:e.program(5,r,0,l),inverse:e.noop,data:r,blockParams:l}))?n:"")+" </tbody> </table> </div> "+(null!=(n=a.ifNotEquals.call(s,null!=(n=null!=t?t.otherLayoutOptions:t)?n.length:n,0,{name:"ifNotEquals",hash:{},fn:e.program(7,r,0,l),inverse:e.noop,data:r,blockParams:l}))?n:"")+' </div> <div class="red f11" id="picklistErr" style="visibility: hidden;"></div>'},useData:!0,useBlockParams:!0}),t.populateSampleData=e({compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l=null!=t?t:{},n=e.escapeExpression;return'<input type="hidden" id="userType" value="myself"> <div class="pp-content" style="max-height:initial !important; max-width:500px; margin:0 auto;"> <span class="popClsoseIcon ico-close-small2 dIB svgIconsImg pA cP I10z" onclick="crmui.hidePopup(\'cobdiv\');Crm.trackSpotLightAction(\'Customer OnBoarding - Add Sample Data Close Button Clicked\');"></span> <p class="crm-font-regular f18 color_1 mB10 aligncenter pT10">'+n(a.getI18n.call(l,"cob.add.sampeldata.towhom",{name:"getI18n",hash:{},data:r}))+'</p> <div class="mT20 aligncenter pT15" style="margin:0 50px;"> <div class="dIB p15 pL20 pR20 pB10 selectHighLight cP selectDefault pR" id="ownUser" onclick="selectUser(\'myself\',this);"> <span class="onboardSprite onboarUserIcon dIB"></span> <p class="f15 crm-font-bold color_1 pT10">'+n(a.getI18n.call(l,"cob.myself",{name:"getI18n",hash:{},data:r}))+'</p> </div> <div class="dIB p10 vat mT30 mL10"> <p class="crm-font-regular f14 color_1">'+n(a.getI18n.call(l,"crm.label.lowercase.or",{name:"getI18n",hash:{},data:r}))+'</p> </div> <div class="dIB p10 pT15 pB15 cP selectDefault pR selectDefaultMulti" id="addOtherUsers" onclick="selectUser(\'muitluser\',this);"> <span class="onboardSprite onboarMultiUserIcon dIB"></span> <p class="f15 crm-font-regular color_1 pT10" style="max-width:140px;">'+n(a.getI18n.call(l,"cob.multiple.users",{name:"getI18n",hash:{},data:r}))+'</p> </div> <div class="grayBdr pL30 pR30 w320 pT15 pB30 mT9 dN multipleUserAdd pR mT15"> <div class="bbd1 pT20" style="width:290px;" id="emaildiv_0"> <input type="text" id="email0" class="nobdr noBg emailField" style="width:100%;" placeholder="'+n(a.getI18n.call(l,"cob.enter.email",{name:"getI18n",hash:{},data:r}))+'" value="" autofocus onfocus="$(this).closest(\'div\').addClass(\'focusBdr\')" onblur="$(\'.emailField\').closest(\'div\').removeClass(\'focusBdr\')"> </div> <div class="bbd1 pT20 pR" style="width:290px;" id="emaildiv_1"> <input type="text" id="email1" class="nobdr noBg emailField" style="width:100%;" placeholder="'+n(a.getI18n.call(l,"cob.enter.email",{name:"getI18n",hash:{},data:r}))+'" value="" onfocus="$(this).closest(\'div\').addClass(\'focusBdr\')" onblur="$(\'.emailField\').closest(\'div\').removeClass(\'focusBdr\')"> <span class="svgIconsImg greenPlusIcon dIB pA cP" id="span_1" onclick="$(\'#emaildiv_2\').show();$(\'#span_1\').hide();$(\'.emailDiv\').removeClass(\'focusBdr\');$(\'#emaildiv_2\').addClass(\'focusBdr\'); "></span> </div> <div class="bbd1 pT20 pR dN emailDiv" style="width:290px;" id="emaildiv_2" > <input type="text" id="email2" class="nobdr noBg emailField" style="width:100%;" placeholder="'+n(a.getI18n.call(l,"cob.enter.email",{name:"getI18n",hash:{},data:r}))+'" value="" onfocus="$(this).closest(\'div\').addClass(\'focusBdr\')" onblur="$(\'.emailField\').closest(\'div\').removeClass(\'focusBdr\')"> <span class="svgIconsImg greenPlusIcon dIB pA cP" id="span_2" onclick="$(\'#emaildiv_3\').show();$(\'#span_2\').hide();$(\'.emailDiv\').removeClass(\'focusBdr\');$(\'#emaildiv_3\').addClass(\'focusBdr\'); "></span> </div> <div class="bbd1 pT20 pR dN emailDiv" style="width:290px;" id="emaildiv_3" > <input type="text" class="nobdr noBg emailField" id="email3" style="width:100%;" placeholder="'+n(a.getI18n.call(l,"cob.enter.email",{name:"getI18n",hash:{},data:r}))+'" value="" onfocus="$(this).closest(\'div\').addClass(\'focusBdr\')" onblur="$(\'.emailField\').closest(\'div\').removeClass(\'focusBdr\')"> <span class="svgIconsImg greenPlusIcon dIB pA cP" id="span_3" onclick="$(\'#emaildiv_4\').show();$(\'#span_3\').hide();$(\'.emailDiv\').removeClass(\'focusBdr\');$(\'#emaildiv_4\').addClass(\'focusBdr\'); "></span> </div> <div class="bbd1 pT20 pR dN emailDiv" style="width:290px;" id="emaildiv_4"> <input type="text" class="nobdr noBg emailField" id="email4" style="width:100%;" placeholder="'+n(a.getI18n.call(l,"cob.enter.email",{name:"getI18n",hash:{},data:r}))+'" value="" onfocus="$(this).closest(\'div\').addClass(\'focusBdr\')" onblur="$(\'.emailField\').closest(\'div\').removeClass(\'focusBdr\')"> </div> </div> </div> <div> </div> <div class="aligncenter mT25"> <input type="submit" class="primarybtn" value="'+n(a.getI18n.call(l,"cob.add.sampledata",{name:"getI18n",hash:{},data:r}))+'" onclick="gS.scheduleDataPopulation();"> </div> </div> '},useData:!0}),t.premiumSupportEmail=e({compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l=null!=t?t:{},n=e.escapeExpression;return'<div id="feedBackForm" class="feedBackPopup pA bot30 r0 zi30 whiteBg boxShadowMask w450 fR"> <div class="p20 pB10"> <div class="pR "> <span class="crm-font-bold f16">Premium Support</span> <span id="ps_emailclose" class="svgIcons t0 r0 ico-close-small2 cP op08 pA" onclick="PremiumChat.closeMailPop()"></span> </div> <div class="color_3 pT20">'+n(a.getI18n.call(l,"crm.label.subject",{name:"getI18n",hash:{},data:r}))+'</div> <input id="ps_subject" type="text" name="subject" class="mT5 textField w100per borderbox" placeholder="'+n(a.getI18n.call(l,"crm.label.type.your.subject",{name:"getI18n",hash:{},data:r}))+'"> <div class="color_3 pT20">'+n(a.getI18n.call(l,"crm.label.summary",{name:"getI18n",hash:{},data:r}))+'</div> <textarea id="ps_summary" name="summary" class=" w100p p5 f14 oA lineHgt20 mT5 h150 borderbox" placeholder="'+n(a.getI18n.call(l,"crm.label.type.your.summary",{name:"getI18n",hash:{},data:r}))+'"></textarea> <div class="cB"></div> <div id="attachMoreFiles"></div> <div></div> </div> <div class="clearfix p20 mT40" style="background:#eff2f4;"> <input  type="button" class="fL primarybtn mR0 " value="Send" onclick="PremiumChat.sendMail()"> <div class="fL mL10 "> <a id="attach_desktop" tabindex="-1" class="rellistNew attachFileNew positionRelative detailsPageAttach dIB oH vam fR" style="padding:10px 0px 0px 0px; width: auto;" href="javascript:;"> <input type="file" tabindex="-1" name="attachments" class="smFile file0" id="feedBackAttachFile" onchange="PremiumChat.addFile(this);" style="background: none;left: auto; right: 0; top: 9px; height: 15px;" multiple> <span id="fbAttachMoreFiles" class="hide zDattachment dIB"></span> <span id="fbAttachFiles" class="zDattachment vam dIB"></span> <span class="f15 color_7 vam dIB">'+n(a.getI18n.call(l,"crm.button.attach",{name:"getI18n",hash:{},data:r}))+"</span> </a> </div> </div>"},useData:!0}),t.tabularChart=e({1:function(e,t,a,i,r){var l;return" <th "+(null!=(l=a.ifEquals.call(null!=t?t:{},r&&r.index,1,{name:"ifEquals",hash:{},fn:e.program(2,r,0),inverse:e.noop,data:r}))?l:"")+">"+e.escapeExpression(e.lambda(t,t))+"</th> "},2:function(e,t,a,i,r){return'class="db_aggregateFld"'},4:function(e,t,a,i,r,l,n){var s;return" "+(null!=(s=a.each.call(null!=t?t:{},null!=t?t.data:t,{name:"each",hash:{},fn:e.program(5,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "},5:function(e,t,a,i,r,l,n){var s,o=null!=t?t:{},d=e.escapeExpression,c=e.lambda;return' <tr onclick="CrmDashboard.fetchRecordsForTable('+d(a.json.call(o,null!=n[2]?n[2].additionalInfo:n[2],{name:"json",hash:{},data:r}))+", "+d(a.json.call(o,t,{name:"json",hash:{},data:r}))+", "+d(c(r&&r.index,t))+", '"+d(c(null!=n[2]?n[2].reportId:n[2],t))+"');\"> "+(null!=(s=a.each.call(o,t,{name:"each",hash:{},fn:e.program(6,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" </tr> "},6:function(e,t,a,i,r){var l;return" <td "+(null!=(l=a.ifEquals.call(null!=t?t:{},r&&r.index,1,{name:"ifEquals",hash:{},fn:e.program(2,r,0),inverse:e.noop,data:r}))?l:"")+"> "+e.escapeExpression(e.lambda(t,t))+" </td> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r,l,n){var s,o=null!=t?t:{};return'<br><br><div style="overflow:auto;" id="tablediv"> <table width="100%" border="0" cellpadding="0" cellspacing="0" class="newtable"> <tr> '+(null!=(s=a.each.call(o,null!=t?t.categories:t,{name:"each",hash:{},fn:e.program(1,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" </tr> "+(null!=(s=a.each.call(o,null!=t?t.series:t,{name:"each",hash:{},fn:e.program(4,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" </table> </div> "},useData:!0,useDepths:!0}),t.tabularView=e({1:function(e,t,a,i,r){return' <td class="tableHead pL0"> '+e.escapeExpression(a.getI18n.call(null!=t?t:{},t,{name:"getI18n",hash:{},data:r}))+" </td> "},3:function(e,t,a,i,r,l,n){var s,o=e.lambda,d=e.escapeExpression,c=null!=t?t:{};return" <tr class= \"topband_dv_row newCvarRow\" data-zcqa='record_row' data-params='"+d(o(null!=t?t.info:t,t))+"' id='row_"+d(o(null!=t?t.rowid:t,t))+"'> "+(null!=(s=a.lessThan.call(c,null!=t?t.source:t,1,{name:"lessThan",hash:{},fn:e.program(4,r,0,l,n),inverse:e.program(6,r,0,l,n),data:r}))?s:"")+" "+(null!=(s=a.each.call(c,null!=t?t.content:t,{name:"each",hash:{},fn:e.program(12,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" </tr> "},4:function(e,t,a,i,r,l,n){var s=e.lambda,o=e.escapeExpression;return' <td class="bb" height="35"> <a href="javascript:;" class="neweditIcon dIB vmiddle mR10" data-zcqa="cvarEdit" data-params=\''+o(s(null!=t?t.cidparams:t,t))+"' onclick=\"cVar.goToCrmVarPage('edit',"+o(s(null!=t?t.cidparams:t,t))+');" id="cvarEdit" ></a> <a href="javascript:;" class="deleteIcon dIB vmiddle"  data-zcqa="cvarDelete" onclick=\''+o(s(null!=n[1]?n[1].deletefn:n[1],t))+'\' id="cvardelete"></a> </td> '},6:function(e,t,a,i,r){var l;return' <td class="bb" height="35"> '+(null!=(l=a.ifCondLogic.call(null!=t?t:{},null!=t?t.source:t,"==","10","||",null!=t?t.source:t,"==","11",{name:"ifCondLogic",hash:{},fn:e.program(7,r,0),inverse:e.program(10,r,0),data:r}))?l:"")+' <a href="javascript:;" class="deleteIcon dIB vmiddle disabled"  data-zcqa="cvarDelete" id="cvardelete"></a> </td> '},7:function(e,t,a,i,r){var l;return" "+(null!=(l=a.if_eq.call(null!=t?t:{},null!=t?t.type:t,0,{name:"if_eq",hash:{},fn:e.program(8,r,0),inverse:e.program(10,r,0),data:r}))?l:"")+" "},8:function(e,t,a,i,r){var l=e.lambda,n=e.escapeExpression;return' <a href="javascript:;" class="neweditIcon dIB vmiddle mR10" data-params=\''+n(l(null!=t?t.cidparams:t,t))+"' data-zcqa=\"cvarEdit\" onclick=\"cVar.goToCrmVarPage('edit',"+n(l(null!=t?t.cidparams:t,t))+');" id="cvarEdit" ></a> '},10:function(e,t,a,i,r){return' <a href="javascript:;" class="neweditIcon dIB vmiddle mR10 disabled" id="cvarEdit" ></a> '},12:function(e,t,a,i,r){var l=e.lambda,n=e.escapeExpression;return' <td class="bb ellipsistext" title=\''+n(l(t,t))+"'>"+n(l(t,t))+"</td> "},14:function(e,t,a,i,r){return' <tr> <td colspan="6"><div id="lvNoRecordsFound" class="bodyText pT30 pB30 aligncenter graytxt">'+e.escapeExpression(a.I18nDynamicKey.call(null!=t?t:{},"","crm.module.empty.message",null!=t?t.featureName:t,{name:"I18nDynamicKey",hash:{},data:r}))+"</div></td> </tr> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r,l,n){var s,o=null!=t?t:{};return' <div class="groupCtnList"> <div class="cvarTypesCtn"> <table width="100%" border="0" class="listview bdrCollapse" id="listview" style="table-layout: fixed;"> <tbody> <tr class="tableHeadBg"> <td class="tableHead w50"></td> '+(null!=(s=a.each.call(o,null!=t?t.heading:t,{name:"each",hash:{},fn:e.program(1,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" </tr> "+(null!=(s=a.each.call(o,null!=t?t.body:t,{name:"each",hash:{},fn:e.program(3,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "+(null!=(s=a.unless.call(o,null!=t?t.body:t,{name:"unless",hash:{},fn:e.program(14,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" </tbody> </table> </div> </div> "},useData:!0,useDepths:!0}),t.trackableFields=e({1:function(e,t,a,i,r){return' <li class="fL"> <label class="newCustomchkbox-md  fL eventNone"> <input type="checkbox" checked="" class="checkboxReal"> <span class="fL chkbxIcon mT3"></span> <span class="f13 mL5 fL relColValues ellipsistext">'+e.escapeExpression(e.lambda(t,t))+"</span> </label> </li> "},3:function(e,t,a,i,r,l,n){var s;return" "+(null!=(s=a.ifNotEquals.call(null!=t?t:{},null!=t?t.label:t,null!=n[1]?n[1].currPickList:n[1],{name:"ifNotEquals",hash:{},fn:e.program(4,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "},4:function(e,t,a,i,r,l,n){var s;return" "+(null!=(s=a.ifNotEquals.call(null!=t?t:{},null!=t?t.label:t,null!=n[1]?n[1].currPickListLabel:n[1],{name:"ifNotEquals",hash:{},fn:e.program(5,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "},5:function(e,t,a,i,r){var l;return' <li class="fL picklistSelectableFields"> '+(null!=(l=a.if.call(null!=t?t:{},null!=t?t.isFollowed:t,{name:"if",hash:{},fn:e.program(6,r,0),inverse:e.program(8,r,0),data:r}))?l:"")+" </li> "},6:function(e,t,a,i,r){var l=e.lambda,n=e.escapeExpression;return' <label class="newCustomchkbox-md  fL "> <input type="checkbox" checked="" onchange="CMB.validateTrackableFields(this);CrmModule.enableSaveButton(this)" class="checkboxReal" data-zcqa="PTH_'+n(l(null!=t?t.id:t,t))+'" id="'+n(l(null!=t?t.id:t,t))+'" data-label="'+n(l(null!=t?t.label:t,t))+'"> <span class="fL chkbxIcon mT3"></span> <span class="f13 mL5 fL labelSpan ellipsistext relColValues" >'+n(l(null!=t?t.label:t,t))+"</span> </label> "},8:function(e,t,a,i,r){var l=e.lambda,n=e.escapeExpression;return' <label class="newCustomchkbox-md fL"> <input type="checkbox" class="checkboxReal" onchange="CMB.validateTrackableFields(this);CrmModule.enableSaveButton(this)" data-zcqa="PTH_'+n(l(null!=t?t.id:t,t))+'" id="'+n(l(null!=t?t.id:t,t))+'" data-label="'+n(l(null!=t?t.label:t,t))+'"> <span class="fL chkbxIcon mT3"></span> <span class="f13 mL5 fL labelSpan ellipsistext relColValues">'+n(l(null!=t?t.label:t,t))+"</span> </label> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r,l,n){var s,o=e.lambda,d=e.escapeExpression,c=null!=t?t:{};return'<div class="selColContainer pT2"> <div class=\'selColContainerCtn\'> <ul id=\'selColList\' class="selColList p0 m0"> <li class="fL"> <label class="newCustomchkbox-md fL eventNone"> <input type="checkbox" class="checkboxReal" checked> <span class="fL chkbxIcon mT3"></span> <span class="f13 mL5 fL relColValues ellipsistext">'+d(o(null!=t?t.currPickList:t,t))+"</span> </label> </li> "+(null!=(s=a.each.call(c,null!=t?t.basicFields:t,{name:"each",hash:{},fn:e.program(1,r,0,l,n),inverse:e.noop,data:r}))?s:"")+" "+(null!=(s=a.each.call(c,null!=t?t.trackedfields:t,{name:"each",hash:{},fn:e.program(3,r,0,l,n),inverse:e.noop,data:r}))?s:"")+' </ul> </div> <div class="selColSelLimit fontsmooth pR pL35 f13 color_4 infoDisabled oH" id="maxRelatedListColMsg"> <span class="fL mL5 col333">'+d(o(null!=t?t.maxRelListColMsg:t,t))+"</span> </div> </div>"},useData:!0,useDepths:!0}),t.unsubscribeFormsList=e({1:function(e,t,a,i,r){var l,n=e.lambda,s=e.escapeExpression;return' <li data-zcqa="unsub_'+s(n(null!=t?t.linkName:t,t))+'_option" style="white-space: pre-wrap;" class="selValUnsubLink pR" title="'+s(n(null!=t?t.landingUrl:t,t))+'" onclick="inSplnk.fnUnsubLinkSelect(this);" value="'+s(n(null!=t?t.linkName:t,t))+'" formid="'+s(n(null!=t?t.formId:t,t))+'">'+(null!=(l=a.ifEquals.call(null!=t?t:{},"Default",null!=t?t.linkName:t,{name:"ifEquals",hash:{},fn:e.program(2,r,0),inverse:e.program(4,r,0),data:r}))?l:"")+"</li> "},2:function(e,t,a,i,r){return e.escapeExpression(a.getI18n.call(null!=t?t:{},"crm.lable.default",{name:"getI18n",hash:{},data:r}))},4:function(e,t,a,i,r){return e.escapeExpression(e.lambda(null!=t?t.linkName:t,t))},6:function(e,t,a,i,r){return' <span class="createLinkDiv"> <a class="cP pL30 pTB6 dB createlink f13" style="white-space: pre-wrap;" onclick="inSplnk.createUnsubscribeLink()" target="_blank" rel="noopener noreferrer">'+e.escapeExpression(a.getI18n.call(null!=t?t:{},"crm.customlink.createlink",{name:"getI18n",hash:{},data:r}))+"</a> </span> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l,n=null!=t?t:{};return'<ul class="listSelectVal cP m0 p0 whiteBg oA"> '+(null!=(l=a.each.call(n,null!=t?t.data:t,{name:"each",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?l:"")+" </ul> "+(null!=(l=a.if.call(n,null!=t?t.createLink:t,{name:"if",hash:{},fn:e.program(6,r,0),inverse:e.noop,data:r}))?l:"")},useData:!0}),t.validationRuleError=e({1:function(e,t,a,i,r){return' <div class="alignleft f14 color_3 mB5 popup-model-content"> <span class="red"> '+e.escapeExpression(e.lambda(t,t))+" </span> </div> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l,n=null!=t?t:{},s=e.escapeExpression;return'<div class="zcrm-content"> <div class="aligncenter"> <span id="vralertMsg" style="font : 18px;"> <div class="f22 crm-font-bold alignleft popup-model-header"> '+s(a.getI18n.call(n,"crm.validation.rule.invalid.entry.alertmsg.title",{name:"getI18n",hash:{},data:r}))+" </div> "+(null!=(l=a.each.call(n,t,{name:"each",hash:{},fn:e.program(1,r,0),inverse:e.noop,data:r}))?l:"")+' </span><br> <div class="aligncenter popup-model-footer"> <input type="button" id="custom_alert_button" class="primarybtn" value="'+s(a.getI18n.call(n,"crm.mb.newversion.msg4",{name:"getI18n",hash:{},data:r}))+'" onclick="CVRExec.hideAlertPopup()"> </div> </div> </div>'},useData:!0}),t.widgetPreview=e({1:function(e,t,a,i,r){var l;return" "+(null!=(l=a.ifContainsInArray.call(null!=t?t:{},r&&r.index,{name:"ifContainsInArray",hash:{},fn:e.program(2,r,0),inverse:e.program(7,r,0),data:r}))?l:"")+" "},2:function(e,t,a,i,r){var l,n=null!=t?t:{};return" "+(null!=(l=a.ifEquals.call(n,a.arithResult.call(n,r&&r.index,"+",1,{name:"arithResult",hash:{},data:r}),null!=t?t.length:t,{name:"ifEquals",hash:{},fn:e.program(3,r,0),inverse:e.program(5,r,0),data:r}))?l:"")+" "},3:function(e,t,a,i,r){return" <li class='widgetLastList'><span class='dIB ellipsistext vmiddle widgetPreviewContent'>"+e.escapeExpression(e.lambda(t,t))+"</span></li> "},5:function(e,t,a,i,r){return' <li class="smallDot">'+e.escapeExpression(e.lambda(t,t))+"</li> "},7:function(e,t,a,i,r){var l;return" "+(null!=(l=a.ifEquals.call(null!=t?t:{},r&&r.index,2,{name:"ifEquals",hash:{},fn:e.program(8,r,0),inverse:e.program(10,r,0),data:r}))?l:"")+" "},8:function(e,t,a,i,r){return" <li class=\"currentStage\"><span class='dIB ellipsistext vmiddle widgetPreviewContent'>"+e.escapeExpression(e.lambda(t,t))+"</span></li> "},10:function(e,t,a,i,r){var l;return" "+(null!=(l=a.ifEquals.call(null!=t?t:{},r&&r.index,3,{name:"ifEquals",hash:{},fn:e.program(11,r,0),inverse:e.program(13,r,0),data:r}))?l:"")+" "},11:function(e,t,a,i,r){return" <li class=\"stageCancelled\"><span class='dIB ellipsistext vmiddle widgetPreviewContent'>"+e.escapeExpression(e.lambda(t,t))+"</span></li> "},13:function(e,t,a,i,r){return" <li class=\"stageFinished\"><span class='dIB ellipsistext vmiddle widgetPreviewContent'>"+e.escapeExpression(e.lambda(t,t))+"</span></li> "},compiler:[7,">= 4.0.0"],main:function(e,t,a,i,r){var l;return' <div> <span class="dIB f12 widgetPriewHead crm-font-bold">Widget Preview</span> <a href="javascript:;" id="widgetPriewcloseIcon" class="widgetPriewcloseIcon" onclick="CMB.showWidgetPreview(this,true)"></a> </div> <ul class="widgetPriewList fontsmooth f12 mT70"> '+(null!=(l=a.each.call(null!=t?t:{},null!=t?t.pickListOptions:t,{name:"each",hash:{},fn:e.program(1,r,1),inverse:e.noop,data:r}))?l:"")+" </ul>"},useData:!0})}();var crmBstTime={responseData:{},responseDataSeid:{},userData:void 0,reqtime:{},updateInterval:void 0,updateTimeout:void 0,bestTimeClickTracker:void 0,detailsPageDate:void 0,detailsPageTime:void 0,reminderTime:void 0,reminderInformation:{},orderid:0,notificationFlag:0,increment:0,pushNotificationList:{},gmtTime:{},module:void 0,supportedModules:["Leads","Contacts"],days:["crm.best.time.day.short.sunday","crm.best.time.day.short.monday","crm.best.time.day.short.tuesday","crm.best.time.day.short.wednesday","crm.best.time.day.short.thursday","crm.best.time.day.short.friday","crm.best.time.day.short.saturday"],daysShortForm:["crm.best.time.day.short.monday","crm.best.time.day.short.tuesday","crm.best.time.day.short.wednesday","crm.best.time.day.short.thursday","crm.best.time.day.short.friday","crm.best.time.day.short.saturday","crm.best.time.day.short.sunday"],months:["crm.best.time.month.short.january","crm.best.time.month.short.february","crm.best.time.month.short.march","crm.best.time.month.short.april","crm.best.time.month.short.may","crm.best.time.month.short.june","crm.best.time.month.short.july","crm.best.time.month.short.august","crm.best.time.month.short.september","crm.best.time.month.short.october","crm.best.time.month.short.november","crm.best.time.month.short.december"],bestTimeNotificationData:{},ziapauseFlag:0,ziapauseInc:1,cTop:0,activityType:void 0,quickCreateTaskFlag:0,component:void 0,loadBestTimeNotificationData:function(e){var t=new crmRequestPool,a={execute:"getBestTimeNotificationData",ct:(new Date).getTime()};t.initiate({action:Crm.getCrmBasePath()+"/BestTime.do",data:a,success:function(t){crmBstTime.bestTimeNotificationData=JSON.parse(t),e&&crmBstTime.showBestTimeNotification()}})},getConvertedCurrentDateTime:function(){var e=new Date,t=e.getTimezoneOffset(),a=Utils.getTimezoneOffset();if(a!==t){var i=t-a;e.setMinutes(e.getMinutes()+i)}return e},addNeededParams:function(e){e&&(e.reqTime=(new Date).getTime(),e.seModule=crmTab.selectedTab,e.bestTimeFor="ALL",e.is12HourFormat="hh:mm a"===Crm.userDetails.TIME_FORMAT)},isSupportedModule:function(e){return-1!==crmBstTime.supportedModules.indexOf(e)},makeAjaxCall:function(e,t,a,i,r){r=r||"GET",(new crmRequestPool).initiate({action:e,data:a,type:r,success:function(e,a,i){t(e,a,i)},error:function(e){i&&i(e)}})},getListViewString:function(e){var t=e.length;t=t<=3?t:3;for(var a="",i=crmBstTime.getConvertedCurrentDateTime(),r=0;r<t;r++){var l=e[r],n=-1!==l.indexOf(" "),s=l.split(":"),o=new Date;if(n){var d=s[1].split(" "),c=I18n.getMsg("PM"),m=d[1]==c,u=s[0];m&&parseInt(u)<12&&(u=parseInt(u)+12),o.setHours(u),o.setMinutes(d[0])}else o.setHours(s[0]),o.setMinutes(s[1]);i>o?a='<span class="crm-font-regular f14 bestTimeTagList ">'+l+"</span>":a+='<span class="crm-font-regular f14 bestTimeTagList  mR5">'+l+"</span>"}return a},getParsedBestTime:function(e,t){var a={},i="hh:mm a"===Crm.userDetails.TIME_FORMAT,r=-1,l=-1,n=new Date,s=new Date;if(s.setMinutes(s.getMinutes()-30),void 0!==t&&void 0!==t.user_time){var o=t.user_time;r=o.hour,l=o.minute,n.setHours(r),n.setMinutes(l),s.setHours(r),s.setMinutes(l),s.setMinutes(s.getMinutes()-30),(new Date).getDate()!==crmBstTime.reqtime.getDate()&&(n.setDate(crmBstTime.reqtime.getDate()),s.setDate(crmBstTime.reqtime.getDate()))}n.setMilliseconds(new Date-crmBstTime.reqtime),s.setMilliseconds(new Date-crmBstTime.reqtime);for(var d=[],c=[],m=[],u=[],p=[],g=e.length,v=0;v<g;v++){var h=e[v],f=h.time.split(":"),y=f[0],C=f[1];i&&"PM"===h.ampm&&parseInt(y)<12&&(y=parseInt(y)+12);var b=new Date;if(b.setHours(y),b.setMinutes(C),n>b)s<b&&c.push(b),m.push(b);else{var T=(b-n)/6e4;T>4&&(p.push(b),T<15&&(a.isbelow15=!0)),u.push(b)}d.push(b),crmBstTime.gmtTime[crmBstTime.getFormattedTime(i,b)]=h.gmtTime}d.sort(Utils.sortDate),c.sort(Utils.sortDateDecending),u.sort(Utils.sortDate);var I=c.length,w=void 0,L=void 0;if(I>0){w=c[I-1],a.oldTime=crmBstTime.getFormattedTime(i,w);var k=Math.ceil((n.getTime()-w.getTime())/6e4%60);L=k;var $="";0===k?$=I18n.getMsg("crm.Now"):1===k?$=I18n.getMsg("crm.best.time.nl.str.minute.ago"):k>1&&($=I18n.getMsg("crm.best.time.nl.str.minutes.ago",k)),a.oldTimeInNL=$}if(a.allPastTimes=[],m.length>0){m.sort(Utils.sortDateDecending);for(var P=m.length,D=0;D<P;D++)a.allPastTimes.push(crmBstTime.getFormattedTime(i,m[D]))}if(a.reminderTime=[],p.length>0){p.sort(Utils.sortDate);var M=p.length;for(D=0;D<M;D++)a.reminderTime.push(crmBstTime.getFormattedTime(i,p[D]))}var _=I<=0?4:3;_=u.length>_?_:u.length;var E=u.slice(0,_);if(void 0!==E[0]){var S=E[0];a.nextImmediateTime=crmBstTime.getFormattedTime(i,S),a.nextImmediateTimeInNL=crmBstTime.getNextImmediateTimeInNL(S,n)}a.diffTime=Math.ceil(L),a.allTimes=[];for(var x=d.length,B=0;B<x;B++){var R=crmBstTime.getFormattedTime(i,d[B]);a.allTimes.push(R)}a.nextTimes=[];for(B=1;B<_&&void 0!==E[B];B++)a.nextTimes.push(crmBstTime.getFormattedTime(i,E[B]));return a},getNextImmediateTimeInNL:function(e,t){diffTime=(e.getTime()-t.getTime())/6e4;var a=parseInt(diffTime/60),i=parseInt(diffTime%60),r="";return 0===a?r=0===i?I18n.getMsg("crm.Now"):1===i?I18n.getMsg("crm.best.time.nl.str.minute.only",i):I18n.getMsg("crm.best.time.nl.str.minutes.only",i):1===a?r=0===i?I18n.getMsg("crm.best.time.nl.str.hour.only",a):1===i?I18n.getMsg("crm.best.time.nl.str.both.hour.and.minute",[a,i]):I18n.getMsg("crm.best.time.nl.str.both.hour.and.minutes",[a,i]):a>1&&(r=0===i?I18n.getMsg("crm.best.time.nl.str.hours.only",a):1===i?I18n.getMsg("crm.best.time.nl.str.both.hours.and.minute",[a,i]):I18n.getMsg("crm.best.time.nl.str.both.hours.and.minutes",[a,i])),r},sortDateBestTime:function(e,t){return new Date(e.bestTimeDate)-new Date(t.bestTimeDate)},getLevel:function(e){return e>=0&&e<21?1:e>20&&e<41?2:e>40&&e<61?3:e>60&&e<81?4:5},getBestTimeByDay:function(e,t,a){for(var i="hh:mm a"===Crm.userDetails.TIME_FORMAT,r=e[t],l=r.length,n=[],s=0;s<l;s++){var o=r[s],d=o.time.split(":"),c=d[0],m=d[1];"PM"===o.ampm&&parseInt(c)<12&&(c=parseInt(c)+12);var u={};u.weight=o.weight,u.bestTimeDate=new Date,u.bestTimeDate.setHours(c),u.bestTimeDate.setMinutes(m),n.push(u)}n.sort(crmBstTime.sortDateBestTime);var p=[],g=n.length;for(s=0;s<g;s++){var v={};v.bestTimeDate=n[s].bestTimeDate,v.bestTime=crmBstTime.getFormattedTime(i,n[s].bestTimeDate,!0),v.level=crmBstTime.getLevel(n[s].weight),p.push(v)}return p},showBestTimeOnRightPanelNew:function(e){if(void 0!==e){crmBstTime.reqtime=new Date;var t=crmBstTime.getBestTimeByDay(e,7,!0),a=t.length>5?5:t.length,i={};if(0!==a){i.nextImmediateTime=t[0].bestTime,i.nextImmediateTimelevel="lev"+t[0].level;var r=new Date;i.nextImmediateTimeInNL=crmBstTime.getNextImmediateTimeInNL(t[0].bestTimeDate,r),i.nextTimes=[];for(var l=1;l<a&&5!==l;l++){var n={};n.bestTime=t[l].bestTime,n.bestTimeLevel="lev"+t[l].level,i.nextTimes.push(n)}i.showRightpanelRemTime=i.nextTimes.length>0;var s=Handlebars.templates.RightPanelBestTime(i);$("#bestTimeRP").html(s)}}},detailsViewShow:function(e,t,a){if(Crm.userDetails.isBestTimeEnabledCall||Crm.userDetails.isBestTimeEnabledMail){crmBstTime.activityType=Crm.userDetails.isBestTimeEnabledCall&&Crm.userDetails.isBestTimeEnabledMail?"ALL":Crm.userDetails.isBestTimeEnabledCall?"CALL":"TEXT";var i="/crm/di/getBestTime",r={};r.seId=t.id,crmBstTime.addNeededParams(r),t.relModule&&(r.seModule=t.relModule),e?e.addUp({action:i,type:"GET",data:r,success:l}):crmBstTime.makeAjaxCall(i,l,r,void 0,"GET"),crmBstTime.reqtime=new Date}function l(e){var i=e[t.id];void 0!==a?a(i,e.data):$("#bestTimeToContact").html(Handlebars.templates.BestTimeToContact(i))}},populateActivityReminderBestTime:function(e){if(e){if(e.best_times)e.best_times_result=crmBstTime.getParsedBestTime(e.best_times);else for(var t=e.length,a=0;a<t;a++)for(var i=e[a].length,r=0;r<i;r++)e[a][r].best_times&&(e[a][r].best_times_result=crmBstTime.getParsedBestTime(e[a][r].best_times));return e}},showHideSuggestionForCreateTask:function(e){if("show"===e){var t=$("#BestTimeCreateTask .dIBestTimetoCallContainer");t.length?(t.removeClass("hide").hide().fadeIn(500),t.find("dIBestTimeContent").removeClass("hide").show(),t.find("#dIBestTime").addClass("hide").removeClass("hide").fadeIn(200)):crmBstTime.showSuggestionForCreateTask()}else $(".REMINDAT").attr("style","padding-bottom:0px;")},showSuggestionForCreateTask:function(){if(Crm.userDetails.isBestTimeEnabledCall||Crm.userDetails.isBestTimeEnabledMail){var e=Crm.userDetails.isBestTimeEnabled?"All":Crm.userDetails.isBestTimeEnabledCall?"Call":"Text";if(crmBstTime.hideBestTimeSuggestion("CreateTask"),document.getElementById("Crm_Tasks_CONTACTID")){var t=$("#Crm_Tasks_CONTACTID"),a=t.data().lookupModule,i=t.data().id,r=$("#Crm_Tasks_SUBJECT").val(),l=$("#Crm_Tasks_DUEDATE"),n=crmBstTime.constructDateObject(l.val());if((new Date).toDateString()!=n.toDateString()&&new Date>n)return void $L($("crm-besttime-zia")[0]).hide();$("#RemindAtdiv > div .popfooter").length?$(renderingUtils.createHTML({name:"div",attr:{id:"BestTimeCreateTask",style:"display:block;"}})).insertBefore($("#RemindAtdiv .popfooter")):$("#RemindAtdiv > div").eq(0).append(renderingUtils.createHTML({name:"div",attr:{id:"BestTimeCreateTask",style:"display:block;"}})),"All"==e&&(e=r.includes("CALL ")||"CALL"==r||r.includes("Call ")||"Call"===r||r.includes("call ")?"Call":"Text");var s=networkUtils.returnDependencyFiles(["crm-besttime-zia.js"],crmConstants.jsStaticPathForLyte);if(s=s.concat(networkUtils.returnDependencyFiles(["crm-besttime-zia.css"],crmConstants.cssStaticPathForLyte)),$("#BestTimeCreateTask").length){Lyte.injectResources(s,void 0,(function(){Lyte.Component.render("crm-besttime-zia",{seid:i,viewType:"CreateTask",module:a,dueDate:n,type:e},"#BestTimeCreateTask");var t=$(".dIBestTimeContainerCreateTask");t.addClass("schedule"),t.is(":visible")&&$(".REMINDAT").attr("style","padding-bottom:140px"),crmBstTime.setPosition()}))}crmBstTime.setBestTimeTracker("CreateTask",e),$("#Crm_Tasks_RemindAt_Start_Date1").on("change",(function(){var e=$(this).val(),t=$("crm-besttime-zia")[0];$(".calendarInputCreateTask").val(e),e=crmBstTime.constructDateObject(e),new Date>e&&(new Date).toDateString()!=e.toDateString()?$L(t).hide():t.component.changeDateForCreateTask(e)})),t.on("change",(function(){if($("#BestTimeCreateTask").length){Lyte.injectResources(s,void 0,(function(){$("crm-besttime-zia").remove();var t=$("#Crm_Tasks_CONTACTID").data();Lyte.Component.render("crm-besttime-zia",{seid:t.id.toString(),viewType:"CreateTask",module:t.lookupModule,dueDate:n,type:e},"#BestTimeCreateTask");var a=$(".dIBestTimeContainerCreateTask");a.addClass("schedule"),a.is(":visible")&&$(".REMINDAT").attr("style","padding-bottom:140px"),crmBstTime.setPosition()}))}}))}}},showSuggestionForCreateCall:function(){if(Crm.userDetails.isBestTimeEnabledCall&&(crmBstTime.hideBestTimeSuggestion("CreateCall"),!$("#CurrentCall").prop("checked")&&!$("#CompletedCall").prop("checked")&&document.getElementById("Crm_Calls_CONTACTID"))){var e=$("#Crm_Calls_CONTACTID");e.attr("onchange","crmBstTime.showSuggestionForCreateCall()");var t=$("#Crm_Calls_CALLSTARTDATETIME"),a=e.data(),i=a.lookupModule,r=a.id,l=crmBstTime.constructDateObject(t.val());$(".newCallContainer").parent().append(renderingUtils.createHTML({name:"div",attr:{id:"BestTimeCreateCall",class:"w100p"}}));var n=networkUtils.returnDependencyFiles(["crm-besttime-zia.js"],crmConstants.jsStaticPathForLyte);if(n=n.concat(networkUtils.returnDependencyFiles(["crm-besttime-zia.css"],crmConstants.cssStaticPathForLyte)),$("#BestTimeCreateCall").length){Lyte.injectResources(n,void 0,(function(){Lyte.Component.render("crm-besttime-zia",{seid:r,viewType:"CreateCall",module:i,dueDate:l},"#BestTimeCreateCall"),$("#ScheduleCall").parents(".labelValCreate").css({"margin-bottom":"0px"}),$("#BestTimeCreateCall").css({"margin-bottom":"120px"}),crmBstTime.setPosition()}))}crmBstTime.setBestTimeTracker("CreateCall","Call"),t.on("change",(function(){var e=$(this).val();$(".calendarInputCreateCall").val(e);var t=$("crm-besttime-zia")[0];if(void 0!==t){if(e=crmBstTime.constructDateObject(e),new Date>e&&(new Date).toDateString()!=e.toDateString())return $L(t).hide(),void $("#BestTimeCreateCall").css({"margin-bottom":"0px"});t.component.changeDateForCreateTask(e)}}))}},showSuggestionForQuickCreateCall:function(){if(Crm.userDetails.isBestTimeEnabledCall){var e=$("#bestTimeUsageId");crmBstTime.hideBestTimeSuggestion("QuickCreateTask"),$("#leContModName").on("loadBestTime",(function(){crmBstTime.showSuggestionForQuickCreateCall()})),$("#Crm_Calls_CALLSTARTDATETIME").attr("onchange","crmBstTime.showSuggestionForQuickCreateCall()");var t=$("#leContModSel").val(),a=$("#leContModId").val(),i=$('input[name="property(Call Start Time)"]').val(),r=crmBstTime.constructDateObject(i);e.val("NotUsed"),crmBstTime.sendBestTimeRequest("QuickCreateCall",r,t,a)}},showSuggestionForQuickCreateTask:function(e){if(Crm.userDetails.isBestTimeEnabledCall||Crm.userDetails.isBestTimeEnabledMail){var t=$("#bestTimeListFilterId");if(t.length&&($("#sdiv").hide(),t.hide()),Crm.userDetails.isBestTimeEnabledCall&&Crm.userDetails.isBestTimeEnabledMail?crmBstTime.activityType="ALL":crmBstTime.activityType=Crm.userDetails.isBestTimeEnabledCall?"CALL":"TEXT",$("#ctiapi_activitys_create_task").is(":visible"))crmBstTime.hideBestTimeSuggestion("QuickCreateTask");else{$("#bestTimeUsageId");var a=$("#leContModSel").val(),i=$("#leContModId").val(),r=$('input[name="property(Remind At)"]').val(),l=$('input[name="property(Due Date)"]').val();e&&l&&(r=l),$("#qc_rem_date").attr("onchange","crmBstTime.showSuggestionForQuickCreateTask()");var n=crmBstTime.constructDateObject(r);crmBstTime.sendBestTimeRequest("QuickCreateTask",n,a,i)}}},showSuggestionForReSchedule:function(e){if(Crm.userDetails.isBestTimeEnabledCall){""!==e&&void 0!==e||(e=0);var t=$("#relatedDetails_Calls").find("a").attr("data-params");if(""===t||void 0===t)return e<5?(e+=1,void setTimeout((function(){crmBstTime.showSuggestionForReSchedule(e)}),100)):void 0;var a=JSON.parse(t),i=a.module,r=a.id,l=$("#callDate");$("#rescheduleBestTimeUsageId").val("NotUsed");var n=$("#bestTimeUsageId");l.attr("onchange","crmBstTime.showSuggestionForReSchedule()");var s=crmBstTime.constructDateObject(l.val());n.val("NotUsed"),crmBstTime.sendBestTimeRequest("Reschedule",s,i,r)}},sendBestTimeRequest:function(e,t,a,i){if(!(Crm.userDetails.CLIENT_ACCOUNT||"A|Z|C|E|U".indexOf(Crm.userDetails.LICENSE_TYPE)<0)){crmBstTime.module=a;var r=0==$("#updateCallStatus").length?$("#bestTimeUsageId"):$("#rescheduleBestTimeUsageId"),l="DetailsPage"===e;if(crmBstTime.responseData[e]=void 0,t&&a&&i&&("Contacts"===a||"Leads"===a)){var n=new crmRequestPool,s="QuickCreateCall"===e||"QuickCreateTask"===e||"Reschedule"===e?new Date(t):new Date;"QuickCreateCall"!==e&&"Reschedule"!==e||(crmBstTime.activityType="CALL");var o={seId:i,seModule:a,is12HourFormat:"hh:mm a"===Crm.userDetails.TIME_FORMAT,bestTimeFor:crmBstTime.activityType,reqTime:s.getTime(),isDetailsPage:l};l&&(o.userTZ=Crm.userDetails.USER_TIME_ZONE,o.timeFormat=Crm.userDetails.TIME_FORMAT),n.initiate({action:"/crm/di/getBestTime",type:"GET",data:o,success:function(t){void 0!==t&&""!==t&&void 0!==t[i]&&""!==t[i]?(crmBstTime.responseData[e]=t[i],crmBstTime.responseDataSeid[e]=i,crmBstTime.userData=t.data,crmBstTime.reqtime=new Date,crmBstTime.loadBestTimeData(e,!0,a)):r.val("NA"),l&&(crmBstTime.reminderTime=t.reminderTime)},error:function(){r.val("NA")}})}}},removeBestTimeFilter:function(){$(".dItimesdiv").find("li").show(),$("#bestTimeListFilterId").removeClass("filtered").hide()},hideBestTimeSuggestion:function(e,t){""!==t&&void 0!==t||(t=0),"QuickCreateTask"===e||"Reschedule"===e||"QuickCreateCall"===e?($("#times").find("li").removeClass("favBestTimeDrop").removeClass("bestTime").removeClass("lev1").removeClass("lev2").removeClass("lev3").removeClass("lev4").removeClass("lev5"),crmBstTime.removeBestTimeFilter(),$("#sdiv").removeClass("dItimesdiv").removeClass("tHours"),$("#bestTimeListFilterId").hide(),"QuickCreateCall"===e&&($("#leContModName").removeAttr("loadBestTime"),$("#bestTimeUsageId").val("NA"))):"DetailsPage"===e?$("#BestTime"+e).find(".dIBestTimeContainerDetailsPage").remove():"CreateTask"===e?($("#BestTime"+e).remove(),$(".REMINDAT").attr("style","padding-bottom:0px"),$("#bestTimeListFilterId").hide()):"CreateCall"===e&&($("#BestTime"+e).remove(),$("#ScheduleCall").parents(".labelValCreate").css({"margin-bottom":"initial"}),$("#Crm_Calls_CALLSTARTDATETIME").removeAttr("onchange"),$("#Crm_Calls_CONTACTID").removeAttr("onchange"),$("#bestTimeListFilterId").hide())},showCalendarForDi:function(e,t,a){var i=new Date;crmCalendar.showCalendar(e,t,a,void 0,void 0,void 0,i.getMonth()+1+"/"+i.getDate()+"/"+i.getFullYear(),void 0),$("#Calendar").css({height:$(".dIBestTimeDropdown").outerHeight()-6,"box-sizing":"border-box"})},loadBestTimeData:function(e,t,a){$("body").children(".diNewToolTipForBestTime").remove();var i=crmBstTime.responseData[e];if(void 0!==i&&i[7].length){new Date;if("QuickCreateTask"===e||"Reschedule"===e||"QuickCreateCall"===e){var r=crmBstTime.getBestTimeByDay(i,7,!0),l=$("#times"),n=$("#sdiv");if(n.find("li").show(),l.find("li").removeClass("favBestTimeDrop").removeClass("bestTime").removeClass("lev1").removeClass("lev2").removeClass("lev3").removeClass("lev4").removeClass("lev5"),r.length>0){if(n.addClass("dItimesdiv"),"HH:mm"===Crm.userDetails.TIME_FORMAT&&n.addClass("tHours"),"pl_PL"!==Crm.userDetails.LOCALE&&"bg_BG"!==Crm.userDetails.LOCALE||n.addClass("plLang"),"QuickCreateCall"===e)crmBstTime.constructDateObject($('input[name="property(Call Start Time)"]').val());else if("QuickCreateTask"===e){var s=$("#qc_rem_date").val();s=""===s||void 0===s?$('input[name="property(Due Date)"]').val():s,crmBstTime.constructDateObject(s)}else"Reschedule"===e&&crmBstTime.constructDateObject($("#callDate").val());for(var o=r.length>5?5:r.length,d=0;d<o;d++){var c=r[d].bestTime,m="lev"+r[d].level;l.find('li[time="'+c.replace(" ",":")+'"]').addClass("bestTime").addClass(m)}(o>0&&!t&&!a||n.is(":visible"))&&$("#bestTimeListFilterId").show(),t||crmBstTime.alignBestTimeList()}else n.css({"padding-bottom":0})}}},alignBestTimeList:function(){var e=$("#sdiv"),t=e.offset().top,a=e.outerHeight();if(0===$(".dItimesdiv").find("li.bestTime").length)e.removeClass("dItimesdiv").removeClass("tHours"),$("#bestTimeListFilterId").hide();else{var i=$("#bestTimeListFilterId"),r=i.outerHeight()+3;if(e.is(":visible")&&i.show(),renderingUtils.windowHeight<a+t){var l=t-a-30,n=i.offset().top-a-26;e.css({top:l}),i.css({top:n}),e.addClass("tA")}}e.css({"padding-bottom":r}),i.show()},setBestTimeTracker:function(e,t){$(".dIBestTimeContent .timeDi ").on("click",(function(a){var i=a.target.textContent;if(i=9===i.length?a.target.textContent.slice(1):i,crmBstTime.bestTimeClickTracker=!0,"CreateTask"===e){var r=$("#Crm_Tasks_RemindAt_Start_Date1_TimeOption");r.val(i).effect("highlight",{},1e3);var l=r.val().split(" ")[0].split(":"),n=l[0],s=l[1];n="PM"===Utils.getMeridiem(r.timeEntry("getTime")).toUpperCase()?parseInt(n)+12:n;var o=crmCalendar.getDateObjectFromGivenDateString($("#Crm_Tasks_RemindAt_Start_Date1").val());o.setHours(n),o.setMinutes(s),$("#Tasks_fldRow_RemindAt_Start_Date1 #Crm_Tasks_RemindAt_Start_Date1").data("dateObj",o)}else"CreateCall"===e&&$("#Crm_Calls_CALLSTARTDATETIME_TimeOption").val(i).effect("highlight",{},1e3);Crm.client_tracking("BestTime - Usage",{Module:crmBstTime.module,viewType:e,BestTimeTo:t})}))},getDateCri:function(e){var t=new Date;return e.getDate()==t.getDate()&&e.getMonth()==t.getMonth()&&e.getFullYear()==t.getFullYear()?"Today":e.getDate()==t.getDate()+1&&e.getMonth()==t.getMonth()&&e.getFullYear()==t.getFullYear()?"Tomorrow":"Other"},getDateCri:function(e){var t=new Date;return e.getDate()==t.getDate()&&e.getMonth()==t.getMonth()&&e.getFullYear()==t.getFullYear()?"Today":e.getDate()==t.getDate()+1&&e.getMonth()==t.getMonth()&&e.getFullYear()==t.getFullYear()?"Tomorrow":"Other"},setPosition:function(){var e=$("#BestTimeDetailsPage"),t=e.outerWidth(),a=$("#bcWraperDiv").outerWidth(),i=$(".bcCardDetail"),r=i.outerWidth()+t,l=a-r<=0?0:a-r;0!==(l=l-50>400?l-200:l-50>300?l-100:l-50>250?l-50:l)?l+r<=a?(l=l-10<=0?0:l-10,e.hasClass("flex-grid-skeleton")||(Crm.userDetails.RTL_ENABLED?e.hide().fadeIn(100).css({"margin-right":l-5}):e.hide().fadeIn(100).css({"margin-left":l-5}))):(l=l+r-a,e.hasClass("flex-grid-skeleton")||(Crm.userDetails.RTL_ENABLED?e.hide().fadeIn(100).css({"margin-right":l-10}):e.hide().fadeIn(100).css({"margin-left":l-10}))):i.length&&!$(".DetailsPageRevampBox").length&&i.find(".busniess_card_Hover").addClass("dITruncateFields")},showBestTimeInList:function(){if($(".dItimesdiv").find("li").show(),$("#ctiapi_activitys_create_call").is(":visible")||$("#ctiapi_activitys_create_task").is(":visible"))crmBstTime.hideBestTimeSuggestion("QuickCreateTask");else{$("#bestTimeListFilterId").removeClass("filtered");var e=$("#quick_module").val();if("Tasks"===e)crmBstTime.loadBestTimeData("QuickCreateTask");else if("Calls"===e){var t=$("#leContModName"),a=t&&t.val()?t.val().length:"";$("#whichCall1").prop("checked")||$("#whichCall2").prop("checked")||0===a?crmBstTime.hideBestTimeSuggestion("QuickCreateCall"):crmBstTime.loadBestTimeData("QuickCreateCall")}else $("#statusHeading").text()===I18n.getMsg("Re-schedule")&&crmBstTime.loadBestTimeData("Reschedule");0===$("#sdiv").find("li.bestTime").length&&crmBstTime.hideBestTimeSuggestion("QuickCreateTask")}},showFilteredBestTime:function(e){var t=$(".dItimesdiv"),a=$(e),i=$("#sdiv"),r=i.outerHeight(),l=$("#bestTimeListFilterId"),n=l.outerHeight()+3;if(a.hasClass("filtered")?(t.find("li").show(),a.removeClass("filtered")):(a.addClass("filtered"),t.find("li").hide(),t.find("li.bestTime").show()),$(".tA").length)if($(".filtered").length){l.attr("w",r);var s=r-i.outerHeight();crmBstTime.cTop=i.offset().top+s,l.css({top:crmBstTime.cTop+i.height()+4}),i.css({top:crmBstTime.cTop,"padding-bottom":n})}else{s=l.attr("w")-r;var o=crmBstTime.cTop-s;l.css({top:o+i.height()+4}),i.css({top:o,"padding-bottom":n})}else i.css({"padding-bottom":n}),l.css({top:t.offset().top+t.height()+4});l.removeClass("bottomAlignClicked"),Crm.client_tracking("BestTime - Usage",{Module:crmBstTime.module,viewType:"QuickCreateCall"})},showRightpanelRemTime:function(){$(".dIrightPanelTags").fadeIn(200)},setBestTimeValueforCall:function(){var e=Utils.getDateInUserDatePattern(crmBstTime.detailsPageDate),t=crmBstTime.detailsPageTime[1]+":"+crmBstTime.detailsPageTime[2];$("#whichCall3").trigger("click"),$("[id='Call Start TimedateTime']").attr("value",t).effect("highlight",{},1e3),$('[name="property(Call Start Time)"]').val(e).effect("highlight",{},1e3),$('[name="property(Call Start Timehour)"]').val(crmBstTime.detailsPageTime[1]),$('[name="property(Call Start Timeminute)"]').val(crmBstTime.detailsPageTime[2]);var a=$("[id='Call Start Time_ampmSpan']");if(a.length){var i=I18n.getMsg("AM")===crmBstTime.detailsPageTime[3]?"AM":"PM";a.text(I18n.getMsg(crmBstTime.detailsPageTime[3])),$('[name="property(Call Start Timeampm)"]').val(i)}$("#qCreate").addClass("qCreateCallCenter"),$("#saveCall").show(),$("#startCurrCall").hide(),$("#Zia_CreateCall").removeClass("BT"),$("#bestTimeUsageId").val("Used")},setBestTimeValueforTask:function(){var e=Utils.getDateInUserDatePattern(crmBstTime.detailsPageDate),t=crmBstTime.detailsPageTime[1]+":"+crmBstTime.detailsPageTime[2];$("#qCreate").addClass("qCreateCallCenter"),$("#dateBasedRemindAtTime").attr("value",t),$('[name="property(Remind Athour)"]').val(crmBstTime.detailsPageTime[1]),$('[name="property(Remind Atminute)"]').val(crmBstTime.detailsPageTime[2]);var a=$("[id='Remind At_ampmSpan']");if(a.length){var i=I18n.getMsg("AM")===crmBstTime.detailsPageTime[3]?"AM":"PM";a.text(I18n.getMsg(crmBstTime.detailsPageTime[3])),$('[name="property(Remind Atampm)"]').val(i)}Crm.userDetails.detailView_newUI?($("#Zia_CreateTaskCall").removeClass("BT"),$("#Zia_CreateTaskMail").removeClass("BT")):$("#Zia_CreateTask").removeClass("BT"),$(getElemById("Call Start TimedateTime")).val(e),$("#qc_rem_date").val(e),$("#bestTimeUsageId").val("Used"),$('select[name="alertType"]').val("popup").change(),$("#remindAtInfo").addClass("BT"),$("#remindAtCheckbox").prop("checked",!0),quickTask.setReminder(),Crm.userDetails.detailView_newUI?quickTask.createReminder():$("#doneRemindAt").trigger("click")},sendBestTimeReminderRequest:function(e,t,a){var i=new crmRequestPool;e.crmcsrfparam=cookieUtils.getCookie("crmcsr"),i.initiate({action:"/crm/di/ziaReminder",type:"POST",data:e,success:function(e){if(void 0!==e&&""!==e&&(crmBstTime.reminderTime=e.ReminderTime),"listView"===t){var i=Lyte.Router.getRouteInstance().routeName;e.result&&(e.overAll_status?crmui.showMsgBand("success",I18n.getMsg("crm.best.time.zia.success.msg"),2e3):void 0!==e.overAll_status&&crmui.showMsgBand("warning",I18n.getMsg("crm.best.time.zia.warning.msg"),5e3),a||("list"==i?void 0!==e.overAll_status?Lyte.registeredMixins["crm-view-utils"].clearSelection():crmListView.reloadCurrentListView(void 0,"list"):crmListView.selectAllEntity())),hideAnimatePopup("topBandPopup",!0),commonUtils.showHideLoadingDiv(),removeFreezeLayer()}else if("restore"===t){crmBstTime.setToLocalStorage();var r=e.notifications;if(void 0!==r)for(var l=r.length,n=0;n<l;n++)crmBstTime.showReminderPushNotification(r[n],"customMsg")}}})},showReminderPushNotification:function(e,t){var a=crmBstTime.orderid;crmBstTime.reminderInformation[crmBstTime.orderid]=e,0===crmBstTime.notificationFlag&&(crmBstTime.setTopEle(crmBstTime.increment),crmBstTime.notificationFlag=1);var i=27e5;if(void 0!==t){var r=(new Date).getTime();i=crmBstTime.getDateObject(e.time,!0).getTime()-r+18e5}crmBstTime.pushNotificationList["notificationTimeout"+a]=setTimeout((function(){crmBstTime.hideRemoveNotification(a,$("#crmBtReminder"+a),void 0,!1)}),i),crmBstTime.orderid++},setTopEle:function(e){crmBstTime.increment=e;var t=Object.keys(crmBstTime.reminderInformation).length,a=$(".diCrmBestTmeRepDiv"),i=$("body");a.length||(i.append('<div class="diCrmBestTmeRepDiv"><div class="crm-font-regular headerClassdI" id="reminderTopBand" ><span class="fL mR5">'+I18n.getMsg("crm.best.time.zia.notification.title")+'</span><div class="divOrderIc fL cP" onclick="crmBstTime.openNotificationSettings()"></div><div class="fR cP" data-zcqa="zia_dissmissAll" onclick="crmBstTime.dismissAllNotification()">'+I18n.getMsg("crm.best.time.zia.dismiss.all")+"</div></div></div>"),a=$(".diCrmBestTmeRepDiv"));var r=$(".diCrmBestTmeRepDiv .headerClassdI"),l=r.outerHeight(),n=$(".headerClassdI").outerHeight(),s=$("#moreNotification");s.length||i.append(renderingUtils.createHTML({name:"div",attr:{class:"dishowMoreOptNotification dishowMoreOptNotification",id:"moreNotification",onclick:"crmBstTime.toShowAllNotification(this)","data-zcqa":"zia_moreOption"},child:[{name:"text",content:"1"+I18n.getMsg("crm.label.More")}]}));var o=$(".dishowMoreOptNotification");if(e<t){var d=crmBstTime.reminderInformation[crmBstTime.increment];if(d&&d.entity_detail){var c=void 0===d.accountName?" ":d.accountName,m=d.time;d.time.includes("AM")?m=(m=d.time.replace("AM",""))+" "+I18n.getMsg("AM"):d.time.includes("PM")&&(m=(m=d.time.replace("PM",""))+" "+I18n.getMsg("PM"));var u="<div id=crmBtReminder"+crmBstTime.increment+" data-id="+d.id+' class="popReminderFromBestTime" databesttimeorderid='+crmBstTime.increment+'><div class="remBandCont fL"><div class="profileSectionCont w100p"><div class="profTextCont crm-font-regular w100p"><div id="crmBtReminderContactName" class="profTextcontName fL cB mB4" data-zcqa="zia_openEntity'+crmBstTime.increment+'" onClick="crmBstTime.openEntityInNewWindow('+crmBstTime.increment+')">'+$ESAPI.encoder().encodeForHTML(d.name)+'</div><span class="profTextTitTime fR ellipsistext" title="'+m+'">'+m+'</span><div id="crmBtReminderAccountName" class="profcontOrg fL crm-font-regular cB">'+$ESAPI.encoder().encodeForHTML(c)+'</div></div></div><div class="remBandButton mT8"><button class="remBandGreen crm-font-regular  mR5" data-zcqa="zia_displayPhoneNo'+crmBstTime.increment+'" id=notificationCallButton'+crmBstTime.increment+' onclick="crmBstTime.displayPhoneNumber(this,'+crmBstTime.increment+');sE(event);">'+I18n.getMsg("Call")+'</button></div></div><div class="fL popRightPanelbutton"><div class="viewbtnStyle cP" data-zcqa="zia_dismiss" onClick="crmBstTime.hideRemoveNotification('+crmBstTime.increment+',this,event);sE(event);">'+I18n.getMsg("crm.eventreminder.dismiss")+'</div><div class="viewbtnStyle laterViewBtn cP" onClick="crmBstTime.displayLaterTime(this,'+crmBstTime.increment+');sE(event)" style="border-bottom:0px;">'+I18n.getMsg("crm.tpi.ctiapi.button.label.notification.later")+"</div></div></div>";u=Handlebars.compile(u);var p={};p[d.entity_detail.seId+""]=d.gmtTime+":"+d.viewId,crmBstTime.setToLocalStorage(d.id,p,"add");var g=$(".popReminderFromBestTime"),v=g.length;0===v?a.append(u):($(u.call()).insertAfter(g.last()),v+=1),void 0!==d.entity_detail.callOptions&&d.entity_detail.callOptions.length||$("#notificationCallButton"+crmBstTime.increment).text(I18n.getMsg("crm.label.view")).addClass("viewLabel"),a.show();var h=$("#crmBtReminder"+crmBstTime.increment),f=h.outerWidth()+3,y=h.outerWidth()/2-o.outerWidth()/2,C=h.outerHeight();r.css({width:f-3}),a.css({width:f,height:l+3*C}),a.hasClass("showMoreOpened")?crmBstTime.toShowAllNotification():v>=3?a.css({height:l+3*C}):crmBstTime.toShowAllNotification(),o.css({top:n+3*C+16,right:y});var b=$(".toAvoidbord");if(!a.hasClass("showMoreOpened")&&v>=3){var T=v-3;T>0&&(s.text(T+" "+I18n.getMsg("crm.label.More")).show(),a.hasClass("ps-container")&&thirdPartyUtils.unbindPerfectScroll(a),b.show(),thirdPartyUtils.bindPerfectScroll(a,{suppressScrollX:!0}))}b.length||a.append('<div class="toAvoidbords"></div>'),setTimeout((function(){r.fadeIn(350),$("#crmBtReminder"+crmBstTime.increment).css({right:"3px",opacity:1,top:"27px"}).show(),crmBstTime.setTopFromNew($("#crmBtReminder"+crmBstTime.increment),crmBstTime.increment)}),1e3)}}else crmBstTime.notificationFlag=0},toShowAllNotification:function(e){var t=$(".popReminderFromBestTime"),a=$("#wmstoolbar"),i=a.length?a.outerHeight():28,r=t.one().outerHeight()*t.length+$(".headerClassdI").outerHeight()+27-i;renderingUtils.windowHeight<=r&&(r=renderingUtils.windowHeight-7-a.outerHeight());var l=$(".diCrmBestTmeRepDiv");$(e).hide(),e&&l.addClass("showMoreOpened"),l.css({height:r,overflow:"auto"})},setTopFromNew:function(e,t){var a=$(e).prev(".popReminderFromBestTime"),i=a.nextAll(".popReminderFromBestTime").length*a.outerHeight()+27;a.css({top:i,right:"3px"}),$(".toAvoidbord").css({top:95+i}),a.prev(".popReminderFromBestTime").length?crmBstTime.setTopFromNew(a,t):crmBstTime.setTopEle(t+1)},dismissReminderPushNotificaiton:function(e){var t=e.nId;if("0"===t){for(x in $(".diCrmBestTmeRepDiv").remove(),$("#reminderTopBand, #moreNotification").hide(),crmBstTime.increment=0,crmBstTime.orderid=0,crmBstTime.notificationFlag=0,crmBstTime.reminderInformation={},crmBstTime.pushNotificationList)clearTimeout(crmBstTime.pushNotificationList[x]);crmBstTime.setToLocalStorage()}else{var a=$("[data-id="+t+"]");if(a.length){var i=a.attr("id").replace("crmBtReminder","");crmBstTime.hideRemoveNotification(i,a,void 0,!1)}}},displayLaterTime:function(e,t){var a=I18n.getMsg("mins"),i="<div class='diLaterTimeDiv' id='diLaterTimeDiv'><ul class='p0 m0'><li class='crm-font-regular m0' data-zcqa='zia_reschedule5' onClick='crmBstTime.rescheduleReminder(this,"+t+",5);sE(event)'>5 "+a+"</li><li class='crm-font-regular m0' data-zcqa='zia_reschedule10' onClick='crmBstTime.rescheduleReminder(this,"+t+",10);sE(event)'>10 "+a+"</li><li class='crm-font-regular m0 lastForBorder' data-zcqa='zia_reschedule15' onClick='crmBstTime.rescheduleReminder(this,"+t+",15);sE(event)'>15 "+a+"</li></ul></div>",r=$(".remindMeTime .listElements:not(.nextBestTime)").clone(),l="",n=$(e),s="hh:mm a"===Crm.userDetails.TIME_FORMAT,o=crmBstTime.reminderInformation[t].entity_detail.laterTimes,d=n.offset().left,c=n.offset().top+n.outerHeight()-3,m=void 0===o?0:o.length;if(m>0){l=l+'<li class="crm-font-regular m0 diLaterTimesForLi firstForBorder" data-zcqa="zia_reschedule1" onClick="crmBstTime.rescheduleReminder(this,'+t+');" gmtTime='+o[0].gmtTime+">"+(s?crmBstTime.get12HourTimeFormat(o[0].timeString):o[0].timeString)+"</li>";for(var u=1;u<m;u++)l=l+'<li class="crm-font-regular m0 diLaterTimesForLi" data-zcqa="zia_reschedule'+u+'" onclick="crmBstTime.rescheduleReminder(this,'+t+');"  gmtTime='+o[u].gmtTime+">"+(s?crmBstTime.get12HourTimeFormat(o[u].timeString):o[u].timeString)+"</li>"}r.removeAttr("onmouseout").removeAttr("onmouseover"),r.removeClass("listElements"),l=Handlebars.compile(l),$("#diLaterTimeDiv").remove(),$("body").append(i),$(".diLaterTimeDiv .p0").append(l),0===$(".diLaterTimesForLi").length&&$(".lastForBorder").removeClass("lastForBorder"),$(".diLaterTimeDiv").css({left:d,top:c}).show(),$(".dICallTimerDiv").hide(),$(".clikedLaterbtn").removeClass("clikedLaterbtn"),n.addClass("clikedLaterbtn")},rescheduleReminder:function(e,t,a){$(".diLaterTimeDiv").hide();var i=crmBstTime.reminderInformation[t],r=void 0,l=void 0;void 0!==a?(r=60*a*1e3,l="modify"):(r=e.getAttribute("gmtTime"),l="add");var n={seId:i.entity_detail.seId,reminderTime:r,viewId:i.viewId,operation:l,userTZ:Crm.userDetails.USER_TIME_ZONE,timeFormat:Crm.userDetails.TIME_FORMAT};crmBstTime.hideRemoveNotification(t,$("#crmBtReminder"+t)),crmBstTime.sendBestTimeReminderRequest(n)},initCallfromReminder:function(e,t){$(".dICallTimerDiv").hide(),$(".callBtnSel").removeClass("callBtnSel");var a=t.getAttribute("lastusedorderid");if(Crm.userDetails.TELEPHONY_ENABLED){var i=crmBstTime.reminderInformation[a].entity_detail;ctiApiNotifier.click2Call($(t).children(".offNo").text(),Crm.userDetails.ZGID,Crm.userDetails.USER_ID,i.id,"",i.module,crmBstTime.reminderInformation[a].name)}else window.ZPB&&ZPB.clickToDial.isEnabled()?crmCallsNew.initiateCallViaZPB($(t).children(".offNo").text(),i.id,i.module,crmBstTime.reminderInformation[a].name):window.location="skype:+"+$(t).children(".offNo").text()+"?call";crmBstTime.hideRemoveNotification(a,$("#crmBtReminder"+a))},displayPhoneNumber:function(e,t){var a=$(e),i=a.offset().left,r=a.offset().top+a.outerHeight()+3,l=crmBstTime.reminderInformation[t].entity_detail.callOptions;if($(".callBtnSel").removeClass("callBtnSel"),a.addClass("callBtnSel"),$("#diCallToolTip").hide(),a.hasClass("viewLabel"))a.removeClass("viewLabel"),crmBstTime.openEntityInNewWindow(t),crmBstTime.hideRemoveNotification(t,$("#crmBtReminder"+t));else{for(var n="<div class='dICallTimerDiv' id='diCallToolTip' ><ul class='p0 m0' style='display:table'>",s=l.length,o=0;o<s;o++)n=n+"<li class='crm-font-regular m0 diPersonalTime' data-zcqa='zia_phone'"+o+"' id='crmBtReminderCallMobile' lastUsedOrderId="+t+" onClick='crmBstTime.initCallfromReminder(1,this);sE(event);'><span class='offLab crm-font-regular'>"+$ESAPI.encoder().encodeForHTML(I18n.getMsg(l[o].displayName))+"</span><span class='offNo'>"+$ESAPI.encoder().encodeForHTML(l[o].number)+"</span></li>";n+="</ul></div>",n=Handlebars.compile(n),$("#diCallToolTip").length?$("#diCallToolTip").replaceWith(n):$("body").append(n)}$("#diCallToolTip").css({left:i,top:r}).show(),$(".diLaterTimeDiv").hide()},openEntityInNewWindow:function(e){var t=crmBstTime.reminderInformation[e].entity_detail;networkUtils.openUrl(Crm.getOrgSpecificURL(Crm.getCrmBasePath()+"/EntityInfo.do?module="+t.module+"&id="+t.seId))},hideRemoveNotification:function(e,t,a,i){delete crmBstTime.pushNotificationList["notificationTimeout"+e];var r=$(t),l=crmBstTime.reminderInformation[e].id;crmBstTime.reminderInformation[e]="",clearTimeout(crmBstTime.pushNotificationList["notificationTimeout"+e]),$(".diLaterTimeDiv, .dICallTimerDiv").hide();var n=r.parents(".popReminderFromBestTime"),s=n.length?n:r;crmBstTime.dismissNotification(s),s.remove();var o=$(".popReminderFromBestTime");($(".showMoreOpened").length||o.length<=2)&&crmBstTime.toShowAllNotification();var d=$(".diCrmBestTmeRepDiv"),c=d.scrollTop();if(d.scrollTop(c-95),thirdPartyUtils.unbindPerfectScroll(d),thirdPartyUtils.bindPerfectScroll(d,{suppressScrollX:!0}),crmBstTime.setToLocalStorage(l,void 0,"remove"),void 0===i){var m={nId:l,op:"dismiss",action:"ziaReminder"};crmBstTime.saveReminderSettings(m,void 0,!0)}var u=o.length;u?u<=3?($("#moreNotification").hide(),$(".toAvoidbord").hide(),d.hasClass("ps-container")&&thirdPartyUtils.unbindPerfectScroll(d)):$("#moreNotification").text(o.length-3+" "+I18n.getMsg("crm.label.More")):($("#reminderTopBand").hide(),d.remove(),crmBstTime.increment=0,crmBstTime.orderid=0,crmBstTime.notificationFlag=0,crmBstTime.reminderInformation={},crmBstTime.setToLocalStorage())},dismissNotification:function(e){var t=$(e),a=t.prev(".popReminderFromBestTime"),i=t.prev(),r=$(".toAvoidbord");if(a.length){var l=parseInt(i.css("top"))-parseInt(i.outerHeight());r.css({top:l+95}),a.css({top:l}),a.prev(".popReminderFromBestTime").length&&crmBstTime.dismissNotification(a)}else r.css({top:parseInt(r.css("top"))-95})},dismissAllNotification:function(){for(x in $(".diCrmBestTmeRepDiv").remove(),crmBstTime.increment=0,crmBstTime.orderid=0,crmBstTime.notificationFlag=0,crmBstTime.reminderInformation={},crmBstTime.pushNotificationList)clearTimeout(crmBstTime.pushNotificationList[x]);crmBstTime.setToLocalStorage(),crmBstTime.pushNotificationList={},$("#moreNotification").hide();crmBstTime.saveReminderSettings({nId:0,op:"dismiss",action:"ziaReminder"},void 0,!0)},openNotificationSettings:function(){networkUtils.openUrl(Crm.getOrgSpecificURL(Crm.getCrmBasePath()+"/ShowSetup.do?tab=general&subTab=ZiaSettings&action=remindersettings"))},openNotificationSettingsSameWindow:function(){Utils.windowLocationHref(Crm.getCrmBasePath()+"/ShowSetup.do?tab=general&subTab=ZiaSettings&action=remindersettings")},onNotificationSettingsChanged:function(e){var t=$(e),a=$("#reminderRadio");if(a.is(":checked")){var i=$("#ziaDeactivePopup"),r=t.parent("label");$("#ziaReminderSettings").removeClass("pR");var l=r.position().top+r.outerHeight()+7,n=r.position().left;Crm.userDetails.RTL_ENABLED&&(n-=r.outerWidth()+15),i.css({top:l,left:n}).addClass("scalePopOne"),freezeBackground(),i.show(),renderingUtils.stopEvent()}else{a.prop("checked",!0);crmBstTime.saveReminderSettings({op:"update",checked:!0,cvid:0,action:"ziaReminder"},"reload"),Crm.userDetails.isZiaReminderEnabled=!0}$(".reminderPauseDatesPopup").hide()},disableNotification:function(){var e=$("[id^=reminderRadio]");e.length&&(e.prop("checked",!1),e.parents(".dIViewListHolder").addClass("notifyDisabled")),$("#ziaReminderSettings").addClass("pR"),$("#ziaDeactivePopup").hide(),removeFreezeLayer();crmBstTime.saveReminderSettings({op:"update",checked:!1,cvid:0,action:"ziaReminder"}),Crm.userDetails.isZiaReminderEnabled=!1},onSettingsChanged:function(e,t){var a=$(e);a.is(":checked")?a.parents(".dIViewListHolder").removeClass("notifyDisabled"):a.parents(".dIViewListHolder").addClass("notifyDisabled");var i=e.id,r=!1;void 0!==t&&a.is(":checked")&&(i=i.slice(0,-2),$("#"+i).prop("checked",!0),r=!0);var l={op:"update",checked:r,cvid:e.getAttribute("cvid"),action:"ziaReminder"};crmBstTime.saveReminderSettings(l)},saveReminderSettings:function(e,t,a,i){var r=new crmRequestPool;e.userTZ=Crm.userDetails.USER_TIME_ZONE,e.crmcsrfparam=cookieUtils.getCookie("crmcsr"),r.initiate({action:Crm.getCrmBasePath()+"/ZiaReminderAction.do",type:"POST",data:e,success:function(e){if(void 0!==e&&""!==e){if(t)if(i)n(t,i);else{var l={isOrgConfig:!0,isRecommendation:!0};l.userTZ=Crm.userDetails.USER_TIME_ZONE,l.crmcsrfparam=cookieUtils.getCookie("crmcsr"),r.initiate({action:"/crm/v2/setup/zia/config",type:"GET",data:l,success:function(e){i=e.configs,n(t,i)}})}else n();function n(t,i){return t&&(e.configs=i,crmBstTime.renderReminderSettings(e)),void 0===a&&crmui.showMsgBand("success",I18n.getMsg("crm.best.time.zia.settings.updated"),1500),e}}},error:function(){void 0===a&&crmui.showMsgBand("failure",I18n.getMsg("crm.zia.config.not.saved"),1e3)}})},showZiaReminderSettingsforListView:function(e,t,a){var i=!!crmListView.getObject().doMassActioninScheduler&&crmListView.getObject().doMassActioninScheduler;Crm.client_tracking("BestTime - SetReminderClick",{Module:e}),"HomePage"!==e&&"Tasks"!==e&&"Events"!==e&&"Calls"!==e||(e="Activities");var r=!1;void 0===t&&(t=$(a).attr("cvid"),i=!0,r=!0),commonUtils.showHideLoadingDiv(!0);var l={operation:"getLCount",viewId:t,seModule:e,userTZ:Crm.userDetails.USER_TIME_ZONE,crmcsrfparam:cookieUtils.getCookie("crmcsr")};(new crmRequestPool).initiate({action:"/crm/di/ziaReminder",type:"POST",data:l,success:function(a){var l=a.layoutCount;if(!l)return;var n=l.layoutCount,s=!1;void 0!==l.nodata_records&&void 0!==l.beyond_businesshrs&&void 0!==l.new_records&&(s=!0);if(n>=5&&!s)crmBstTime.showLimitReachedWarning();else{freezeBackground();var o={};if(o.module=e,o.cvid=t.toString(),o.noData=l.nodata_records,o.businessHr=!!l.disableBusinessHr||l.beyond_businesshrs,o.newRecord=l.new_records,o.isMassUpdate=i,o.isUpdate=s,o.isHomePage=r,o.disableBusinessHr=l.disableBusinessHr,Handlebars.templates.ziaReminderSetup){var d=Handlebars.templates.ziaReminderListViewSetup(o);$("#topBandPopup").html(d).addClass("zcrm-show").show()}else networkUtils.loadFeatureScripts(["zohocrm_ziaReminderSetup.js"],(function(){var e=Handlebars.templates.ziaReminderListViewSetup(o);$("#topBandPopup").html(e).addClass("zcrm-show").show()}));commonUtils.showHideLoadingDiv()}},error:commonUtils.showHideLoadingDiv})},showLimitReachedWarning:function(){if(!$(".warningPopForlimitReached").length){var e="<div class='warningPopForlimitReached' data-zcqa='zia_limitReachWarning' id='warningPopForlimitReached'><span class='warningCont crm-font-regular fL pR pL20'>"+I18n.getMsg("crm.best.time.zia.layout.count.error")+"</span><div class='fL cB w100p pL20 mT20'><input type='button' style='font-size:14px !important;' class='primarybtn mR10' onclick=\"crmBstTime.openNotificationSettingsSameWindow();$('#warningPopForlimitReached').hide();removeFreezeLayer();\" value='"+I18n.getMsg("crm.best.time.zia.manage.reminders")+"'/> <input type='button' value='"+I18n.getMsg("Cancel")+"' class='cP crm-font-regular newwhitebtn' onclick=$('#warningPopForlimitReached').hide();removeFreezeLayer();commonUtils.showHideLoadingDiv();> </div></div>";$("body").append(Handlebars.compile(e))}var t=$("#warningPopForlimitReached"),a=$("#remindByZia");if(freezeBackground(),a.length){var i=a.offset().left+a.outerWidth()-t.outerWidth()/2-56,r=a.offset().top+a.outerHeight();t.removeClass("hideArrowTop"),t.css({left:i,top:r}).show()}else{var l=$("#tabLayer");r=l.offset().top+l.outerHeight(),i=mailsetCenter("warningPopForlimitReached \t");t.addClass("hideArrowTop"),t.css({top:r,"margin-top":"0"})}},scheduleListViewReminder:function(e,t,a,i){var r=null;if(!a&&"Activities"===e.moduleName&&Crm.isActivitySplitDone)if(e.moduleName!==Lyte.Router.getRouteInstance().parent.parent.getDynamicParam()){var l=Lyte.Router.getRouteInstance().parent.parent.getDynamicParam();r=crmTab.getFromCache(l).selectedIds}else r=crmTab.getFromCache(e.moduleName).selectedIds;else a||(r=crmTab.getFromCache(e.moduleName).selectedIds);var n={seId:a?0:r.join(";"),viewId:t,operation:"schedule",noBestTime:$("#noBestTimeCheck").is(":checked"),beyondBusinesHr:$("#businessHourCheck").is(":checked"),newRecord:$("#newRecordCheck").is(":checked"),seModule:e.moduleName,userTZ:Crm.userDetails.USER_TIME_ZONE,isMassJobScheduled:a},s=0;s=n.noBestTime?s+4:s,s=n.beyondBusinesHr?s+2:s,s=n.newRecord?s+1:s,Crm.client_tracking("BestTime - ListViewReminder",{Module:n.seModule,checkbox:s}),commonUtils.showHideLoadingDiv(!0),crmBstTime.sendBestTimeReminderRequest(n,"listView",i)},renderReminderSettings:function(e){var t={},a="hh:mm a"===Crm.userDetails.TIME_FORMAT;if(t.display=!1,e.configs){var i=e.configs[0].configs[0];i.category=e.configs[0].category,t.config=i}if(void 0!==e.notification){var r=e.reminderDetails,l={};if(t.display=!0,t.is12Hours=a,t.notification=e.notification,a?(t.startTime=crmBstTime.get12HourTimeFormat(e.pause_startTime),t.endTime=crmBstTime.get12HourTimeFormat(e.pause_endTime)):(t.startTime=e.pause_startTime,t.endTime=e.pause_endTime),t.pauseStatus=e.pause_status,t.reminderSettings=l,void 0!==r){if(void 0!==r.Leads&&r.Leads.length>0){var n=void 0!==Crm.moduleInfo.Leads?Crm.moduleInfo.Leads.translatedPluralLabel:"Leads";l.lead={name:n,value:r.Leads,id:0}}if(void 0!==r.Contacts&&r.Contacts.length>0){var s=void 0!==Crm.moduleInfo.Contacts?Crm.moduleInfo.Contacts.translatedPluralLabel:"Contacts";l.contact={name:s,value:r.Contacts,id:1}}if(void 0!==r.Activities&&r.Activities.length>0){var o=void 0!==Crm.moduleInfo.Activities?Crm.moduleInfo.Activities.translatedPluralLabel:"Activities";l.Activity={name:o,value:r.Activities,id:2}}}var d=[];void 0!==e.pause_days&&(d=e.pause_days.split(",")),t.daysList=[];for(var c=1,m=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],u=0;u<7;u++){var p={value:c,checked:d[u],day:I18n.getMsg(m[u])};c+=c,t.daysList.push(p)}}Handlebars.templates.ziaReminderSetup?crmBstTime.showZiaReminderSettings(t):networkUtils.loadFeatureScripts(["zohocrm_ziaReminderSetup.js"],(function(){crmBstTime.showZiaReminderSettings(t)}))},showZiaReminderSettings:function(e){$("#overlayHeader,#settingInner").hide();var t=$("#result"),a=Handlebars.templates.ziaReminderSetup(e);t.html(a),t.show(),crmBstTime.onZiaSetupDaySelect(!0),crmLayout.Resize.Setup(),$("[data-fieldtype=timeField]").each((function(e,t){t.value=$(this).val(),crmTemplate.bindEventsToTimeField.call(t,crmBstTime.onZiaPauseTimeChanged)})),$("#ziaPauseEndTime").click((function(){$("#ziaPauseStartTime_List").hide();var e=$("#ziaPauseStartTime").val(),t=$("#ziaPauseEndTime_List li");t.hide(),crmBstTime.ziapauseInc=1,crmBstTime.ziapauseFlag=0,t.each((function(){$(this).text().trim()==e&&($(this).hide(),crmBstTime.ziapauseFlag=1),1==crmBstTime.ziapauseFlag&&($(this).text().trim()==e?$(this).hide():$(this).show(),crmBstTime.ziapauseInc=crmBstTime.ziapauseInc+1,crmBstTime.ziapauseInc>=12&&(crmBstTime.ziapauseFlag=0))})),$(".timeList").perfectScrollbar("update")})),$("#ziaPauseStartTime").click((function(){$("#ziaPauseEndTime_List").hide(),$("#ziaPauseStartTime_List ziaPauseStartTime_SCROLLDIV").find("li").last().hide()})),$("#setupshow,#mainResult").show(),crmSetup.SetHeight_setup_inner_content(),crmBstTime.setWidthForListSpan()},onDeleteReminderEntry:function(e){var t={op:"remove",cvid:e.getAttribute("cvid"),action:"ziaReminder"};$(e).parents(".dIViewListHolder").slideUp(200,(function(){crmBstTime.saveReminderSettings(t,"reload")}))},onZiaSetupDaySelect:function(e){var t=0,a=[],i=[0,0,0,0,0,0,0],r=void 0;if($("#ziaDaysList .p0").each((function(e){if($(this).find("input:checkbox").is(":checked")){var r=$(this);t+=parseInt(r.find("label").attr("value")),i[e]=1,a.push(I18n.getMsg(crmBstTime.daysShortForm[e]))}})),r=127===t?I18n.getMsg("day"):31===t||63===t?I18n.getMsg("crm.best.time.weekdays"):96===t?I18n.getMsg("crm.best.time.weekends"):a.join(", "),$("#ziaPauseDayText").text(r),void 0===e){var l={op:"pauseSetup",daysList:i.join(),action:"ziaReminder"};crmBstTime.saveReminderSettings(l,void 0,!0),crmBstTime.setWidthForListSpan()}},onZiaPauseTimeChanged:function(){var e="hh:mm a"===Crm.userDetails.TIME_FORMAT,t="",a=$("#ziaPauseEndTime"),i=crmBstTime.getDateObject($("#ziaPauseStartTime").val()),r=crmBstTime.getDateObject(a.val()),l=(r-i)/36e5;if(l<=6&&l>0)t=crmBstTime.getFormattedTime(!1,i,!1)+","+crmBstTime.getFormattedTime(!1,r,!1);else if(l<=0)crmui.showMsgBand("error",I18n.getMsg("crm.start.before.end.time"),4e3);else{var n=new Date(i.getTime()+18e5);a.val(crmBstTime.getFormattedTime(e,n)),t=crmBstTime.getFormattedTime(!1,i,!1)+","+crmBstTime.getFormattedTime(!1,n,!1)}if(""!==t){var s={op:"pauseSetup",fromToTime:t,action:"ziaReminder"};crmBstTime.saveReminderSettings(s,void 0,!0)}crmBstTime.setWidthForReminderInput()},showRemDaysList:function(e){var t=$(e),a=t.position().left-15,i=t.position().top+t.outerHeight()+3;$(".reminderPauseDatesPopup").css({left:a,top:i}).show()},setWidthForListSpan:function(){var e=0;crmBstTime.setWidthForReminderInput();var t=$("#ziaReminderSettings .indsubSpan");t.css({width:"auto"}),t.each((function(){$(this).outerWidth()>e&&(e=$(this).outerWidth())})),t.css({width:e+30}),crmLayout.Resize.Setup(),$("#setup_new_ContentDiv").addClass("oA")},setWidthForReminderInput:function(){var e=$("#ziaPauseStartTime"),t=$("#ziaPauseEndTime"),a=e.val(),i=t.val(),r=renderingUtils.createHTML({name:"div",attr:{class:"dIstartTimeEndTime"}});$("body").append(r);var l=$(".dIstartTimeEndTime"),n=l.text(a).outerWidth(),s=l.text(i).outerWidth();e.css({width:n}),t.css({width:s}),l.remove()},checkZiaPendingReminder:function(){var e=crmBstTime.getFromLocalStorage(),t=[];for(var a in e){var i=e[a],r=Object.keys(i),l=i[r].split(":"),n={notificationId:a,time:l[0],seId:r[0],viewId:l[1]};t.push(n)}if(Object.keys(e).length>0&&history.length>1){var s={operation:"restore",restoreList:JSON.stringify(t),viewId:0};crmBstTime.sendBestTimeReminderRequest(s,"restore")}},getFormattedTime:function(e,t,a){var i=t.getHours(),r=t.getMinutes(),l="";if(e){l="AM";0===i?i=12:12===i?l="PM":i>12&&(i-=12,l="PM")}return i<10&&(i="0"+i),r<10&&(r="0"+r),l=a?l:I18n.getMsg(l),e?i+":"+r+" "+l:i+":"+r},constructDateObject:function(e,t){return e?CrmDateUtils.getDateObjectFromString(e,t):new Date(e)},sleep:function(e){var t=new Date,a=null;do{a=new Date}while(a-t<e)},getMonthName:function(e){return crmBstTime.months[e.getMonth()]},getDayName:function(e){return crmBstTime.days[e.getDay()]},getDateObject:function(e,t){var a=void 0===t?e.match(new RegExp("(\\d+):(\\d+) ?("+I18n.getMsg("AM")+"|"+I18n.getMsg("PM")+"|)")):e.match(new RegExp("(\\d+):(\\d+) ?(AM|PM|)")),i=new Date;return i.setSeconds(0,0),"PM"===a[3]||I18n.getMsg("PM")===a[3]?"12"!==a[1]?i.setHours(12+parseInt(a[1])):i.setHours(12):"AM"!==a[3]&&I18n.getMsg("AM")!==a[3]||"12"!==a[1]?i.setHours(a[1]):i.setHours(0),i.setMinutes(a[2]),i},get12HourTimeFormat:function(e){var t=e.split(":"),a=t[0],i=t[1],r="AM";return 0==a?a=12:12==a?r="PM":a>12&&(a-=12,r="PM"),a<10&&1===a.toString.length&&(a="0"+a),a+":"+i+" "+(r=I18n.getMsg(r))},getFromLocalStorage:function(){var e=localStorage.getItem("ZiaReminder");return e=null===e?"{}":e,JSON.parse(e)},setToLocalStorage:function(e,t,a){var i={};"add"===a?(i=crmBstTime.getFromLocalStorage())[e+""]=t:"remove"===a&&delete(i=crmBstTime.getFromLocalStorage())[e+""],localStorage.setItem("ZiaReminder",JSON.stringify(i))},getSuggestedCallStartTimeArray:function(e,t,a){return Crm.userDetails.isBestTimeEnabledCall?store.findAll("besttime_zia",{id:e,module:t,type:"Call",reqDate:a}).then((function(e){var t=e.bestTime_call,a={};return t&&t.forEach((function(e){if(e.level&&e.bestTime){var t="lev"+e.level;a[e.bestTime]=t}})),a})).catch((function(){return{}})):new Promise((function(e){e({})}))}};