var taskKanbanViewCache="",mySetupArray=[],permissionDenied=!1,CScriptLib="undefined"!=typeof CScript,CScriptComp=!1,isLyteViewPortEnabled=!0,Crm={getCrmBasePath:function(){return"undefined"!=typeof crmBasePath&&crmBasePath?crmBasePath:"/crm"},getHelpUrl:function(e){return crmConstants.helpUrl["help.domain.url"]+crmConstants.helpUrl[e]},isWorkflowSuggestionEnabled:!0,isRestrictionEnabled:!0,threshold:{configCount:{}},getRouteObject:function(e){var t=Object.assign({},e.info);return t.data=e.data,t},csrfcookiename:"crmcsr",newHistoryArr:[],moduleName:"",moreFldNameVsValue:{},currentPageData:{},isRecordModified:!1,isFieldsJSLoaded:!1,isModulesJSLoaded:!1,isVertical:!1,Vertical:{appName:"",appDomain:"",zaid:""},formCounter:0,jsonDepValues:{},jsonSelectValues:{},jsonDepValues_Quick:{},jsonSelectValues_Quick:{},lookupFilterObj:{},latestEntId:void 0,LOG:{},CURRENT_REQUEST:{},trackSpotLightAction:function(e,t,r){try{if(e&&$zoho.spotlight){if(!t)t={};if(!r)r=function(){};return t.Plan=Crm.userDetails.EDITION_NAME,void $zoho.spotlight.track(e,t,r)}r&&r()}catch(e){}},moduleInfo:void 0,selectedModule:void 0,userDetails:void 0,isNewEditor:!1,fieldDependency:[],isPageLoad:!1,REQUEST_QUEUE:{},userDetails:{},userBusinessCard:{},requestParam:{},fieldsObj:{},currencyFields:{},origin:"",editReqFrom:"listView",approvalActions:{},canvasTab:{},defaultObj:["Crm","crmTab","crmSetup","crmReports","CrmDashboard","crmListView","crmTemplate","crmEmailStats","CML","CMB","Macro","crmRelatedList","migrate","CVRCust","CAECust"],clickEventIdVsMethodMapping:{refreshRoute:"Crm.refreshRoute",deleteEntity:"Crm.deleteEntity",backOneLevel:"crmHistory.backOneLevel",backToListView:"crmHistory.backToListView",back:"crmHistory.back",GlobalSearch:"ajaxGSearch",editbtn:"Crm.editEntity",clonebtn:"Crm.cloneEntity",detailView:"Crm.lyteTransition",NavPrevious:"crmNavig.navigateRecord",NavNext:"crmNavig.navigateRecord",tkvshowmore:"Crm.taskKanbanViewShowMore",kanbanviewentity:"Crm.lyteTransition",apprDetailView:"Crm.lyteTransition",ReportRelCV:"CrmDashboard.getMoreReportsRecords",slackshare:"Crm.loadChatIntegrations",cliqshare:"Crm.loadChatIntegrations",ciscoteamsshare:"Crm.loadChatIntegrations"},initApprovalActions:function(){Crm.approvalActions={WebToContactApproval:Crm.getCrmBasePath()+"/WebContactApproval.do?mod=true",WebToCaseApproval:Crm.getCrmBasePath()+"/WebCaseApproval.do?mod=true",WebToLeadApproval:Crm.getCrmBasePath()+"/WebLeadApproval.do?mod=true&actionName=0&showDuplicates=0",WebRecordApproval:Crm.getCrmBasePath()+"/WebRecordApproval.do?mod=true&actionName=0&showDuplicates=0"}},taskKanbanViewShowMore:function(e,t){var r={};t&&(r=JSON.parse($(t).attr("data-params")));var a=$("#"+r.kvmodule+"_startindex").val();r.startindex=a,r.columntype=r.kvmodule,(new crmRequestPool).initiate({action:Crm.getCrmBasePath()+"/ShowDetails.do",data:r,success:function(e){crmListView.kanbanView(e),init(r,"kanbanview")}})},goToKanbanViewEntity:function(e,t,r){if(document,getElemById("cvEditSave")&&document,"none"===getElemById("cvEditSave").style.display||iskvFollowupTask){t&&(params=JSON.parse($(t).attr("data-params")));var a=$(t).attr("id");if(!r&&TaskKanbanView.kvrecordid===a)return;loadActivityDetails(e,t,params,params.id),TaskKanbanView.kvrecordid=a,iskvFollowupTask=!1}else showConfirmBox(t)},activityGrp:{Tasks:"Activities",Events:"Activities",Calls:"Activities",Activities:"Activities"},deleteEntity:function(e,t,r){var a=r||JSON.parse($(t).attr("data-params"));"Contacts"!==a.module&&"Accounts"!==a.module||!(null!=customViewObject&&null!=customViewObject.isZBCustomModuleEnabled?customViewObject.isZBCustomModuleEnabled:zbCustomModuleObjForAccountContactDeletion.isZBCustomModuleEnabled)?Crm.deleteEntity_new(e,t,a):ZInvoice.getAlertContentOnContactDelete(e,t,a)},deleteEntity_new:function(e,t,r){renderingUtils.stopEvent(e);r=r||JSON.parse($(t).attr("data-params"));if($(t).hasClass("fromDeletePopup"))if("undefined"!=typeof CAEExec&&CAEExec.init(),"true"!==$("#iskanbanview").val()||"Tasks"==r.module){if(commonUtils.showHideLoadingDiv(!0),r){var a=0;if("calendar"!==r.from)a=parseInt(document.getElementById("recordNum").value);var i=Crm.getCrmBasePath()+"/MassDelete.do?module="+r.module+"&id="+r.id;r[csrfParamName]=csrfToken,paramcsrf=csrfParamName+"="+encodeURIComponent(csrfToken);var n=paramcsrf+"&recordNum="+a+"&isajax=true";"Events"!==r.module&&"Tasks"!==r.module||(n+="&delOpt="+r.delOpt+"&from="+r.from);var o=crmHistory.getState(),s=o.data?o.data.pfrom:"",l=r.id,c=r.module,d=r.delOpt,u=r.dateval,m="Activities"!==Crm.activityGrp[c]||Crm.isActivitySplitDone?c:"Activities",p=void 0;(new crmRequestPool).initiate({type:"POST",url:i,data:n,success:function(e){commonUtils.showHideLoadingDiv(),hideAnimatePopup("deletepopup"),"undefined"!=typeof EmailComposeUtil&&EmailComposeUtil&&EmailComposeUtil.removeDraftDOMElement();var t=e.orchestration_used;if(t)Crm.showOrchUsedDenyPopUp(t);else{$("#rItemDataDiv").find("#recentItemImg_"+l).remove(),0===$("#rItemDataSubDiv").find("a").length&&$("#rItemDataSubDiv").find("td").append('<div id="recentitems_empty_msg">'+I18n.getMsg("crm.msg.recentitems.empty")+"</div>");var r=$("#ajax_"+c);if(r.find("#"+c+"_"+l).remove(),r.find("[id^="+c+"_]").length||r.remove(),renderingUtils.removeDummyBackground(),"calendar"===e.from){if(calView.isMultiUserView)"dayview"===calView.currCalView?Events.handleEvtDelinMulUserDayView(l):"weekview"===calView.currCalView?Events.handleEvtDelinMulUserWeekView(l):Events.handleEvtDelinMulUserMonthView(l),"upcomingEv"==d&&(calView.needRefresh=!0);else{if("upcomingEv"===d)$("#moreEventsAllDiv").is(":visible")||(calView.needRefresh=!0);else if($("#calendarBd").fullCalendar("removeEvents",l),"monthview"===calView.currCalView)Events.eventsCntDatewise[u]>5&&!$("#moreEventsAllDiv").is(":visible")&&(calView.needRefresh=!0);if($("#moreEventsAllDiv").is(":visible"))$("#moreEvent_"+l).remove(),PopSetCenter("moreEventsAllDiv"),$("#moreEventsAllDiv").find(".moreEvInner p").length<=0&&Events.closeMoreEventDiv()}return calView.needRefresh&&calView.refresh(),Events.closeQuickView(),!0}if(crmTab.deleteFromCache(m),"object"==typeof e&&(p=e),p&&p.CannotDelete){var i='<div onclick="sE()" class="w500 p20"><div class="floatL pL20 w430"><div class="f20"><h2 style="color:#E20000";>'+I18n.getMsg(p.CannotDelete[0])+'</h2></div><div class="mT10">'+I18n.getMsg(p.CannotDelete[1])+'</div></div><br class="clearB"><div  class="alignright mT20"><input type="button" id="popupok" class="primarybtn" value="'+I18n.getMsg("crm.button.ok")+"\" onclick=\"hide('popupnew');removeFreezeLayer();document.getElementById('popupnew').style.zIndex=30\"></div></div>";renderingUtils.popUpWithFreeze(i)}else if("upcomingEv"!==d&&crmNavig[crmNavig.customViewKey]&&"rel"!==s&&a){"Activities"===Crm.activityGrp[m]&&updateRecordNumParam(l),crmNavig[crmNavig.customViewKey].recordId[a]&&$("#detailView_"+crmNavig[crmNavig.customViewKey].recordId[a].id).remove(),crmNavig[crmNavig.customViewKey].recordId.splice(a,1);var n=$("#detailCView").children().length;if(n>0&&n<10){$("#taskMenuBlkdiv").css("min-height","0").css("height","auto");var o=parseInt(getObj("cvFromIndex").value);$("#from_To").text(o+" - "+(o+n-1))}var g=history.state.data;g.fromDel="true",g.clickId="NavNext",g.module=c;var h=$("#cvToIndex");if("Activities"===Crm.activityGrp[m]&&h.length){var f=parseInt(h.val())-1;h.val(f),$("input[name=toIndex]").val(f)}crmNavig.navigateRecord(void 0,void 0,g)}else"rel"==s?$(".selectedRightActivity").next()[0]?$(".selectedRightActivity").next().children()[0].click?$(".selectedRightActivity").next().children()[0].click():$(".selectedRightActivity").next().children().trigger("click"):$(".selectedRightActivity").prev()[0]?$(".selectedRightActivity").prev().children()[0].click?$(".selectedRightActivity").prev().children()[0].click():$(".selectedRightActivity").prev().children().trigger("click"):crmHistory.backOneLevel():crmHistory.backOneLevel()}},error:function(e){var t='<div onclick=/"sE()" class="w500 p20"><div class="floatL pL20 w430"><div class="f20"><h2 style="color:#E20000";>'+I18n.getMsg("crm.delete.error")+'</h2></div><div class="mT10">'+I18n.getMsg("crm.record.delete.message",[Crm.getCrmBasePath()])+'</div></div><br class="clearB"><div  class="alignright mT20"><input type="button" id="popupok" class="primarybtn" value="'+I18n.getMsg("crm.button.ok")+"\" onclick=\"hide('popupnew');removeFreezeLayer();document.getElementById('popupnew').style.zIndex=30\"></div></div>";e&&401!=e.status&&(renderingUtils.popUpWithFreeze(t),commonUtils.showHideLoadingDiv())}})}}else TaskKanbanView.deleteEntity(r.module,r.id);else{var g=[],h="Events"===r.module?$("#entityNameInBCView").text():$("#entityName").val();"Calls"===r.module&&isNewCallView&&(h=$("#callsdp_subject").val()||h),h=h&&h.length>45?h.substring(0,35)+"...":h,g.push(h);var f=I18n.getMsg("crm.warning.delete.record",g),v=isRelatedRecordsModule(r.module)?I18n.getMsg("crm.warning.related.modules",getAllRelatedChildModulesPluralLabel(r.module)):"";"Events"===r.module?Events.valDeleteEvent(r.id,"detailView"===r.from,r.delopt,f,t):"Tasks"===r.module?crmTasks.confirmDeleteTask(r.id,"detailView"==r.from,r.delopt,f,t):showDeletePopup(f,"crm.button.delete","",v,t)}},clickHandler:function(e,t,r){var a=r;if("customize_modules_validationRules"!=a&&"ShowValidationRule"!=a&&"undefined"!=typeof CVRCust&&CVRCust.init(),this.clickEventIdVsMethodMapping[a]){"undefined"!=typeof CAEExec&&CAEExec.init();var i=$(t).attr("data-params");return i||(i={}),"string"==typeof i&&(i=JSON.parse(i)),i.calleeObj=i.calleeObj||"Crm",i.clickId=a,$(t).attr("data-params",JSON.stringify(i)),Lyte.registeredMixins["crm-utilities"].executeFunctionByName(this.clickEventIdVsMethodMapping[a],window,e,t),!1}return!0},addRecentItems:function(e,t){var r=$("#entityName"),a=$("#entityNameInBCView");if((r.length>0||a.length>0)&&"undefined"!=typeof CrmPlusLib&&CrmPlusLib.isLoadedInCrmplusFrame){var i={Type:"RecentItems",DisplayName:"Events"===t?a.text().trim():r.val(),ClickAction:"crm/EntityInfo.do?module="+t+"&id="+e,Module:moduleRecordMapping[t].singular_label};CrmPlusLib.addRecord(i)}},showAlertMsg:function(e,t){if($("#crmEmailOuterContainerDiv").is(":visible")||$("#ewfAdminWF").is(":visible")){var r=$("#emailAlertMsgContainer");r.find(".infoCont").text(e),r.find(".confirm").click((function(){Crm.hideAlertMsg((function(){t&&$(t).focus()}))})),r.show(),r.find(".confirm").focus(),mailsetCenter(r.attr("id")),r.css("top","200px")}else alert(e),t&&$(t).focus()},hideAlertMsg:function(e){$("#emailAlertMsgContainer").hide(),e&&e()},showOrchUsedDenyPopUp:function(e,t){commonUtils.showHideLoadingDiv();var r=$("#customConfirmationPop");r.html(Handlebars.templates.deleteFieldWarningPopup()),r.css("visibility","visible"),renderAutomationDenyPopComp(e,void 0,void 0,"#automationdiv"),t?($("#delfldhd").html(I18n.getMsg("crm.automation.cannot.deactivate.delete.text")),$("#deleteInfo1").html(I18n.getMsg("crm.ap.journey.deactivate.delete.info")),$L("#btnskip").hide()):($("#delfldhd").html(I18n.getMsg("crm.automation.cannot.delete.text",[I18n.getMsg("Campaign")])),$("#deleteInfo1").html(I18n.getMsg("crm.ap.webform.delete.info",[I18n.getMsg("Campaign")]))),crmui.showPopup("deletefield")},showOrchUsedBUlkDenyPopUp:function(e,t){var r;commonUtils.showHideLoadingDiv(),hideAnimatePopup("deletepopup");var a=[],i=[],n={Transition:[]};if(t){var o=$("#massResult");if(!((r=document.TransferWizardForm.chk)instanceof NodeList)){var s=[];s.push(r),r=s}}for(var l in e.Orchestration)n.Transition=n.Transition.concat(e.Orchestration[l].Transition),delete e.Orchestration[l],t?r.forEach((function(e){e.value==l&&(a.push(o.find("#"+l+" :nth-child(2)")[1].innerText),i.push(l))})):crmListView.getObject().body.forEach((function(e){e.id==l&&(a.push(e.Campaign_Name),i.push(l))}));e.Orchestration.transitions=n,renderingUtils.popUpWithFreeze(Handlebars.templates.deleteFieldWarningPopup()),renderAutomationDenyPopComp(e,void 0,void 0,"#automationdiv"),$("#delfldhd").html(I18n.getMsg("crm.automation.cannot.delete.text",[I18n.getMsg("crm.campaign.few")])),$("#deleteInfo1").html(I18n.getMsg("crm.campaign.delete.bulk",$ESAPI.encoder().encodeForHTML(a.join(", ")))),$("#deleteInfo2").html(I18n.getMsg("orch.bulk.delete.denypop")),$("#popupnew").css("position","fixed"),t||(crmListView.getObject().selectedIds=crmListView.getObject().selectedIds.filter((function(e){return!i.includes(e)})));var c=$("#btnclos");if(t&&r.length!=i.length||!t&&crmListView.getObject().selectedIds.length>0){c.hide();var d=$("#btnskip"),u=$("#btncancel");u.show(),d.show(),u.click((function(){t?Crm.clearMassDelSelection():clearSelection()})),d.click((function(){Crm.skipAndProceed(i,t)}))}else c.click((function(){t?Crm.clearMassDelSelection():clearSelection()}));crmui.showPopup("deletefield")},clearMassDelSelection:function(e){try{document.TransferWizardForm.chk.forEach((function(t){e?e.includes(t.value)&&(t.checked=!1):t.checked=!1}))}catch(e){document.TransferWizardForm.chk.checked=!1,document.TransferWizardForm.allcheck.checked=!1}document.TransferWizardForm.allcheck.checked=!1},skipAndProceed:function(e,t){crmui.hidePopup("deletefield"),t?(Crm.clearMassDelSelection(e),massActionWizard("massdelete","MassDelete","&target=MassRecords")):massActionDelete("massdelete","MassDelete",""),commonUtils.showHideLoadingDiv()},scrollPage:function(){if(Crm.scrollToElem){"tasks"!=Crm.scrollToElem&&"events"!=Crm.scrollToElem&&"calls"!=Crm.scrollToElem||(Crm.scrollToElem="activity");var e=$("[id^='"+Crm.scrollToElem+"']")[0];showDrillDownPtr($(e).attr("name"))}Crm.scrollToElem=void 0},loadDefaultConstants:function(){crmConstants.fullDaysArray=[{html:I18n.getMsg("Sunday"),value:"1"},{html:I18n.getMsg("Monday"),value:"2"},{html:I18n.getMsg("Tuesday"),value:"3"},{html:I18n.getMsg("Wednesday"),value:"4"},{html:I18n.getMsg("Thursday"),value:"5"},{html:I18n.getMsg("Friday"),value:"6"},{html:I18n.getMsg("Saturday"),value:"7"}]},sameModuleExlude:{convert:!0,editbtn:!0,createbtn:!0,clonebtn:!0,showMacro:!0,macrobtn:!0},toolTipObj:{usersPermi_assignTerritory:"crm.territory.title.assign.territories",GlobalSearch:"crm.label.search.result",GlobalSearch1:"crm.label.search.result",massTransfer:"crm.permission.mass.transfer.CustomModule",WebToLeadApproval:"crm.title.web.lead.approval",WebToContactApproval:"crm.title.web.lead.approval",WebToCaseApproval:"crm.title.web.lead.approval",massDelete:"crm.permission.mass.delete.CustomModule",massEmail:"crm.permission.mass.email.leads",massUpdate:"crm.permission.mass.update.CustomModule"},errorMsgArray:{default:{mandate:"crm.field.empty.check",maxLen:"crm.field.length.check",maxLimit:"crm.field.limit.check",mxncloneproceed:"",type:{integer:"crm.field.valid.check",String:"Only String allowed",decimal:"crm.field.valid.decimal.check2"}}},logDetails:"",pushForStats:function(e,t){0===this.logDetails.length&&(this.timerInterval=setTimeout((function(){0!==Crm.logDetails.length&&($.ajax({url:Crm.getCrmBasePath()+"/BlankRequest.do",type:"POST",data:{data:Crm.logDetails},success:function(){}}),Crm.logDetails="")}),3e3)),this.logDetails+=e+":"+t+","},registerAjaxSendForOrgHeader:function(){$(document).ajaxSend((function(e,t,r){t.requestUrl=r.url;var a=-1!=t.requestUrl.indexOf("sandbox/diff")||-1!=t.requestUrl.indexOf("production/diff");r.crossDomain||"undefined"==typeof crmZgid||!crmZgid||a||t.setRequestHeader("X-CRM-ORG",crmZgid)}))},init:function(e,t,r,a,i){Crm.registerAjaxSendForOrgHeader(),moduleApiMapping={},idModuleMapping={},moduleRecordMapping={},registeredEntity=[],store.pushPayload("module",moduleDetailedInfo.modules,!0),userInfo&&store.pushPayload("user",userInfo.users),store.pushPayload("tab_group",tabInfo.tab_groups),app.newSubVersion=crmConstants.subVersion,app.historyLength=1;var n,o=crmHistory.getNewURL(document.location.href);history.replaceState(history.state,document.title,o),50==history.length&&(history.length=1),e.RTL_ENABLED&&(crmConstants.lessStaticPathForLyte="/crm/CRMClient/css/compiled-css/default/rtl/"),Crm.userDetails.MEETING_BRIDGE_ENABLED&&Events.loadMeetingbridge(),networkUtils.checkscriptSource(),Crm.initialHistoryIndex=window.history.length,Lyte.Router.init(),(cookieUtils.getCookie("crmtrialEnabed")||cookieUtils.getCookie("crmtrialEnabedFrmSetup"))&&setTimeout((function(){if(cookieUtils.getCookie("crmtrialEnabedFrmSetup")){var e=Handlebars.templates.TrialSuccessThroSetup();$("#HigherEdnTrialSuccessDiv").html(e),mailsetCenter("HigherEdnTrialSuccessDiv"),freezeBackground(),cookieUtils.deleteCookie("crmtrialEnabedFrmSetup","/")}else{var t=I18n.getMsg("crm.trial.success.display.message",I18n.getMsg(Crm.userDetails.TRAIL_TYPE));crmui.showMsgBand("success",t,5e3),cookieUtils.deleteCookie("crmtrialEnabed","/")}}),500),cookieUtils.getCookie("crmtrialCancelled")&&setTimeout((function(){var e=I18n.getMsg("crm.trial.cancelled.display.message",I18n.getMsg(Crm.userDetails.LICENSE_TYPE_ACTUAL_NAME));crmui.showMsgBand("success",e,5e3),cookieUtils.deleteCookie("crmtrialCancelled","/")}),500),RebrandLinkUtil.setProperties(i),this.registerPartials();try{crmReports.init&&"function"==typeof crmReports.init&&(crmReports.exportReports=crmReports.exportReports+"_"+e.USER_ID,crmReports.init())}catch(e){}try{networkUtils.loadFeatureScripts(["zohocrm_crmExportWMSMsg.js"],(function(){crmExportWMSMsg.init&&"function"==typeof crmExportWMSMsg.init&&(crmExportWMSMsg.export=crmExportWMSMsg.export+"_"+e.USER_ID,crmExportWMSMsg.init())}),!0),networkUtils.loadFeatureScripts(["zohocrm_wmsbar.js"],void 0,!0)}catch(e){}if("Mozilla"!==$L.userAgent.browser&&"Firefox"!==$L.userAgent.browser||(document.addEventListener("click",(function(e){window.event=e}),!0),document.addEventListener("mouseenter",(function(e){window.event=e}),!0),Events.reminderNotificationImgUrl=networkUtils.getImageUrl("event_reminder_feed_firefox_e346c5c_.png",ResourceConstants.CRM)),$(document).on("dialogopen",(function(e,t){$(".ui-widget-overlay").css("position","fixed"),$(".ui-widget-overlay").css("z-index","26"),$(".ui-dialog").css("z-index","27")})),$.ajaxPrefilter((function(e,t,r){"script"!=e.dataType&&"script"!=t.dataType||(e.cache=!0),r.always((function(e,t,r){"abort"!==t&&delete Crm.REQUEST_QUEUE[this.url+"---"+this.data]}))})),$(document).keyup((function(e){var t=e.target?e.target:e.srcElement,r=$(t).attr("data-kpid");if(r){var a=$(t).attr("data-params");a&&(a=JSON.parse(a)),"true"==a.multiSel&&"countryAutoSuggest"==r?$(t).autocomplete({minLength:2,source:function(e,t){var r=new RegExp("^"+$.ui.autocomplete.escapeRegex(e.term.extractLast()),"i");t($.grep(I18n.properties.COUNTRY_LIST2,(function(e){return r.test(e)})))},search:function(e,t){$(this).data("ui-autocomplete").menu.bindings=$()},focus:function(){return!1},select:function(e,t){var r=split(this.value);return r.pop(),r.push(t.item.value),r.push(""),this.value=r.join(", "),!1}}):$(t).autocomplete({minLength:2,source:function(e,t){var r=new RegExp("^"+$.ui.autocomplete.escapeRegex(e.term.extractLast()),"i");t($.grep(I18n.properties.COUNTRY_LIST2,(function(e){return r.test(e)})))},search:function(e,t){$(this).data("ui-autocomplete").menu.bindings=$()}})}var i=void 0;if($("#deletepopup:visible").hasClass("zcrm-show"))var n=(i=$("#deletepopup")).find("#deleteButton:visible");else if($("#WarningdivWebForm:visible").hasClass("zcrm-show"))n=(i=$("#WarningdivWebForm")).find("#webform_del_button:visible");else if($("#statusWarningdiv:visible").hasClass("zcrm-show"))n=(i=$("#statusWarningdiv")).find("#deactiveBtnId:visible").length?i.find("#deactiveBtnId:visible"):i.find("#activeBtnId:visible");else if($("#custom_alert_popup:visible").hasClass("zcrm-show"))n=(i=$("#custom_alert_popup")).find("#custom_alert_button:visible");if(i){var o=e.keyCode;27==o?hideAnimatePopup(i.attr("id")):13==o&&n.length&&n[0].click()}if("Contacts"===Crm.moduleName&&"Crm_Contacts_ACCOUNTID"===e.target.id&&"ACCOUNTID"===e.target.dataset.colname){var s=$("#Crm_Contacts_ACCOUNTID"),l=$("#Contacts_fldRow_REPORTINGTOCONTACTID"),c=$("#Crm_Contacts_REPORTINGTOCONTACTID"),d=void 0!==Crm.moduleInfo.Accounts?Crm.moduleInfo.Accounts.translatedSingularLabel:"Account",u=I18n.getMsg("crm.contact.hierarchy.Specify_account_name",[I18n.getMsg(d)]);s.val().length>0?(c.prop("disabled",!1),c.autocomplete("enable"),l.removeClass("noclick"),l.unbind("mouseover"),l.unbind("mouseout"),l.removeAttr("onmouseenter onmouseleave")):0==s.val().length&&(c.val(""),c.prop("disabled",!0),c.autocomplete("disable"),l.attr({class:"REPORTINGTOCONTACTID tabDivCreate noclick"},{onmouseenter:"zctt.showtt('"+u+"');"},{onmouseleave:"zctt.hidett();"}))}onkeydown=function(e){if(!e.metaKey){window.location;if(32==(e=e||event).keyCode&&"keydown"==e.type&&e.altKey&&document.getElementById("topbandSearchIcon").click(),27==e.keyCode){$("#gsearchTextBox").blur(),$(".searchTopband .adSearchCloses span").click();var t=document.querySelector("crm-p2p-referral");t&&!1===t.component.data.showReferralPanel&&$("body").click()}}},27==e.keyCode&&$(".commonDrop").addClass("hide")})),$(document).mousedown((function(e){0!=window.getSelection().isCollapsed||e.shiftKey||3==e.which||(window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges?window.getSelection().removeAllRanges():document.selection&&document.selection.empty())})),this.bindDocumentEvents(),$(window).resize((function(e){clearTimeout(n),n=setTimeout((function(){app.windowRect.innerWidth=window.innerWidth,app.windowRect.innerHeight=window.innerHeight,app.windowRect.outerWidth=window.outerWidth,app.windowRect.outerHeight=window.outerHeight,$("body, html").css("overflow","hidden"),$("body, html").css("overflow",""),crmLayout.Resize.All(),Lyte.triggerEvent("windowResize",{id:"WINDOWRESIZE",event:e})}),200)})),$(document).ajaxSend((function(e,t,r){var a,i;if(t.requestUrl=r.url,a=r.url,(i=document.createElement("a")).href=a,i.hostname==location.hostname&&r.data&&("string"==typeof r.data?r.data=function(e){for(var t=csrfParamName+"=",r=e.split("&"),a=r.length,i=0;i<a;i++)if(0==r[i].indexOf(t)){r[i]=csrfParamName+"="+csrfToken;for(var n="",o=0;o<a;o++)n+=r[o],o!=a-1&&(n+="&");return n}return e}(r.data):"object"==typeof r.data&&csrfParamName in r.data&&(r.data[csrfParamName]=csrfToken)),"object"!=typeof r.data&&!r.url.endsWith(Crm.client_tracking_endpoint))if(Crm.REQUEST_QUEUE[r.url+"---"+r.data]){if(Crm.REQUEST_QUEUE[r.url+"---"+r.data]++,void 0!==r.data&&(-1!==r.data.indexOf("mode=click2call")||-1!==r.data.indexOf("event=makeCall"))){var n=CTIAPI.CTI.ctiname;n=""===n||void 0===n?"phonebridge":n,Crm.pushForStats("CTIAPI_BLOCKED_REQUEST_"+n,r.data)}t.abort(),void 0!==window.console&&window.console.log(r.url+" is already being processed!!!!!! No of tries for the same url : "+Crm.REQUEST_QUEUE[r.url+"---"+r.data])}else Crm.REQUEST_QUEUE[r.url+"---"+r.data]=1})),$(document).ajaxComplete((function(e,t,r){var a=window.location.href,i=(t.getResponseHeader("clientVersion"),t.getResponseHeader("clientsubVersion"));if(Crm.env.isDevelopment&&"undefined"!=typeof Instrumentdata){if(void 0===Instrumentdata.flag&&(Instrumentdata.flag="true"),t.requestUrl==Crm.getCrmBasePath()+"/Instrument.do"){Instrumentdata.instrumentresp=[];var n=t.responseText;Instrumentdata.flag="false",void 0!==n&&(Instrumentdata.instrumentresp.length>30&&Instrumentdata.instrumentresp.shift(),null!=n&&""==!n&&Instrumentdata.instrumentresp.push("object"==typeof n?n:JSON.parse(n)))}"true"==Instrumentdata.flag&&(Instrumentdata.flag="false")}if(i&&crmConstants.subVersion&&(-1!==a.indexOf("extensions")||-1!==r.url.indexOf("/market/")&&!Crm.isPlatform||(app.newSubVersion=i)),t.getResponseHeader("tiralExpired")&&!$("#trialExpiryDiv").length){Crm.trackSpotLightAction("Trial expiry alert shown");var o=t.getResponseHeader("editionEvaluated"),s=t.getResponseHeader("showExtendTrail"),l=(E=Handlebars.templates.EditionExpiryAlert)({profileName:Crm.userDetails.PROFILE_NAME,title:I18n.getMsg("crm.trial.expiry.notification.title",I18n.getMsg(o)),message:I18n.getMsg("crm.trial.expiry.notification.message"),option1:I18n.getMsg("crm.store.upgrade.to",I18n.getMsg(o)),option2:I18n.getMsg("crm.trial.expiry.notification.option.move",I18n.getMsg(Crm.userDetails.LICENSE_TYPE_ACTUAL_NAME)),deployment:Crm.userDetails.DEPLOYMENT,contactAdmin:I18n.getMsg("crm.trial.contact.adminstrator"),option3:I18n.getMsg("crm.extend.your.trail"),editionEvaluated:o,showExtendTrail:s});showFreezeLayer(),$("body").append(l),mailsetCenter("trialExpiryDiv")}if($("#trialExpiryDiv").length&&showFreezeLayer(),"true"!==t.getResponseHeader("isDeveloperUser")){var c=t.getResponseHeader("statusCode");if("3"!==c&&"6"!==c&&"8"!==c){if("true"===t.getResponseHeader("isAccessRestricted"))if($("#SubscriptionExpiryDiv").length)$("#basic").addClass("bodyBlur"),freezeBackground();else{l=(E=Handlebars.templates.EditionExpiryAlert)({action:"subscription",isOnlineStoreAvailable:"true"===t.getResponseHeader("isOnlineStoreAvailable"),profileName:Crm.userDetails.PROFILE_NAME,title:I18n.getMsg("crm.subscription.expired.title"),message:I18n.getMsg("crm.subscription.expired.alert.admin",[Crm.userDetails.PARTNERBRAND,I18n.getMsg(Crm.userDetails.LICENSE_TYPE_ACTUAL_NAME),Crm.userDetails.SUBSCRIPTION_EXPIRED_DATE]),question:I18n.getMsg("crm.trial.expiry.notification.message"),option1:I18n.getMsg("crm.subscription.renew"),option2:I18n.getMsg("crm.subscription.choose.other.edition"),option3:I18n.getMsg("crm.move.to.free"),or:I18n.getMsg("crm.books.configure.or.label"),contactAdmin:I18n.getMsg("crm.subscription.contact.admin.msg")});freezeBackground(),$("#basic").addClass("bodyBlur"),$("body").append(l)}else if("Administrator"===Crm.userDetails.PROFILE_NAME&&"true"===Crm.userDetails.SHOW_RENEWAL_BANNER&&Crm.userDetails.SUBSCRIPTION_EXPIRED_DATE&&!$(".downgrateMssBand").length){var d=I18n.getMsg("crm.subscription.contact.admin.msg");if("Administrator"===Crm.userDetails.PROFILE_NAME){var u=Crm.userDetails.REMAINING_GRACE_DAYS;d=I18n.getMsg("crm.subscription.renew.days",[u,Crm.userDetails.manageSubscriptionUrl]),Crm.userDetails.REMAINING_GRACE_DAYS<=1&&(d=I18n.getMsg("crm.subscription.renew.today",[Crm.userDetails.manageSubscriptionUrl]))}var m="<div class='downgrateMssBand f14 fs color_1 aligncenter dN p7' id='subscriptionExpiryMsgband'>"+I18n.getMsg("crm.subscription.expired.alert.admin",[Crm.userDetails.PARTNERBRAND,I18n.getMsg(Crm.userDetails.LICENSE_TYPE_ACTUAL_NAME),Crm.userDetails.SUBSCRIPTION_EXPIRED_DATE])+"&nbsp;"+d;$("#tabLayer").prepend(m),$(".downgrateMssBand > a").click((function(){Crm.trackSpotLightAction("Renew Subscription - Banner")}));var p=$("#annoncement"),g=$(".downgrateMssBand");0===p.length?g.show():g.hide()}else if($(".downgrateMssBand").length&&!Crm.userDetails.SUBSCRIPTION_EXPIRED_DATE)$(".downgrateMssBand").remove();else if(Crm.userDetails.SHOW_AUTHTOKEN_DEPRECATION_BANNER){$("#basic").addClass("bodyBlur");var h=RebrandLinkUtil.getProperty("MAIL_FEEDBACK_TO"),f={name:"div",attr:{class:"attentionWrapper mA"},child:[{name:"div",attr:{class:"attentionParent"},child:[{name:"div",attr:{class:"warnLogo mA"}},{name:"div",attr:{class:"attentionContent dIB aligncenter"},child:[{name:"div",attr:{class:"attentionHead pT10"},child:[{name:"text",html:I18n.getMsg("crm.api.deperation.attention")}]},{name:"div",attr:{class:"sunsetDate mA f13"},html:I18n.getMsg("It seems that your organization is still using the "),child:[{name:"span",attr:{class:"boldFont"},html:I18n.getMsg("Deprecated AuthToken which will SUNSET on "),child:[{name:"span",attr:{class:"ss_date"},html:"May 31, 2021."}]}]},{name:"div",attr:{class:"moreDetialArea mA f14"},html:"A ",child:[{name:"a",attr:{class:"normallinkcol",href:"https://help.zoho.com/portal/en/community/topic/zoho-crm-authtoken-deprecation-6-4-2021"},html:I18n.getMsg("forum post")},{name:"span",attr:{class:"specialLetter"},html:" "+I18n.getMsg("crm.function.authtoken.mail.forum")}]},{name:"div",attr:{class:"pinkContent mA f14"},child:[{name:"div",attr:{class:"pinkAreaContent mA"},html:I18n.getMsg("crm.function.authtoken.mail.forward"),child:[{name:"span",attr:{class:"boldFont"},html:I18n.getMsg("crm.function.authtoken.mail.data.loss")}]}]},{name:"div",attr:{class:"highLightWords mA f14 specialLetter boldFont"},html:I18n.getMsg("crm.function.authtoken.recommend")},{name:"div",attr:{class:"confirmBut cP dIB",onclick:"Crm.authtoken_banner_success()"},child:[{name:"text",content:I18n.getMsg("crm.api.deperation.consent")}]},{name:"div",attr:{class:"contectArea mA f13"},html:I18n.getMsg("crm.api.deperation.info",h)}]}]}]};renderingUtils.popUpWithFreeze(renderingUtils.createHTML(f)),$("#FreezeLayer").addClass("freezelayer_zindex"),$("#popupnew").addClass("popupnew_zindex")}else if(Crm.userDetails.SHOW_OLD_OAUTH_SANDBOX_API_DEPR_BANNER){var v=networkUtils.returnDependencyFiles(["crm-old-oauth-depr-banner-sandbox.js"],crmConstants.jsStaticPathForLyte),C=C=networkUtils.returnDependencyFiles(["crm-old-oauth-depr-banner-sandbox.css"],crmConstants.cssStaticPathForLyte),y=networkUtils.returnDependencyFiles([networkUtils.getI18nJSUrl("OldOAuthSandboxDepr")]);Lyte.injectResources(v.concat(C).concat(y)).then((function(){var e=document.querySelector("crm-old-oauth-depr-banner-sandbox");e||(e=Lyte.Component.render("crm-old-oauth-depr-banner-sandbox","{}","body")).component.executeMethod("showBanner")}))}if(Crm.userDetails.TELEPHONY_BANNER){v=networkUtils.returnDependencyFiles(["crm-old-telephony-depr-banner.js"],crmConstants.jsStaticPathForLyte),C=C=networkUtils.returnDependencyFiles(["crm-old-telephony-depr-banner.css"],crmConstants.cssStaticPathForLyte),y=networkUtils.returnDependencyFiles([networkUtils.getI18nJSUrl("OldTelephonyDepr")]);Lyte.injectResources(v.concat(C).concat(y)).then((function(){var e=document.querySelector("crm-old-telephony-depr-banner");if(!e){var t=crmCalendar.months[Crm.userDetails.TELEPHONY_BANNER.month+""],r=I18n.getMsg(t)+" "+Crm.userDetails.TELEPHONY_BANNER.date+", "+Crm.userDetails.TELEPHONY_BANNER.year;(e=Lyte.Component.render("crm-old-telephony-depr-banner",{ctiname:Crm.userDetails.TELEPHONY_BANNER.provider,lastdate:"<span class='nowrap'>"+r+"</span>",helpLink:Crm.userDetails.TELEPHONY_BANNER.helplink},"body")).component.executeMethod("showBanner")}}))}if(location.href.indexOf(Crm.getOrgSpecificURL(Crm.getCrmBasePath()+"/search"))<0&&$("#gsearchparentdiv").hide(),!0===Crm.isPageLoad&&(Crm.isPageLoad=!1),Crm.userDetails.SHOW_DOT_NOTATION_API_DEPRECATION_BANNER&&"#showDeprecated"!==window.location.hash){v=networkUtils.returnDependencyFiles(["plugin-old-api-notation-depr-banner.js"],crmConstants.jsStaticPathForLyte),C=C=networkUtils.returnDependencyFiles(["plugin-old-api-notation-depr-banner.css"],crmConstants.cssStaticPathForLyte),y=networkUtils.returnDependencyFiles([networkUtils.getI18nJSUrl("OldApiNotationPluginDepr")]);Lyte.injectResources(v.concat(C).concat(y)).then((function(){var e=document.querySelector("plugin-old-api-notation-depr-banner");e||(e=Lyte.Component.render("plugin-old-api-notation-depr-banner","{}","body")).component.executeMethod("showBanner")}))}0!==t.status&&0!=t.readyState&&delete Crm.REQUEST_QUEUE[r.url+"---"+r.data]}else if($("html,body").addClass("eventNone"),$("#wmstoolbar").addClass("eventNone_remove"),!$("#deactivatedWindow").length){$("#sandboxCssLink").length||Lyte.injectResources(networkUtils.returnDependencyFiles(["sandbox-min.css"]));I={deactivate:"true"};"3"===c?(I.headContent="crm.sandbox.deactivated.subject",I.bodyContent="crm.sandbox.deactivated.content"):"6"===c?I.headContent="crm.sandbox.rebuild.description":"8"===c&&(I.headContent="crm.sandbox.data.population.inprogress");var E=Handlebars.templates.sandboxDeactivatedPage(I);$("body").append(E)}}else if($("html,body").addClass("eventNone"),$("#wmstoolbar").addClass("eventNone_remove"),showFreezeLayer(),$("#freezeBackGround").css("opacity","0"),!$("#deactivatedWindow").length){$("#sandboxCssLink").length||Lyte.injectResources(networkUtils.returnDependencyFiles(["sandbox-min.css"]));var I={headContent:"crm.sandbox.devuser.blocked.subject",bodyContent:"crm.sandbox.devuser.blocked.content"},E=Handlebars.templates.sandboxDeactivatedPage(I);$("body").append(E)}})),$(document).ajaxError((function(e,t,r){var a;if(t.status===crmConstants.errorStatusCode&&r&&r.headers&&!r.headers["X-ZOHO-SERVICE"]&&(!r.url||-1===r.url.indexOf("Analytics"))&&!r.url.includes("shift_hours"))return Crm.isHeadless&&void 0!==WindowsCommunicator&&(a=function(){WindowsCommunicator.notifyParent("cancel-operation")}),renderingUtils.displayPermissionDenied(t,void 0,void 0,void 0,a),$("input[name=save]").prop("disabled",!1),$("input[name=saveAndNew]").prop("disabled",!1),void $("input[name=cancel]").prop("disabled",!1)})),this.userDetails=e,"705161756"==Crm.userDetails.ZUID||"675350355"==Crm.userDetails.ZUID||"689349620"==Crm.userDetails.ZUID){var s=Lyte.Router.registerRoute;Lyte.Router.registerRoute=function(e){if(Lyte.Router.__lp.getDefinition(e)){var t=new Error(e+" route overwritten");murphy.error(t)}else s.apply(Lyte.Router,arguments)}}app.crossOriginEnabled=document.domain.indexOf("localzoho.com")>-1||"undefined"!=typeof FingerPrint&&FingerPrint.isCdnEnabled||void 0!==Crm&&Crm.userDetails&&Crm.userDetails.JS_CORS_ENABLED;var l=document.querySelector("crm-menu");if(void 0!==this.Logo&&l){var c=this.Logo.Logo_url,d=l.component.getData("crmLogoUrl");void 0!==this.Logo.Service&&"ZohoCRM"===this.Logo.Service&&(c=this.Logo.Logo_url_white,Lyte.objectUtils(d,"add","heightRestriction",!1)),Lyte.objectUtils(d,"add","Logo_url_white",c)}Crm.userDetails.jsLocation="China"===Crm.userDetails.DEPLOYMENT?"china/":"";var u="object"!=typeof e.MODULE_LIST?JSON.parse(e.MODULE_LIST):e.MODULE_LIST;if(this.moduleInfo=u,this.userDetails.MODULE_LIST=moduleRecordMapping,"Mozilla"!==$L.userAgent.browser&&"Firefox"!==$L.userAgent.browser||document.addEventListener("click",(function(e){window.event=e}),!0),crmConstants.init(),org.owasp.esapi.ESAPI.initialize(),this.loadDefaultConstants(),this.calPreferences=t,!Crm.isHeadless){this.menu.init(),Search.rowcnt||Search.init(),Activities.init();try{Territory.init(),crmListView.initStageTemplates()}catch(e){}try{crmEmailStats.init()}catch(e){}}for(var m in crmCalendar.init(),crmCalendar.calDefColor=r,Events.init(),Crm.isHeadless&&"msteams"!==networkUtils.parseUrl(location.href).params.from||CrmDashboard.init(),moduleRecordMapping){!!moduleRecordMapping[m].web_link||this.getModuleObj(m)}1==Crm.userDetails.ISPAID_USER&&(crmConstants.maxSelectCount=500),(Crm.userDetails.JS_CORS_ENABLED||document.domain.indexOf("localzoho.com")>-1)&&commonUtils.enableErrorLogging(),"675892647"!=Crm.userDetails.ZGID&&"659089839"!=Crm.userDetails.ZGID&&"55171602"!=Crm.userDetails.ZGID||Object.defineProperty(CFRExec,"relatedEntityMap",{get:function(){return CFRExec._relatedEntityMap},set:function(e){if(validationUtils.isEmpty(e))try{var t=(new Error).stack;murphy.addCustomTracking({message:t,name:"value_relatedEntityMap",type:"custom event"}),murphy.error(new Error("Layout Rule Related Information-relatedMapSetEmpty"))}catch(e){murphy.error(e)}return CFRExec._relatedEntityMap=e}}),$(document).keyup((function(e){if(27==e.keyCode)if($("#listviewHeaderRow #addColumn").removeClass("addColumnActive"),$("#toolsId, #columnList").slideUp(100),$("#importDiv, #importRevampDiv, #columnList").slideUp(100),"block"==$("#alphaRefTable #alphaTable").css("display")&&1==$("#alphaSearch").hasClass("alphaSearchActive")&&($("#alphaSearch").removeClass("alphaSearchActive"),$("#alphaTable").slideUp(100)),$("#formRuleMandatoryFields").is(":visible"))$("#formRuleMandatoryFields").find("#cancel").trigger("click");else if($("#subSecondaryPopup").is(":visible"))$("#subSecondaryPopup").find("#cancel").trigger("click");else{var t=$(document.activeElement).closest(".zcrm-modal:visible:not(.newProductStyleEle)").attr("id");t&&("topBandPopup"==t?hideAnimatePopup(t,!0):hideAnimatePopup(t),$("#searchCreatePopup").is(":visible")&&"lookupPopup"==t&&($("#freezeBackGround").removeClass("zindex250").css("z-index","30"),showFreezeLayer()))}}));var p=$(window);Crm.userDetails.viewPort={height:p.height(),width:p.width()},Crm.userDetails.screen={height:window.screen.height,width:window.screen.width},Crm.userDetails.lastRefresh=(new Date).toString(),"true"==RebrandLinkUtil.getProperty("enablePerfLogger")&&(PerfLogger.prototype.constructLandingUrlData=function(){var e={};return e.automation_id=cookieUtils.getCookie("ZCRM_QA_AUTOMATION_ID"),e.automation_case_id=cookieUtils.getCookie("ZCRM_QA_AUTOMATION_CASE_ID"),e.type=this.types.LANDING_PAGE,e.landing_url=window.location.href,e},navigator.sendBeacon(PERF_LOGGER.url,JSON.stringify(PERF_LOGGER.constructLandingUrlData())));var g=RebrandLinkUtil.getProperty("responseTrackingUrl");Crm.userDetails.isResponseTrackingEnabled&&g&&window.addEventListener("unload",(function(){navigator.sendBeacon(g,JSON.stringify(responsetimeTracker)),responsetimeTracker=[]})),(Crm.env.isDevelopment||0==crmConstants.compression)&&renderingUtils.RemoveFromCache(),setTimeout((function(){var e,t=networkUtils.returnDependencyFiles(["crm-browser-version.js","crm-browser-version-check.js"],crmConstants.jsStaticPathForLyte),r=networkUtils.returnDependencyFiles([networkUtils.getI18nJSUrl("browserupgradeversion")]),a=networkUtils.returnDependencyFiles(["crm-browser-version.css"],crmConstants.cssStaticPathForLyte),i=t.concat(a).concat(r);Crm.userDetails.RTL_ENABLED&&(e=networkUtils.returnDependencyFiles(["crm-browser-version-rtl.css"],crmConstants.cssStaticPathForLyte),i=i.concat(e));var n,o=!0,s=$L.userAgent,l=!1;if((document.domain.includes(".com.cn")||"zh_CN"==Crm.userDetails.LOCALE||document.domain.includes("crmcn.localzoho.com"))&&(l=!0),"Chrome"===s.browser||"CriOS"===s.browser)s.version<73&&(l&&s.version>=55?(o=!0,!0):o=!1),n=!0;else if("Firefox"===s.browser||"FxiOS"===s.browser)s.version<68&&(l&&s.version>=54?(o=!0,!0):o=!1),n=!0;else if("Safari"===s.browser)s.version<13&&(l&&s.version>=11?(o=!0,!0):o=!1),n=!0;else if("Edge"===s.browser||"EdgiOS"===s.browser)s.version<79&&(o=!1),n=!0;else if("OPR"===s.browser)s.version<60&&(l&&s.version>=42?(o=!0,!0):o=!1),n=!0;else if("IE"===s.browser)o=!1,n=!0;else{o=function(){try{return Function("() => {};"),!0}catch(e){return!1}}(),n=!1}o||Lyte.injectResources(i,void 0,(function(e,t){0===t.length&&(n?Lyte.Component.render("crm-browser-version-check",{},"#oldBrowserAlertWrapper"):n||($L.moment().fromNow($L.moment("31/12/2020","DD/MM/YYYY")).past?Lyte.Component.render("crm-unsupported-browser-blocking",{},"#oldBrowserAlertWrapper"):Lyte.Component.render("crm-browser-version-check",{},"#oldBrowserAlertWrapper")))}))}),0)},bindDocumentEvents:function(){$(document).click((function(e){if(!Lyte.registeredMixins["business-hours-utils"]||!Lyte.registeredMixins["business-hours-utils"].CrmBusinessHours.routers.contains(Lyte.Router.getRouteInstance().routeName)){targ=null,srcElement=null;var t=e.target?e.target:e.srcElement;if(!$L.userAgent||"Mozilla"!==$L.userAgent.browser&&"Firefox"!==$L.userAgent.browser||1===e.which)if(1!=e.ctrlKey&&1!=e.metaKey&&2!=e.which||null==$(t).attr("href")){if(0==window.getSelection().isCollapsed&&"customCheckBox"!=e.target.className&&"customCheckBoxChecked"!=e.target.className)return renderingUtils.stopEvent(e),!1;var r=$(t).attr("data-cid");if(r||$(t).parents().each((function(e,a){if(r=$(a).attr("data-cid"))return t=a,!1})),"false"==$(t).attr("data-permission"))return renderingUtils.displayPermissionDenied(),renderingUtils.stopEvent(e),permissionDenied=!0,!1;var a=$(t).attr("crm-tracking-message");if(a)if(a.includes(","))try{var i=a.substring(a.indexOf(",")+1,a.length);i=i.replace(/'/g,'"');var n=JSON.parse(i),o=a.substring(0,a.indexOf(","));Crm.trackSpotLightAction(o,n)}catch(e){JS_LOGGER.log("Invalid JSON Parsing")}else Crm.trackSpotLightAction(a);else $(t).parents().each((function(e,t){var r=$(t).attr("crm-tracking-message");if(r)if(r.includes(","))try{var a=r.substring(r.indexOf(",")+1,r.length);a=a.replace(/'/g,'"');var i=JSON.parse(a),n=r.substring(0,r.indexOf(","));Crm.trackSpotLightAction(n,i)}catch(e){JS_LOGGER.log("Invalid JSON Parsing")}else Crm.trackSpotLightAction(r)}));if(r){var s=$(t).data("params"),l={};if(l.data=s,l.targetElem=t,l.clickId=r,l.ev=e,$("#next_action_activity_id").addClass("pointerEveNone"),"undefined"==typeof crmSetup&&("tab"==r&&s&&"Setup"==s.module||s&&"crmSetup"==s.calleeObj))return networkUtils.loadFeatureScripts(["zohocrm_setup.js"],(function(){Crm.triggerClickHandlerBasedOnCalee(l)})),!1;if(!Crm.triggerClickHandlerBasedOnCalee(l)&&"dummy"!==r)return!1}checkForWindowOpener(t,e),getElemById("FreezeLayer")!=t&&hideMenu(e,!1)}else checkForWindowOpener(t,e),renderingUtils.stopEvent(e)}}))},client_tracking_endpoint:"__internal/client_tracking",client_tracking:function(e,t){var r={};for(var a in r.feature_name=e,t)r[a]=t[a];var i={"X-ZCSRF-TOKEN":csrfParamName+"="+csrfToken};window.clientPortalName&&(i["X-CRMPORTAL"]=window.clientPortalName),$.ajax({type:"POST",url:"/crm/v2/"+Crm.client_tracking_endpoint,data:r,headers:i})},registerPartials:function(){Crm.isHeadless||(Handlebars.registerPartial("notificationGroups",Handlebars.templates.notificationGroups),Handlebars.registerPartial("notificationGroup",Handlebars.templates.notificationGroup),Handlebars.registerPartial("cvNotificationShowMore",Handlebars.templates.cvNotificationShowMore),Handlebars.registerPartial("centralNotificationMenu",Handlebars.templates.centralNotificationMenu),Handlebars.registerPartial("signalBusinessCard",Handlebars.templates.signalBusinessCard),Handlebars.registerPartial("signalBusinessCardContent",Handlebars.templates.signalBusinessCardContent),Handlebars.registerPartial("signalDetailViewTemplate",Handlebars.templates.signalDetailViewTemplate),Handlebars.registerPartial("uiTypeTemplate",Handlebars.templates.uiTypeTemplate),Handlebars.registerPartial("uiTypeTemplatePrint",Handlebars.templates.uiTypeTemplatePrint),Handlebars.registerPartial("uiTypeLabelTemplate",Handlebars.templates.uiTypeLabelTemplate),Handlebars.registerPartial("uiTypeInputTemplate",Handlebars.templates.uiTypeInputTemplate),Handlebars.registerPartial("CriteriaEditor",Handlebars.templates.CriteriaEditor),Handlebars.registerPartial("CustomViewList",Handlebars.templates.CustomViewList),Handlebars.registerPartial("InnerCV",Handlebars.templates.InnerCV),Handlebars.registerPartial("TaskKanbanView",Handlebars.templates.TaskKanbanView),Handlebars.registerPartial("body",Handlebars.templates.body),Handlebars.registerPartial("customViewFilters",Handlebars.templates.customViewFilters),Handlebars.registerPartial("canvasViewsList",Handlebars.templates.canvasViewsList),Handlebars.registerPartial("customViewFiltersPart",Handlebars.templates.customViewFiltersPart),Handlebars.registerPartial("leadPrediction",Handlebars.templates.leadPrediction),Handlebars.registerPartial("cvError",Handlebars.templates.cvError),Handlebars.registerPartial("heading",Handlebars.templates.heading),Handlebars.registerPartial("macroBtn",Handlebars.templates.macroBtn),Handlebars.registerPartial("customizedviewmenu",Handlebars.templates.customizedviewmenu),Handlebars.registerPartial("navigateByRecords",Handlebars.templates.navigateByRecords),Handlebars.registerPartial("noRecordsFound",Handlebars.templates.noRecordsFound),Handlebars.registerPartial("VisitEmbedCode",Handlebars.templates.VisitEmbedCode),Handlebars.registerPartial("fixedColumnlistview",Handlebars.templates.fixedColumnlistview))},triggerClickHandlerBasedOnCalee:function(e){var t=e.data,r=e.targetElem,a=e.clickId;if(t&&t.calleeObj){var i=t.calleeObj;"crmSetup"!==i?(window[i].clickEventIdVsMethodMapping[a],window[i].clickHandler?window[i].clickHandler(e.ev,r,a):(t.clickId=a,$(r).attr("data-params",JSON.stringify(t)),Lyte.registeredMixins["crm-utilities"].executeFunctionByName(window[i].clickEventIdVsMethodMapping[a],window,e.ev,r))):(t.clickId=a,$(r).attr("data-params",JSON.stringify(t))),!1}else for(var n=Crm.defaultObj,o=0;o<n.length&&(!window[n[o]]||!window[n[o]].hasOwnProperty("clickHandler")||window[n[o]].clickHandler(e.ev,r,a));o++);},authtoken_banner_success:function(){var e=new crmRequestPool,t={"X-ZCSRF-TOKEN":csrfParamName+"="+csrfToken};$(".attentionParent, .attentionWrapper").remove(),$(".freezelayer_zindex").removeClass("freezelayer_zindex"),$(".popupnew_zindex").removeClass("popupnew_zindex"),removeFreezeLayer(),$("#basic").removeClass("bodyBlur"),Crm.userDetails.SHOW_AUTHTOKEN_DEPRECATION_BANNER=!1,e.initiate({action:"/crm/v2/__internal/authtoken_deprecation_banner",type:"POST",headers:t})},getAjaxUrl:function(e,t,r){var a=networkUtils.parseUrl(e),i=a.action,n=t||(a.params?a.params:{});for(var o in n)n[o]=decodeURIComponent(n[o]);var s=n.module?n.module:crmTab.selectedTab,l={apprListView:"ShowDetails",apprDetailView:"approvalProcess",ViewForecast:"potentials/ViewForecastDetails",TerritoryForecast:"TerritoryForecast",RoleForecast:"RoleForecast",ViewPipeline:"ViewPipeline",GlobalSearch:"GSearch",GlobalSearch1:"GSearch",Convert:"leads/Convert",CreateEntity:"Create",EditEntity:"Edit",CloneEntity:"Clone",Import:"specific/ImportAction",MassTransfer:"MassRecords",MassDeleted:"MassRecords",MassConvert:"MassRecords",MassUpdate:"MassRecords",WebToLeadApproval:"WebLeadApproval",WebToContactApproval:"WebContactApproval",WebToCaseApproval:"WebCaseApproval",GeneratingPO:"GeneratePO",CreateCV:"CustomView",EditCV:"CustomView",CloneCV:"CustomView",EntityInfo:"ShowEntityInfo",ShowCalendar:"events/CalendarView",Calendar:"events/ShowCalendar",ManageCalendarScheduler:"ManageCalendar",CreateCalendarScheduler:"CreateCalScheduler",AutoResponders:"AutoResponder",CreateAutoResponder:"AutoResponder",ViewAutoResponder:"AutoResponder",EditAutoResponder:"AutoResponder",DeDuplicate:"GetMassDupRecords",MergeDuplicate:"EntityDuplicate",ModifyOwner:"ChangeOwner",AddRecords:"MassRecords",AddContactRole:"potentials/ShowContactsRolesMapping",EditContactRole:"potentials/ShowContactsRolesMapping",MergeEntities:"MergeAction",Merge:"ManualMerge",ShowDuplicates:"ViewDuplicates",ListConflicts:"ViewConflicts",FindEntityDuplicate:"FindDuplicate",WebRecordApproval:"WebRecordApproval",ReportsRelatedCV:"ReportsRelatedCV",ManageTags:"ManageTags"},c=l[i]?l[i]:void 0;if(c){switch(i){case"WebRecordApproval":n.isload=!0;break;case"CreateEntity":crmTab.isZBCustomModule(s)||crmTab.isZSCustomModule(s)||"Forecasts"==s||(Events.createEntity(s,t),c=void 0);break;case"EditEntity":crmTab.isZBCustomModule(s)||crmTab.isZSCustomModule(s)||"Forecasts"==s||"Events"!=s||(Crm.editEntity(void 0,void 0,n),c=void 0);break;case"CloneEntity":Crm.cloneEntity(void 0,void 0,n),c=void 0;break;case"ShowCalendar":n.module="Events";break;case"ManageCalendarScheduler":Crm.loadCalendarSchedule(n,"Manage"),c=void 0;break;case"CreateCalendarScheduler":Crm.loadCalendarSchedule(n,"Create"),c=void 0;break;case"TerritoryForecast":case"RoleForecast":case"ViewPipeline":n.isload=!1;break;case"AddRecords":n.actiontype="mass_addRecords",n.lookback="showdetails";break;case"ModifyOwner":n.target="showcvdetails";break;case"DeDuplicate":Crm.loadDeduplication(s,"Start",!1),c=void 0;break;case"ShowDuplicates":Crm.loadDeduplication(s,"ShowDuplicates",n),c=void 0;break;case"Merge":Crm.loadDeduplication(s,"Merge",n),c=void 0;break;case"ListConflicts":Crm.loadDeduplication(s,"Conflict",n),c=void 0;break;case"MergeDuplicate":case"FindEntityDuplicate":if(n.findDupFldName="",n.searchDetails){for(var d=JSON.parse(n.searchDetails),u=n.match,m=Object.keys(d).length,p=1;p<=m;p++){for(j=0;j<d["pattern"+p].length;j++)n[d["pattern"+p][j][0]]=d["pattern"+p][j][1];1!=p&&(n["match"+p]="101"==u?"or":"and")}n["property(Match)"]=u,delete n.match,delete n.searchDetails}break;case"CreateAutoResponder":n.step="create";break;case"ViewAutoResponder":n.step="view";break;case"EditAutoResponder":n.step="edit";break;case"GlobalSearch":case"GlobalSearch1":for(p=0;p<crmNavig.listOfBuffers.length;p++)crmNavig[crmNavig.listOfBuffers[p]]=void 0;n.ajaxSearch=!0,n.searchCategory="AllEntities",document.title=I18n.getMsg("crm.title.general",I18n.getMsg(["crm.title.global.search.results",Crm.partnerName]));break;case"EntityInfo":if(Crm.origin&&(n.origin=Crm.origin),n.format="json","Forecasts"==n.module){c="potentials/ViewForecastDetails",n.forecastId=n.id,delete n.id,delete n.module;break}if("Invoices"==n.module&&delete n.isload,n.pfrom||(n.pfrom="cv"),"Activities"==Crm.activityGrp[n.module]&&Crm.isPageLoad&&(n.fromDetailView&&delete n.fromDetailView,n.fromActivityListView&&delete n.fromActivityListView),!t.fromActivityListView&&!1!==r){e=Crm.getCrmBasePath()+"/"+c+".do";p=0;for(var o in n)/\b(calleeObj|clickId)\b/.test(o)||void 0!==n[o]&&(e+=0==p?"?":"&",e+=o+"="+encodeURIComponent(n[o]),p++);return(n.module||n.parModule)&&(n.module?crmTab.updateTabContent(n.module):crmTab.updateTabContent(n.parModule)),detailView.load(e),void(isRelatedListLoaded=!0)}break;case"ShowTab":case"ShowSelectedCustomView":case"ShowHomePage":if(n.changeOption=!0,n.searchDetails||n.searchletter&&""!=n.searchletter||1!=n.fromIndex){for(p=0;p<crmNavig.listOfBuffers.length;p++)crmNavig[crmNavig.listOfBuffers[p]]=void 0;delete n.changeOption}if(n&&n.fromIndex&&n.toIndex&&(c="NavigateByRecords",n.fileName=Crm.getCrmBasePath()+"/ShowSelectedCustomView.do",n.mod=!0),n.isload="true","Tasks"!=s&&"Events"!=s&&"Calls"!=s||(s="Activities"),n.module=s,"Chat"==n.module||"Documents"==n.module)return void Utils.windowLocationHref(Crm.getOrgSpecificURL(Crm.getCrmBasePath()+"/tab/"+n.module));if(n.previous_sort_column&&(delete n.sortOrderString,delete n.sortColumnString),n.searchDetails){d=JSON.parse(decodeURIComponent(n.searchDetails));for(var g=0;g<d.length;g++){var h=d[g];n["advSearch_text_"+(g+1)]=h.text?h.text:"",n["advSearch_select_"+(g+1)]=h.ptn,n["advSearch_name_"+(g+1)]=h.name,h.hr&&(n["advSearch_DT_hour"+(g+1)]=h.hr),h.min&&(n["advSearch_DT_minute"+(g+1)]=h.min),h.ampm&&(n["advSearch_DT_ampm"+(g+1)]=h.ampm)}delete n.searchDetails,n.advSearchCnt=g,n.searchField="All",n.advSearchEnable=!0}break;case"Import":n.step=1,n.dataScope||(n.dataScope="myData"),n.currStep||(n.currStep=1);break;case"CrmImport":n.step=1,n.currStep||(n.currStep=1);break;case"MassDeleted":case"MassTransfer":case"MassConvert":case"MassUpdate":if("MassUpdate"===i?n.actiontype="mass_update":"MassDeleted"===i?n.actiontype="mass_delete":"MassTransfer"===i?n.actiontype="mass_transfer":"MassConvert"===i&&(n.actiontype="mass_convert"),n.searchDetails){d=JSON.parse(n.searchDetails);n.rowCount=d.length;for(p=0;p<d.length;p++){(h=d[p]).patternVal?(n.rowCount--,n.patternVal=h.patternVal):(n["searchfield"+(p+1)]=h.text,n["searchfieldtype"+(p+1)]=h.type,n["match"+(p+1)]=h.match,"T"===h.type?(n["searchtext"+(p+1)]=h.value,n["textcondition"+(p+1)]=h.ptn,void 0!==h.enc&&!0===h.enc?n["enc"+(p+1)]=!0:n["enc"+(p+1)]=!1):"picklist"===h.type?(n["searchpicklist"+(p+1)]=h.value,n["textpicklistcondition"+(p+1)]=h.ptn):"L"===h.type?(n["searchlayout"+(p+1)]=h.value,n["layoutcondition"+(p+1)]=h.ptn):"tag"===h.type?(n["searchtag"+(p+1)]=h.value,n["tagcondition"+(p+1)]=h.ptn):"U"===h.type?(n["searchuser"+(p+1)]=h.value,n["temp_searchuser"+(p+1)]=h.temp_value,n["usercondition"+(p+1)]=h.ptn):"CML"===h.type?(n["searchcampcv"+(p+1)]=h.value,n["temp_searchcampcv"+(p+1)]=h.temp_value,n["campcvcondition"+(p+1)]=h.ptn):"C"===h.type?(n["searchusercv"+(p+1)]=h.value,n["usercvcondition"+(p+1)]=h.ptn):"B"===h.type?(n["searchboolean"+(p+1)]=h.value,n["booleancondition"+(p+1)]=h.ptn):"N"===h.type?(n["searchnum"+(p+1)]=h.value,n["numcondition"+(p+1)]=h.ptn,void 0!==h.enc&&!0===h.enc?n["enc"+(p+1)]=!0:n["enc"+(p+1)]=!1):"D"===h.type?(n["datecondition"+(p+1)]=h.ptn,h.ptn==Search.ageCrt||h.ptn==Search.dueCrt?(n["ageindayscondition"+(p+1)]=h.ageindayscondition,n["ageindays"+(p+1)]=h.ageindays):(n["searchdate"+(p+1)]=h.value,n["searchedate"+(p+1)]=h.edate)):"DT"===h.type&&(n["datetimecondition"+(p+1)]=h.ptn,h.ptn==Search.ageCrt||h.ptn==Search.dueCrt?(n["ageindayscondition"+(p+1)]=h.ageindayscondition,n["ageindays"+(p+1)]=h.ageindays):(n["searchdatedate"+(p+1)]=h.value,n["searchsthour"+(p+1)]=h.sthour,n["searchstminute"+(p+1)]=h.stminute,n["searchstampm"+(p+1)]=h.stampm,n["searchetminute"+(p+1)]=h.endminute,n["searchenddate"+(p+1)]=h.enddate,n["searchethour"+(p+1)]=h.endhour,n["searchetampm"+(p+1)]=h.endampm,n["searchstime"+(p+1)]=h.stime,n["searchetime"+(p+1)]=h.etime)))}}else n.rowCount=1;n&&n.fromIndex&&n.toIndex&&(c="NavigateByRecords",n.fileName=Crm.getCrmBasePath()+"/MassRecords.do?mod=true"),delete n.searchDetails,delete n.calleeObj,delete n.backOneLevel,"true"!=n.isFromMassTransWizard&&"true"!=n.isFromMassDelWizard||delete n.isFromBack,"undefined"==n.previous_sort_order&&(n.previous_sort_order="sort_asc");var f=new crmRequestPool;if((Crm.isPageLoad||n.isFromBack)&&n.operation_mode){var v=JSON.parse(JSON.stringify(n));delete v.operation_mode,delete v.fromIndex,delete v.toIndex,delete v.currentOption;for(p=1;p<=v.rowCount;p++)delete v["temp_searchuser"+p];f.initiate({action:Crm.getCrmBasePath()+"/MassRecords.do",data:v,success:function(e){$("#show").html(e),v.rowCount>=1||v.searchfieldtype1?(Search.setValues("create",n),Search.rowcnt=v.rowCount):(Search.setDefaultValues("create",void 0,void 0,void 0,void 0,!0),Search.rowcnt=1)},error:function(e){commonUtils.showHideLoadingDiv(),e.status===crmConstants.limitExceedsCode&&Search.displayLookupExceedsMsg(e)}}),v.fromIndex=n.fromIndex,v.toIndex=n.toIndex,v.currentOption=n.currentOption,v.operation_mode=n.operation_mode,f.addUp({action:Crm.getCrmBasePath()+"/"+c+".do",data:v,success:function(e){$("#massResult").html(e)},error:function(e){commonUtils.showHideLoadingDiv(),e.status===crmConstants.limitExceedsCode&&Search.displayLookupExceedsMsg(e)}})}else f.initiate({action:Crm.getCrmBasePath()+"/"+c+".do",data:n,success:function(e){n.operation_mode?$("#massResult").html(e):($("#show").html(e),Search.setDefaultValues("create",void 0,void 0,void 0,void 0,!0),Search.rowcnt=1)},error:function(e){commonUtils.showHideLoadingDiv(),e.status===crmConstants.limitExceedsCode&&Search.displayLookupExceedsMsg(e)}});return;case"AutoResponders":n.step||(n.step="show");break;case"CreateCV":n.action="create";break;case"EditCV":case"CloneCV":n.action="EditCV"==i?"edit":"clone";break;case"WebToLeadApproval":n.module="Leads";break;case"WebToCaseApproval":n.module="Cases";break;case"WebToContactApproval":n.module="Contacts";break;case"ReportsRelatedCV":n.ajax="true";break;case"RelActCV":n.pfrom||(n.pfrom="cv");case"ManageTags":f=new crmRequestPool,e="/crm/v2/settings/tags";var C={"X-ZCSRF-TOKEN":csrfParamName+"="+csrfToken},y=n.module;return n.module=moduleRecordMapping[y].api_name,f.initiate({action:e+"?fromClient="+!0,type:"GET",data:n,headers:C,success:function(e){CrmTags.manageTagsRendering(e,s)},error:function(e){var t=e.responseJSON;t&&-1!=t.code.indexOf("NO_PERMISSION")&&renderingUtils.displayPermissionDenied(e)}}),n.module=y,void Crm.trackSpotLightAction("Tagging - Manage Tags Click",{Module:n.module})}if(n.isFromBack&&delete n.isFromBack,c){e=Crm.getCrmBasePath()+"/"+c+".do";p=0;for(var o in n)/\b(calleeObj|clickId)\b/.test(o)||void 0!==n[o]&&(e+=0==p?"?":"&",e+=o+"="+encodeURIComponent(n[o]),p++);return(n.module||n.parModule)&&(n.module?crmTab.updateTabContent(n.module):crmTab.updateTabContent(n.parModule)),e}}},editEntity:function(e,t,r,a){var i=(r=r||JSON.parse($(t).attr("data-params"))).module;if("Appointments"===i&&!a){var n=[];n=(n=(n=n.concat(networkUtils.returnDependencyFiles(["zohocrm_services.js"]))).concat(networkUtils.returnDependencyFiles([networkUtils.getI18nJSUrl("businesshours")]))).concat(networkUtils.returnDependencyFiles(["crm-image-upload.js","crm-image-mixin.js","crm-image-preview.js","crm-image-upload-create.js","lyte-scrollTo.js","exif-plugin.js","lyte-cropper.js","lyte-colorbox.js"],crmConstants.jsStaticPathForLyte));var o=[];return Crm.userDetails.RTL_ENABLED&&(o=networkUtils.returnDependencyFiles(["crm-image-upload-rtl.css","crm-image-upload-ziaError.css"],crmConstants.cssStaticPathForLyte)),o=o.concat(networkUtils.returnDependencyFiles(["crm-image-upload.css","crm-image-upload-create.css","crm-image-preview.css"],crmConstants.cssStaticPathForLyte)),n=(n=n.concat(o)).concat(networkUtils.returnDependencyFiles([networkUtils.getI18nJSUrl("imageupload"),networkUtils.getI18nJSUrl("businesshours")])),void Lyte.injectResources(n,void 0,(function(){Crm.editEntity(e,t,r,!0)}))}if("Calls"===i&&!a){var s=networkUtils.returnDependencyFiles(["zcrm_callsnew.js"],crmConstants.jsStaticPath);return s=s.concat(networkUtils.returnDependencyFiles(["zcrm_callsnew1.js"],crmConstants.jsStaticPath)),void Lyte.injectResources(s,void 0,(function(){Crm.editEntity(e,t,r,!0)}))}Lyte.injectResources(networkUtils.returnDependencyFiles(["businessHoursmixin.js"],crmConstants.jsStaticPathForLyte),void 0,(function(){Lyte.injectResources(Lyte.registeredMixins["business-hours-utils"].downloadRecourceFile(),void 0)})),"undefined"!=typeof CAEExec&&CAEExec.init(),Crm.requestParam={},0!=$(".relListMenuDiv").length&&$(".relListMenuDiv").is(":visible")&&$(".relListMenuDiv").css({visibility:"hidden"}),commonUtils.showHideLoadingDiv(!0),$("body").css("overflow","");var l=r.id,c=(r.callee,r.clickId,r.layoutId),d=r.layoutName;if(Crm.editReqFrom=r.reqFrom?r.reqFrom:r.returnAnchor||r.goTo?"":"listView",Crm.scrollToElem=r.goTo?r.goTo:r.returnAnchor,"Events"===i&&"skyDesk"===Crm.brandName){var u=$(window).height();$("#eventCreatePopup").attr("style","width:95%;height:"+90*u/100+"px;display:none;"),$("#eventCreateContainerDiv").attr("style","width:100%;height:"+90*u/100*90/100+"px;"),$("#eventCreationDiv").attr("style","width:95%;height:"+90*u/100*90/100+"px;"),$("#eventCreationInnerDiv").attr("style","width:100%;height:"+90*u/100*80/100+"px;Overflow:hidden;")}if(r.fromKv||crmTab.isZBCustomModule(i)||crmTab.isZSCustomModule(i)||"Forecasts"==i){var m=Crm.isPageLoad,p=(v=networkUtils.constructUrl(Crm.getCrmBasePath()+"/Edit.do",r),"true"===$("#iskanbanview").val()),g=networkUtils.parseUrl(v).params;cachedmodule=g.module;var h="show";if(p?(PAGE_CACHE[cachedmodule]&&PAGE_CACHE[cachedmodule].New&&delete PAGE_CACHE[cachedmodule].New,taskKanbanViewCache=objectUtils.cloneObject(document.getElementById("kventitydetailspage")),document.getElementById("mapValues")&&document.getElementById("mapValues").parentNode.removeChild(document.getElementById("mapValues")),ActivityMoreInfoContent=$("#entitypopup").html(),h="cvEditSave"):$("#taskDetailsPart").length&&(h="taskDetailsPart",taskKanbanViewCache={},ActivityMoreInfoContent=$("#taskDetailsPart").html()),"kvlistview"===r.from&&0===TaskKanbanView.kvrecordid){taskKanbanViewCache="false";var f=$(t).closest(".kvtlistbgheader").attr("id");$("#kvType").val(f),taskDetailsview.listAnimation("open")}ajaxNew(v,void 0,(function(e){"show"===h&&(m||(Lyte.Router.transitionTo({route:"crm.tab.module.entity.edit",dynamicParams:[i,l]}).data=r),crmTab.updateTabContent(r.module)),$("#cvEditSave").show()}),h)}else{var v=Crm.getCrmBasePath()+"/Edit.do";this.fieldsObj[i]=[],Crm.resetSubformFields(i),this.currencyFields[i]=[];var C=this.getModuleObj(i);C.setStatus("edit");var y={id:l,module:i,format:"json",layoutId:c,layoutName:d};"gsearch"===r.pfrom&&(crmNavig.removeFeaturCacheObj("gsearch"),y.pfrom="gsearch"),y.tstamp=(new Date).getTime(),r.EditSeries&&(y.EditSeries="true",y.recAct=r.recAct,y.cvid=$("#cvid").val());var E=new crmRequestPool;E.followOrder=!0,E.initiate({action:v,type:"GET",data:y,dataType:"json",success:function(t){if(t.responseText)return $("#show").html(t.responseText),void commonUtils.showHideLoadingDiv();if(t.meetingConfZuid)Events.meetingConfZuid=t.meetingConfZuid;else if(t.STATUS&&"FAILURE"==t.STATUS&&t.INFO&&t.INFO.MSG)return renderingUtils.showCustomAlert(t.INFO.MSG,"",!1),void commonUtils.showHideLoadingDiv();commonUtils.showHideLoadingDiv(),"Appointments"!==i&&"JobSheets"!==i||(Events.createSource=r.from,Events.currentStatus="edit"),C.edit(l,t,r),"Events"===i||"Appointments"===i||"JobSheets"===i||"Calls"==i&&isNewCallView||"true"===$("#iskanbanview").val()||(!Crm.isPageLoad&&r.clickId&&("Activities"!=Crm.activityGrp[i]||Crm.isActivitySplitDone?Lyte.Router.transitionTo({route:"crm.tab.module.entity.edit",dynamicParams:[i,l]}).data=r:Lyte.Router.transitionTo({route:"crm.tab.module.entity.edit",dynamicParams:["Activities",l],queryParams:{sub_module:i}}).data=r),r.validationRequest&&"true"==r.validationRequest&&($("#saveAndNew"+r.module+"Btn").hide(),$("#save"+r.module+"Btn").val(I18n.getMsg("crm.validation.rule.approve.and.save.entity")).data("fromValidation",!0),$("#saveAndNew"+r.module+"Btn_Bottom").hide(),$("#save"+r.module+"Btn_Bottom").val(I18n.getMsg("crm.validation.rule.approve.and.save.entity")).data("fromValidation",!0)),!Crm.isDataEnrichAvailable||!Crm.enrichPermission||CAEExec.isEnrichDataInEditMode||"1"!==CAEExec.enrichStatusForRecord&&"6"!==CAEExec.enrichStatusForRecord||CAEExec.initEnrichDataFetchProcess(),"undefined"!=typeof CAEExec&&CAEExec.isEnrichDataInEditMode&&CAEExec.populateEnrichValues(),crmTab.updateTabContent(r.module)),!isGlobalSearch(e)||"Events"==i||"Appointments"==i||"Calls"===i&&isNewCallView||adSearchClose()},error:function(e){if(-1===e.responseText.indexOf("INSUFFICIENT_PRIVILEGES")){var t='<div onclick=/"sE()" class="w500 p20"><div class="floatL pL20 w430"><div class="f20"><h2 style="color:#E20000";>'+I18n.getMsg("crm.delete.error")+'</h2></div><div class="mT10">'+I18n.getMsg("crm.record.delete.message",[Crm.getCrmBasePath()])+'</div></div><br class="clearB"><div  class="alignright mT20"><input type="button" id="popupok" class="primarybtn" value="'+I18n.getMsg("crm.button.ok")+"\" onclick=\"hide('popupnew');removeFreezeLayer();document.getElementById('popupnew').style.zIndex=30\"></div></div>";renderingUtils.popUpWithFreeze(t),commonUtils.showHideLoadingDiv()}}}),(void 0===Crm.userDetails.LAYOUTRULEAVAILABLE||!0===Crm.userDetails.LAYOUTRULEAVAILABLE&&Crm.userDetails.LRINVOLVEDMODULES.contains(y.module))&&(y.getLayoutRuleJSON=!0,Crm.layoutRuleJSONData={},E.addUp({type:"GET",action:v,data:y,dataType:"json",success:function(e){null!==e&&(CFRExec.init(e,r.module,"edit"),CFRExec.promptIfMandatory=!1,CFRExec.evalRules("edit",!0))},error:function(){commonUtils.showHideLoadingDiv(),Crm.layoutRuleJSONData={}}})),(void 0===Crm.userDetails.VALIDATIONRULEAVAILABLE||!0===Crm.userDetails.VALIDATIONRULEAVAILABLE&&Crm.userDetails.VRINVOLVEDMODULES.contains(y.module))&&Crm.downloadValidationRules(v+"?format=json&module="+i+"&id="+y.id+(y.layoutId?"&layoutId="+y.layoutId:""),i)}return!1},getModuleObj:function(e){return this.fieldsObj[e]=[],Crm.resetSubformFields(e),this.currencyFields[e]=[],window[e]||(window[e]=Object.create(crmCommonModule),window[e].moduleName=e),window[e]},cloneEntity:function(e,t,r){if(Crm.requestParam={},commonUtils.showHideLoadingDiv(!0),Lyte.injectResources(networkUtils.returnDependencyFiles(["businessHoursmixin.js"],crmConstants.jsStaticPathForLyte),void 0,(function(){Lyte.injectResources(Lyte.registeredMixins["business-hours-utils"].downloadRecourceFile(),void 0)})),t)r=JSON.parse($(t).attr("data-params"));"calendar"===r.from&&($("#saveEventsBtn").attr("onclick","Events.saveEntity(event,undefined,undefined,'calendar')"),Events.createSource=r.from),"undefined"!=typeof CAEExec&&CAEExec.init();var a=r.module,i=r.id,n=(r.callee,Crm.getCrmBasePath()+"/Clone.do"),o=this.getModuleObj(a);window[a].setStatus("clone"),this.fieldsObj[a]=[],Crm.resetSubformFields(a),this.currencyFields[a]=[];r={id:i,module:a,format:"json"};var s=new crmRequestPool;s.followOrder=!0,s.initiate({action:n,type:"GET",data:r,dataType:"json",success:function(e){commonUtils.showHideLoadingDiv(),"Appointments"!==o.moduleName&&Events.formatInvDetailsToFinalIdsJson(e),e.responseText&&e.responseText.includes("FEATURELIMIT_ERROR_403::::FEATURELIMITEXCEED")?$("#show").html(e.responseText):o.clone(i,e)},error:function(e){commonUtils.showHideLoadingDiv()}}),(void 0===Crm.userDetails.LAYOUTRULEAVAILABLE||!0===Crm.userDetails.LAYOUTRULEAVAILABLE&&Crm.userDetails.LRINVOLVEDMODULES.contains(r.module))&&(r.getLayoutRuleJSON=!0,Crm.layoutRuleJSONData={},s.addUp({type:"GET",action:n,data:r,dataType:"json",success:function(e){null!==e&&(CFRExec.init(e,r.module,"edit"),CFRExec.promptIfMandatory=!1,CFRExec.evalRules("edit",!0))},error:function(){commonUtils.showHideLoadingDiv(),Crm.layoutRuleJSONData={}}})),(void 0===Crm.userDetails.VALIDATIONRULEAVAILABLE||!0===Crm.userDetails.VALIDATIONRULEAVAILABLE&&Crm.userDetails.VRINVOLVEDMODULES.contains(r.module))&&Crm.downloadValidationRules(n+"?format=json&module="+a+"&id="+r.id+(r.layoutId?"&layoutId="+r.layoutId:""),a)},layoutRuleJSONData:{},downloadLayoutRules:function(e,t,r,a){t.getLayoutRuleJSON=!0,(new crmRequestPool).initiate({type:"GET",action:e,data:t,dataType:"json",success:function(e){null!==e&&(CFRExec.init(e,t.module,r),a&&a.call(window))},error:function(){commonUtils.showHideLoadingDiv()}})},evalAfterLRDownload:function(e,t,r){(void 0===Crm.userDetails.LAYOUTRULEAVAILABLE||!0===Crm.userDetails.LAYOUTRULEAVAILABLE&&Crm.userDetails.LRINVOLVEDMODULES.contains(t))&&Crm.downloadLayoutRules(e,{module:t,id:r,getLayoutRuleJSON:!0},"view",(function(){CFRExec.promptIfMandatory=!1,CFRExec.evalRules("view",!0)}))},validationRuleJSONData:{},downloadValidationRules:function(e,t,r){Crm.validationRuleJSONData||(Crm.validationRuleJSONData={}),e+="&getValidationRuleJSON=true",networkUtils.lyteInitiateRequest(e,"GET").then((function(e){e&&(Crm.validationRuleJSONData[t]=JSON.parse(e),r&&r())}),(function(){commonUtils.showHideLoadingDiv(),r&&r()}))},downloadLRRules:function(e,t,r,a){if(void 0===Crm.userDetails.LAYOUTRULEAVAILABLE||!0===Crm.userDetails.LAYOUTRULEAVAILABLE&&Crm.userDetails.LRINVOLVEDMODULES.contains(e)){var i={},n={};n.module=e,n.format="json",t&&(n.layoutId=t),n.getLayoutRuleJSON=!0,i.params=n,networkUtils.lyteInitiateRequest(Crm.getCrmBasePath()+"/Create.do","GET",i).then((function(t){t&&(CFRExec.init(t,e,CFRExec.OPERATIONCONSTANT.QUICK_CREATE,a),CFRExec.addListenerForQCMode(e,a.qcObject.containerDiv),CFRExec.evalRulesForQCMode(e,r.fields,!0))}),(function(){commonUtils.showHideLoadingDiv()}))}},executeLayoutRule:function(e,t,r){if(void 0===Crm.userDetails.LAYOUTRULEAVAILABLE||!0===Crm.userDetails.LAYOUTRULEAVAILABLE&&Crm.userDetails.LRINVOLVEDMODULES.contains(t.module)){t.getLayoutRuleJSON=!0;var a=t.module;"view"==r&&delete t.module;var i=new crmRequestPool;Crm.layoutRuleJSONData={},i.initiate({type:"GET",action:e,data:t,dataType:"json",success:function(e){null!==e&&(CFRExec.init(e,a,r),CFRExec.promptIfMandatory=!1,CFRExec.evalRules(r,!0))},error:function(){commonUtils.showHideLoadingDiv(),Crm.layoutRuleJSONData={}}})}},evalAfterLRDownload:function(e,t,r){(void 0===Crm.userDetails.LAYOUTRULEAVAILABLE||!0===Crm.userDetails.LAYOUTRULEAVAILABLE&&Crm.userDetails.LRINVOLVEDMODULES.contains(t))&&Crm.downloadLayoutRules(e,{module:t,id:r,getLayoutRuleJSON:!0},"view",(function(){CFRExec.promptIfMandatory=!1,CFRExec.evalRules("view",!0)}))},showSubformErrorMsg:function(e,t,r){var a=$L("#errorMsg_"+t);a.length>0&&a[0].remove();var i=document.createElement("span");$(i).html(e).css({clear:"both","padding-bottom":"10px",color:"#F63648","font-size":"11px",display:"block"}).attr({class:"errMsg errorMsgDesc",id:"errorMsg_"+t}),$(i).css("position","relative"),r.closest(".secContent").parent().find("td.contHeadInfo").append(i)},showErrorMsg:function(e,t,r,a,i,n,o){setTimeout((function(){var s=t.closest("tr");s.position(),s.height();i?t&&$("[id='errorMsg_"+t.attr("id")+"']").remove():($(document.getElementById("errorMsg_"+t.attr("id"))).remove(),$(document.getElementById("errorMsg_"+t.attr("id")+"_label")).remove());var l=t.closest(".tabDiv,.tabDivCreate,.customDatefield");"businesscardDtls"===t.closest("div").attr("id")&&(l=t.closest(".tabdiv")),0===l.length&&(l=t),l.removeClass("errorFieldP");var c=document.createElement("span");if($(c).html(e).css({clear:"both","padding-bottom":"10px",color:"#F63648","font-size":"11px",display:"block"}).attr({class:"errMsg errorMsgDesc",id:"errorMsg_"+t.attr("id")}),"Events"===r&&$("#saveEventsBtn").removeAttr("disabled"),l.length)l.addClass("errorFieldP");else if(t.closest(".aggFldTabl").length)t.closest("tr").addClass("errorFieldP");else if(!0===a){s.addClass("form_err_fld"),(t.hasClass("cvFilter")?t.closest("div"):s).append(c)}var d=t.parents("span").attr("id");if(d&&-1!==d.indexOf("header")){var u=t.parents("span").parents("td").eq(0);$(c).removeClass("errorMsgDesc"),t.addClass("errorHighlight"),u[0].appendChild(c)}else{c.innerHTML=c.innerHTML;var m=t.closest(".labelValCreate,.labelValTwo,.validErrMsg,.FValue.uploadDoc");if(0==m.length&&n&&(m=t.closest(".tabDiv,.tabDivCreate").find(".labelValCreate")),0===m.length&&(m=t.find("td"),$(c).css("position","relative")),$("#multipleFieldsEditPop").length>0)if(1==m.hasClass("labelValCreate"))m.append(c).parent().addClass("form_err_fld");else m.find(".labelValCreate").length>0?m.find(".labelValCreate").append(c).parent().addClass("form_err_fld"):m.append(c).parent().addClass("form_err_fld");else m.append(c).parent().addClass("form_err_fld");o&&crmTemplate.setSubformFocusBlurEvent(m),"coborgName"==r&&t.closest(".labelValCreate").append(c)}t=null}),500)},getDuplicateErrorMsg:function(e,t,r,a){null==a&&(a=0);var i=e.FIELDLABEL,n=e.OWNERNAME,o=e.MODULE,s=void 0!==e.DUPCHKMODULE?e.DUPCHKMODULE:e.MODULE,l="Leads"!==s&&"Contacts"!==s?e.hasOwnProperty("RECORDS")?e.RECORDS[0].ENTITYNAME:e.CONVERTEDRECORDS[0].ENTITYNAME:e.hasOwnProperty("RECORDS")?e.RECORDS[0].ENTITYNAMEFORPOPOVER:e.CONVERTEDRECORDS[0].ENTITYNAMEFORPOPOVER;l="string"!=typeof l?"null":l;var c="",d="";c=Crm.userDetails.MODULE_LIST[s].plural_label?Crm.userDetails.MODULE_LIST[s].plural_label:Crm.userDetails.MODULE_LIST[s].pluralLabel,d=Crm.userDetails.MODULE_LIST[s].singular_label?Crm.userDetails.MODULE_LIST[s].singular_label:Crm.userDetails.MODULE_LIST[s].singularLabel;var u="1"==e.ISCF?i:I18n.getMsg(i,[d]);e.hasOwnProperty("i18nFieldLabel")&&(u=e.i18nFieldLabel);var m=t?"":I18n.getMsg("crm.duplicate.value.not.allowed")+" ",p=e.RECORDS[0].ENTITYID;if("1"==e.COUNT||"1"!=e.COUNT&&"Leads"!=s&&"Contacts"!=s&&"Accounts"!=s&&"Vendors"!=s){if(m+=I18n.getMsg("crm.duplicate.value.available",[I18n.getMsg("JobSheets"===o?Crm.userDetails.MODULE_LIST[o].singular_label:d).toLowerCase(),u]),m=$ESAPI.encoder().encodeForHTML(m),!r){var g=Crm.getCrmBasePath()+"/EntityInfo.do?module="+s+"&id="+p;g=Crm.getPortalURL(g),m+=" <a data-zcqa='viewExistingRecord' class='viewExistingRecordQuickInfo' id='viewExistingRecordQuickInfo"+a+'\' onmouseleave="Crm.dontHideQuickInfoPop(event);" onmouseenter="Crm.showExistingEmailQuickInfo(\''+$ESAPI.encoder().encodeForJavaScript(l)+"','"+$ESAPI.encoder().encodeForJavaScript(n)+"','"+$ESAPI.encoder().encodeForJavaScript(e.ZUID)+"','"+$ESAPI.encoder().encodeForJavaScript(d)+"','"+a+"',this)\" rel='noopener noreferrer' target='_blank' href='"+g+"'>"+I18n.getMsg("crm.view.record",I18n.getMsg(d))+"</a>"}}else if(m+=I18n.getMsg("crm.duplicate.value.available.multiple",[I18n.getMsg(d).toLowerCase(),u]),m=$ESAPI.encoder().encodeForHTML(m),!r&&"JobSheets"!=s){var h=Crm.getCrmBasePath()+"/EntityDuplicate.do?module="+s+"&id="+p+"&newTab=yes&findDupFldName="+i;h=Crm.getPortalURL(h),m+='<link-to lt-prop-target="_blank" lt-prop-route="crm.tab.module.entity.find-and-merge" lt-prop-qp=\'{"findDupFldName" :"'+i+"\"}'    lt-prop-dp='[\""+s+'","'+p+"\"]'>"+I18n.getMsg("crm.label.module.merge",I18n.getMsg(c))+"</link-to>"}return m},showExistingEmailQuickInfo:function(e,t,r,a,i,n,o){var s=$(n),l=($(n).closest("div").prev().text(),r?"https://"+RebrandLinkUtil.getProperty("CONTACTS_URL")+"/file?ID="+r+"&fs=thumb":networkUtils.getImageUrl("sprite_avatar_0f72e0b_.svg",ResourceConstants.CRM)),c=$(n).closest("div").find("input")[0]?$(n).closest("div").find("input")[0].id:$(n).closest("div")[0].id;o&&!c&&(c=$L(n).closest("crm-create-fields")[0].getAttribute("fld-id")),""===c&&(c=s.attr("id")),$L("crm-existing-email-quickinfo").length?$L("crm-existing-email-quickinfo")[0].setData({id:"viewExistingRecordQuickInfo"+i,lead_name:e,lead_owner:t,image_url:l,owner_label:I18n.getMsg("Lead Owner",a),lead_label:I18n.getMsg("Lead Name",a)}):Lyte.Component.render("crm-existing-email-quickinfo",{id:"viewExistingRecordQuickInfo"+i,lead_name:e,lead_owner:t,image_url:l,owner_label:I18n.getMsg("Lead Owner",a),lead_label:I18n.getMsg("Lead Name",a)},"#"+c),$L("#crmExistingEmailQuickInfoPopover")[0].ltProp({show:!0})},dontHideQuickInfoPop:function(e){$L("#crmExistingEmailQuickInfoPopover")[0].ltProp("bindToBody",!1),$L("crm-existing-email-quickinfo").hide()},hideDuplicateErrorMsg:function(e){var t;if((t=null!=e&&""!==e?$("form[name="+e+"] [id^='errorMsg_']"):$("[id^='errorMsg_']")).length>0)for(var r=0;r<t.length;r++){var a=t[r].id;$("#"+a.replace("(","\\(").replace(")","\\)")).remove();var i=a.substring(a.indexOf("_")+1).replace("(","\\(").replace(")","\\)"),n=$("#"+i);n&&0!==n.length||(n=$("[name='"+i+"']")),n.removeClass("errorHighlight").css({"border-color":""})}},isCpqActivated:function(){return void 0!==moduleRecordMapping.ZohoCPQ},getErrorKey:function(){for(var e,t,r=this.errorMsgArray[arguments[0]],a=this.errorMsgArray.default,i=1;i<arguments.length;i++)t=e=arguments[i],r&&(r=r[e]),a&&1!=i&&(a=a[t]);var n=r&&"object"!=typeof r?r:a;return n},validateEntityAndShowErrorMsg:function(e,t,r,a,i,n){var o,s;Crm.requestParamWithColname={},Crm.requestSubformBitMap={};var l=$("#VRAjaxEdit").is(":visible"),c=$("#createEditCallDiv"),d=$("#multipleFieldsEditPop"),u=$("#formRuleMandatoryFields"),m=u.is(":visible"),p=$("#addLinesBtnLwr").offset();$(".mandatory").removeClass("mandatory");var g,h=!0,f=!0,v=!0,C=crmTab.tabVsSubTabs[t],y={},E=void 0!==C?C.length:0;if(C&&E>0)for(var I=0;I<E;I++){Crm.requestSubformBitMap[C[I]]="";var w=$("#subform_"+C[I]);if(w.closest(".subformParentSection").is(":visible")||n&&n.isFrmBP){var T=$L("#errorMsg_"+w.data().dataSubformid);T.length>0&&T[0].remove();for(var b=!1,S=0,_=[],M=Crm.fieldsObj[t+"_"+C[I]],D=w.find("tbody tr"),A=D.length,k=D.closest("table").data("data-columnname"),N=!0,L=0;L<A;L++){var R=$(D[L]).data("data-linkingmodule_id"),O={};R&&(O.LINKINGMODULE_ID=R);for(var P="_"+$(D[L]).data("data-rowid"),U=!1,x=!1,F=0,V=0,H=[],B=!1,j=0;j<M.length;j++){if((fe=$("#"+M[j]+P)).length){if(116===(Ce=fe.data()).uitype||117===Ce.uitype)continue;if(n&&n.isFrmBP&&!0===Ce.mandate&&F++,fe.length&&(-1==M[j].indexOf("_SERIAL_NUMBER")||-1!=M[j].indexOf("_SERIAL_NUMBER")&&n&&n.isFrmBP)){var z=(Ce=fe.data()).name,W=Ce.displaylabel;if(!0===(ye=this.validateEntity(fe,t,r,n)).mandateFailed&&n&&n.isFrmBP){V++,delete Crm.requestParamWithColname[Ce.colname];continue}if(ye.paramvalues){for(var q in ye.paramvalues){$("#errorMsg_"+fe.attr("id")).remove();var Y=q.replace("property(","").replace(")","");""!=ye.paramvalues[q]&&(U=!0,x=!0),n&&n.isFrmBP&&133===Ce.uitype?Ce.id?O[Ce.colname]=Ce.id+"":O[Ce.colname]="":O[Y]=ye.paramvalues[q]}n&&n.isFrmBP&&delete Crm.requestParamWithColname[Ce.colname]}if(Crm.userDetails.isMandatorySubFormEnabled&&ye.mandateFailed){var J={};J.elem=fe,J.label=z,J.displayLabel=W,J.data=Ce,J.resultObj=ye,s||B||(J.isNeedToFocusFirst=!0,B=!0),H.push(J)}else!(f=ye.result?f:ye.result)&&!s&&fe&&fe[0]&&(s=fe),this.showErrorMessage(ye,fe,t,z,W,Ce,!0)}}}var G=H.length;if(U){if(_.push(O),Crm.userDetails.isMandatorySubFormEnabled&&(b=!0,S++,x))for(var K=0;K<G;K++){var Q=H[K];Q.isNeedToFocusFirst&&(s=Q.elem),this.showErrorMessage(Q.resultObj,Q.elem,Q.module,Q.label,Q.displayLabel,Q.data,!0),h=!1}}else if(Crm.userDetails.isMandatorySubFormEnabled&&(0!==S||L<A-1)){D.eq(L).remove(),w.closest(".subFrmLayout").find(".subFrmTablSerlNoOverlay tbody").html(""),crmTemplate.updateSubFormSerialNumber(t,w.data("dataSubformid"))}if(Crm.requestSubformBitMap[C[I]]=U?Crm.requestSubformBitMap[C[I]]+"1":Crm.requestSubformBitMap[C[I]]+"0",y[C[I]]=b,n&&n.isFrmBP){N=N&&!(0!==F&&0===V||0===F&&U);var X=w.closest(".subformParentSection").find(".errorFieldP");X.length>0&&$("#errorMsg_"+X.attr("id")).remove()}}if(Crm.userDetails.isMandatorySubFormEnabled&&0===A&&(k=w.data().dataColumnname,y[C[I]]=!1),Crm.requestParam["property("+k+")"]=JSON.stringify(_),n&&n.isFrmBP&&(n[C[I]]={},n[C[I]].resultObj={},n[C[I]].resultObj.mandateFailed=N,n[C[I]].resultObj.maxRowlimitFailed=A>w.data("dataMax_rows"),n[C[I]].resultObj.maxRowlimitFailed&&(h=!1)),Crm.userDetails.isMandatorySubFormEnabled&&!b&&"true"===w[0].getAttribute("subform-mandatory")){var Z=w.data().dataSubformsectionlabel;if(!s)for(var ee=w.find("tbody tr td"),te=ee.length,re=!0,ae=0;ae<te;ae++){var ie=ee.eq(ae).find("input");if(0===ie.length&&(ie=ee.eq(ae).find("select")),0===ie.length&&(ie=ee.eq(ae).find("textarea")),void 0!==ie&&0!==ie.length&&!ie.data("readonly")&&"SERIAL_NUMBER"!==ie.data().colname&&116!==ie.data().uitype){s=ie.eq(0),re=!1;break}}re?h=!0:(this.showSubformErrorMsg(I18n.getMsg(this.getErrorKey(t,Z,"mandate"),$ESAPI.encoder().encodeForHTML(Z)),C[I],w),h=!1)}}}d.is(":visible")?(c=d,g=!0):m?c=u:1==e.length?c=$("#fullInfoDiv"):l&&(c=$(".bodycontainer"));var ne=c.find("#secDiv_Reason_For_Incoming_Call").find("#Crm_Calls_DESCRIPTION"),oe=c.find("#secDiv_Outcome_Of_Outgoing_Call").find("#Crm_Calls_DESCRIPTION");"Campaigns"===t&&((n=null!=n?n:{}).zohoCampaignValidateProperties={Native__Campaigns__Extn__Campaign_Subject:{maxLength:125,negativeRegex:/^\s*()(Re:|Re:-|R e:|Re :-|Re :|fwd:|fwd:-| f w d :-|fwd :)/i,regexErrorKey:"crm.zcampaign.subject.regex.failure"},Native__Campaigns__Extn__Sender_Name:{maxLength:100,negativeRegex:/^([\w.]+)@([\w.]+)|[`~#^*[\]{}\\";$%<>+=?]/,regexErrorKey:"crm.mb.field.common.splc"}},detailView.isZohoCampaign()&&(n.zohoCampaignValidateProperties.Campaign_Name={maxLength:125,negativeRegex:/[`~#^*[\]{}\\";&<>%/]/,regexErrorKey:"crm.mb.field.common.splc"})),!Crm.userDetails.isLineItemSubformMvmtDone&&Crm.isInventoryModule(t)&&productDetails.rowIndexIssueWorkAround();var se=$("#bulkTaskNewPopup");if(se.length>0){var le=JSON.parse(se.val());Crm.requestParam["property(bulkIds)"]=le.idList;for(var ce=le.idList.split(";"),de="",ue=Lyte.Router.getRouteInstance().parent.currentModel.module_name,me={Leads:"Full_Name",Activities:"Subject",Accounts:"Account_Name",Contacts:"Full_Name",Potentials:"Potential_Name",Campaigns:"Campaign_Name",Cases:"Subject",Solution:"Solution_Title",Products:"Products_Name",Vendors:"Vendor_Name",PriceBooks:"Book_Name",Quotes:"Subject",SalesOrders:"Subject",PurchaseOrders:"Subject",Invoices:"Subject"}[ue],pe=0,ge=ce.length;pe<ge;pe++){var he=store.peekRecord(moduleRecordMapping[ue].id,ce[pe]);de+=(he[me]?he[me]:he.Full_Name)+"&&##"}Crm.requestParam["property(bulkNames)"]=de}for(pe=0,ge=e.length;pe<ge;pe++){var fe=$("#"+e[pe]);validationUtils.isEmpty(e[pe])||(fe=$("#"+e[pe]+":not(.quickinput)")),"Calls"==t&&isNewCallView&&(fe="Crm_Calls_DESCRIPTION"!==e[pe]||g?c.find("#"+e[pe]):ne.is(":visible")?ne:oe);var ve=fe.is(":visible");if(fe.length){var Ce;if(116===(Ce=fe.data()).uitype||117===Ce.uitype||"RECURRING_WEEKLY_REPEAT"===fe.colname||"duration_radio1"===Ce.colname||"duration_radio2"===Ce.colname)continue;if("555"==Ce.uitype&&parseInt($("#attachSize_"+Ce.fieldid).val())>20971520)return this.showErrorMsg(I18n.getMsg("crm.FileuploadField.size.limitstmt",$ESAPI.encoder().encodeForHTML(Ce.displaylabel)),fe,t),!1;if("555"==Ce.uitype&&parseInt($("#attachCount_"+Ce.fieldid).val())>Ce.maxlength)return this.showErrorMsg(I18n.getMsg("crm.file.upload.maxlength.exceeds",$ESAPI.encoder().encodeForHTML(Ce.displaylabel)),fe,t),!1;if((void 0===Ce.restricted||void 0!==Ce.restricted&&!Ce.restricted)&&Ce.readonly&&39!=Ce.uitype&&("DISCOUNT"!==Ce.colname||!Crm.isInventoryModule(t)))continue;if("Calls"===t&&isNewCallView&&("CALLTYPE"!==Ce.colname&&!ve||!0===Ce.skipWhileSubmit)&&!d.is(":visible"))continue;z=Ce.name,W=Ce.displaylabel;$("#errorMsg_"+fe.attr("id")).remove(),fe.closest(".tabDiv,.tabDivCreate").removeClass("errorFieldP"),"786"===Ce.uitype&&$("#"+e[pe]+"_TimeOption").closest(".tabDiv,.tabDivCreate").removeClass("errorFieldP");var ye=this.validateEntity(fe,t,r,n);if(Ce.uitype==CrmField.UITYPES.SERVICE_TIMING)if(0==ye&&o&&CSU.focus)delete CSU.focus;else{if(0!=ye&&ye.paramvalues["property(Available Time)"]!=I18n.getMsg("crm.service.servicetiming.business")){Crm.requestParam["property(Available Time)"]=JSON.stringify(ye.paramvalues["property(Available Time)"]);continue}if(0!=ye){Crm.requestParam["property(Available Time)"]="";continue}}if(Ce.uitype==CrmField.UITYPES.MULTI_DATE_SELECT&&0!=ye){Crm.requestParam["property(Available_Dates)"]=JSON.stringify(ye.paramvalues["property(Available_Dates)"]);continue}if(ye.mandateFailed&&i){n&&n.isFrmBP&&Ce.subFormTabId&&(n[Ce.subFormTabId].aggFldObj||(n[Ce.subFormTabId].aggFldObj={}),n[Ce.subFormTabId].resultObj.mandateFailed=!0,n[Ce.subFormTabId].aggFldObj[Ce.colname]=Crm.requestParamWithColname[Ce.colname],Crm.isInventoryModule(t)&&"TAX"===Ce.colname&&(n[Ce.subFormTabId].aggFldObj.$line_tax=Crm.requestParam["property(recordTaxDet)"])),delete Crm.requestParamWithColname[Ce.colname];continue}for(var q in ye.paramvalues)Crm.requestParam[q]=ye.paramvalues[q];if(Crm.userDetails.isMandatorySubFormEnabled&&void 0!==Ce.subFormTabId&&void 0!==y[Ce.subFormTabId]&&!0===Ce.defMandate&&!1===y[Ce.subFormTabId])continue;if(!(v=ye.result?v:ye.result)&&!o&&fe&&fe[0])if(Ce.uitype==CrmField.UITYPES.SERVICE_TIMING){var Ee=$("#timechange1_0"),Ie=$("#timechange1_1");CSU.focus?(o=CSU.focus,delete CSU.focus):o=Ee[0]?Ee:Ie[0]?Ie:fe}else o=fe;if("444"!==Ce.uitype&&"445"!==Ce.uitype||!Ce.clonedfrom||"CALLMXNCLONESCHEDULER"!==Ce.selectedid||$("#temp_"+fe.attr("id")).css("margin-top","0px"),this.showErrorMessage(ye,fe,t,z,W,Ce),n&&n.isFrmBP&&Ce.subFormTabId){n[Ce.subFormTabId].aggFldObj||(n[Ce.subFormTabId].aggFldObj={}),n[Ce.subFormTabId].aggFldObj[Ce.colname]=Crm.requestParamWithColname[Ce.colname],Crm.isInventoryModule(t)&&"TAX"===Ce.colname&&(n[Ce.subFormTabId].aggFldObj.$line_tax=Crm.requestParam["property(recordTaxDet)"]),delete Crm.requestParamWithColname[Ce.colname];continue}}}if(Crm.requestParam.UserDatePattern=Crm.userDetails.DATE_PATTERN,h=!(!f||!v)&&h,o||s){var we=$(s).closest(".secContent").data("data-secsequence"),Te=$(o).closest(".secContent").data("data-secsequence");o=we&&!Te||Te&&Te>we?s:o,r&&("SELECT"===o[0].nodeName?(o.focus(),o.select2("open"),$("html").css({overflow:""}),setTimeout((function(){$("html").css({overflow:"hidden"})}),1)):o.hasClass("imageUploadHead")?$L(window).scrollTo(o.offset().top-$("#createFixedButtonDiv").height()-10,{duration:500}):o.focus())}if("PriceBooks"==t){var be=$(".hrow1").length+1;for(pe=1;pe<be;pe++){var Se=parseFloat($("#Crm_PriceBooks_txtFromRange"+pe).val()),_e=parseFloat($("#Crm_PriceBooks_txtToRange"+pe).val());_e<Se&&(this.showErrorMsg(I18n.getMsg("crm.alert.selected.rangevalue"),$("#Crm_PriceBooks_txtToRange"+pe),t),h=!1);for(j=1;j<be;j++)if(pe!=j){var Me=parseFloat($("#Crm_PriceBooks_txtFromRange"+j).val()),De=parseFloat($("#Crm_PriceBooks_txtToRange"+j).val());(Se>=Me&&Se<=De||_e>=Me&&_e<=De&&j>pe)&&(this.showErrorMsg(I18n.getMsg("crm.alert.selected.rangevalue"),$("#Crm_PriceBooks_txtFromRange"+j),t),h=!1)}}}if("Events"===t&&!$("#eventRecurringDiv").is(":visible")&&$("#eventCreatePopup").is(":visible")){var Ae=$("#Crm_Events_REPEATTYPE").val();if(Ae&&"none"!=Ae)if("monthly"==$("#Crm_Events_RECURRING_FREQUENCY").val()&&"2"==$("input:radio[name='monthlyhidden']:checked").val()){var ke=$("#Crm_Events_RECURRING_CUSTOM_OCCUR_FIRST").val(),Ne=$("#Crm_Events_RECURRING_CUSTOM_OCCUR_DAY").val();"5"!=ke||"0"!=Ne&&"-1"!=Ne||(Crm.requestParam.monthlyhidden="1",Crm.requestParam.monthly1select=Ne)}return h?(Events.checkDuplicateEvent(void 0,!0,(function(e){var t=$("#Crm_Events_STATUS").data("oldValue"),r=$("#Crm_Events_STATUS").val(),i=$("#Crm_Events_STARTDATETIME").data("dateObj");if(0===t&&1===$("#Crm_Events_STATUS").val()&&Events.isRecEvent&&!confirm(I18n.getMsg("crm.event.rec.all.confirm.msg",[Events.getModuleName(!0,!1)])))return!1;if("edit"===Events.currentStatus){var n=(new Date).getTime(),o=new Date(Events.modifyingEvent.start),s=$("#Crm_Events_STARTDATETIME").data("dateObj");"edit"===Events.currentStatus&&o.getTime()<n&&s.getTime()>n?h=Events.showConfirmForModify(!1,Events.modifyingEvent,void 0,void 0,Event.isRecurringEditAvail?Events.editRecurringAlert:void 0):"edit"===Events.currentStatus&&n<o.getTime()&&n>s.getTime()?h=Events.showConfirmForModify(!0,Events.modifyingEvent,void 0,void 0,Event.isRecurringEditAvail?Events.editRecurringAlert:void 0):Events.isRecurringEditAvail&&(h=Events.editRecurringAlert(!1,Events.modifyingEvent))}if(h){var l={title:trimBoth($("#Crm_Events_SUBJECT").val()),start:i,oldStatus:t,status:r};h=Events.showSendMailAlert(l)}h&&(void 0===a?Events.saveEntity(void 0,!0,!0):Events.saveEntity(a,!0,!0))})),!1):h}if("Appointments"==t){if(h){var Le=$("#Crm_Appointments_APPOINTMENTDATEANDTIME"),$e=$("#Crm_Appointments_SERVICEID");if(Le.length>0&&$e.length>0&&!Events.isAppointmentReschedule&&"edit"!==Events.currentStatus){var Re=JSON.parse($e.attr("serviceJSON")),Oe=Le.data("dateObj"),Pe=60*Re.Duration*1e3,Ue=new Date(new Date(Oe).getTime()+Pe),xe=Utils.getTimeStringWithAmPm(Ue);if(Crm.requestParam["property(Appointment End Time)"]=Utils.getDateInUserDatePattern(Ue),Crm.requestParam["property(Appointment End Timehour)"]=xe.hrs,Crm.requestParam["property(Appointment End Timeminute)"]=xe.mins,Crm.requestParam["property(Appointment End Timeampm)"]="am"==xe.meridiem?"AM":"PM",Crm.requestParam.appointmentCreateFrom=Events.createSource,h=CSU.checkServiceAvailabilityTime(Le,!0))return $("#saveAppointmentsBtn").attr("value")===I18n.getMsg("crm.appointments.add.job.sheet")?(Crm.requestApp=Crm.requestParam,Crm.appFormRule={},Crm.appFormRule.rule=CFRExec,Crm.appFormRule.relatedId=CFRExec.relatedEntityMap,void Events.globalCreate(a,Events.createSource,"JobSheets")):(CSU.checkDuplicateEvent(Re,void 0,!0,(function(){void 0===a?Events.saveEntity(void 0,!0,!0):Events.saveEntity(a,!0,!0)}),void 0,CSU.appointmentPreferences.allow_booking_outside_businesshours,CSU.appointmentPreferences.allow_booking_outside_service_availability),!1);Le.focus()}else if(Events.isAppointmentReschedule)return(Re=Le.attr("serviceJSON"))&&(Re=JSON.parse(Re)),CSU.checkDuplicateEvent(Re,void 0,!0,(function(){CSU.rescheduleAppointment(!0)}),void 0,CSU.appointmentPreferences.allow_booking_outside_businesshours,CSU.appointmentPreferences.allow_booking_outside_service_availability),!1}}else if(Crm.isInventoryModule(t)&&!Crm.userDetails.isLineItemSubformMvmtDone){var Fe=$("#totalProductCount"),Ve=!1;if($("#multipleFieldsEditPop").is(":visible")&&n&&(Ve=n.isContinuous),Crm.userDetails.isLookupAdvancedSearchEnabledInLineItem&&Fe&&Fe.val()>0){for(var He=$("#linesTable"),Be=!0,je=$(Fe).val(),ze=1;ze<=je;ze++){var We=He.find("#hrow"+ze),qe=We.find("#Crm_"+t+"_PRODUCTDETAILS_"+ze);""!==qe.val()&&""!==We.find("#hdnProductId"+ze).val()||(this.showErrorMsg(I18n.getMsg("crm.field.empty.check","Product Details"),qe,t),Be=!1)}if(!Be)return!1}if(Fe&&$(Fe).val()<=0&&(!i||Ve))return $("#errorMsg_Crm_"+t+"_PRODUCTDETAILS").show(),o||window.scrollTo(0,p.top-200),!1;if(Fe&&$(Fe).val()>200)return alert(I18n.getMsg("crm.lineitem.exceeds.alert",I18n.getMsg("Line Items"))),!1;$("#errorMsg_Crm_"+t+"_PRODUCTDETAILS").hide();var Ye=!1;return $(".invValidate").each((function(){isNaN($(this).val())?(h=!1,$(this).addClass("errorHighlight"),o||Ye||(Ye=!0,$(this).focus(),$(this).select())):$(this).hasClass("errorHighlight")&&$(this).removeClass("errorHighlight")})),h}if("Tasks"===t){var Je=$("#Crm_Tasks_RECURRING"),Ge=$("#Crm_Tasks_REMINDAT");if(Ge.is(":checked")&&!Ge.is(":disabled")&&!Je.is(":checked")&&$("#Crm_Tasks_STATUS").val()!=crmTasks.compDispVal){if($("#Crm_Tasks_REMINDAT").hasClass("errorFieldAdded"))return!1;var Ke,Qe,Xe=null,Ze=null,et=null,tt=$("#Tasks_fldRow_RemindAt_Start_Date1 #Crm_Tasks_RemindAt_Start_Date1").data("dateObj");et=new Date(tt);Xe=" ";if($("#Crm_Tasks_RemindAt_remTime_Radio").prop("checked")){Xe=Crm.requestParam.remTime;var rt=$("#Crm_Tasks_DUEDATE");et=new Date(rt.data("dateObj"))}if(Ke=Crm.requestParam["property(Remind Athour)"]+"",Qe=Crm.requestParam["property(Remind Atminute)"]+"","HH:mm"!==Crm.userDetails.TIME_FORMAT&&(Ze=Crm.requestParam["property(Remind Atampm)"]),""==et||""==Ke||""==Qe)return!1;var at={date:et,hour:Ke,minute:Qe,ampm:Ze,eventBefore:Xe};Activities.checkForTaskReminderDate(at,(function(e){var t="crm.task.rem.validation1";getObjFromPopup("Crm_Tasks_RemindAt_Start_Date1_label",$("[name=createEntityNewForm]"));if($("#Crm_Tasks_RemindAt_Start_Date1_Radio").prop("checked")&&""!=Crm.requestParam["property(Due Date)"]){var r=crmCalendar.getDateObjectFromGivenDateString($("#Crm_Tasks_DUEDATE").val());Utils.compareDate(crmCalendar.getDateObjectFromGivenDateString($("#Crm_Tasks_RemindAt_Start_Date1").val()),r)||(e="true",t="crm.task.rem.validation2")}if("true"==e){$("#Tasks_fldRow_REMINDAT").addClass("errorFieldP");var a='<span class="errMsg errorMsgDesc" style="clear: both; color: rgb(221, 0, 0); font-size:1.1rem; display: block;">'+I18n.getMsg(t)+"</span>";$("#Tasks_fldRow_REMINDAT > .labelValCreate").append(a),h=!1}}))}}return h},showErrorMessage:function(e,t,r,a,n,o,s){if(556!==parseInt(o.uitype))if(e.mandateFailed)(444!==o.uitype||"Services"==r&&"MXNDUMMYCOLUMN_SERVICE"==o.colname)&&445!==o.uitype||$("#multipleFieldsEditPop").is(":visible")?(this.showErrorMsg(I18n.getMsg(this.getErrorKey(r,a,"mandate"),$ESAPI.encoder().encodeForHTML(n)),t,r,void 0,void 0,void 0,s),"786"===o.uitype&&$("#"+fieldsArray[i]+"_TimeOption").addClass("errorHighlight")):($("#temp_"+t.attr("id")).css("margin-top","1px"),this.showErrorMsg(I18n.getMsg(this.getErrorKey(r,a,"mxncloneproceed"),$ESAPI.encoder().encodeForHTML(n)),t,r));else if(e.maxlengthFailed)this.showErrorMsg(I18n.getMsg(this.getErrorKey(r,a,"maxLen"),[$ESAPI.encoder().encodeForHTML(n),o.maxlength]),t,r);else if(e.maxlimitFailed)this.showErrorMsg(I18n.getMsg(this.getErrorKey(r,a,"maxLimit"),[$ESAPI.encoder().encodeForHTML(n),o.maxlimit]),t,r);else if(e.maxRowlimitFailed)this.showErrorMsg(I18n.getMsg("crm.subform.record.create.maxrow.limit",[o.dataMax_rows,$ESAPI.encoder().encodeForHTML(n)]),t,r);else if(e.decimalLengthCheckFailed)this.showErrorMsg(I18n.getMsg(this.getErrorKey(r,a,"type","decimal"),[$ESAPI.encoder().encodeForHTML(n),o.decimalLength]),t,r);else if(e.surveyInvalidName)this.showErrorMsg(I18n.getMsg("crm.zsurvey.invalid.name.msg"),t);else if(e.surveyNameLenExceed)this.showErrorMsg(I18n.getMsg("crm.zsurvey.name.len.exceed.msg",[n]),t);else if(e.fieldValueInvalid)this.showErrorMsg(I18n.getMsg(e.invalidFieldMessageKey),t);else if(e.maxLenExceed)this.showErrorMsg(I18n.getMsg("crm.criteria.editor.no.of.characters.exceed",[n,e.maxAllowedLen]),t);else if(e.checkFailed){if(""===n||!n){var l=t.data("contentType");"date"===l||"Date"===l?n=I18n.getMsg("Date"):"decimal"===l&&(n=I18n.getMsg("Decimal"))}this.showErrorMsg(I18n.getMsg("crm.field.valid.check",[$ESAPI.encoder().encodeForHTML(n)]),t,r)}else if(e.integerFailed)""===n&&(n=I18n.getMsg("Integer")),this.showErrorMsg(I18n.getMsg(this.getErrorKey(r,a,"type","integer"),[$ESAPI.encoder().encodeForHTML(n),"integer"]),t,r);else if(e.comparisonFailed){var c={ENDDATE:"mouseArea__STARTDATE",SALES_END_DATE:"mouseArea__SALES_START_DATE",SUPPORT_EXPIRY_DATE:"mouseArea__SUPPORT_START_DATE"},d={Native__Backstage__Extn__Event_End_Date:"Native__Backstage__Extn__Event_Start_Date"},u=(g={ENDDATETIME:"Crm_Events_STARTDATETIME",Recurring_End_Date1:"Crm_Tasks_Recurring_Start_Date1",ENDDATE:"Crm_Campaigns_STARTDATE",SALES_END_DATE:"Crm_Products_SUPPORT_START_DATE",SUPPORT_EXPIRY_DATE:"Crm_Products_SUPPORT_START_DATE",APPOINTMENTENDTIME:"Crm_JobSheets_APPOINTMENTSTARTTIME"})[o.colname]?$("#"+g[o.colname]):$('[data-sysrefname="'+d[o.sysrefname]+'"]'),m=u.data("displaylabel");u.length<1&&(u=$("#"+c[o.colname]))[0]&&(m=u.data("params").displaylabel),m||(m=I18n.getMsg("current Time")),"JobSheets"===r&&"APPOINTMENTENDTIME"===o.colname||"Events"===r&&"ENDDATETIME"===o.colname?this.showErrorMsg(I18n.getMsg("crm.field.greater.check",['"'+$ESAPI.encoder().encodeForHTML(n)+'"','"'+m+'"']),t,r):this.showErrorMsg(I18n.getMsg("crm.field.comparision.check",['"'+$ESAPI.encoder().encodeForHTML(n)+'"','"'+m+'"']),t,r);var p=u.attr("id");0!==$("#errorMsg_"+p).length&&($("#errorMsg_"+p).remove(),u.closest(".tabDiv,.tabDivCreate").removeClass("errorFieldP"))}else if(e.lessThan){c={STARTDATE:"mouseArea__ENDDATE",SALES_START_DATE:"mouseArea__SALES_END_DATE",SUPPORT_START_DATE:"mouseArea__SUPPORT_EXPIRY_DATE"},d={Native__Backstage__Extn__Event_Start_Date:"Native__Backstage__Extn__Event_End_Date"};var g,h=(g={STARTDATETIME:"Crm_Events_ENDDATETIME",Recurring_Start_Date1:"Crm_Tasks_Recurring_End_Date1",STARTDATE:"Crm_Campaigns_ENDDATE",SALES_START_DATE:"Crm_Products_SALES_END_DATE",SUPPORT_START_DATE:"Crm_Products_SUPPORT_EXPIRY_DATE"})[o.colname]?$("#"+g[o.colname]):$('[data-sysrefname="'+d[o.sysrefname]+'"]'),f=h.data("displaylabel");h.length<1&&(h=$("#"+c[o.colname]))[0]&&(f=h.data("params").displaylabel),f||(f=I18n.getMsg("current Time")),"Events"===r&&"STARTDATETIME"==o.colname?this.showErrorMsg(I18n.getMsg("crm.custom.field.less.than",['"'+$ESAPI.encoder().encodeForHTML(n)+'"','"'+f+'"']),t,r):this.showErrorMsg(I18n.getMsg("crm.custom.field.less.than.equalto",['"'+$ESAPI.encoder().encodeForHTML(n)+'"','"'+f+'"']),t,r);var v=h.attr("id");0!==$("#errorMsg_"+v).length&&($("#errorMsg_"+v).remove(),h.closest(".tabDiv,.tabDivCreate").removeClass("errorFieldP"))}else e.filterNotMatched?this.showErrorMsg(I18n.getMsg("crm.lookupfilter.entity.errormsg",moduleRecordMapping[r].singular_label),t,r):e.startDatePast?this.showErrorMsg(I18n.getMsg("crm.past.date.check",[$ESAPI.encoder().encodeForHTML(n)]),t):e.customTimeLess1?(t=$("#timechange1_0"),this.showErrorMsg(I18n.getMsg("crm.service.servicetiming.alert"),t,r)):e.customTimeLess2&&(t=$("#timechange1_1"),this.showErrorMsg(I18n.getMsg("crm.service.servicetiming.alert"),t,r))},confirmInvoiceCreationWithLowStock:function(){var e;if(Crm.userDetails.isLineItemSubformMvmtDone)for(var t=$(".lineItemSubFrmRow").length,r=0;r<t;r++){var a=$(".lineItemSubFrmRow").eq(r).attr("id").split("_")[1],i=parseFloat($(productDetails.sfFldIdSuffix+"QUANTITY_"+a).val()),n=$(productDetails.sfFldIdSuffix+"PRODUCTID_"+a).attr("prdDetails"),o=n?JSON.parse(n).LAYOUTID:void 0;if(!o||Crm.userDetails.QuantityInStockAvailableLayoutIds.contains(o))if(i>(n?JSON.parse(n).Qty_in_Stock:0)){e=!0;break}}else for(t=$("#linesTbody").children().length,r=1;r<=t;r++){if((i=parseFloat($("#txtQty"+r).val()))>parseFloat($("#hdnQtyStock"+r).val())){e=!0;break}}return!e||window.confirm(I18n.getMsg("crm.invoice.stock.notavailable"))},checkIfLookUpAndLookUpValue:function(e,t){var r=Lyte.Router.getRouteInstance();if(null!=r)r.parent.getQueryParams().sub_module;else;var a=e.data();(a.lookupModule||a.permissionDeniedLookup)&&(t||(t=a.uitype))},validateEntity:function(e,t,r,a){var i,n=!0,o={result:!0},s=a&&a.fieldsArr?a.fieldsArr:void 0,l=void 0!==a?a.isFrmBP:void 0;if(e.length){var c=e.data(),d=c.name,u=c.contentType,m=c.uitype+"",p=c.displaylabel,g=c.sysrefname,h=$("#multipleFieldsEditPop").is(":visible");if("Lookup"===u){this.checkIfLookUpAndLookUpValue(e,m);var f=window[t].createEditJson;if(Crm.userDetails.isLookupFilterEnabled&&void 0!==f&&f.filterNotSatisfied&&f.fillupFieldColumn===c.colname&&f.entityid===c.id&&(o.filterNotMatched=!0,n=!1),!(e.is(":visible")&&c&&c.id&&c.hasOwnProperty("selectedlookupvalue")&&""!=e.attr("data-selectedlookupvalue"))||""===e.val()&&void 0===e[0].value||e.attr("data-old-value")==e.val()||e.val()==e[0].value&&e.attr("data-old-value")!=e.val()&&e.val()==e.attr("data-selectedlookupvalue")||(c.id=null,$("#"+e[0].id).data("id",null),e.data("id",null)),e.is(":visible")&&!c.id&&e.val()&&e.val().trim()&&c.lookupModule){var v=moduleRecordMapping[c.lookupModule].singular_label,C=I18n.getMsg("crm.label.lookup.norecord",v)+" ";if("Quotes"!==c.lookupModule&&"Invoices"!==c.lookupModule&&"SalesOrders"!==c.lookupModule&&"PurchaseOrders"!==c.lookupModule&&"Services"!==c.lookupModule){var y=$("<a class='cP autoRecordCreateAlert'>");y.attr({id:"lookupFieldAlertDiv","data-zcqa":"createNewRecord",onclick:"crmLookupAutoComplete.openSearchCreatePopUp('"+e[0].id+"','createPageLookup','"+c.lookupModule+"')"}).text(I18n.getMsg("crm.label.create.new")+" "+v),C+=y.get(0).outerHTML}return this.showErrorMsg(C,e,t),!1}}if("100"==m&&"Crm_Tasks_RECURRING_WEEKLY_DAYS"===e.attr("id")){for(var E=[],I=$("#Crm_Tasks_RECURRING_WEEKLY_DAYS").find(".circleInput:checked"),w=0;w<I.length;w++)E[w]=$(I[w]).val();i=E}else i=m===CrmField.UITYPES.MULTI_MODULE_LOOK_UP_ENTITY&&"Crm_Appointments_SEID"===e.attr("id")&&e.find("option").eq(0).attr("data-modulename-disabled")?e.find("option").eq(0).attr("data-modulename-disabled"):commonUtils.getValue(e);if(24==m&&"CLOSING_DATE"==c.colname&&"Services"===t&&!CFRExec.isLayoutRuleHiddenElem(c.colname)){var T=Crm.requestParam["property(Starts From)"];if(T&&i&&new Date(CrmDateUtils.convertdateToDBformat(i))-new Date(CrmDateUtils.convertdateToDBformat(T))<864e5)return new Date(CrmDateUtils.convertdateToDBformat(i)).getTime()==new Date(CrmDateUtils.convertdateToDBformat(T)).getTime()?(this.showErrorMsg(I18n.getMsg("crm.service.availfromto.samevaluealert"),e,t),!1):(this.showErrorMsg(I18n.getMsg("crm.service.availfromto.fromtoalert"),e,t),!1);var b=6e4*CrmDateUtils.getTimeOffsetInMins(Crm.userDetails.ORGTIME_ZONE);(new Date).getTime()}if(m==CrmField.UITYPES.LAYOUT_LOOKUP&&(i=e.data().id),m==CrmField.UITYPES.MULTI_DATE_SELECT)if(CFRExec.isLayoutRuleHiddenElem(c.colname))i=null;else{if($("#errorMsg_Crm_Services_AVAILABLE_DATES").remove(),0==(i=CSU.getServiceModuleAvailDates(i,e,t)))return!1;var S=renderingUtils.getPickListDisplayValuebyDomAndSysValue("Crm_Services_SERVICEAVAILABILITY","Specific Date(s)");if(null==i&&Crm.requestParam["property(Availability_Type)"]==S)return this.showErrorMsg(I18n.getMsg("crm.field.empty.check",[p]),e,t),!1}if($("#errorMsg_serviceDurationDiv").remove(),m==CrmField.UITYPES.SERVICE_DURATION&&i&&("none"==i||""==i.trim()))return this.showErrorMsg(I18n.getMsg(this.getErrorKey(t,d,"mandate"),$ESAPI.encoder().encodeForHTML(p)),e,t),!1;if(m==CrmField.UITYPES.SERVICE_TIMING&&i==I18n.getMsg("crm.service.servicetiming.custom")){if($("#CustomTiming0").removeClass("errorFieldP form_err_fld"),0==(i=CSU.getServiceTiming(t)))return!1}else if(m==CrmField.UITYPES.SERVICE_TIMING&&i==I18n.getMsg("crm.service.servicetiming.business")&&"custom"===Crm.businessJSON.type){if(CSU.checkServiceTimingandDurationWithBusinessHour()){var _=$("#serviceDurationDiv");return CSU.focus=_,this.showErrorMsg(I18n.getMsg("crm.service.dur.less.avail",moduleRecordMapping.Services.singular_label),_,t),!1}}if("PROBABILITY"===c.colname)if(i)c.oldValue==i&&"clone"!=window[t].currentStatus||i>=0&&i<=100||(o.integerFailed=!0,n=!1);else{var M=commonUtils.getValue($("#Crm_Potentials_STAGE"));i=M.substring(0,M.indexOf(":"))}if("1234"==m&&("Events"===t&&"REMINDAT"===c.colname?i=Events.getMultipleRemindersAsJson():"Appointments"==t&&(i=CSU.getAppointmentRemindersAsJson()),this.requestParamWithColname[c.colname]=i),"Events"===t&&104==m){if("REMINDINVITEESAT"===c.colname){var D=$("#Crm_Events_REMINDINVITEESAT").attr("data-value");i="none"===D?null:Events.getReminderforParticipants(D)}this.requestParamWithColname[c.colname]=i}if(445===m||"445"===m){(i=c.selectedid+"")&&"-"!==i||(i="");var A=i.split("-")[0];A&&A.length>0&&A.split(",").length>c.maxlength/2&&(o.maxlimitFailed=!0,c.maxlimit=c.maxlength/2,n=!1)}i="string"==typeof i?i.trim():i;var k=c.colname,N=c.oldValue,L=c.mandate+"";e.parent().parent().find(".labelTabCreate.newmandatory.csx").length>0&&(L="true"),556===parseInt(c.uitype)&&void 0===c.mandate&&$(".DetailViewInnerPage").is(":visible")&&!$("#formRuleMandatoryFields").is(":visible")&&(L=$("#mouseArea__"+c.colname).data("params").mandate+"");var R=CFRExec.isLayoutRuleHiddenElem(k);if("SALUTATION"===k&&(R=CFRExec.isLayoutRuleHiddenElem("FIRSTNAME")),!Crm.isHeadless&&CFRExec&&R&&!h&&(L="false"),"Events"==t&&"LOCATION"===k&&i.length>255&&(o.maxlengthFailed=!0,n=!1),"Events"!=t||"true"!==L||"SEID"!==k&&"CONTACTID"!==k)if("Campaigns"===t&&"true"===L&&"SURVEYSELECT"===k){var O=$("#Crm_Campaigns_SURVEYSELECT .zohoSurveyNone").text();i=O,""!==O&&void 0!==O&&"-None-"!==O||(o.mandateFailed=!0,n=!1)}else if("Campaigns"===t&&"true"===L&&"SURVEYTEXTFIELD"===k){var P=$("#Crm_Campaigns_SURVEYTEXTFIELD").val();i="string"==typeof P?P.trim():P;var U=new RegExp("^[a-zA-Z0-9()&._?\\s\\u00A1-\\uFFFF-]*$");""===i||void 0===i?(o.mandateFailed=!0,n=!1):U.test(i)?i.length>100&&(o.surveyNameLenExceed=!0,n=!1):(o.surveyInvalidName=!0,n=!1)}else if("true"==L&&"LOCATION"==k&&""==i)$("#meetingInclude").prop("checked")||(o.mandateFailed=!0,n=!1);else if("true"===L&&"ADDCOMMENT"===k&&validationUtils.isFieldEmpty(e)&&!/create|clone/.test(window[t].currentStatus))o.mandateFailed=!0,n=!1;else if("true"!=L||"HANDLER"!==k&&"221"!=m||e.data("id"))if("true"==L&&"RECURRING_WEEKLY_DAYS"==k)0==i.length&&(o.mandateFailed=!0,n=!1);else if("true"!==L||"444"!==m&&"445"!==m||""!==i&&"CALLMXNCLONESCHEDULER"!==c.selectedid)if("556"===m){var x;if($(".DetailViewInnerPage").is(":visible")&&!$L("#formRuleMandatoryFields").is(":visible")){var F=e.find("crm-image-upload-detail");void 0!==F[0]&&(x=F[0].component)}else{var V=e.find(".imageUploadHead[data-name="+c.colname+"] crm-image-upload-create");0===V.length&&(V=e.find("crm-image-upload-create")),void 0!==V[0]&&(x=V[0].component)}var H=$("#closedWon");if(H.is(":visible")&&(0===(V=H.find(".imageUploadHead[data-name="+c.colname+"] crm-image-upload-create")).length&&(V=e.find("crm-image-upload-create")),void 0!==V[0]&&(x=V[0].component)),void 0!==x)if("true"===L&&0===x.data.imageData.length){o.mandateFailed=!0,n=!1;var B=I18n.getMsg("crm.field.empty.check",$ESAPI.encoder().encodeForHTML(c.displaylabel));x.constructErrorDiv(B)}else x.removeErrorDiv()}else"true"!==L||("duration"===k||"durationUnit"===k)&&$("#Crm_Consents_duration_radio1").prop("checked")||m===CrmField.UITYPES.MULTI_MODULE_LOOK_UP_ENTITY&&"Crm_Appointments_SEID"===e.attr("id")||!validationUtils.isFieldEmpty(e)||"HANDLER"===k||"221"===m||"SMOWNERID"===k||"ADDCOMMENT"===k||(o.mandateFailed=!0,n=!1);else o.mandateFailed=!0,n=!1;else o.mandateFailed=!0,n=!1;else"Others"===$("#Crm_"+t+"_CONTACTID_select").val()?validationUtils.isFieldEmpty($("#Crm_"+t+"_SEID"))&&validationUtils.isFieldEmpty($("#Crm_"+t+"_CONTACID"))&&(o.mandateFailed=!0,n=!1):validationUtils.isFieldEmpty($("#Crm_"+t+"_CONTACTID"))&&"CONTACTID"===k&&(o.mandateFailed=!0,n=!1);if(a&&a.hasOwnProperty("zohoCampaignValidateProperties")&&a.zohoCampaignValidateProperties.hasOwnProperty(g)){var j=a.zohoCampaignValidateProperties;j.hasOwnProperty("Native__Campaigns__Extn__Campaign_Subject")&&!j.hasOwnProperty("Campaign_Name")&&(j.Campaign_Name={maxLength:125,negativeRegex:/[`~#^*[\]{}\\";&<>%/]/,regexErrorKey:"crm.mb.field.common.splc"});var z=$("#Crm_Campaigns_"+k).val();i="string"==typeof z?z.trim():z;var W=j[g];U=W.negativeRegex;validationUtils.isEmptyString(i)?"true"==L&&(o.mandateFailed=!0,n=!1):U.test(i)?(o.fieldValueInvalid=!0,o.invalidFieldMessageKey=W.regexErrorKey,n=!1):i.length>W.maxLength&&(o.maxLenExceed=!0,o.maxAllowedLen=W.maxLength,n=!1)}if(26==m&&i&&!e.data().readonly){var q=i.split(":");q.length<=2&&!q[1]&&(o.mandateFailed=!0,n=!1)}var Y=this.getSaveParamName(e,r,t,a),J=e.data();m+="";var G={};if(n||""!=i){switch(m){case"27":"SALUTATION"===k&&"-None-"===i&&(i="");break;case"555":fileupload.createObj={},fileupload.removedAttachmentIds.length>0&&(fileupload.createObj.removedAttachmentIds=fileupload.removedAttachmentIds),fileupload.uploadedFileObject.length>0&&(fileupload.createObj.uploadedFileObject=fileupload.uploadedFileObject),i=JSON.stringify(fileupload.createObj),this.requestParam["property(fileUploadObject)"]=i;break;case"556":var K=[],Q=[],X=[],Z=[],ee=$L("#preHTMLContainer_"+t).find("crm-image-upload-create"),te=ee.length;for(w=0;w<te;w++){for(var re=ee[w].component.data.imageData.length,ae=ee[w].component.data.removedIds,ie=ee[w].component.data.tempRemovedIds,ne=ee[w].component.data.previewPageChanges,oe=ee[w].component.data.sequenceChanges,se=ie.length,le=0;le<se;le++)X.push(ie[le]);var ce=ae.length;for(le=0;le<ce;le++)Q.push(ae[le]);var de=ne.length;if(Object.keys(oe).length>0){for(var ue in oe){for(var me=oe[ue],pe={},ge=0;ge<de;ge++){var he=ne[ge];if(he.uploadid===ue){pe=he;break}}pe.uploadid=ue,pe.Sequence=me,Z.push(pe)}Z.sort((function(e,t){return e.Sequence-t.Sequence}))}for(le=0;le<re;le++){var fe=ee[w].component.data.imageData[le];if(void 0!==fe.uploadedValues){var ve=JSON.parse(fe.uploadedValues);K.push({fieldId:ve.FieldId,fileName:ve.fileName,fileID:ve.resourceId,fromService:ve.fromService,linkToDocs:ve.linkToDocs,fromGoogleDocs:ve.fromGoogleDocs,description:ve.description,uploadId:fe.uploadid,fileSize:ve.streamsize,sequence:ve.sequence,OldFlow:!0})}}}var Ce={};K.length>0&&(Ce.uploadedFileObject=K),Q.length>0&&(Ce.removedAttachmentIds=Q),X.length>0&&(Ce.unUsedOrphanedIds=X),Z.length>0&&(Ce.previewObject=Z);var ye,Ee=JSON.stringify(Ce);if(this.requestParam["property(imageUploadObject)"]=Ee,CFRExec.mandatoryInputNeededElem.contains(k))if(void 0!==(ye=H.is(":visible")?H.find(".imageUploadHead[data-name="+c.colname+"] crm-image-upload-create"):e.find("crm-image-upload-create"))[0]){var Ie=ye[0].component.constructAPIRequestBody();Ie.length>0&&(this.requestParamWithColname[k]=Ie)}break;case"33":case"35":validationUtils.isValidPhoneNo(e,e.val())?i=commonUtils.getValue(e):(o.checkFailed=!0,n=!1),(we=c.maxlength)<i.length&&(o.checkFailed=!0,n=!1,o.maxlengthFailed=!0);break;case"34":case"38":case"143":case"144":case"145":case"36":var we=c.maxlength,Te=c.decimalLength,be=we-Te;if(["TAX","DISCOUNT"].indexOf(k)>-1&&Crm.isInventoryModule(t))break;if(CFRExec.isLayoutRuleHiddenElem(J.colname))break;if(validationUtils.isValidDecimal(i,be,Te,o))validationUtils.decimalLengthCheck(i,Te)||(o.decimalLengthCheckFailed=!0,n=!1);else o.checkFailed=!0,n=!1;break;case"32":case"52":""===i||validationUtils.isValidInteger(i)||(o.integerFailed=!0,n=!1),(we=c.maxlength)<i.length&&(o.checkFailed=!0,n=!1,o.maxlengthFailed=!0);break;case"11":case"110":(we=c.maxlength)<i.length&&(o.checkFailed=!0,n=!1,o.maxlengthFailed=!0);break;case"1":case"2":if("-None-"===i&&(i=""),"CALLDURATION"===k&&(""===i||validationUtils.isValidInteger(i)?(i=parseInt(i,10),/^\d{1}$/.test(i)&&(i="0"+i),"Calls"===t&&i>1439&&(o.maxlimitFailed=!0,n=!1)):h&&"--"===i?i="":(o.integerFailed=!0,n=!1)),"Users"!=t||0!=e.data().customfield||"Crm_Users_ALIAS"!=e[0].id&&"Crm_Users_STREET"!=e[0].id&&"Crm_Users_COUNTRY"!=e[0].id&&"Crm_Users_CITY"!=e[0].id&&"Crm_Users_STATE"!=e[0].id&&"Crm_Users_ZIPCODE"!=e[0].id||i.indexOf("|")>-1&&(o.checkFailed=!0,n=!1),"1"===m)(we=c.maxlength)<i.length&&(o.checkFailed=!0,n=!1,o.maxlengthFailed=!0);break;case"100":case"96":if(i||(i=""),i)if("Crm_Tasks_RECURRING_WEEKLY_DAYS"==e.attr("id")){for(var Se=0;Se<i.length;Se++)G["day"+parseInt(i[Se])]="on";i=void 0}else i=i.join(";");break;case"17":i=commonUtils.getRadioValue(d);break;case"42":if("Custom_Recurring_period"===c.colname&&"Tasks"===t)if("daily"===i)G.dailyhidden=2,G.daily111=$("#Crm_Tasks_RECURRING_DAILY_REPEAT_COUNT").val(),G.exceptholiday=$("#Crm_Tasks_EXCEPT_BUSINESS_HOLIDAY_0").is(":checked");else if("monthly"==i){var _e=$("#Crm_Tasks_RECURRING_MONTHLY_REPEAT_COUNT").val();G.noMonths1=_e,G.noMonths2=_e,G.nextbusin_holiday=$("#Crm_Tasks_NEXT_BUSINESS_HOLIDAY_MONTH_0").is(":checked")}else"yearly"===i&&(G.nextbusin_holiday=$("#Crm_Tasks_NEXT_BUSINESS_HOLIDAY_YEAR_0").is(":checked"));else if("Tasks"===t&&"Recurring_period"===c.colname){var Me=$("#Crm_Tasks_Recurring_period").find("option:selected").val(),De=new Date($("#Crm_Tasks_DUEDATE").data("dateObj"));"custom"!=Me&&"none"!=Me&&(G.repeatEveryCnt=1,"daily"==Me?(G.dailyhidden=1,G.exceptholiday=$("#Crm_Tasks_EXCEPT_BUSINESS_HOLIDAY_0").is(":checked")):"weekly"==Me?G.selectedWeekDays=De.getDay()+1:"monthly"==Me?(G.noMonths1=1,G.monthlyhidden=1,G.monthly1select=De.getDate(),G.nextbusin_holiday=$("#Crm_Tasks_NEXT_BUSINESS_HOLIDAY_MONTH_0").is(":checked")):"yearly"==Me&&(G.yearlyhidden=1,G.yearmonths=De.getMonth(),G.yearlydays1select=De.getDate(),G.nextbusin_holiday=$("#Crm_Tasks_NEXT_BUSINESS_HOLIDAY_YEAR_0").is(":checked")))}break;case"18":$("."+c.colname).each((function(){this.checked&&(G[this.name]="on")}));break;case"21":Ee=e.val()?e.val().trim():e.val();validationUtils.isValidWebUrl(Ee)||(o.checkFailed=!0,n=!1),(we=c.maxlength)<i.length&&(o.checkFailed=!0,n=!1,o.maxlengthFailed=!0);break;case"22":var Ae=e.val();Ae&&(Ae=Ae.trim()),validationUtils.isValidTwitter(Ae)||(o.checkFailed=!0,n=!1);break;case"25":Ee=e.val()?e.val().trim():e.val();validationUtils.isValidEmail(Ee)||(o.checkFailed=!0,n=!1);break;case"123":if("Events"==t&&(i=void 0),"RECURRING"===c.colname&&"Tasks"===t&&(i=e.is(":checked")&&!e.is(":disabled")?"on":void 0,i=CFRExec&&CFRExec.isLayoutRuleHiddenElem(k)?void 0:i,"custom"==$("#Crm_Tasks_Recurring_period").val())){var ke=$("#Crm_Tasks_Custom_Recurring_period").val();"daily"==ke?(crmTasks.removeArrayElements(Crm.fieldsObj[t],crmTasks.customWeeklyFields),crmTasks.removeArrayElements(Crm.fieldsObj[t],crmTasks.customMonthlyFields),crmTasks.removeArrayElements(Crm.fieldsObj[t],crmTasks.customYearlyFields)):"weekly"==ke?(crmTasks.removeArrayElements(Crm.fieldsObj[t],crmTasks.customDailyFields),crmTasks.removeArrayElements(Crm.fieldsObj[t],crmTasks.customMonthlyFields),crmTasks.removeArrayElements(Crm.fieldsObj[t],crmTasks.customYearlyFields)):"monthly"==ke?(crmTasks.removeArrayElements(Crm.fieldsObj[t],crmTasks.customDailyFields),crmTasks.removeArrayElements(Crm.fieldsObj[t],crmTasks.customWeeklyFields),crmTasks.removeArrayElements(Crm.fieldsObj[t],crmTasks.customYearlyFields)):"yearly"==ke&&(crmTasks.removeArrayElements(Crm.fieldsObj[t],crmTasks.customDailyFields),crmTasks.removeArrayElements(Crm.fieldsObj[t],crmTasks.customWeeklyFields),crmTasks.removeArrayElements(Crm.fieldsObj[t],crmTasks.customMonthlyFields))}e.data().recdata&&("Tasks"===t&&"clone"===window[t].currentStatus?G.recAct="":G.recAct=e.data().recdata,G.oldEntityId=crmHistory.getCurrentStateData().id,G.userId=Crm.userDetails.USER_ID),e.is(":checked")||(delete G["property(Recurring Activity)"],delete this.requestParam["property(Recurring Activity)"]);break;case"301":case"300":i="RECURRING_INVITATIONMAIL"===c.colname?e.is(":checked")?"1":"0":"OTHERSERVICE"===c.colname?"true"===i?"on":"":e.is(":checked")?"on":"";break;case"24":case"202":case"14":case"786":case"30":case"333":if("checkbox"==e.attr("type")&&"Tasks"==t){if(e.is(":checked")){var Ne=$("#Crm_Tasks_RECURRING").is(":checked");if(G.remCheckTask="on",Ne){crmTasks.updateAllUpcomingRem&&(G.remOnAllUpcomingTasks=!0);var Le=$("#Crm_Tasks_remTime_TimeOption");ze=(je=Le.val().split(" ")[0]).split(":");G["property(Remind Athour)"]=ze[0],G["property(Remind Atminute)"]=ze[1];var $e=Utils.getMeridiem(Le.timeEntry("getTime")).toUpperCase();G["property(Remind Atampm)"]=$e,G["Remind AtdateTime"]=Le.val(),(E=$("#Crm_Tasks_remTime").val())&&"none"!=E&&("Events"==t?Crm.calPreferences.TURNOFFEMAILREMINDER?G.alertRadio=G.alertType="email":G.alertRadio=G.alertType="popup":G.alertRadio=this.requestParam.alertType=$("#Crm_Tasks_RemindAt_Notify").val(),G.remTime=E+" "+$("#Crm_Tasks_remTime_Period").val())}else{var Re="Crm_Tasks_RemindAt_Start_Date1",Oe=$("#"+Re).val(),Pe=$("#Crm_Tasks_RemindAt_remTime_Radio").prop("checked"),Ue=Pe?$("#Crm_Tasks_remTime_TimeOption"):$("#Crm_Tasks_RemindAt_Start_Date1_TimeOption"),xe=(ze=(je=Ue.val().split(" ")[0]).split(":"))[0],Fe=ze[1],Ve=Utils.getMeridiem(Ue.timeEntry("getTime")).toUpperCase();e,G["property(Remind Athour)"]=xe,G["property(Remind Atminute)"]=Fe,G["property(Remind Atampm)"]=Ve.toUpperCase(),G["property(Start Date1)"]=Oe,G["Remind AtdateTime"]=$("#"+Re+"_TimeOption").val(),G.remTime=0,G.remTime=Pe?$("#Crm_Tasks_remTime").val()+" "+$("#Crm_Tasks_remTime_Period").val():0,i=Oe,G.alertRadio=G.alertType=$("#Crm_Tasks_RemindAt_Notify").val()}G.remTaskRepeat=$("#Crm_Tasks_RemindAt_period").val()}else crmTasks.remOffAll&&(G.remOffAllUpcomingTasks=!0),delete this.requestParam.remCheckTask,delete G.remCheckTask;break}"Tasks"===t&&"DUEDATE"===c.colname&&$("#Crm_Tasks_RECURRING").is(":checked")&&(i=$("#Crm_Tasks_Recurring_Start_Date1").lenght?$("#Crm_Tasks_Recurring_Start_Date1").val():i),i=i.replace(Crm.userDetails.DATE_PATTERN,"");var He=$("#createEditCallDiv"),Be="Calls"==t&&isNewCallView&&He.is(":visible")?He.find("#"+e.attr("id")+"_TimeOption"):$("#"+e.attr("id")+"_TimeOption");if("24"!=m&&"202"!=m)var je=Be.val().split(" ")[0];if(c.mandate+""=="true"&&"24"!=m&&"202"!=m&&""==je&&(n=!1,o.mandateFailed=!0),""==i||Utils.isValidDate(Crm.userDetails.DATE_PATTERN,i)||(o.checkFailed=!0,n=!1),""!==i&&Utils.isValidDate(Crm.userDetails.DATE_PATTERN,i))$L("#changeOwnerPopUp").is(":visible")&&new Date(CrmDateUtils.convertdateToDBformat(i)).getFullYear()<1e3&&(o.checkFailed=!0,n=!1);if(("786"==m||"30"==m||"14"==m||"333"==m)&&""!=i){var ze=je.split(":"),We=($e=""!=je?Utils.getMeridiem(Be.timeEntry("getTime")).toUpperCase():"AM",""!=je?ze[0]:"00"),qe=""!=je?ze[1]:"00";Utils.isValidTime(We,qe)||(o.checkFailed=!0,n=!1),We&&(G[Y.substring(0,Y.indexOf(")"))+"hour)"]=We),qe&&(G[Y.substring(0,Y.indexOf(")"))+"minute)"]=qe),$e&&(G[Y.substring(0,Y.indexOf(")"))+"ampm)"]=$e),"HH:mm"!==Crm.userDetails.TIME_FORMAT?this.requestParamWithColname[k]=i+" "+We+":"+qe+" "+$e:this.requestParamWithColname[k]=i+" "+We+":"+qe}if("JobSheets"===t&&"APPOINTMENTENDTIME"===c.colname||"ENDDATETIME"==c.colname||"Recurring_End_Date1"==c.colname||"ENDDATE"==c.colname||"SALES_END_DATE"==c.colname||"SUPPORT_EXPIRY_DATE"==c.colname||"Native__Backstage__Extn__Event_End_Date"==c.sysrefname){var Ye=e,Je=c.dateObj,Ge={ENDDATE:"mouseArea__STARTDATE",SALES_END_DATE:"mouseArea__SALES_START_DATE",SUPPORT_EXPIRY_DATE:"mouseArea__SUPPORT_START_DATE"},Ke={Native__Backstage__Extn__Event_End_Date:"Native__Backstage__Extn__Event_Start_Date"},Qe=(at=(rt={ENDDATETIME:"Crm_Events_STARTDATETIME",Recurring_End_Date1:"Crm_Tasks_Recurring_Start_Date1",ENDDATE:"Crm_Campaigns_STARTDATE",SALES_END_DATE:"Crm_Products_SALES_START_DATE",SUPPORT_EXPIRY_DATE:"Crm_Products_SUPPORT_START_DATE",APPOINTMENTENDTIME:"Crm_JobSheets_APPOINTMENTSTARTTIME"})[c.colname]?$("#"+rt[c.colname]):$('[data-sysrefname="'+Ke[c.sysrefname]+'"]')).data("dateObj"),Xe=validationUtils.isFieldEmpty(Ye),Ze=validationUtils.isFieldEmpty(at);if(validationUtils.isFieldEmpty(at)&&validationUtils.isFieldEmpty(Ye))break;if(at.length<1){var et=$("#"+Ge[c.colname]);if(et.length>0){Qe=new Date(et.data("params").defaultvalue);var tt=$("#subvalue_"+et.data("params").colname);Ze=!1,tt.length>0&&tt.text().trim().length<1&&(Ze=!0)}}if(Ze||Xe)break;Qe&&(("JobSheets"===t&&"APPOINTMENTENDTIME"===c.colname&&"ENDDATETIME"==c.colname||Utils.compareDate(Qe,Je))&&(("JobSheets"!==t||"APPOINTMENTENDTIME"!==c.colname)&&"ENDDATETIME"!=c.colname||Utils.compareDateandTime(Qe,Je))||(o.comparisonFailed=!0,n=!1))}if("STARTDATETIME"==c.colname||"Recurring_Start_Date1"==c.colname||"STARTDATE"==c.colname||"SALES_START_DATE"==c.colname||"SUPPORT_START_DATE"==c.colname||"Native__Backstage__Extn__Event_Start_Date"==c.sysrefname){var rt,at=e;Qe=c.dateObj,Ge={STARTDATE:"mouseArea__ENDDATE",SALES_START_DATE:"mouseArea__SALES_END_DATE",SUPPORT_START_DATE:"mouseArea__SUPPORT_EXPIRY_DATE"},Ke={Native__Backstage__Extn__Event_Start_Date:"Native__Backstage__Extn__Event_End_Date"},Je=(Ye=(rt={STARTDATETIME:"Crm_Events_ENDDATETIME",Recurring_Start_Date1:"Crm_Tasks_Recurring_End_Date1",STARTDATE:"Crm_Campaigns_ENDDATE",SALES_START_DATE:"Crm_Products_SALES_END_DATE",SUPPORT_START_DATE:"Crm_Products_SUPPORT_EXPIRY_DATE"})[c.colname]?$("#"+rt[c.colname]):$('[data-sysrefname="'+Ke[c.sysrefname]+'"]')).data("dateObj"),Xe=validationUtils.isFieldEmpty(Ye),Ze=validationUtils.isFieldEmpty(at);if(validationUtils.isFieldEmpty(at)&&validationUtils.isFieldEmpty(Ye))break;if(Ye.length<1){var it=$("#"+Ge[c.colname]);if(it.length>0){Je=new Date(it.data("params").defaultvalue);var nt=$("#subvalue_"+it.data("params").colname);Xe=!1,nt.length>0&&nt.text().trim().length<1&&(Xe=!0)}}if(Ze||Xe)break;if(Ke[c.sysrefname])if((Qe=new Date($("#Crm_"+t+"_"+c.colname).data("dateObj")))<new Date){o.startDatePast=!0,n=!1;break}Je&&(("STARTDATETIME"==c.colname||Utils.compareDate(Qe,Je))&&("STARTDATETIME"!=c.colname||Utils.compareDateandTime(Qe,Je))||(o.lessThan=!0,n=!1))}if("Calls"==t&&"CALLSTARTDATETIME"===c.colname&&!isNewCallView){var ot=commonUtils.getRadioValue("whichCall");Qe=e.data("dateObj");"ScheduleCall"===ot?Qe&&!Utils.compareDateandTime(new Date,Qe)&&(o.comparisonFailed=!0,n=!1):"CompletedCall"===ot&&"edit"!=window[t].currentStatus&&Qe&&!Utils.compareDateandTime(Qe,new Date)&&"edit"!=window[t].currentStatus&&(o.lessThan=!0,n=!1),G.whichCall=ot}break;case"Time":Utils.isValidTime(e.val())||(n=!1);break;case"41":i=JSON.stringify(Events.invJsonCreate),"edit"==Events.currentStatus&&(Events.invRemoveJson.e=Events.removeInvEmailsList,Events.invAddJson.e=Events.addInvEmailsList,G.invRemoveJson=JSON.stringify(Events.invRemoveJson),G.invAddJson=JSON.stringify(Events.invAddJson),i=void 0);break;case"221":i=e.data().id;break;case"8":if(i=e.val(),"Appointments"==t)if(!(i=document.getElementById("Crm_Appointments_SMOWNERID").component.getData("dataId"))){n=!1,o.mandateFailed=!0;break}if(Crm.userDetails.LITE.IS_LITE_USER&&(!i&&!e.data().id||i===Crm.userDetails.USER_ID||e.data().id===Crm.userDetails.USER_ID)){n=!1,o.mandateFailed=!0;break}G["property(ownerId)"]=e.data().id,G["property(ownerName)"]=$("#ownerNameLookupSpan").text(),this.requestParamWithColname[k]=e.data().id;break;case"208":G["property(Layout)"]=e.val();break;case"55":i=e.val(),G["property(ownerName:Handler)"]=e.data().id,this.requestParamWithColname[k]=e.data().id;break;case"4":case"5":case"6":case"7":case"9":case"10":case"12":case"13":case"15":case"133":case"135":if((i=e.data("id"))&&"null"!=i?i+="":i="","Events"===t)var st=$("#Crm_"+t+"_CONTACTID_select").val();else if("Tasks"===t||"Calls"===t)st=$("#Crm_"+t+"_CONTACTID_WhoId_select").val();if(/Calls|Tasks/.test(t)&&!st&&(G["property(modsel)"]=$("#Crm_"+t+"_SEID_label_select").val()||$("#Crm_"+t+"_SEID_select").val(),G["property(modname)"]=$("#Crm_"+t+"_SEID").val(),""!=trimBoth($("#Crm_"+t+"_SEID").val())&&(G["property(modid)"]=$("#Crm_"+t+"_SEID").data("id"))),/Events|Calls|Tasks/.test(t)&&"CONTACTID"==k&&st&&"None"!=st)"Leads"==st||"Contacts"==st?(G["property(leContModId)"]=i,G["property(leContModSel)"]=st,G["property(leContModName)"]=$("#Crm_"+t+"_CONTACTID").val(),G["property(modsel)"]=$("#Crm_"+t+"_SEID_label_select").val()||$("#Crm_"+t+"_SEID_select").val(),G["property(modname)"]=$("#Crm_"+t+"_SEID").val(),""!=trimBoth($("#Crm_"+t+"_SEID").val())&&(G["property(modid)"]=$("#Crm_"+t+"_SEID").data("id"))):"Others"==st?(G["property(modsel)"]=$("#Crm_"+t+"_SEID_label_select").val()||$("#Crm_"+t+"_SEID_select").val(),G["property(modname)"]=$("#Crm_"+t+"_SEID").val(),""!=trimBoth($("#Crm_"+t+"_SEID").val())&&(G["property(modid)"]=$("#Crm_"+t+"_SEID").data("id"))):"PhoneNumbers"==st&&(G["property(Customer Number)"]=$("#Crm_"+t+"_CONTACTID").val(),G["property(modsel)"]=$("#Crm_"+t+"_SEID_label_select").val()||$("#Crm_"+t+"_SEID_select").val(),G["property(modname)"]=$("#Crm_"+t+"_SEID").val(),""!=trimBoth($("#Crm_"+t+"_SEID").val())&&(G["property(modid)"]=$("#Crm_"+t+"_SEID").data("id"))),"Tasks"===t&&l||(i=void 0);else if("SEID"===k&&m!==CrmField.UITYPES.MULTI_MODULE_LOOK_UP_ENTITY.toString())i=void 0;else{var lt=J.subformdisplaylabel,ct="true"==J.customfield?J.colname:J.name;if(l&&lt&&!1===J.customfield&&Crm.isLineItemSubFormModule(lt)&&(ct=J.colname),Crm.isLineItemSubFormModule(lt)&&"PRODUCTID"===c.colname){var dt=e.attr("prdDetails");if(""===(Ee=e.val())||void 0===dt&&Ee.length>0||void 0!==dt&&Ee!==function(e,t){var r=JSON.parse(e),a=r.Product_Name.replace(/(\r\n|\n|\r)/gm," ");return t&&r.Product_Code&&""!==r.Product_Code&&(a=a+" ("+r.Product_Code+")"),a}(dt,J.lineitemprodcode)){var ut=e.val(),mt=e.closest("div"),pt=mt.find(".prdError");if(ut.length>0&&0===pt.length){var gt=document.createElement("span");gt.setAttribute("class","prdError errMsg errorMsgDesc"),gt.innerText=I18n.getMsg("crm.subform.lineitem.product.name.error"),mt.append(gt)}n=!1}}t&&moduleRecordMapping[t]&&"linking"===moduleRecordMapping[t].generated_type&&J.colname.indexOf("LINKINGMXN")>-1&&(ct=J.sysrefname),G["property("+ct+")"]=e.val()}if("Calls"===t&&isNewCallView&&"CONTACTID"===k&&validationUtils.isEmpty(G["property(leContModId)"]))if("ScheduledCall"==crmCallsNew.getCallStartTimeWithInfo().whichCall){var ht=I18n.getMsg("crm.call.callto.empty.check.qcreate");renderingUtils.showCustomAlert(ht),n=!1}break;case"132":"Lookup"===J.contentType&&(i=e.data("id")),i&&"null"!=i?i+="":i="";ct="true"===J.customfield||"Lookup"===J.contentType?J.colname:J.name;if(t&&moduleRecordMapping[t]&&"linking"===moduleRecordMapping[t].generated_type&&J.colname.indexOf("LINKINGMXN")>-1&&(ct=J.sysrefname),"APPOINTMENTFOR"===k&&"krp"===Events.createSource){var ft=$("#Crm_Appointments_APPOINTMENTFOR_RELATEDTO");G["property(modsel)"]=ft.data("lookup-module"),G["property(modid)"]=ft.data("id")}G["property("+ct+")"]=e.val();break;case"444":case"445":var vt="";(i=e.data("id"))&&"null"!=i||(i=e.data("selectedid"))&&"null"!=i||(i="");var Ct=e.data("clonedfrom");if(Ct&&(G.cloneEntityId=Ct),"Users"!=e.data("lookupModule")&&(e.data("unselectedid")&&(vt=e.data("unselectedid")),i=i+"-"+vt),"Events"===t)st=$("#Crm_"+t+"_CONTACTID_select").val();else if("Tasks"===t||"Calls"===t)st=$("#Crm_"+t+"_CONTACTID_WhoId_select").val();if(/Calls|Tasks/.test(t)&&!st&&(G["property(modsel)"]=$("#Crm_"+t+"_SEID_label_select").val()||$("#Crm_"+t+"_SEID_select").val(),G["property(modname)"]=$("#Crm_"+t+"_SEID").val(),""!=trimBoth($("#Crm_"+t+"_SEID").val())&&(G["property(modid)"]=$("#Crm_"+t+"_SEID").data("id"))),/Events|Calls|Tasks/.test(t)&&"CONTACTID"==k&&st&&"None"!=st)"Leads"==st||"Contacts"==st?(G["property(leContModId)"]=i,G["property(leContModSel)"]=st,G["property(leContModName)"]=$("#Crm_"+t+"_CONTACTID").val(),G["property(modsel)"]=$("#Crm_"+t+"_SEID_label_select").val()||$("#Crm_"+t+"_SEID_select").val(),G["property(modname)"]=$("#Crm_"+t+"_SEID").val(),""!=trimBoth($("#Crm_"+t+"_SEID").val())&&(G["property(modid)"]=$("#Crm_"+t+"_SEID").data("id"))):"Others"==st&&(G["property(modsel)"]=$("#Crm_"+t+"_SEID_label_select").val()||$("#Crm_"+t+"_SEID_select").val(),G["property(modname)"]=$("#Crm_"+t+"_SEID").val(),""!=trimBoth($("#Crm_"+t+"_SEID").val())&&(G["property(modid)"]=$("#Crm_"+t+"_SEID").data("id"))),i=void 0;else if("SEID"==k)i=void 0;else if(-1!=k.indexOf("MXNDUMMYCOLUMN")){ct="true"===J.customfield?J.colname:J.name;"Services"==t&&"MXNDUMMYCOLUMN_SERVICE"==J.colname||(G["property("+ct+")"]=i),h&&(445===m||"445"===m)&&i&&validationUtils.isEmpty(i.toString().split("-")[0])&&(o.mandateFailed=!0,n=!1)}else{ct="true"==J.customfield?J.colname:J.name;t&&moduleRecordMapping[t]&&"linking"===moduleRecordMapping[t].generated_type&&J.colname.indexOf("LINKINGMXN")>-1&&(ct=J.sysrefname),G["property("+ct+")"]=e.val()}if("Calls"===t&&isNewCallView&&"CONTACTID"===k&&validationUtils.isEmpty(G["property(leContModId)"]))if("ScheduledCall"==crmCallsNew.getCallStartTimeWithInfo().whichCall){ht=I18n.getMsg("crm.call.callto.empty.check.qcreate");renderingUtils.showCustomAlert(ht),n=!1}break;case"1234":E=$("#Crm_"+t+"_REMINDAT").val();if("Events"===t){var yt=Events.maxReminderValue;for(w=1;w<=yt;w++)if("none"!=$("#Crm_Events_REMINDAT"+w).attr("data-value")&&null!=$("#Crm_Events_REMINDAT"+w).attr("data-value")){E=$("#Crm_Events_REMINDAT"+w).attr("data-value");break}}("Events"===t?E&&"none"!=E:E&&"none"!=E&&"0"!=E)&&(G.remCheckTask="on","Events"===t&&(Crm.calPreferences.TURNOFFEMAILREMINDER?G.alertType="email":G.alertType="popup"),G.remTime=E,G.remTaskRepeat="none")}if("text"===e.attr("type")&&"Lookup"!==J.contentType)(we=e.attr("data-cscript-maxlength"))&&we<i.length&&(o.checkFailed=!0,n=!1,o.maxlengthFailed=!0)}if(!Crm.isHeadless&&CFRExec&&!0===o.checkFailed&&CFRExec.isLayoutRuleHiddenElem(k)&&(o.checkFailed=!1,n=!0,i=void 0),void 0!==i&&"555"!==m&&"556"!==m){if("Tasks"==t&&"property(Remind At)"==Y&&($("#Crm_Tasks_RECURRING").prop("checked")||$("#Crm_Tasks_RemindAt_remTime_Radio").prop("checked"))){var Et=$("#Crm_Tasks_DUEDATE");1==Et.length?G[Y]=Et.val():G[Y]=null}else!i||1!=m&&11!=m&&27!=m&&127!=m&&62!=m||(i=renderingUtils.removeMultiSpacestoSingleSpace(i)),G[Y]=i;this.requestParamWithColname[k]||("300"!==m&&"301"!==m||(i="on"===i),(void 0===s||s&&s.indexOf(e.attr("id"))>-1)&&(this.requestParamWithColname[k]=i))}if("Events"===t){if(Events.appendEventParams(k),"edit"!==Events.currentStatus){G["property(notified_all)"]=!1}var It="property(Who Id)";delete Crm.requestParam[It],delete G[It]}if("Calls"===t&&($("#Crm_Calls_CALLDURATION_Mins").is(":visible")||!Crm.isHeadless)){var wt=Crm.requestParam["property(DurationInMinute)"],Tt=Crm.requestParam["property(DurationInSecond)"];wt=wt||G["property(DurationInSecond)"],Tt=Tt||G["property(DurationInSecond)"],G["property(Call Duration)"]=wt||Tt?(wt||"00")+":"+(Tt||"00"):"","CALLDURATION"==k&&h&&(""===G["property(Call Duration)"]?delete this.requestParamWithColname[k]:this.requestParamWithColname[k]=$("#Crm_Calls_CALLDURATION_Mins").val()+":"+$("#Crm_Calls_CALLDURATION_Secs").val())}i!==N&&(Crm.isRecordModified=!0),Crm.isInventoryModule(t)&&!Crm.userDetails.isLineItemSubformMvmtDone&&(h&&void 0!==a?productDetails.setParamsForInventory(!0,a.relListId):productDetails.setParamsForInventory())}return o.paramvalues=G,o.result=n,o},hideBHPopup:function(){removeFreezeLayer(),$("#showBHPopup").remove()},getSaveParamName:function(e,t,r,a){var i=e.data(),n=i.colname,o=i.subformdisplaylabel,s=void 0!==a?a.isFrmBP:void 0,l="true"===i.customfield||"true"===i.customfield||i.uitype===CrmField.UITYPES.MULTI_MODULE_LOOK_UP_ENTITY&&"Lookup"===i.contentType?i.colname:i.name;if(s&&o&&!1===i.customfield&&Crm.isLineItemSubFormModule(o)&&(l=n),r&&moduleRecordMapping[r]&&"linking"===moduleRecordMapping[r].generated_type&&i.colname.indexOf("LINKINGMXN")>-1&&(l=i.sysrefname),1!=i.customfield&&"Users"===this.moduleName)return l=UserModule.getSaveParam(i.label);if(i.lookupModule&&"MultiModuleLookup"!==i.contentType){var c=i.lookupModule;l=this.getLookupIdName(c)+":"+l}else{if(/RECURRING_DAILY_EVERYDAY|Recurring_period|RECURRING_MONTHLY_DAYS_NO|RECURRING_MONTHLY_MONTH_NO|RECURRING_MONTHLY_WEEKSEQUENCE_TYPE|RECURRING_MONTHLY_WEEKSEQUENCE_DAY|RECURRING_MONTHLY_WEEKSEQUENCE_MONTH_NO|RECURRING_YEARLY_DAYS_OF_MONTH|RECURRING_YEARLY_DAYS_NO|RECURRING_YEARLY_WEEKSEQUENCE_TYPE|RECURRING_YEARLY_WEEKSEQUENCE_NO|RECURRING_YEARLY_WEEKSEQUENCE_MONTH_NAME/.test(i.colname))return l;if(/RECURRING_WEEKLY_REPEAT_COUNT/.test(i.colname))return"weeklyhidden";if(/RECURRING_MONTHLY_DAYS/.test(i.colname))return"monthlyhidden";if(/RECURRING_YEARLY_DAYS/.test(i.colname))return"yearlyhidden";if(/RECURRING_INVITATIONMAIL/.test(i.colname))return"property(RecInvMailType)";if(/hdnproductName[1-9]+|hdnNetTotal[0-9]+|hdnTax[0-9]+|hdnTotalAfterDiscount[0-9]+|hdnDiscount[0-9]+|hdnproductName[0-9]+|hdnQtyStock[0-9]+|txtQty[0-9]+|hdnUnitPrice[0-9]+|txtListPrice[1-9]+|hdnTotal[1-9]+/.test(l))return l;if(-1!=Events.recurringElemIds.indexOf("Crm_Events_"+n)){if("STARTDATETIME"!=n&&"ENDDATETIME"!=n)return i.name;t||(l=l.replace("Time","")+"1")}}return"RemindAt_Notify"===n&&(l="alertType"),"Crm_Calls_CALLDURATION_Mins"===e.attr("id")&&(l="DurationInMinute"),"Crm_Calls_CALLDURATION_Secs"===e.attr("id")&&(l="DurationInSecond"),133===i.uitype&&this.moduleName.startsWith("LinkingModule")||(-1!=l.indexOf(".")&&(l=i.sysrefname),-1!=l.indexOf("(")&&(l=i.sysrefname),-1!=l.indexOf(")")&&(l=i.sysrefname)),"property("+l+")"},getLookupIdName:function(e){var t=null,r={Accounts:"actName",Contacts:"contactName",Potentials:"potentialName",Campaigns:"campName",Products:"prodName",Solutions:"solutionName",PriceBooks:"priceName",Cases:"caseName",Leads:"leadName",Vendors:"vendorName",Invoices:"invoiceName",PurchaseOrders:"purchaseorder",SalesOrders:"salesorder",JobSheets:"JobSheet",Quotes:"quoteName",Services:"ServiceName",Appointments:"AppointmentName"};return-1!==e.indexOf("CustomModule")?t="customModule":r[e]&&(t=r[e]),t},getModuleDisplayName:function(e,t,r){var a="",i=Crm.moduleInfo?Crm.moduleInfo.Events:void 0;return i||(i="string"==typeof Crm.userDetails.MODULE_LIST?JSON.parse(Crm.userDetails.MODULE_LIST).Events:Crm.userDetails.MODULE_LIST.Events),a=i.pluralLabel?i.translatedPluralLabel:i.plural_label,e&&(a=i.singularLabel?i.translatedSingularLabel:i.singular_label),t||(a=a.toLowerCase()),r?I18n.getMsg(a):a},saveEntity:function(e,t,r,a,i,n,o,s,l){var c=!("Events"!==t&&"Appointments"!==t||!a)||Crm.validateEntityAndShowErrorMsg(this.fieldsObj[t],t,!0,n);if(c&&$("#bulkTaskNewPopup").length>0){var d=Lyte.Router.getRouteInstance().parent.currentModel.module_name;"Leads"==d||"Contacts"==d?(Crm.requestParam["property(leContModSel)"]=d,delete Crm.requestParam["property(modsel)"]):(delete Crm.requestParam["property(leContModSel)"],Crm.requestParam["property(modsel)"]=d)}if(!c)return!1;new Promise((function(e){if("688912415"==Crm.userDetails.ZGID){var r={};r.requestparam1=JSON.stringify(Crm.requestParam),r.message="Crm. requestParam during promise",r.zuid=Crm.userDetails.ZUID,murphy.addCustomTracking({message:JSON.stringify(r),name:"Create record",type:"custom event"}),murphy.error(new Error("Create record without field values debugger 7"))}e(CVRExec.evalRules("edit",t))})).then((function(c){if(!("Invoices"!=t||c&&Crm.confirmInvoiceCreationWithLowStock()))return!1;if(!c)return!1;if(window.ctiApiNotifier&&ctiApiNotifier.eventCreate)return ctiApiNotifier.addEvent(c),!1;if("Potentials"===t&&"view"!==window[t].currentStatus){var d=$("#Crm_Potentials_STAGE"),u=d.val();if(u&&"Closed Lost"===d.find("option:selected").attr("data-fctype")&&!$("#closedWon").is(":visible")&&(u!==d.data("old-value")||"clone"===window[t].currentStatus))return void closePotentialFromDV($("#Crm_Potentials_STAGE").val(),"edit")}var m;if(e&&"Appointments"!==t&&"JobSheets"!==t&&$(e.target).prop("disabled",!0).siblings("input[type=button]").prop("disabled",!0),"Events"!==t&&"Appointments"!==t&&"JobSheets"!==t){m=["save"];var p=Crm.userDetails.permissions["Crm_Implied_Create_"+t];"Calls"===t&&p?m.push("saveAndTask"):p&&m.push("saveAndNew"),"Tasks"===t&&Crm.userDetails.ISGAPPS_USER&&m.push("saveAndExportToGoogleTask"),m.push("cancel");for(var g=m.length,h=0;h<g;h++)$('input[id="'+m[h]+t+'Btn"],input[id="'+m[h]+t+'Btn_Bottom"]').prop("disabled",!0)}commonUtils.showHideLoadingDiv(!0);var f=Crm.requestParam;if("688912415"==Crm.userDetails.ZGID){var v={};v.requestparam1=JSON.stringify(Crm.requestParam),v.message="Crm. requestParam initial",v.zuid=Crm.userDetails.ZUID,murphy.addCustomTracking({message:JSON.stringify(v),name:"Create record",type:"custom event"}),murphy.error(new Error("Create record without field values debugger 1"))}if("JobSheets"===t&&$("#appointmentCreate")&&!Crm.requestApp2&&Crm.requestApp&&$("#saveAppointmentsBtn").attr("value")===I18n.getMsg("crm.appointments.add.job.sheet"))return Crm.requestApp2=f,Crm.requestParam={},Events.moduleName="Appointments",Events.module="Appointments",Events.currentStatus="Create",void Events.saveEntity(event,!0,!0);if("Appointments"===t&&Crm.requestApp&&!Crm.requestParam["property(Appointment Name)"]&&(f=Crm.requestApp),"JobSheets"===t&&Crm.requestApp2?(f=Crm.requestApp2,delete Crm.requestApp2):"JobSheets"!==t||"create"!==window[t].currentStatus&&"edit"!==window[t].currentStatus||(Events.entityId=window.Appointments.entityId,f["property(Appointment Id)"]=window.Appointments.entityId,f["property(Appointment Name)"]=$("#subvalue_APPOINTMENTNAME").text(),f["property(AppointmentName:Appointment Name)"]=window.Appointments.entityId),"Accounts"===t&&("create"===window[t].currentStatus||"edit"===window[t].currentStatus||"clone"===window[t].currentStatus)){var C=$("#externalCompanyId").val();null!=C&&""!=C&&(f.externalSource=null!=$("#externalCompanyId").attr("externalsource")?$("#externalCompanyId").attr("externalSource"):"",f.externalSourceId=C)}var y=s||Crm.getCrmBasePath()+"/CreateCommonModule.do";if("edit"===window[t].currentStatus&&(y=Crm.getCrmBasePath()+"/EditCommonModule.do"),"Tasks"==t&&(f["property(Send Notification Email)"]=document.getElementById("Crm_Tasks_SENDNOTIFICATION").checked?"on":"",f.updateAllRecTasks=!!crmTasks.updateAllRec&&crmTasks.updateAllRec),getElemById("homeTable")&&"Events"==t&&(f.createSource=Events.createSource),f.operation=window[t].currentStatus,"edit"==window[t].currentStatus){var E=window[t].entityId;f["property(id)"]=E,f.ActionType="Edit","Consents"!=t&&"undefined"!=typeof changeOwner&&(f.relatedRecords=changeOwner.relatedRecords[E],f.notify=changeOwner.notifyOwner[E])}f.Product&&(f.Product=JSON.stringify(f.Product)),f.newModel=!0,!Crm.isDataEnrichAvailable||"Leads"!==t&&"Contacts"!==t&&"Accounts"!==t||(f.increaseEnrichCnt=CAEExec.isIncludeEnrichCount(),f.enrichStatus=CAEExec.enrichStatus,void 0!==CAEExec.isTwitterValid&&CAEExec.isTwitterValid&&(f.isTwitterValid=CAEExec.isTwitterValid),CAEExec.init()),f.module=t;var I=$("#layoutDetails").val(),w=$("#zCampIntegLayout");if(w.length>0){var T=w.val();"zCampIntegLayoutOffline"!==T&&(I=T)}f.layoutId=null==I||"Calls"==t?$("#Crm_"+t+"_LAYOUTID").val():"Appointments"===t?void 0:I;var b=$("input[name='uploadId']");b.length>0&&void 0!==b.val()?f.uploadId=b.val():delete f.uploadId;var S=$("input[name='deleteEntityImage']");if(S.length>0&&void 0!==S.val()&&(f.deleteEntityImage=S.val()),"clone"===window[t].currentStatus){var _=$("#photoID").val();null!=_&&null!=_&&"null"!=_&&""!=_&&(f.uploadId=_)}if(f["property(module)"]=t,"PriceBooks"===t){var M=$("#Crm_PriceBooks_PRICINGMODEL").val();""!==M&&null!=M&&"-None-"!==M&&(f["property(totalPriceCount)"]=$("#secDiv_Pricing_Details").find(".hrow1").length)}if(Crm.isInventoryModule(t)&&"setup"!==this.currentStatus&&Crm.userDetails.isLineItemSubformMvmtDone&&(f["property(txtQty0)"]=-1,f["property(txtListPrice0)"]=-1),f[csrfParamName]=csrfToken,$("#save"+f.module+"Btn").data("fromValidation")&&(f.validationApproval=!0),window[t].currentStatus&&"clone"==window[t].currentStatus&&crmCommonModule.createEditJson.entityMapJson){var D=crmCommonModule.createEditJson.entityMapJson.TAGMODULEREFID;if(null!=D&&null!=D){var A=D.defaultvalue.split("||"),k="",N=A.length;for(h=0;h<N;h++)""!=A[h]&&(k+=h<N-1?A[h]+",":A[h]);f.tagValue=k}}if("Events"===t){var L="property(EventStatus)";f.fromQuickCreate="true",f[L]=Events.status;var R=$("#Crm_Events_STARTDATETIME").data("dateObj").getTime(),O=$("#Crm_Events_ENDDATETIME").data("dateObj").getTime(),P=(new Date).getTime();if(P<R){if(f["property(meetingToolAdded)"]=$("#meetingInclude").prop("checked"),$("#meetingInclude").prop("checked")){f["property(meetingToolName)"]=$("#Crm_Events_MeetingSolutions_select option:selected").attr("name");if(f["property(Venue)"]="","relatedlist_meetnow"==Events.createSource){f.mnDuration=$("#Crm_Events_DURATION").val()}}}else if("edit"==Events.currentStatus&&P>R){f["property(meetingToolAdded)"]=!1}if("clone"==Events.currentStatus&&O>P&&R<P)f[L="property(EventStatus)"]=1}else"Tasks"===t?(f.remBefore="",$("#Crm_Tasks_RECURRING").is(":checked")&&(f.remBefore=Crm.requestParam.remTime,f.exceptholiday=$("#Crm_Tasks_EXCEPT_BUSINESS_HOLIDAY_0").is(":checked")),crmTasks.updateAllUpcomingRem&&(f.remOnAllUpcomingTasks=!0)):"Calls"===t&&isNewCallView&&"krp"==Calls.source&&(f.callCreateFrom=Calls.source);return"Consents"==t&&"edit"===window[t].currentStatus&&(f["property(parentId)"]=detailView.entityId,f["property(parent Module)"]=detailView.currentModule),"Potentials"==t&&f.hasOwnProperty("relmodule")&&"Products"==f.relmodule&&(f["property(productId)"]=f.entityid),$(".outlookqCreate").length&&(f.isfromOutlookRightPanel=!0),"Calls"!==t&&"Events"!==t&&"Tasks"!==t&&"Appointments"!==t||!Crm.isFromSalesInbox||(f.isFromSalesInbox=!0),o&&(f.skipBlockListValidation=!0),Crm.isHeadless||(detailView.isWFExecInKafka=!1,detailView.refreshInWms=!1),(new crmRequestPool).initiate({url:y,type:"POST",data:f,success:function(o){if("object"==typeof o&&"error"===o.status&&"converted_lead"===o.type)return commonUtils.showHideLoadingDiv(),void renderingUtils.showCustomAlert(o.errorMsg,o.title);if("object"==typeof o&&(o.account_create_permission_failed||o.lookup_invalid_records_present||"INVALID_USER"===o.status)){if("INVALID_USER"===o.status)return Crm.enableButtons(t),void renderingUtils.displayPermissionDenied(void 0,void 0,I18n.getMsg(o.msg_key));var c=!1;if(o.account_create_permission_failed&&(Crm.showErrorMsg(I18n.getMsg("crm.crud.account.create.no.permission",$ESAPI.encoder().encodeForHTML(moduleRecordMapping.Accounts.plural_label)),$("#Crm_"+t+"_ACCOUNTID"),t),c=!0),o.lookup_invalid_records_present){if(null==o.subforms){if(o.columns)for(var d=o.columns.length,u=0;u<d;u++)Crm.showErrorMsg(I18n.getMsg("crm.crud.lookup.inaccessible.record"),$("#Crm_"+t+"_"+o.columns[u]),t);if(o.lookupModColumns)for(d=o.lookupModColumns.length,u=0;u<d;u++)Crm.showErrorMsg(I18n.getMsg("crm.crud.lookup.module.inaccessible"),$("#Crm_"+t+"_"+o.lookupModColumns[u]),t)}else for(tabId in o.subforms)for(var p=o.subforms[tabId],g=p.length,h=0;h<g;h++){var v=p[h];if(v.columns)for(d=v.columns.length,u=0;u<d;u++)Crm.showErrorMsg(I18n.getMsg("crm.crud.lookup.inaccessible.record"),$("#Crm_"+t+"_"+tabId+"_"+v.columns[u]+"_"+v.SNO),t);if(v.lookupModColumns)for(d=v.lookupModColumns.length,u=0;u<d;u++)Crm.showErrorMsg(I18n.getMsg("crm.crud.lookup.module.inaccessible"),$("#Crm_"+t+"_"+tabId+"_"+v.lookupModColumns[u]+"_"+v.SNO),t)}c=!0}if(c)return void Crm.enableButtons(t)}if("object"==typeof o&&"error"===o.status&&"invalid_twitter_user"===o.type)return commonUtils.showHideLoadingDiv(),Crm.showErrorMsg(I18n.getMsg("crm.tw.err.twHandleName.patterenCheck"),$("#Crm_"+t+"_TWITTER"),t),void Crm.enableButtons(t);if(Crm.appId&&"object"==typeof o&&!o.entityId){showFreezeLayer();var C="/crm/v2/Appointments__s/"+Crm.appId;delete Crm.appId,delete Crm.calJSON,store.findAll("dummy",{},!1,!1,{url:C,method:"DELETE"})}Crm.requestApp2&&"object"==typeof o&&!o.entityId&&CSU.cancelJobSheetBTN(),"Appointments"===o.module&&$("#jobsheetCreateDiv")&&Crm.requestApp2&&!Crm.requestApp2["property(Appointment Id)"]&&$("#saveAppointmentsBtn").attr("value")===I18n.getMsg("crm.appointments.add.job.sheet")&&o.entityId&&(Crm.requestApp2["property(Appointment Id)"]=o.entityId,Crm.appId=o.entityId,Events.moduleName="JobSheets",Events.module="JobSheets",Events.currentStatus="Create",Events.saveEntity(event,!0,!0)),commonUtils.showHideLoadingDiv();var I,w=$("#newRelatedListPopUpDiv");if("Tasks"===t&&Crm.userDetails.TaskPopup&&w&&""!==w.html()&&w.find("#rwb").length>0&&!(I=commonUtils.checkErrorMsg(o,void 0,y,void 0,t))){if($("#bulkTaskNewPopup").length>0&&(Lyte.Router.getRouteInstance().refresh().data={reloadAll:!0}),null!=Lyte.Router.getRouteInstance())if(void 0===Lyte.Router.getRouteInstance().parent.currentModel||"Activities"!==Lyte.Router.getRouteInstance().parent.currentModel.module_name&&"Tasks"!==Lyte.Router.getRouteInstance().parent.currentModel.module_name){if("kanban"===Lyte.Router.getRouteInstance().routeName)Lyte.Router.getRouteInstance().refresh().data={reloadAll:!0};else if("detail"===Lyte.Router.getRouteInstance().routeName)if("Activities"===Lyte.Router.getRouteInstance().parent.parent.currentModel.module_name||"Tasks"===Lyte.Router.getRouteInstance().parent.parent.currentModel.module_name){if($$rightPanel.detailRightPanel(!0,"info",!0),$("#followUpTask").length>0)$("#followup").html('<span class="green">'+I18n.getMsg("crm.add.task.success.mesg")+"</span>").css("background-color","#EDF9ED").show()}else{var T=null;T=Crm.isActivitySplitDone?Crm.getCrmBasePath()+"/NewRelatedList.do?pname=TASKSPERSONALITY;TASKSHISTORYPERSONALITY&action=getData&module="+detailView.currentModule+"&id="+detailView.entityId:Crm.getCrmBasePath()+"/NewRelatedList.do?pname=ACTIVITYPERSONALITY;ACTIVITYHISTORYPERSONALITY&action=getData&module="+detailView.currentModule+"&id="+detailView.entityId,(new crmRequestPool).initiate({url:T,type:"GET",success:function(e){crmRelatedList.load(crmRelatedList.Module,crmRelatedList.EntityId,e)},error:function(){commonUtils.showHideLoadingDiv(),renderingUtils.showCustomAlert(I18n.getMsg("crm.assignment.rule.internal.error"))}})}}else Lyte.Router.getRouteInstance().refresh().data={reloadAll:!0};$(".commonRightPanel").length&&$$rightPanel.detailRightPanel(!0,"info",!0),w.empty(),crmui.hidePopup("newRelatedListPopUpDiv");var b="<link-to lt-prop-target='_blank' lt-prop-route='crm.tab.module.entity.detail' lt-prop-dp='[\"Activities\",\""+o.entityId+'"]\' lt-prop-qp=\'{"sub_module":"Tasks"}\'> '+I18n.getMsg("crm.invitation.view.details.label")+" </link-to>",S=I18n.getMsg("crm.taskPopup.create.success.msg")+b;if(crmui.showMsgBand("success",S,4e3),Crm.requestParam={},"688912415"==Crm.userDetails.ZGID)(N={}).requestparam2=JSON.stringify(Crm.requestParam),N.message="After sucess requestParam emptied",N.zuid=Crm.userDetails.ZUID,murphy.addCustomTracking({message:JSON.stringify(N),name:"Create record",type:"custom event"}),murphy.error(new Error("Create record without field values debugger 3"));return}if("undefined"!=typeof EmailComposeUtil&&EmailComposeUtil&&EmailComposeUtil.removeDraftDOMElement(),"Edit"===f.ActionType&&f.relatedRecords){changeOwner.relatedRecords[E]&&delete changeOwner.relatedRecords[E];var _={};_.message=I18n.getMsg("crm.changeOwner.relatedRecord.scheduler.popup.message.progress"),crmSchedulerNotification.addOrUpdateStatus(_,I18n.getMsg("crm.changeOwner.relatedRecord.scheduler.popup.title"))}if("emailFoundInBlockList"==o){var M=m?m.length:0;for(u=0;u<M;u++)$('input[id="'+m[u]+t+'Btn"],input[id="'+m[u]+t+'Btn_Bottom"]').prop("disabled",!1);r&&$("#ajax_load_tab").is(":visible")&&r(o,I);var D=Handlebars.templates.blockListWarning();return $(D).appendTo("body"),crmui.showPopup("blockListWarning"),void $("#blockListWarning .redbtn").on("click",(function(){crmui.hidePopup("blockListWarning"),$(D).remove(),Crm.saveEntity(e,t,r,a,i,n,!0)}))}if(moduleRecordMapping[t].total_count=void 0,commonUtils.showHideLoadingDiv(),!Crm.isHeadless&&multiLookupsView&&(multiLookupsView.multiLookups={},multiLookupsView.currentMultiLookup=null),s==Crm.getCrmBasePath()+"/ShowPopupInAllTabs.do"&&networkUtils.loadFeatureScripts(["zohocrm_phonebridge_notifier.js"],(function(){ctiApiNotifier.ctiApiNotification(o)})),Crm.isRecordModified=!1,I=commonUtils.checkErrorMsg(o,void 0,y,void 0,t)){for(M=m?m.length:0,u=0;u<M;u++)$('input[id="'+m[u]+t+'Btn"],input[id="'+m[u]+t+'Btn_Bottom"]').prop("disabled",!1);(r&&"Calls"==t&&isNewCallView||r&&$("#ajax_load_tab").is(":visible"))&&r(o,I)}else{if(o||"Events"!==t||(o={}),o&&"Events"===t&&"object"!=typeof o){if(-1!=o.indexOf("}{"))o=o.replace("}{",",");else if(-1!=o.indexOf("crm.limit.reached"))return void crmui.showMsgBand("error",I18n.getMsg("crm.limit.reached"),4e3);o=JSON.parse(o)}if(!Crm.isHeadless&&isWFKafkaUser()&&(detailView.isWFExecInKafka=o.isWFExecInKafka,detailView.refreshInWms=o.callWMS,detailView.prevModule=o.module),window[t].entityId=void 0,"Consents"===t)return crmui.showMsgBand("success",I18n.getMsg("crm.updated"),2e3),DataPrivacy.refreshDataPrivacyView(),detailView.isDataPrivacyModified=!0,null!=detailView&&null!=detailView.currentModule&&crmTab.deleteFromCache(detailView.currentModule),void("canvas"===Lyte.Router.getRouteInstance().routeName&&Lyte.Router.getRouteInstance().refresh());var A="Activities"===Crm.activityGrp[t];if(A&&-1!=Activities.reminderList.indexOf(o.entityId)){var k=$("#notificationCount").text();$("#reminder_notification").text(k).show(),$(".remainder-notifi").slideUp(),$(".timericon").removeClass("footIconActive timericonAct"),$("#reminderContent").html(""),Activities.notifyCountToCrmPlusFrame(k),Activities.reminderCount=0,Activities.reminderList=""}var N,L=!("Events"===t&&"clone"!==window[t].currentStatus||"Calls"===t&&isNewCallView||("JobSheets"===t||"Appointments"===t)&&"clone"!==window[t].currentStatus||Crm.requestApp2);if("calendar"==Events.createSource&&"on"==f["property(Recurring Activity)"]&&"edit"!==window[t].currentStatus&&(L=!0),A&&"edit"===window[t].currentStatus&&updateLeftPanel(f["property(id)"],t),"JobSheets"!==t||"create"!==window[t].currentStatus&&"edit"!==window[t].currentStatus||refreshFollowDiv(),"object"==typeof o&&"true"===o.error&&"RSO_Trial_Expired"===o.errMsg){var R=networkUtils.returnDependencyFiles(["crm-rso-trial-popup.js"],crmConstants.jsStaticPathForLyte);R=R.concat(networkUtils.returnDependencyFiles(["crm-rso-trial-popup.css"],crmConstants.lessStaticPathForLyte)),Lyte.injectResources(R,void 0,(function(){var e="Administrator"===Crm.userDetails.PROFILE_NAME,r=$L("crm-rso-trial-popup").e;0!==r.length&&r[0].remove(),Lyte.Component.render("crm-rso-trial-popup",{},"#basic");var a=document.getElementById("rsoExpiredPopUp");null!==a&&a.ltProp("show",!0),commonUtils.showHideLoadingDiv();var i={wrapperClass:"rsoExpiredWrap",top:"36%",showCloseButton:!1,show:!0};e?i.buttons=[{type:"reject",text:I18n.getMsg("crm.livedesk.pot.later"),appearance:"default"},{type:"accept",text:I18n.getMsg("crm.button.buy.now"),appearance:"success"}]:(i.wrapperClass="rsoExpiredWrap rsoExpiredUser",i.showCloseButton=!0),renderingUtils.dummyBackground(!1,"rsoExpiredPopUp");var n=$L("#rsoExpiredPopUp")[0];n.ltProp(i),n.setMethods({onAccept:function(){Crm.redirectToRSOSettings()},onClose:function(){Crm.hideRSOTrialPopup()}}),"Activities"===Crm.activityGrp[t]&&"edit"===window[t].currentStatus&&(window[t].entityId=f["property(id)"])}))}else r&&r(o,I);if(Crm.requestParam={},"688912415"==Crm.userDetails.ZGID)(N={}).requestparam2=JSON.stringify(Crm.requestParam),N.message="After sucess requestParam emptied",N.zuid=Crm.userDetails.ZUID,murphy.addCustomTracking({message:JSON.stringify(N),name:"Create record",type:"custom event"}),murphy.error(new Error("Create record without field values debugger 2"));if(!i&&A&&"edit"===window[t].currentStatus){if(ActivityMoreInfoContent="",l)return void detailView.showProjectTaskSyncModel(!0);if("true"===$("#iskanbanview").val()&&$("#entitypopup").length)return window[t].currentStatus=void 0,loadActivityDetails(void 0,$("#recordid_"+o.entityId),{module:t},o.entityId,!0),void crmHistory.backOneLevel();if($("#rightPanel").length&&$("#detailCView").length)return(x=Crm.newHistoryArr[crmHistory.getState().data.backOneLevel.historyIndex]).data.fromActivityListView&&delete x.data.fromActivityListView,x.data.fromSave=!0,x.data.fromDetailView=!0,window[detailView.currentModule].currentStatus=void 0,void(Lyte.Router.transitionTo({route:"crm.tab.module.entity.detail",dynamicParams:["Activities",o.entityId],queryParams:{sub_module:o.module}}).data=x.data)}if(i)o.displayName&&$("#rItemDataSubDiv").find("#recentItemImg_"+o.entityId).find("div").text(o.displayName),f={},"Calls"===t&&(t="Tasks",f.entityid=o.entityId,f.relmodule="Calls",f.iskanbanview="true"),f.module=t,o.returnAnchor&&(f.entityid=o.entityid,f.entityname=o.entityname,f.fillUpModule=o.fillUpModule,f.listRelationId=o.listRelationId,f.fillUpFieldId=o.entityid,f.primid=o.primid,f.primmodule=o.primmodule,f.relmodule=o.relmodule,f.returnAnchor=o.returnAnchor.substring(1)),"create"==Lyte.Router.getRouteInstance().routeName?Lyte.Router.getRouteInstance().refresh().data=f:"Tasks"==f.module?Lyte.Router.transitionTo({route:"crm.tab.module.create",dynamicParams:["Activities"],queryParams:{sub_module:f.module}}).data=f:Lyte.Router.transitionTo({route:"crm.tab.module.create",dynamicParams:[o.module]}).data=f;else if(l)detailView.showProjectTaskSyncModel(!0);else if(-1!==y.indexOf("EditCommonModule")&&L)if("listView"==Crm.editReqFrom&&"Appointments"!==o.module){var O=$("#pfrom").length?$("#pfrom").val():"cv",P="";if("Tasks"!=o.module&&"Calls"!=o.module&&"Events"!=o.module||Crm.isActivitySplitDone)if("Tasks"!=o.module&&"Calls"!=o.module&&"Events"!=o.module||!Crm.isActivitySplitDone){(null!=store.peekRecord(moduleRecordMapping[o.module].id,o.entityId)?Promise.resolve(store.peekRecord(moduleRecordMapping[o.module].id,o.entityId)):store.findRecord(moduleRecordMapping[o.module].id,o.entityId,{approved:"both"})).then((function(e){e=null!=e.id?e:e[0],P=e&&e.$canvas_id?Lyte.Router.transitionTo({route:"crm.tab.module.entity.canvas",dynamicParams:[o.module,o.entityId,e.$canvas_id]}):Lyte.Router.transitionTo({route:"crm.tab.module.entity.detail",dynamicParams:[o.module,o.entityId]})}))}else{var U=Lyte.Router.getRouteInstance();P="edit"===U.routeName&&U.parent&&"Activities"===U.parent.parent.currentModel.module_name?Lyte.Router.transitionTo({route:"crm.tab.module.entity.detail",dynamicParams:["Activities",o.entityId],queryParams:{sub_module:o.module}}):Lyte.Router.transitionTo({route:"crm.tab.module.entity.detail",dynamicParams:[o.module,o.entityId]})}else P=Lyte.Router.transitionTo({route:"crm.tab.module.entity.detail",dynamicParams:["Activities",o.entityId],queryParams:{sub_module:o.module}});(x=Crm.newHistoryArr[crmHistory.getState().data.backOneLevel.historyIndex]).data&&(P.data={recordNum:x.data.recordNum,pfrom:O,lookback:!0,step:"2"})}else crmHistory.backOneLevel();else if(f.returnAnchor){if("Campaigns"==o.module&&(o.newSurveyBuilder&&!0===o.newSurveyBuilder&&o.newSurveyBuilderUrl&&networkUtils.openUrl(o.newSurveyBuilderUrl,"blank"),o.hierarchy_create))return void Lyte.Router.transitionTo({route:"crm.tab.module.entity.detail",dynamicParams:["Campaigns",o.child_campaign_id]});f.returnAnchor;f.returnAnchor&&(Crm.scrollToElem=f.returnAnchor),crmHistory.backOneLevel()}else if("homePage"===Crm.editReqFrom)renderingUtils.triggerEvent("click",$("#tab_Home"));else if("Events"==o.module&&L||"Tasks"==o.module||"Calls"==o.module&&(L||!isNewCallView)){store.modelFor(moduleRecordMapping.Activities.id)||store.registerModel(moduleRecordMapping.Activities.id,{},{extends:"entity"});var x=0!==Object.keys(crmHistory.getState().data).length&&crmHistory.getState().data.hasOwnProperty("backOneLevel")?Crm.newHistoryArr[crmHistory.getState().data.backOneLevel.historyIndex]:void 0;if(!Crm.isActivitySplitDone||x&&x.dynamicParams.contains("Activities")?store.findRecord(moduleRecordMapping.Activities.id,o.entityId):store.findRecord(moduleRecordMapping[o.module].id,o.entityId),"calendar"==Events.createSource)calView.refresh();else{if(!Crm.isActivitySplitDone||x&&x.dynamicParams.contains("Activities"))P=Lyte.Router.transitionTo({route:"crm.tab.module.entity.detail",dynamicParams:["Activities",o.entityId],queryParams:{sub_module:o.module}});else P=Lyte.Router.transitionTo({route:"crm.tab.module.entity.detail",dynamicParams:[o.module,o.entityId]});P.data={pfrom:"cv"},Crm.trackSpotLightAction(o.module+" - Added")}}else if(L){"Campaigns"==o.module&&o.newSurveyBuilder&&!0===o.newSurveyBuilder&&o.newSurveyBuilderUrl&&networkUtils.openUrl(o.newSurveyBuilderUrl,"blank");P=Lyte.Router.transitionTo({route:"crm.tab.module.entity.detail",dynamicParams:[t,o.entityId]});"Leads"!=o.module&&"Contacts"!=o.module&&"Potentials"!=o.module||Crm.trackSpotLightAction(o.module+" - Added")}if(o&&o.isInReview&&7==o.isInReview){var F=$L("crm-reviewprocess-reviewpop").e;0!=F.length&&F[0].remove(),Lyte.Component.render("crm-reviewprocess-reviewpop",{moduleName:moduleRecordMapping&&moduleRecordMapping[t]?moduleRecordMapping[t].plural_label:t},"#tabLayer"),$L("#rpRecordInReview")[0].ltProp("show",!0)}if(o&&o.isInImageValidation&&13===o.isInImageValidation){var V=Crm.getVisionMyJobsDependency();Lyte.injectResources(V,void 0,(function(){!function(){var e=$("crm-zia-vision-error-popup");0!=e.length&&e.remove();Crm.client_tracking("Zia Vision Entity Validation Failure",{type:"image_processing"}),Lyte.Component.render("crm-zia-vision-error-popup",{moduleName:moduleRecordMapping&&moduleRecordMapping[t]?moduleRecordMapping[t].plural_label:t,action:"image_processing",isSaveAndNew:!0},"#tabLayer"),$L("#visionApproval_messageBox")[0].ltProp("show",!0)}()}))}crmTab.deleteFromCache(t),fileupload.removedAttachmentIds.length=0,fileupload.uploadedFileObject.length=0}},error:function(e){commonUtils.showHideLoadingDiv(),fileupload.removedAttachmentIds.length=0,fileupload.uploadedFileObject.length=0}}),!0}))},saveAndNewEntity:function(e,t){this.saveEntity(e,t,void 0,!1,!0)},enableButtons:function(e){commonUtils.showHideLoadingDiv(),$("[id='cancel"+e+"Btn']").prop("disabled",!1),$("[id='save"+e+"Btn']").prop("disabled",!1),$("[id='saveAndNew"+e+"Btn']").prop("disabled",!1)},getModuleRenderingValue:function(){for(var e=objectUtils.cloneObject(crmConstants.uiRenderingDetails.default),t=objectUtils.cloneObject(crmConstants.uiRenderingDetails[arguments[0]]),r=1;r<arguments.length;r++){if("*"==arguments[r]){for(var a in t)""==t[a]?delete e[a]:e[a]=t[a];return e}t=t&&t[arguments[r]]?t[arguments[r]]:void 0,e=e&&e[arguments[r]]?e[arguments[r]]:void 0}return t||e},openHelpUrl:function(e){var t=e.target,r=$(t).data("helpurl");window.open(r,"help","toolbar=no,statusbar=no,menubar=no,directories=no,scrollbars=yes,resizeable=yes,menubar=no,width=1040,height=600")},copyField:function(e,t,r,a){for(var i=["STREET","CITY","STATE","CODE","COUNTRY","ZIP"],n=!1,o=0;o<i.length;o++){if((s=$("#Crm_"+t+"_"+r+i[o])).length>0)if(l=s.val().trim()){n=!0;break}}if(n)for(o=0;o<i.length;o++){var s;if((s=$("#Crm_"+t+"_"+r+i[o])).length>0){var l=s.val(),c=$("#Crm_"+t+"_"+a+i[o]);l&&c.length>0&&(c.val(l),renderingUtils.triggerEvent("change",c))}}},toggleReportingTo:function(e){var t=e.data,r=void 0!==Crm.moduleInfo.Accounts?Crm.moduleInfo.Accounts.translatedSingularLabel:"Account",a=I18n.getMsg("crm.contact.hierarchy.Specify_account_name",[I18n.getMsg(r)]),i=$("#Crm_Contacts_REPORTINGTOCONTACTID"),n=$("#Contacts_fldRow_REPORTINGTOCONTACTID"),o=$("#Crm_Contacts_REPORTINGTOCONTACTID"),s=$("#Crm_Contacts_ACCOUNTID").val();1!=o.prop("readOnly")&&("edit"==window.Contacts.currentStatus?s?(t&&t!=s&&i.val(""),n.attr("class","REPORTINGTOCONTACTID tabDivCreate"),o.prop("disabled",!1),o.autocomplete("enable"),n.removeAttr("onmouseenter"),n.removeAttr("onmouseleave")):(i.val(""),n.attr("class","REPORTINGTOCONTACTID tabDivCreate noclick"),o.prop("disabled",!0),o.autocomplete("disable"),n.attr("onmouseenter","zctt.showtt('"+a+"');"),n.attr("onmouseleave","zctt.hidett();")):s?(n.attr("class","REPORTINGTOCONTACTID tabDivCreate"),o.prop("disabled",!1),o.autocomplete("enable"),n.unbind("mouseover"),n.unbind("mouseout"),n.removeAttr("onmouseenter"),n.removeAttr("onmouseleave")):(i.val(""),n.attr("class","REPORTINGTOCONTACTID tabDivCreate noclick"),o.prop("disabled",!0),o.autocomplete("disable"),n.attr("onmouseenter","zctt.showtt('"+a+"');"),n.attr("onmouseleave","zctt.hidett();"))),$("[data-lookup-module='Accounts']").each((function(){$(this).val()&&n.attr("class","REPORTINGTOCONTACTID tabDivCreate")}))},calculateExpectedRevenue:function(e){void 0===e&&(e="");var t=0;s=0;var r,a=!1,i=$("#Crm_Potentials_"+e+"AMOUNT")[0],n=$("#Crm_Potentials_"+e+"EXPECTEDREVENUE")[0],o=$("#Crm_Potentials_"+e+"PROBABILITY")[0];if("view"==window.Potentials.currentStatus&&(n=$("#value_EXPECTEDREVENUE"),r=$("#headervalue_EXPECTEDREVENUE"),o=$("#value_PROBABILITY"),i=$("#value_AMOUNT"),a=!0),a){t="";i&&(t=i.data("value")?i.data("value")+"":""),""!==t&&(t=parseFloat(t));var s=""==o.text().trim()?"0":o.text().trim();s=parseFloat(s);var l=Crm.userDetails,c=returnJson.entityMapJson.CURRENCYISOCODE?returnJson.entityMapJson.CURRENCYISOCODE.defaultvalue:l.BASE_CURRENCY?l.BASE_CURRENCY:l.defaultCurrencyISOCode,d=l.CURRENCY_DETAILS[c]?l.CURRENCY_DETAILS[c].symbol:l.defaultOrgCurrency;if(d=d||"",!isNaN(t)||isNaN(s)){g=0;""===t?(g="",n.text(" "),r.text(" ")):0!=t&&0!=s?(g=roundValue((t*(s/100)).toString()),c?(g=currencyUtils.returnValueInDefaultCurrency(c,g),n.text(g),r.text(g)):(n.text(d+" "+g),r.text(d+" "+g))):(n.text(d+" 0"),r.text(d+" 0"))}}else{i&&!isNaN(i.value)&&(t=parseFloat(i.value)),i&&""!=i.value||(t="");var u=$("#Crm_Potentials_"+e+"STAGE")[0],m=u.options[u.options.selectedIndex].value;if(u&&""!=m&&"none"!==m){var p=u.options[u.options.selectedIndex].value;p.indexOf(":")>-1&&(p=p.split(":")[0]),s=parseFloat(p)}if(o&&""!=o.value&&(s=parseFloat(o.value)),n){var g=0;""===t?g="":0!=t&&0!=s&&(g=roundValue((t*(s/100)).toString())),n.value=g}}},setDependent:function(e,t,r,a){if(e&&!r&&(r=renderingUtils.getTargetElem(e)),!(r.getAttribute("data-subformsectionlabel")&&e&&null!==e.data&&e.data.isFormulaChange)){var i=$(document);if("Calls"==t&&isNewCallView){var n=$(r.closest("#preHTMLContainer_Calls"));if(n.length>0)i=n;else{var o=$(r.closest("#preHTMLContainer"));o.length>0&&(i=o)}}var s=$(r),l=s.data(),c=commonUtils.getValue(s),d=l.colname;if("STAGE"===d&&(c=c.split(":")[1]),"view"==a){if(!(d=l.parentcolname))return;if(CFRExec&&CFRExec.setDependentCall&&CFRExec.relatedEntityMap[d])c=CFRExec.relatedEntityMap[d].defaultvalue;else{var u="#mouseArea__"+d,m=i.find(u);if(!(m.length>0))return;c=m.data("params").defaultvalue}}if(s.attr("data-picklist-color")?s.attr("data-picklist-color"):s.data("colorcode_enabled"))if(t===crmModuleConstants.Events){var p=s.children("option:selected")[0],g=$(p).attr("data-colorcode"),h=$("#selectColorComponent"),f="edit"===Events.currentStatus||"create"===Events.currentStatus||"clone"===Events.currentStatus,v=$("#formRuleMandatoryFields").is(":visible"),C=$("#multipleFieldsEditPop"),y=C.is(":visible");if(y)var E=C.find("#Events_fldRow_STARTDATETIME");var I=$(".activitesColor_dv");if(y?h=C.find("#selectColorComponent"):f&&(h=$("#preHTMLContainer_Events").find("#selectColorComponent")),g){h.remove(),f||y||I.remove();var w=$('<span class="dIB activitesColor" data-zcqa="selectColorComponent"  id="selectColorComponent" style="background:'+g+'"></span>');y?(w=$('<span class="dIB activitesColor" data-zcqa="selectColorComponent" id="selectColorComponent" style="background:'+g+';left:2px;top:14px;"></span>'),E.length>0&&(w=$('<span class="dIB activitesColor" data-zcqa="selectColorComponent" id="selectColorComponent" style="background:'+g+';left:-10px;top:10px;"></span>'))):v&&(w=$('<span class="dIB activitesColor" data-zcqa="selectColorComponent"  id="selectColorComponent" style="background:'+g+';left:-8px;top:6px;"></span>')),w.insertBefore(s);var T=s.parent().parent().parent();T.addClass("colorEnabledPicklist"),p.value&&"-None-"!==p.value?T.removeClass("colorEnabledPKNone"):T.addClass("colorEnabledPKNone")}else g||a||!h||(h.remove(),f||y||I.remove())}else updateColorCodeForSelObj(s);if(t===crmModuleConstants.Cases&&"CASEORIGIN"===d){for(var b,S=l.picklistmap.length,_=0;_<S;_++)l.picklistmap[_].uservalue===c&&(b=l.picklistmap[_].systemvalue);var M=i.find("#Crm_"+t+"_EMAIL");M.data("mandate");"Email"===b?M.data("mandate","true"):M.data("defMandate")||M.data("mandate","false")}var D="PIPELINE"===r.getAttribute("data-colname")&&"Tasks"!=t&&"Calls"!=t&&"Events"!=t&&r.getAttribute("data-suffixindex")?t+"_"+r.getAttribute("data-suffixindex"):t;Crm.setDependentValuesByParentNameValue(D,d,c,i,a,r)}},setDependentValuesByParentNameValue:function(e,t,r,a,i,n){var o=Crm.fieldDependency[e];if(Crm.userDetails.isMapDepencySubFormSupported&&n.getAttribute("data-subformsectionlabel")){var s=n.getAttribute("data-subformdisplaylabel");o=Crm.fieldDependency[s];var l=n.id.split("_").last()}var c,d=$("#multipleFieldsEditPop").is(":visible"),u=$("#saveCancelSpan").is(":visible");null==o&&d&&ProcessFlow.fieldDependency&&(o=ProcessFlow.fieldDependency),null!=o&&0!=o.length||void 0!==Crm.jsonDepValues[e]&&(o=Crm.jsonDepValues[e]);var m=o&&"STAGE"==t&&o.Stage;if(m&&(t="Stage"),o&&o[t])for(var p=objectUtils.getKeys(o[t]),g=function(e){return-1!==O.indexOf(e.uservalue)},h=0;h<p.length;h++)if(c=p[h],o[t][c]){if(""==r&&(r="-None-"),"CALLTYPE"===c){S=o[t][c][r],a.find("input[name='Call Type'][value='"+S+"']").prop("checked",!0);continue}var f=a.find("#Crm_"+e+"_"+c);if("SALUTATION"===c&&(f=a.find("#Crm_"+e+"_FIRSTNAME_"+c)),c.includes("LINKINGCF")&&Crm.userDetails.isMapDepencySubFormSupported&&s){var v=n.getAttribute("id").split("_")[2];v&&(f=$("#Crm_"+n.getAttribute("data-module")+"_"+v+"_"+c+"_"+l))}if(0===f.length)continue;if("true"==f.data("readonly"))continue;if(f.data("readonly")+""=="true"&&(f.data("uitype")+""=="2"||f.data("uitype")+""=="26")&&"FORECASTCATEGORY"!==c&&"FORECAST_CATEGORY"!==c){var C=f.val();""==C&&(C="-None-");var y=$(document.createElement("option"));y.attr({value:C,selected:"selected"});var E=f.data("uitype")+""===CrmField.UITYPES.STAGE.toString()&&C.indexOf(":")>-1?C.substr(C.indexOf(":")+1):C;y.text(E),$(f[0]).empty(),f.prepend(y),renderingUtils.triggerEvent("change",f);continue}var I=$([]),w=$(f[0]).val(),T=w.length;if(0!=i&&"create"!=i&&100===f.data("uitype")&&o[t][c][r])for(var b=0;b<T;b++)o[t][c][r].contains(w[b])||o[t][c][r].push(w[b]);"STAGE"===c&&w.indexOf(":")>-1&&(w=w.substring(w.indexOf(":")+1));var S,_=$(document.createElement("option"));$(f[0]).empty();var M="Potentials"==f.data("module")&&"STAGE"==f.data("colname")&&"none"==w,D={};("STAGE"===t||m&&"Stage"==t)&&r.indexOf(":")>-1&&(r=r.substring(r.indexOf(":")+1));for(var A=null,k=!1,N=null!=f.data().picklistmap?f.data().picklistmap.length:0,L=0;L<N;L++)if(f.data().picklistmap[L].uservalue===w){k=!0;break}"create"!=window[e].currentStatus&&(null==f.data("orphanValue")?null!=o[t][c][r]&&0!=i?o[t][c][r].contains(w)?f.data("isOrphanValue",!1):(A=w,f.data("orphanValue",w),f.data("isOrphanValue",!0)):f.data("isOrphanValue",!1):(A=f.data("orphanValue"),k&&f.data("isOrphanValue",!1)),(0!=f.data("isOrphanValueToAppend")||0==f.data("isOrphanValueToAppend")&&1==f.data("isOrphanValue")&&A==w)&&f.data("isOrphanValueToAppend",!0)),o[t][c][r]?(E=(S=o[t][c][r])[0],D="STAGE"===c?Crm.getStageVsDetails(f.data("values")):{}):E=(S=f.data("values"))[0];for(var R=f.data("oldValue")?(""+f.data("oldValue")).split(";"):[],O=[],P=!1,U=0;U<S.length;U++){var x=S[U],F=S[U];"object"==typeof x&&(F=x=""!=x.content?x.content:x.html),O[U]=D[x]?D[x]:x}var V=f.data().values.length,H=o[t][c][r];if(H&&f.data("isOrphanValueToAppend")&&""!=w&&!M&&"create"!=window[e].currentStatus){for(var B=H.length,j=0;j<B;j++){if(w==H[j]){P=!0;break}}if(!P)for(var z=1==f.data("isOrphanValueToAppend")&&1==f.data("isOrphanValue"),W=0;W<V;W++){var q=f.data().values[W];"object"==typeof q&&"default"in q&&q.default&&!z&&w==q.content&&(P=!0)}if(!P&&(O[U]=D[w]?D[w]:w,"STAGE"===c&&D[w])){var Y=D[w].value.indexOf(":"),J=Y>-1?D[w].value.substr(Y+1):D[w].value;S.push(J)}}f.data("isOrphanValueToAppend")&&f.data("isOrphanValueToAppend",!1);_=$(document.createElement("option"));if(f.data("mapval",O),Crm.isStdOptionsField(c))for(var G=f.data("picklistmap").filter(g),K=G.length,Q=0;Q<K;Q++){var X=_.clone().attr("value",G[Q].uservalue).attr("data-actual-value",G[Q].systemvalue).prop("text",G[Q].uservalue);R&&-1!==R.indexOf(G[Q].uservalue)&&X.prop("selected","selected"),I=I.add(X)}else{if(f.removeClass("dataPopulated"),R)for(Q=0;Q<R.length;Q++){R[Q]&&(R[Q]=R[Q].trim());var Z="STAGE"===c&&w&&u,ee=Z?w:R[Q];if("STAGE"===c&&(S.contains(ee)||ee.indexOf(":")>-1&&S.contains(ee.substring(ee.indexOf(":")+1)))){var te=!Z&&ee.indexOf(":")>-1?ee.substring(ee.indexOf(":")+1):ee,re=D[te]?D[te].value:ee,ae=D[te]?D[te].html:te,ie=D[te]?D[te].fcCategory:void 0;I=I.add(_.clone().attr("value",re).prop("text",ae).attr({"data-fccategory":ie,"data-fctype":D[te].fctype}).prop("selected","selected"))}else if(O.contains(R[Q])){var ne;if(f.data("colorcode_enabled")){var oe=f.data("picklistmap");ne=getPickListColorCode(R[Q],oe,se)}I=ne?I.add(_.clone().attr({value:R[Q],"data-colorcode":ne}).prop("text",R[Q]).prop("selected","selected")):I.add(_.clone().attr("value",R[Q]).prop("text",R[Q]).prop("selected","selected"))}else R[Q]=""}if(""==R){var se="STAGE"===c&&O[0].html&&D[O[0].html];re=se?O[0].value:O[0],F=se?O[0].html:O[0];if(f.data("colorcode_enabled")){void 0===(oe=f.data("picklistmap"))&&(oe=f.data("values"));var le=getPickListColorCode(F,oe,se);_.attr("data-colorcode",le)}I=I.add(_.clone().attr("value",re).prop("text",F).attr({"data-fccategory":se?O[0].fcCategory:void 0,"data-fctype":O[0].fctype}))}}if(f.append(I),f.removeClass("dataPopulated"),"create"===i){f.eq(0).trigger("change",i);continue}"undefined"!=typeof CFRExec&&!1!==CFRExec.setDependentCall||"edit"===i||renderingUtils.triggerEvent("change",f)}},setContactValues:function(e,t,r,a,n,o,s){var l=document.querySelector(".fromLyteFields"),c=!1;if(l&&l.component){l.component.setData({newLookupcreated:!0,selectedSingleId:t});var d=l.querySelector("lyte-input");d&&(d.classList.add("yellowLyteInput"),c=!0,setTimeout((function(){d.classList.remove("yellowLyteInput")}),5e3)),l.classList.remove("fromLyteFields")}var u=$("#searchCreatePopup:visible").length,m=decodeURIComponent(r);jsonObj=JSON.parse(m),r=jsonObj.accountName+"",accId=jsonObj.accountId+"";var p,g,h=jsonObj.cntPhone+"",f=jsonObj.cntEmail+"",v=Crm.moduleName,C=$("#"+o);o?(p=C.find('input[name="fldName"]').val(),g=C.find('input[name="fldId"]').val()):(p=getObj("fldName").value,g=getObj("fldId").value),a&&(p=void 0===p?$('[name="fldName"]').val():p,g=void 0===g?$('[name="fldId"]').val():g);var y,E,I=$("[id='"+g+"']"),w=a?$(window.opener.$.find("[id='"+g+"']")).data().colname:$("[id='"+g+"']").data()?$("[id='"+g+"']").data().colname:void 0,T=g.replace(w,"ACCOUNTID"),b=getObj(T);if(b||(b=getObj(g.replace(w,"SEID"))),"Events"==v){var S=$("#addpartCheckbox"),_=$("#Events_fldRow_PARTICIPANTID").length>0;"null"!=f&&_?($("#addpartCheck").show(),$("#addpartCheckboxTitle").text(I18n.getMsg("crm.event.add.contact",[e])),S.attr("recId",t),S.attr("module","Contacts"),S.attr("onclick","Events.addRelatedParticipant($(this),'"+t+"','Contact')")):$("#addpartCheck").hide(),""==Events.relAccId&&(Events.relAccId=accId,Events.relAccName=r,Events.relAccMod=!0)}a?(y=window.opener.$("#"+p).length>0?window.opener.$("#"+p):window.opener.$('[name="'+p+'"]').val(),E=window.opener.$("#"+getObj("fldId").value).length>0?(window.opener.$("#"+getObj("fldId").value),window.opener.$("#"+getObj("fldId").value)):(window.opener.$('[id="'+getObj("fldId").value+'"]'),window.opener.$('[id="'+getObj("fldId").value+'"]')),y.val(e),y&&y.data()&&y.attr({"data-selectedlookupvalue":e,"data-selectedid":y.data().id})):(y=getObj(p),void 0!==(E=getObj(getObj("fldId").value))&&(E.value=t),$(y).val(e),$(y)&&$(y).data()&&$(y).attr({"data-selectedlookupvalue":e,"data-selectedid":$(y).data().id}));var M=Lyte.Router.getRouteInstance("crm.tab.module")?Lyte.Router.getRouteInstance("crm.tab.module").getDynamicParam():void 0;if(!!Lyte.Router.getRouteInstance("crm.settings.migration.index.map-fields")){for(var D=I.length,A=I.eq(0).data(),k=1;k<D;k++)Object.assign(I.eq(k).data(),A);var N,L=A.fieldMappingInfo.split("_"),R=parseInt(L[1]),O=L[2],P=$L("crm-dm-field-mapping")[R],U=11;P?(U=(N=(P=P.component).getData("fieldRows")[O]).getFileIndex(),e.toString().length?$L(".fieldListForModule:visible").find("lyte-tr")[O].className="migFieldReplaceAdded":$L(".fieldListForModule:visible").find("lyte-tr")[O].className=""):N=(P=$L("crm-dm-assign-default")[0]).getData("defaultRows")[O],N.setDefault({name:e,id:t}),P.setData("dirtyIndex",Object.assign({},{index:U}))}if(!$("#VRAjaxEdit").is(":visible")&&M)if("view"!==window[M].currentStatus||$("#multipleFieldsEditPop:visible").length>0)Crm.setRefFieldValues(y,t,n);else{var x=$(y);if(x.data()){var F=x.data().fieldid;n=n||JSON.parse($("#refFieldsInfo_"+t).val()),fieldOfLookup.getReferFromFieldIdVsColumnName(n,F,t)}}$("#social_create").length>0&&$(E).css("width","87%"),$(y).addClass("nwrp tOE"),$(y).attr("title",e);$(y).data("uitype");var V=$("#multipleFieldsEditPop").is(":visible"),H=$(y).data("dependfield");if(V&&H){var B=$(y).data("fieldid");ProcessFlow.getDuringTransitionDependentFields(t,B)}if(V&&crmTab.isLinkingModule(v)&&$(E).data("colname").startsWith("LINKINGMXN")&&ProcessFlow.checkDuplicateAssociation(E,t,$(E).attr("id").split("_")[2],v),$(E).data("id",t),$(y).data("id",t),"Crm_Events_CONTACTID"==g&&$("#addressOf_"+t).val()){var j=JSON.parse($("#addressOf_"+t).val());0!=Object.keys(j).length&&Events.setAddressInfo(j,"Contacts")}"Tasks"===v&&"Crm_Tasks_CONTACTID"===p&&crmBstTime.showSuggestionForCreateTask();try{var z=$(".projectsTaskSyncBtn"),W=Lyte.Router.getRouteInstance(),q=W.parent.parent.getDynamicParam();if("Tasks"===v&&null!==q&&"Activities"===q){var Y=W.parent.getDynamicParam();if(void 0!==Y){var J=crmModuleConstants.Contacts,G=store.peekRecord("crm-project-sync-task",Y);if(G)if("Potentials"!==G.module){var K="TASK_NOT_SYNCED"!==G.code;store.findAll("crm-project-sync-task",{task_id:Y,entity_id:t,module:J,isTaskSync:K},!1).then((function(e){"TASK_NOT_SYNCED"===e.code&&null!==e.firstSelectedProject?z.show():z.hide(),detailView.setProjectTaskSyncResponse(Y,e)}),(function(){z.hide()}))}}}}catch(e){murphy.error(e)}if("Calls"===v&&"Crm_Calls_CONTACTID"===p&&crmBstTime.showSuggestionForCreateCall(),0==p.indexOf("CID")){var Q=getObj("accNameInConRoleAdd_"+r);Q&&(void 0!==r&&"null"!=r?($(Q).empty(),Q.innerHTML=r):$(Q).empty())}try{CRMLookupCallBack()}catch(e){}if(b&&crmTab.tabList.contains("Accounts")){var X=getObj(T+"_label_select");if(X&&"Accounts"===$(X).val())"null"===r&&(r="",accId=""),""===$(b).val()&&$(b).val(unescape(r)).data("id",accId);else if(null!=accId&&"null"!=accId&&""===$(b).val()){var Z=$(b).attr("id"),ee=$("#"+Z+"_label_select");ee[0]||(ee=$("#"+Z+"_select")),ee.val("Accounts").trigger("change.select2"),$(b).val(unescape(r)).data("id",accId),V&&$(b).data("dependfield")&&ProcessFlow.getDuringTransitionDependentFields(accId,$(b).data("fieldid"))}b&&$(b).data()&&$(b).attr({"data-selectedlookupvalue":$(b).val(),"data-selectedid":$(b).data().id})}if("Cases"===v&&"WHOID"===w&&("null"!==h&&$("#Crm_Cases_PHONE").length>0&&""===$("#Crm_Cases_PHONE").val()&&$("#Crm_Cases_PHONE").val(h),"null"!==f&&$("#Crm_Cases_EMAIL").length>0&&""===$("#Crm_Cases_EMAIL").val()&&$("#Crm_Cases_EMAIL").val(f)),"SalesOrders"==v||"Quotes"==v||"Invoices"==v||"PurchaseOrders"==v){var te=$("#"+g);if(null!=te){var re=te.data().colname;if(null!=re&&re.indexOf("CF")<0&&getObj("addressOf_"+t)){for(i in{BILLINGCOUNTRY:"MAILINGCOUNTRY",BILLINGCODE:"MAILINGZIP",BILLINGSTATE:"MAILINGSTATE",BILLINGCITY:"MAILINGCITY",BILLINGSTREET:"MAILINGSTREET",SHIPPINGCOUNTRY:"OTHERCOUNTRY",SHIPPINGSTREET:"OTHERSTREET",SHIPPINGSTATE:"OTHERSTATE",SHIPPINGCITY:"OTHERCITY",SHIPPINGCODE:"OTHERZIP"}){var ae="Crm_"+v+"_"+i;document.getElementById(ae)&&(document.getElementById(ae).value="")}var ie=getObj("addressOf_"+t).value;for(var ne in ie=JSON.parse(ie)){var oe=$("#Crm_"+v+"_"+ne)[0],se=$(oe);if(oe)if(null!=ie[ne])if("CURRENCYISOCODE"==ne){var le=se.val();if(null!=le){var ce=ie[ne];Crm.updateCurrencyFields(v,ce,le),se.data("oldValue",ce);var de=crmTemplate.getElemIdByColname(v,"EXCHANGERATE"),ue=Crm.userDetails.CURRENCY_DETAILS[ce].er;$("#"+de).html(ue)}if(se.hasClass("dataPopulated"))se.val(ie[ne]).trigger("change.select2");else{var me=$([]);me=$(document.createElement("option")).clone().attr("value",ie[ne]).prop("text",ie[ne]),se.html("").append(me[0]),se.trigger("change.select2")}}else oe.value=ie[ne];else oe.value=""}}}}if("Appointments"===v&&"Crm_Appointments_SEID_RELATEDTO"===y.id){var pe=getObj("addressOf_"+t);ie=null;pe&&(ie=JSON.parse(pe.value)),CSU.setAddressValueForAppointment(ie)}$("#topBandPopup").is(":visible")&&hideAnimatePopup("topBandPopup"),$("#lookupPopup").is(":visible")&&(hideAnimatePopup("lookupPopup",!0),u&&($("#freezeBackGround").css("z-index","30"),showFreezeLayer())),a||(c||$(y).effect("highlight",{},1e3),$(y).trigger("create_edit_clone_DomChange",this),$(y).focus()),a&&y&&y.data()?y.attr({"data-selectedlookupvalue":e,"data-selectedid":y.data().id}):$(y)&&$(y).data()&&$(y).attr({"data-selectedlookupvalue":e,"data-selectedid":$(y).data().id}),s&&document.querySelector("crm-appointment-preference").component.executeMethod("closeEntityLookup",void 0,e,t)},setRefFieldValues:function(e,t,r,a){var i=!!$(e).data("subformsectionlabel");if(i||!0===Crm.userDetails.FIELD_OF_LOOKUP_ENABLED&&!0===Crm.userDetails.FIELD_OF_LOOKUP_AVAIALBLE)try{r=r||JSON.parse($("#refFieldsInfo_"+t).val());var n=$(e).data("subformdisplaylabel"),o=$("#createEntityForm");if(r){var s;if(a)s=void 0===(s=o.find(e).attr("data-fieldid"))?e:s;else s=void 0===(s=$(e).attr("data-fieldid"))?e.data.fieldIdFol:s;var l,c=$(e).closest("tr"),d=c.data("data-rowid");if($(productDetails)&&$(productDetails.sfFldIdSuffix)){var u=$(productDetails.sfFldIdSuffix+"LINETAX_"+d),m=u.data("refered_from_fieldid");l=m?m.substr(m.lastIndexOf("_")+1):void 0}var p=Object.keys(r);Crm.isLineItemSubFormModule(n)&&p&&l&&p.indexOf(l)<0&&(r[l]="",p.push(l));for(var g=p.length,h=0;h<g;h++){var f,v=p[h],C="[data-refered_from_fieldid=lookup_"+s+"_"+v+"]";if((f=i?c.find(C):o.length?e.form&&"createEntityNewForm"===e.form.name?$(C):o.find(C):$(C)).length>0){var y=f.eq(0);if(!(["LISTPRICE","ITEMDESCRIPTION","LINETAX"].indexOf($(y).data("colname"))>-1&&Crm.isLineItemSubFormModule($(y).data("subformdisplaylabel")))&&$(y).data("readonly")&&1==$(y).data("readonly")&&i)continue;if(i||14!==y.data("uitype")&&24!==y.data("uitype"))if(333===y.data("uitype")||786===y.data("uitype"))if(i&&333===y.data("uitype")){var E=r[v],I=E.indexOf(":"),w=E.substring(0,I-3),T=E.substring(I-2,E.length);$(f[1]).val(T),renderingUtils.triggerEvent("change",$(y).val(w))}else if(""!=r[v]){ae=(ae=Utils.getDateInUserDatePattern(new Date(r[v])))||Utils.getDateInUserDatePattern(CrmDateUtils.getDateObjectFromString(r[v]));var b,S=!1;"HH:mm"===Crm.userDetails.TIME_FORMAT&&(S=!0),""!=r[v]&&(b=isNaN(new Date(r[v]).valueOf())?CrmDateUtils.getDateObjectFromString(r[v]):new Date(r[v]));var _="";if(S){var M=Utils.formatTimeVal(b.getHours()),D=Utils.formatTimeVal(b.getMinutes());_=M+":"+D}else r[v]=Utils.convertTo12HoursFormatTimeObj(b),_=r[v].hrs+":"+r[v].mins+" "+I18n.getMsg(r[v].meridiem.toUpperCase());if(o.length){var A=f.eq(0).attr("id").match(/\(([^)]+)\)/)[1];if(S)$('input[name="property('+A+'hour)"]').val(M),$('input[name="property('+A+'minute)"]').val(D),f.eq(1).val(M+":"+D);else{$('input[name="property('+A+'hour)"]').val(r[v].hrs),$('input[name="property('+A+'minute)"]').val(r[v].mins),$('input[name="property('+A+'ampm)"]').val(r[v].meridiem.toUpperCase());var k=$('span[id="'+A+'_ampmSpan"]');k.attr("ampm",r[v].meridiem.toUpperCase()),k.text(I18n.getMsg(r[v].meridiem.toUpperCase())),f.eq(1).val(r[v].hrs+":"+r[v].mins)}f.eq(1).attr("time",_),renderingUtils.triggerEvent("change",f.eq(1))}else f.eq(1).val(_);renderingUtils.triggerEvent("change",y.val(ae))}else renderingUtils.triggerEvent("change",y.val(""));else for(var N=0;N<f.length;N++){if((y=f.eq(N)).is("input:checkbox")){"true"==r[v]||1==r[v]?y.prop("checked",!0):y.prop("checked",!1),renderingUtils.triggerEvent("change",y)}else{var L=y.data("uitype"),R=r[v];if(2==L||26==L||39==L){var O=y.data("values");O&&!O.contains(R)&&O.push(R),y.find('[value="'+R+'"]').length<1&&y.append('<option selected="selected" value="'+R+'">'+R+"</option>")}else if(100==L)for(var P=(R=R.split(";")).length,U=0;U<P;U++){y.find('[value="'+R[U]+'"]').length<1&&y.append('<option selected="selected" value="'+R[U]+'">'+R[U]+"</option>")}else if(52===L&&R)R=Search.reverseFormatNumber(R);else if(3==L){var x=y.data().maxlength;R=R.substring(0,x)}else if("object"==typeof R)if(4==L||5==L||6==L||7==L||9==L||10==L||12==L||13==L||15==L||133==L){var F=R.ID;if(R.ID||(F=""),y.data("id",F),$("#createEntityForm").length>0){y.parent().find("input[type=hidden]").attr("value",F)}R=R.Name}else R=R.Name;else if(36==L||38==L||34==L||32==L||143==L||144==L||145==L){var V=y.data().decimalLength,H=String(R);36==L&&-1!=H.indexOf(",")&&(R=H.replace(/,/g,"")),null==V&&(V=9),38==L&&(H=Search.reverseFormatNumber(H)),R=H.replace(/,/g,""),R=parseFloat(parseFloat(R).toFixed(V)),isNaN(R)&&(R="")}if(47===L){var B=Crm.userDetails.isLineItemSubformMvmtDone?JSON.parse($(e).attr("prdDetails")):void 0;if(B&&B.Taxable&&(productDetails.autoPopulateTax||!Crm.userDetails.TAX_MIGRATION_COMPLETED)){var j=$(productDetails.sfFldIdSuffix+"TAX_"+d),z=parseFloat($(productDetails.sfFldIdSuffix+"TOTALAFTERDISCOUNT_"+d).val());z=isNaN(z)?0:z;for(var W=B.Tax?B.Tax.split(";"):[],q="",Y=0,J=0,G=W.length,K=0;K<G;K++){var Q=W[K],X=productDetails.taxIdVsName[Q],Z=void 0!==X&&X.length>0?X[1]:Q,ee=JSON.parse(productDetails.newAllTaxes)[Z],te=parseFloat(ee[1]),re=z*te/100;Y+=re,J+=te,q+=Z+"==="+te+":::"+re+";;;"}R=q,j.attr("percentage",J),j.val(Y)}else{u.val(""),(j=$(productDetails.sfFldIdSuffix+"TAX_"+d)).attr("percentage",0)}}}y.is("input:checkbox")||renderingUtils.triggerEvent("change",y.val(R)),33==L&&Crm.userDetails.isPhoneNoNewView&&y[0].dispatchEvent(new Event("paste"))}else if(""!=r[v]){var ae=Utils.getDateInUserDatePattern(new Date(r[v]));renderingUtils.triggerEvent("change",y.val(ae))}else renderingUtils.triggerEvent("change",y.val(""))}}}"PRODUCTID"===$(e).data("colname")&&Crm.isLineItemSubFormModule(n)&&$(e).closest("div").find(".prdError").remove()}catch(e){}},setValue:function(e,t,r,a,i,n,o,s,l,c,d,u,m,p,g,h){var f=document.querySelector(".fromLyteFields"),v=!1;if(f&&f.component){f.component.setData({newLookupcreated:!0,selectedSingleId:r});var C=f.querySelector("lyte-input");C&&(C.classList.add("yellowLyteInput"),v=!0,setTimeout((function(){C.classList.remove("yellowLyteInput")}),5e3)),f.classList.remove("fromLyteFields")}var y,E,I,w,T,b=!1,S=$("#searchCreatePopup:visible").length;s?(y=window.opener.Crm.moduleName,E=window.opener[y].currentStatus):Crm.moduleName?(y=Crm.moduleName,E=window[y]?window[y].currentStatus:void 0):(y=e,E=window[y]?window[y].currentStatus:void 0);var _=$("#"+u);"Services"===e&&r&&networkUtils.lyteInitiateRequest("/crm/v2.1/Services__s/"+r,"GET").then((function(e){e&&e.data&&e.data.length&&(crmCommonModule.serviceModuleLooked=!0,CSU.setAppointmentRelatedData(e.data[0]),CSU.setMemberDataForAppointment(),setTimeout((function(){var e=document.getElementById("Crm_Appointments_SMOWNERID");if(e&&e.hasChildNodes()){e.component.setData("dataId",""),e.component.setData("userRecord",{});var t=$("#Crm_Appointments_APPOINTMENTDATEANDTIME");CSU.checkServiceAvailabilityTime(t)}}),200))})),u?(I=_.find('input[name="searchModule"]').val(),w=_.find('input[name="fldName"]').val(),T=_.find('input[name="fldId"]').val()):(I=getObj("searchModule").value,w=getObj("fldName").value,T=getObj("fldId").value);var M=$("[id='"+T+"']"),D=!!(M[0]&&M.data("colname")&&M.data("colname").indexOf("CF")>0);if(!!Lyte.Router.getRouteInstance("crm.settings.migration.index.map-fields")){for(var A=M.length,k=M.eq(0).data(),N=1;N<A;N++)Object.assign(M.eq(N).data(),k);var L,R=k.fieldMappingInfo.split("_"),O=parseInt(R[1]),P=R[2],U=$L("crm-dm-field-mapping")[O],x=11;U?(x=(L=(U=U.component).getData("fieldRows")[P]).getFileIndex(),w.toString().length?$L(".fieldListForModule:visible").find("lyte-tr")[P].className="migFieldReplaceAdded":$L(".fieldListForModule:visible").find("lyte-tr")[P].className=""):L=(U=$L("crm-dm-assign-default")[0]).getData("defaultRows")[P],L.setDefault({name:t,id:r}),U.setData("dirtyIndex",Object.assign({},{index:x}))}if($("#multipleFieldsEditPop").is(":visible")&&crmTab.isLinkingModule(y)&&M.data("colname").startsWith("LINKINGMXN")&&ProcessFlow.checkDuplicateAssociation(M[0],r,fldId.split("_")[2],y),("SalesOrders"==y&&"Quotes"==I&&!D||"Invoices"==y&&"SalesOrders"==I&&!D||"Invoices"==y&&"Quotes"==I&&!D)&&"view"!=E)Crm.fillFormObject(encodeURIComponent(t),r,I,null,y,void 0,$("#layoutDetails").val());else{if(s){var F=window.opener.$("#"+fldName).length>0?window.opener.$("#"+fldName):window.opener.$('[name="'+fldName+'"]').val(),V=window.opener.$("#"+T).length>0?(window.opener.$("#"+T),window.opener.$("#"+T)):(window.opener.$('[id="'+T+'"]'),window.opener.$('[id="'+T+'"]'));F.val(t).change(),w=$(F).val(),F&&F.data()&&F.attr({"data-selectedlookupvalue":t,"data-selectedid":F.data().id})}else F=getObj(w),V=getObj(T),$(F).val(t),$(F)&&$(F).data()&&$(F).attr({"data-selectedlookupvalue":t,"data-selectedid":$(F).data().id});var H=w===T,B=$(F);B.addClass("nwrp tOE");var j=$(F).data("subformdisplaylabel"),z=Crm.isLineItemSubFormModule(j),W=$(V),q=W.data("dependfield"),Y=null;q&&(Y=W.data("id")),W.data("id",r),H||W.val(r),z&&"PRODUCTID"===$(F).data("colname")&&void 0!==p&&(B.removeClass("nwrp tOE"),$(F).attr("prdDetails",JSON.stringify(p)),p.Product_Code&&""!==p.Product_Code&&$(F).data("lineitemprodcode")?$(F).val(t.replace(/(\r\n|\n|\r)/gm," ")+" ("+p.Product_Code+")"):$(F).val(t.replace(/(\r\n|\n|\r)/gm," ")),B.css({height:"18px"}),B.css({height:B[0].scrollHeight}));var J=Lyte.Router.getRouteInstance("crm.tab.module")?Lyte.Router.getRouteInstance("crm.tab.module").getDynamicParam():void 0;if(!$("#VRAjaxEdit").is(":visible")&&J)if("view"!==window[J].currentStatus||$("#multipleFieldsEditPop:visible").length>0)Crm.setRefFieldValues(F,r,d);else if(B.data()){var G=B.data().fieldid;d=d||JSON.parse($("#refFieldsInfo_"+r).val()),fieldOfLookup.getReferFromFieldIdVsColumnName(d,G,r)}w.indexOf("txtListPrice")>-1&&$(V).val(r);try{CRMLookupCallBack()}catch(e){}if("events"==l){"Accounts"==e&&($(F).attr("recId",r),Events.invJsonCreate={t:{},e:{},u:{},l:{},c:{},lv:{},cv:{},g:{},r:{},rs:{}},Events.invRemoveJson=Events.invJsonCreate,$("#Crm_Events_PARTICIPANTID").text("None"),Events.selInviteesCnt=0,Events.relAccId!=r&&(Events.relAccMod=!0,Events.relAccName=t),Events.relAccId=r);var K=JSON.parse($("#addressOf_"+r).val());0!=Object.keys(K).length&&Events.setAddressInfo(K,I)}if("Events"==y&&"Leads"===I){var Q=$("#Events_fldRow_PARTICIPANTID").length>0;if(c&&"null"!=c&&Q){var X=$("#addpartCheckbox");$("#addpartCheck").show(),$("#addpartCheckboxTitle").text(I18n.getMsg("crm.event.add.contact",[t])),X.attr("recId",r),X.attr("module",I),X.attr("onclick","Events.addRelatedParticipant($(this),'"+r+"','Lead')")}else $("#addpartCheck").hide()}if("Appointments"===y&&"Crm_Appointments_SEID_RELATEDTO"===F.id){var Z=getObj("addressOf_"+r),ee=null;Z&&(ee=JSON.parse(Z.value)),CSU.setAddressValueForAppointment(ee)}if("Potentials"===I&&"rLEmail"===$('[name="source"]').val()&&("Contacts"===y&&"canvas"!=Lyte.Router.getRouteInstance().routeName&&reloadPersonality("potentialspersonality"),EntityEmail.changeDealForEmail("associateDeal",T,r,t)),"Tasks"!==y||"Leads"!==I&&"Contacts"!==I||"Crm_Tasks_CONTACTID"!==w||crmBstTime.showSuggestionForCreateTask(),"Calls"!==y||"Leads"!==I&&"Contacts"!==I||"Crm_Calls_CONTACTID"!==w||crmBstTime.showSuggestionForCreateCall(),"Products"==I&&w.indexOf("CF")<0){if(Crm.isInventoryModule(y))if(z)Crm.handleProductLineItemUpdate($(F));else{var te=(re=/(.*?)(\d+)/g).exec(w)[2];Crm.userDetails.isLookupAdvancedSearchEnabled?("null"!=i&&(getObj("hdnQtyStock"+te).value=i),getObj("hdnUnitPrice"+te).value=a,getObj("txtListPrice"+te).value=a):("null"!=i&&(getObj("Crm_"+y+"_hdnQtyStock"+te).value=i),getObj("Crm_"+y+"_hdnUnitPrice"+te).value=a,getObj("Crm_"+y+"_txtListPrice"+te).value=a),$("#hdnUnitPrice"+te).val(a),$("#txtListPrice"+te).val(a)}else if(Crm.userDetails.isLookupAdvancedSearchEnabled){var re;(te=(re=/(.*?)(\d+)/g).exec(w)?re.exec(w)[2]:"")&&("null"!=i&&$("#hdnQtyStock"+te).val(i),$("#hdnUnitPrice"+te).val(a),$("#txtListPrice"+te).val(a))}}else if("PriceBooks"==I)if("null"!=t&&null!=t&&w.indexOf("txtListPrice")>-1){F.value=parseFloat(t).toFixed(productDetails.roundOff);var ae=$(F).attr("id");ae=ae.split("txtListPrice")[1],productDetails.discStatus="fromPb",$("#txtQty"+ae).trigger("blur"),$("#hdnPriceBookName"+ae).val(n),$("#hdnPriceBookIdClone"+ae).val(r);var ie=$("#frmBook").find(".openSansNormal"),ne=ie.text();ne.indexOf("-")>0&&(ne=ne.substring(0,ne.lastIndexOf("-"))),ie.text(ne),ie.append(" - "+n)}else if("null"!==t&&null!==t&&z&&w.indexOf("_BOOKID_")>-1){var oe=$(F).closest("tr").data("data-rowid"),se=$(productDetails.sfFldIdSuffix+"LISTPRICE_"+oe);$(F).val(n),se.val(productDetails.getRoundOff(se,parseFloat(t))).trigger("change"),productDetails.discStatus="fromPb",b=!0,window[productDetails.module].formulaObj.handlePriceBookLineItemUpdate(oe,g,!0)}else F.value=n;else if("Accounts"==I){var le;if((le=s?$(window.opener.$.find("#"+T)):$("#"+T)).length&&"PARENTACCOUNTID"!==le.data().colname&&!le.data().customfield&&!f){var ce=le.data().colname;if(null!=ce&&ce.indexOf("CF")<0&&getObj("addressOf_"+r)){ee=getObj("addressOf_"+r).value;Crm.fillAddressinfo(y,ee)}else null!=o&&Crm.fillAddressinfo(y,o)}try{if("Tasks"==y&&"Crm_Tasks_SEID"==w&&getObj("id")&&"Contacts"!==I){var de=void 0!==detailView.entityId?detailView.entityId:window.Tasks.entityId;Crm.isHeadless||void 0===de||isProjectAvailable(void 0,I,r,encodeURIComponent(t),de)}}catch(e){murphy.error(e)}try{var ue=$(".projectsTaskSyncBtn"),me=Lyte.Router.getRouteInstance().parent.parent.getDynamicParam();if("Tasks"===y&&null!==me&&"Activities"===me){var pe=Lyte.Router.getRouteInstance().parent.getDynamicParam();if(void 0!==pe){var ge=I,he=r,fe=store.peekRecord("crm-project-sync-task",pe);if(fe.module!==crmModuleConstants.Potentials){var ve="TASK_NOT_SYNCED"!==fe.code,Ce=$("#Crm_Tasks_CONTACTID").val();$("#Crm_Tasks_CONTACTID_WhoId_select option:selected").val()===crmModuleConstants.Contacts&&""===Ce&&store.findAll("crm-project-sync-task",{task_id:pe,entity_id:he,module:ge,isTaskSync:ve},!1).then((function(e){"TASK_NOT_SYNCED"===e.code&&null!==e.firstSelectedProject?ue.show():ue.hide(),detailView.setProjectTaskSyncResponse(pe,e)}),(function(){ue.hide()}))}}}}catch(e){murphy.error(e)}}if("Campaigns"==e&&m){var ye=document.querySelector("crm-add-to-campaign-popup");if(ye){m=parseInt(m);var Ee=ye.getData("showPopup"),Ie=$("#AddToCampaign_CampaignType");if(Ee&&Ie&&Ie.length>0){var we={campaignType:m,selectedCampaign:r,buttonLabel:I18n.getMsg("crm.button.save")};5===m?we.buttonLabel=I18n.getMsg("crm.survey.label.sendsurvey"):4===m&&(we.buttonLabel=I18n.getMsg("crm.label.next")),ye.setData(we)}}}if("Campaigns"===e&&crmTemplate.fromAddToCampaignTool&&(Lyte.Router.transitionTo({route:"crm.tab.module.actions.add-to-campaigns",dynamicParams:[crmListView.getObject().module],queryParams:{"entity-id":r}}),delete crmTemplate.fromAddToCampaignTool),q&&Y!=r){var Te=W.data("fieldid");ProcessFlow.getDuringTransitionDependentFields(r,Te)}if($("#topBandPopup").is(":visible")){hideAnimatePopup("topBandPopup",!0);var be=$("#sIlookupFieldAddNew");1==be.is(":visible")&&(be.hide(),$(".clearAccountName").remove())}$("#lookupPopup").is(":visible")&&(hideAnimatePopup("lookupPopup",!0),S&&($("#freezeBackGround").css("z-index","30"),showFreezeLayer())),s||b||(v||$(F).effect("highlight",{},1e3),!H&&B&&B.data("id",r))}s&&F&&F.data()?F.attr({"data-selectedlookupvalue":F.val(),"data-selectedid":F.data().id}):$(F)&&$(F).data()&&$(F).attr({"data-selectedlookupvalue":$(F).val(),"data-selectedid":$(F).data().id}),h&&document.querySelector("crm-appointment-preference").component.executeMethod("closeEntityLookup",e,F.value,r),s||$(F).trigger("create_edit_clone_DomChange",this),$(F).focus()},fillAddressinfo:function(e,t){e=e||(crmCommonModule.createEditJson?crmCommonModule.createEditJson.module:"");var r={BILLINGCOUNTRY:"MAILINGCOUNTRY",BILLINGCODE:"MAILINGZIP",BILLINGSTATE:"MAILINGSTATE",BILLINGCITY:"MAILINGCITY",BILLINGSTREET:"MAILINGSTREET"},a={SHIPPINGCOUNTRY:"OTHERCOUNTRY",SHIPPINGSTREET:"OTHERSTREET",SHIPPINGSTATE:"OTHERSTATE",SHIPPINGCITY:"OTHERCITY",SHIPPINGCODE:"OTHERZIP"},n=!1,o=!1;for(i in r){if((p=$("#Crm_"+e+"_"+i)[0])||(p=$("#Crm_"+e+"_"+r[i])[0]),p&&p.value.trim().length>0){n=!0;break}}for(i in a){if((p=$("#Crm_"+e+"_"+i)[0])||(p=$("#Crm_"+e+"_"+a[i])[0]),p&&p.value.trim().length>0){o=!0;break}}var s=window[e]?window[e].currentStatus:void 0;if(e&&t){if(Crm.isInventoryModule(e))for(i in{BILLINGCOUNTRY:"MAILINGCOUNTRY",BILLINGCODE:"MAILINGZIP",BILLINGSTATE:"MAILINGSTATE",BILLINGCITY:"MAILINGCITY",BILLINGSTREET:"MAILINGSTREET",SHIPPINGCOUNTRY:"OTHERCOUNTRY",SHIPPINGSTREET:"OTHERSTREET",SHIPPINGSTATE:"OTHERSTATE",SHIPPINGCITY:"OTHERCITY",SHIPPINGCODE:"OTHERZIP"}){var l="Crm_"+e+"_"+i;document.getElementById(l)&&(document.getElementById(l).value="")}for(var c in"string"==typeof t&&(t=JSON.parse(t)),t)if("Contacts"!=e&&null!=c&&null!=t[c]){if("CURRENCYISOCODE"==c&&"edit"!=s){var d=$("#Crm_"+e+"_"+c),u=d.val();if(null!=u){var m=t[c];window.Crm.updateCurrencyFields(e,m,u),d.data("oldValue",m)}}var p=getObj("Crm_"+e+"_"+c),g=$(p);if(p)if("CURRENCYISOCODE"==c){if("edit"!=s){if(g.hasClass("dataPopulated"))g.val(t[c]).trigger("change.select2");else{g.empty();var h=$([]);h=$(document.createElement("option")).clone().attr("value",t[c]).prop("text",t[c]),g.append(h[0]),g.trigger("change.select2")}var f=crmTemplate.getElemIdByColname(e,"EXCHANGERATE"),v=Crm.userDetails.CURRENCY_DETAILS[t[c]].er;$("#"+f).html(v)}}else g.val(t[c]),renderingUtils.triggerEvent("change",g)}else{if(!n&&c in r)(p=$("Crm_"+e+"_"+c)[0])||(p=$("#Crm_"+e+"_"+r[c])[0]),p&&($(p).val(t[c]),renderingUtils.triggerEvent("change",$(p)));if(!o&&c in a)(p=$("Crm_"+e+"_"+c)[0])||(p=$("#Crm_"+e+"_"+a[c])[0]),p&&($(p).val(t[c]),renderingUtils.triggerEvent("change",$(p)))}}},fillFormObject:function(e,t,r,a,i,n,o,s){if("view"!=window[i].currentStatus){var l=Crm.getCrmBasePath()+"/FillEntityObject.do?fillUpModule="+encodeURIComponent(r)+"&operation="+encodeURIComponent(window[i].currentStatus)+"&module="+encodeURIComponent(i)+"&entityname="+encodeURIComponent(e)+"&entityid="+encodeURIComponent(t)+"&isajax=true";null!=o&&(l=l+"&layoutid="+encodeURIComponent(o)),l=Crm.getPortalURL(l),Crm.fillInfo(l,r,a,e,t,n,s)}},fillInfo:function(e,t,r,a,i,n,o){var s=getHTTPObject();s.open("POST",e,!0),s.onreadystatechange=function(){if(4==s.readyState){var e=s.responseText,t=JSON.parse(e),r="";if(Crm.userDetails.isLookupAdvancedSearchEnabled&&!o&&(r=$("crm-entity-lookup")[0].component.getData("reqData").labelName),Crm.getModuleObj(Crm.moduleName).createTemplate(t,void 0,void 0,!0),Crm.userDetails.isLookupAdvancedSearchEnabled||o||$("#linesTbody").children().remove(),!Crm.userDetails.isLineItemSubformMvmtDone){var l=t.productLineItems;l.fieldMeta=t.entityMapJson.PRODUCTDETAILS,productDetails.setValuesForAddedRowForEdit(l,void 0,void 0,void 0,!0);for(var c=t.productLineItems.totalProductCount,d=1;d<=c;d++)$("#hdnInvRelId"+d).removeAttr("value");productDetails.grandTaxChanged=!0,$("#productList").find(".pB20").show(),$("#productList").find(".pB20").find(".wrap").show(),$("#addLinesBtnLwr").hide(),loadClassFns1(),loadClassFns2(),productDetails.fillCurrencySymbolsInLineHeaders(),productDetails.fillCurrSymForGrandVals()}if(Crm.userDetails.isLookupAdvancedSearchEnabled&&!o){var u=$("[id='"+r+"']");0==(m=$("#"+r)).length&&(m=u),p=m,m.val(decodeURIComponent(a)),m.addClass("nwrp tOE"),p.data("id",i+""),$("#topBandPopup").is(":visible")&&hideAnimatePopup("topBandPopup",!0),$("#lookupPopup").is(":visible")&&hideAnimatePopup("lookupPopup",!0),$(m).effect("highlight",{},1e3)}else{if(void 0!==n)r=n,u=n;else r=getObj("fldName").value,u=getObj("fldId").value;var m=getObj(r),p=getObj(u);m.value=decodeURIComponent(a),$(p).data("id",i+""),Crm.setRefFieldValues(m,i),hideAnimatePopup("topBandPopup",!0)}!0===Crm.userDetails.LAYOUTRULEAVAILABLE&&Crm.userDetails.LRINVOLVEDMODULES.contains(Crm.moduleName)&&(CFRExec.init(CFRExec.oldResJson,Crm.moduleName,"edit"),CFRExec.promptIfMandatory=!1,CFRExec.evalRules("edit",!0))}},s.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),s.send(csrfParamName+"="+encodeURIComponent(csrfToken))},updateCurrencyFields:function(e,t,r,a,i){var n=Crm.userDetails.CURRENCY_DETAILS,o=n[t].symbol,s="qCreate"!==a?Crm.currencyFields[e]:i,l=Crm.isInventoryModule(e),c=!1;l&&"qCreate"!==a&&(productDetails.currencySymbol=o,productDetails.roundOff=n[t].decimals,productDetails.roundOffPrecision=Math.pow(10,n[t].decimals),Crm.userDetails.isLineItemSubformMvmtDone||productDetails.fillCurrencySymbolsInLineHeaders());var d=function(e){($(e).data("subformsectionlabel")||$(e).data("subFormTabId"))&&($(e).trigger("change"),$(e).off("keypress keyup blur").on("keypress keyup blur",(function(e){crmTemplate.calculatorOperation(this,e)})))},u=s.length,m=parseInt($("#totalProductCount").val());if(null!=s){if(l&&"qCreate"!==a){for(var p=1;p<=m;)s.push("hdnUnitPrice"+p),s.push("txtListPrice"+p),++p;s.push("txtAdjustment")}for(p=0;p<s.length;p++){var g=document.getElementById("currencySymbol_"+s[p]);if(g&&($(g).empty(),$(g).hasClass("sfHeaderCurrency")?g.innerHTML="("+o+")":g.innerHTML=o+"&nbsp;"),""!=s[p]){var h=getObj(s[p]);if(null!=h&&("EXPECTEDREVENUE"!==h.getAttribute("data-colname")||1!=c)){var f=h.value,v=$(h).data("uitype");if(116!=v&&117!=v&&null!=r&&""!=r&&""!=f){var C=parseFloat(n[r].er),y=n[t].er;"edit"==Lyte.Router.getRouteInstance().currentModel.currentStatus&&0!=crmTemplate.recordCurrencyER&&(window[e].defaultCurrency==r&&(C=crmTemplate.recordCurrencyER),window[e].defaultCurrency==t&&(y=crmTemplate.recordCurrencyER));var E=f/C,I=parseFloat(y),w=parseInt(Crm.userDetails.CURRENCY_DETAILS[t].decimals);h.value=Crm.roundNumber(E*I,w),d(h),renderingUtils.triggerEvent("change",$(h)),"EXPECTEDREVENUE"!=h.getAttribute("data-colname")&&(!0!==$(h).data("readonly")&&$(h).trigger("keypress").trigger("keyup").trigger("blur"),"AMOUNT"==h.getAttribute("data-colname")&&(c=!0))}}}}}if(l&&!Crm.userDetails.isLineItemSubformMvmtDone&&null==a)for(var T=1;T<=parseInt($("#totalProductCount").val());T++)productDetails.calculateForLine(T,!0);for(p=s.length;p>u;)s.pop(),p--},roundNumber:function(e,t){return(Math.round((e*Math.pow(10,t)).toFixed(t))/Math.pow(10,t)).toFixed(t)},clearLookup:function(e){var t=e.data("dependfield"),r=$("#multipleFieldsEditPop").is(":visible");if(t){var a=e.data().fieldid;ProcessFlow.getDuringTransitionDependentFields(void 0,a)}if(r&&e.data("isMXNDuplicate")&&e.data("isMXNDuplicate",!1),"Services"===e.data().lookupModule){setTimeout((function(){var e=document.getElementById("Crm_Appointments_SMOWNERID");e&&e.hasChildNodes()>0&&(e.component.setData("dataId",""),e.component.setData("userRecord",{}))}),400);var i=$("#serviceDurationAndPrice"),n=$("#checkDuplicateEvent");n&&n.remove(),i.length&&i.hide(100,(function(){i.remove()}))}if(e.data("id",""),e.val(""),e.focus(),"Contacts"===Crm.moduleName&&"ACCOUNTID"===e[0].dataset.colname){var o=void 0!==Crm.moduleInfo.Accounts?Crm.moduleInfo.Accounts.translatedSingularLabel:"Account",s=$("#Contacts_fldRow_REPORTINGTOCONTACTID"),l=$("#Crm_Contacts_REPORTINGTOCONTACTID"),c=I18n.getMsg("crm.contact.hierarchy.Specify_account_name",[I18n.getMsg(o)]);l.val(""),l.prop("disabled",!0),l.autocomplete("disable"),s.attr({class:"REPORTINGTOCONTACTID tabDivCreate noclick"},{onmouseenter:"zctt.showtt('"+c+"');"},{onmouseleave:"zctt.hidett();"})}e.trigger("create_edit_clone_DomChange",this)},showLookUp:function(e,t,r,a,i,n,o,s,l,c,d,u,m,p,g,h,f,v,C,y,E){var I=$("#multipleFieldsEditPop").is(":visible"),w=$("#VRAjaxEdit").is(":visible"),T=$("[id='"+t+"']").eq(0).data("fieldid");if("ownername"!==i||!Crm.userDetails||!Crm.userDetails.PERSONAL_ACCOUNT){this.moduleName=e;var b="",S="",_=$("#socAddToCrmPop").is(":visible");null!=s&&(void 0!==y&&Crm.isLineItemSubFormModule(y)?(b+="&isSubFormField=true",S=s):"vendorName"===s||"property(vendorName:Vendor Name)"===s?S=getObj("property(vendorName:Vendor Name)")?getObj("property(vendorName:Vendor Name)").value:"":getObj(s)?(S=getObj(s).value,"property(actName:Account Name)"==s&&""==getObj("property(Account Name)").value&&(S=null)):S=null,b+="&productId="+S),null==h&&(h="");var M=$("#Crm_"+e+"_CURRENCYISOCODE").val();null==M&&(M="");var D=null,A="",k="",N="",L=getObj(r);if(g){if(!(D=$(L).data("id"))&&(D=$(L).data("selectedid"))){if((D+="").indexOf("CALLMXNCLONESCHEDULER")>-1)return!1;if(D.indexOf("-")>-1){var R=D.split("-");D=R[0],A=R.length>1?R[1]:""}multiLookupsView.multiLookups[t]&&(multiLookupsView.multiLookups[t].variedLookupValues.confirmselectedid=D,multiLookupsView.multiLookups[t].variedLookupValues.confirmunselectedid=A)}if(i===e){var O,P=t.length-1;if(O="X"===t[P]?t.substring(0,t.length-1):t+"X",multiLookupsView.multiLookups[O])if((k=$("#"+O).data("selectedid"))&&""!==k&&"-"!==k&&k.indexOf("-")>-1){var U=k.split("-");k=U[0],N=U[1]}}}var x=$("#"+r),F=0;if(x){var V=x.data();V&&V.uitype&&(F=V.uitype)}if("Users"!=i){var H=r;if(r&&r.indexOf("property(")>-1)try{H=r.match(/property\([a-z]+\:(.*[^)])+/i)[1].replace(/[^a-z]/gi,"")}catch(e){H=(new Date).getTime()}if("ownername"==i){if($("#ownerNameLookup")[0]){var B=document.getElementById(t),j=$(B).offset(),z=$(B).height();j.top+=z;var W=$("#ownerNameLookup"),q=W.find(".on");q.length&&W.scrollTo(q),$("#hostSrchBox")&&($("#hostListCont").find("li").each((function(){$(this).show()})),$("#hostSrchBox").val("")),W.css("display","block"),renderingUtils.stopEvent(window.event)}else{var Y=Crm.getCrmBasePath()+"/Search.do?searchmodule="+i+"&fldName="+t+"&fldId="+r+"&fldLabel="+a+"&fldValue="+h+b+"&itsfromLAR="+d+"&condition="+m+"&newModel=truefromSearchCreate="+v;(new crmRequestPool).initiate({action:Y,type:"POST",success:function(r){var a=document.getElementById(t),i=$(a).data("id"),n=r.length,o=($(a).data(),$(a).offset()),s=$(a).outerWidth()-3;o.top+=z;var l={name:"div",css:{"z-index":"31","background-color":"#fff",border:"1px solid #d4d4d4",overflow:"auto",position:"absolute",top:o.top+5+"px",left:o.left-22+"px"},attr:{id:"ownerNameLookup",name:"ownerNameLookup",class:"posRel dd_boxSh"},child:[]},c={name:"ul",attr:{id:"hostListCont",class:"cusDropDown"},css:{width:s+23+"px",border:0,"max-height":"180px",overflow:"auto"},child:[]},d=[{name:"click",args:[t],fn:function(t,r,a){r=$(r),$(".on").removeClass("on"),r.addClass("on");var i=$("#"+a);i.attr("title",r.attr("title")),i.data("id",r.data("id")),i.html(r.html()),"Events"!==e&&"Calls"!==e||Events.checkDuplicateEvent(void 0,!1),$("#ownerNameLookup").hide(),$("#emptyLayer").remove(),renderingUtils.removeDummyBackground()}}];if(n>10){var u={name:"input",attr:{id:"hostSrchBox",type:"text","data-zcqa":"txt_SearchUser",class:"hostSearch",placeholder:"Search Users...",maxlength:"10"}},m=[{name:"keyup",args:[u],fn:function(e,t){showMacroSuggest(t,e,"hostListCont","li",void 0,void 0,void 0,void 0,void 0,"userName")}}];u.events=m;var p={name:"div",child:[u]};l.child.push(p)}for(var g=0;g<n;g++){var h=r[g].label,f=h,v=commonUtils.calculateAcceptableCharCount(a,f);h.length>v&&(h=h.substr(0,v-1)+"...");p={name:"li",html:revertSplChrs(h),attr:{title:f,userName:f},data:{id:r[g].USERID}};if(r[g].USERID===i){p.attr.class="on"}p.events=d,c.child.push(p)}l.child.push(c);var C=renderingUtils.createHTML(l);thirdPartyUtils.bindPerfectScroll("#hostListCont"),document.body.appendChild(C);var y=$("#ownerNameLookup"),E=y.find(".on");E.length&&y.scrollTo(E)}})}renderingUtils.dummyBackground(!0),$("#emptyLayer").css("z-index","30")}else{if("Contacts"===i)if(/Calls|Tasks|Events/.test(e)){"Accounts"===($("#Crm_"+e+"_SEID_label_select").val()||$("#Crm_"+e+"_SEID_select").val())&&(S=$("#Crm_"+e+"_SEID").data("id"))&&(b="&productId="+S)}else{var J={accounts:[]},G=0,K=[];if((ae=$("#Crm_"+e+"_ACCOUNTID"))[0]?(S=ae.data("id"))&&(null!=S&&"null"!=S&&""!=S&&(K[G]=S,J.accounts[G]={},J.accounts[G].id=S,J.accounts[G].name=ae.val(),G+=1),b="&productId="+S):null==ae[0]&&(ae=$("#subvalue_ACCOUNTID"))[0]&&(S=ae.data("params")?ae.data("params").id:null,"detailView"==ae.data("cid")&&S&&(K[G]=S,J.accounts[G]={},J.accounts[G].id=S,J.accounts[G].name=ae.text(),G+=1)),"Crm_Contacts_REPORTINGTOCONTACTID"!==r){var Q=(ne=e.substring(0,e.length-1)).toUpperCase()+"CF";if(0==ne.indexOf("CustomModule")){var X=e.split("CustomModule");Q=X[1]<=50?"COBJ"+X[1]+"CF":"COBJCF"}var Z,ee="input[id^='Crm_"+e+"_"+Q+"']";(oe=$(ee)).length<2&&(ee="a[id^='subvalue_"+Q+"']",Z=(oe=$(ee)).length>0);for(be=0;be<oe.length;be++){var te=$(oe[be]);if(Z){if("Accounts"===(te.data("params")?te.data("params").module:null)){var re=te.data("params").id,ae=te.text();re&&ae&&(K.contains(re)||(K[G]=re,J.accounts[G]={},J.accounts[G].id=re,J.accounts[G].name=ae,G+=1))}}else if("Accounts"===te.data("lookupModule")){re=te.data("id"),ae=te.val();re&&ae&&(K.contains(re)||(K[G]=re,J.accounts[G]={},J.accounts[G].id=re,J.accounts[G].name=ae,G+=1))}}}else if("Crm_Contacts_REPORTINGTOCONTACTID"===r&&"view"===window[e].currentStatus){(ae=$("#subvalue_ACCOUNTID"))[0]&&(null!=(S=JSON.parse(ae[0].dataset.params).id)&&"null"!=S&&""!=S&&(K[G]=S,J.accounts[G]={},J.accounts[G].id=S,J.accounts[G].name=ae[0].text,G+=1),b="&productId="+S)}K.length>0&&(b="&productId="+(S=K[0])+"&accDetails="+encodeURIComponent(JSON.stringify(J))+"&accountid="+S+"&accountname="+encodeURIComponent(J.accounts[0].name))}else if("Campaigns"===i||"Potentials"===i||"Quotes"===i||"SalesOrders"===i){J={accounts:[]},G=0,K=[];if("Cases"===e)ae=$("#Crm_"+e+"_WHOID");else if("Calls"===e){var ie=-1!=r.indexOf("_PBCalls_")?"PBCalls":"Calls";ae=$("#Crm_"+ie+"_CONTACTID")}else ae=$("#Crm_"+e+"_CONTACTID");ae[0]&&(S=ae.data("id"))&&(null!=S&&"null"!=S&&""!=S&&(K[G]=S,J.accounts[G]={},J.accounts[G].id=S,J.accounts[G].name=ae.val(),G+=1),b="&productId="+S);Q=(ne=e.substring(0,e.length-1)).toUpperCase()+"CF",ee="input[id^='Crm_"+e+"_"+Q+"']";var ne,oe=$(ee);if(K.length>0&&(b="&productId="+(S=K[0])+"&accDetails="+encodeURIComponent(JSON.stringify(J))),"Potentials"===i||"Quotes"===i||"SalesOrders"===i)(ae=$("#Crm_"+e+"_ACCOUNTID"))[0]&&ae.data("id")&&(b=b+"&accountId="+ae.data("id"))}if("Potentials"===i&&"rLEmail"===n){var se=null,le=$("#module");if("Contacts"===e&&"Accounts"!=le.val())se=$("#id").val();else if("Potentials"===e)se=$("#cntId").val(),"canvas"==Lyte.Router.getRouteInstance().routeName&&(se=$("crm-emailsrl-canvas-view").attr("associated-cont-id"));else if("Accounts"==e||"Contacts"===e&&"Accounts"==le.val()){var ce=$("#contactSelDropdownInAcc");se=$("crm-emails-related-list").length>0?"ALL"==ce.attr("lt-prop-selected")?$("#"+t).parents(".rLEmailSub").data("contactid"):ce.attr("lt-prop-selected"):"ALL"==ce.val()?$("#"+t).closest(".mailcontDiv").data("contactid"):ce.val()}var de=Crm.getCrmBasePath()+"/Search.do?searchmodule="+i+"&fldName="+t+"&fldId="+r+"&fldLabel="+a+"&fldValue="+h+b+"&condition="+m+"&contactId="+se+"&source="+n+"&currencyISOCode="+M+"&newModel=true"}else if(""!=p&&null!=p&&"-1"!=p)de=Crm.getCrmBasePath()+"/Search.do?searchmodule="+i+"&fldName="+t+"&fldId="+r+"&fldLabel="+a+"&fldValue="+h+b+"&condition="+m+"&potentialId="+p+"&currencyISOCode="+M+"&newModel=true";else if("Services"===i&&"Appointments"===e)de=Crm.getCrmBasePath()+"/Search.do?searchmodule="+i+"&fldName="+t+"&fldId="+r+"&fldLabel="+a+"&fldValue="+h+b+"&condition="+m+"&currencyISOCode="+M+"&newModel=true&parentModule="+e;else{var ue="";i!==crmModuleConstants.Accounts||e!==crmModuleConstants.Accounts||_||"edit"!==window[e].currentStatus&&"view"!==window[e].currentStatus||(ue="&seId="+window[e].entityId);de=Crm.getCrmBasePath()+"/Search.do?searchmodule="+i+"&fldName="+t+"&fldId="+r+"&fldLabel="+a+"&fldValue="+h+b+"&condition="+m+"&currencyISOCode="+M+ue+"&newModel=true&notInMultiModLookup="+C}if(de=Crm.getPortalURL(de),g){if(("all"===A||"all"===N)&&"Edit"===$(heading_title).text().trim().substring(0,$(heading_title).text().trim().indexOf(" ")))return void("all"===N?multiLookupsView.permissionIssueWarningShow("",e,i,16,g):"all"===A&&multiLookupsView.permissionIssueWarningShow("",e,i,12,g));if(Crm.trackSpotLightAction("Multi Select Lookup - Record Edit",{Module:e}),de+="&linkingmodule="+g+"&selectedid="+D+"&unselectedid="+A+"&selectedidx="+k+"&unselectedidx="+N+"&select=true",window[e]&&("edit"==window[e].currentStatus||I))if(window[e].entityId)de+="&entityId="+window[e].entityId;else{var me=$("#multipleFieldEditEntityId");me.length>0&&(de+="&entityId="+me.val())}else de+="&entityId="+H.value}if(f&&(validationUtils.isInteger(f)&&(de+="&campaignId="+f),de+="&hideQuickCreate=true"),(crmTemplate.fromAddToCampaignTool||f)&&(de+="&addToCampaign=true"),v&&(de+="&fromSearchCreate="+v),E&&(de+="&fromAutDealCreate="+E),"Crm_Contacts_REPORTINGTOCONTACTID"!==r||"edit"!==window[e].currentStatus&&"view"!==window[e].currentStatus||(de+="&entityId="+window[e].entityId),e&&window[e]&&window[e].createEditJson)window[e].createEditJson.layout_jsonarrayObj?pe=window[e].createEditJson.layout_jsonarrayObj.sysLayoutId:returnJson.layout_jsonarrayObj&&(pe=returnJson.layout_jsonarrayObj.sysLayoutId),"view"==window[e].currentStatus&&returnJson.layout_jsonarrayObj&&(pe=returnJson.layout_jsonarrayObj.sysLayoutId);else var pe=$("#layoutdetails").val();if(pe&&"null"!=pe&&"undefined"!=pe&&(de+="&layoutId="+pe),T&&"null"!=T&&"undefined"!=T&&(de+="&lookupFieldId="+T),w&&(de+="&hideQuickCreate=true"),$(".outlookInfoCont").is(":visible")){$("#topBandPopup");de+="&isfromOutlookRightPanel=true",$$rightPanel.openNewWindowFromOutlook(de,500,1100)}else commonUtils.openCustomLookup(de,void 0,"topBandPopup",renderingUtils.windowWidth-300)}}else if(444==F){var ge=document.getElementById("ServiceMultiUserComponent"),he=[],fe=[];D&&D.length>0&&(he=D.split(","));for(var ve=Crm.userDetails.MODULE_LIST.Services.id,Ce=store.peekRecord("module",ve).profiles,ye=Ce.length,Ee=[],Ie="(profile:in:",we=[],Te=[],be=0;be<ye;be++)we.push(Ce[be].id),Ce[be].name&&Te.push(Ce[be].name.replace(/,/g,"\\,"));var Se={comparator:"in",field:"profile.id"};Se.value=we,Ee.push(Se);var _e=Te.join().replace(/\(/g,"\\(");Ie=Ie+(_e=_e.replace(/\)/g,"\\)"))+")",void 0!==ge&&$(ge).length>0&&ge.remove(),fe=null==$(L).data("userIdList")?"create"==window[e].currentStatus||"clone"==window[e].currentStatus?[]:he:$(L).data("userIdList"),Lyte.Component.render("crm-service-user-lookup",{id:"ServiceMultiUserComponent",excludeIds:{},selectedIds:he,userCriteria:JSON.stringify(Ee),userSearchCriteria:Ie,userIdList:fe},"#Services_fldRow_MXNDUMMYCOLUMN_SERVICE"),(ge=document.getElementById("serviceUserLookup")).cxProp("show",!0)}else{if(Search.InfoForPartialLoad){var Me=$(Search.createShowLookup(t));if(D&&D.length>0){var De=D.split(",");$.each(De,(function(e,r){Me.find("#"+t+"_"+r).addClass("result-selected-no-display")}))}renderingUtils.stopEvent(window.event)}else if(0===$("#ownerNameLookup_"+t).length){Me=$(Search.createShowLookup(t));if(D&&D.length>0){De=D.split(",");$.each(De,(function(e,r){Me.find("#"+t+"_"+r).addClass("result-selected-no-display")}))}renderingUtils.stopEvent(window.event)}else-1!=t.indexOf("MXNDUMMYCOLUMN")&&Search.showCreatedUserPopup(t,"yes",!0);$("#ownerNameLookup_"+H).closest("#critEditorDIV").length&&Search.setHeightOwnerLookupScoring($("#ownerNameLookup_"+H)),renderingUtils.scrollPrevent($("#ownerNameLookup_"+t)),$("input#hostSearch_"+H).attr("onclick","sE(event)").focus()}}},validateFormFields:function(e){for(var t=!0,r=0;r<e.length;r++){var a=$("#"+e[r]),i=a.data(),n=(i.displaylabel,i.contenttype),o=i.displaylabel,s=commonUtils.getValue(a),l=(i.fieldtype,i.i18fieldtype),c=i.datepattern;switch(s="string"==typeof s?s.trim():s,"true"===i.mandate+""&&validationUtils.isFieldEmpty(a)&&(this.showErrorMsg(I18n.getMsg("crm.field.empty.check",[o]),a),t=!1),i.maxlength&&!Crm.checkMaxLength(a,i.maxlength)&&(this.showErrorMsg(I18n.getMsg("crm.field.length.check",[l]),a),t=!1),n){case"Email":var d=a.val()?a.val().trim():a.val();validationUtils.isValidEmail(s)||(this.showErrorMsg(I18n.getMsg("crm.field.valid.check",[l]),a),t=!1);break;case"Date":case"DateTime":if(""==(s=(s=s.replace(Crm.userDetails.DATE_PATTERN,"")).replace(crmConstants.executionDayFormula,""))||Utils.isValidDate(Crm.userDetails.DATE_PATTERN,s,c)||(this.showErrorMsg(I18n.getMsg("crm.field.valid.check",[l]),a),t=!1),"DateTime"===n){var u=$("#"+a.attr("id")+"_TimeOption").val().split(" ")[0];if(""!=u){""==$("#"+a.attr("id")).val()&&(this.showErrorMsg(I18n.getMsg("crm.field.valid.check",[l]),a),t=!1);var m=u.split(":"),p=(Utils.getMeridiem($("#"+a.attr("id")+"_TimeOption").timeEntry("getTime")).toUpperCase(),m[0]),g=m[1];Utils.isValidTime(p,g)||(this.showErrorMsg(I18n.getMsg("crm.field.valid.check",[l]),a),t=!1)}}break;case"URL":d=a.val()?a.val().trim():a.val();validationUtils.isValidWebUrl(d)||(this.showErrorMsg(I18n.getMsg("crm.field.valid.check",[l]),a),t=!1);break;case"Currency":var h=i.maxlength-(f=i.decimalLength);currencyUtils.isValidCurrency(s,h,f)||(this.showErrorMsg(I18n.getMsg("crm.field.valid.check",[l]),a),t=!1);break;case"Percent":case"Number":case"LongInteger":""===s||validationUtils.isValidInteger(s)||(this.showErrorMsg(I18n.getMsg("crm.field.valid.check",[l]),a),t=!1);break;case"Phone":validationUtils.isValidPhoneNo(a,a.val())||(this.showErrorMsg(I18n.getMsg("crm.field.valid.check",[l]),a),t=!1);break;case"Decimal":var f;h=i.maxlength-(f=i.decimalLength);if(validationUtils.isValidDecimal(s,h,f))validationUtils.decimalLengthCheck(s,f)||(this.showErrorMsg(I18n.getMsg("crm.field.valid.check",[l]),a),t=!1);else this.showErrorMsg(I18n.getMsg("crm.field.valid.check",[l]),a),t=!1;break;default:if(i.regex)new RegExp(i.regex,"g").test(s)||(t=!1,this.showErrorMsg(I18n.getMsg("Please provide a valid data.."),a))}}return t},getFieldTypeStr:function(e){return{1:"Text",11:"Text",32:"Text",27:"Text",127:"Text",2:"Pick List",26:"Pick List",3:"Textarea",21:"URL",24:"Date",30:"Date/Time",25:"Email",32:"Number",33:"Phone",34:"Percent",38:"Decimal",36:"Currency",37:"Text",39:"Pick List",98:"Pick List",40:"Number",300:"Boolean",301:"Boolean",100:"Multiselect",786:"DateTime",14:"DateTime",333:"DateTime",111:"AutoNumber",4:"Lookup",5:"Lookup",6:"Lookup",7:"Lookup",8:"Lookup",9:"Lookup",10:"Lookup",12:"Lookup",13:"Lookup",15:"Lookup",55:"Lookup",132:"Lookup",133:"Lookup",135:"Lookup",136:"Lookup",143:"Currency(Round Off)",144:"Currency(Round Down)",145:"Currency(Round Up)",116:"Formula",52:"Long Integer",46:"Lookup",221:"Lookup"}[e]},handleDontShowTaskClosePopup:function(){Crm.userDetails.CUSTOMIZE_INFO.CloseTaskPopup=!0},refreshRoute:function(e,t){Lyte.Router.getRouteInstance().transition.info.route.indexOf("crm.tab.module")>-1&&crmTab.deleteFromCache(Lyte.Router.getRouteInstance().transition.info.dynamicParams[0]);var r={};t.getAttribute("data-params")&&(r=JSON.parse(t.getAttribute("data-params")));var a=Lyte.Router.getRouteInstance(),i=!0,n=a.getQueryParams();"refreshRoute"==r.clickId&&n&&null!=n.page&&(r.currentOption=a.transition.info.queryParams.per_page,r.toIndex=a.transition.info.queryParams.per_page,a.setQueryParams({page:void 0}).data=r,i=!1),i&&(a.refresh().data=r)},checkIfSameRoute:function(e,t){if(t.queryParams=t.queryParams?t.queryParams:{},e.route!==t.route)return!1;for(var r=e.dynamicParams.length,a=0;a<r;a++)if(e.dynamicParams[a]!==t.dynamicParams[a])return!1;if(Object.keys(e.queryParams).length!==Object.keys(t.queryParams).length)return!1;for(var i in e.queryParams)if(e.queryParams[i]!==t.queryParams[i])return!1;return!0},lyteTransition:function(e,t,r){for(var a,i=!0,n=e.target||e.srcElement;n!==t;){if("LINK-TO"===n.tagName)return;n=n.parentElement}t?(a=$(t).data("cid"),r=$(t).data("params")):(a=r.clickId,delete r.clickId);var o={detailView:{route:"crm.tab.module.entity.detail",dynamicParams:[r.module,r.id]},kanbanviewentity:{route:"crm.tab.module.entity.detail",dynamicParams:[r.module,r.id]},showMacro:{route:"crm.settings.section.macro.index",queryParams:{module:r.module}},showDashboard:{route:"crm.tab.dashboards.view",dynamicParams:[r.dbId]},newReport:{route:"crm.tab.reports.create"},customizeReport:{route:"crm.tab.reports.view",dynamicParams:[r.reportId],queryParams:{folderId:r.folderId}},apprDetailView:{route:"crm.tab.approvals.view",queryParams:{recModule:r.recModule,entityId:r.entityId}}};if("showMacro"==a)1!=r.type&&2!=r.type||(o.showMacro.route="crm.settings.section.macro."+(2==r.type?"view":"edit")),o.showMacro.dynamicParams=[r.ruleId];else if("navigate_next"==a||"navigate_previous"==a||"changeOption"==a){if(window.location.href.indexOf("approvals")>-1){var s=r.fromIndex;r={actionName:$("#groupUserView option:selected").val()};$("#showDuplicatesOpt").val()&&(r.showDuplicates=$("#showDuplicatesOpt").val());var l=$("#currentOption").val();r.fromIndex="navigate_next"==a?parseInt(s)+parseInt(l):"navigate_previous"==a?parseInt(s)-parseInt(l):s,r.toIndex=parseInt(r.fromIndex)+parseInt(l)-1,o[a]={route:"crm.tab.module.actions.approvals",dynamicParams:[getObj("module").value],queryParams:r}}}else if("detailView"==a||"kanbanviewentity"==a){var c=o[a].dynamicParams[0];(r.fromActivityListView||"Activities"==Crm.activityGrp[c]&&(!Crm.isActivitySplitDone||Lyte.Router.getRouteInstance()&&Lyte.Router.getRouteInstance().parent&&Lyte.Router.getRouteInstance().parent.parent&&"Activities"===Lyte.Router.getRouteInstance().parent.parent.getDynamicParam()))&&(o[a].dynamicParams[0]="Activities",o[a].queryParams={sub_module:c});var d=Lyte.Router.getRouteInstance().transition;200!=d.state&&308!=d.state&&(i=!1)}i&&(Lyte.Router.transitionTo(o[a]).data=r)},isValidJSON:function(e){try{JSON.parse(e)}catch(t){return Crm.isValidJSONArray(e)}return!0},isValidJSONArray:function(e){return Array.isArray(e)},routeOnBoarding:function(e,t){Lyte.Router.transitionTo({route:e})},getStageVsDetails:function(e){for(var t=e.length,r={},a=0;a<t;a++)if("none"!==e.value){var i=e[a];r[e[a].html]=i}return r},isStdOptionsField:function(e){return-1!==crmConstants.stdOptionFields.indexOf(e)},updatePermission:function(e){for(var t=["Crm_Implied_View_","Crm_Implied_Import_","Crm_Implied_Create_","Crm_Implied_Approve_Web_","Crm_Implied_Edit_","Crm_Implied_Export_","Crm_Implied_Mass_Delete_","Crm_Implied_Mass_Email_","Crm_Implied_Mass_Transfer_","Crm_Implied_Mass_Update_","Crm_Implied_Web_To_","Crm_Implied_Webform_Abtesting_","Crm_Implied_Delete_","Crm_Implied_Tags_","Crm_Implied_ZohoSheet_View_","Crm_Implied_Delete_Mail_","Crm_Implied_Import_My_","Crm_Implied_Import_MyOrg_","Crm_Implied_MailMerge_Mail_","Crm_Implied_Mass_Convert_","Crm_Implied_Print_View_","Crm_Implied_Send_Mail_","Crm_Implied_Share_"],r=t.length,a=0;a<r;a++)Crm.userDetails.permissions[t[a]+e.modName]=!0},openOrganizationsPageInNewTab:function(e){Crm.client_tracking("Multiple Organization - Org manage clicked"),window.name="zcrmmainwindow";var t="";t="true"==window.isSandboxAcc?"https://"+RebrandLinkUtil.getProperty("SANDBOXURL"):RebrandLinkUtil.getProperty("CRMURL_HTTPS"),window.open(t+"/organizations?ref="+e)},returnPhoneFieldDependencyFiles:function(){var e=networkUtils.returnDependencyFiles(["crm-phone-field.js"],crmConstants.jsStaticPathForLyte),t=networkUtils.returnDependencyFiles(["crm-phone-field.css"],crmConstants.cssStaticPathForLyte);return networkUtils.returnDependencyFiles(["zlib_phonenumber.js"],crmConstants.jsStaticPath).concat(e,t)},loadPhoneFieldComponentJSFiles:function(){"undefined"==typeof ZlibPhoneNumber&&Lyte.injectResources(Crm.returnPhoneFieldDependencyFiles())},showOrHideScoreDetails:function(e,t){var r=$L("#"+e);t?(r.addClass("dN"),$L("#showspan_"+e).removeClass("dN"),$L("#hidespan_"+e).addClass("dN"),$L("#srTimeline_"+e).removeClass("lightGreyBg").addClass("pL0")):(r.removeClass("dN"),$L("#srTimeline_"+e).addClass("lightGreyBg").removeClass("pL0"),$L("#showspan_"+e).addClass("dN"),$L("#hidespan_"+e).removeClass("dN"))},showStorageExceedPopup:function(e,t,r){var a=Crm.userDetails.CLIENT_ACCOUNT?"new_record_client":"new_record";e=e||a;var i=Crm.userDetails.data_storage,n=!!i&&"count"===i.calculation_type;t=t||"#showAlertPopUp";var o=i.percentage>100?100:i.percentage;i.total_used_space>i.total_allowed_space&&(i.total_used_space=i.total_allowed_space);var s={errorType:e,rem_storage:i.total_remaining_space.toString(),allowed_storage:i.total_allowed_space,isCount:n,HomePage:r,used_storage_in_percent:o},l=networkUtils.returnDependencyFiles(["datastorage.js"],crmConstants.jsStaticPathForLyte),c=networkUtils.returnDependencyFiles(["datastorage.css"],crmConstants.cssStaticPathForLyte),d=networkUtils.returnDependencyFiles([networkUtils.getI18nJSUrl("datastorage")]),u=l.concat(c).concat(d);Lyte.injectResources(u,void 0,(function(){t&&!$L("crm-data-storage-error-msg")[0]?Lyte.Component.render("crm-data-storage-error-msg",s,t):($L("crm-data-storage-error-msg")[0].setData(s),$L("#dS_errorMsgLandRecPage")[0].ltProp("show","true"))}))},notifySearchCloseCRMPlus:function(){"global-search"===Lyte.Router.getRouteInstance().routeName&&isLoadedInCRMPlusIFrame()&&CrmPlusImpl.trigger("searchView.onclose")}};function simpleEmail(){}function territoryListHide(){$("#containerDIV").is(":visible")&&$("#containerDIV").hide(),$(".shiftHoursDD").is(":visible")&&$(".shiftHoursDD").hide()}function isConfiguredUser(e){var t=$("#telephonyconfigured").val(),r=CTIAPI.CTI.ctiname;return"true"===t&&r===e}function updateRecordNumParam(e){if($("#cvlist_"+e).length)for(var t=$("#detailView_"+e).nextAll("li").children('div[data-cid="detailView"]'),r=t.length,a=0;a<r;a++){var i=t.eq(a),n=JSON.parse(i.attr("data-params"));n.recordNum=parseInt(n.recordNum)-1,i.attr("data-recordnum",n.recordNum).attr("data-params",JSON.stringify(n))}}Crm.Field={},Crm.Field.UITYPES={OWNER:8,USERLOOKUP:221,PRODUCT_HANDLER:55,SINGLE_LINE:1,DATE:24,DATETIME:786,MULTI_LINE_CF:110,NUMERIC_FIELD:32,PHONE:33,PERCENT:34,LONG_INTEGER:52,WEBSITE:21,EMAIL:25,CURRENCY:36,DECIMAL:38,MULTI_PICK_LIST:100,PICK_LIST:2,SKYPE_FIELD:37,TEXT_FIELD:11,TWITTER:22,FIRST_NAME:27,LAST_NAME:127,TASK_SUBJECT:62,TEXT_AREA:3,DATE_TIME1:30,CREATED_TIME:200,CREATED_BY:20,AGGREGATE_FIELD:117,BIG_DECIMAL:40,STAGE:26,RECORD_CURRENCY:39,ACCOUNT_NAME_LOOKUP:4,CAMPAIGN_NAME_LOOKUP:5,PRODUCT_NAME_LOOKUP:6,CONTACT_LOOKUP:7,VENDOR_NAME_LOOKUP:9,POTENTIAL_ID:10,SALESORDER_ID:12,CONTACT_ID:13,QUOTE_ID:15,ROLE_NAME:16,LOOK_UP_ENTITY:133,MULTI_MODULE_LOOK_UP_ENTITY:132,MULTISELECT_LOOK_UP:444,LAYOUT_LOOKUP:136,BOOLEAN_DEF:300,BOOLEAN_DEF_NOT:301,LAYOUT:208,AUTONUMBER:111},simpleEmail.SendMail=function(){if(Crm.trackSpotLightAction("Sticky Notes - Send Mail Click"),simpleEmail.CheckContents()){var e,t=getObj("toAddress").value,r=getObj("fromAddress").value,a=getObj("subject").value,i=getObj("description").value,n=getObj("editorMode").value;if(void 0!==getObj("invType"))var o=getObj("invType").value.trim(),s=getObj("invRecId").value.trim();e="plaintext"==n?"action=simpleMail&toAddress="+encodeURIComponent(t)+"&fromAddress="+encodeURIComponent(r)+"&subject="+encodeURIComponent(a)+"&mailDescription=&mailDescriptionInPlainText="+encodeURIComponent(i)+"&editorMode="+encodeURIComponent(n)+"&"+csrfParamName+"="+encodeURIComponent(csrfToken):"action=simpleMail&toAddress="+encodeURIComponent(t)+"&fromAddress="+encodeURIComponent(r)+"&subject="+encodeURIComponent(a)+"&mailDescription="+encodeURIComponent(i)+"&mailDescriptionInPlainText=&editorMode="+encodeURIComponent(n)+"&"+csrfParamName+"="+encodeURIComponent(csrfToken),o&&s&&(e=(e=e+"&invType="+encodeURIComponent(o))+"&invRecId="+encodeURIComponent(s)),"Events"==$("#module").val()&&$("#messageId").data("messageId")&&null!=$("#messageId").data("messageId")&&""!=$("#messageId").data("messageId")&&(e=e+"&messageId="+$("#messageId").data("messageId")),$.ajax({url:Crm.getCrmBasePath()+"/mailer/EntReply.do",data:e,type:"POST",success:function(e){-1!=e.indexOf("success")?(crmui.showMsgBand("success",I18n.getMsg(e),4e3),simpleEmail.ClosePopup()):-1!=e.indexOf("dayLimitReached")?crmui.showMsgBand("error",I18n.getMsg(e),4e3):-1!=e.indexOf("from Address")?crmui.showMsgBand("error",I18n.getMsg("crm.mail.from.invalid"),4e3):-1!=e.indexOf("To Address contains Blocked Email")?crmui.showMsgBand("error",I18n.getMsg("crm.unsubscription.event.sendmail.blocked"),4e3):-1!=e.indexOf("Maximum_Limit_Exceeded")?(crmui.showMsgBand("error",I18n.getMsg("workflow.webHook.failures.dayLimitReached"),4e3),$(".simpleEmail_submit").find(".primarybtn").addClass("disable")):crmui.showMsgBand("error",I18n.getMsg("crm.unable.to.process.request"),4e3),Crm.trackSpotLightAction("Sticky Notes - Mail Sent Successfully")}})}},simpleEmail.CheckContents=function(){var e=editor.getContent();if(e.length>32e3)return alert(I18n.getMsg("crm.template.email.content","32,000")),!1;var t=getObj("toAddress");if(t.value=t.value.replace(/\s+/g,""),getObj("toAddress").value=t.value,0==t.value.length){var r=I18n.getMsg("crm.label.to.email");return alert(I18n.getMsg("crm.field.empty.check",r)),t.setAttribute("autocomplete","off"),t.focus(),!1}for(var a=t.value.split(","),i=a.length,n=0;n<a.length;n++){var o=a[n];if(""!=o&&!validationUtils.isValidEmail(o)){r=I18n.getMsg("crm.label.to.email");return alert(I18n.getMsg("crm.field.valid.check",r)),t.setAttribute("autocomplete","off"),t.focus(),!1}""==o&&(i-=1)}if(i>10)return alert(I18n.getMsg("crm.email.to.check")),!1;var s=getObj("subject");if(0==s.value.replace(/^\s+/g,"").replace(/\s+$/g,"").length){var l=I18n.getMsg("crm.label.subject");return alert(I18n.getMsg("crm.field.empty.check",l)),s.setAttribute("autocomplete","off"),s.focus(),!1}if(s&&s.value.length>250){var c=s.value;s.value=c.substring(0,250)}return"Script tags found"!=e&&(getObj("editorMode").value=editor.mode,getObj("description").value=e,!0)},simpleEmail.SendMailPopup=function(e,t,r,a,i,n){if(t)var o="action=emailPopup&toAddress="+encodeURIComponent(e)+"&subject="+encodeURIComponent(t)+"&module="+a;else o="action=emailPopup&toAddress="+encodeURIComponent(e)+"&module="+a;null!=r&&(o=o+"&inviteeId="+encodeURIComponent(r),i&&(o=(o=o+"&invType="+encodeURIComponent(i))+"&invRecId="+encodeURIComponent(n))),commonUtils.showHideLoadingDiv(!0),$.ajax({url:Crm.getCrmBasePath()+"/mailer/EntReply.do",data:o,type:"POST",success:function(e){commonUtils.showHideLoadingDiv();var t=$("#emailInviteesPop");0==t.length?(t=$(Handlebars.templates.emailInviteesPop()),$("body").append(t)):$(t).empty(),t[0].innerHTML=e,t.show(),EvalInnerScript(t[0]),setTimeout((function(){editor.setContent($("#bodyContent").data("mailBody")),editor.focusAtStart()}),500)}})},simpleEmail.ClosePopup=function(){$("#emailInviteesPop").hide(),$("#viewInviteesPop").is(":visible")||$("#stNotes").is(":visible")||removeFreezeLayer()},simpleEmail.InitMail=function(){editor=ZE.create({id:"emailEditor",editorheight:200}),$(".ze_area").css("height",200),freezeBackground(),mailsetCenter("emailInviteesPop")},Crm.sharedworker={},Crm.sharedworker.cache={},Crm.sharedworker.makeRequest=function(e,t,r,a){"undefined"!=typeof Crmworker?Crmworker.port.postMessage({action:e,Key:t,KeyValue:r,params:a}):"Put"===e&&(Crm.sharedworker.cache[t]=r)},Crm.getUserDetailsMap=function(e,t){if(Crm.userDetailsMap?t&&t(Crm.userDetailsMap):void 0===InfoForDisplay?loadDataForDisplayAndMentions(!1,!0,!1,e,(function(){Crm.constructUserDetailsMap(),t&&t(Crm.userDetailsMap)})):(Crm.constructUserDetailsMap(),t&&t(Crm.userDetailsMap)),!e)return Crm.userDetailsMap},Crm.constructUserDetailsMap=function(){Crm.userDetailsMap={};for(var e=JSON.parse(InfoForDisplay),t=Crm.userDetails.NAME_FORMAT,r=t.indexOf("First")<t.indexOf("Last"),a=e.length,i=0;i<a;i++){var n=e[i],o={};if(r)var s=(n.firstName&&0!=n.firstName.length?n.firstName+" ":"")+n.lastName;else s=(n.lastName&&0!=n.lastName.length?n.lastName+" ":"")+n.firstName;o.name=s,o.avatar=n.avatar,Crm.userDetailsMap[n.id]=o}},Crm.bindEventForUserBCView=function(){var e=$("[purpose=showUserBC]");e.off("mouseover").mouseover(showUserBusinessCard),e.off("mouseout").mouseout(hideUserBusinessCard)},Crm.getUserBusinessCard=function(e,t){var r=document.getElementById("popoverTooltip");r||((r=document.createElement("crux-user-tooltip")).setAttribute("id","popoverTooltip"),r.style.display="none",t.append(r)),r.setData({userId:e}),r.component.show(t)},Crm.loadDeduplication=function(e,t,r){Crm.loadDeduplicationJSandExecute((function(){switch(t){case"Start":crmDeduplicate.startDeduplication(e);break;case"Merge":crmDeduplicate.merge(e,r.jobId,r.RecordIds,r.currentColumn,r.currentColVal,r.fromFindAndMerge,r.recordCount,r.currentFieldLabel,r.fromConflicts,r.conflictfromIndex,r.conflictendIndex,r.startIndex);break;case"Conflict":crmDeduplicate.viewConflicts(r.jobId,e,r.fromIndex,r.toIndex,r.column,r.fromMerge);break;case"ShowDuplicates":crmDeduplicate.showDuplicates(e,r.jobId,r.currentColumn,r.currentColVal,r.currentFieldLabel,r.fromViewConflicts,r.startIndex)}}))},Crm.resetSubformFields=function(e){if(crmTab.tabVsSubTabs&&crmTab.tabVsSubTabs[e]){var t=crmTab.tabVsSubTabs[e];if(t&&t.length>0)for(var r=0;r<t.length;r++)this.fieldsObj[e+"_"+t[r]]=[]}},Crm.loadDeduplicationJSandExecute=function(e){networkUtils.loadFeatureScripts(["zohocrm_deduplicate.js","i18n/"+Crm.userDetails.jsLocation+"deduplication/zohocrm_"+$ESAPI.encoder().encodeForJavaScript(Crm.userDetails.LOCALE)+".js"],e)},Crm.loadChatIntegrations=function(e,t,r,a,i){if(!i||"workflow"!==r&&"orchestration"!==r||(i=automationActions.getDataParamForWFChat(i)),!i&&t&&(i=JSON.parse($(t).attr("data-params"))),a=!a&&i?i.chatType:a,"workflow"===(r=r||i.reqFrom)||"orchestration"===r)switch(a){case"Cliq":a="cliq";break;case"Slack":a="slack";break;case"CiscoTeams":a="cisco"}else if(["0","1","2"].contains(a)){var n={0:"cliq",1:"slack",2:"cisco"};a=n[a.toString()]}if("cisco"!=a||"false"!=cisco.isCiscoTeamsAuthorised){if(arguments[5])var o=arguments[5];if(crmConstants.isAnyChatNotificationAvailable){var s=!0,l=networkUtils.returnDependencyFiles(["chat-integ-store.js","slack-setup-store.js","chat-setup-store.js","crm-chat-popup.js","chat-bc-store.js"],crmConstants.jsStaticPathForLyte);l=l.concat(networkUtils.returnDependencyFiles(["zohocrm_chatIntegration.js",networkUtils.getI18nJSUrl("chatintegrations")]));var c=networkUtils.returnDependencyFiles(["crm-chat-popup.css"],crmConstants.cssStaticPathForLyte);Lyte.injectResources(l.concat(c),void 0,(function(){var e=function(){var e=document.getElementsByTagName("crm-chat-popup")[0],t={source:r,type:a};if("analytics"===r){if(i.isHome){t.chartId=i.dbItemId,t.layoutId=i.layoutid;var n=document.getElementById(t.layoutId);t.dashboardId=JSON.parse(n.getAttribute("data-params")).dashboardId}else{t.dashboardId=i.dbId,t.chartId=i.id,t.layoutId=void 0;n=document.getElementById(t.chartId)}t.chartName=n.querySelector(".widgetHeading").innerText.trim()}else if("reports"===r)newReportsEnabled&&(t.chartName=i.chartName),t.chartId=i.reportId;else if("record"===r){t.module=i.module,t.id=i.id;var l={type:a,module:i.module,id:i.id};store.findAll("chat_bc",l,!1).then((function(e){var r=networkUtils.returnDependencyFiles(["crm-chat-bc.js"],crmConstants.jsStaticPathForLyte);r=r.concat(networkUtils.returnDependencyFiles(["crm-chat-bc.css"],crmConstants.cssStaticPathForLyte)),Lyte.injectResources(r,void 0,(function(){t.bcDetails=e,Crm.renderChatPopup(document.getElementsByTagName("crm-chat-popup")[0],t)}))}),(function(e){chatIntegration.handleErrorResponse(e)})),s=!1}else if(("workflow"==r||"orchestration"===r)&&i){if(i.teamid&&(t.teamid=i.teamid,t.slackUserId=i.suserid,t.teamName=i.teamname),t.notifyType={channel:"chat_channel",user:"chat_user",fields:"fields"}[i.notifyType.toString()],"fields"===t.notifyType){t.notifyModuleId=i.notify_fields.module_id,t.notifyLookupId=i.notify_fields.lookup_field,t.channelOrUser=t.notifyModuleId;var c=i.notify_fields.s_fields,d=i.notify_fields.fields;t.selectedFieldIds=c?c.concat(d):d}else t.userChannelId=i.notifyIds,t.userChannelName=i.name,t.channelOrUser={channel:"chat_channel",user:"chat_user"}[i.notifyType.toString()];t.message=wfmergefield.convertInfoToLabel(i.message,!0),t.editAction=!0}o&&(t.wfActionModule=o),t.wfStyleModal="workflow"===r||"orchestration"===r,s&&Crm.renderChatPopup(e,t)};"slack"==a?networkUtils.loadFeatureScripts(["zohocrm_slackHome.js","zohocrm_chatIntegration.js"],e):e()}))}}else networkUtils.loadFeatureScripts(["zohocrm_chatIntegration.js"],(function(){cisco.callback=Crm.loadChatIntegrations,cisco.callbackParams=[e,t,r,a,i],chatIntegration.authorise(chatIntegration.CISCO,r)}),"object"==typeof chatIntegration)},Crm.getVisionMyJobsDependency=function(){var e,t=networkUtils.returnDependencyFiles(["crm-ziavision-myjobs.js","crm-image-mixin.js","crm-image-preview.js","crm-vision-helper.js","exif-plugin.js","lyte-colorbox.js","crm-image-upload-ziaError.js"],crmConstants.jsStaticPathForLyte),r=networkUtils.returnDependencyFiles([networkUtils.getI18nJSUrl("ziavision")]);return e=Crm.userDetails.RTL_ENABLED?networkUtils.returnDependencyFiles(["crm-ziavision-myjobs.css","crm-zia-error.css","crm-image-upload-ziaError.css","crm-ziavision-myjobs-rtl.css","crm-image-preview.css"],crmConstants.cssStaticPathForLyte):networkUtils.returnDependencyFiles(["crm-ziavision-myjobs.css","crm-image-preview.css","crm-zia-error.css","crm-image-upload-ziaError.css"],crmConstants.cssStaticPathForLyte),t.concat(e).concat(r)},Crm.renderChatPopup=function(e,t){e?e=e.component.setData(t):Lyte.Component.render("crm-chat-popup",t,"#basic"),document.getElementById("chat-popup").ltProp("show",!0);var r=$L("#chat-message-textarea");r&&r.cruxTextareaBindResize()},Crm.loadChatIntegrationJSForCalAndSS=function(e,t){crmConstants.isAnyChatNotificationAvailable&&("calendar"!=e&&"workflow"!=e&&"signals"!=e&&"orchestration"!=e||Crm.loadAllChatJS(t))},Crm.loadAllChatJS=function(e){var t=["zohocrm_chatIntegration.js"];crmConstants.isSlackAvailable&&"undefined"==typeof slackNotificationHome&&t.push("zohocrm_slackHome.js"),networkUtils.loadFeatureScripts(t,(function(){e&&e()}))},Crm.loadCalendarSchedule=function(e,t){Crm.loadCalendarScheduleJSandExecute((function(){switch(t){case"Create":calendarSchedule.createSchedule(e.type,e.module,e.configId,!1);break;case"Manage":calendarSchedule.listSchedule()}}))},Crm.loadCalendarScheduleJSandExecute=function(e){networkUtils.loadFeatureScripts(["zohocrm_calendarSchedule.js","i18n/"+Crm.userDetails.jsLocation+"calendarschedule/zohocrm_"+$ESAPI.encoder().encodeForJavaScript(Crm.userDetails.LOCALE)+".js"],e)},Urls={},Urls.Salesinbox=Crm.getCrmBasePath()+"/salesinbox/View.do",Crm.getPortalURL=function(e){return Crm.userDetails.CLIENT_ACCOUNT&&-1===e.indexOf(Crm.userDetails.CLIENT_PORTAL_URL_CONTEXT)&&-1===e.indexOf("/crm/v2/")&&-1===e.indexOf("/crm/v2.1/")&&-1===e.indexOf("/crm/v2.2/")&&(e="/"===e[0]?Crm.getCrmBasePath()+e:Crm.getCrmBasePath()+"/"+e),e},Crm.getOrgSpecificURL=function(e){if("undefined"!=typeof crmPortal&&crmPortal&&-1===e.indexOf("/crm/"+crmPortal+"/")){var t=e.indexOf("/crm/");if(0==t||-1!=t&&(e.startsWith(document.domain)||e.startsWith(location.protocol+"//"+document.domain))){var r=t+5;e=e.substring(0,r)+crmPortal+"/"+e.substring(r)}}return e},Crm.showURLChangeAlert=function(){if(crmNewPortal){var e={val:I18n.getMsg("Refresh",[90]),fn:function(){var e=location.href,t=e.indexOf("/crm/"),r=e.substring(0,t+5),a=e.substring(t+6);a=a.substring(a.indexOf("/")),location.href=r+crmNewPortal+a}},t="<span class='crm-font-bold f20'>"+crmNewPortal+"</span>",r=$("#customConfirmationPop");r.find(".txt-ctr").removeClass("p60").addClass("p30"),r.find("br").remove(),r.find(".pT30.aligncenter").removeClass("pT30").addClass("pT15");var a={val:I18n.getMsg("Skip")};renderingUtils.showCustomConfirmMessageNewModel("<p class='crm-font-regular f20 color_3'>"+I18n.getMsg("crm.multiportal.changed1",t)+"</p><p class='crm-font-regular f15 color_3'>"+I18n.getMsg("crm.multiportal.changed2")+"</p>",e,a)}},Crm.isWMSNotifictionForCurrentOrg=function(e){var t="production"===Crm.userDetails.orgEnvType;return"string"==typeof e&&(e=JSON.parse(e)),void 0===e||void 0===e.zgid||"null"===e.zgid||""===e.zgid?t:e.zgid==Crm.userDetails.ZGID+""},Crm.linkToClick=function(){if(event.preventDefault(),"crm.tab.module.entity.convert"===arguments[0]){if(!moduleRecordMapping.Contacts.visible){var e=[];return e.push(moduleRecordMapping.Leads.plural_label),e.push(moduleRecordMapping.Contacts.plural_label),crmui.showMsgBand("error",I18n.getMsg("crm.lead.no.conversion",e),1e3),!1}var t=!!arguments[3].showPortalChange&&arguments[3].showPortalChange;arguments[3].showPortalChange=t||detailView.changedBCJson.showInConvert}var r=event.currentTarget.getAttribute("lt-prop-target");if(r){var a=$(event.currentTarget).find("a");networkUtils.openUrl(a.attr("href"),r)}else{event.preventDefault();var i=Lyte.Router.transitionTo.apply(Lyte.Router,arguments),n=event.currentTarget.getAttribute("lt-prop-td");n&&(i.data=JSON.parse(n))}},Crm.domainUrlProcess={getDomainSuggestion:function(e,t){var r=$("#orgDomainUrl"),a=$("#domainValidatingInfo"),i=$("#domainAvailableInfo"),n=$("#errorMsg_orgDomainUrl"),o=r.data("domainProcessData");if("orgDomainUrl"==t||!o.isDomainUrlManuallyEdited){e=e.toLocaleLowerCase();this.validDomainReq(t,o)&&(o.isDomainSuggReqPending=!0,a.add(i).addClass("dN"),n.remove(),a.removeClass("dN"),this.callValidateDomainAPI(e,"correct_domain").then((function(n){if(n.organizations&&n.organizations[0]){var s,l=n.organizations[0];if("orgName"===t||"Crm_Sandbox_name"===t)s=l.domain_available?e:l.corrected_domain_name,o.isDomainUrlValid=!0,o.domainUrlValiationFailed=!1,o.isSystemReservedDomainName=!1,o.isDuplicateDomainUrl=!1,r.val(s),o.orgDomainUrl_old=s,i.removeClass("dN");else"orgDomainUrl"===t&&(l.domain_available?(o.isDomainUrlValid=!0,o.domainUrlValiationFailed=!1,o.isSystemReservedDomainName=!1,o.isDuplicateDomainUrl=!1,i.removeClass("dN"),$("#errorMsg_orgDomainUrl").remove()):(o.isDomainUrlValid=!1,l.invalid_domain?(o.domainUrlValiationFailed=!0,o.isSystemReservedDomainName=l.system_reserved,o.isDuplicateDomainUrl=!1,Crm.showErrorMsg(I18n.getMsg("crm.org.create.access.url.invalid"),r)):(o.domainUrlValiationFailed=!1,o.isSystemReservedDomainName=!1,o.isDuplicateDomainUrl=!0,Crm.showErrorMsg(I18n.getMsg("crm.org.create.access.url.dup"),r))));o[t+"_old"]=e,a.addClass("dN"),o.isDomainSuggReqPending=!1}}),(function(){o.isDomainSuggReqPending=!1,a.addClass("dN")})).catch((function(){o.isDomainSuggReqPending=!1,a.addClass("dN")})))}},validDomainReq:function(e,t){var r=$("#"+e).val(),a=t[e+"_old"];return"orgDomainUrl"==e&&0==r.length?($("#domainAvailableInfo").addClass("dN"),t.isDomainUrlValid=!1,t.domainUrlValiationFailed=!0,t.isSystemReservedDomainName=!1,t.isDuplicateDomainUrl=!1,!1):!t.isDomainSuggReqPending&&(r&&r.length>0&&r!==a)},callValidateDomainAPI:function(e,t){var r={};return r.params={name:e},"suggest"!==t&&"correct_domain"!==t||(r.params.suggestion_type=t),networkUtils.lyteInitiateRequest("/crm/v2/__internal/organizations/actions/domain_availablity","GET",r)},validateDomainUrlPattern:function(){var e=$("#orgDomainUrl"),t=e.data("domainProcessData");if(!t.isDomainUrlValid){var r=I18n.getMsg("crm.org.create.access.url.invalid");return t.isDuplicateDomainUrl?r=I18n.getMsg("crm.org.create.access.url.dup"):t.domainUrlValiationFailed&&(r=I18n.getMsg("crm.org.create.access.url.invalid")),t.isSystemReservedDomainName&&(r=I18n.getMsg("crm.org.domain.reserved",[e.value.replace(/[0-9]/g,""),RebrandLinkUtil.getProperty("Brand")])),Crm.showErrorMsg(r,e),!1}return!0}},Crm.handleProductLineItemUpdate=function(e){var t=$(e).closest("tr"),r=t.data("data-rowid"),a=$(productDetails.sfFldIdSuffix+"BOOKID_"+r),i=t.find("[data-label='"+a.attr("id")+"']");if(e.val().length>0){a.attr("type","text").val("").data("id",""),i.attr("style",""),$(productDetails.sfFldIdSuffix+"QUANTITY_"+r).val(1).trigger("change");var n=$(productDetails.sfFldIdSuffix+"DISCOUNT_"+r);n.attr({percentage:"0",discType:"percent"}),n.val(0).trigger("change")}else a.attr("type","hidden").val("").data("id",""),i.attr("style","visibility:hidden")},Crm.getPrdTaxDetails=function(e,t){var r="";if(void 0!==e&&e.length>0&&"null"!==e){var a=productDetails.taxIdVsName;if(t)r=e;else for(var i=JSON.parse(e),n=JSON.parse(productDetails.allTaxes),o=JSON.parse(productDetails.newAllTaxes),s=productDetails.taxNameVsId,l=Object.keys(i),c=l.length,d=0;d<c;d++){var u=l[d],m=i[u][0],p=i[u][1],g=s[u];n[u]=p,o[u]&&(o[u][0]=m,o[u][1]=p),a[g]&&(a[g][0]=m,a[g][1]=u),r.length<1?r+=u:r+=";"+u}}return r},Crm.isLineItemSubFormModule=function(e){return"QuotedItems"===e||"OrderedItems"===e||"PurchaseItems"===e||"InvoicedItems"===e},Crm.isInventoryModule=function(e){return"Quotes"===e||"Invoices"===e||"SalesOrders"===e||"PurchaseOrders"===e},Crm.initApprovalActions(),Object.defineProperty(window,"csrfToken",{get:function(){for(var e=Crm.csrfcookiename+"=",t=document.cookie.split(";"),r=t.length,a=0;a<r;a++){for(var i=t[a];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(e))return i.substring(e.length,i.length)}},configurable:!0}),Crm.checkMaxLength=function(e,t){var r=e.prop("type");return"text"===r?e.val().length<=t:"Integer"!==r&&"Long"!==r||e.val().replace(/,/g,"").length<=t},Crm.fetchCallDetails=function(e,t,r){var a=isNewCallView?"zcrm_callsnew.js":"zcrm_callsold.js",i=networkUtils.returnDependencyFiles([a],crmConstants.jsStaticPath);Lyte.injectResources(i,void 0,(function(){Calls.fetchCallDetails(e,t,r)}))},Crm.globalCreate=function(e,t,r,a,i,n){e&&"emailsAI"==t&&(event=e);var o=$(event.target),s=networkUtils.returnDependencyFiles(["zcrm_callsnew.js"],crmConstants.jsStaticPath);renderingUtils.stopEvent(event),Lyte.injectResources(s,void 0,(function(){Calls.globalCreate(e,t,r,a,i,n,o)}))},Crm.scheduledCallMoreOption=function(e,t,r,a){var i=isNewCallView?"zcrm_callsnew.js":"zcrm_callsold.js",n=networkUtils.returnDependencyFiles([i],crmConstants.jsStaticPath);Lyte.injectResources(n,void 0,(function(){a&&(Calls.callLayoutId=a),Calls.scheduledCallMoreOption(e,t,r)}))},Crm.enableMassUpdateSaveBtn=function(){$("#bulkUpdateFldsListForScheduler").find("#saveButtonDiv").find("input")[0].disabled=!1},Crm.redirectToRSOSettings=function(){commonUtils.showHideLoadingDiv();var e={show:!1};$L("#rsoExpiredPopUp")[0].ltProp(e),removeFreezeLayer();var t=document.getElementById("saveEventsBtn");null!==t&&t.removeAttribute("disabled");var r=document.getElementById("emptyLayer");null!==r&&r.remove(),void 0!==Lyte.Router.getRouteInstance()?Lyte.Router.getRouteInstance().transitionTo("crm.settings.section.extensions.zoho-extensions.remote-sales-office.information"):location.href="/crm/settings/extensions/zoho/remote-sales-office/information"},Crm.hideRSOTrialPopup=function(){commonUtils.showHideLoadingDiv();var e={show:!1};$L("#rsoExpiredPopUp")[0].ltProp(e);var t=document.getElementById("saveEventsBtn");null!==t&&t.removeAttribute("disabled");var r=document.getElementById("calsched_savebtn");null!==r&&r.removeAttribute("disabled");var a=document.getElementById("emptyLayer"),i=document.getElementById("FreezeLayer");null!==a?a.remove():null!==i&&i.remove(),$("#rsoExpiredPopUp").remove()},$.fn.outerHTML=function(){var e=$(this);if("outerHTML"in e[0])return e[0].outerHTML;var t=e.wrap("<div></div>").parent().html();return e.unwrap(),t},window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),$.fn.setPopupClass=function(e){$("#"+e+"Popup").removeClass(),$("#"+e+"Popup").addClass("zcrm-content"),$("#"+e+"Header").removeClass(),$("#"+e+"Header").addClass("popup-model-header f21 crm-font-regular"),$("#"+e+"Content").removeClass(),$("#"+e+"Content").addClass("popup-model-content"),$("#"+e+"Footer").length>0&&($("#"+e+"Footer").removeClass(),$("#"+e+"Footer").addClass("popup-model-footer")),showAnimatePopup("topBandPopup")};try{["forEach","map","filter","every"].forEach((function(e){[NodeList,HTMLCollection].forEach((function(t){t.prototype[e]||(t.prototype[e]=function(){return Array.prototype[e].apply(this,arguments)})}))}))}catch(e){}var CJS={execScript:function(e,t,r,a,i){if(e.includes("/crm/")&&FingerPrint.isEnabled&&!a){var n=e.split("javascript/")[1].split("?")[0],o=commonUtils.getfingerPrintProperties(n);n!=o?(e=crmConstants.fp_jsStaticPath+"/"+o,FingerPrint.isCdnEnabled&&(e=crmConstants.cdn_jsStaticPath+"/"+o)):e=crmConstants.jsStaticPath+"/"+n}if(r)t();else{var s=document.createElement("script");if(s.onload=s.onreadystatechange=function(){this.readyState&&"complete"!=this.readyState&&"loaded"!=this.readyState||(this.onload=this.onreadystatechange=null,t())},e.includes("/crm/")&&(document.domain.indexOf("localzoho.com")>-1||FingerPrint.isCdnEnabled||void 0!==Crm&&Crm.userDetails&&Crm.userDetails.JS_CORS_ENABLED)?(s.src=e+FingerPrint.corsParams,s.setAttribute("crossorigin","anonymous")):s.src=e,i)s.defer=!0,document.getElementsByTagName("body")[0].appendChild(s);else{var l=document.getElementsByTagName("script")[0];l.parentNode.insertBefore(s,l)}}}},Utils={detachObjects:[],sectionNamesArrayForSearch:[],getMonthEnd:function(e,t){var r=[31,28,31,30,31,30,31,31,30,31,30,31];return 1==e&&(r[1]=t%400==0||t%4==0&&t%100!=0?29:28),r[e]},isValidTime:function(e,t){for(var r=arguments.length,a=/\d*/g,i=0;i<r;i++){if(!a.test(arguments[i]))return!1;if(0==i&&(""===arguments[i]||arguments[i]>23))return!1;if(1==i&&(""===arguments[i]||arguments[i]>59))return!1}return!0},formatTimeVal:function(e){return e=e<10?"0"+e:e},convertTimeTo24HoursFormat:function(e,t){return"am"==(t=t.toLowerCase())?0==e?12:12==e?0:e:"pm"==t?12==e?e:e+12:t==I18n.getMsg("AM")||I18n.getMsg("am")==t?0==e?12:12==e?0:e:t==I18n.getMsg("PM")||I18n.getMsg("pm")==t?12==e?e:e+12:void 0},convertTimeTo12HoursFormat:function(e,t){return"pm"==(t=t.toLowerCase())?e<=12?e:e-12:"am"==t?0==e?12:e:void 0},getDateObject:function(e,t){var r=crmCalendar.getDateObjectFromGivenDateString(e,!0===Crm.isCalendarSchedule?"mm/dd/yyyy":void 0);return t.hrs&&r.setHours(t.hrs),t.mins&&r.setMinutes(t.mins),t.sec&&r.setSeconds(t.sec),r},getTimeDiff:function(e,t){var r=(t.getTime()-e.getTime())/1e3;return{hours:r/3600,minutes:r%3600/60,seconds:r%60}},getTimeArrayWithGivenIntervalNew:function(e,t){var r,a,i,n=new CrmDate;"future"===t?(n.userDisplayMinute<=30?(a=n.userHourIn24hrFmt,i=30):(a=n.userHourIn24hrFmt+1,i=0),r=CrmDateUtils.getCrmDateFromUserTime(n.userDisplayMonth,n.userDisplayDate,n.userDisplayYear,a,i,0)):r=CrmDateUtils.getCrmDateFromUserTime(n.userDisplayMonth,n.userDisplayDate,n.userDisplayYear,0,0,0);var o=r,s=[],l=e;do{var c=o.getTimeInUserPattern(),d=o.userHourIn24hrFmt>11?"PM":"AM",u=[{name:"span",html:c,attr:{diff:0,hrs:c.split(":")[0],mins:o.userDisplayMinute,meridiem:d}}];s.push(u),o=CrmDateUtils.getAfterMinsByCrmdate(l,o)}while("past"===t?!o.isFutureTime():o.isToday());return s},getTimeArrayWithGivenInterval:function(e,t,r,a,i){if(e)r=new Date;else if(!r)r=new Date(2e3,0,1,0,0,0);t=t||30;for(var n=new Date(r),o=new Date(r),s=new Date(n.setDate(n.getDate()+1)).getTime(),l="",c=[];r.getTime()<s;){var d=r.getMinutes(),u=r.getHours(),m="HH:mm"===Crm.userDetails.TIME_FORMAT?u:this.convertTimeTo12HoursFormat(u,Utils.getMeridiem(r)),p=0,g=u>11?"PM":"AM";if("meridiem"==a&&"HH:mm"!==Crm.userDetails.TIME_FORMAT)l=u>11?I18n.getMsg("PM"):I18n.getMsg("AM");else if("timeDiff"==a){var h=this.getTimeDiff(o,r);h.hours>1?(l=h.hours+" "+I18n.getMsg("crm.workflow.scheduler.hours"),p=60*h.hours):1==h.hours?(p=60*h.hours,l=h.hours+" "+I18n.getMsg("crm.workflow.scheduler.hour")):(l=h.minutes+" "+I18n.getMsg("crm.workflow.scheduler.mins"),p=h.minutes)}var f=[{name:"span",html:Utils.formatTimeVal(m)+":"+Utils.formatTimeVal(d)+" ",attr:{diff:p,hrs:"HH:mm"===Crm.userDetails.TIME_FORMAT?u:m,mins:Utils.formatTimeVal(d),meridiem:g}}];if(l&&f.push({name:"span",html:l,attr:{class:"color2 f13 pL5"}}),c.push(f),!validationUtils.isEmpty(i)){var v=i.optionHour,C=i.optionMin,y=i.optionName,E="HH:mm"===Crm.userDetails.TIME_FORMAT?v:this.convertTimeTo12HoursFormat(v,v>12?"pm":"am"),I=[{name:"span",html:y,attr:{diff:0,hrs:"HH:mm"===Crm.userDetails.TIME_FORMAT?v:E,mins:Utils.formatTimeVal(C),meridiem:g}}];v==u&&C>=d&&C-d<t&&c.push(I)}r=new Date(r.getTime()+6e4*t)}return c},compareDate:function(e,t){var r=new Date(e.getTime());r.setHours(0,0,0,0);var a=new Date(t.getTime());return a.setHours(0,0,0,0),a.getTime()-r.getTime()>=0},compareDateandTime:function(e,t){var r=new Date(e).getTime();return new Date(t).getTime()-r>=1e3},isValidDate:function(e,t,r){if(!t)return!1;e=(e=null!=r?r:e).toUpperCase();try{return $L.moment(t,e).validate()}catch(e){return!1}},getTimeStringWithAmPm:function(e){e||(e=new Date);var t=e.getHours(),r=e.getMinutes(),a="";return"HH:mm"===Crm.userDetails.TIME_FORMAT||(a=Utils.getMeridiem(e),t=Utils.convertTimeTo12HoursFormat(t,a)),t<10&&(t="0"+t),r<10&&(r="0"+r),{hrs:t,mins:r,meridiem:a}},getMeridiem:function(e,t){var r=t?"AM":"am";return e.getHours()>=12&&(r=t?"PM":"pm"),r},getDateObjFromDateStr:function(e,t){if(!e)return"";if(t||(t=Crm.userDetails.DATE_PATTERN.toUpperCase()),!e.getMonth){var r=new Date;try{r=$L.moment(e,t).getDObj()}catch(e){murphy.error(e)}return r||(r=new Date),r}return e},convertDateToUserPattern:function(e,t){return t||(t=Crm.userDetails.DATE_PATTERN.toUpperCase()),$L.moment(new Date(e)).format(t)},getDateInUsrViewFormat:function(e){e=this.convertUsrtoDefaultDatePattern(e);var t="MMM D, YYYY";return"en_GB"==Crm.userDetails.COUNTRY_LOCALE&&(t="D MMM, YYYY"),this.convertDateToUserPattern(e,t)},getCurrentCrmTimeInUserFormat:function(){var e=new Date;return Utils.convertToUserTimezone(e),Utils.getTimeInUserFormat(e)},getDateInUsrLocaleFormat:function(e){var t="MMM D, YYYY";new Date(e).getFullYear()===(new Date).getFullYear()&&(t=t.split(",")[0]);var r=this.convertDateToUserPattern(new Date(e),t),a=r.slice(0,3);return r.replace(a,I18n.getMsg(a))},getDateInUserDatePattern:function(e,t){return this.convertDateToUserPattern(e)},getDateInGivenPattern:function(e,t){if(!(e&&e instanceof Date))e=new Date;var r=e.getDate()+" "+e.getMonth()+" "+e.getFullYear();return crmCalendar.convertToUserDatePattern(r,t)},getDateInLocaleDefaultFormat:function(e){if(!(e&&e instanceof Date))e=new Date;return crmCalendar.monthNameWithThreeLetter[e.getMonth()].html+" "+e.getDate()+", "+e.getFullYear()},getDateTimeInUsrFmtWithoutLbl:function(e,t){var r=Utils.getDateInUserDatePattern(e);return r+=" "+Utils.getTimeInUserFormat(e,t,!0)},getDateTimeInUserFormat:function(e,t,r,a){var i=Utils.getDateInUserDatePattern(e);return i+=" "+Utils.getTimeInUserFormat(e,t,a)},getUserDateTimeFormatFromServerFormat:function(e){if(e&&"string"==typeof e&&e.match("T")){(e=e.replace(/[+-]\d{2}:\d{2}/,"")).split("-");var t=$L.moment(e.split("T")[0],"YYYY-MM-DD").toDate(),r=(e=e.split("T"))[1]?e[1].split(":"):"";r&&(t.setHours(r[0]),t.setMinutes(r[1]));var a=Utils.getDateTimeInUserFormat(t,!0),i=a.slice(0,3);return a.replace(i,I18n.getMsg(i))}return e},getDateTimeInUserFormatWithI18N:function(e){if(!(e&&e instanceof Date))e=new Date;var t=Utils.getDateInLocaleDefaultFormat(e);return t+=" "+Utils.getTimeInUserFormat(e,!0)},getTimeInUserFormat:function(e,t,r){if("HH:mm"==Crm.userDetails.TIME_FORMAT&&e instanceof Date)return(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes());var a=Utils.convertTo12HoursFormatTimeObj(e,t);return r?a.hrs+":"+a.mins+" "+a.meridiem:a.hrs+":"+a.mins+" "+I18n.getMsg(a.meridiem)},convertTo12HoursFormatTimeObj:function(e,t){e||(e=new Date);var r=e.getHours(),a=this.getMeridiem(e,t),i=e.getMinutes();return(r=Utils.convertTimeTo12HoursFormat(r,Utils.getMeridiem(e)))<10&&(r="0"+r),i<10&&(i="0"+i),{hrs:r,mins:i,meridiem:a}},convertUsrtoDefaultDatePattern:function(e,t){if(!e)return"";if(!e.getMonth){var r=Crm.userDetails.DATE_PATTERN.toUpperCase();try{e=$L.moment(e,r).getDObj()}catch(e){murphy.error(e)}}return e},getTimeStrForAllDayReminder:function(){var e=Crm.calPreferences.DAYSTARTSAT.split(":"),t=new Date;t.setHours(parseInt(e[0])-1);var r="";if("HH:mm"===Crm.userDetails.TIME_FORMAT){var a=t.getHours();r=(a<10?"0"+a:a)+":00"}else{var i=Utils.convertTo12HoursFormatTimeObj(t);parseInt(i.hrs)<10&&(i.hrs=i.hrs.substr(1)),r=i.hrs+" "+I18n.getMsg(i.meridiem.toUpperCase())}return r},isToday:function(e){var t=new Date;return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()},getDayDiff:function(e,t){$.datepicker.formatDate("yy-mm-dd",e);var r=Math.abs(e.getTime()-t.getTime());return Math.ceil(r/864e5)},getMillisecondsToBasicDateProperties:function(e,t){var r=parseInt(e/864e5),a=t?parseInt(e%864e5/36e5):parseInt(e/36e5),i=parseInt(e%36e5/6e4);secs=Math.floor(e%6e4/1e3);var n={};return n.days=r,n.hours=a,n.mins=i,n.secs=secs,n},getProperI18nTimeUnit:function(e,t){return 1!=e&&(t+="s"),e+" "+(t=I18n.getMsg(t))+" "},convertTimeInDoubleToReadableForm:function(e,t){if(!validationUtils.isValidDecimal(e))return e;if(0==(e=parseFloat(e)))return 0;var r=60*e*1e3,a=Utils.getMillisecondsToBasicDateProperties(r,!0),i="";return a.days&&(i+=Utils.getProperI18nTimeUnit(a.days,"day"),delete a.mins,delete a.secs),a.hours&&(i+=t?Utils.getProperI18nTimeUnit(a.hours,t):Utils.getProperI18nTimeUnit(a.hours,"hour"),delete a.secs),a.mins&&(i+=Utils.getProperI18nTimeUnit(a.mins,"min")),a.secs&&(i+=Utils.getProperI18nTimeUnit(a.secs,"sec")),i.trim()},sortDate:function(e,t){return new Date(e)-new Date(t)},sortDateDecending:function(e,t){return new Date(t)-new Date(e)},dateEquals:function(e,t){return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}};function attachDocsIntegCallBackFn(e){var t=e.docObj,r="",a="",i="",n="",o="",s="";$(t).each((function(e,t){"true"==t.isDocumentSharedToMe?(n="upload"==t.service?""==n?t.encryptedId:n+","+t.encryptedId:""==n?t.docId:n+","+t.docId,o=""==o?t.docName:o+","+t.docName,s=""==s?t.service:s+","+t.service):(t.docName=commonUtils.HandleCommaInFileName(t.docName),r=""==r?t.docId:r+","+t.docId,a=""==a?t.docName:a+","+t.docName,i=""==i?t.service:i+","+t.service)}));var l=Crm.getCrmBasePath()+"/Status.do",c=$("#entId"),d=$("#id"),u=c.length?c.val():d.length?d.val():null,m="docIds="+r+"&docNames="+encodeURIComponent(a)+"&services="+i+"&id="+u+"&sharedDocIds="+n+"&sharedDocNames="+o+"&sharedServices="+s;fileupload.fromFileUploadField&&(m=m+"&fromFileUploadField=true&fieldId="+fileupload.fieldID),fileupload.fromFileUploadField=!1,$.ajax({type:"POST",url:l,data:m,success:function(e){var t=document.createElement("DIV");t.style.display="none",document.body.appendChild(t),t.innerHTML=e,JSEvalScript(t)}})}jQuery.fn.clonewithvalues=function(){var e=jQuery.fn.clone;return function(){for(var t=e.apply(this,arguments),r=this.find("textarea").add(this.filter("textarea")),a=t.find("textarea").add(t.filter("textarea")),i=this.find("select").add(this.filter("select")),n=t.find("select").add(t.filter("select")),o=0,s=r.length;o<s;++o)$(a[o]).val($(r[o]).val());for(o=0,s=i.length;o<s;++o)n[o].selectedIndex=i[o].selectedIndex;return t}}(),Utils.updateDateTimeUI=function(e,t){var r=$("#"+e);t||(t=r.data("dateObj")?r.data("dateObj"):new Date),r.val(Utils.getDateInUserDatePattern(t)),r.data("dateObj",t),Utils.updateTimeUI(e+"_TimeOption")},Utils.updateTimeUI=function(e){var t="HH:mm"===Crm.userDetails.TIME_FORMAT,r=$("#"+e.substr(0,e.indexOf("_TimeOption"))).data("dateObj")||new Date,a=t?Utils.getTimeStringWithAmPm(r):Utils.convertTo12HoursFormatTimeObj(r);$("#"+e).val(a.hrs+":"+a.mins+" "+I18n.getMsg(a.meridiem.toUpperCase()))},Utils.getTimeDiffInFormats=function(e,t){var r=Math.abs(t-e)/1e3,a={},i={month:2592e3,day:86400,hours:3600,minutes:60,seconds:1};return Object.keys(i).forEach((function(e){a[e]=Math.floor(r/i[e]),r-=a[e]*i[e]})),a},Utils.convertToUserTimezone=function(e){var t=e.getTimezoneOffset(),r=Utils.getTimezoneOffset();if(r!==t){var a=t-r;e.setMinutes(e.getMinutes()+a)}},Utils.getTimezoneOffset=function(e){var t=e||Crm.userDetails.TIME_ZONE,r=!1;t.indexOf("+")>-1&&(r=!0),t=t.replace("+","").replace("-","");var a=60*parseInt(t),i=t.split(".")[1],n=a+(i=parseInt(i));return r&&(n*=-1),n},function(e){var t=e.fn.html;e.fn.html=function(){return arguments.length>=1&&e(this).empty(),t.apply(this,arguments)}}(jQuery),function(e){var t=e.fn.position;e.fn.position=function(r){if(r&&r.of)return t.apply(this,arguments);if(this[0]){var a,i,n=this[0],o={top:0,left:0};if("fixed"===jQuery.css(n,"position"))i=n.getBoundingClientRect();else{a=this.offsetParent(),i=this.offset(),jQuery.nodeName(a[0],"html")||(o=a.offset());var s=e(a).eq(0).css(["borderTopWidth","borderLeftWidth"]),l=parseFloat(s.borderTopWidth);l=isFinite(l)?l||0:s.borderTopWidth;var c=parseFloat(s.borderTopWidth);c=isFinite(c)?c||0:s.borderLeftWidth,o={top:o.top+l,left:o.left+c}}var d=e(n).css(["marginTop","marginLeft"]),u=parseFloat(d.marginTop);u=isFinite(u)?u||0:d.marginTop;var m=parseFloat(d.marginLeft);return m=isFinite(m)?m||0:d.marginLeft,{top:i.top-o.top-u,left:i.left-o.left-m}}}}(jQuery),function(e){var t=e.fn.empty;e.fn.empty=function(){return thirdPartyUtils.unbindChildEvents(this),t.apply(this,arguments)}}(jQuery),function(e){var t=e.fn.remove;e.fn.remove=function(){return thirdPartyUtils.unbindChildEvents(this),t.apply(this,arguments)}}(jQuery),function(e){e.fn.filterByData=function(t,r){return void 0===r?this.filter((function(){return void 0!==e(this).data(t)})):this.filter((function(){return e(this).data(t)==r}))}}(jQuery),Utils.getTimestamp=function(){return window.performance?performance.now():+new Date},Utils.getUtcDateObj=function(e){var t=new Date(e),r=t.getTime(),a=6e4*t.getTimezoneOffset();return new Date(r+a)},Utils.getDisplayDateTime=function(e,t){var r=new Date;if(r.getFullYear()-e.getFullYear()==0&&r.getMonth()-e.getMonth()==0)switch(r.getDate()-e.getDate()){case 0:if(t){var a=r.getTime()-e.getTime(),i=a/36e5;if(i<1){var n=a/6e4;return n<1?"Now":Math.floor(n)+" mins ago"}return Math.floor(i)+" hrs ago"}return"Today";case 1:return"Yesterday"}var o="d M";return e.getFullYear()!=r.getFullYear()&&(o="d M yy"),$.datepicker.formatDate(o,e)},Utils.getDateTimeForEntity=function(e){var t,r=new Date(e),a=Utils.getUtcDateObj(r.getTime()),i=Utils.getUtcDateObj((new Date).getTime());Crm.userDetails.TIME_FORMAT;return a.getDate()===i.getDate()?Utils.getTimeInUserFormat(r,!0):(t=a.getFullYear()===i.getFullYear()?"d M":"d M yy",$.datepicker.formatDate(t,r))},Utils.getDateTimeForEntityHover=function(e){var t=new Date(e),r=(Crm.userDetails.TIME_FORMAT,Crm.userDetails.LOCALE.split("_")[0]);return("ja"!==r&&"zh"!==r?$.datepicker.formatDate("D d M yy",t):crmCalendar.convertToUserDatePattern(e))+" "+Utils.getTimeInUserFormat(t,!0)},Utils.convertDateToGivenPattern=function(e,t){return $.datepicker.formatDate(e,new Date(t))},Utils.getMonth=function(e){switch(e+1){case 1:return"January";case 2:return"February";case 3:return"March";case 4:return"April";case 5:return"May";case 6:return"June";case 7:return"July";case 8:return"August";case 9:return"September";case 10:return"October";case 11:return"November";case 12:return"December"}},Utils.convertFrom8601DateFormat=function(e){var t=new Date(e),r=Utils.getTimezoneOffset();return t.setMinutes(t.getMinutes()+r),t},Utils.ISO8601toDateObject=function(e){var t,r,a=e,i=null,n=null;return n=a.substring(a.length-6),r=a.substring(0,a.length-6),i=n.split(":"),newHr=parseInt(i[0].substring(1)),sign=i[0].substring(0,1),i[1]=parseInt(i[1]),t=new Date(r).getTime(),new Date(t)},Utils.convertTimeStrToRequiredFormat=function(e){var t=Crm.userDetails.TIME_FORMAT,r="00",a="01",i="AM",n=null,o=null;if("HH:mm"!=t){if(r=(o=(n=e.split(" "))[0].split(":"))[1],a=o[0],!(i=n[1])){r=(o=e.split(":"))[1];var s=parseInt(o[0]);if(s>=12)a=""+(s>12?s-12:s),i="PM";else a=s+"",i="AM"}"0"==a&&"AM"==i&&(a="12")}else a=(o=e.split(":"))[0],r=o[1];"HH:mm"==t&&(r.indexOf("PM")>0||r.indexOf("AM")>0)&&(r.indexOf("PM")>0&&12!=parseInt(a)&&(a=""+(12+parseInt(a))),r=r.substring(0,r.indexOf(" ")),"12"==a&&e.indexOf("AM")>0&&(a="00")),1==a.length&&(a="0"+a);var l=a+":"+r;return l+="HH:mm"==t?"":" "+i};var tempJQr=$.Event.prototype.stopPropagation;$.Event.prototype.stopPropagation=function(e){null==this.currentTarget&&null==this.currentTarget||null==this.currentTarget.attributes&&null==this.currentTarget.attributes||null!=this.currentTarget.attributes.isOpenerNotNeeded&&0!=this.currentTarget.attributes.isOpenerNotNeeded||null==this.currentTarget.attributes.href||null!=this.currentTarget.attributes.rel&&""!=this.currentTarget.attributes.rel||null==this.currentTarget.attributes.target||"_blank"!=this.currentTarget.attributes.target||("chrome"===$.browser.name&&$.browser.versionNumber>=49||"firefox"===$.browser.name&&$.browser.versionNumber>=52||"safari"===$.browser.name&&$.browser.versionNumber>=10||"opera"===$.browser.name&&$.browser.versionNumber>=36)&&(this.currentTarget.attributes.rel="noopener"),tempJQr.call(this)};var tempNativ=Event.prototype.stopPropagation;Event.prototype.stopPropagation=function(e){null==this.currentTarget&&null==this.currentTarget||null==this.currentTarget.attributes&&null==this.currentTarget.attributes||null!=this.currentTarget.attributes.isOpenerNotNeeded&&0!=this.currentTarget.attributes.isOpenerNotNeeded||null==this.currentTarget.attributes.href||null!=this.currentTarget.attributes.rel&&""!=this.currentTarget.attributes.rel||null==this.currentTarget.attributes.target||"_blank"!=this.currentTarget.attributes.target||("chrome"===$.browser.name&&$.browser.versionNumber>=49||"firefox"===$.browser.name&&$.browser.versionNumber>=52||"safari"===$.browser.name&&$.browser.versionNumber>=10||"opera"===$.browser.name&&$.browser.versionNumber>=36)&&(this.currentTarget.attributes.rel="noopener"),tempNativ.call(this)},Utils.getCurrentDomain=function(){return window.location.protocol+"//"+window.location.host},Utils.getCustomisedSingularLabel=function(e){var t=Crm.moduleInfo,r="Deals"===e?"Potentials":e;return t[r]?t[r].translatedSingularLabel:e},Utils.getQueryParamsFromUrl=function(e){var t={};if(e){var r=e.split("?")[1];"string"==typeof r&&(t=Utils.convertStrQueryparamsToJSON(r))}return t},Utils.convertStrQueryparamsToJSON=function(e){var t={};try{e.split("&").forEach((function(e){2===(e=e.split("=")).length&&(t[e[0]]=e[1])}))}catch(e){}return t},Utils.getMatchedRow=function(e,t,r){if(Array.isArray(e))for(var a=e.length,i=0;i<a;i++)if(e[i][t]==r)return e[i]},Utils.inverseKeyValues=function(e){var t={};for(var r in e)t[e[r]]=r;return t},Utils.removeDuplicates=function(e){var t={};return e.forEach((function(e){t[e]=!0})),Object.keys(t)},Utils.updateObject=function(e,t,r){t.forEach((function(t){e[t]=r}))},Utils.removeKeysFromGivenObj=function(e,t){t.forEach((function(t){e.hasOwnProperty(t)&&delete e[t]}))},Utils.convertTimeValueTo24HourFormat=function(e){var t=e.split(":"),r=t[0].trim(),a=t[1].split(" "),i=a[0].trim();return null==a[1]||a[1].toUpperCase()!=I18n.getMsg("AM")&&"AM"!=a[1].toUpperCase()||"12"!=r||(r="0"),null!=a[1]&&(a[1].toUpperCase()==I18n.getMsg("PM")||"PM"==a[1].toUpperCase())&&Number(r)<12&&(r=Number(r)+12),Number(r)<10&&r.toString().length<2&&(r="0"+r),r+":"+i},Utils.getTimefromMillisecs=function(e){if(null!=e){var t=Utils.getMillisecondsToBasicDateProperties(e,!0),r="";return t.days&&(r+=a(t.days,"day")),t.hours&&(r+=a(t.hours,"hour")),(t.days||t.hours)&&0==t.mins||(r+=a(t.mins,"minute")),r.trim();function a(e,t){return e+" "+(t=I18n.getMsg(e>1?t+"s":t))+" "}}},Utils.windowLocationReload=function(e){var t=window.location.href;if(-1===t.indexOf("frameorigin")){var r=Utils.getUpdatedFrameOriginURL(t);r!==t&&history.replaceState(history.state,"",r)}window.location.reload(e)},Utils.windowLocationHref=function(e){window.location.href=Utils.getUpdatedFrameOriginURL(e)},Utils.getUpdatedFrameOriginURL=function(e){if(-1===e.indexOf("frameorigin")&&"undefined"!=typeof CrmPlusLib&&CrmPlusLib.isLoadedInCrmplusFrame&&CrmPlusLib.getFrameOriginForURL){var t=CrmPlusLib.getFrameOriginForURL();t&&(e+=-1===e.indexOf("?")?"?":"&",e+="frameorigin="+t)}return e};var objectUtils={getKeys:function(e){var t=[];if(!e)return t;if(Object.keys)t=Object.keys(e);else for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t},findKey:function(e,t){return Object.keys(e).filter((function(r){return e[r]===t}))[0]},parseURLParamString:function(e){var t,r,a,i,n={};for(a=0,i=(t=e.split("&")).length;a<i;a++)r=t[a].split("="),n[decodeURIComponent(r[0])]=decodeURIComponent(r[1]);return n},URL:function(e){var t={},r=[],a=(r=e.split("?")[1])?r.split("&"):[];return{getParams:function(){for(var e in a)if(a.hasOwnProperty(e)){var r=a[e].split("=");t[r[0]]=decodeURIComponent((r[1]||"").replace(/\+/g," "))}return t}}},cloneObject:function(e){var t={};for(var r in e){var a=e[r];if(jQuery.isPlainObject(a))a=this.cloneObject(a);else if(jQuery.isArray(a)){for(var i=[],n=a.length,o=0;o<n;o++)jQuery.isPlainObject(a[o])?i.push(this.cloneObject(a[o])):i.push(a[o]);a=i}t[r]=a}return t},cloneObject_new:function(e){return e&&"function"==typeof e.clone?e.clone():objectUtils.deepClone(e,[],[],!0)},removeKeyFromGivenObj:function(e,t){return e.hasOwnProperty(t)&&delete e[t],e},addKeyToGivenObj:function(e,t,r){return e.hasOwnProperty(t)||(e[t]=r),e},getLength:function(e){return objectUtils.getKeys(e).length},convertArrayToMap:function(e){var t={};return e.forEach((function(e){t[e]=!0})),t},convertKeys:function(e,t){for(var r in t){var a=t[r],i=e[r];r!=a&&void 0!==i&&(e[a]=i,delete e[r])}},getValueFromObj:function(e,t){if(e){if(Array.isArray(t)){for(var r=t.length,a=0;a<r;a++){if(!e)return;e=e[t[a]]}return e}return e[t]}},jsonToQueryParam:function(e){return"object"==typeof e?Object.keys(e).map((function(t){return t+"="+e[t]})).join("&"):""},getMatchedObject:function(e,t,r){var a;return e.every((function(e){return e[t]!==r||(a=e,!1)})),a},getMatchedKey:function(e,t){for(var r in e)if(e[r]===t)return r},deepClone:function(e,t,r,a){if(e&&"function"==typeof e.clone)return e.clone();var i=objectUtils.typeOf(e),n=function(n){for(var o=t.length,s=0;s<o;){if(e===t[s])return r[s];s+=1}if(t[s+1]=e,r[s+1]=n,"Array"===i)e.forEach((function(e){n.push(a?objectUtils.deepClone(e,t,r,!0):e)}));else for(var l in e)n[l]=a?objectUtils.deepClone(e[l],t,r,!0):e[l];return n};return"Object"===i?n({}):"Array"===i?n([]):"Date"===i?new Date(e.valueOf()):"RegExp"===i?objectUtils.cloneRegExp(e):/^HTML.*Element$/.test(i)?e.cloneNode():e},cloneRegExp:function(e){return new RegExp(e.source,(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.sticky?"y":"")+(e.unicode?"u":""))},typeOf:function(e){return null==e?"Null":null==e?"Undefined":Object.prototype.toString.call(e).slice(8,-1)}};Array.prototype.contains||(Array.prototype.contains=function(e){for(var t=this.length,r=0;r<t;r++)if(this[r]==e)return!0;return!1}),Array.prototype.pushUniqValues||(Array.prototype.pushUniqValues=function(e){return-1===this.lastIndexOf(e)&&(this.push(e),!0)}),Array.prototype.removeLastOccurenceOfElement||(Array.prototype.removeLastOccurenceOfElement=function(e){var t=this.lastIndexOf(e);return-1!==t&&(this.splice(t,1),!0)}),Array.prototype.removeFirstOccurenceOfElement||(Array.prototype.removeFirstOccurenceOfElement=function(e){for(var t=this.length,r=0;r<t;r++)if(this[r]===e){this.splice(r,1);break}}),Array.prototype.removeArrayElements||(Array.prototype.removeArrayElements=function(e){for(var t=e.length,r=0;r<t;r++)this.removeLastOccurenceOfElement(e[r]);return this}),Array.prototype.deleteElementAt||(Array.prototype.deleteElementAt=function(e){-1!==e&&this.splice(e,1)}),Array.prototype.filterWithLimit||(Array.prototype.filterWithLimit=function(e,t){for(var r=this,a=[],i=r.length,n=0,o=0;o<i&&(e(r[o],o)&&(a.push(r[o]),n++),!(t&&n>=t));o++);return a}),Array.prototype.sortBy||(Array.prototype.sortBy=function(e){return $u.sortBy(this,e)}),Array.prototype.sortDescOrder||(Array.prototype.sortDescOrder=function(e){return $u.sortBy(this,e).reverse()}),Array.prototype.first||(Array.prototype.first=function(e){return e?this.slice(0,e):this[0]}),Array.prototype.last||(Array.prototype.last=function(e){return e?this.slice(Math.max(this.length-e,0)):this[this.length-1]}),Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{value:function(e){if(null==this)throw new TypeError("this is null or not defined");for(var t=Object(this),r=t.length>>>0,a=arguments[1],i=a>>0,n=i<0?Math.max(r+i,0):Math.min(i,r),o=arguments[2],s=void 0===o?r:o>>0,l=s<0?Math.max(r+s,0):Math.min(s,r);n<l;)t[n]=e,n++;return t}}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var r=Object(this),a=r.length>>>0;if(0===a)return!1;var i,n,o=0|t,s=Math.max(o>=0?o:a-Math.abs(o),0);for(;s<a;){if((i=r[s])===(n=e)||"number"==typeof i&&"number"==typeof n&&isNaN(i)&&isNaN(n))return!0;s++}return!1}}),Array.prototype.removeAll||(Array.prototype.removeAll=function(e){for(var t=this,r=e.length,a=0;a<r;a++)t.contains(e[a])&&t.splice(t.indexOf(e[a]),1);return t}),Array.prototype.diff||(Array.prototype.diff=function(e){return this.filter((function(t){return e.indexOf(t)<0}))}),Array.prototype.unique||(Array.prototype.unique=function(){var e=this;return e.filter((function(t,r){return e.indexOf(t)===r}))}),Array.prototype.intersection||(Array.prototype.intersection=function(e){return this.filter((function(t){return e.indexOf(t)>-1}))}),Array.prototype.mapByKey||(Array.prototype.mapByKey=function(e){for(var t=[],r=this.length,a=0;a<r;++a){var i=this[a];i.hasOwnProperty(e)&&t.push(i[e])}return t}),String.prototype.startsWith||(String.prototype.startsWith=function(e){return 0===this.indexOf(e)}),String.prototype.endsWith||(String.prototype.endsWith=function(e){return this.length>=e.length&&this.substr(this.length-e.length)==e}),String.prototype.removeSpecialChars||(String.prototype.removeSpecialChars=function(){return this.replace(/[^a-zA-Z0-9]+/g,"")}),String.prototype.extractLast||(String.prototype.extractLast=function(){return this.split(/,\s*/).pop()}),String.prototype.getOnlyNO||(String.prototype.getOnlyNO=function(){return this.replace(/[^\d]/g,"")}),String.prototype.firstLetterCap||(String.prototype.firstLetterCap=function(){return this.charAt(0).toUpperCase()+this.slice(1)}),String.prototype.replaceAtIndex||(String.prototype.replaceAtIndex=function(e,t){this.split("")[e]=t}),String.prototype.replaceAll||(String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(e+"\\b","gi")," "+t)}),String.prototype.replaceBetween||(String.prototype.replaceBetween=function(e,t,r){return this.substring(0,e)+r+this.substring(t)}),String.prototype.includes||(String.prototype.includes=function(e,t){return"number"!=typeof t&&(t=0),!(t+e.length>this.length)&&-1!==this.indexOf(e,t)});var validationUtils={emailRegex:/^[\p{L}\p{M}\p{N}_]([\p{L}\p{M}\p{N}!#$%&'*+\-/=?^_`{|}~.]*)@(?=.{4,256}$)(([\p{L}\p{N}\p{M}]+)(([-_]*[\p{L}\p{M}\p{N}])*)[.])+[\p{L}\p{M}]{2,22}$/,emailRegexOfUser:/^[\w](['A-Za-z0-9._%\-+]*@[A-Za-z0-9-]+(\.[a-zA-Z0-9-]{1,30}){0,9}\.[a-zA-Z]{2,22})$/,isEmpty:function(e){try{var t=null;if(!e||"null"===e||"NULL"===e||"empty"===e||"EMPTY"===e||"undefined"===e||"UNDEFINED"===e)return!0;if("object"!=typeof e&&"string"==typeof e)t=e.replace(/[ ]/g,"");else if("object"==typeof e)return Object.keys(e).length<1;return""===t}catch(e){return!0}},isNotEmpty:function(e){return!this.isEmpty(e)},isUndefined:function(e,t){if(void 0===e||!e)return!0;if("object"==typeof e){var r=e[t];return void 0===r||!r}return!1},isFieldEmpty:function(e){var t=e.prop("type");if(null==(r=commonUtils.getValue(e))&&e[0]&&e[0].component&&"single"===e[0].getAttribute("type"))var r=e[0].component.data.userId;if("text"===t&&e.data("contentType")&&-1!==e.data("contentType").toLowerCase().indexOf("date"))r=r.replace(Crm.userDetails.DATE_PATTERN,"");else if("radio"===t){var a=e.prop("name");r=commonUtils.getRadioValue(a)}else"checkbox"===t?r=e.is(":checked")?"true":"false":"combo"!==t&&"select-one"!==t&&"select"!==t||r&&(r=r.replace(/-None-|none|None/g,""));return validationUtils.isEmptyString(r)},isValidEmail:function(e){if(""==e)return!0;if(null==e)return!1;var t=new XRegExp(validationUtils.emailRegex.source,"i");return XRegExp.test(e.trim(),t)},isValidEmailOfUser:function(e){return""==e||validationUtils.emailRegexOfUser.test(e)},validatePattern:function(e,t){if(""==t)return!0;if(null==t)return!1;var r=new XRegExp(e.source,"i");return XRegExp.test(t.trim(),r)},isValidTwitter:function(e){if(""===e)return!0;if(e.trim().length<=50&&e.trim().length>0){return/^[a-zA-Z0-9_]*$/.test(e)}},isValidDomain:function(e){return""===e||new RegExp("^([a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?.)+[a-zA-Z]{2,22}$").test(e)},isValidWebUrl:function(e){if(""===e)return!0;return new RegExp('^(http:\\/\\/www.|https:\\/\\/www.|ftp:\\/\\/www.|www.|http:\\/\\/|https:\\/\\/|ftp:\\/\\/|){1}[^\0-"-\'*-,.-/:-?[-^`{}- ]+(\\.[^\0-"$-,.-/<>@[-^`{}- ]+)+([/?].*)*$').test(e)},isValidInteger:function(e){if(""===e)return!0;return!(isNaN(e)||-1!==e.indexOf(".")||!/^-?\d+(,(\d)+)*$/.test(e))},isValidNumber:function(e,t){var r=/^-?(\d+)(\.)*(\d+)*$/.exec(e);if(!r)return!1;var a=r[3];return!(a&&t&&a.length>t)},isValidDecimal:function(e,t,r,a){if(""===e)return!0;if(-1!==(e+="").indexOf(".")){var i=e.split(".");if(""===i[0]&&""===i[1])return!1}0===e.split(".")[0].length&&(e=0+e);var n=/^-?(\d+)?(\.){0,1}(\d+)*$/.exec(e);if(!n)return!1;var o=n[1],s=n[3];if(null==o&&null==s)return!1;if((o?o.length:0)+(s?s.length:0)<=t+r&&(o&&(t=o.length),s&&(r=s.length)),s||(t+=r),o){if(!validationUtils.isValidInteger(o))return!1;if(o.length>t)return a&&(a.maxlengthFailed=!0),!1}if(s){if(!validationUtils.isValidInteger(s))return!1;if(s.length>r)return a&&(a.decimalLengthCheckFailed=!0),!1}return!0},decimalLengthCheck:function(e,t){if(""===e)return!0;var r=/^-?(\d+)?(\.){0,1}(\d+)*$/.exec(e);if(!r)return!1;var a=r[3];return!(a&&a.length>t)},validateCommaSepEmails:function(e){var t=$("#"+e),r=t.val();if(!r)return!0;if(""!==r)for(var a=(o=r.split(",")).length,i=0;i<a;i++){var n=trimBoth(o[i]);if(!validationUtils.isValidEmail(n)){var o=r.split(",");return renderingUtils.showCustomAlert(I18n.getMsg("crm.email.comma")),t.focus(),!1}}return!0},checkEmailLimitExceed:function(e,t,r,a){var i=e.split(","),n=[],o=[];return a=a||50,"null"!==t&&(n=t.split(",")),"null"!==r&&(o=r.split(",")),i.length+n.length+o.length>a},isInteger:function(e){return!isNaN(e)&&parseFloat(e)%1==0},isValidPhoneNo:function(e,t){if(t){void 0!==Crm&&Crm.userDetails.isPhoneNoNewView&&"undefined"!=typeof CrmPhoneNumberInput&&(t=CrmPhoneNumberInput.getValueFromPhoneFieldComp(e,t));var r=e.attr("maxlength"),a=t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/[\u202c]/g,"")).replace(/[,](?!.)/,"")).replace(/\s{2,}/g," ")).replace(/\s-/g,"-")).replace(/-\s/g,"-")).replace(/\s[.]/g,"[.]")).replace(/\s;/g,";")).replace(/;\s/g,";")).replace(/\s,/g,",")).replace(/,\s/g,",")).replace(/\(\s/g,"(")).replace(/\s\)/g,")"),i=(a=a.replace(/\)(?![\s;,\-\/])/g,") ")).length;if(""===a)return!1;for(var n=a[0],o=1;o<i;o++)"("===a[o]&&" "!==a[o-1]?n=n+" "+a[o]:n+=a[o];return(n=(n=n.replace(/^\s+/,"")).replace(/\s+$/,"")).length<=r&&(t=n),!!/^([\+]?)(?![\.-])((?=([\.\/-]?[ ]?[\da-zA-Z]+))\3+|([ ]?\((?![\.-])(?=[ \.-]?[\da-zA-Z]+)([ \.-]?[\da-zA-Z]+)+\)(?!\.)([ -][\da-zA-Z]+)?)+)+((([,]+)?[;]?([\*#]+)?[\da-zA-Z]+)+)?[#;]?$/.test(t)&&(void 0!==Crm&&Crm.userDetails.isPhoneNoNewView&&"undefined"!=typeof CrmPhoneNumberInput?CrmPhoneNumberInput.validatePhoneNumber(e):(e.val(t),!0))}return!0},isJson:function(e){try{if("object"==typeof e||JSON.parse(e))return!0}catch(e){}return!1},isJsonCheck:function(e){try{if("object"==typeof e||(JSON.parse(e),0))return!0}catch(e){}return!1},IsJsonString:function(e){try{JSON.parse(e)}catch(e){return!1}return!0},isEmptyString:function(e){return null==e||"string"==typeof e&&0===e.trim().length}},cookieUtils={setCookie:function(e,t,r,a,i,n){var o=new Date;o.setDate(o.getDate()+r);var s=e+"="+t+"; ";r&&(s+="expires="+o.toUTCString()+"; "),i&&(s+="domain="+i+"; "),a&&(s+="path="+a+";"),n&&(s+=" secure"),document.cookie=s},updateCookie:function(e,t,r){var a=this.getCookie(e),i=t;i=i.replace(/\./gi,"\\."),i=new RegExp(i),a?a=a.search(i)>-1||r?(a=(a=(a=a.replace(i,"","g")).replace(/,{2,}/gi,",")).replace(/^,/,"")).replace(/,$/,""):a+","+t:r||(a=t),a?this.setCookie(e,a):this.deleteCookie(e)},getCookie:function(e){var t=document.cookie,r=t.indexOf(" "+e+"=");if(-1===r&&(r=t.indexOf(e+"=")),-1===r)t=null;else{r=t.indexOf("=",r)+1;var a=t.indexOf(";",r);-1===a&&(a=t.length),t=unescape(t.substring(r,a))}return t},deleteCookie:function(e,t,r){var a=new Date;a.setTime(a.getTime()-1);var i=e+"= ; expires="+a.toGMTString()+"; ";t&&(i+="path="+t+";"),r&&(i+="domain="+r+";"),document.cookie=i}},currencyUtils={getPresentCurrencySepartor:function(){var e=$("#subvalue_CURRENCYISOCODE").text();return""===e&&(e=Crm.userDetails.BASE_CURRENCY),Crm.userDetails.CURRENCY_DETAILS&&Crm.userDetails.CURRENCY_DETAILS[e]?Crm.userDetails.CURRENCY_DETAILS[e]?Crm.userDetails.CURRENCY_DETAILS[e].format.split("|")[0]:",":Crm.userDetails.defaultOrgCurrency&&Crm.userDetails.DEFAULT_ORG_CURRENCY&&Crm.userDetails.DEFAULT_ORG_CURRENCY.format?Crm.userDetails.DEFAULT_ORG_CURRENCY.format.split("|")[0]:","},applyRounding:function(e,t,r){return!isNaN(e)&&r>-1?(e=Number(e).toFixed(16),t==CrmField.UITYPES.CURRENCY_ROUND_OFF?e=Math.round(e*Math.pow(10,r))/Math.pow(10,r):t==CrmField.UITYPES.CURRENCY_ROUND_DOWN?e=Math.floor(e*Math.pow(10,r))/Math.pow(10,r):t==CrmField.UITYPES.CURRENCY_ROUND_UP&&(e=Math.ceil(e*Math.pow(10,r))/Math.pow(10,r)),e):e},returnValueInDefaultCurrency:function(e,t,r,a,i,n){var o=Crm.userDetails;isNaN(n)||(t=currencyUtils.applyRounding(t,i,n));var s=currencyUtils.getNumberWithCommas(parseFloat(t),",","."),l=void 0!==r?r:void 0!==o.defaultRoundOff?parseInt(o.defaultRoundOff):2,c=parseFloat(t),d=Number(Math.round(c+"e+"+l)+"e-"+l).toFixed(l);if(o.CURRENCY_DETAILS[o.BASE_CURRENCY]&&e){l=parseInt(o.CURRENCY_DETAILS[o.BASE_CURRENCY].decimals);var u=parseInt(o.CURRENCY_DETAILS[e].decimals),m=(a?t/parseFloat(a):t/parseFloat(o.CURRENCY_DETAILS[e].er))+"",p=o.CURRENCY_DETAILS[e].format.split("|"),g=o.CURRENCY_DETAILS[o.BASE_CURRENCY].format.split("|"),h=currencyUtils.getNumberWithCommas(Number(Math.round(c+"e+"+u)+"e-"+u).toFixed(u),p[0],p[1]);if(e==o.BASE_CURRENCY)s=o.CURRENCY_DETAILS[e].symbol+" "+h;else{var f=Number(Math.round(parseFloat(m)+"e+"+l)+"e-"+l).toFixed(l);s=o.CURRENCY_DETAILS[e].symbol+" "+h+" ("+o.CURRENCY_DETAILS[o.BASE_CURRENCY].symbol+" "+currencyUtils.getNumberWithCommas(currencyUtils.getWholeOrDecimalValue(f,l),g[0],g[1])+")"}}else if(o.defaultOrgCurrency){p=o.DEFAULT_ORG_CURRENCY&&o.DEFAULT_ORG_CURRENCY.format?o.DEFAULT_ORG_CURRENCY.format.split("|"):[",","."];s=o.defaultOrgCurrency+" "+currencyUtils.getNumberWithCommas(d,p[0],p[1])}else if(o.CURRENCY_DETAILS&&o.BASE_CURRENCY&&o.CURRENCY_DETAILS[o.BASE_CURRENCY]){l=parseInt(o.CURRENCY_DETAILS[o.BASE_CURRENCY].decimals),d=Number(Math.round(c+"e+"+l)+"e-"+l).toFixed(l);p=o.CURRENCY_DETAILS[o.BASE_CURRENCY].format.split("|");s=o.CURRENCY_DETAILS[o.BASE_CURRENCY].symbol+" "+currencyUtils.getNumberWithCommas(d,p[0],p[1])}return s},isValidCurrency:function(e,t,r,a){return validationUtils.isValidDecimal(e,t,r,a)},getCurrencyWithoutSeperator:function(e){if(e=e.replace(/\u00a0/g,""),!((e=/[0-9\.,]+/g.exec(e))&&e.length>0))return"";e=(e=e[0]).replace(/^\./g,"");var t=currencyUtils.getPresentCurrencySepartor();if("."===t){for(e=e.replace(/\./g,"");e.search(/,(\d+)?0$/)>-1;)e=e.replace(/0$/,"");e=(e=e.replace(/,$/,"")).replace(/,(\d+$)/,".$1")}else if(""===t.trim()){for(e=e.replace(/\ /g,"");e.search(/,(\d+)?0$/)>-1;)e=e.replace(/0$/,"");e=(e=e.replace(/,$/,"")).replace(/,(\d+$)/,".$1")}else{for(e=e.replace(/,/g,"");e.search(/\.(\d+)?0$/)>-1;)e=e.replace(/0$/,"");e=e.replace(/\.$/,"")}return e},getNumberWithCommas:function(e,t,r){t=t||",",r=r||".";var a=e.toString().split(".");return a[0]=a[0].replace(/\B(?=(\d{3})+(?!\d))/g,t),a.join(r)},getWholeOrDecimalValue:function(e,t){return isNaN(e)||0===e.toString().length?void 0:e-Math.floor(e)==0?parseFloat(e):Number(e).toFixed(t)},getCurrencySymbol:function(e){switch(e){case"USD":case"AUD":case"SGD":case"MXN":default:return"$";case"CNY":return"¥ /元";case"INR":return"₹";case"JPY":return"¥";case"GBP":return"£";case"EUR":return"€"}}},networkUtils={filesArray:[],constructUrl:function(e,t){var r=e,a=0;for(var i in t)r+=0==a?"?"+i+"="+t[i]:"&"+i+"="+t[i],a++;return r},constructEncodedUrl:function(e,t,r){var a=e,i=0;for(var n in t)r&&/\b(calleeObj|clickId)\b/.test(n)||(a+=0==i?"?"+n+"="+encodeURIComponent(t[n]):"&"+n+"="+encodeURIComponent(t[n]),i++);return a},setCsrfParam:function(e){e[csrfParamName]=csrfToken},openUrl:function(e,t,r){if(null==r&&null!=t&&"_top"!==t&&"_self"!==t&&"_parent"!==t)t=t||"",r="noopener noreferrer",window.open(e,t,r);else{"_self"===t&&(e=Utils.getUpdatedFrameOriginURL(e));var a=window.open(e,t,r);"widgetConnectorAuthorize"!==t&&a&&(a.opener=null)}},openUrlwithpopBlockerHandle:function(e,t){var r,a=window.open(e);return null==a?(renderingUtils.showCustomAlert(t,"",!0),r=!0):(a.opener=null,r=!1),r},constructScriptPath:function(e,t){var r;if(e==crmConstants.jsStaticPath||e==crmConstants.cssStaticPath){var a=t.includes(".css")?[crmConstants.cssStaticPath,crmConstants.fp_cssStaticPath,crmConstants.cdn_cssStaticPath]:[crmConstants.jsStaticPath,crmConstants.fp_jsStaticPath,crmConstants.cdn_jsStaticPath];t!=(i=commonUtils.getfingerPrintProperties(t))?(r=a[1]+"/"+i,FingerPrint.isCdnEnabled&&(r=a[2]+"/"+i)):r=a[0]+"/"+t}else if(e===crmConstants.jsStaticPathForLyte||e===crmConstants.cssStaticPathForLyte||e===crmConstants.lessStaticPathForLyte||e.indexOf("css/compiled-css")>=0){var i;a=t.includes(".css")?[crmConstants.cssStaticPathForLyte,crmConstants.fp_cssStaticPathForLyte,crmConstants.cdn_cssStaticPathForLyte]:[crmConstants.jsStaticPathForLyte,crmConstants.fp_jsStaticPathForLyte,crmConstants.cdn_jsStaticPathForLyte];if(e.indexOf("css/compiled-css/feature-")>=0)t=e.split("/crm/CRMClient/css/")[1]+t;else if(e.indexOf("css/compiled-css")>=0){t="compiled-css/default/"+(Crm.userDetails.RTL_ENABLED?"rtl":"ltr")+"/"+t}t!=(i=commonUtils.getfingerPrintProperties(t,"CRMClient"))?(r=a[1]+"/"+i,FingerPrint.isCdnEnabled&&(r=a[2]+"/"+i)):r=a[0]+"/"+t}else r=e+t;return r},returnDependencyFiles:function(e,t){var r;if(crmConstants.compression)r=e;else if(Array.isArray(e)){e=commonUtils.getArrayList(e);var a=networkUtils.fetchUncompressedFiles(e);r=[];for(var i=a.length,n=0;n<i;n++){var o=a[n];if("string"==typeof o)r=r.concat(o);else{var s=o.length,l={};l.parent=o[s-2],l.child=o[s-1];for(var c=s-3;c>=0;c--){var d={};d.parent=o[c],d.child=l,l=d}r=r.concat(l)}}}else r=e;t=t||crmConstants.jsStaticPath;var u=!1;Array.isArray(r)||(r=[r],u=!0);s=r.length;for(var m=0;m<s;m++)"object"==typeof r[m]?(r[m].parent=networkUtils.returnDependencyFiles(r[m].parent,t),r[m].child=networkUtils.returnDependencyFiles(r[m].child,t)):r[m]=networkUtils.constructScriptPath(t,r[m]);return u?r[0]:r},returnFilesWithPath:function(e){for(var t=[],r=e.length,a=0;a<r;a++){var i,n=commonUtils.getfingerPrintProperties(e[a]);i=e[a]!=n?(i=(i=crmConstants.fp_jsStaticPath+"/"+n).split(/crm(.+)/)[1]).replace(/\/+/g,"/"):(i=(i=crmConstants.jsStaticPath+"/"+e[a]).split(/crm(.+)/)[1]).replace(/\/+/g,"/"),t.push(i)}return t},loadFeatureScripts:function(e,t,r){if(!crmConstants.compression){for(var a=networkUtils.fetchUncompressedFiles(e),i=[],n=a.length,o=0;o<n;o++)i=i.concat(a[o]);e=i}var s=networkUtils.returnFilesWithPath(e),l=networkUtils.returnUnloadedFiles(e,s);0!==l.length?networkUtils.loadScripts(l,t,r):t&&t()},loadScripts:function(e,t,r){if(e.length){var a=crmConstants.jsStaticPath+"/"+e[0],i=[];i.push(e[0]);var n=networkUtils.returnFilesWithPath(i);CJS.execScript(a,(function(){networkUtils.filesArray.push(n[0]);var a=e.splice(1,e.length);networkUtils.loadScripts(a,t,r)}),void 0,void 0,r)}else t&&t()},fetchUncompressedFiles:function(e){for(var t=e.length,r=[],a=0;a<t;a++){if(CRM_COMPRESSION_LIST[e[a]])1!==(o=CRM_COMPRESSION_LIST[e[a]]).length?r[a]=o:r=r.concat(o);else if("object"==typeof e[a]){for(var i=e[a].length,n=e[a],o=[],s=0;s<i;s++)o=CRM_COMPRESSION_LIST[n[s]]?o.concat(CRM_COMPRESSION_LIST[n[s]]):o.concat(n[s]);r[a]=o}else r=r.concat(e[a])}return r},returnUnloadedFiles:function(e,t){for(var r=Object.keys(Lyte.injectResources.availableTags),a=r.length,i=[],n=[],o=0;o<a;o++)r[o]=r[o].replace(/\/+/g,"/"),r[o]=r[o].split(/crm(.+)/)[1],r[o]&&(r[o]=r[o].split(".js")[0]+".js"),r[o]&&!networkUtils.filesArray.contains(r[o])&&networkUtils.filesArray.push(r[o]);if(networkUtils.filesArray.length>0){var s=e.length;for(o=0;o<s;o++)networkUtils.filesArray.contains(t[o])||(i.push(e[o]),n.push(t[o]));return i}return e},checkscriptSource:function(){for(var e,t=$("script"),r=t.length,a=0;a<r;a++)(e=t[a].src)&&(e=(e=e.replace(/\/+/g,"/")).split(/crm(.+)/)[1])&&(e=e.split(".js")[0]+".js"),e&&!networkUtils.filesArray.contains(e)&&networkUtils.filesArray.push(e)},makeRequest:function(e,t,r){var a=r.params||{},i=r.headers||{},n=!r.skip_load_tab,o=r.success_callback,s=r.failure_callback,l=r.data_type,c=r.content_type,d=t;t="PUT"===t||"PATCH"===t||"DELETE"===t?"POST":t,n&&commonUtils.showHideLoadingDiv(!0),i["X-ZCSRF-TOKEN"]=csrfParamName+"="+cookieUtils.getCookie("crmcsr"),window.clientPortalName&&(i["X-CRMPORTAL"]=window.clientPortalName),d!=t&&(i["X-HTTP-Method-Override"]=d);var u=new crmRequestPool,m={action:e,type:t,data:a,dataType:l,contentType:c,headers:i,crossDomain:r.crossDomain,success:function(e){n&&commonUtils.showHideLoadingDiv(!1),o(e)},error:function(e){if(n&&commonUtils.showHideLoadingDiv(!1),s){if(555===e.status&&"Duplicate report Name"===e.responseText){var t=I18n.getMsg("crm.label.name.already.exist");$("#reportName").focus().next().removeClass("dN").text(t).show()}s(e)}else o(e.responseJSON)}};u.initiate(m)},getUrlParamKey:function(e,t){for(var r=t?Object.keys(t):[],a="",i=r.length,n=0;n<i;n++){var o=r[n];a=a?a.concat("_"+t[o]):t[o]+""}return e+"_"+a},lyteInitiateRequest:function(e,t,r,a){if(a){var i=networkUtils.getUrlParamKey(e,r.params),n=app.reqCache[i];if(n)return n}var o=new Promise((function(a,i){(r=r||{}).success_callback=a,r.failure_callback=i,networkUtils.makeRequest(e,t,r)}));return a&&(app.reqCache[i]=o),o},parseUrl:function(e){var t=document.createElement("a");t.href=e;var r=e.indexOf("?");r<0&&(r=e.length);var a=e.substring(0,r),i=(a=a.replace(".do","")).lastIndexOf("/");a=a.substring(i+1);var n=e.substring(r+1),o={};if(0!==n.length)for(var s=(n=n.replace(t.hash,"")).split("&"),l=s.length,c=0;c<l;c++){var d=s[c].indexOf("="),u=s[c].substring(0,d);if(s[c].indexOf("#")>0)var m=s[c].substring(d+1,s[c].indexOf("#"));else m=s[c].substring(d+1);o[u]=m}return{action:a,params:o,hash:t.hash}},sendxhr:function(e,t,r,a){return new Promise((function(i,n){var o=new XMLHttpRequest;for(var s in o.open(t,e,!0),(r=r||{})["X-ZCSRF-TOKEN"]=csrfParamName+"="+csrfToken,r["X-CRM-ORG"]=crmZgid,window.clientPortalName&&(r["X-CRMPORTAL"]=window.clientPortalName),"undefined"!=typeof crmZgid&&crmZgid&&(r["X-CRM-ORG"]=crmZgid),r)o.setRequestHeader(s,r[s]);o.send(a),o.onreadystatechange=function(){if(4===o.readyState)return"2"===o.status.toString()[0]||"3"===o.status.toString()[0]?i(o):n(o)}}))},getI18nJSUrl:function(e){return"i18n/"+Crm.userDetails.jsLocation+e.toLowerCase()+"/zohocrm_"+$ESAPI.encoder().encodeForJavaScript(Crm.userDetails.LOCALE)+".js"},getQueryVariable:function(e){for(var t=window.location.search.substring(1).split("&"),r=t.length,a=0;a<r;a++){var i=t[a].split("=");if(decodeURIComponent(i[0])==e)return decodeURIComponent(i[1])}},getDomainNameFromUrl:function(e){var t=/([a-zA-Z]+):\/\/([\-\w\.]+)(?:\:(\d{0,5}))?/.exec(e);if(null!=t&&t.length>2&&"string"==typeof t[2]&&t[2].length>0){var r=t[2];return t.length>3&&"string"==typeof t[3]&&t[3].length>0&&(r=r+":"+t[3]),r}return null},getImageUrl:function(e,t){if(void 0!==Crm&&void 0!==Crm.env&&Crm.env.isDevelopment){return ResourceConstants.IMAGES[t]+"/"+e.replace(/(_[A-Za-z0-9]*_\.)/g,".")}return ResourceConstants.IMAGES[t]+"/"+e},initChart:function(){"undefined"!=typeof Highcharts&&CrmDashboard.initChart()},includeChartFiles:function(){return Crm.isZohoChartsEnabled?["zohocrm_chart.js"]:["highcharts.js"]}},thirdPartyUtils={unbindChildSelect2:function(e){var t=e.find(".select2-hidden-accessible");if(t.length)try{t.select2("destroy")}catch(e){murphy.error(e)}},unbindChildPerfectScroll:function(e){var t=e.find(".ps-container");if(t.length)try{t.perfectScrollbar("destroy")}catch(e){murphy.error(e)}},unbindHighcharts:function(e){for(var t=e.find(".highcharts-container"),r=t.length,a=0;a<r;a++)try{var i=t.eq(a).parent().highcharts();i&&i.destroy()}catch(e){murphy.error(e)}},unbindZohoCharts:function(e){for(var t=e.find(".d3container"),r=t.length,a=0;a<r;a++)try{var i=t[a].__data__;i&&i.destroy()}catch(e){murphy.error(e)}},unbindGridstack:function(e){var t=e.find(".grid-stack").data("gridstack");if(t)try{t.destroy()}catch(e){murphy.error(e)}},removeDropzoneInstances:function(){var e=FileUploader.instances.length;if(FileUploader&&e)for(;e;)try{FileUploader.instances[e-1].instance.clean(),e--}catch(t){e--,murphy.error(t)}e=Dropzone.instances.length;if(Dropzone&&e)for(var t=0;t<e;t++)try{Dropzone.instances[t].destroy()}catch(e){murphy.error(e)}},unbindAutoComplete:function(e){for(var t=e.find(".ui-autocomplete-input"),r=t.length,a=0;a<r;a++)try{t.eq(a).autocomplete("destroy")}catch(e){murphy.error(e)}},unbindFullcalendar:function(e){var t=e.find("#calendarBd");if(t.length)try{t.fullCalendar("destroy")}catch(e){murphy.error(e)}},unbindChildEvents:function(e){if(e instanceof $||(e=$(e)),0!==e.length)try{thirdPartyUtils.unbindAutoComplete(e),thirdPartyUtils.unbindChildPerfectScroll(e),thirdPartyUtils.unbindChildSelect2(e),thirdPartyUtils.unbindHighcharts(e),thirdPartyUtils.unbindZohoCharts(e),thirdPartyUtils.unbindGridstack(e),thirdPartyUtils.unbindFullcalendar(e),(e.find("[batchid]").length||e.find(".dropzone").length)&&thirdPartyUtils.removeDropzoneInstances()}catch(e){return}},unbindPerfectScroll:function(e){e&&$(e).length&&(e=$(e)).perfectScrollbar("destroy")},bindPerfectScrollUpdate:function(e){e&&$(e).length&&(e=$(e)).perfectScrollbar("update")},bindPerfectScroll:function(e,t){if(e&&$(e).length){if(e=$(e),(t=t||{}).start){var r=$(t.start).position().top;delete t.start}e.perfectScrollbar(t),r&&(e.scrollTop(r),e.perfectScrollbar("update"))}},bindLyteScroll:function(e,t){e&&$L(e).length&&(t=t||{},(e=$L(e)).scroll(t))},selectTempResult:function(e){var t=e.text,r=e.element;if(void 0!==r){var a=$(r.parentElement).data("colorcode_enabled"),i=$(r.parentElement).attr("data-picklistmap")?$(r.parentElement).attr("data-picklistmap"):$(r.parentElement).attr("data-values"),n=void 0!==i&&Crm.isValidJSON(i);if($(".select2-container").removeClass("dropdown_eventcolor"),n){var o=$(r).data("colorcode");if(o||!o&&a){var s=$(r).attr("actualvalue")?$(r).attr("actualvalue"):$(r).val(),l="-None-"===s||""===s?" colorEnabledSelect2None":"";return t="<span class='disable"+e.disabled+l+"'><span class='dIB activitesColor' data-zcqa='option_"+t+"' style='background:"+$ESAPI.encoder().encodeForHTMLAttribute(o)+"'></span><span>"+$ESAPI.encoder().encodeForHTML(e.text)+"</span></span>",$(".select2-container").addClass("dropdown_eventcolor"),t}$(".select2-container").removeClass("dropdown_eventcolor")}}return"<span class='disable"+e.disabled+"'>"+$ESAPI.encoder().encodeForHTML(t)+"</span>"},selectEmptyVal:function(e,t){var r=e.text,a=e.id;if((""===a||"-None-"===a&&!t)&&null!=t){var i=t.attr("id");$("#"+i).parents(".select2-container").parent().addClass("selectEmptyVal")}return"<span class='disable"+e.disabled+"'>"+$ESAPI.encoder().encodeForHTML(r)+"</span>"},bindSelect2:function(e,t){setTimeout((function(){if(e&&$(e).length){e=$(e),t=t||{};var r=$("#commonActionPage"),a=r.find(".pp-content"),i=t.disable_search_threshold||0,n=t.dropdownParent||"",o=t.no_results_text||I18n.getMsg("crm.label.no.options.found"),s=t.placeholder_text_multiple||t.placeholder_text_single||I18n.getMsg("crm.label.picklist.none"),l=Crm.userDetails.RTL_ENABLED?"rtl":"ltr",c=$("#commonSummary").length,d=t.maximumSelectionLength||"",u=t.maximum_result_text||I18n.getMsg("crm.chosen.maximum.option"),m=t.minimumInputLength||0===t.minimumInputLength?t.minimumInputLength:1,p=t.input_too_short_func||function(e){return I18n.getMsg("crm.chosen.minimum.input.text",e.minimum-e.input.length)},g=t.searching_text||I18n.getMsg("crm.chosen.searching.text"),h=t.error_loading_func||I18n.getMsg("crm.chosen.error.loading.text"),f=t.width_auto||"",v=t.closeOnSelect,C=e.closest(".wf_chosen_ui"),y=C.find(".sltSetVal"),E=[];e.each((function(e){E[e]=0===c?"none"!==$(this).css("display"):$(this).is(":visible")})),e.each((function(e){if(E[e]){var c={minimumResultsForSearch:i,dir:l,dropdownParent:n,maximumSelectionLength:d,language:{noResults:function(){return o},maximumSelected:function(){return u}},width:f},I=$(this).attr("multiple");I&&(c.placeholder=s);var w=$(this),T=$(this).attr("id");if(null!=T&&-1!==T.indexOf("ATTACHMENTID"))return $(this).on("focus",(function(){$(this).parent().trigger("mouseover")})),void $(this).on("blur",(function(){$(this).parent().trigger("mouseleave")}));if(t.ajax&&(c.ajax=t.ajax,c.minimumInputLength=m,null!=v&&(c.closeOnSelect=v),c.language.searching=function(){return g},c.language.errorLoading=function(){return h},c.language.inputTooShort=p),t.templateResult?c.templateResult=t.templateResult:c.templateResult=T&&"userDateFormat"===T?function(e){var t=e.element,r='<span class="color_3  crm-font-bold mR5 breakWord">';return r+=e.text,r+='</span><span class="color_6 f12 dIB">(',r+=$(t).data("desp"),r+=")</span>",$(r)}:thirdPartyUtils.selectTempResult,c.templateSelection=w.hasClass("ccPhoneNumber")?CrmPhoneNumberInput.countryCodeSelect:thirdPartyUtils.selectEmptyVal,c.matcher=renderingUtils.matchStart,c.escapeMarkup=function(e){return e},"searchcriteria0"===$(this).parent().parent().parent().parent().attr("id"))return;var b=$(this).parent().parent();if(!w.data("colorcode_enabled")&&void 0!==b&&b.hasClass("colorEnabledPicklist")&&b.removeClass("colorEnabledPicklist"),$(this).select2(c),I){var S=$(this).next(".select2").find(".select2-search__field");S.on("focus",(function(){var e=$(this).closest(".select2"),t=e.closest("td"),r=e.closest(".labelValCreate");r.length?r.addClass("focusEleField"):e.closest(".labelValTwo").length?e.closest(".tabDiv").addClass("focusEleField"):t.length&&($(".wf_setFocus").removeClass("wf_setFocus"),t.addClass("wf_setFocus"))})),S.on("blur",(function(){var e=$(this).closest(".select2"),t=e.closest("td"),r=e.closest(".labelValCreate");if(r.length)r.removeClass("focusEleField");else if(e.closest(".labelValTwo").length)e.closest(".tabDiv").removeClass("focusEleField");else if(t.length){0===$(".select2-container--open").eq(0).length&&t.removeClass("wf_setFocus")}}))}else{var _=$(this).next(".select2").find(".select2-selection");_.on("focus",(function(){var e=$(this),t=e.closest(".select2"),r=t.closest("td");e.on("keydown",(function(e){40==e.keyCode&&($(this).trigger("click"),e.preventDefault())}));var a=t.closest(".labelValCreate");a.length?($(".labelValCreate").removeClass("focusEleField"),a.addClass("focusEleField")):t.closest(".labelValTwo").length?t.closest(".tabDiv").addClass("focusEleField"):r.length&&($(".wf_setFocus").removeClass("wf_setFocus"),r.addClass("wf_setFocus")),t.closest("crm-phone-field").length>0&&(t.closest("tr.topband_dv_row").addClass("txtFldFocusedRow"),t.closest("crm-create-subformfields").length>0&&t.closest(".crm_phone_field").addClass("LyteSForm_focus")&&t.closest("lyte-tr").addClass("selectedSubformRow"))})),_.on("blur",(function(){var e=$(this),t=e.closest(".select2"),r=t.closest("td");e.off("keydown",(function(e){40==e.keyCode&&($(this).trigger("click"),e.preventDefault())}));var a=t.closest(".labelValCreate");if(a.length)$(".select2-container--open").length<=0&&a.removeClass("focusEleField");else if(t.closest(".labelValTwo").length)t.closest(".tabDiv").removeClass("focusEleField");else if(r.length){0===$(".select2-container--open").eq(0).length&&r.removeClass("wf_setFocus")}t.closest("crm-phone-field").length>0&&t.closest("crm-create-subformfields").length>0&&t.closest(".crm_phone_field").removeClass("LyteSForm_focus")&&t.closest("lyte-tr").removeClass("selectedSubformRow")}))}$(this).next("span.select2.select2-container.select2-container--default").attr("data-zcqa",$(this).attr("data-zcqa")),$(this).off("select2:opening"),$(this).on("select2:opening",(function(e){var r=$(this);if(r.data()&&r.data("colorcode_enabled")){var a=r.parent(),i=a.find(".activitesColor");""===r.val()&&i.length>0&&(i.remove(),a.parent().addClass("colorEnabledPKNone"))}if(1!==$("#analyticalPageContainer").length&&1!==$("#createDashboardPanel").length||AnalyticsChart.freezePopScroll(r),$("#commonActionPage").hasClass("showPpTop")&&$("#commonActionPage .pp-content").css("overflow","hidden"),r.hasClass("ccPhoneNumber")){var n=$L("crm-create-fields")[0];if(n&&n.component.processLayoutRules(n),!r.is(":visible"))return!1;r.data("select2").dataAdapter.query("",(function(e){r.data("select2").trigger("results:all",{data:e,query:""})}))}if(!r.hasClass("dataPopulated")&&r.hasClass("ccPhoneNumber"))return sE(e),CrmPhoneNumberInput.populatePhoneNumberCountryCodes(r),!1;if(!r.hasClass("dataPopulated")&&(r.data("values")||r.data("mapval")))return sE(e),populatePicklist(r),!1;if($(".select2-selection__rendered").height()<300){var o=$("#layout_landing_right"),s=renderingUtils.windowHeight>=$(document).height()?0:renderingUtils.getScrollBarWidthValue;$("html,#setup_new_ContentDiv").css({overflow:"hidden","margin-right":s});var l=$("#searchCreateDiv").find(".popup-model-content");l.is(":visible")&&setTimeout((function(){l.addClass("oHimp")}),200);var c=$(".mmCriteriaContainer");c.is(":visible")&&c.css({overflow:"hidden"}),o.is(":visible")&&o.addClass("oH")}setTimeout((function(){var e=$("body > .select2-container--open");e.on("click",(function(){sE(event)}));var t=$("body > .select2-container--open .select2-results").width();e.length&&e.offset().left+t>renderingUtils.windowWidth&&e.css({left:"auto",right:t+30}),$(".select2-results__option").length<10&&$(".select2-container--open").find(".select2-search--dropdown").css({height:"0px",overflow:"hidden"})}),10),t.onOpenCallback&&Lyte.registeredMixins["crm-utilities"].executeFunctionByName(t.onOpenCallback,window,r),setTimeout((function(){var e=$(".select2-container--open").eq(0);e.closest("td").addClass("wf_setFocus"),e.closest("crm-phone-field").length>0&&e.closest("crm-create-subformfields").length>0&&e.closest(".crm_phone_field").addClass("LyteSForm_focus")&&e.closest("lyte-tr").addClass("selectedSubformRow")}),50)})),t.afterOpenCallback&&$(this).off("select2:open").on("select2:open",(function(){Lyte.registeredMixins["crm-utilities"].executeFunctionByName(t.afterOpenCallback,window,$(this));var e=$(".select2-container--open").eq(0);e.closest(".labelValCreate").addClass("focusEleField"),e.closest("td").addClass("wf_setFocus")})),!1!==v&&I&&$(this).on("select2:select",(function(){$(this).select2("open")})),$(this).on("select2:close",(function(){var e=$("#layout_landing_right");$("html,#setup_new_ContentDiv").css({overflow:"","margin-right":""});var r=$("#searchCreateDiv").find(".popup-model-content");r.is(":visible")&&r.removeClass("oHimp"),$(".select2-container--open").find(".select2-search--dropdown").css({height:"",overflow:""});var a=$(".mmCriteriaContainer");a.is(":visible")&&a.css({overflow:"auto"}),e.is(":visible")&&e.removeClass("oH"),t.onCloseCallback&&t.onCloseCallback($(this))})),$(this).on("select2:closing",(function(){if(1===$("#analyticalPageContainer").length||1===$("#createDashboardPanel").length){var e=$(this);AnalyticsChart.rm_freezePopScroll(e)}var t=$(".select2-container--open"),i=t.eq(0),n=t.length,o=r,s=a;i.closest(".labelValCreate").removeClass("focusEleField"),i.closest("td").removeClass("wf_setFocus"),o.hasClass("showPpTop")&&(n>2?s.css("overflow","hidden"):s.css("overflow","auto"))})),C&&y.length>0&&y.on("click",(function(){$(this).next("select").select2("open")}))}})),$(".select2-selection__rendered").attr("title","");var I=$("#reportingSelect"),w=$("#addUserReporting");(I.length>0||w.length>0||$("#roleChangePopUp").length>0||$("#branchChangePopup").length>0)&&$("#userDD,#userReportingDD,#subUserDD").add(I).add(w).select2({templateResult:formatState,templateSelection:formatState}),e=null}}),1)},unbindSelect2:function(e){e&&$(e).length&&((e=$(e)).select2("destroy"),e.closest(".wf_chosen_ui").find(".sltSetVal").off("click"))},titleForEllipsis:function(e){$(e).off("mouseenter").on("mouseenter",(function(){var e=$(this);e.removeAttr("title"),this.offsetWidth<Math.floor(this.scrollWidth)&&this.offsetWidth!=Math.floor(this.scrollWidth)&&("INPUT"===e.prop("tagName")?e.attr("title",$.trim(e.val())):e.attr("title",$.trim(e.text())))}))},bindTableScroll:function(){var e=$("#listViewTable"),t=e.parent();thirdPartyUtils.tabContLeftPos=e.outerWidth()-t.outerWidth(),0==t.scrollLeft()&&$("#fixedRowHeader").hide(),t.scroll((function(){var e=$("#listViewTable"),t=e.parent(),r=t.scrollTop(),a=t.scrollLeft(),i=$(".fixedheadercolumn"),n=$("#fixedRowHeader"),o=$("#fixedRowHeaderTable"),s=$("#fixedHeaderTable"),l=$("#fixedHeader"),c=$("#listviewtablescroll").scrollLeft();if(Crm.userDetails.RTL_ENABLED)thirdPartyUtils.scrollLeftpos=thirdPartyUtils.scrollLeftpos+renderingUtils.windowWidth-Utils.lvLeftFilterWidth.replace("px","")+1,$(".firefox").length>0?(thirdPartyUtils.scrollLeftpos=Math.abs(c),0!=thirdPartyUtils.scrollLeftpos?(i.show(),n.show(),i.addClass("boxShadowFixedColunm"),o.css({top:-1*r}),e.addClass("ls")):(n.hide(),e.removeClass("ls"),i.removeClass("boxShadowFixedColunm")),s.css({right:-Math.abs(c)})):thirdPartyUtils.scrollLeftpos!=l.outerWidth()?(i.show(),n.show(),i.addClass("boxShadowFixedColunm"),o.css({top:-1*r}),s.css({right:-1*Math.abs(thirdPartyUtils.tabContLeftPos-Math.abs(c))}),e.addClass("ls")):(n.hide(),e.removeClass("ls"),i.removeClass("boxShadowFixedColunm"),s.css({right:-1*Math.abs(thirdPartyUtils.tabContLeftPos-Math.abs(c))})),r>0&&l.show();else if(r>0?(l.show(),s.css({left:-1*a-1})):l.hide(),a>0){i.show(),n.show(),i.addClass("boxShadowFixedColunm");var d=-1*r;o.css({top:d}),e.addClass("ls")}else n.hide(),e.removeClass("ls"),i.removeClass("boxShadowFixedColunm");var u=$("#sort_div");u.length&&"block"===u.css("display")&&u.hide()}))},select2HandleBackspace:function(){$.fn.select2.amd.require(["select2/selection/search"],(function(e){if(this.$element&&this.$element.data("removeElement"))this.trigger("unselect",{data:arguments[1]});else{var t=e.prototype.searchRemoveChoice;e.prototype.searchRemoveChoice=function(){t.apply(this,arguments),this.$search.val(""),this.handleSearch()}}}))},removeSelect2Hover:function(e,t){$(t).closest(".select2-results").find("li").removeClass("select2-results__option--highlighted")},closeSelect2:function(e){e&&$("#"+e).select2("close")}},renderingUtils={fieldsJSONArray:[]};$(document).ready((function(){renderingUtils.windowHeight=$(window).height(),renderingUtils.windowWidth=$(window).width(),renderingUtils.windowOuterHeight=$(window).outerHeight(),renderingUtils.windowOuterWidth=$(window).outerWidth()})),renderingUtils.getTargetElem=function(e){return e?e.target||e.srcElement:void 0},renderingUtils.positionArrow=function(e,t,r,a,i){var n=window.innerWidth?window.innerWidth:document.body.clientWidth,o=window.innerHeight?window.innerHeight:document.body.clientHeight,s=$("#"+t),l=s.outerWidth(),c=i.mouseclientY,d=i.mouseclientX,u=i.mousepageY,m=i.mousepageX,p=o-c,g=0,h=0,f="arrwLeft",v=s.outerHeight(),C=$("#eventViewPopup");if(n-d-15>l?(g="wid_calCreate_opts_menu"==t?p>v+40?u-60:u-(v-p+150):p>v?u-30:u-(v-p+25),h=m+20,f="arrwRight"):(h=m-s.outerWidth()-20,g="wid_calCreate_opts_menu"==t?p>v+40?u-60:u-(v-p+150):p>v?u-30:u-(v-p+25),f="arrwLeft"),g=g<0?0:g,h=h<0?0:h,s.css({top:g,left:h}),"qcpopuparrow"===(a=a||"posArrow")){var y=$("."+a);y.removeClass("qcRight"),$(".etTrendsWrapper").length||y.attr({class:f}).css({left:"",top:u-g-8})}else $("#"+a).attr({class:f}).css({left:"",top:u-g-8});C.hide(),s.show();var E=$(e).parent();(E.hasClass("eventActionsMenu")||E.hasClass("quickCreateLink"))&&($(".eventActionsMenu a, .quickCreateLink a").removeClass("quickCreateLinkAct"),$(e).addClass("quickCreateLinkAct"))},renderingUtils.triggerEvent=function(e,t){t[0]&&(t[0][e]?t[0][e]():t.eq(0).trigger(e))},renderingUtils.sectionSorting=function(){var e=!1,t=$(".connectedSortable");t.multiselectable({selectedClass:"selectedElem",cancel:".nosort",mousedown:function(e,t){"searchField"===document.activeElement.id&&$("#searchField").blur(),t.hasClass("nosort")&&t.removeClass("selectedElem")}}),t.multisortable({selectedClass:"selectedElem",cancel:".nosort",start:function(t,r){var a=$(r.item).parent().attr("id");$("#"+("availableList"===a?"selectedColumns":"availableList")).children(".selectedElem").removeClass("selectedElem");var i=$(".selectedElem"),n=i.first(),o=document.createElement("span");$(o).addClass("multiMove"),n.append(o),"availableList"===n.parent().attr("id")?n.children(".addArrw").hide():n.children(".lArrowIcon").hide(),i.addClass("cvSelected"),e=!1},beforeStop:function(t,r){var a=t.target.getAttribute("data-cid"),i=r.placeholder.parents("li").eq(0),n=i.attr("data-cid")?i.attr("data-cid"):r.placeholder[0].parentNode.getAttribute("data-cid"),o=$(".cvSelected");if("availableList"===a&&"availableList"===n)o.children(".multiMove").remove(),o.children("#add").hide(),o.filter(".selectedElem").removeClass("cvSelected").removeClass("selectedElem"),o.stop(!0,!0).animate({backgroundColor:"#fff3ad"}),o.stop(!0,!0).animate({backgroundColor:"white"},{duration:500,complete:function(){o.attr("style","margin-left: 11px; margin-right: 11px;")}}),e=!0;else if("selectedColumns"===a&&"availableList"===n){var s;$("#noRecords:visible").length>0&&renderingUtils.emptySearchBox(),o.removeClass("selectedElem").css({position:"",left:"",top:""}),o.children(".multiMove").remove();var l=$("li.noFields"),c=$("#selectedColumns"),d=$("#availableList"),u=d.find("li");$.each(o,(function(e){var t=$(o[e]);t.removeClass("selectedElem"),t.attr("mandatory")&&t.removeClass("cvSelected multiselectable-previous pR"),t.css({position:"",left:"",top:""});var r=t.children(".multiMove");if(r&&r.remove(),t.attr("mandatory"))c.prepend(t);else{l.length>0&&l.remove();var a=t.children(".SelectedElement").text();renderingUtils.fieldsJSONArray.push(a),renderingUtils.fieldsJSONArray.sort();var i=renderingUtils.fieldsJSONArray.indexOf(a);0!==i?u.eq(i-1).after(t):d.prepend(t[0]),t.children("#remove").hide(),s=t,t.attr("style","margin-left : 11px; margin-right : 11px;")}commonUtils.addToMandatory()})),s&&$(".availableCol").scrollTo(s)}else"availableList"===a&&"selectedColumns"===n&&($.each(o,(function(e){var t=$(o[e]).children().find(".selectionClass");t.length>0&&$.each(t,(function(e){var r=$(t[e]),a=r.text();r.replaceWith(a)}))})),commonUtils.removeFromMandatory());o.stop(!0,!0).animate({backgroundColor:"#fff3ad"}),o.stop(!0,!0).animate({backgroundColor:"white"},500)},update:function(){!0===e&&$(this).sortable("cancel")},stop:function(e,t){var r=e.target.getAttribute("data-cid"),a=$(".cvSelected"),i=!1,n=$(t.item),o=$("#availableList");if(n.hasClass("selectedElem")&&(n.removeClass("selectedElem"),"selectedColumns"===r&&(i=!0)),a.removeClass("cvSelected selectedElem").children(".multiMove").remove(),a.children("#remove").hide(),a.children("#add").hide(),0===o.children("li").length){var s=document.createElement("li");s.setAttribute("class","nosort noFields"),$(s).html(I18n.getMsg("crm.customview.nofields")),o.append(s)}a.stop(!0,!0).animate({backgroundColor:"#fff3ad"}),a.stop(!0,!0).animate({backgroundColor:"white"},1e3),i||a.removeClass("multiselectable-previous multiselectable-shift")},receive:function(e,t){var r=e.target.getAttribute("data-cid"),a=$("li.noFields"),i=$("#availableList"),n=$(t.item);if("selectedColumns"===r&&$("#selectedColumns").find("li.sorl:not(.cvSelected)").length>=Search.MAX_COL_CNT){$(t.sender).sortable("cancel"),a.length>0&&a.remove();var o=n.children(".SelectedElement").text();renderingUtils.fieldsJSONArray.push(o),renderingUtils.fieldsJSONArray.sort();var s=renderingUtils.fieldsJSONArray.indexOf(o);0!==s?i.find("li").eq(s-1).after(n):i.prepend(t.item),n.children("#remove").hide(),n.attr("style","margin-left : 11px; margin-right : 11px;")}}}),t.sortable({connectWith:".connectedSortable",cancel:".nosort"})},renderingUtils.showCustomConfirmMessageNewModel=function(e,t,r){var a=$("#customConfirmationPop");a.find(".confirmWarning").html(e);var i=a.find(".confirmBtn").val(t.val),n=a.find(".cancelBtn").val(r.val);$("#diNotificationDiv").css("z-index",20);var o=function(e,t){e.fn&&e.fn(),$("#diNotificationDiv").css("z-index",""),renderingUtils.stopEvent(t);var r=$("#customConfirmationPop");hideAnimatePopup(r.attr("id")),setTimeout((function(){var e=r.find("[data-zcqa='confirm_cancelbtn']"),t=r.find("[data-zcqa='confirm_deletebtn']");e.attr("class","newgraybtn cancelBtn"),t.attr("class","primarybtn confirmBtn"),r.removeClass("bpLicenseErr")}),500)};i.off("click").click((function(e){o(t,e)})),n.off("click").click((function(e){o(r,e)})),showAnimatePopup(a.attr("id"))},renderingUtils.showCustomConfirmMessage=function(e,t,r){if($("#"+e).remove(),0===$("#"+e).length){var a=$("#confirmMsg1")[0].cloneNode(!0);a.id=e;for(var i=t.length,n=0;n<i;n++)$(a).find("#confirmMessage"+n).html(t[n]);i=r.length;for(n=0;n<i;n++)$(a).find("#confirmButton"+n).val(r[n].val),r[n].fn&&$(a).find("#confirmButton"+n).click(r[n].fn);$(a).addClass("w100p"),document.body.appendChild(a)}else a=$("#"+e)[0];return renderingUtils.positionCenter(e),a},renderingUtils.positionCenter=function(e){var t=document.documentElement.scrollTop||document.body.scrollTop,r=document.documentElement.scrollLeft||document.body.scrollLeft,a=$("#"+e);if(renderingUtils.windowHeight>a.height())a.css({display:"block",position:"absolute",left:"50%",top:"50%","margin-left":-a.width()/2+r,"margin-top":-a.height()/2+t});else{var i=t+10;a.css({display:"block",position:"absolute",left:"50%",top:i,"margin-left":-a.width()/2+r,"margin-top":"0px"})}$(".eventPop").hasClass("ziaForEmailsCheck")&&a.css("z-index","316")},renderingUtils.constructList=function(e,t,r){var a=$("<div>",{style:"z-index:1000;#padding-right:20px;display:none"}),i=$("<ul>",{class:"timeList"});a.append(i);for(var n=e.length,o=0;o<n;o++){var s=e[o],l=$("<li>");if(i.append(l),r&&l.click((function(){r(this),a.hide()})),s.length)for(var c=s.length,d=0;d<c;d++)l.append(renderingUtils.createHTML(s[d]));else l.append(renderingUtils.createHTML(s));t&&t(l)}return a[0]},renderingUtils.stopEvent=function(e){if(!e)e=window.event;"yes"!=$("#isCFS").val()&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())},renderingUtils.bindEventForCreateHTML=function(e){var t=[],r=$(this);r.data("args_"+e.type)&&(t=t.concat(r.data("args_"+e.type)));var a=r.data("fn_"+e.type);"function"==typeof a?(t.unshift(e,this),a.apply(window,t)):(t.unshift(a,window,e,this),Lyte.registeredMixins["crm-utilities"].executeFunctionByName.apply("Utils",t))},renderingUtils.createHTML=function(e){e.length||(e=[e]);for(var t=document.createDocumentFragment(),r=e.length,a=0;a<r;a++){var i=e[a];if("text"!==i.name)var n=document.createElement(i.name);else{var o=i.content?i.content:i.html?i.html:i.textContent?i.textContent:"";n=document.createTextNode(o)}for(var s in i)/events|child|name|content|textContent/.test(s)||$(n)[s](i[s]);var l=i.events;if(l)for(var c=l.length,d=0;d<c;d++){var u=l[d],m=u.name,p=$(n);p.data("args_"+m,u.args),p.data("fn_"+m,u.fn),p[m](renderingUtils.bindEventForCreateHTML)}if(i.child){var g=i.child;for(c=g.length,d=0;d<c;d++)n.appendChild(this.createHTML(g[d]))}if(1===e.length)return n;t.appendChild(n)}return t},renderingUtils.setTooltip=function(e,t){var r=commonUtils.calculateAcceptableCharCount(e,t),a=t;t.length>r&&(t=t.substring(0,r-1)+"..."),$(e).empty(),e.innerHTML=revertSplChrs(t),e.title=a},renderingUtils.createSelectBox=function(e,t,r,a){var i=document.createElement("select");if($(i).addClass("select"),a&&$(i).attr(a),t&&$(i).attr("multiple","multiple"),"function"==typeof e)for(var n=0;;){var o=document.createElement("option"),s=e(n);if(!s)break;var l=s.content?s.content:s.html,c=s.value?s.value:l;$(o).html(l).val(c),"true"===s.defaultVal&&$(o).prop("selected",!0),i.appendChild(o),n++}else{n=0;for(var d=e.length;n<d;n++){o=document.createElement("option");var u=$(o);if("object"==typeof e[n]){e[n].attr&&u.attr(e[n].attr),"true"===e[n].default&&u.prop("selected",!0);l=e[n].content?e[n].content:e[n].html,c=e[n].value?e[n].value:l;u.html(l).val(c)}else u.html(I18n.getMsg(e[n])).val(e[n]);i.appendChild(o)}}return r&&$(i).change((function(){var e=this.getSelectedNode(this);r(e)})),i},renderingUtils.targetElement=function(e){return e?e.target?e.target:e.srcElement:void 0},renderingUtils.ShakeDivInfreeze=function(e,t,r,a,i){i=i||$("#FreezeLayer");var n=$("#sdiv"),o=n.is(":visible");i&&(i.click((function(){var a=$("#"+e),i=$(window);!QuickActionSelObj&&(i.scrollTop()+renderingUtils.windowHeight-parseInt(a.css("top"))<0||i.scrollTop()-(parseInt(a.css("top"))+parseInt(a.height()))>0)?$.scrollTo("#"+e,{axis:"y",duration:1e3,offset:-80,onAfter:function(){renderingUtils.shakeAnimation(e,t,r)}}):renderingUtils.shakeAnimation(e,t,r)})),o&&n.hide(),$(".dItimesdiv").length&&($(".dItimesdiv #sdiv").hide(),$(".bestTimeListFilter").hide(),$(".tA").removeClass("tA"),crmBstTime.hideBestTimeSuggestion("QuickCreateTask")))},renderingUtils.shakeAnimation=function(e,t,r){for(var a=r,i=document.getElementById(e),n=$("#sdiv"),o=n.is(":visible"),s=0;s<4;s++)switch(a=parseInt(-1*a),t){case"left":if(-1!==i.style.left.indexOf("%")){var l=parseInt(a/10);$("#"+e).animate({left:"+="+l+"%"},100)}else $("#"+e).animate({left:"+="+a},100);break;case"right":if(-1!==i.style.right.indexOf("%")){l=parseInt(a/10);$("#"+e).animate({right:"+="+l+"%"},100)}else $("#"+e).animate({right:"+="+a},100);break;case"up":$("#"+e).animate({top:"+="+a},100)}o&&n.hide(),$(".dItimesdiv").length&&(n.hide(),$(".bestTimeListFilter").hide(),$(".tA").removeClass("tA"),crmBstTime.hideBestTimeSuggestion("QuickCreateTask"))},renderingUtils.handleDummyLayer=function(e,t){var r=$("#Calendar");e?(hideMenu(event),renderingUtils.removeDummyBackground()):r.is(":visible")||renderingUtils.shakeAnimation(t,"left",30),$("#gotoDateContDiv").is(":visible")&&r.is(":visible")&&r.hide()},renderingUtils.dummyBackground=function(e,t){var r=$("#emptyLayer");if(r[0])return!0;var a=$(window).scrollTop(),i=renderingUtils.windowHeight,n=renderingUtils.windowWidth;document.documentElement.style.overflow="hidden";var o=document.createElement("DIV");o.id="emptyLayer",o.className="emptyLayer",o.onclick=function(){renderingUtils.handleDummyLayer(e,t)},$(o).css({width:n,height:i,top:a}).appendTo("body"),!Crm.isHeadless&&crmNTC.isSignalDetailViewVisible()&&(r.css({"z-index":32}),$(".temp_freezelayer").length>0?$("#duplicateEventMsg").css({"z-index":34}):$("#duplicateEventMsg").css({"z-index":33})),$("#saveEventsBtn").attr("disabled","disabled")},renderingUtils.removeDummyBackground=function(){var e=$("#emptyLayer");$("#saveEventsBtn").removeAttr("disabled"),e.remove(),$("#FreezeLayer")[0]||(document.documentElement.style.overflow=""),e.css({"z-index":""}),$("#duplicateEventMsg").css({"z-index":""})},renderingUtils.setEndToInputBox=function(e){(e=$(e).get(0)).focus();var t=e.value.length;e.setSelectionRange(t,t)},renderingUtils.displayErrorDiv=function(e,t,r,a){var i=$("#bulkUpdateFldsListForScheduler").is(":visible"),n=$(".depField").is(":visible"),o=$("#sIlookupFieldAddNew").is(":visible")||Crm.isFromSalesInbox,s="displayContent_"+e,l=$("[id='"+s+"']").length>0?document.getElementById(s):document.createElement("div");l.id=s,l.className="form_err_msg";var c=$("#quickConfig"),d=$("#imap_config_page"),u=c.length>0&&"true"===c.val(),m=d.length>0&&"true"===d.val();if(a&&0!==$(a).length||(a=getObj(e)),i&&!n&&!o){var p=$("#error_status_alert");return p.text(I18n.getValueForFields(r,t)),p.removeClass("dN").addClass("top30").show(),!1}if(u||m?($(a).closest(".tabDivCreate").addClass("errorFieldP"),l.className="validateConfiguration form_err_msg",l.style.height="5%"):l.style.height="10%",!m&&!u||"displayContent_imapPort"!==l.id&&"displayContent_smtp_port"!==l.id||(l.style.cssText="left:"+parseInt($("#"+e+"_cont").position().left)+"px !important",l.style.bottom="-17px"),m&&"displayContent_imapServer"===l.id&&(l.style.top="25px"),"displayContent_appCmntsArea"===l.id&&(l.style.top="200px"),$(l).empty(),l.innerHTML=I18n.getValueForFields(r,t),"displayContent_days"===l.id&&(l.style.left=$("#ruleName").outerWidth()+$("#sign").outerWidth()+"px"),"displayContent_predictionCreationName"!==l.id&&"displayContent_recNameContri"!==l.id||($(a).parent().append(l),$(a).find("input").focus(),$(a).addClass("errorFieldP specialCharExcep"),$("#displayContent_predictionCreationName").show()),"displayContent_similarityCreationName"===l.id){$(a).parent().append(l);var g=$("#displayContent_similarityCreationName");g.css("top","130%"),g.parents(".similarityValidation").addClass("mB25")}$(a).addClass("err_fld"),"displayContent_imapServer"===l.id||"displayContent_smtp_server"===l.id||"displayContent_smtp_emails"===l.id||"displayContent_roleName"===l.id||"displayContent_reportsTo"===l.id||"displayContent_taskSubject"===l.id||"displayContent_days"===l.id||"displayContent_assignTo"===l.id?$(a).parent().append(l):"displayContent_sharingSrc_G"===l.id||"displayContent_sharingTo_G"===l.id||"displayContent_sharingSrc_R"===l.id||"displayContent_sharingTo_R"===l.id||"displayContent_emailTemplateId"===l.id||"displayContent_fieldOption1"===l.id||"displayContent_fieldValue1"===l.id?("displayContent_fieldValue1"===l.id&&(l.style.left=$("#fieldOption1").outerWidth()+"px"),$(a).closest("td").append(l),$(a).closest(".newSelect,.wf_chosen_ui"),$(a).parent().css("display","inline-block")):"displayContent_WFDateFieldsdd"===l.id||"displayContent_ruleName"===l.id?($(a).closest("tr").addClass("form_err_fld"),$(a).parent().append(l)):-1!==e.indexOf("noOfUnits")?$(a).closest(".wf_form_row").append(l):"WFTriggerFieldId0"===e?"SameFieldName"===t?$("#WFTriggerFieldsDIV").find(".noWrap").eq(0).append(l):($("#WFTriggerFieldsDIV").find(".noWrap").eq(0).append(l),$("#displayContent_"+e).css({position:"static",display:""})):"displayContent_appname"===l.id?($(a).closest("tr,.tabDivCreate").addClass("form_err_fld"),$("#authsubmit").after(l)):"displayContent_selectedProfileIds"===l.id?$(a).next(".newSelect,.wf_chosen_ui").prepend(l):"SELECT"===$(a).prop("tagName")?$(a).closest(".newSelect,.wf_chosen_ui").after(l):$(a).after(l),"ruleName"===e||"ruleDesc_inp"===e||"WFDateFieldsdd"===e||"showOnDateTime"===e||-1!==e.indexOf("noOfUnits")||"WFTriggerFieldId0"===e&&"SameFieldName"===t?$("#displayContent_"+e).css({position:"static",display:""}):$(a).closest("tr").addClass("form_err_fld"),e.indexOf("modOpt")>=0&&$("#wfDelugeEditorDIV").length>0&&$("#displayContent_"+e).css({position:"relative"}),"pb_transitionName"===e&&$("#displayContent_"+e).css({position:"relative"}),$(a).parent().hasClass("newSelect")&&$(l).addClass("alter_err_pos"),$(a).parent().hasClass("wf_chosen_ui")&&$(l).addClass("alter_err_pos"),"relatedField_Stage"!==t&&"relatedField_Pipeline"!==t||$("#"+t).addClass("form_err_fld")},renderingUtils.displayAlert=function(e,t,r,a,i){"inline"===i?renderingUtils.displayErrorDiv(e,t,r,a):"custom"===i?setTimeout((function(){renderingUtils.showCustomAlert(r)}),70):renderingUtils.showCustomAlert(r)},renderingUtils.displayPermissionDenied=function(e,t,r,a,i,n,o){var s,l=Lyte.Router.getRouteInstance().transition;i=null==i&&!0;if(200!==l.state&&app.prevTransition.route&&app.prevTransition.route.indexOf("crm.tab.module")>-1)for(var c=app.listViewLinkedRoutes.length,d=0;d<c;d++)if(l.info.route.indexOf(app.listViewLinkedRoutes[d])>-1){-1==l.info.route.indexOf("crm.settings.section")&&(crmHistory.doNotReload=!0),crmHistory.handleAjaxErrorLyte=!0;break}if(void 0!==e)try{r=$(e.responseText).filter("#errorMsg").html()}catch(e){murphy.error(e)}commonUtils.showHideLoadingDiv(),r&&I18n.getMsg("error.database.problem")===r&&(r=I18n.getMsg("error.database.problem"),s=I18n.getMsg("error.unknown.problem"),i=!1);var u=$L("crux-permission-denied-alert")[0];u&&(u.eventLis&&Lyte.removeEventListener(u.eventLis),u.remove());var m={cxPropReason:r,cxPropTitle:s,cxPropIcon:i,cxPropZindex:a};if(o)for(var p in o)m[p]=o[p];var g=Lyte.Component.render("crux-permission-denied-alert",m,"body");if(g.setMethods({onShow:function(){t&&t.call(this.$node)},onAccept:function(){renderingUtils.ajaxErrorBackForLyte()},onClose:function(){var e=$L("crux-permission-denied-alert")[0];e&&(e.eventLis&&Lyte.removeEventListener(e.eventLis),e.remove(),n&&n.call(this.$node)),$L("#FreezeLayer")[0]&&renderingUtils.removeFreezeLayerPD()}}),g.setData("cxPropShow",!0),g.eventLis=Lyte.addEventListener("beforeRouteTransition",(function(e){var t=$L("crux-permission-denied-alert")[0];if(t&&t.getData("cxPropShow")){if(e&&e.history&&e.history.fromHistory&&e.prevTrans&&["crm.tab.module.custom-view.list","crm.tab.module.custom-view.zia","crm.tab.module.custom-view.kanban","crm.tab.module.custom-view.canvas"].contains(e.prevTrans.target))return void t.setData("cxPropShow",!1);var r=!($L(".commonRightPanel").length||!Lyte.Router.getRouteInstance())&&Lyte.Router.getRouteInstance().transition.preservePopup,a=document.getElementById("iskanbanview");r||a&&"true"===a.value||t.setData("cxPropShow",!1)}})),$L("#Warningdiv").hide(),$L("#appointmentCreate").is(":visible")||$L("#serviceAjaxEdit").is(":visible")||$L("#appointmentRescheduleDiv").is(":visible")||$L("#appointmentCancelDiv").is(":visible")||$L("#appointmentCompletePopup").is(":visible")?$L("#freezeBackGround").show():$L("#freezeBackGround").hide(),$L("#topBandPopup:visible").length||$L("#layoutPreview:visible").length){var h=$L("#FreezeLayer")[0];h&&(h.style.zIndex="250")}},renderingUtils.removeFreezeLayerPD=function(){if($L("#topBandPopup").is(":visible")||$L("#appointmentCreate").is(":visible")||$L("#serviceAjaxEdit").is(":visible")||$L("#appointmentRescheduleDiv").is(":visible")||$L("#appointmentCancelDiv").is(":visible")||$L("#appointmentCompletePopup").is(":visible")){if($L("#freezeBackGround").hide(),$L("#topBandPopup:visible").length){var e=$L("#FreezeLayer")[0];e&&(e.style.zIndex="")}}else removeFreezeLayer()},renderingUtils.ajaxErrorBackForLyte=function(){!Lyte.Router.getRouteInstance().transition.preservePopup&&crmHistory.loaded&&crmHistory.handleAjaxErrorLyte&&(crmHistory.handleAjaxErrorLyte=!1,Lyte.Router.getRouteInstance().transition.abort(),!app.prevTransition.route||app.historyLength<=1?Lyte.Router.getRouteInstance().replaceWith("crm.tab.module.begin","Home"):history.go(-1)),$("#popupnew").removeClass("mxnPermDeniedCheck")},renderingUtils.popUpWithFreeze=function(e){var t=e,r=$("#popupnew");r.html(t).css("z-index","250"),mailsetCenter("popupnew"),$("#Warningdiv").hide(),freezeBackground(),commonUtils.showHideLoadingDiv(),$("#popupok").length>0&&document.getElementById("popupok").focus(),r.click((function(){sE(event)}))},renderingUtils.getHeightFromTabLayer=function(){var e=renderingUtils.windowHeight-$("#tabLayer:visible").outerHeight();isChatEnabled&&(e-=26);var t=$("#annoncement");return e=t.length?e-t.outerHeight():e},renderingUtils.matchStart=function(e,t){if(t.parentText=t.parentText||"",""===$.trim(e.term))return t;var r=t.children;if(r&&r.length>0){for(var a=$.extend(!0,{},t),i=a.children,n=r.length-1;n>=0;n--){var o=r[n];o.parentText+=t.parentText+" "+t.text,null==renderingUtils.matchStart(e,o)&&i.splice(n,1)}return i.length>0?a:renderingUtils.matchStart(e,a)}var s=(t.parentText+" "+t.text).toUpperCase(),l=e.term.toUpperCase();return s.indexOf(l)>-1?t:null},renderingUtils.getScrollBarWidth=function(){var e=document.createElement("p");e.style.width="100%",e.style.height="200px";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),document.body.appendChild(t);var r=e.offsetWidth;t.style.overflow="scroll";var a=e.offsetWidth;r==a&&(a=t.clientWidth),document.body.removeChild(t),renderingUtils.getScrollBarWidthValue=r-a},$(document).ready((function(){renderingUtils.getScrollBarWidth()})),renderingUtils.resizeWindowHW=function(){renderingUtils.windowHeight=$(window).height(),renderingUtils.windowWidth=$(window).width(),renderingUtils.windowOuterHeight=$(window).outerHeight(),renderingUtils.windowOuterWidth=$(window).outerWidth()},renderingUtils.listviewFixedColumn=function(){var e=["list","users","list-view"].contains(Lyte.Router.getRouteInstance().routeName),t=renderingUtils.windowOuterHeight;if(e){var r=$(".cvpadding");renderingUtils.listviewTable=r.offset().top+r.outerHeight()}else{var a=$("#cvpadding");renderingUtils.listviewTable=a.offset().top+a.outerHeight();var i=$(".fixedheadercolumn")}renderingUtils.listviewTableHeightVal=t-(renderingUtils.listviewTable+88),getElemById("listviewtablescroll").style.maxHeight=renderingUtils.listviewTableHeightVal+"px";var n=$("#listviewtablescroll").height(),o=41;if($(".mac.chrome,.mac.safari,.safari").length>0&&(o=42),!e){var s=getElemById("fixedRowHeader");s.style.left=renderingUtils.lvLeftFilterWidth+"px",s.style.top=renderingUtils.listviewTable+o+"px",s.style.height=n-44+"px"}"undefined"!=typeof CrmPlusImpl&&CrmPlusImpl.isLoadedInCrmplus()?i.css({left:renderingUtils.lvLeftFilterWidth,top:renderingUtils.listviewTable}):e||i.css({left:renderingUtils.lvLeftFilterWidth,top:renderingUtils.listviewTable})},renderingUtils.listviewFixedColumnRTL=function(){var e=renderingUtils.windowOuterHeight,t=$("#fixedRowHeader"),r=$("#cvpadding");renderingUtils.listviewTable=r.offset().top+r.outerHeight(),renderingUtils.listviewTableHeightVal=e-(renderingUtils.listviewTable+88);var a=$("#listviewtablescroll"),i=$(".fixedheadercolumn");$("#fixedheadercolumn").outerHeight();renderingUtils.fixedRowHeaderTableTD=$("#fixedRowHeaderTable > .tr > .td").height(),a.css({"max-height":renderingUtils.listviewTableHeightVal});var n=42;$(".chrome,.safari").length>0?$(".fixedrowTd").find("td").css("display","inline-table"):n=42,t.css({top:renderingUtils.listviewTable+n,height:a.height()-44}),i.css({top:renderingUtils.listviewTable})},renderingUtils.listviewCustomizationtable=function(){var e=$("#canvasview-tablescroll"),t=$("#bottomTotalCountBar").outerHeight();if(e.length){var r=e.offset().top,a=renderingUtils.windowOuterHeight;renderingUtils.listviewTable=r+t+28,renderingUtils.listviewTableHeightVal=a-renderingUtils.listviewTable,e.css({"max-height":renderingUtils.listviewTableHeightVal})}},renderingUtils.listviewFixedTable=function(){var e=$("#listviewtablescroll"),t=e.scrollLeft(),r=$("#fixedHeaderTable"),a=r.css("right"),i=$("#lvTred .LVFirstCol"),n=$("#lvTred .LVSecondCol"),o=0===i.length?void 0:i.eq(0).outerWidth(),s=0===n.length?void 0:n.eq(0).outerWidth(),l=$("#listviewHeaderRow").height(),c=$("#fixedHeader"),d=c.outerWidth(),u=c.height(),m=$("#fixedRowHeader");if($("body").css("overflow",""),$(".listviewtablescroll").length){renderingUtils.lvLeftFilterWidth=customViewObject.isPrivacyListView||customViewObject.isCampaignAddMemberListView?"260px":"0px";var p=document.getElementById("lv_left_filter").style.display;"block"!==p&&""!==p||(renderingUtils.lvLeftFilterWidth=customViewObject.isPrivacyListView||customViewObject.isCampaignAddMemberListView?"560px":"300px");var g=$(".fixedheadercolumn");if(g.show(),c.hide(),0===$("#lvNoRecordsFound").length){Crm.userDetails.RTL_ENABLED?(renderingUtils.listviewFixedColumnRTL(),r.css("right","-"+a+"px")):(renderingUtils.listviewFixedColumn(),r.css("left","-"+t+"px")),c.show(),renderingUtils.generateColumnHeader(),getElemById("fixedRowHeader").style.width=o+s+"px";var h=o+s;g.css("width",h),$(".LVFirstFixedHeaderCol").css("width",o),$(".LVSecondFixedHeaderCol").css("width",s),m.removeClass("fixedRowHeaderHide"),renderingUtils.setRowH(o),renderingUtils.setColW(),renderingUtils.setColumnHeaderPosition(),thirdPartyUtils.bindTableScroll(),renderingUtils.fixedRowHeaderWheelBind(),renderingUtils.freezeBody(),Crm.userDetails.RTL_ENABLED?(t=10,thirdPartyUtils.scrollLeftpos!=d&&g.show()):t>0&&m.show(),Crm.userDetails.RTL_ENABLED&&(l=u-1,l-=20),$("#fixedheadercolumn").find("td").css("height",l),c.find("td").css("height",l-2)}else renderingUtils.lvLeftFilterWidth=0,"block"!==p&&""!==p||(renderingUtils.lvLeftFilterWidth="300px"),Crm.userDetails.RTL_ENABLED?renderingUtils.listviewFixedColumnRTL():renderingUtils.listviewFixedColumn(),m.addClass("fixedRowHeaderHide"),g.hide(),Crm.userDetails.RTL_ENABLED||e.scrollLeft(0);e.scrollTop(0)}},renderingUtils.tableSorter=function(){var e=Lyte.Router.getRouteInstance().routeName;1==customViewObject.isCustomizedView?renderingUtils.listviewCustomizationtable():"list"!==e&&renderingUtils.listviewFixedTable()},renderingUtils.generateColumnHeader=function(){var e,t=$("#listViewTable").find("#listviewHeaderRow td"),r=$("#fixedHeader .tr"),a=document.createDocumentFragment();r.empty();for(var i=0;i<t.length;i++)(e=$(t[i]).clone()).removeClass("th").addClass("td fixedHeaderTd"),$(a).append(e);r.append(a)},renderingUtils.setRowH=function(e){for(var t=$("#lvTred").find("tr"),r=$(".fixedrowTd").find("tr"),a=[],i=[],n=t.length,o=0;o<n;o++){var s=t.eq(o);a[o]={},a[o].height=s[0].getBoundingClientRect().height,a[o].maxHeight=s.outerHeight(),i[o]={};var l=r.eq(o);i[o].dom=l,i[o].td=l.find("td"),i[o].LVFirstFixedCol=l.find(".LVFirstFixedCol > div")}for(o=0;o<n;o++)i[o].dom.css({"max-height":a[o].maxHeight,height:a[o].height}),i[o].td.css({height:a[o].height-23}),i[o].LVFirstFixedCol.css({width:e-13})},renderingUtils.setColW=function(){var e=$("#fixedHeader").find("td"),t=[],r=$("#listviewHeaderRow").find("td"),a=e.length;if(Crm.userDetails.RTL_ENABLED){a=e.length;for(var i=0;i<a;i++)t[i]=r.eq(i).width()-10}else for(i=0;i<a;i++)t[i]=r.eq(i).width();var n=document.getElementsByClassName("fixedHeaderTd");for(i=0;i<a;i++)n[i].style.minWidth=t[i]+"px",n[i].style.maxWidth=t[i]+"px"},renderingUtils.setColumnHeaderPosition=function(){if($("#listviewtablescroll").length){var e=$("#fixedHeader"),t=$("#listViewTable"),r=t.parent().offset(),a=r.left,i=r.top;0==a&&(a=2);var n=t.width();Crm.userDetails.RTL_ENABLED?e.css({top:i,width:n}):e.css({top:i,left:a+1,width:n})}},renderingUtils.freezeBody=function(){var e=$("#fixedRowHeaderTable");$("html").hasClass("firefox")||(e.on("mouseover",(function(){$("body").css({overflow:"hidden"})})),e.on("mouseout",(function(){$("body").css({overflow:""})})))},renderingUtils.fixedRowHeaderWheelBind=function(){var e=$("#fixedRowHeader"),t=$("#fixedRowHeaderTable").height();e.show();var r=renderingUtils.listviewTableHeightVal-44;e.hide();var a=-1*t+r;e.off("wheel"),a<0&&e.on("wheel",(function(e){var t=$("#fixedRowHeaderTable"),r=$("#listviewtablescroll");e.stopPropagation();var i=t.position().top-e.originalEvent.deltaY;i>0?i=0:i<a&&(i=a),t.css({top:i}),r.scrollTop(-1*i)}))},renderingUtils.scrollPrevent=function(e){$(e).on("wheel",(function(t){if($(e).width()<$(e).closest(".zcrm-modal").width()){var r=t.originalEvent,a=r.wheelDelta||-r.detail;this.scrollTop+=10*(a<0?1:-1),t.preventDefault()}}))},renderingUtils.showCustomAlert=function(e,t,r,a,i,n){var o=$("#custom_alert_popup");o.attr("data-show",!0),r?$("#custom_alert_msg").html(e):$("#custom_alert_msg").text(e),t?$("#alert_title").text(t).show():$("#alert_title").hide(),showAnimatePopup("custom_alert_popup");var s=$("#custom_alert_button");s.val(n||I18n.getMsg("crm.nsocial.onboard.got.it")),setTimeout((function(){o.removeAttr("data-show");var e=$("#custom_alert_button");e.length>0&&e.eq(0).focus()}),100),$("#custom_alert_button").unbind("click"),a?i?s.unbind("click").click({params:i},a):s.unbind("click").click(a):o.attr("data-show")||a&&a()},renderingUtils.saveValtoopt=function(e,t,r){var a=$($("#"+e).html());a.eq(0).attr("data-value",r),""!==t?(a.eq(0).attr("value",t),a.eq(0).show()):a.eq(0).hide();var i=$("<div>").append(a[0]).html()+"<div class='selectOpt dIB vam' onmouseenter='$(this).parent(&#39;.selectBoxInput&#39;).css(&#39;border&#39;,&#39;1px solid #ddd&#39;);' onmouseleave='$(this).parent(&#39;.selectBoxInput&#39;).css(&#39;border&#39;,&#39;&#39;);sE(event);'>";return i+="<span class='slctOptVal'",1==Events.setPadding(t)&&(i+="style='padding-left:10px'"),i+=">"},renderingUtils.isElementInViewport=function(e){"function"==typeof jQuery&&e instanceof jQuery&&(e=e[0]);var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)},renderingUtils.freezeProperty=function(e,t){Object.defineProperty(e,t,{enumerable:!1,configurable:!1,writable:!1})},renderingUtils.forceTransitionTo=function(e){var t=!1,r=Lyte.Router.getRouteInstance().transition.info;if(e.route==r.route){t=!0,e.queryParams||(e.queryParams={}),e.dynamicParams||(e.dynamicParams=[]);var a=$u.isEqual(e.queryParams,r.queryParams),i=$u.isEqual(e.dynamicParams,r.dynamicParams);t=!(!a||!i)}t?Lyte.Router.getRouteInstance().refresh():Lyte.Router.transitionTo({route:e.route,dynamicParams:e.dynamicParams,queryParams:e.queryParams})},renderingUtils.getSingularLabel=function(e){return I18n.getMsg(Crm.moduleInfo[e].translatedSingularLabel)},renderingUtils.getPluralLabel=function(e){return I18n.getMsg(Crm.moduleInfo[e].translatedPluralLabel)},renderingUtils.showLyteErrorMessage=function(e,t,r){r&&(r=r.replace("#",""));var a=t.attr("id");a=null!=a?a:r,$("#lyteerrorMsg_"+a).remove();var i=document.createElement("span"),n=$(i);a?n.html(e).attr({class:"lyteErrorMsg",id:"lyteerrorMsg_"+a}):n.html(e).attr({class:"lyteErrorMsg"}),t.addClass("lyteErrorBorder"),t.append(i),t.outerWidth()<200&&n.css("whiteSpace","nowrap")},renderingUtils.hideLyteErrorMessages=function(e){$(e).find(".lyteErrorMsg").remove(),$(e).find(".lyteErrorBorder").removeClass("lyteErrorBorder")},renderingUtils.getClipBoardData=function(e){return e.clipboardData&&e.clipboardData.getData("text/plain")?e.clipboardData.getData("text/plain"):window.clipboardData&&window.clipboardData.getData("text")?window.clipboardData.getData("text"):e.originalEvent.clipboardData.getData("text/plain")},renderingUtils.restrictPaste=function(e,t,r){t.preventDefault();var a=renderingUtils.getClipBoardData(t),i=$(e).text();if(r&&i.length+a.length>r){var n=r-i.length;a=a.substring(0,n)}a.length>0&&document.execCommand("insertHTML",!1,$ESAPI.encoder().encodeForHTML(a))},renderingUtils.showAlertMsg=function(e,t,r,a){r||(r=[{type:"accept",text:I18n.getMsg("crm.mb.newversion.msg4"),appearance:"primary"}]),a||(a={}),a.params={ltPropPrimaryMessage:"",ltPropContentAlign:"center",ltPropWrapperClass:"utilsAlertMsg",ltPropSecondaryMessage:"X",ltPropButtons:r},t&&(a.params.ltPropType=t),a.show=function(t){$L(".utilsAlertMsg").find("lyte-button").focus();var r=t.childComp.querySelector(".alertSecondaryMsg");r.innerHTML=e,r.classList.add("crm-font-regular")},_cruxUtils.showCustomAlert(a)},renderingUtils.showMsgBox=function(e,t,r){var a=document.getElementById("lyteMsgBox");r||(r={}),r.ltPropType=t,r.ltPropMessage=e,r.ltPropDuration=r.ltPropDuration?r.ltPropDuration:"3000",r.id="lyteMsgBox",a?a.ltProp({message:r.ltPropMessage,type:r.ltPropType,duration:r.ltPropDuration}):a=Lyte.Component.render("lyte-messagebox",r,"body"),a.ltProp("show",!0)},renderingUtils.RemoveFromCache=function(){var e=Lyte.removeFromCache.assign;Lyte.removeFromCache.assign=function(t){return void 0!==t?(t=commonUtils.getArrayList(t),e(t[0])):void 0}},renderingUtils.emptySearchBox=function(){$("#searchField").val("").trigger("keyup")},renderingUtils.searchKey=function(e,t){t?($("#emptySearch").css("display",e.value?"block":"none"),showMacroSuggest(e,t,"availableList","li","noRecords","","","",void 0,void 0,"false",!0)):($("#emptySearch").css("display",e?"block":"none"),commonUtils.searchedFields(moduleJSON,e))},renderingUtils.removeMultiSpacestoSingleSpace=function(e){return"string"==typeof e?e.replace(/  +/g," "):e},renderingUtils.getFirstChild=function(e){for(var t=e.firstChild;null!=t&&3===t.nodeType;)t=t.nextSibling;return t},renderingUtils.getPickListDisplayValuebyDomAndSysValue=function(e,t){for(var r=$("#"+e).data().picklistmap,a=r.length,i=0;i<a;i++)if(r[i].systemvalue==t)return r[i].uservalue;return null},renderingUtils.getPickListDefaultValToActualValDetailView=function(e){for(var t=e.defaultvalue,r=e.picklistmap,a=r.length,i=0;i<a;i++)if(r[i].uservalue==t)return r[i].systemvalue},renderingUtils.highlightUrlInText=function(e){if(e){return e.replace(/((https?|ftp)(:|&#x3a;)(\/\/|&#x2f;&#x2f;))((www\.){0,1}[a-zA-Z0-9-_]+(\.[a-z0-9]+)+)((:|&#x3a;)[0-9]*(\.[a-z0-9]+)*)*(((\/|&#x2f;)[^\s]*)*)|www\.([a-zA-Z0-9-_]+(\.[a-z0-9]+)+)((:|&#x3a;)[0-9]*(\.[a-z0-9]+)*)*(((\/|&#x2f;)[^\s]*)*)/g,(function(e){var t="";return-1===e.indexOf("http")&&-1===e.indexOf("ftp")&&(t="//"),'<a class="link" rel="noopener noreferrer" href="'+t+e+'" target="_blank">'+e+"</a>"}))}return""},renderingUtils.showLyteErrorMessageWithParentScope=function(e,t,r){t&&(t=t.replace("#",""));var a=t,i=$(r).find("#"+t);if(!(n=i.find("lyte-drop-button")).length)var n=i.find(".lyteField");r?$("#lyteerrorMsg_"+a,r).remove():$("#lyteerrorMsg_"+a).remove();var o=document.createElement("span"),s=$(o);a?s.html(e).attr({class:"lyteErrorMsg",id:"lyteerrorMsg_"+a}):s.html(e).attr({class:"lyteErrorMsg"}),n.addClass("lyteErrorBorder"),n.append(o),n.outerWidth()<200&&s.css("whiteSpace","nowrap")};var storageUtils={removeLocalStorageValue:function(e){"undefined"!=typeof Storage?localStorage.removeItem(e):cookieUtils.deleteCookie(e)},setLocalStorage:function(e,t){"undefined"!=typeof Storage?localStorage.setItem(e,t):cookieUtils.setCookie(e,t)},getLocalStorageValue:function(e){return"undefined"!=typeof Storage?localStorage.getItem(e):cookieUtils.getCookie(e)}},commonUtils={ms_ie:!1,getPhotoURL:function(e){return crmConstants.contactsPhotoURL+"/file?ID="+e+"&fs=thumb"},getFromToIndexes:function(e,t){var r=parseInt(parseInt(e)/parseInt(t)),a=[];return a.push(r*t+1),a.push((r+1)*t),a},isInViewport:function(e){var t=e.offset().top,r=e.offset().top+e.outerHeight(),a=$(window).scrollTop()+$(window).innerHeight(),i=$(window).scrollTop()+$(".cvpadding").outerHeight();return a>t&&i<r}};commonUtils.checkErrorMsg=function(e,t,r,a,i){t=t||"show";var n=$("#twtInptDiv");if("object"==typeof e){if("true"===e.error&&"crm.process.criteria.pop.info"===e.errMsg)return crmui.showMsgBand("error",I18n.getMsg(e.errMsg),3e3),commonUtils.showHideLoadingDiv(),!0;if("LOOKUPFILTER_CRITERIA_NOTMATCHED"===e.STATUS){var o=(E=["(",")","+","-","_","/"]).length,s=e.INFO.length;if(s>0)for(var l=0;l<s;l++){var c="1"===(y=e.INFO[l]).ISCF?y.COLUMNNAME:y.FIELDLABEL;for(_=0;_<o;_++)c=commonUtils.replaceSpSymbols(c,E[_]);(b=$("#property\\("+c+"\\)"))&&0!==b.length||(b=a?$("#"+y.COLUMNNAME):$("#Crm_"+i+"_"+y.COLUMNNAME))&&0!==b.length||(b=$("input[name=property\\("+c+"\\)]")),Crm.showErrorMsg(I18n.getMsg("crm.lookupfilter.entity.errormsg",y.SINGULARTABLABEL),b,i,a),a||commonUtils.isInViewport(b)||$.scrollTo(b,{axis:"y",duration:1e3,offset:-100})}else if(Object.keys(e.INFO))for(var d=Object.keys(e.INFO),u=d.length,m=0;m<u;m++)for(var p=d[m],g=p.split("_")[1],h=p.split("_")[2],f=e.INFO[p],v=f.length,C=0;C<v;C++){var y=f[C];let e=Crm.requestSubformBitMap[h],t=0,r=0;for(;t<g&&r<1e3;)"1"===e.charAt(r)&&t++,r++;let n=$("#subform_"+h).find("tr")[r],o=0!==$(n.querySelector(" input[data-colname="+y.COLUMNNAME+"]")).length?$(n.querySelector(" input[data-colname="+y.COLUMNNAME+"]")):$(n.querySelector(" textarea[data-colname="+y.COLUMNNAME+"]"));Crm.showErrorMsg(I18n.getMsg("crm.lookupfilter.entity.errormsg",y.SINGULARTABLABEL),o,i,a),commonUtils.isInViewport(o)||$.scrollTo(o,{axis:"y",duration:1e3,offset:-100})}return commonUtils.showHideLoadingDiv(),!0}if("DUPLICATE"===e.STATUS){if(Crm.hideDuplicateErrorMsg(),e.TYPE)return renderingUtils.showCustomAlert(e.INFO,"",!0),commonUtils.showHideLoadingDiv(),!0;o=(E=["(",")","+","-","_","/"]).length;for(var E,I=e.INFO.length,w=0,T=0;T<I;T++,w++){var b,S=e.INFO[T],_=0,M=S.FIELDLABEL;i=S.MODULE,c="1"==S.ISCF?S.COLUMNNAME:M;for(_=0;_<o;_++)c=commonUtils.replaceSpSymbols(c,E[_]);(b="TWITTER"===S.COLUMNNAME?n:$("#property\\("+c+"\\)"))&&0!==b.length||(b=!0===a?$("#Crm_"+i+"_"+S.COLUMNNAME+".Crm_"+i+"_"+S.COLUMNNAME):$("#Crm_"+i+"_"+S.COLUMNNAME));var D=Crm.getDuplicateErrorMsg(S,!1,void 0,w);Crm.showErrorMsg(D,b,i,a),b.focus()}return commonUtils.showHideLoadingDiv(),!0}if("REPORTINGTO_COUNT_EXCEEDED"===e.STATUS){var A="<span id='errorMsg_Crm_Contacts_REPORTINGTOCONTACTID' class='errMsg errorMsgDesc'>"+e.INFO+"</span>",k=$("#Contacts_fldRow_REPORTINGTOCONTACTID");return k.addClass("errorFieldP"),k.find(".labelValCreate").append(A),commonUtils.showHideLoadingDiv(),!0}if("ACCOUNT_PERMISSION_DENIED"===e.STATUS){A="<span id='errorMsg_Crm_Contacts_ACCOUNTID' class='errMsg errorMsgDesc'>"+e.INFO+"</span>";var N="#Contacts_fldRow_ACCOUNTID";return $(N).addClass("errorFieldP"),$(N).find(".labelValCreate").append(A),commonUtils.showHideLoadingDiv(),!0}if("PRODUCT_DOES_NOT_EXIST"===e.STATUS){var L,R="object"==typeof e.DelProd?e.DelProd:JSON.parse(e.DelProd);for(_=0;_<e.ProdCount;_++){var O,P;if(Crm.userDetails.isLineItemSubformMvmtDone?(O=productDetails.sfFldIdSuffix.substr(1)+"PRODUCTID_"+(_+1),P=productDetails.sfFldIdSuffix+"PRODUCTID_"+(_+1)):(O="hrow"+(_+1),P="#txtProductSpan"+(_+1)),$("#errorMsg_product_"+O).remove(),R.includes(_+1)){A="<div id='errorMsg_product_"+O+"' style='clear:both; padding-bottom:10px; color:#F63648; font-size:1.1rem !important; display:block;'>"+I18n.getMsg("crm.select.product.deleted")+"</div>";$(A).insertAfter(P),L=$("#"+O).offset()}}return window.scrollTo(0,L.top-200),commonUtils.showHideLoadingDiv(),!0}if("INVALID_INVENTORY_REQUEST"==e.STATUS)return renderingUtils.showCustomAlert(I18n.getMsg("crm.email.message.invalid.data")+". "+I18n.getMsg("crm.refresh.page")),commonUtils.showHideLoadingDiv(),!0;if("FILEUPLOAD_FIELD_LIMITEXCEEDED"===e.STATUS)return crmui.showMsgBand("error",I18n.getMsg("crm.attachment.fileUploadField.Maxlen.check.field",[e.MAXLEN,e.LABEL]),3e3),commonUtils.showHideLoadingDiv(),!0;if("IMAGEUPLOAD_FIELD_LIMITEXCEEDED"===e.STATUS)return crmui.showMsgBand("error",I18n.getMsg("crm.imageupload.allowed.length",[e.MAXLEN,e.LABEL]),3e3),commonUtils.showHideLoadingDiv(),!0;if("SHOW_INFO_KEY_ERROR"===e.STATUS)return crmui.showMsgBand("error",e.INFO,3e3),commonUtils.showHideLoadingDiv(),!0;if("NO_PERMISSION_FOR_EMAILID"===e.STATUS){commonUtils.showHideLoadingDiv();for(var U=(z=e.DETAILS.fields).length,x=0;x<U;x++){M=z[x].field_label;var F=$L(a?"#createEntityForm":"#secDiv_Native__Campaigns__Extn__Zoho_Campaign_Details").find('[data-label="'+M+'"]');Crm.showErrorMsg(I18n.getMsg("crm.zcampaign.emailid.permission.denied"),F,i)}return!0}if("LOOKUP_RECORD_ENTERS_INTO_REVIEW"===e.STATUS)return crmui.showMsgBand("error",e.INFO,3e3),commonUtils.showHideLoadingDiv(),!0;if(e.message&&-1!==e.message.indexOf("cf validation rule execution failed"))return CVRExec.showAlertOnError(i,e);if(e.message&&-1!==e.message.indexOf("validation rule execution failed")){if("error"===e.status){if(e.validation_rule_error_fields)for(var V=(z=e.validation_rule_error_fields).length,H={},B={},j=0;j<V;j++)H=z[j],B=$("#"+CVRExec.getElemId("edit",H.column_name,i)),Crm.showErrorMsg($ESAPI.encoder().encodeForHTML(H.alert),B,i),B.focus();return!0}}else if(e.message&&-1!==e.message.indexOf("Service Module Check for Service Availability")||e.message&&-1!==e.message.indexOf("Appointment Module Check for Service Availability")){if("error"===e.status){if(e.service_availability_error_fields){var z;for(V=(z=e.service_availability_error_fields).length,H={},B={},j=0;j<V;j++)H=z[j],B=$("#"+CVRExec.getElemId("edit",H.column_name,i)),Crm.showErrorMsg($ESAPI.encoder().encodeForHTML(H.alert),B,i),B.focus()}return!0}}else{if(e.message&&("crm.error.services.limit"==e.message||"crm.error.active.services.limit"==e.message))return"error"===e.status&&renderingUtils.showCustomAlert(I18n.getMsg(e.message,moduleRecordMapping.Appointments.singular_label),"",!1),!0;if(e&&e.STATUS&&"FAILURE"===e.STATUS&&e.INFO&&e.INFO.MSG)return renderingUtils.showCustomAlert(e.INFO.MSG,"",!0),commonUtils.showHideLoadingDiv(),!0;if("SUBFORM_RECORD_MAX_ROW_EXCEEDED"===e.STATUS){var W=e.INFO.split(":::"),q=I18n.getMsg(W[0],[W[1],W[2]]);return crmui.showMsgBand("error",q,3e3),commonUtils.showHideLoadingDiv(),!0}if(e&&e.STATUS&&"ZIAFAILURE"===e.STATUS&&e.INFO){var Y=$L(".photoUploadSec"),J=$("#wmstoolbar"),G=28;J&&(G=J.outerHeight());var K=$("#createFixedButtonDiv"),Q=Y.offset().top+Y.outerHeight(),X=Y.offset().top,Z=$(window),ee=Z.scrollTop()+K.outerHeight(),te=ee+renderingUtils.windowHeight-G-K.outerHeight();if(!(X>ee&&Q<te)){var re=Y.offset().top-G-K.outerHeight();Z.scrollTop(re)}var ae=Crm.getVisionMyJobsDependency();return Lyte.injectResources(ae,void 0,(function(){if("PRODUCTID_INVALID"===e.STATUS){var t=$('[data-colname="PRODUCTID"]')[e.prdId].closest("div");if(0===t.getElementsByClassName("prdError").length){var r=document.createElement("span");r.setAttribute("class","prdError errMsg errorMsgDesc"),r.innerText=I18n.getMsg(e.errMsg),t.append(r)}return commonUtils.showHideLoadingDiv(),!0}!function(){var t=$("crm-zia-vision-error-popup");0!=t.length&&t.remove();Crm.client_tracking("Zia Vision Entity Validation Failure",{type:e.INFO});var r=$L(".lnPhoto");r.find("img").hide();var a=$L("#imgContainer").find("img")[0].src;Lyte.Component.render("crm-zia-vision-error-popup",{moduleName:i,createImgSrc:a,action:e.INFO,visionId:e.VISIONID},"#zia-vision-popup"),r.addClass("lnPhoto_ziaVision"),Y.addClass("cP"),Y.attr("onclick",'$("#visionModal")[0].ltProp("show", true);')}(model)})),!0}$L(".lnPhoto").removeClass("lnPhoto_ziaVision")}}else if(void 0!==e.indexOf){if(e.indexOf("NAVMESG::::")>-1){var ie=e.substring(e.indexOf("NAVMESG::::")+11,e.indexOf("::::NAVMESG"));return renderingUtils.showCustomAlert(I18n.getMsg(ie,I18n.getMsg(singularModule))),commonUtils.showHideLoadingDiv(),!0}if(e.indexOf("INVALIDTICKET:::")>-1)return commonUtils.showHideLoadingDiv(),renderingUtils.showCustomAlert(I18n.getMsg("crm.project.portal.zsckeyisregenerated.admin")),!0;if(e.indexOf("Cannot_Create_Anymore_Projects")>-1)return renderingUtils.showCustomAlert(I18n.getMsg("crm.project.limit.projectcreation")),commonUtils.showHideLoadingDiv(),!0;if(e.indexOf("Portal_owner_changed")>-1)return renderingUtils.showCustomAlert(I18n.getMsg("crm.project.portalownerchanged")),commonUtils.showHideLoadingDiv(),!0;if(e.indexOf("Insufficient_Privileges_Project")>-1)return renderingUtils.showCustomAlert(I18n.getMsg("crm.project.noproceed.insuff.projects")),commonUtils.showHideLoadingDiv(),!0;if(e.indexOf("Not_A_User_In_Projects")>-1)return renderingUtils.showCustomAlert(I18n.getMsg("crm.project.noproceed.notinprojects")),commonUtils.showHideLoadingDiv(),!0;if(e.indexOf("No_Permission_For_User_Profile")>-1)return renderingUtils.showCustomAlert(I18n.getMsg("crm.project.noproceed.insuff.crm")),commonUtils.showHideLoadingDiv(),!0;if(e.indexOf("NOPROJECTTOASSOCIATE")>-1)return renderingUtils.showCustomAlert(I18n.getMsg("crm.project.noprojavailable")),commonUtils.showHideLoadingDiv(),!0;if(e.indexOf("NOPROJASSOCIATION:::")>-1)return commonUtils.showHideLoadingDiv(),renderingUtils.showCustomAlert(I18n.getMsg("crm.project.nomoretoassociate","")),!0;if(e.indexOf("TWOCONTACTSWITHSAMEEMAIL")>-1)return renderingUtils.showCustomAlert(I18n.getMsg("crm.project.sameemail")),commonUtils.showHideLoadingDiv(),!0;if(e.indexOf("SECURITY::::")>-1||-1!==e.indexOf("SECURITY_ERROR_403::::INSUFFICIENT")||-1!==e.indexOf("SECURITY_ERROR_403::::INSUFFICIENT_PRIVILEGES"))return 1===(y=e.split("SECURITY::::")).length&&(y[1]=e),$(t).html(y[1]),commonUtils.showHideLoadingDiv(),!0;if(e.indexOf("CRM_ERROR_PAGE_500::::EXCEPTION")>-1){if(r&&(r.indexOf("CreateCommonModule")>-1||r.indexOf("EditCommonModule")>-1))if(e.indexOf("MaxLenField")>-1){var ne=e.substring(e.indexOf("MaxLenField"),e.lastIndexOf("&#x3a;&#x3a;"));ne=(ne=ne.split("&#x3a;&#x3a;")).splice(1,2);var oe=$("#Crm_"+i+"_"+ne[1].toUpperCase().replace(/ /g,""));oe.data()?ne[1]=oe.data().displaylabel:ne[1]=I18n.getMsg(ne[1],I18n.getMsg(moduleRecordMapping[i].singular_label)),ne.toString().indexOf("txtListPrice")>-1?ne[1]=I18n.getMsg("List Price"):ne.toString().indexOf("txtQty")>-1?ne[1]=I18n.getMsg("Qty"):ne.toString().indexOf("hdnTotal")>-1?ne[1]=I18n.getMsg("Amount"):ne.toString().indexOf("hdnDiscount")>-1||ne.toString().indexOf("hdnDiscPc")>-1?ne[1]=I18n.getMsg("Discount"):ne.toString().indexOf("hdnTax")>-1?ne[1]=I18n.getMsg("Tax"):ne.toString().indexOf("hdnNetTotal")>-1&&(ne[1]=I18n.getMsg("Total")),renderingUtils.showCustomAlert(I18n.getMsg("crm.iamexception.maxlen",ne))}else!Crm.isHeadless&&productDetails.isListPriceEmpty()?crmui.showMsgBand("error",I18n.getMsg("crm.label.alert.listprice",""),4e3):Crm.userDetails.isStorageLimitReached?Crm.showStorageExceedPopup():renderingUtils.showCustomAlert(I18n.getMsg("crm.unable.to.process.request",""));else{var se=$(t);se.html(e),EvalInnerScript(se),$.scrollTo("#basic")}return commonUtils.showHideLoadingDiv(),!0}if(e.indexOf("SECURITY::::")>-1){y=e.split("SECURITY::::");return $("#show").html(y[1]),commonUtils.showHideLoadingDiv(),!0}if(e.indexOf("NOT UNIQUE:::")>-1){y=e.split("NOT UNIQUE:::");return $("#unique").html(y).show(),commonUtils.showHideLoadingDiv(),!0}if(e.indexOf("NOT UNIQUE ACCOUNT:::")>-1){var le=$("#Crm_"+i+"_ACCOUNTID");return Crm.showErrorMsg(e.split("NOT UNIQUE ACCOUNT:::"),le,i,a),le.focus(),commonUtils.showHideLoadingDiv(),!0}if(e.indexOf("UNAUTHORIZED TO ASSOCIATE ACCOUNT:::")>-1){le=$("#Crm_"+i+"_ACCOUNTID");return Crm.showErrorMsg(e.split("UNAUTHORIZED TO ASSOCIATE ACCOUNT:::"),le,i,a),le.focus(),commonUtils.showHideLoadingDiv(),!0}if(e.indexOf("Why does my session expire")>-1||e.indexOf("Affordable for Medium Business")>-1)return renderingUtils.showCustomAlert(I18n.getMsg("crm.reauth.login.expired",I18n.getMsg(singularModule))),document.location.href=Crm.getCrmBasePath()+"/ShowHomePage.do",!0;if(e.indexOf("CRM_ERROR_PAGE_500::::EXCEPTION")>-1)return!0;if(["crm.zsurvey.error.create.survey.campaign.brandchange","crm.zsurvey.error.invalid.survey.type","crm.zsurvey.error.create.new.survey"].contains(e))return crmui.showMsgBand("error",I18n.getMsg("crm.zsurvey.error.create.survey.campaign.brandchange",Crm.integrationsAppName.ZOHO_SURVEY),3e3),!0}return!1},commonUtils.getPlainPhoneNo=function(e){var t=e.trim(),r=t.length,a="";if(r<0)return a;if(/^\d+(,(\d)+)*(\.\d{1,2})*$/.test(t))return t;if(14===r){if(t.startsWith("(")&&t.indexOf("-")&&t.indexOf(")")&&t.indexOf(" ")){a=t;var i=t.indexOf(")"),n=t.indexOf(" "),o=t.indexOf("-");return 4===i&&5===n&&9===o&&10===(t=(t=(t=(t=t.replace(" ","")).replace("(","")).replace(")","")).replace("-","")).length?t.replace(" ","").replace("(","").replace(")","").replace("-","").length<10?a:t:a}return t}if(12===r){if(-1!==t.indexOf(" "))return t;if(t.startsWith("(")&&t.indexOf(")")&&t.indexOf("-")){a=t;var s=t.indexOf(")"),l=t.indexOf("-");return 6===s&&7===l&&9===(t=(t=(t=t.replace("-","")).replace("(","")).replace(")","")).length?t.replace("-","").replace("(","").replace(")","").length<9?a:t:a}return t}return t},commonUtils.compareNumber=function(e,t){var r=!0;return(e===t||parseInt(e)>parseInt(t))&&(r=!1),r},commonUtils.calculateAcceptableCharCount=function(e,t){var r=document.createElement("div"),a=$(e).width();r.innerText=t+"...",r.style.display="none",document.body.appendChild(r);var i=$(r).width();if(document.body.removeChild(r),(a=a||200)>i)return t.length;for(;a<i;)t=t.substring(0,t.length-2),r.innerText=t+"...",r.style.display="none",document.body.appendChild(r),i=$(r).outerWidth(),document.body.removeChild(r);return t.length},commonUtils.cleanWhitespace=function(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];3!==r.nodeType||/\S/.test(r.nodeValue)||(e.removeChild(r),t--),1===r.nodeType&&commonUtils.cleanWhitespace(r)}return e},commonUtils.destroyCanvasElem=function(){commonUtils.getTextWidthUsingCanvas.canvasElem=null},commonUtils.getTextWidthUsingCanvas=function(e,t){var r,a;return r=(commonUtils.getTextWidthUsingCanvas.canvasElem||(commonUtils.getTextWidthUsingCanvas.canvasElem=document.createElement("canvas"))).getContext("2d"),t?(-1!==(a=t.font.split(" "))[0].search("rem")&&(a[0]=16*a[0].split("rem")[0]+"px",t.font=a.join(" ")),r.font=t.font):r.font="16px crm-font-regular",r.measureText(e).width},commonUtils.openCustomLookup=function(e,t,r,a,i,n,o,s,l,c){if(Crm.userDetails.CLIENT_ACCOUNT&&t&&t.searchmodule){var d=Crm.moduleInfo?Crm.moduleInfo[t.searchmodule]:void 0;if(d)store.peekRecord("module",d.Id).fields||store.findAll("field",{module:d.apiname})}if(loadAjaxTab(""),(e.includes("/EditCompetitor.do")||e.includes("/ViewCompetitor.do")||e.includes("/ShowMultiValuesForAdd.do"))&&(t||(t={}),"string"==typeof t?t=t+"&"+csrfParamName+"="+csrfToken:t[csrfParamName]=csrfToken),t&&t.lookuprel&&"true"===t.lookuprel){for(var u in t)if(t.hasOwnProperty(u)){var m=t[u];"true"===m?m=!0:"false"===m&&(m=!1),e+="&"+u+"="+m}t=null}(new crmRequestPool).initiate({action:e,type:"POST",data:t,success:function(e){var t=$("#searchCreatePopup"),i=$("#topBandPopup"),n=$("#freezeBackGround"),d=$("#qCreate"),u=d.is(":visible"),m=t.is(":visible"),p=$("#sIlookupFieldAddNew").is(":visible");$(".eventCreatePopup");commonUtils.showHideLoadingDiv();var g=!(!Lyte.Router.getRouteInstance()||"canvas"!=Lyte.Router.getRouteInstance().routeName);if(validationUtils.isJson(e)&&"object"!=typeof e&&"crm.campaign.integ.sandbox.not.supported"===JSON.parse(e).error)crmui.showMsgBand("error",I18n.getMsg("crm.campaign.integ.sandbox.not.supported",crmTab.getDisplayName("Campaigns",!1).toLowerCase()),3e3);else if(validationUtils.isJson(e)&&"object"==typeof e&&"PARENT_RECORD_DELETED"===e.STATUS)crmui.showMsgBand("error",I18n.getMsg("crm.record.perform.deleted.revoked"),5e3);else{var h=$("#"+r),f=$(".etTrendsWrapper");f.length&&"searchCreatePopup"===r?($(".temp_freezelayer").css({zIndex:315}),h.css("z-index","316")):"topBandPopup"===r&&$(".temp_freezelayer").css({zIndex:315});var v=h.is(":visible");if($.isPlainObject(e)){var C=!1;if(!1===e.lookupFilterNotSatisfied)return void crmui.showMsgBand("error",e.lookupFilterErrorMsg,"4000","");if(1==e.scheduled&&(multiLookupsView.permissionIssueWarningShow(null,null,e.searchmodule,7),C=!0),e.unassignallscheduler_running)return void(e.islookup?multiLookupsView.permissionIssueWarningShow(null,null,e.searchmodule,17,null,e.unassignallscheduler_runningmsg,e.unassignallscheduler_runningtitle):multiLookupsView.permissionIssueWarningShow(null,null,e.searchmodule,13,null,e.unassignallscheduler_runningmsg));if(e.mxnconvertscheduler_running)return void multiLookupsView.permissionIssueWarningShow(null,null,e.searchmodule,18,null,e.mxnconvertscheduler_runningmsg);if(e.clonescheduler_running)return void multiLookupsView.permissionIssueWarningShow(null,null,e.searchmodule,11,null,e.clonescheduler_runningmsg);if(1==e.isEditPermissionDenied&&1==e.isconfirm)return multiLookupsView.closeMLPopup(e.fldName),void multiLookupsView.permissionIssueWarningShow(null,null,e.searchmodule,1);var y=!1;if(multiLookupsView.multiLookups&&multiLookupsView.multiLookups[e.fldId]||(y=!0),e.relid){(M={}).id=e.entityId,M.rid=e.relid;var E=(O=g?store.peekRecord("related_list",e.relid):crmRelatedList.EachModuleData[e.relid]).parentModule?O.parentModule:$L("#module")[0].value;e.parentModule&&(E=e.parentModule),y||(E&&""!==E&&"null"!=E||(multiLookupsView.multiLookups[e.fldId].parentModule=e.parentModule),e&&e.page&&(multiLookupsView.multiLookups[e.fldId].page=e.page),multiLookupsView.currentMultiLookup.isMandatory||e.select&&"true"===e.select&&e.body&&0===e.body.length||(multiLookupsView.multiLookups[e.fldId].variedLookupValues=null,multiLookupsView.multiLookups[e.fldId]=null)),M.actModule=E,M.module=E,M.actId=e.entityId,M.pname=O.name,M.isSortRequest=!1,Lyte.triggerEvent("relatedList",{id:e.relid}),crmRelatedList.ajaxReq(M),0==M.isSortRequest&&multiLookupsView.updateMXNFieldValue(void 0,M.rid,e.defaultvalue),!C&&e.successmsg&&crmui.showMsgBand("success",e.successmsg,"2000","")}else{multiLookupsView.multiLookups&&multiLookupsView.multiLookups[e.fldName]&&(e&&e.parentModule&&(multiLookupsView.multiLookups[e.fldName].parentModule=e.parentModule),e&&e.page&&(multiLookupsView.multiLookups[e.fldName].page=e.page)),multiLookupsView.updateMXNFieldValue(e.fldName,void 0,e.defaultvalue);var I=$("#mxnEntityLookupdiv"),w=$("#popupClose");if(m&&(e.fromSearchCreate&&("true"==e.fromSearchCreate||1==e.fromSearchCreate)||c)){n.addClass("zindex248").css("z-index","251");var T=!0;if(I)if(w)(_=w.attr("href"))&&_.indexOf("javascript:multiLookupsView.closeMLPopup(")>-1&&(_=_.replace("javascript:multiLookupsView.closeMLPopup('","").replace("');",""))!==e.fldName&&multiLookupsView.multiLookups[_]&&multiLookupsView.multiLookups[_].lookuprel&&(T=!1);if(!T){multiLookupsView.multiLookups[_].currentDom=i.html();var b=i.attr("style");multiLookupsView.multiLookups[_].currentDomstyle=b;var S=multiLookupsView.callMultiLookupPopup(e);h.html(S)}i.css("z-index","252")}if(u){n.removeClass("zindex250").css("z-index","250");var _;T=!0;if(I)if(w)(_=w.attr("href"))&&_.indexOf("javascript:multiLookupsView.closeMLPopup(")>-1&&(_=_.replace("javascript:multiLookupsView.closeMLPopup('","").replace("');",""))!==e.fldName&&multiLookupsView.multiLookups[_]&&multiLookupsView.multiLookups[_].lookuprel&&(T=!1);if(!T){multiLookupsView.multiLookups[_].currentDom=i.html();b=i.attr("style");multiLookupsView.multiLookups[_].currentDomstyle=b;S=multiLookupsView.callMultiLookupPopup(e);h.html(S)}i.css("z-index","252"),m&&n.removeClass("zindex250").css("z-index","251")}}if("{}"===e.body)return void(y?(i.css("z-index",""),hideAnimatePopup("deletepopup",!1),multiLookupsView.fieldStatusUpdate(e.fldName)):multiLookupsView.currentMultiLookup.isMandatory||multiLookupsView.closeMLPopup(e.fldName));S="";if(n.removeClass("zindex250"),e.isPartialLoad)multiLookupsView.partialCallBodyMultiLookupPopup(e);else{if(multiLookupsView.currentMultiLookup&&multiLookupsView.currentMultiLookup.isMandatory){if(e&&e.fldName&&-1===e.fldName.indexOf("_")){S=multiLookupsView.callMultiLookupPopup(e),h.html(S),a=renderingUtils.windowWidth-400,h.width(a),h.find(".pp-footer").removeClass("box-sh");var M,D=moduleRecordMapping[e.searchmodule].singular_label.toLowerCase();(M={}).id=e.entityId;O=crmRelatedList.EachModuleData[e.fldName];M.rid=e.fldName,M.actModule=e.parentModule,M.module=e.parentModule,M.actId=e.entityId,O&&(M.pname=O.name),M.isSortRequest=!1,crmRelatedList.ajaxReq(M),"addmore"==e.page&&crmui.showMsgBand("success",I18n.getMsg("crm.mxnlookup.lookuprel.mandatory.quickcreate",[D,multiLookupsView.currentMultiLookup.associatedRecordLabel?multiLookupsView.currentMultiLookup.associatedRecordLabel:""]),3e3)}}else{S=multiLookupsView.callMultiLookupPopup(e),h.html(S),a=renderingUtils.windowWidth-400,h.width(a),h.find(".pp-footer").removeClass("box-sh");var A=$(".mlSelectedRecord"),k=A.text(),N=$("#removeAllBtn"),L=$("#selected-records");if(("true"===e.select||!0===e.select)&&e.selectedCount>0)N.css({visibility:"hidden",display:"none"}),document.getElementsByName("AddMore")[0].setAttribute("style","display:none;visibility:hidden"),A.text(e.selectedCount),L.css("visibility","visible");if("false"!==e.select&&!1!==e.select||(""!==k&&k>0?($("#nextStep").prop("disabled",!1),$(".animateMl").css("visibility","hidden").addClass("cvTableAct"),L.css("visibility","visible")):($("#nextStep").prop("disabled",!0),$(".animateMl").css("visibility","visible").removeClass("cvTableAct"),L.css("visibility","hidden"))),e.select&&"true"==e.select&&0===e.body.length&&N.css("visibility","hidden"),$("#mxnlistViewTable tbody").find(".customCheckBox").length>0?$("#mxnlistViewTable #checkAll").attr("class","customCheckBox"):$("#mxnlistViewTable #checkAll").attr("class","customCheckBoxChecked"),multiLookupsView.mlSearchCloseIcon(".mlSearch"),o&&$(o.target).filter("input[type=button]").prop("disabled",!1),multiLookupsView.currentMultiLookup.associatedRecordLabel){var R={};if(null==D&&e&&(D=Crm.moduleInfo[e.module].translatedSingularLabel),e&&e.entityId&&e.refreshid){var O;if(R.id=e.entityId,R.rid=e.refreshid,O=crmRelatedList.EachModuleData[e.refreshid]){E=O.parentModule;R.pname=O.name}R.actModule=E,R.module=E,R.actId=e.entityId,R.isSortRequest=!1,crmRelatedList.ajaxReq(R),crmui.showMsgBand("success",I18n.getMsg("crm.mxnlookup.lookuprel.mandatory.quickcreate",[D,multiLookupsView.currentMultiLookup.associatedRecordLabel]),3e3),delete multiLookupsView.currentMultiLookup.associatedRecordLabel}}}multiLookupsView.currentMultiLookup&&(multiLookupsView.currentMultiLookup.isMandatory=!1),!e.relid&&e.select&&"true"==e.select&&0===e.body.length&&multiLookupsView.openAddMorePopup(e.fldName)}}else"block"===$("#subSecondaryPopup").css("display")&&(n.addClass("zindex248"),i.css("z-index","300")),s&&"null"!==s?deskInteg.editPotentialLookUp(h,e):(Crm.isHeadless||"undefined"!=typeof crmNTC&&crmNTC.isSignalDetailViewVisible()&&"undefined"!=typeof crmNTCGlobal&&crmNTCGlobal&&crmNTCGlobal.showFreezeLayerForSignals(),h.html(e));if(u&&(Crm.userDetails.isLookupAdvancedSearchEnabled&&n.removeClass("zindex250").css("z-index","250"),p&&"lookupPopup"===r||i.css("z-index","252"),m&&n.removeClass("zindex250").css("z-index","251")),$.trim($("#diNotificationDiv").html()).length&&f.length&&i.css("z-index","316"),v){var P=$("#camp_status");P&&P.length&&thirdPartyUtils.bindSelect2(P)}else{a&&h.width(a),showAnimatePopup(r,(function(){"topBandPopup"===r&&(h.on("keydown",(function(e){var t=document.activeElement,r=$(t).closest("tr"),a=$("tr.tdhover");if(-1!==t.id.indexOf("radio_")){if(a.length>0&&(t=a.find("input")),40==e.keyCode)r.next().attr("class","tdhover"),e.preventDefault();else if(38==e.keyCode){var i=r.prev();i.find("input").length>0&&i.attr("class","tdhover"),e.preventDefault()}else 32==e.keyCode&&(renderingUtils.triggerEvent("click",t),e.preventDefault());r.removeClass("tdhover")}})),crmLayout.Resize.PopupHeightResize()),"searchCreatePopup"===r&&(t.find(".popup-model-footer").removeClass("scroll-sh"),crmLayout.Resize.PopupHeightResize())}));var U=$(".lookupListTable");if(U.is(":visible")){var x=parseInt(U.css("z-index"));t.css("z-index",x+2),n.css("z-index",x+1)}Crm.isFromSalesInbox&&d[0].childElementCount>0&&Crm.isFromSalesInbox&&$(".freezeLayer").attr("style","z-index : 35 !important")}setTimeout((function(){if(m=t.is(":visible"))m&&u&&Crm.isFromSalesInbox&&t.css("z-index","40");else{$("#fldValue").focus();var e=$("[name=fldValue]"),r=e.val();e.focus().val("").val(r)}m&&$L("#feedParentDiv").is(":visible")&&t.css("z-index","")}),100),m&&e.fromSearchCreate&&setTimeout((function(){var e=$("[data-zcqa=mxnsearchString]"),t=e.val();e.focus().val("").val(t)}),100),"function"==typeof l&&l()}},error:function(e){(commonUtils.showHideLoadingDiv(),"crm.tab.module.entity.canvas"===Lyte.Router.getRouteInstance().transition.info.route)&&($(".zc_ajax_pop_wrapper").eq(0).removeClass("dNImp"),"function"==typeof l&&l(!0));if(555===e.status&&e.responseText){if(renderingUtils.showCustomAlert(e.responseText),n){var t=$("#navig_next"),r=t.hasClass("vam")?"nextDisabled vam":"nextDisabled";t.after('<img hspace="2" src='+networkUtils.getImageUrl("spacer_e17b417_.gif",ResourceConstants.CRM)+'" class="'+r+'" align="middle">'),t.remove()}}else 558===e.status&&e.responseText?crmui.showMsgBand("warning",e.responseText,1e4):e.status!==crmConstants.errorStatusCode?renderingUtils.showCustomAlert("Unable to process request"):e.status===crmConstants.errorStatusCode&&window.scrollTo({top:0})}})},commonUtils.formatDecimalValue=function(e,t,r){var a=void 0!==t?t:0,i=parseFloat(e),n=(parseInt(i+"")+"").length,o=parseFloat(e).toPrecision(n+a);return o&&-1!==o.indexOf("e")&&(o=parseFloat(e).toPrecision(n+a+2)),!0===r?o:currencyUtils.getNumberWithCommas(o,",",".")},commonUtils.enableErrorLogging=function(){location.host.includes("zoho.in")&&"60010197171"===crmZgid&&(detailview_log={}),murphy.setTags((function(){var e=cookieUtils.getCookie("ZCRM_QA_AUTOMATION_MACHINEINFO"),t=e&&parseInt(e.split(":")[1])?parseInt(e.split(":")[1]):null;return{jsVersion:crmConstants.staticVersion.replace("v",""),buildId:crmConstants.buildId,zuid:Crm.userDetails.ZUID,zgid:Crm.userDetails.ZGID,screen:Crm.userDetails.screen,viewPort:Crm.userDetails.viewPort,lastRefresh:Crm.userDetails.lastRefresh,automation_id:cookieUtils.getCookie("ZCRM_QA_AUTOMATION_ID"),automation_case_id:cookieUtils.getCookie("ZCRM_QA_AUTOMATION_CASE_ID"),automation_case_info:e,case_rerun_count:t,userAgent:navigator.userAgent}})),Lyte.addEventListener("error",(function(e){murphy.error(e)}));var e,t=/\/(crm)\/[a-z0-9_\-.]+(\/[A-Za-z0-9]*)?(\/[A-Za-z0-9]*)?\/(ShowEntityInfo\.do|besttime|tags|EntityCustomization\.do|views|NewRelatedList\.do|zia_insights|[0-9]+|scoring_rules|GetIntegrationList\.do|bulk)(\?.*)?/;murphy.beforeTrack((function(e){if("xhr"===e.category){if(e.data.url.includes("tracking")||e.data.url.includes("spotlight"))return;if(location.host.includes("zoho.in")&&"60010197171"===crmZgid&&"undefined"!=typeof detailview_log&&Object.keys(detailview_log).length>0&&e.data.url.match(t)){var r={};return r.method=e.data.method,r.startimestamp=e.data.startimestamp,r.status_code=e.data.status_code,r.timeTaken=e.data.timeTaken,r.url=e.data.url,detailview_log.xhrTiming.push(r),e}return e}return e})),window.addEventListener("offline",(function(){murphy.addCustomTracking({message:"User went offline",name:"Network Status",type:"custom event"})})),window.addEventListener("online",(function(){murphy.addCustomTracking({message:"User Back online",name:"Network Status",type:"custom event"})})),document.createElement=(e=document.createElement,function(){var t=e.apply(this,arguments);return"script"!==t.tagName.toLowerCase()&&"link"!==t.tagName.toLowerCase()||(t.setAttribute("X-MURPHY-LOAD-START",Date.now()),t.addEventListener("error",(function(){var e=this.getAttribute("src")||this.getAttribute("href");e=e.includes("https")?e:"https:"+e,murphy.addCustomTracking({type:"http",category:"xhr",data:{method:this.tagName.toLowerCase(),url:e,startimestamp:this.getAttribute("X-MURPHY-LOAD-START"),timeTaken:Date.now()-this.getAttribute("X-MURPHY-LOAD-START"),status_code:404}})})),t.addEventListener("load",(function(){if(location.host.includes("zoho.in")&&"60010197171"===crmZgid){Array.isArray(detailview_log.getRes)&&detailview_log.getRes.length>0&&(detailview_log.getRes=_.flatten(detailview_log.getRes));var e=this.getAttribute("src")||this.getAttribute("href");if(e=e.includes("https")?e:"https:"+e,"undefined"!=typeof detailview_log&&detailview_log.getRes.length>0){var t=Date.now()-this.getAttribute("X-MURPHY-LOAD-START"),r={};r.url=e,r.timeTaken=t;var a=0,i=detailview_log.getRes.length;for(a=0;a<i;a++)if("string"==typeof detailview_log.getRes[a]&&e.includes(detailview_log.getRes[a]))detailview_log.resourceTime.push(r),detailview_log.getRes.splice(a,1),a--;else if("object"==typeof detailview_log.getRes[a]){function n(e,t){return!!t.includes(e.parent)||!!t.includes(e.child)||"object"==typeof e.child&&n(e.child,t)}n(detailview_log.getRes[a],e)&&detailview_log.resourceTime.push(r)}}}}))),t})},commonUtils.getfingerPrintProperties=function(e,t){if(null==t&&(t="default"),r="javascript",e.includes(".css"))var r="css";if(FingerPrint.isEnabled&&crmConstants.compression){var a=FingerPrint.config_properties[t][r][e],i=[],n=e.lastIndexOf(".");return i.push(e.substr(0,n)),i.push(e.substr(n)),a?i[0]+"_"+a+"_"+i[1]:e}return e},commonUtils.getCharacterCode=function(e){return e.which},commonUtils.getArrayList=function(e){var t,r=0;Array.isArray(e)?t=e:(t=[e],r=1);for(var a=[],i=[],n=0,o=t.length,s=0;s<o;s++)"object"==typeof t[s]?(i.push(t[s].parent),"object"!=typeof t[s].child?(i.push(t[s].child),a[n]=i,s=n):(t=[t[s].child],s=-1)):(n++,a[s]=r?e:e[s]);return a},commonUtils.getHeadLessCallbackCode=function(){return Crm.isHeadless?Lyte.Router.getRouteInstance("crm").getQueryParams().callbackcode:null},commonUtils.HandleCommaInFileName=function(e){return e.indexOf(",")>-1&&(e=e.indexOf("[comma]")>-1?e.replace(/\[comma\]/gi,"[Comma]"):e.replace(/,/g,"[comma]")),e},commonUtils.replaceSpSymbols=function(e,t){return e="("===t||")"===t||"+"===t?e.replace(new RegExp("\\"+t,"g"),"\\"+t):e.replace(new RegExp(t,"g"),"\\"+t)},commonUtils.getValue=function(e){var t,r=e.prop("type"),a=e.data("uitype");if("photoID"===e.prop("name")&&(r="text"),"text"===r||"combo"===r||"select-one"===r||"textarea"===r)t=e.val();else if("select-multiple"===r)"object"==typeof(t=e.val())&&0===t.length&&(t=null);else if("radio"===r){var i=e.attr("name");t=commonUtils.getRadioValue(i)}else"checkbox"===r&&(t=e.is(":checked")?"1":"");return 33==a&&Crm.userDetails.isPhoneNoNewView&&(t=CrmPhoneNumberInput.getValueFromPhoneFieldComp(e,t)),t},commonUtils.getRadioValue=function(e){return $("input[type='radio'][name='"+e+"']:checked").val()},commonUtils.showHideLoadingDiv=function(e){var t=$("#ajax_load_tab"),r=t.data("dispCount");r||(r=0),"undefined"!=typeof CrmPlusLib&&CrmPlusLib.isLoadedInCrmplusFrame?(t.is(":visible")&&t.hide(),e?(r++,t.data("dispCount",r),CrmPlusLib.showLoading()):(r>0&&r--,t.data("dispCount",r),CrmPlusLib.hideLoading())):e?(r++,t.data("dispCount",r).show()):(r>0&&r--,t.data("dispCount",r),t.hide())},commonUtils.clearTextSelection=function(e){var t=(e=e||window).document;if(e.getSelection)e.getSelection().removeAllRanges();else if(t.getSelection){var r=t.getSelection();r.collapse&&r.collapse(!0),r.removeAllRanges&&r.removeAllRanges()}else t.selection&&t.selection.empty()},commonUtils.addToMandatory=function(){var e=!1,t=!1,r=$("#selectedColumns").find("li");r.each((function(){($(this).attr("value").indexOf("LASTNAME")>-1||"Last_Name"===$(this).attr("value"))&&(e=!0),($(this).attr("value").indexOf("FULLNAME")>-1||"Full_Name"===$(this).attr("value"))&&(t=!0)})),e&&t||r.each((function(){var e=$(this).attr("value");(e.indexOf("LASTNAME")>-1||e.indexOf("FULLNAME")>-1||"Last_Name"===e||"Full_Name"===e)&&($(this).children("#remove").remove(),$(this).children("#add").remove(),$(this).attr("mandatory","true"),$(this).removeAttr("ondblclick onclick"))}))},commonUtils.removeFromMandatory=function(e){var t=!1,r=!1,a=$("#selectedColumns").find("li");a.each((function(){$(this).attr("value")&&($(this).attr("value").indexOf("LASTNAME")>-1||"Last_Name"===$(this).attr("value"))&&(t=!0),$(this).attr("value")&&($(this).attr("value").indexOf("FULLNAME")>-1||"Full_Name"===$(this).attr("value"))&&(r=!0)})),t&&r&&a.each((function(){var t=$(this).attr("value");if($(this).attr("value")&&(t.indexOf("LASTNAME")>-1||t.indexOf("FULLNAME")>-1||"Full_Name"===t||"Last_Name"===t)){$(this).children("#remove").remove(),$(this).children("#add").remove();var r=document.createElement("span");$(r).attr({class:"lArrowIcon dIB fR posRel",id:"remove",onClick:"commonUtils.moveToList(event,"+e+")",style:"display:none;"}),$(this).append(r);var a=document.createElement("span");$(a).attr({id:"add",class:"addArrw dIB fR pA",style:"display:none;",onClick:"commonUtils.moveToSelectedList(event,"+e+")","data-zcqa":"moveToUnselected"}),$(this).append(a),$(this).attr({ondblclick:"commonUtils.moveToListOnDoubleClick(this,"+e+")",onclick:"commonUtils.checkSelectedElements(this,event)"}),$(this).removeAttr("mandatory")}}))},commonUtils.moveToList=function(e){e.stopPropagation();var t=$("#availableList"),r=e.target,a=$(r.parentNode).removeAttr("class");r.setAttribute("style","display : none"),$("li.noFields").length>0&&$(".li.noFields").remove();var i=a.attr("data-index")?a.attr("data-index"):0,n=a.children(".SelectedElement").text(),o=t.find("li"),s=o.length;renderingUtils.fieldsJSONArray.push(n),renderingUtils.fieldsJSONArray.sort(),i=renderingUtils.fieldsJSONArray.indexOf(n),a.addClass("sorl"),i>s&&(i=s),0!=i?o.eq(i-1).after(a):t.prepend(a),$(".availableCol").scrollTo(a),a.stop(!0,!0).animate({backgroundColor:"#fff3ad"}),a.stop(!0,!0).animate({backgroundColor:"white"},{duration:1e3,complete:function(){a.attr("style","margin-left : 11px; margin-right : 11px;")}}),commonUtils.addToMandatory()},commonUtils.moveToSelectedList=function(e,t){e.stopPropagation();var r=e.target,a=$("#selectedColumns");$(r.parentNode).removeClass("selected"),r.setAttribute("style","display:none;");var i=r.parentNode;a.append(i),$(".selectedCol").scrollTo(i),$(i).removeClass("multiselectable-previous selectedElem"),$(i).stop(!0,!0).animate({backgroundColor:"#fff3ad"}),$(i).stop(!0,!0).animate({backgroundColor:"white"},{duration:500,complete:function(){$(i).attr("style","margin-left:11px;margin-right:11px")}});var n=$("#availableList");if(0===n.children().not(".sectionHd").length){var o=document.createElement("li");o.setAttribute("class","nosort noFields"),$(o).html(I18n.getMsg("crm.customview.nofields")),n.append(o)}var s=$(i).children().find(".selectionClass");s.length>0&&$.each(s,(function(e){var t=s[e],r=$(t).text();$(t).replaceWith(r)})),commonUtils.removeFromMandatory(t)},commonUtils.checkSelectedElements=function(e){var t=$("#availableList"),r=t.children().children(".multiMove");r&&r.remove();var a=e.parentNode;if($(e).hasClass("selectedElem")&&!$(e).hasClass("multiselectable-previous")&&!$(e).hasClass("multiselectable-shift")){var i=$(a).attr("id");$("#"+i).children(".selectedElem").not(e).removeClass("multiselectable-previous multiselectable-shift selectedElem")}var n="availableList"===$(a).attr("id")?"selectedColumns":"availableList",o=$("#"+n).children(".selectedElem");if(o.length>0&&o.removeClass("multiselectable-previous multiselectable-shift selectedElem"),"availableList"===$(e).closest("ul").attr("id")){var s=t.find("li.selectedElem"),l=s.length,c=$("#selectedColumns").find("li").length;if(l+c>Search.MAX_COL_CNT)for(var d=Search.MAX_COL_CNT-c;d<l;d++)s.eq(d).removeClass("multiselectable-previous").removeClass("multiselectable-shift").removeClass("selectedElem")}},commonUtils.moveToListOnDoubleClick=function(e){var t=$("#availableList"),r=$("#selectedColumns");if($(e).stop(!0,!0).animate({backgroundColor:"#fff3ad"}),"selectedColumns"===e.parentNode.id){e.removeAttribute("class"),e.children.remove.setAttribute("style","display : none;");var a=$("li.noFields");a.length>0&&a.remove();var i=$(e).children(".SelectedElement").text();renderingUtils.fieldsJSONArray.push(i),renderingUtils.fieldsJSONArray.sort();var n=renderingUtils.fieldsJSONArray.indexOf(i);if(""!==$("#searchField").val()){var o=[];renderingUtils.fieldsJSONArray.filter((function(e){e.search(new RegExp($("#searchField").val(),"i"))>-1&&o.push(e)})),n=o.indexOf(i)}0!==n?t.find("li").eq(n-1).after(e):t.prepend(e),$(".availableCol").scrollTo(e),commonUtils.addToMandatory()}else{if(r.find("li").length>=Search.MAX_COL_CNT)return void $(e).removeClass("multiselectable-previous selectedElem");if(e.children.add.setAttribute("style","display : none;"),r.append(e),0===t.children("li").length){var s=document.createElement("li");s.setAttribute("class","nosort noFields"),$(s).html(I18n.getMsg("crm.customview.nofields")),t.append($(s))}$(".selectedCol").scrollTo(e);var l=$(e).children(".SelectedElement").text();renderingUtils.fieldsJSONArray.removeFirstOccurenceOfElement(l),commonUtils.removeFromMandatory()}$(e).removeClass("multiselectable-previous selectedElem"),$(e).stop(!0,!0).animate({backgroundColor:"white"},{duration:500,complete:function(){$(e).attr("style","margin-left: 11px; margin-right: 11px;")}});var c=$(e.parentNode).children().find(".selectionClass");c.length>0&&$.each(c,(function(e){var t=c[e],r=$(t).text();$(t).replaceWith(r)}))},commonUtils.searchedFields=function(e,t){for(var r=[],a=$(".selectedElem"),i=$("#selectedColumns").find("li").children(".SelectedElement"),n=[],o=i.length,s=0;s<o;s++)n.push(i.eq(s).text());if(t=(t=t.replace(/\(/g,"\\(")).replace(/\)/g,"\\)"),renderingUtils.fieldsJSONArray.filter((function(e){e.search(new RegExp(t,"i"))>-1&&r.push(e)})),a)for(var l={},c=(o=a.length,0);c<o;c++){var d=a.eq(c),u=d.children(".SelectedElement").text();r.contains(u)&&(l[u]=d.attr("class"))}var m=JSON.parse(JSON.stringify(e)),p=!0;if($.each(m[0],(function(e,t){for(var a=function(e){r.contains(e)&&n.indexOf(e)<=-1?p=!1:(t.splice(o,1),o--)},i=t.length,o=0;o<i;o++)$.each(t[o],a)})),commonUtils.setColumnValues(m,!0,l),p){var g=document.createElement("li");$(g).attr({class:"nosort",id:"noRecords"}),$(g).attr("style","font-size:1.5rem;text-align: center;margin-top: 12px;"),$(g).html(I18n.getMsg("crm.customview.nofields.found")),$("#availableList").html(g)}},commonUtils.setColumnValues=function(e,t){var r=document.getElementById("ColumnsListtr");if(!t){var a=document.createElement("div");$(a).attr({class:"relList",style:"width:280px"});var i=document.createElement("div");i.setAttribute("class","pR");var n=document.createElement("input");$(n).attr({style:"width:228px;height:25px; padding: 4px 30px 4px 20px; background: #fff url("+networkUtils.getImageUrl("svgicons_162d5bc_.svg",ResourceConstants.CRM)+") no-repeat 7px -173px;text-indent: 15px;",id:"searchField","data-zcqa":"dash_searchField_chooseColumns",type:"text",autocomplete:"off",onkeyup:"renderingUtils.searchKey(this.value)"});var o=document.createElement("i");$(o).attr({id:"emptySearch",class:"inputDel",style:"display:none;",onclick:"renderingUtils.emptySearchBox()"}),i.appendChild(n),i.appendChild(o),a.appendChild(i);var s=document.createElement("div");s.className="relList";var l=document.createElement("div");l.className="sectionsort selectedCol";var c=document.createElement("ul");$(c).attr({class:"connectedSortable",id:"selectedColumns","data-cid":"selectedColumns"})}if(!a){var d=$("#searchField");d.length>0&&(a=d.parents(".relList")[0])}var u=document.createElement("ul");$(u).attr({class:"sectionsort connectedSortable availableCol","data-cid":"availableList",id:"availableList"});if($.each(e[0],(function(e,r){if(t){if($.isEmptyObject(r[0]))return;$("#availableList").remove()}for(var i=function(e,r){t||renderingUtils.fieldsJSONArray.push(e);var a=r.join(":"),i=document.createElement("li");$(i).attr({class:"sorl",value:a,onclick:"commonUtils.checkSelectedElements(this, event);",ondblclick:"commonUtils.moveToListOnDoubleClick(this, "+t+");",style:"margin-left : 11px; margin-right : 11px;"});var n=document.createElement("span");$(n).attr({class:"SelectedElement",style:"margin-left:0",title:e}),$(n).text(e);var o=document.createElement("span");$(o).attr({class:"lArrowIcon dIB fR posRel",id:"remove",onClick:"commonUtils.moveToList(event, "+t+");",style:"display : none;"}),i.appendChild(o),i.appendChild(n);var s=document.createElement("span");if($(s).attr({id:"add",class:"addArrw dIB fR pA",onClick:"commonUtils.moveToSelectedList(event, "+t+");",style:"display : none;","data-zcqa":"movetoSelected"}),i.appendChild(n),i.appendChild(s),u.appendChild(i),e.indexOf("Last Name")>-1||e.indexOf("Full Name")>-1){var l=document.createElement("sup");$(l).attr({class:"red mL3 top8"}),$(l).html("*"),i.appendChild(l)}},n=r.length,o=0;o<n;o++)null!=r[o]?$.each(r[o],i):(r.splice(o,1),o--);a.appendChild(u)})),!t){for(var m=function(e,r){var a=r.join(":");a=a.substring(0,a.lastIndexOf(":"));var i=document.createElement("li");$(i).attr({class:"pR sorl",value:a,onclick:"commonUtils.checkSelectedElements(this, event);",style:"margin-left : 11px; margin-right : 11px;"});var n=document.createElement("span");if($(n).attr({class:"SelectedElement sdasd",style:"margin-left:0"}),$(n).text(e),i.appendChild(n),a.indexOf(mandatoryfield)>-1||a.indexOf("ACTIVITYTYPE")>-1||a.indexOf("FULLNAME")>-1){i.setAttribute("mandatory","true");var o=document.createElement("sup");$(o).attr({class:"red mL3 top8"}),$(o).html("*"),i.appendChild(o)}else{var s=document.createElement("span");$(s).attr({class:"lArrowIcon dIB fR posRel",id:"remove",onClick:"commonUtils.moveToList(event,"+t+")",style:"display:none;"}),i.appendChild(s);var l=document.createElement("span");$(l).attr({id:"add",class:"addArrw dIB fR pA",style:"display:none;",onClick:"commonUtils.moveToSelectedList(event,"+t+")","data-zcqa":"moveToUnselected"}),i.appendChild(l),i.setAttribute("ondblclick","commonUtils.moveToListOnDoubleClick(this,"+t+")"),i.setAttribute("onclick","commonUtils.checkSelectedElements(this,event)")}c.appendChild(i)},p=e[e.length-1].selectedFieldsJSON,g=p.length,h=0;h<g;h++)p[h]&&$.each(p[h],m);l.appendChild(c),s.appendChild(l);var f=document.createElement("td");f.appendChild(a),r.appendChild(f);var v=document.createElement("td");r.appendChild(v).setAttribute("style","width:15px;");var C=document.createElement("td");C.appendChild(s),r.appendChild(C),commonUtils.removeFromMandatory(t)}renderingUtils.sectionSorting(),$("ul.connectedSortable").find("li").not(".nosort").hover((function(){var e=$(this);e.hasClass("selectedElem")||(e.css({background:"#eee"}),"selectedColumns"===this.parentNode.id?e.children().filter(".lArrowIcon").show():"availableList"===this.parentNode.getAttribute("data-cid")&&e.find(".addArrw").attr("style","display:inline"))}),(function(){var e=$(this);e.css({background:""}),"selectedColumns"===this.parentNode.id?e.children().filter(".lArrowIcon").hide():"availableList"===this.parentNode.getAttribute("data-cid")&&e.find(".addArrw").attr("style","display:none")}))},commonUtils.setColumnValues1=function(e,t,r){var a=document.getElementById("ColumnsListtr"),i=document.createElement("div");$(i).attr({class:"relList",style:"width:280px"});var n=document.createElement("div");n.setAttribute("class","pR");var o=document.createElement("input");$(o).attr({style:"width:228px;height:25px; padding: 4px 30px 4px 20px; background: #fff url("+networkUtils.getImageUrl("svgicons_162d5bc_.svg",ResourceConstants.CRM)+") no-repeat 7px -173px;text-indent: 15px;",id:"searchField","data-zcqa":"dash_searchField_chooseColumns",type:"text",autocomplete:"off",onkeyup:"renderingUtils.searchKey(this, event)"});var s=document.createElement("i");$(s).attr({id:"emptySearch",class:"inputDel",style:"display:none;",onclick:"renderingUtils.emptySearchBox()"}),n.appendChild(o),n.appendChild(s),i.appendChild(n);var l=document.createElement("div");l.className="relList";var c=document.createElement("div");c.className="sectionsort selectedCol";var d=document.createElement("ul");if($(d).attr({class:"connectedSortable",id:"selectedColumns","data-cid":"selectedColumns"}),!i){var u=$("#searchField");u.length>0&&(i=u.parents(".relList")[0])}var m=document.createElement("ul");$(m).attr({class:"sectionsort connectedSortable availableCol","data-cid":"availableList",id:"availableList"});$.each(e[0],(function(e,t){$.each(t,(function(e,t){if(t&&2!==t.display_type&&"PROCESSINGBASIS"!==t.columnname&&"DATASOURCE"!==t.columnname&&"ISCALLBILLABLE"!==t.columnname&&"PRICINGDETAILS"!==t.columnname){var r=t.field_label;renderingUtils.fieldsJSONArray.push(r);r=t.field_label;var a=t.table_name+":"+t.columnname+":"+t.actual_label,i=document.createElement("li");$(i).attr({"data-index":e,class:"sorl cv_sotableList",value:a,onclick:"commonUtils.checkSelectedElements(this, event);",ondblclick:"commonUtils.moveToListOnDoubleClick(this, undefined);",style:"margin-left : 11px; margin-right : 11px;"});var n=document.createElement("span");$(n).attr({class:"SelectedElement",style:"margin-left:0",title:r}),$(n).text(r);var o=document.createElement("span");$(o).attr({class:"lArrowIcon dIB fR posRel",id:"remove",onClick:"commonUtils.moveToList(event, undefined);",style:"display : none;"}),i.appendChild(o),i.appendChild(n);var s=document.createElement("span");if($(s).attr({id:"add",class:"addArrw dIB fR pA",onClick:"commonUtils.moveToSelectedList(event, undefined);",style:"display : none;","data-zcqa":"movetoSelected"}),i.appendChild(n),i.appendChild(s),a.indexOf("LASTNAME")>-1||a.indexOf("FULLNAME")>-1){var l=document.createElement("sup");$(l).attr({class:"red mL3 top8"}),$(l).html("*"),i.appendChild(l)}m.appendChild(i)}}));var r=document.createElement("li");$(r).attr({class:"nosort",id:"noRecords"}),$(r).attr("style","font-size:1.5rem;text-align: center;margin-top: 12px;display:none;"),$(r).html(I18n.getMsg("crm.customview.nofields.found")),m.appendChild(r),i.appendChild(m)})),c.appendChild(d),l.appendChild(c);var p=document.createElement("td");p.appendChild(i),a.appendChild(p);var g=document.createElement("td");a.appendChild(g).setAttribute("style","width:15px;");var h=document.createElement("td");h.appendChild(l),a.appendChild(h),renderingUtils.sectionSorting(),$("ul.connectedSortable").find("li").not(".nosort").hover((function(){var e=$(this);e.hasClass("selectedElem")||(e.css({background:"#eee"}),"selectedColumns"===this.parentNode.id?e.children().filter(".lArrowIcon").show():"availableList"===this.parentNode.getAttribute("data-cid")&&e.find(".addArrw").attr("style","display:inline"))}),(function(){var e=$(this);e.css({background:""}),"selectedColumns"===this.parentNode.id?e.children().filter(".lArrowIcon").hide():"availableList"===this.parentNode.getAttribute("data-cid")&&e.find(".addArrw").attr("style","display:none")}));var f=$("#ColumnsListtr"),v=f.find('li[value="CrmActivity:TAGMODULEREFID:Tag"]');v&&v.length>1&&(v.eq(1).remove(),v.eq(2).remove());for(var C=t.length,y=0;y<C;y++){var E=t[y];if(E){var I=E.table_name+":"+E.columnname+":"+E.actual_label;if(f.find('li[value="'+I+'"]').trigger("dblclick"),I.indexOf(r)>-1||I.indexOf("ACTIVITYTYPE")>-1||I.indexOf("FULLNAME")>-1){var w=$('li[value="'+I+'"]');if(w.attr("mandatory","true"),!(I.indexOf("FULLNAME")>-1||I.indexOf("LASTNAME")>-1)){var T=document.createElement("sup");$(T).attr({class:"red mL3 top8"}),$(T).html("*"),w.append(T)}w.find("#remove").remove(),w.removeAttr("onclick").removeAttr("ondblclick").find("#add").remove()}}}},commonUtils.checkUsernameNeeded=function(e,t,r){var a=Crm.getCrmBasePath()+"/UpdateUsername.do";(new crmRequestPool).initiate({type:"POST",url:a,data:"action=checkUsernameNeeded&service="+t,success:function(a){var i=a.replace(/^\s+|\s+$/g,""),n=$("#shownotes");if(i.length>0){n.html(a),n.addClass("newPopup p30 f17").css({zindex:" 100",position:"absolute"}),freezeBackground();var o=$("#usernameUpdateBtn");o&&"undefined"!==o&&o.click((function(){commonUtils.updateUsername(e,t)}));var s=$("#closeUpdateUsernameId");s&&"undefined"!==r&&"undefined"!==s&&s.click((function(){commonUtils.closeUpdateUsernameDiv(r)})),n.show(),mailsetCenter("shownotes")}else usernameNotNeeded.push(t),e()}})},commonUtils.checkUsernameAvailability=function(){var e=$("#username").val(),t=$("#alertForShortUsername");if(t.hide(),$("#usernameAlerts").hide().removeClass("green mt15 red"),$("#usernamePatternFailed").hide(),e.length<6||e.length>30||!/^[A-Za-z0-9](.*[A-Za-z0-9])?$/.test(e))return t.show(),!1;var r=Crm.getCrmBasePath()+"/UpdateUsername.do?action=checkUsernameAvailability",a="username="+escape(e);loadAjaxTab("","lightblue"),(new crmRequestPool).initiate({type:"POST",url:r,data:a,dataType:"json",success:function(t){commonUtils.showHideLoadingDiv();var r=$("#usernameAlerts");"1004"==t.result?(r.html('"'+$ESAPI.encoder().encodeForHTML(e)+'" '+$("#usernameAlreadyTaken").html()),r.addClass("red mt15"),r.show()):"1007"==t.result?(r.html('"'+$ESAPI.encoder().encodeForHTML(e)+'" '+$("#usernameAlreadyNotTaken").html()),r.addClass("green mt15"),r.show()):"1008"==t.result&&$("#usernameAlreadyTakenError").show()},error:function(){commonUtils.showHideLoadingDiv(),$("#shownotes").css("display","none"),removeFreezeLayer(),freezeBackground(),mailsetCenter("shownotes")}})},commonUtils.showUserNameHints=function(){var e=$("#usernameTable").get(0).offsetWidth+8;$("#tempdiv").css({left:e}).show()},commonUtils.closeUpdateUsernameDiv=function(e){$("#shownotes").hide(),removeFreezeLayer(),void 0!==e&&e()},commonUtils.updateUsername=function(e,t){var r=!0,a=$("#alertForShortUsername"),i=$("#usernameAlerts");"meeting"===t&&(r=!1),a.hide(),$("#usernamePatternFailed").hide(),i.hide().removeClass("green mt15 red");var n=$("#username").val();if(n.length<6||n.length>30||!/^[A-Za-z0-9](.*[A-Za-z0-9])?$/.test(n))return a.show(),!1;var o=Crm.getCrmBasePath()+"/UpdateUsername.do?action=updateUsername",s="username="+escape(n)+"&"+csrfParamName+"="+encodeURIComponent(csrfToken)+"&service="+t;loadAjaxTab("","lightblue"),(new crmRequestPool).initiate({type:"POST",url:o,data:s,async:r,dataType:"json",success:function(t){commonUtils.showHideLoadingDiv();var r=$("#shownotes");r.css("display","none"),removeFreezeLayer(),"1002"==t.result?e():"1004"==t.result||"1005"==t.result?(i.html('"'+$ESAPI.encoder().encodeForHTML(n)+'" '+$("#usernameAlreadyTaken").html()),i.addClass("red mt15").show(),freezeBackground(),mailsetCenter("shownotes")):"1003"==t.result&&(r.html($("#usernameUpdationFailedMsg").html()),r.addClass("newPopup p30 font17").css({zIndex:"21",position:"absolute"}),freezeBackground(),mailsetCenter("shownotes"))},error:function(){var e=$("#shownotes");commonUtils.showHideLoadingDiv(),e.css("display","none"),removeFreezeLayer(),freezeBackground(),mailsetCenter("shownotes")}})},commonUtils.getArrayOfIdsAsCommaSeperatedString=function(e){for(var t=e.length,r="",a=0;a<t;a++)r+=e[a],a!==t-1&&(r+=",");return r},commonUtils.getOrgNameOrSandboxName=function(){return Crm.userDetails.isSandbox?Crm.userDetails.sandboxName:commonUtils.getOrgNameForDisplay(Crm.userDetails.orgName,Crm.currentZgid)},commonUtils.getOrgNameForDisplay=function(e,t){return void 0===e||e.length<0||"-"===e?"org"+t:e},commonUtils.toCamelCase=function(e){if(!e)return e;if('"'===e.charAt(0)&&(e=e.substring(1,e.length)),'"'===e.charAt(e.length-1)&&(e=e.substring(0,e.length-1)),-1!==e.indexOf("("))return e;if(-1===e.indexOf(" "))return e.charAt(0).toUpperCase()+e.substring(1,e.length).toLowerCase();var t=e.split(" "),r=t.length;e="";for(var a=0;a<r;a++)a>0&&(e+=" "),e=e+t[a].charAt(0).toUpperCase()+t[a].substring(1,t[a].length).toLowerCase();return e},commonUtils.copyTextToClipBoard=function(e,t){var r=document.createElement("input");document.getElementById(e).appendChild(r),r.value=t,r.select(),document.execCommand("copy"),r.remove()},commonUtils.unloadModuleRecords=function(e){if(moduleRecordMapping&&e&&moduleRecordMapping[e]){var t=store.peekRecord("module",moduleRecordMapping[e].id).fields;(t=t&&Array.isArray(t)?Array.from(t):t)&&t.forEach((function(e){store.unloadRecord("field",e.id)}))}},commonUtils.removeElements=function(e){for(var t=e.length,r=0;r<t;r++)e[r].remove()};var clienttab={browserTabId:Date.now()+"",ismaster:!1,isslave:!1,incall:!1,showAlertBeforeUnload:!1,listener:function(){window.addEventListener("storage",(function(e){null!==e.key&&("MasterTabId"===e.key&&null==localStorage.getItem("MasterTabId")&&(null!=localStorage.getItem("SlaveTabId")?localStorage.getItem("SlaveTabId")==clienttab.browserTabId:clienttab.isslave)?(clienttab.ismaster=!0,localStorage.setItem("MasterTabId",clienttab.browserTabId),localStorage.removeItem("SlaveTabId"),CTIAPI.makeConnection(),clienttab.isslave=!1):clienttab.ismaster||"SlaveTabId"!==e.key||null!=localStorage.getItem("SlaveTabId")?clienttab.ismaster||"SlaveTabId"!==e.key||null==localStorage.getItem("SlaveTabId")||e.newValue==clienttab.browserTabId?"MasterTabId"===e.key&&e.oldValue==clienttab.browserTabId?(clienttab.incall||(CTIAPI.destroyConnection(),clienttab.ismaster=!1),clienttab.isslave=!0,localStorage.setItem("SlaveTabId",clienttab.browserTabId)):e.key.includes("call")&&CTIAPI.trigger_event(e):clienttab.isslave=!1:(localStorage.setItem("SlaveTabId",clienttab.browserTabId),clienttab.isslave=!0))}))},tabinitializer:function(){try{"inbound"==localStorage.getItem("incall")||"outbound"==localStorage.getItem("incall")?(localStorage.setItem("SlaveTabId",clienttab.browserTabId),clienttab.isslave=!0):(localStorage.setItem("MasterTabId",clienttab.browserTabId),clienttab.ismaster=!0),window.addEventListener("unload",(function(){clienttab.ismaster?(null==localStorage.getItem("MasterTabId")&&localStorage.setItem("MasterTabId","0"),localStorage.removeItem("MasterTabId")):clienttab.isslave&&(null==localStorage.getItem("SlaveTabId")&&localStorage.setItem("SlaveTabId","0"),localStorage.removeItem("SlaveTabId")),clienttab.incall&&localStorage.removeItem("incall")})),window.onbeforeunload=function(){if(clienttab.incall||clienttab.showAlertBeforeUnload)return""},clienttab.listener()}catch(e){clienttab.ismaster=!0,murphy.error(e)}}};$(document).ready((function(){try{if(navigator.userAgent.indexOf("Firefox")>-1?clienttab.ismaster=!0:clienttab.tabinitializer(),!clienttab.ismaster&&"inbound"==localStorage.getItem("incall")){var e=$("#callrefid").val();"inRinging"==CTIAPI.get("twiCurrentStatus")&&"true"==$("#ctinotifier").attr("is")&&twilioCallDetails.hasOwnProperty(e)&&"ringing"==twilioCallDetails[e].status&&$("#ctiapi_twilio_call_ctrl_bts").show()}}catch(e){murphy.error(e)}})),notifyParentWindow=function(e){var t=e.messageType;if(validationUtils.isNotEmpty(t)&&-1!==Object.keys(messageTypeVsAllowedParentDomains).indexOf(t)){var r=commonUtils.getHeadLessCallbackCode();validationUtils.isNotEmpty(r)&&(e.callbackcode=r);for(var a=messageTypeVsAllowedParentDomains[t],i=a.length,n=0;n<i;n++){var o;try{o=window.parent.location.href}catch(e){o=document.referrer}var s=a[n];if(o.startsWith(s)){e=JSON.stringify(e),window.parent.postMessage(e,s);break}}}},notifyChildWindow=function(e){var t=e.messageType;if(validationUtils.isNotEmpty(t)&&-1!==Object.keys(messageTypeVsAllowedParentDomains).indexOf(t)){var r;r=e.featurename?document.getElementsByClassName("childwindow"+e.featurename)[0]:document.getElementById("childwindow_"+e.iframeId);for(var a=messageTypeVsAllowedParentDomains[t],i=a.length,n=0;n<i;n++){var o=a[n];if(r&&r.src.startsWith(o)){e=JSON.stringify(e),r.contentWindow.postMessage(e,o);break}}}},window.addEventListener("message",(function(e){var t="string"==typeof e.data?JSON.parse(e.data):e.data;if(validationUtils.isJson(t)&&"undefined"!=typeof inputtableMessageTypeVsDetails&&-1!==Object.keys(inputtableMessageTypeVsDetails).indexOf(t.messageType)){if(-1===inputtableMessageTypeVsDetails[t.messageType].allowedDomains.indexOf(e.origin))return;switch(t.messageType){case"fields-value-collector":ctiApiNotifier.saveCallFieldsParamFromFrame(t),WindowsCommunicator.hideChildWindow("callfieldspopup_"+t.callbackcode);break;case"cancel-operation":WindowsCommunicator.hideAllChildWindows("callnotifypopup");break;case"crm-followup-create":ctiApiNotifier.followupListner(t,!0),WindowsCommunicator.hideAllChildWindows("callnotifypopup");break;case"error":ctiApiNotifier.handleFieldsCollectorError(t),WindowsCommunicator.closeAllChildWindows("callnotifypopup");break;case"get-pbcall-info":var r={};"getCallBackParam"===t.action&&(r={data:ctiApiNotifier.getCallBackparam(),action:"setCallBackParam"}),WindowsCommunicator.notifyChild("set-pbcall-info",r,"callnotifypopup");break;case"update-pbcall-info":"updateCallBackParam"===t.action&&(ctiApiNotifier.updateCallBackparam(t.data,t.callbackcode),WindowsCommunicator.hideAllChildWindows("callnotifypopup"));break;case"set-pbcall-info":"setCallBackParam"===t.action&&Calls.resolveWindowsCommunication(t.data);break;case"switch-router-instance":WindowsCommunicator.routerTransition(t.routerData)}}}),!1),window.addEventListener("storage",(function(e,t){switch(e.key){case"call-popup-remove-callfields-link":t=localStorage.getItem(e.key),ctiApiNotifier.removeCallFieldslink(t);break;case"call-popup-update-callfields-data":var r=localStorage.getObject(e.key);ctiApiNotifier.updateCallFieldsData(r);break;case"get-call-back-param":if(t=localStorage.getObject(e.key),!Crm.isHeadless&&t&&(clienttab.isslave||localStorage.getItem("incall")&&clienttab.master)){var a={id:t.id,callBackParam:ctiApiNotifier.getCallBackparam(),followUpData:ctiApiNotifier.followUpData,durationData:{min:$("#ctiapi_calltimer_min").text(),sec:$("#ctiapi_calltimer_sec").text(),Minute:CTIAPI.CallTimer.Minute,Second:CTIAPI.CallTimer.Second,callStartedTimeInMilliSeconds:CTIAPI.CallTimer.callStartedTimeInMilliSeconds,callPausedTimeInMilliSeconds:CTIAPI.CallTimer.callPausedTimeInMilliSeconds},tabId:t.tabId};localStorage.setObject("set-call-back-param",a),setTimeout((function(){localStorage.removeItem("get-call-back-param")}),0)}break;case"set-call-back-param":t=localStorage.getObject(e.key),!Crm.isHeadless&&t&&clienttab.browserTabId===t.tabId&&(ctiApiNotifier.setCallPopupData(t),setTimeout((function(){localStorage.removeItem("set-call-back-param")}),0));break;case"imNotificationMessage":var i=document.querySelector("crm-msg-push-notify");i&&i.setData("removeAll",!0)}}));var WindowsCommunicator={messageTemplate:{getSuccessMsgJson:function(){return{message:"success",status:"saved"}},getCancelledMsgJson:function(){return{message:"close"}},getErrorMsgJson:function(e){return{message:"error",Details:e}},getFieldsCollectorSuccessMsg:function(e){return{message:"success",status:"not_saved",Details:e}},getSuccessMsgWithEntityInfo:function(e){return{message:"success",status:"saved",Details:{module:e.module,recordid:e.id,recordname:e.name}}},getSuccessMsgForFollowUp:function(e){var t=e.module,r=null;-1!==["Events","Tasks","Calls"].indexOf(e.module)&&(t="Activities",r=e.module);var a=Utils.getCurrentDomain()+Crm.getCrmBasePath()+"/tab/"+t+"/"+e.id;return r&&(a=a+"?sub_module="+r),{message:"success",status:"saved",RecordName:e.name,Details:{module:e.module,recordid:e.id,recordname:e.name,recordurl:a}}},getActionMessage:function(e){return{data:e.data,action:e.action}},getUpdateActionMessage:function(e){return{message:"success",data:e.data,action:e.action}},getSwitchRouterInstanceData:function(e){return{routerData:e.routerData}}},notifyParent:function(e,t,r){if(Crm.isHeadless){var a;switch(e){case"fields-value-collector":a=WindowsCommunicator.messageTemplate.getFieldsCollectorSuccessMsg(r);break;case"crm-quick-create":case"crm-associate-search":a=WindowsCommunicator.messageTemplate.getSuccessMsgWithEntityInfo(t);break;case"crm-followup-create":a=WindowsCommunicator.messageTemplate.getSuccessMsgForFollowUp(t);break;case"cancel-operation":a=WindowsCommunicator.messageTemplate.getCancelledMsgJson();break;case"error":a=WindowsCommunicator.messageTemplate.getErrorMsgJson(r);break;case"get-pbcall-info":a=WindowsCommunicator.messageTemplate.getActionMessage(r);break;case"update-pbcall-info":a=WindowsCommunicator.messageTemplate.getUpdateActionMessage(r)}a.messageType=e,notifyParentWindow(a)}},notifyChild:function(e,t,r){var a;switch(e){case"set-pbcall-info":a=WindowsCommunicator.messageTemplate.getActionMessage(t);break;case"switch-router-instance":a=WindowsCommunicator.messageTemplate.getSwitchRouterInstanceData(t)}a.featurename=r,a.messageType=e,notifyChildWindow(a)},notifyOtherTabs:function(e,t){"string"==typeof t?localStorage.setItem(e,t):localStorage.setObject(e,t)},createChildWindow:function(e,t,r){var a=$("#childwindow_"+t.removeSpecialChars());if(a.length>0)a.show();else{var i=document.createElement("iframe");i.setAttribute("src",e),i.setAttribute("id","childwindow_"+t.removeSpecialChars()),i.setAttribute("class","childwindow"+r),i.setAttribute("name","childwindow"),i.style.cssText="border-width:0px; position:fixed; z-index:400; top:0; left:0; width:100%; height:100%;",i.style.visibility="hidden",document.body.appendChild(i),commonUtils.showHideLoadingDiv(!0),i.onload=function(){commonUtils.showHideLoadingDiv(),e.startsWith("/crm")&&$(i.contentDocument.getElementsByTagName("body")[0]).css("background-color","transparent"),i.style.visibility="visible"}}},reopenChildWindow:function(e){var t=$("#childwindow_"+e.removeSpecialChars());return t.length>0&&(t.show(),!0)},hideChildWindow:function(e){$("#childwindow_"+e.removeSpecialChars()).hide()},hideAllChildWindows:function(e){$(".childwindow"+e).hide()},closeAllChildWindows:function(e){$(".childwindow"+e).remove()},closeChildWindow:function(e){$("#childwindow_"+e.removeSpecialChars()).remove()},switchRouterInstance:function(e,t,r,a){var i=$(".childwindow"+r);i.length<1&&e&&t&&r?this.createChildWindow(e,t,r):(this.notifyChild("switch-router-instance",{routerData:a},r),i.show())},routerTransition:function(e){Lyte.Router.checkIfSameRoute(Lyte.Router.getRouteInstance().transition.info,e)?Lyte.Router.getRouteInstance().refresh({refreshTemplate:!0}):e&&Lyte.Router.replaceWith(e)}};RebrandLinkUtil={properties:void 0,setProperties:function(e){this.properties=e},getProperties:function(){return this.properties},getProperty:function(e){if(this.properties)return this.properties[e]}};var crmPopupUtils={getPrimaryButton:function(e,t,r){return crmPopupUtils.getButtonJson("primarybtn",e,!1,t,r)},getDisabledPrimaryButton:function(e,t,r,a){var i=crmPopupUtils.getButtonJson("primarybtn",t,!0,r,a);return i.id=e,i},getOkButton:function(e,t){return crmPopupUtils.getButtonJson("newgraybtn",I18n.getMsg("crm.button.ok"),!1,e,t)},getCancelButton:function(e,t){return crmPopupUtils.getButtonJson("newgraybtn",I18n.getMsg("crm.button.cancel"),!1,e,t)},getCloseButton:function(e,t){return crmPopupUtils.getButtonJson("newgraybtn",I18n.getMsg("crm.button.close"),!1,e,t)},getRedButton:function(e,t,r){return crmPopupUtils.getButtonJson("redbtn",e,!1,t,r)},getButtonJson:function(e,t,r,a,i){var n={};return n.class_type=e,n.value=t,n.disabled=r,n.click_text=a,n.attributes=i,n},getHeader:function(e,t,r,a,i){var n={};return n.id=e,n.title=t,n.subtext=r,n.width=a,n.classes=i,n},getFooter:function(e,t){var r={};return r.alignment=e,r.buttons=t,r},getPopUpJson:function(e,t,r){var a={};return a.header=e,a.body=t,a.footer=r,a},removePopup:function(e){removeFreezeLayer(),$("body").find("#"+e).remove()},showPopup:function(e,t){$("body").append(Handlebars.templates.PopupLayout(t)),crmui.showPopup(e)},hidePopup:function(e){crmui.hidePopup(e)}},CustomView={maxFav:10};CustomView.selectedFavorites,CustomView.curElem,CustomView.offset,CustomView.divObj,CustomView.timeoutValue,CustomView.curFavoriteNo,CustomView.beingSorted=!1,CustomView.sharedData="",CustomView.folderData="",CustomView.orgTerritoryId="",CustomView.initFavorite=function(){$("#newVListPop").find("li").click((function(){if(!CustomView.beingSorted){var e=$(this),t=$(".SelectedPortal"),r=e.attr("siqportal"),a=e.text();"All Portals"==r?t.text(I18n.getMsg("crm.salesiq.all.accounts")):t.text(a),t.attr("siqportal",r);var i=Lyte.Router.getRouteInstance();"crm.tab.module.begin"===i.transition.target?i.transitionTo("crm.tab.module.custom-view.list","Visits",$("lyte-dropdown[data-zcqa=SelectedOption]")[0].ltProp("selected")):i.refresh()}CustomView.beingSorted=!1}))},CustomView.showVTPortaldd=function(e){var t=$(e),r=parseInt(t.innerHeight())+parseInt(t.offset().top)+2,a=parseInt(t.offset().left),i=$("#vtddId");(i.css({left:a,top:r}),i.toggle(),i.length&&i.is(":visible"))&&($("#PLSearchBox").focus(),$("#PLSearchBox input").focus(),renderingUtils.scrollPrevent("#vtddId"))},CustomView.checkFavoriteMaxLimit=function(){$("#curFavoritesNo").val()>=CustomView.maxFav&&$("#setFavorite").hasClass("emptyStar")&&"true"!==$("#isFavorite").val()&&(alert(I18n.getMsg("crm.alert.favorite.reached.maxlimit",CustomView.maxFav.toString())),$("#setFavorite").prop("checked",!1));var e=$("#setFavorite");if(e.hasClass("selectedStar"))e.removeClass("selectedStar").addClass("emptyStar"),CustomView.selectedFavorites--;else if(e.hasClass("emptyStar")){if(CustomView.curFavoriteNo+CustomView.selectedFavorites>=CustomView.maxFav)return void alert(I18n.getMsg("crm.alert.favorite.reached.maxlimit",CustomView.maxFav.toString()));e.removeClass("emptyStar").addClass("selectedStar"),CustomView.selectedFavorites++}},CustomView.checkOnhoverFavIcon=function(e,t){e=e;"enter"===t?e.addClass("cv_starEnter"):"leave"===t&&e.removeClass("cv_starEnter")},CustomView.deleteCV=function(e,t){var r=store.peekRecord("custom_view",e),a=moduleRecordMapping[t].api_name;store.deleteRecord("custom_view",e),r.$.save({module:a,ids:e}).then((function(){var e=new crmRequestPool;crmTab.deleteFromCache(t);var r={};r[csrfParamName]=csrfToken,moduleRecordMapping[t].canvas_view||moduleRecordMapping[t].kanban_view?e.initiate({action:Crm.getCrmBasePath()+"/ShowDetails.do?module="+t+"&isload=false&retrievejson=true",data:r,type:"POST",dataType:"json",success:function(e){if(e.body&&0!=e.body.length){for(var r=[],a=e.fromIndex-1,i=0;a<=e.toIndex;a++,i++)e.body[i]?r[a]=e.body[i]:r[a]=null;e.body=r}delete crmTab.countCache[t],crmTab.putInCache(t,e),hideAnimatePopup("deletepopup"),moduleRecordMapping[t].cvid=e.cvId;var n=moduleRecordMapping[t].canvas_view?"canvas":"kanban";Lyte.Router.transitionTo({route:"crm.tab.module.custom-view."+n,dynamicParams:[e.module,e.cvId,e.viewid]}).data={cachedData:e}}}):(store.unloadAll(moduleRecordMapping[t].id),store.findAll("custom_view",{module:a}).then((function(e){moduleRecordMapping[t].cvid=e.$.meta.default,Lyte.Router.transitionTo({route:"crm.tab.module.custom-view.list",dynamicParams:[t,moduleRecordMapping[t].cvid]})})))}))},CustomView.formSelectColumnString=function(){var e=document.createElement("FORM");e.setAttribute("id","UpdateCustomView");for(var t=$("#columnList input:checked"),r=0,a=1;r<t.length;r++,a++){var i=t[r],n=document.createElement("INPUT"),o=$(i).val();$(n).attr({type:"hidden",name:"col"+a,value:o}),$(e).append(n)}return e},CustomView.bindMultiSelectLookup2=function(e,t,r){var a={};a.placeholder_text_multiple=I18n.getMsg("crm.module.name",I18n.getMsg(moduleRecordMapping[e].singular_label)),a.maximum_result_text=I18n.getMsg("crm.chosen.maximum.campaigns.selected",e),a.maximumSelectionLength=5,a.minimumInputLength=2;var i={url:"/crm/v2/"+moduleRecordMapping[e].api_name+"/search",dataType:"json",delay:1e3,type:"GET",dispColn:r,headers:{"X-ZCSRF-TOKEN":csrfParamName+"="+csrfToken,Range:"1-50"},data:CustomView.campaignSelect2DataFunction,processResults:CustomView.campaignSelect2ResultsFunction};a.ajax=i,thirdPartyUtils.bindSelect2(t,a)},CustomView.campaignSelect2DataFunction=function(e){var t=$(this).closest("div").find("input[type=text]").data("dispsysrefname");t||(t="Campaign_Name");var r="("+t+":starts_with:"+e.term.trim().replace(/([<>*()?\\])/g,"\\$1")+")";if("Campaign_Name"==t){var a=$("#campaign_status_sel").val();""!=a&&(r="("+r+" and (Status:equals:"+a+"))");var i=$("#campaign_type_sel").val();""!=i&&(r="("+r+" and (Type:equals:"+i+"))")}var n={};return n.criteria=r,n},CustomView.campaignSelect2ResultsFunction=function(e){var t=$(this).attr("ajaxOptions").dispColn,r={};return e&&e.data?r.results=$.map(e.data,(function(e){return{text:e[t],id:e.id}})):r.results=[],r},CustomView.populateSelectedCampaignNames=function(e){for(var t=$("#campaign_name_select"),r=e.length,a=renderingUtils.createHTML(o),i=0;i<r;i++){var n=e[i],o={name:"option",attr:{value:n.id,selected:!0},child:[{name:"text",content:n.Campaign_Name}]};t.append($(a))}},CustomView.populateSelectedMxNNames=function(e,t){var r=$("#"+t);$(r).children().remove();for(var a=e.length,i=renderingUtils.createHTML(s),n=0;n<a;n++){var o=e[n],s={name:"option",attr:{value:o.id,selected:!0},child:[{name:"text",content:o.value}]};r.append($(i))}},CustomView.campaignNameOnChange=function(e){var t=e.id,r=$(e).val(),a=validationUtils.isNotEmpty(r);CustomView.showOrHideMemberStatusDiv(a),$("#"+t+" option:not(:selected)").remove(),setTimeout((function(){$("#"+t)&&thirdPartyUtils.closeSelect2(t)}),100)},CustomView.campaignNameReset=function(){$("#campaign_name_select").val("").trigger("change").html("")},CustomView.showOrHideMemberStatusDiv=function(e){var t=$("#campaign_type_sel").val(),r=$("#camp_member_status_div");if(e){if(r.hasClass("dN")){var a={};a.status_val=crmListView.getObject().modulePicklistValues["Campaign Members"].MEMBERSTATUS;var i=Handlebars.templates.MemberStatusForFilters(a),n=$("#camp_member_status_sel");n.html(i),thirdPartyUtils.bindSelect2(n,{placeholder_text_single:I18n.getMsg("crm.lead.select.status","Member")}),r.addClass("dB").removeClass("dN")}}else r.addClass("dN").removeClass("dB");var o=$("#camp_service_status_div");if(e){if(o.hasClass("dN")){var s={},l=["Zoho Backstage","Zoho Webinar","Zoho Campaigns","Zoho Survey"],c=[],d={"Zoho Campaigns":["Hard Bounced","Clicked","Marked As Spam","Opened","Opted Out","Replied","Sent","Skipped","Yet to Send","Soft Bounced"],"Zoho Webinar":["Attended","Invited","Registered"],"Zoho Backstage":["Cancelled","Checked in","Invited","Purchased","Yet to check in"],"Zoho Survey":["Completed","Visited","Yet to visit"]};if(t&&l.contains(t))s.status_val=d[t];else{if(""!==t)return void o.addClass("dN").removeClass("dB");for(var u=crmListView.getObject().modulePicklistValues.Campaigns.TYPE,m=l.length,p=0;p<m;p++)u.contains(l[p])&&(c=c.concat(d[l[p]]));s.status_val=[...new Set(c.sort())]}var g=Handlebars.templates.MemberStatusForFilters(s),h=$("#camp_service_status_sel");h.html(g),thirdPartyUtils.bindSelect2(h,{placeholder_text_single:I18n.getMsg("crm.lead.select.status","Service")}),o.addClass("dB").removeClass("dN")}}else o.addClass("dN").removeClass("dB")},CustomView.populateCampaigns=function(){var e={},t=$(this);e.id=t.val(),e.Campaign_Name=t.text(),crmListView.selectedCampaigns.push(e)},CustomView.showCampSubMenu=function(e,t){var r,a,i=$(e),n=crmui.getOffset(i),o=i.outerWidth(),s=n.top,l=n.left+o;sE(event),Crm.menu.globalHideMenu(),"detailQuickCreate"===t||"detailCreate"===t||"leftPanelRLCreate"===t?(r=returnJson.Campaigns.campaignLayoutSubMenu,a=returnJson.Campaigns.showCampaignLayoutSubmenu):(r=customViewObject.campaignLayoutSubMenu,a=customViewObject.showCampaignLayoutSubmenu);var c={};c.campLayoutSubMenu=r,c.showCampaignLayoutSubmenu=a,c.from=t;var d=i.data("relid");if(a){"detailQuickCreate"!==t&&"detailCreate"!==t&&"leftPanelRLCreate"!==t||(c.rid=d);var u=$("#zCampOpiontDD_"+t);if(0===u.length){var m=Handlebars.templates.campaignCreateSubMenu(c);if("leftPanelRLCreate"===t?$("#show").append(m):i.after(m),thirdPartyUtils.titleForEllipsis(".zCampLayoutName"),u=$("#zCampOpiontDD_"+t),"detailQuickCreate"===t||"detailCreate"===t){u.removeClass("zCampArrowOnRight"),i.closest("div").addClass("pR");var p=i.position().left+o;$("#"+c.rid).find(".norec").length?Crm.userDetails.detailView_newUI?"detailQuickCreate"===t?u.addClass("zCampOpiontDDArrow zCampOpiontDD_"+t).css({left:p+5}):"detailCreate"===t&&(p=i.position().left-u.outerWidth(),u.addClass("zCampOpiontDDArrow zCampArrowOnRight zCampOpiontDD_"+t).css({left:p+10,top:"-5px"})):u.addClass("zCampOpiontDDArrow zCampOpiontDD_"+t+"  zCampOptNorec").css({left:o+5}):"detailQuickCreate"===t?u.addClass("zCampOpiontDDArrow zCampOpiontDD_"+t).css({left:p+5}):"detailCreate"===t&&(p=i.position().left-u.outerWidth(),u.addClass("zCampOpiontDDArrow zCampArrowOnRight zCampOpiontDD_"+t).css({left:p+10,top:"-5px"}))}else if("listViewCreate"===t){var g=$("#importDiv");g.is(":visible")&&g.slideUp(100)}else"leftPanelRLCreate"===t&&(i.closest("li").addClass("whiteBg"),u.addClass("zCampOptionDDRL").css({top:s,left:l}))}var h=getElemById("zIntegNewNotifyCircle"),f=getElemById("zCampOpiontDD_listViewCreate");h&&f&&h.classList.add("dN")}else if("detailQuickCreate"===t)crmListView.createNewCampaignwithMembers(event,e);else if("detailCreate"===t)crmRelatedList.createNewChildCampaign(event);else if("leftPanelRLCreate"===t){$("div[ddid="+d+"]").find(".dummyForLeftPanel")[0].click()}else Lyte.Router.transitionTo("crm.tab.module.create","Campaigns",{})},CustomView.showhideotherviews=function(e){var t=$(e),r=$("#cvlist"),a=!1;r.length||(a=!0,r=t.closest(".cvlist"));var i=t.find(".othersdownicon"),n=r.find(".otherViewsUl"),o=$("#cvList"),s=a?o.scrollTop():r.scrollTop();i.hasClass("ico-arrow-down-solid-small")?(n.show(),s=s+n.height()+5,i.removeClass("ico-arrow-down-solid-small").addClass("ico-arrow-up-solid-small")):(s-=n.height(),n.hide(),i.removeClass("ico-arrow-up-solid-small").addClass("ico-arrow-down-solid-small")),a?o.css("transition","0.3s all ease").scrollTop(s):r.css("transition","0.3s all ease").scrollTop(s)},CustomView.getShowFolderSharingDetails=function(){var e={},t=[],r={type:"ActiveUsers",include_lite_users:!0};if(t.push({name:I18n.getMsg("crm.security.public.groups"),model_name:"user_group",idSelector:"id",prefix:"G",nameSelector:"name",pagination:!1,cxPropEmptyDataMsg:I18n.getMsg("crm.label.no.groups.available")}),t.push({name:I18n.getMsg("crm.security.users"),model_name:"user",idSelector:"id",nameSelector:"full_name",prefix:"U",imageSelector:"image_link",descriptionSelector:"email",pagination:!0,setSearchCriteria:"",cxPropQueryParams:r,cxPropEmptyDataMsg:I18n.getMsg("crm.label.no.users.available")}),t.push({name:I18n.getMsg("crm.security.roles"),model_name:"role",idSelector:"id",prefix:"R",nameSelector:"display_label",pagination:!1,cxPropEmptyDataMsg:I18n.getMsg("crm.label.no.roles.available")}),t.push({name:I18n.getMsg("crm.security.roles.subordinates"),model_name:"role",idSelector:"id",prefix:"RS",nameSelector:"name",pagination:!1,cxPropEmptyDataMsg:I18n.getMsg("crm.label.no.roles.subordinates.available")}),CustomView.territoryEnabled){var a=[];""!==CustomView.orgTerritoryId&&a.push(CustomView.orgTerritoryId),t.push({name:I18n.getMsg("crm.territory.territories"),model_name:"territory",idselector:"id",prefix:"T",nameSelector:"name",pagination:!1,cxPropEmptyDataMsg:I18n.getMsg("crm.label.no.territory.available"),cxPropExclude:a}),t.push({name:I18n.getMsg("crm.label.territories.and.subordinates"),model_name:"territory",idselector:"id",prefix:"TS",nameSelector:"name",pagination:!1,cxPropEmptyDataMsg:I18n.getMsg("crm.label.no.territory.subordinates.available"),cxPropExclude:a})}e.showSharingModels=t,e.selectedItems={},e.configType="customView",null!=CustomView.sharedData&&""!=CustomView.sharedData&&(e.selectedItems=CustomView.sharedData),store.findAll("field",{module:"users"}).then((function(t){if(e.isFirstNameFieldAvailable=!1,t&&null!=t)for(var r=t.length,a=0;a<r;a++)if("first_name"===t[a].api_name){e.isFirstNameFieldAvailable=!0;break}var i=$("#folderSharingTemplate");null!=i&&i.length>0&&i[0].remove();var n=Lyte.Component.render("crm-folder-sharing",e,"body");n.id="folderSharingTemplate";var o=n.getElementsByTagName("crux-combo-box")[0];o.cxProp("maxLimit",500),o.cxProp("show",!0),o.cxProp("headerMsg",I18n.getMsg("crm.label.rejection.send.alert.users"))}))},CustomView.showSharedDetails=function(e,t,r){var a=$(e);$(".shareWithLabel").removeClass("selectshare"),a.closest(".shareWithLabel").addClass("selectshare");var i=$("#folderInfo").find("span");"allowedUsers-all"==t?i.removeClass("shareOnlyMeIcon").addClass("shareUserIcon"):"allowedUsers-noUsers"==t?i.removeClass("shareUserIcon").addClass("shareOnlyMeIcon"):"allowedUsers-selected"==t&&i.removeClass("shareOnlyMeIcon").addClass("shareUserIcon");var n=$("#shared_details");if(r){null!=CustomView.sharedData&&0!=CustomView.sharedData.length&&n.css("display","inline-block");var o=n.find("ul").find("li");(1!=o.length||o.text()!==I18n.getMsg("crm.label.no.selected.users.available"))&&0!=o.length||null!=CustomView.sharedData&&""!=CustomView.sharedData||CustomView.getShowFolderSharingDetails()}else n.css("display","none")};var $namespace=function(e,t,r){var a,i,n=e.split(t||"."),o=r||window;for(a=0,i=n.length;a<i;a++)o=o[n[a]]=o[n[a]]||{};return o},$type=function(e,t){if(!e instanceof t)throw new SyntaxError};if(Array.prototype.each||(Array.prototype.each=function(e){if("function"!=typeof e)throw"Illegal Argument for Array.each";for(var t=0;t<this.length;t++)e(this[t])}),Array.prototype.contains||(Array.prototype.contains=function(e){var t=!1;return this.each((function(r){(e.equals&&e.equals(r)||r==e)&&(t=!0)})),t}),Array.prototype.containsKey||(Array.prototype.containsKey=function(e){for(var t in this)if(t.toLowerCase()==e.toLowerCase())return!0;return!1}),Array.prototype.getCaseInsensitive||(Array.prototype.getCaseInsensitive=function(e){for(var t in this)if(t.toLowerCase()==e.toLowerCase())return this[t];return null}),String.prototype.charCodeAt||(String.prototype.charCodeAt=function(e){for(var t=this.charAt(e),r=0;r<65536;r++){if(String.fromCharCode(r)==t)return r}return 0}),String.prototype.endsWith||(String.prototype.endsWith=function(e){return this.substr(this.length-e.length,e.length)==e}),!Exception){var Exception=function(e,t){this.cause=t,this.errorMessage=e};Exception.prototype=Error.prototype,Exception.prototype.getCause=function(){return this.cause},Exception.prototype.getMessage=function(){return this.message},Exception.prototype.getStackTrace=function(){if(this.callstack)return this.callstack;if(this.stack){for(var e=0,t=(r=stack.split("\n")).length;e<t;e++)r[e].match(/^\s*[A-Za-z0-9\=+\$]+\(/)&&this.callstack.push(r[e]);return this.callstack.shift(),this.callstack}if(window.opera&&this.message){var r;for(e=0,t=(r=this.message.split("\n")).length;e<t;e++)if(r[e].match(/^\s*[A-Za-z0-9\=+\$]+\(/)){var a=r[e];r[e+1]&&(a+=" at "+r[e+1],e++),this.callstack.push(a)}return this.callstack.shift(),this.callstack}for(var i=arguments.callee.caller;i;){var n=i.toString(),o=n.substring(n.indexOf("function")+8,n.indexOf("("))||"anonymous";this.callstack.push(o),i=i.caller}return this.callstack},Exception.prototype.printStackTrace=function(e){var t=this.getMessage()+"|||"+this.getStackTrace().join("|||");return this.cause&&this.cause.printStackTrace&&(t+="||||||Caused by "+this.cause.printStackTrace().replace("\n","|||")),e?void(e.value?e.value=t.replace("|||","\n"):e.writeln?e.writeln(t.replace("|||","\n")):e.innerHTML?e.innerHTML=t.replace("|||","<br/>"):e.innerText?e.innerText=t.replace("|||","<br/>"):e.append?e.append(t.replace("|||","\n")):e instanceof Function&&e(t.replace("|||","\n"))):e.replace("|||","\n")}}if(!RuntimeException)var RuntimeException=Exception;if(!IllegalArgumentException)var IllegalArgumentException=Exception;if(!DateFormat){var DateFormat=function(e){var t=e,r={longMonths:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longDays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],d:function(e){return(e.getDate()<10?"0":"")+e.getDate()},D:function(e){return r.shortDays[e.getDay()]},j:function(e){return e.getDate()},l:function(e){return r.longDays[e.getDay()]},N:function(e){return e.getDay()+1},S:function(e){return e.getDate()%10==1&&11!=e.getDate()?"st":e.getDate()%10==2&&12!=e.getDate()?"nd":e.getDate()%10==3&&13!=e.getDate()?"rd":"th"},w:function(e){return e.getDay()},z:function(e){return"Not Yet Supported"},W:function(e){return"Not Yet Supported"},F:function(e){return r.longMonths[e.getMonth()]},m:function(e){return(e.getMonth()<9?"0":"")+(e.getMonth()+1)},M:function(e){return r.shortMonths[e.getMonth()]},n:function(e){return e.getMonth()+1},t:function(e){return"Not Yet Supported"},L:function(e){return e.getFullYear()%4==0&&e.getFullYear()%100!=0||e.getFullYear()%400==0?"1":"0"},o:function(e){return"Not Supported"},Y:function(e){return e.getFullYear()},y:function(e){return(""+e.getFullYear()).substr(2)},a:function(e){return e.getHours()<12?"am":"pm"},A:function(e){return e.getHours()<12?"AM":"PM"},B:function(e){return"Not Yet Supported"},g:function(e){return e.getHours()%12||12},G:function(e){return e.getHours()},h:function(e){return((e.getHours()%12||12)<10?"0":"")+(e.getHours()%12||12)},H:function(e){return(e.getHours()<10?"0":"")+e.getHours()},i:function(e){return(e.getMinutes()<10?"0":"")+e.getMinutes()},s:function(e){return(e.getSeconds()<10?"0":"")+e.getSeconds()},e:function(e){return"Not Yet Supported"},I:function(e){return"Not Supported"},O:function(e){return(-e.getTimezoneOffset()<0?"-":"+")+(Math.abs(e.getTimezoneOffset()/60)<10?"0":"")+Math.abs(e.getTimezoneOffset()/60)+"00"},P:function(e){return(-e.getTimezoneOffset()<0?"-":"+")+(Math.abs(e.getTimezoneOffset()/60)<10?"0":"")+Math.abs(e.getTimezoneOffset()/60)+":"+(Math.abs(e.getTimezoneOffset()%60)<10?"0":"")+Math.abs(e.getTimezoneOffset()%60)},T:function(e){var t=e.getMonth();e.setMonth(0);var r=e.toTimeString().replace(/^.+ \(?([^\)]+)\)?$/,"$1");return e.setMonth(t),r},Z:function(e){return 60*-e.getTimezoneOffset()},c:function(e){return e.format("Y-m-d")+"T"+e.format("H:i:sP")},r:function(e){return e.toString()},U:function(e){return e.getTime()/1e3}};return{format:function(e){for(var a="",i=0;i<t.length;i++){var n=t.charAt(i);a+=r[n]?r[n].call(e):n}return a}}};DateFormat.getDateInstance=function(){return new DateFormat("M/d/y h:i a")}}$namespace("org.owasp.esapi"),org.owasp.esapi.ESAPI=function(e){var t=e;if(!t)throw new RuntimeException("Configuration Error - Unable to load $ESAPI_Properties Object");var r=null,a=null,i=null,n=null,o=null;return{properties:t,encoder:function(){if(!r){if(!t.encoder.Implementation)throw new RuntimeException("Configuration Error - $ESAPI.properties.encoder.Implementation object not found.");r=new t.encoder.Implementation}return r},logFactory:function(){if(!i){if(!t.logging.Implementation)throw new RuntimeException("Configuration Error - $ESAPI.properties.logging.Implementation object not found.");i=new t.logging.Implementation}return i},logger:function(e){return this.logFactory().getLogger(e)},locale:function(){return org.owasp.esapi.i18n.Locale.getLocale(t.localization.DefaultLocale)},resourceBundle:function(){if(!n){if(!t.localization.StandardResourceBundle)throw new RuntimeException("Configuration Error - $ESAPI.properties.localization.StandardResourceBundle not found.");n=new org.owasp.esapi.i18n.ObjectResourceBundle(t.localization.StandardResourceBundle)}return n},validator:function(){if(!a){if(!t.validation.Implementation)throw new RuntimeException("Configuration Error - $ESAPI.properties.validation.Implementation object not found.");a=new t.validation.Implementation}return a},httpUtilities:function(){return o||(o=new org.owasp.esapi.HTTPUtilities),o}}};var $ESAPI=null;with(org.owasp.esapi.ESAPI.initialize=function(){$ESAPI=new org.owasp.esapi.ESAPI(Base.esapi.properties)},$namespace("org.owasp.esapi"),org.owasp.esapi.Encoder=function(){},$namespace("org.owasp.esapi"),org.owasp.esapi.EncoderConstants={CHAR_LOWERS:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],CHAR_UPPERS:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],CHAR_DIGITS:["0","1","2","3","4","5","6","7","8","9"],CHAR_SPECIALS:["!","$","*","+","-",".","=","?","@","^","_","|","~"],CHAR_LETTERS:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],CHAR_ALNUM:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","0","1","2","3","4","5","6","7","8","9"]},$namespace("org.owasp.esapi"),org.owasp.esapi.EnterpriseSecurityException=function(e,t,r){var a=t,i=new Exception(e,r);return{getMessage:i.getMessage,getUserMessage:i.getMessage,getLogMessage:function(){return a},getStackTrace:i.getStackTrace,printStackTrace:i.printStackTrace}},$namespace("org.owasp.esapi"),org.owasp.esapi.HTTPUtilities=function(){var e=$ESAPI.logger("HTTPUtilities"),t=$ESAPI.resourceBundle(),r=org.owasp.esapi.Logger.EventType;return{addCookie:function(a){if($type(a,org.owasp.esapi.net.Cookie),"http:"!=window.top.location.protocol||"https:"!=window.top.location.protocol)throw new RuntimeException(t.getString("HTTPUtilities.Cookie.Protocol",{protocol:window.top.location.protocol}));var i=a.getName(),n=a.getValue(),o=a.getMaxAge(),s=a.getDomain(),l=a.getPath(),c=a.getSecure(),d=new org.owasp.esapi.ValidationErrorList;if($ESAPI.validator().getValidInput("cookie name",i,"HttpCookieName",50,!1,d),$ESAPI.validator().getValidInput("cookie value",n,"HttpCookieValue",5e3,!1,d),0==d.size()){var u=i+"="+escape(n);u+=o?";expires="+new Date((new Date).getTime()+1e3*o).toGMTString():"",u+=l?";path="+l:"",u+=s?";domain="+s:"",u+=c||$ESAPI.properties.httputilities.cookies.ForceSecure?";secure":"",document.cookie=u}else e.warning(r.SECURITY_FAILURE,t.getString("HTTPUtilities.Cookie.UnsafeData",{name:i,value:n}))},getCookie:function(e){for(var t=document.cookie.split("; "),r=0,a=t.length;r<a;r++){var i=t[r].split("=");if(i[0]==escape(e))return new org.owasp.esapi.net.Cookie(e,i[1]?unescape(i[1]):"")}return null},killAllCookies:function(){for(var e=document.cookie.split("; "),r=0,a=e.length;r<a;r++){var i=e[r].split("="),n=unescape(i[0]);if(!this.killCookie(n))throw new RuntimeException(t.getString("HTTPUtilities.Cookie.CantKill",{name:n}))}},killCookie:function(e){var r=this.getCookie(e);if(r){if(r.setMaxAge(-10),this.addCookie(r),this.getCookie(e))throw new RuntimeException(t.getString("HTTPUtilities.Cookie.CantKill",{name:e}));return!0}return!1},getRequestParameter:function(e){var t=window.top.location.search.substring(1),r=t.indexOf(e);if(r<0)return null;r+=e.length;var a=t.indexOf("&",r);return a<0&&(a=t.length),unescape(t.substring(r,a))}}},$namespace("org.owasp.esapi"),org.owasp.esapi.IntrusionException=function(e,t,r){var a=new org.owasp.esapi.EnterpriseSecurityException(e,t,r);return{getMessage:a.getMessage,getUserMessage:a.getMessage,getLogMessage:a.getLogMessage,getStackTrace:a.getStackTrace,printStackTrace:a.printStackTrace}},$namespace("org.owasp.esapi"),org.owasp.esapi.LogFactory=function(){return{getLogger:!1}},$namespace("org.owasp.esapi"),org.owasp.esapi.Logger=function(){return{setLevel:!1,fatal:!1,error:!1,isErrorEnabled:!1,warning:!1,isWarningEnabled:!1,info:!1,isInfoEnabled:!1,debug:!1,isDebugEnabled:!1,trace:!1,isTraceEnabled:!1}},org.owasp.esapi.Logger.EventType=function(e,t){var r=e,a=t;return{isSuccess:function(){return a},toString:function(){return r}}},org.owasp.esapi.Logger)EventType.SECURITY_SUCCESS=new EventType("SECURITY SUCCESS",!0),EventType.SECURITY_FAILURE=new EventType("SECURITY FAILURE",!1),EventType.EVENT_SUCCESS=new EventType("EVENT SUCCESS",!0),EventType.EVENT_FAILURE=new EventType("EVENT FAILURE",!1),OFF=Number.MAX_VALUE,FATAL=1e3,ERROR=800,WARNING=600,INFO=400,DEBUG=200,TRACE=100,ALL=Number.MIN_VALUE;$namespace("org.owasp.esapi"),org.owasp.esapi.PreparedString=function(e,t,r){var a=[],i=[];return r||(r="?"),function(e){for(var t=0,n=0,o=0;o<e.length;o++)e.charAt(o)==r&&(n++,a.push(e.substr(t,o)),t=o+1);a.push(e.substr(t)),i=new Array(n)}(e),{set:function(e,r,a){if(e<1||e>i.length)throw new IllegalArgumentException("Attempt to set parameter: "+e+" on a PreparedString with only "+i.length+" placeholders");a||(a=t),i[e-1]=a.encode([],r)},toString:function(){for(var e=0;e<i.length;e++)if(null==i[e])throw new RuntimeException("Attempt to render PreparedString without setting parameter "+(e+1));for(var t="",r=0,n=0;n<a.length;n++)t+=a[n],r<i.length&&(t+=i[r++]);return t}}},$namespace("org.owasp.esapi"),org.owasp.esapi.ValidationErrorList=function(){var e=Array();return{addError:function(t,r){if(null==t)throw new RuntimeException("Context cannot be null: "+r.getLogMessage(),r);if(null==r)throw new RuntimeException("Context ("+t+") - Error cannot be null");if(e[t])throw new RuntimeException("Context ("+t+") already exists. must be unique.");e[t]=r},errors:function(){return e},isEmpty:function(){return 0==e.length},size:function(){return e.length}}},$namespace("org.owasp.esapi"),org.owasp.esapi.ValidationRule=function(){return{getValid:!1,setAllowNull:!1,getTypeName:!1,setTypeName:!1,setEncoder:!1,assertValid:!1,getSafe:!1,isValid:!1,whitelist:!1}},$namespace("org.owasp.esapi"),org.owasp.esapi.Validator=function(){return{addRule:!1,getRule:!1,getValidInput:!1,isValidDate:!1,getValidDate:!1,isValidSafeHTML:!1,getValidSafeHTML:!1,isValidCreditCard:!1,getValidCreditCard:!1,isValidFilename:!1,getValidFilename:!1,isValidNumber:!1,getValidNumber:!1,isValidPrintable:!1,getValidPrintable:!1}},$namespace("org.owasp.esapi.codecs.Base64"),org.owasp.esapi.codecs.Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){if(!e)return null;for(var t,r,a,i,n,o,s,l="",c=0,d=org.owasp.esapi.codecs.UTF8.encode(e);c<d.length;)i=(t=d.charCodeAt(c++))>>2,n=(3&t)<<4|(r=d.charCodeAt(c++))>>4,o=(15&r)<<2|(a=d.charCodeAt(c++))>>6,s=63&a,isNaN(r)?o=s=64:isNaN(a)&&(s=64),l+=this._keyStr.charAt(i)+this._keyStr.charAt(n)+this._keyStr.charAt(o)+this._keyStr.charAt(s);return l},decode:function(e){if(!e)return null;for(var t,r,a,i,n,o,s="",l=0,c=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<c.length;)t=this._keyStr.indexOf(c.charAt(l++))<<2|(i=this._keyStr.indexOf(c.charAt(l++)))>>4,r=(15&i)<<4|(n=this._keyStr.indexOf(c.charAt(l++)))>>2,a=(3&n)<<6|(o=this._keyStr.indexOf(c.charAt(l++))),s+=String.fromCharCode(t),64!=n&&(s+=String.fromCharCode(r)),64!=o&&(s+=String.fromCharCode(a));return org.owasp.esapi.codecs.UTF8.decode(s)}},$namespace("org.owasp.esapi.codecs"),org.owasp.esapi.codecs.CSSCodec=function(){var e=new org.owasp.esapi.codecs.Codec;return{encode:e.encode,decode:e.decode,encodeCharacter:function(e,t){if(e.contains(t))return t;var r=org.owasp.esapi.codecs.Codec.getHexForNonAlphanumeric(t);return null==r?t:"\\"+r+" "},decodeCharacter:function(e){e.mark();var t=e.next();if(null==t)return e.reset(),null;if("\\"!=t)return e.reset(),null;var r=e.next();if(null==r)return e.reset(),null;if(e.isHexDigit(r)){for(var a=r,i=0;i<6;i++){var n=e.next();if(null==n||32==n.charCodeAt(0))break;if(!e.isHexDigit(n)){input.pushback(n);break}a+=n}try{var o=parseInt(a,16);return String.fromCharCode(o)}catch(t){return e.reset(),null}}return r}}},$namespace("org.owasp.esapi.codecs"),org.owasp.esapi.codecs.Codec=function(){return{encode:function(e,t){for(var r="",a=0;a<t.length;a++){var i=t.charAt(a);r+=this.encodeCharacter(e,i)}return r},encodeCharacter:function(e,t){return t},decode:function(e){for(var t="",r=new org.owasp.esapi.codecs.PushbackString(e);r.hasNext();){var a=this.decodeCharacter(r);t+=null!=a?a:r.next()}return t},decodeCharacter:function(e){return e.next()}}},org.owasp.esapi.codecs.Codec.getHexForNonAlphanumeric=function(e){return e.charCodeAt(0)<256?org.owasp.esapi.codecs.Codec.hex[e.charCodeAt(0)]:e.charCodeAt(0).toString(16)},org.owasp.esapi.codecs.Codec.hex=[];for(var c=0;c<255;c++)org.owasp.esapi.codecs.Codec.hex[c]=c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122?null:c.toString(16);var entityToCharacterMap=[];entityToCharacterMap["&quot"]="34",entityToCharacterMap["&amp"]="38",entityToCharacterMap["&lt"]="60",entityToCharacterMap["&gt"]="62",entityToCharacterMap["&nbsp"]="160",entityToCharacterMap["&iexcl"]="161",entityToCharacterMap["&cent"]="162",entityToCharacterMap["&pound"]="163",entityToCharacterMap["&curren"]="164",entityToCharacterMap["&yen"]="165",entityToCharacterMap["&brvbar"]="166",entityToCharacterMap["&sect"]="167",entityToCharacterMap["&uml"]="168",entityToCharacterMap["&copy"]="169",entityToCharacterMap["&ordf"]="170",entityToCharacterMap["&laquo"]="171",entityToCharacterMap["&not"]="172",entityToCharacterMap["&shy"]="173",entityToCharacterMap["&reg"]="174",entityToCharacterMap["&macr"]="175",entityToCharacterMap["&deg"]="176",entityToCharacterMap["&plusmn"]="177",entityToCharacterMap["&sup2"]="178",entityToCharacterMap["&sup3"]="179",entityToCharacterMap["&acute"]="180",entityToCharacterMap["&micro"]="181",entityToCharacterMap["&para"]="182",entityToCharacterMap["&middot"]="183",entityToCharacterMap["&cedil"]="184",entityToCharacterMap["&sup1"]="185",entityToCharacterMap["&ordm"]="186",entityToCharacterMap["&raquo"]="187",entityToCharacterMap["&frac14"]="188",entityToCharacterMap["&frac12"]="189",entityToCharacterMap["&frac34"]="190",entityToCharacterMap["&iquest"]="191",entityToCharacterMap["&Agrave"]="192",entityToCharacterMap["&Aacute"]="193",entityToCharacterMap["&Acirc"]="194",entityToCharacterMap["&Atilde"]="195",entityToCharacterMap["&Auml"]="196",entityToCharacterMap["&Aring"]="197",entityToCharacterMap["&AElig"]="198",entityToCharacterMap["&Ccedil"]="199",entityToCharacterMap["&Egrave"]="200",entityToCharacterMap["&Eacute"]="201",entityToCharacterMap["&Ecirc"]="202",entityToCharacterMap["&Euml"]="203",entityToCharacterMap["&Igrave"]="204",entityToCharacterMap["&Iacute"]="205",entityToCharacterMap["&Icirc"]="206",entityToCharacterMap["&Iuml"]="207",entityToCharacterMap["&ETH"]="208",entityToCharacterMap["&Ntilde"]="209",entityToCharacterMap["&Ograve"]="210",entityToCharacterMap["&Oacute"]="211",entityToCharacterMap["&Ocirc"]="212",entityToCharacterMap["&Otilde"]="213",entityToCharacterMap["&Ouml"]="214",entityToCharacterMap["&times"]="215",entityToCharacterMap["&Oslash"]="216",entityToCharacterMap["&Ugrave"]="217",entityToCharacterMap["&Uacute"]="218",entityToCharacterMap["&Ucirc"]="219",entityToCharacterMap["&Uuml"]="220",entityToCharacterMap["&Yacute"]="221",entityToCharacterMap["&THORN"]="222",entityToCharacterMap["&szlig"]="223",entityToCharacterMap["&agrave"]="224",entityToCharacterMap["&aacute"]="225",entityToCharacterMap["&acirc"]="226",entityToCharacterMap["&atilde"]="227",entityToCharacterMap["&auml"]="228",entityToCharacterMap["&aring"]="229",entityToCharacterMap["&aelig"]="230",entityToCharacterMap["&ccedil"]="231",entityToCharacterMap["&egrave"]="232",entityToCharacterMap["&eacute"]="233",entityToCharacterMap["&ecirc"]="234",entityToCharacterMap["&euml"]="235",entityToCharacterMap["&igrave"]="236",entityToCharacterMap["&iacute"]="237",entityToCharacterMap["&icirc"]="238",entityToCharacterMap["&iuml"]="239",entityToCharacterMap["&eth"]="240",entityToCharacterMap["&ntilde"]="241",entityToCharacterMap["&ograve"]="242",entityToCharacterMap["&oacute"]="243",entityToCharacterMap["&ocirc"]="244",entityToCharacterMap["&otilde"]="245",entityToCharacterMap["&ouml"]="246",entityToCharacterMap["&divide"]="247",entityToCharacterMap["&oslash"]="248",entityToCharacterMap["&ugrave"]="249",entityToCharacterMap["&uacute"]="250",entityToCharacterMap["&ucirc"]="251",entityToCharacterMap["&uuml"]="252",entityToCharacterMap["&yacute"]="253",entityToCharacterMap["&thorn"]="254",entityToCharacterMap["&yuml"]="255",entityToCharacterMap["&OElig"]="338",entityToCharacterMap["&oelig"]="339",entityToCharacterMap["&Scaron"]="352",entityToCharacterMap["&scaron"]="353",entityToCharacterMap["&Yuml"]="376",entityToCharacterMap["&fnof"]="402",entityToCharacterMap["&circ"]="710",entityToCharacterMap["&tilde"]="732",entityToCharacterMap["&Alpha"]="913",entityToCharacterMap["&Beta"]="914",entityToCharacterMap["&Gamma"]="915",entityToCharacterMap["&Delta"]="916",entityToCharacterMap["&Epsilon"]="917",entityToCharacterMap["&Zeta"]="918",entityToCharacterMap["&Eta"]="919",entityToCharacterMap["&Theta"]="920",entityToCharacterMap["&Iota"]="921",entityToCharacterMap["&Kappa"]="922",entityToCharacterMap["&Lambda"]="923",entityToCharacterMap["&Mu"]="924",entityToCharacterMap["&Nu"]="925",entityToCharacterMap["&Xi"]="926",entityToCharacterMap["&Omicron"]="927",entityToCharacterMap["&Pi"]="928",entityToCharacterMap["&Rho"]="929",entityToCharacterMap["&Sigma"]="931",entityToCharacterMap["&Tau"]="932",entityToCharacterMap["&Upsilon"]="933",entityToCharacterMap["&Phi"]="934",entityToCharacterMap["&Chi"]="935",entityToCharacterMap["&Psi"]="936",entityToCharacterMap["&Omega"]="937",entityToCharacterMap["&alpha"]="945",entityToCharacterMap["&beta"]="946",entityToCharacterMap["&gamma"]="947",entityToCharacterMap["&delta"]="948",entityToCharacterMap["&epsilon"]="949",entityToCharacterMap["&zeta"]="950",entityToCharacterMap["&eta"]="951",entityToCharacterMap["&theta"]="952",entityToCharacterMap["&iota"]="953",entityToCharacterMap["&kappa"]="954",entityToCharacterMap["&lambda"]="955",entityToCharacterMap["&mu"]="956",entityToCharacterMap["&nu"]="957",entityToCharacterMap["&xi"]="958",entityToCharacterMap["&omicron"]="959",entityToCharacterMap["&pi"]="960",entityToCharacterMap["&rho"]="961",entityToCharacterMap["&sigmaf"]="962",entityToCharacterMap["&sigma"]="963",entityToCharacterMap["&tau"]="964",entityToCharacterMap["&upsilon"]="965",entityToCharacterMap["&phi"]="966",entityToCharacterMap["&chi"]="967",entityToCharacterMap["&psi"]="968",entityToCharacterMap["&omega"]="969",entityToCharacterMap["&thetasym"]="977",entityToCharacterMap["&upsih"]="978",entityToCharacterMap["&piv"]="982",entityToCharacterMap["&ensp"]="8194",entityToCharacterMap["&emsp"]="8195",entityToCharacterMap["&thinsp"]="8201",entityToCharacterMap["&zwnj"]="8204",entityToCharacterMap["&zwj"]="8205",entityToCharacterMap["&lrm"]="8206",entityToCharacterMap["&rlm"]="8207",entityToCharacterMap["&ndash"]="8211",entityToCharacterMap["&mdash"]="8212",entityToCharacterMap["&lsquo"]="8216",entityToCharacterMap["&rsquo"]="8217",entityToCharacterMap["&sbquo"]="8218",entityToCharacterMap["&ldquo"]="8220",entityToCharacterMap["&rdquo"]="8221",entityToCharacterMap["&bdquo"]="8222",entityToCharacterMap["&dagger"]="8224",entityToCharacterMap["&Dagger"]="8225",entityToCharacterMap["&bull"]="8226",entityToCharacterMap["&hellip"]="8230",entityToCharacterMap["&permil"]="8240",entityToCharacterMap["&prime"]="8242",entityToCharacterMap["&Prime"]="8243",entityToCharacterMap["&lsaquo"]="8249",entityToCharacterMap["&rsaquo"]="8250",entityToCharacterMap["&oline"]="8254",entityToCharacterMap["&frasl"]="8260",entityToCharacterMap["&euro"]="8364",entityToCharacterMap["&image"]="8365",entityToCharacterMap["&weierp"]="8472",entityToCharacterMap["&real"]="8476",entityToCharacterMap["&trade"]="8482",entityToCharacterMap["&alefsym"]="8501",entityToCharacterMap["&larr"]="8592",entityToCharacterMap["&uarr"]="8593",entityToCharacterMap["&rarr"]="8594",entityToCharacterMap["&darr"]="8595",entityToCharacterMap["&harr"]="8596",entityToCharacterMap["&crarr"]="8629",entityToCharacterMap["&lArr"]="8656",entityToCharacterMap["&uArr"]="8657",entityToCharacterMap["&rArr"]="8658",entityToCharacterMap["&dArr"]="8659",entityToCharacterMap["&hArr"]="8660",entityToCharacterMap["&forall"]="8704",entityToCharacterMap["&part"]="8706",entityToCharacterMap["&exist"]="8707",entityToCharacterMap["&empty"]="8709",entityToCharacterMap["&nabla"]="8711",entityToCharacterMap["&isin"]="8712",entityToCharacterMap["&notin"]="8713",entityToCharacterMap["&ni"]="8715",entityToCharacterMap["&prod"]="8719",entityToCharacterMap["&sum"]="8721",entityToCharacterMap["&minus"]="8722",entityToCharacterMap["&lowast"]="8727",entityToCharacterMap["&radic"]="8730",entityToCharacterMap["&prop"]="8733",entityToCharacterMap["&infin"]="8734",entityToCharacterMap["&ang"]="8736",entityToCharacterMap["&and"]="8743",entityToCharacterMap["&or"]="8744",entityToCharacterMap["&cap"]="8745",entityToCharacterMap["&cup"]="8746",entityToCharacterMap["&int"]="8747",entityToCharacterMap["&there4"]="8756",entityToCharacterMap["&sim"]="8764",entityToCharacterMap["&cong"]="8773",entityToCharacterMap["&asymp"]="8776",entityToCharacterMap["&ne"]="8800",entityToCharacterMap["&equiv"]="8801",entityToCharacterMap["&le"]="8804",entityToCharacterMap["&ge"]="8805",entityToCharacterMap["&sub"]="8834",entityToCharacterMap["&sup"]="8835",entityToCharacterMap["&nsub"]="8836",entityToCharacterMap["&sube"]="8838",entityToCharacterMap["&supe"]="8839",entityToCharacterMap["&oplus"]="8853",entityToCharacterMap["&otimes"]="8855",entityToCharacterMap["&perp"]="8869",entityToCharacterMap["&sdot"]="8901",entityToCharacterMap["&lceil"]="8968",entityToCharacterMap["&rceil"]="8969",entityToCharacterMap["&lfloor"]="8970",entityToCharacterMap["&rfloor"]="8971",entityToCharacterMap["&lang"]="9001",entityToCharacterMap["&rang"]="9002",entityToCharacterMap["&loz"]="9674",entityToCharacterMap["&spades"]="9824",entityToCharacterMap["&clubs"]="9827",entityToCharacterMap["&hearts"]="9829",entityToCharacterMap["&diams"]="9830";var characterToEntityMap=[];for(var entity in entityToCharacterMap)characterToEntityMap[entityToCharacterMap[entity]]=entity;$namespace("org.owasp.esapi.codecs"),org.owasp.esapi.codecs.ZCodecForHTMLUnicode=function(){return new org.owasp.esapi.codecs.Codec,{encode:function(e,t){for(var r="",a=0;a<t.length;){var i=t.charAt(a);void 0!==String.prototype.codePointAt&&(i=t.codePointAt(a)),r+=this.encodeCharacter(e,i),a+=i>65535?2:1}return r},encodeCharacter:function(e,t){return t}}},org.owasp.esapi.codecs.ZCodecForHTMLUnicode.getHexForNonAlphanumeric=function(e,t){return e.charCodeAt(0)<256?org.owasp.esapi.codecs.Codec.getHexForNonAlphanumeric(e):t.toString(16)},$namespace("org.owasp.esapi.codecs"),org.owasp.esapi.codecs.HTMLEntityCodec=function(){var e=new org.owasp.esapi.codecs.ZCodecForHTMLUnicode,t=function(e){var t=e.peek();return null==t?null:"x"==t||"X"==t?(e.next(),a(e)):r(e)},r=function(e){for(var t="";e.hasNext();){var r=e.peek();if(!r.match(/[0-9]/)){if(";"==r){e.next();break}break}t+=r,e.next()}try{return parseInt(t)}catch(e){return null}},a=function(e){for(var t="";e.hasNext();){var r=e.peek();if(!r.match(/[0-9A-Fa-f]/)){if(";"==r){e.next();break}break}t+=r,e.next()}try{return parseInt(t,16)}catch(e){return null}};return{encode:e.encode,decode:e.decode,encodeCharacter:function(e,t){var r=t;if(void 0!==String.fromCodePoint){r=String.fromCodePoint(t);if(e.contains(r))return r;var a=org.owasp.esapi.codecs.ZCodecForHTMLUnicode.getHexForNonAlphanumeric(r,t)}else{if(e.contains(r))return r;a=org.owasp.esapi.codecs.Codec.getHexForNonAlphanumeric(t)}if(null==a)return r;if("\t"==r||"\n"==r||"\r"==r)return""+r;var i=r.charCodeAt(0);if(i<=31&&"\t"!=r&&"\n"!=r&&"\r"!=r||i>=127&&i<=159)return" ";var n=characterToEntityMap[i];return null!=n?n+";":"&#x"+a+";"},decodeCharacter:function(e){var r=e;r.mark();var a=r.next();if(null==a||"&"!=a)return r.reset(),null;var i=r.next();if(null==i)return r.reset(),null;if("#"==i){var n=t(r);if(null!=n)return n}else if(i.match(/[A-Za-z]/)&&(r.pushback(i),n=function(e){for(var t="";e.hasNext();){var r=e.peek();if(r.match(/[A-Za-z]/)){if(t+=r,e.next(),entityToCharacterMap.containsKey("&"+t)){e.peek(";")&&e.next();break}}else{if(";"!=r)break;e.next()}}return String.fromCharCode(entityToCharacterMap.getCaseInsensitive("&"+t))}(r),null!=n))return n;return r.reset(),null}}},$namespace("org.owasp.esapi.codecs"),org.owasp.esapi.codecs.JavascriptCodec=function(){return{encode:function(e,t){for(var r="",a=0;a<t.length;a++){var i=t.charAt(a);if(e.contains(i))r+=i;else if(null==org.owasp.esapi.codecs.Codec.getHexForNonAlphanumeric(i))r+=i;else{var n=i.charCodeAt(0).toString(16);if(i.charCodeAt(0)<256){var o="00".substr(n.length);r+="\\x"+o+n.toUpperCase()}else r+="\\u"+(o="0000".substr(n.length))+n.toUpperCase()}}return r},decode:(new org.owasp.esapi.codecs.Codec).decode,decodeCharacter:function(e){e.mark();var t=e.next();if(null==t)return e.reset(),null;if("\\"!=t)return e.reset(),null;var r=e.next();if(null==r)return e.reset(),null;if("b"==r)return 8;if("t"==r)return 9;if("n"==r)return 10;if("v"==r)return 11;if("f"==r)return 12;if("r"==r)return 13;if('"'==r)return 34;if("'"==r)return 39;if("\\"==r)return 92;if("x"==r.toLowerCase()){o="";for(var a=0;a<2;a++){var i=e.nextHex();if(null==i)return input.reset(),null;o+=i}try{return n=parseInt(o,16),String.fromCharCode(n)}catch(t){return e.reset(),null}}else if("u"==r.toLowerCase()){for(o="",a=0;a<4;a++){if(null==(i=e.nextHex()))return input.reset(),null;o+=i}try{var n=parseInt(o,16);return String.fromCharCode(n)}catch(t){return e.reset(),null}}else if(e.isOctalDigit(r)){var o=r,s=e.next();if(e.isOctalDigit(s)){o+=s;var l=e.next();e.isOctalDigit(l)?o+=l:e.pushback(l)}else e.pushback(s);try{return n=parseInt(o,8),String.fromCharCode(n)}catch(t){return e.reset(),null}}return r}}},$namespace("org.owasp.esapi.codecs"),org.owasp.esapi.codecs.PercentCodec=function(){var e=new org.owasp.esapi.codecs.Codec,t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",r=function(e){var t="";if(e<-128||e>127)throw new IllegalArgumentException("b is not a byte (was "+e+")");return(e&=255)<16&&(t+="0"),t+e.toString(16).toUpperCase()};return{encode:e.encode,decode:e.decode,encodeCharacter:function(e,a){if(t.indexOf(a)>-1)return a;for(var i=org.owasp.esapi.codecs.UTF8.encode(a),n="",o=0;o<i.length;o++)n+="%"+r(i.charCodeAt(o));return n},decodeCharacter:function(e){e.mark();var t=e.next();if(null==t||"%"!=t)return e.reset(),null;for(var r="",a=0;a<2;a++){var i=e.nextHex();null!=i&&(r+=i)}if(2==r.length)try{var n=parseInt(r,16);return String.fromCharCode(n)}catch(e){}return e.reset(),null}}},$namespace("org.owasp.esapi.codecs"),org.owasp.esapi.codecs.PushbackString=function(e){var t=e,r="",a="",i=0,n=0;return{pushback:function(e){r=e},index:function(){return i},hasNext:function(){return null!=r||!(null==t||0==t.length||i>=t.length)},next:function(){if(null!=r){var e=r;return r=null,e}return null==t||0==t.length||i>=t.length?null:t.charAt(i++)},nextHex:function(){var e=this.next();return this.isHexDigit(e)?e:null},nextOctal:function(){var e=this.next();return this.isOctalDigit(e)?e:null},isHexDigit:function(e){return null!=e&&(e>="0"&&e<="9"||e>="a"&&e<="f"||e>="A"&&e<="F")},isOctalDigit:function(e){return null!=e&&e>="0"&&e<="7"},peek:function(e){return e?null!=r&&r==e||!(null==t||0==t.length||i>=t.length)&&t.charAt(i)==e:null!=r?r:null==t||0==t.length||i>=t.length?null:t.charAt(i)},mark:function(){a=r,n=i},reset:function(){r=a,i=n},remainder:function(){var e=t.substr(i);return null!=r&&(e=r+e),e}}},$namespace("org.owasp.esapi.codecs"),org.owasp.esapi.codecs.UTF8={encode:function(e){for(var t=e.replace(/\r\n/g,"\n"),r="",a=0;a<t.length;a++){var i=t.charCodeAt(a);i<128?r+=String.fromCharCode(i):i>127&&i<2048?(r+=String.fromCharCode(i>>6|192),r+=String.fromCharCode(63&i|128)):(r+=String.fromCharCode(i>>12|224),r+=String.fromCharCode(i>>6&63|128),r+=String.fromCharCode(63&i|128))}return r},decode:function(e){for(var t="",r=c=c1=c2=0;r<e.length;)(c=e.charCodeAt(r))<128?(t+=String.fromCharCode(c),r++):c>191&&c<224?(c2=e.charCodeAt(r+1),t+=String.fromCharCode((31&c)<<6|63&c2),r+=2):(c2=utftext.charCodeAt(r+1),c3=utftext.charCodeAt(r+2),string+=String.fromCharCode((15&c)<<12|(63&c2)<<6|63&c3),r+=3);return t}},$namespace("org.owasp.esapi.i18n"),org.owasp.esapi.i18n.ArrayResourceBundle=function(sName,oLocale,aMessages,oParent){with(org.owasp.esapi.i18n)var _super=new ResourceBundle(sName,oLocale,oParent);var messages=aMessages;return{getParent:_super.getParent,getLocale:_super.getLocale,getName:_super.getName,getString:_super.getString,getMessage:function(e){return messages[e]}}},$namespace("org.owasp.esapi.i18n"),org.owasp.esapi.i18n.Locale=function(e,t,r){var a=e,i=t,n=r;return{getLanguage:function(){return a},getCountry:function(){return i},getVariant:function(){return n},toString:function(){return a+(i?"-"+i+(n?"-"+n:""):"")}}},org.owasp.esapi.i18n.Locale.US=new org.owasp.esapi.i18n.Locale("en","US"),org.owasp.esapi.i18n.Locale.GB=new org.owasp.esapi.i18n.Locale("en","GB"),org.owasp.esapi.i18n.Locale.getLocale=function(e){var t=e.split("-");return new org.owasp.esapi.i18n.Locale(t[0],t.length>1?t[1]:"",t.length>2?t.length[2]:"")},org.owasp.esapi.i18n.Locale.getDefault=function(){var e=(navigator.language?navigator.language:navigator.userLanguage?navigator.userLanguage:"en-US").split("-");return new org.owasp.esapi.i18n.Locale(e[0],e.length>1?e[1]:"",e.length>2?e.length[2]:"")},$namespace("org.owasp.esapi.i18n"),org.owasp.esapi.i18n.ObjectResourceBundle=function(e,t){var r=new org.owasp.esapi.i18n.ResourceBundle(e.name,org.owasp.esapi.i18n.Locale.getLocale(e.locale),t),a=e.messages;return{getParent:r.getParent,getLocale:r.getLocale,getName:r.getName,getString:r.getString,getMessage:function(e){return a[e]}}},$namespace("org.owasp.esapi.i18n"),org.owasp.esapi.i18n.ResourceBundle=function(e,t,r){var a=r,i=t,n=e;if(!n)throw new SyntaxError("Name required for implementations of org.owasp.esapi.i18n.ResourceBundle");if(!i)throw new SyntaxError("Locale required for implementations of org.owasp.esapi.i18n.ResourceBundle");return{getParent:function(){return a},getLocale:function(){return i},getName:function(){return n},getMessage:function(e){return e},getString:function(e,t){if(arguments.length<1)throw new IllegalArgumentException("No key passed to getString");var r=this.getMessage(e);if(!r)return a?a.getString(e,t):e;if(!r.match(/\{([A-Za-z]+)\}/)||!t)return r;for(var i="",n=0;;){var o=r.indexOf("{",n),s=r.indexOf("}",o);if(o<0){i+=r.substr(n,r.length-n);break}if(o>=0&&s<-1)throw new SyntaxError("Invalid Message - Unclosed Context Reference: "+r);i+=r.substring(n,o);var l=r.substring(o+1,s);i+=t[l]?t[l]:r.substring(o,s+1),n=s+1}return i}}},org.owasp.esapi.i18n.ResourceBundle.getResourceBundle=function(sResource,oLocale){var classname=sResource+"_"+oLocale.toString().replace("-","_");with(org.owasp.esapi.i18n)return ResourceBundle[classname]instanceof Object?ResourceBundle[classname]:new ResourceBundle[classname]},$namespace("org.owasp.esapi.net"),org.owasp.esapi.net.Cookie=function(e,t){var r,a,i,n,o,s,l,c,d=$ESAPI.resourceBundle();if(!function(e){for(var t=0,r=e.length;t<r;t++){var a=e.charCodeAt(t),i=e.charAt(t);if(a<32||a>=127||-1!=",; ".indexOf(i))return!1}return!0}(e)||"comment"==e.toLowerCase()||"discard"==e.toLowerCase()||"domain"==e.toLowerCase()||"expires"==e.toLowerCase()||"max-age"==e.toLowerCase()||"path"==e.toLowerCase()||"secure"==e.toLowerCase()||"version"==e.toLowerCase()||"$"==e.charAt(0)){var u=d.getString("Cookie.Name",{name:e});throw new IllegalArgumentException(u)}return r=e,a=t,{setComment:function(e){i=e},getComment:function(){return i},setDomain:function(e){n=e.toLowerCase()},getDomain:function(){return n},setMaxAge:function(e){o=e},getMaxAge:function(){return o},setPath:function(e){s=e},getPath:function(){return s},setSecure:function(e){l=e},getSecure:function(){return l},getName:function(){return r},setValue:function(e){a=e},getValue:function(){return a},setVersion:function(e){if(e<0||e>1)throw new IllegalArgumentException(d.getString("Cookie.Version",{version:e}));c=e},getVersion:function(){return c}}},$namespace("org.owasp.esapi.reference.encoding"),org.owasp.esapi.reference.encoding.DefaultEncoder=function(e){var t=[],r=new org.owasp.esapi.codecs.HTMLEntityCodec,a=new org.owasp.esapi.codecs.JavascriptCodec,i=new org.owasp.esapi.codecs.CSSCodec,n=new org.owasp.esapi.codecs.PercentCodec;e?t=e:(t.push(r),t.push(a),t.push(i),t.push(n));var o=new Array(",",".","-","_"," "),s=new Array(",",".","-","_"),l=new Array,c=new Array(",",".","_");return{cananicalize:function(e,r){if(!e)return null;for(var a=e,i=null,n=1,o=0,s=!1;!s;)s=!0,t.each((function(e){a!=(a=e.decode(a))&&(null!=i&&i!=e&&n++,i=e,s&&o++,s=!1)}));if(o>=2&&n>1){if(r)throw new org.owasp.esapi.IntrusionException("Input validation failure","Multiple ("+o+"x) and mixed encoding ("+n+"x) detected in "+e)}else if(o>=2){if(r)throw new org.owasp.esapi.IntrusionException("Input validation failure","Multiple ("+o+"x) encoding detected in "+e)}else if(n>1&&r)throw new org.owasp.esapi.IntrusionException("Input validation failure","Mixed ("+n+"x) encoding detected in "+e);return a},normalize:function(e){return e.replace(/[^\x00-\x7F]/g,"")},encodeForHTML:function(e){return null==e?null:r.encode(o,e)},decodeForHTML:function(e){return null==e?null:r.decode(e)},encodeForHTMLAttribute:function(e){return null==e?null:r.encode(s,e)},encodeForCSS:function(e){return null==e?null:i.encode(l,e)},encodeForJavaScript:function(e){return null==e?null:a.encode(c,e)},encodeForJavascript:this.encodeForJavaScript,encodeForURL:function(e){var t=null==e?null:escape(e);return null!=t?t.replace(/\*/g,"%2a").replace(/@/g,"%40").replace(/-/g,"%2d").replace(/_/g,"%5f").replace(/\+/g,"%2b").replace(/\./g,"%2e").replace(/\//g,"%2f"):null},decodeFromURL:function(e){return null==e?null:unescape(e)},encodeForBase64:function(e){return e?org.owasp.esapi.codecs.Base64.encode(e):null},decodeFromBase64:function(e){return e?org.owasp.esapi.codecs.Base64.decode(e):null}}},$namespace("org.owasp.esapi.reference.logging"),org.owasp.esapi.reference.logging.Log4JSLogFactory=function(){var e=Array(),t=function(e){var t=null,r=e||null,a=Log4js.Level,i=!1,n=!1,o=!1,s=$ESAPI.encoder().encodeForHTML;t=Log4js.getLogger(r);return{setLevel:function(e){try{t.setLevel(function(e){var t=org.owasp.esapi.Logger;switch(e){case t.OFF:return Log4js.Level.OFF;case t.FATAL:return Log4js.Level.FATAL;case t.ERROR:return Log4js.Level.ERROR;case t.WARNING:return Log4js.Level.WARN;case t.INFO:return Log4js.Level.INFO;case t.DEBUG:return Log4js.Level.DEBUG;case t.TRACE:return Log4js.Level.TRACE;case t.ALL:return Log4js.Level.ALL}}(e))}catch(e){this.error(org.owasp.esapi.Logger.SECURITY_FAILURE,"",e)}},trace:function(e,t,r){this.log(a.TRACE,e,t,r)},debug:function(e,t,r){this.log(a.DEBUG,e,t,r)},info:function(e,t,r){this.log(a.INFO,e,t,r)},warning:function(e,t,r){this.log(a.WARN,e,t,r)},error:function(e,t,r){this.log(a.ERROR,e,t,r)},fatal:function(e,t,r){this.log(a.FATAL,e,t,r)},log:function(e,r,l,c){switch(e){case a.TRACE:if(!t.isTraceEnabled())return;break;case a.DEBUG:if(!t.isDebugEnabled())return;break;case a.INFO:if(!t.isInfoEnabled())return;break;case a.WARNING:if(!t.isWarnEnabled())return;break;case a.ERROR:if(!t.isErrorEnabled())return;break;case a.FATAL:if(!t.isFatalEnabled())return}l||(l="");var d=(l="["+r.toString()+"] - "+l).replace("\n","_").replace("\r","_");o&&((d=s(d))!=l&&(d+=" [Encoded]"));var u=(i?window.location.href:"")+(n?"/"+$ESAPI.properties.application.Name:"");t.log(e,(""!=u?"["+u+"] ":"")+d,c)},addAppender:function(e){t.addAppender(e)},isLogUrl:function(){return i},setLogUrl:function(e){i=e},isLogApplicationName:function(){return n},setLogApplicationName:function(e){n=e},isEncodingRequired:function(){return o},setEncodingRequired:function(e){o=e},setEncodingFunction:function(e){s=e},isDebugEnabled:function(){return t.isDebugEnabled()},isErrorEnabled:function(){return t.isErrorEnabled()},isFatalEnabled:function(){return t.isFatalEnabled()},isInfoEnabled:function(){return t.isInfoEnabled()},isTraceEnabled:function(){return t.isTraceEnabled()},isWarningEnabled:function(){return t.isWarnEnabled()}}};return{getLogger:function(r){var a="string"==typeof r?r:r.constructor.toString(),i=e[a];if(!i){i=new t(a);var n=function(e){var t=$ESAPI.properties.logging;return t[e]&&(t=t[e]),t}(r);i.setLevel(n.Level),i.setLogUrl(n.LogUrl),i.setLogApplicationName(n.LogApplicationName),i.setEncodingRequired(n.EncodingRequired),n.EncodingFunction&&i.setEncodingFunction(n.EncodingFunction),n.Appenders.each((function(e){n.Layout&&e.setLayout(n.Layout),i.addAppender(e)})),e[a]=i}return i}}},$namespace("org.owasp.esapi.reference.validation"),org.owasp.esapi.reference.validation.BaseValidationRule=function(e,t,r){var a,i=$ESAPI.logger("Validation"),n=org.owasp.esapi.Logger.EventType,o=e,s=t||$ESAPI.encoder(),l=!1,c=org.owasp.esapi.i18n.ResourceBundle,d=r||$ESAPI.locale();return $ESAPI.properties.validation.ResourceBundle&&(a=c.getResourceBundle($ESAPI.properties.validation.ResourceBundle,d)),a||(a=$ESAPI.resourceBundle(),i.info(n.EVENT_FAILURE,"No Validation ResourceBundle - Defaulting to "+a.getName()+"("+a.getLocale().toString()+")")),i.info(n.EVENT_SUCCESS,"Validation Rule Initialized with ResourceBundle: "+a.getName()),{setAllowNull:function(e){l=e},isAllowNull:function(){return l},getTypeName:function(){return o},setTypeName:function(e){o=e},setEncoder:function(e){s=e},getEncoder:function(){return s},assertValid:function(e,t){this.getValid(e,t)},getValid:function(e,t,r){var a=null;try{a=this.getValidInput(e,t)}catch(r){return this.sanitize(e,t)}return a},getValidInput:function(e,t){return t},getSafe:function(e,t){var r=null;try{r=this.getValidInput(e,t)}catch(r){return this.sanitize(e,t)}return r},sanitize:function(e,t){return t},isValid:function(e,t){var r=!1;try{this.getValidInput(e,t),r=!0}catch(e){return!1}return r},whitelist:function(e,t){for(var r="",a=0;a<e.length;a++){var i=e.charAt(a);t.contains(i)&&(r+=i)}return r},getUserMessage:function(e,t,r){return this.getMessage(e+".Usr",t+".Usr",r)},getLogMessage:function(e,t,r){return this.getMessage(e+".Log",t+".Log",r)},getMessage:function(e,t,r){return a.getString(e,r)?a.getString(e,r):a.getString(t,r)},validationException:function(e,t,r,a){throw new org.owasp.esapi.reference.validation.ValidationException(this.getUserMessage(e+"."+r,t+"."+r,a),this.getLogMessage(e+"."+r,t+"."+r,a),e)}}},$namespace("org.owasp.esapi.reference.validation"),org.owasp.esapi.reference.validation.CreditCardValidationRule=function(e,t,r){var a=new org.owasp.esapi.reference.validation.BaseValidationRule(e,t,r),i="CreditCard",n=19;ccRule=function(){var e=new RegExp($ESAPI.properties.validation.CreditCard),t=new org.owasp.esapi.reference.validation.StringValidationRule("ccrule",a.getEncoder(),r,e);return t.setMaxLength(n),t.setAllowNull(!1),t}();return{getMaxCardLength:function(){return n},setMaxCardLength:function(e){n=e},setAllowNull:a.setAllowNull,isAllowNull:a.isAllowNull,getTypeName:a.getTypeName,setTypeName:a.setTypeName,setEncoder:a.setEncoder,getEncoder:a.getEncoder,assertValid:a.assertValid,getValid:a.getValid,getValidInput:function(e,t){if(!t||""==t.trim()){if(this.isAllowNull())return null;a.validationException(e,i,"Required",{context:e,input:t})}var r=undefined.getValid(e,t);return function(e){for(var t,r="",a=0;o<e.length;a++)(t=e.charAt(a)).match(/[0-9]/)&&(r+=t);for(var i=0,n=0,s=0,l=!1,c=r.length-1;c>=0;c--)n=parseInt(r.substring(c,a+1)),l?(s=2*n)>9&&(s-=9):s=n,i+=s,l=!l;return i%10==0}(r)||a.validationException(e,i,"Invalid",{context:e,input:t}),r},getSafe:a.getSafe,sanitize:function(e,t){return this.whitelist(t,org.owasp.esapi.EncoderConstants.CHAR_DIGITS)},isValid:a.isValid,whitelist:a.whitelist}},$namespace("org.owasp.esapi.reference.validation"),org.owasp.esapi.reference.validation.DateValidationRule=function(e,t,r){var a=new org.owasp.esapi.reference.validation.BaseValidationRule(e,t,r),i="Date",n=DateFormat.getDateInstance(),o=function(e,t){if(!e||""==e.trim()){if(a.isAllowNull())return null;a.validationException(e,i,"Required",{context:e,input:t,format:n})}var r=a.getEncoder().cananicalize(t);try{return n.parse(r)}catch(r){a.validationException(e,i,"Invalid",{context:e,input:t,format:n})}};return{setDateFormat:function(e){if(!e)throw new IllegalArgumentException("DateValidationRule.setDateFormat requires a non-null DateFormat");n=e},setAllowNull:a.setAllowNull,isAllowNull:a.isAllowNull,getTypeName:a.getTypeName,setTypeName:a.setTypeName,setEncoder:a.setEncoder,getEncoder:a.getEncoder,assertValid:a.assertValid,getValid:a.getValid,getValidInput:function(e,t){return o(e,t)},getSafe:a.getSafe,sanitize:function(e,t){var r=new Date(0);try{r=o(e,t)}catch(e){}return r},isValid:a.isValid,whitelist:a.whitelist}},$namespace("org.owasp.esapi.reference.validation"),org.owasp.esapi.reference.validation.DefaultValidator=function(e,t){var r=Array(),a=e||$ESAPI.encoder(),i=t||org.owasp.esapi.i18n.Locale.getDefault(),n=org.owasp.esapi.reference.validation;return{addRule:function(e){r[e.getName()]=e},getRule:function(e){return r[e]},isValidInput:function(e,t,r,a,i){try{return this.getValidInput(e,t,r,a,i),!0}catch(e){return!1}},getValidInput:function(e,t,r,n,o,s){var l=new org.owasp.esapi.reference.validation.StringValidationRule(r,a,i),c=new RegExp($ESAPI.properties.validation[r]);if(!(c&&c instanceof RegExp))throw new IllegalArgumentException("Invalid Type: "+r+" not found.");l.addWhitelistPattern(c),l.setMaxLength(n),l.setAllowNull(o);try{return l.getValid(e,t)}catch(t){throw t instanceof c.ValidationErrorList&&s&&s.addError(e,t),t}},isValidDate:function(e,t,r,a){try{return this.getValidDate(e,t,r,a),!0}catch(e){return!1}},getValidDate:function(e,t,r,o,s){var l=new n.DateValidationRule(e,a,i);l.setAllowNull(o),l.setDateFormat(r);try{return l.getValid(e,t)}catch(t){throw t instanceof n.ValidationErrorList&&s&&s.addError(e,t),t}},getValidCreditCard:function(e,t,r,o){var s=new n.CreditCardValidationRule(e,a,i);s.setAllowNull(r);try{return s.getValid(e,t)}catch(t){throw t instanceof n.ValidationErrorList&&o&&o.addError(e,t),t}},isValidCreditCard:function(e,t,r){try{return this.getValidCreditCard(e,t,r),!0}catch(e){return!1}},getValidNumber:function(e,t,r,o,s,l){var c=new n.NumberValidationRule(e,a,i,o,s);c.setAllowNull(r);try{return c.getValid(e,t)}catch(t){throw t instanceof n.ValidationErrorList&&l&&l.addError(e,t),t}},isValidNumber:function(e,t,r,a,i){try{return this.getValidNumber(e,t,r,a,i),!0}catch(e){return!1}},getValidInteger:function(e,t,r,o,s,l){var c=new n.IntegerValidationRule(e,a,i,o,s);c.setAllowNull(r);try{return c.getValid(e,t)}catch(t){throw t instanceof n.ValidationErrorList&&l&&l.addError(e,t),t}},isValidInteger:function(e,t,r,a,i){try{return this.getValidInteger(e,t,r,a,i),!0}catch(e){return!1}}}},$namespace("org.owasp.esapi.reference.validation"),org.owasp.esapi.reference.validation.IntegerValidationRule=function(e,t,r,a,i){var n=new org.owasp.esapi.reference.validation.BaseValidationRule(e,t,r),o="Integer",s=a||Number.MIN_VALUE,l=i||Number.MAX_VALUE;if(s>=l)throw new IllegalArgumentException("minValue must be less than maxValue");var c=function(e,t){if(!t||""==t.trim()){if(n.allowNull())return null;n.validationException(e,o,"Required",{context:e,input:t,minValue:s,maxValue:l})}var r=n.getEncoder().cananicalize(t),a=parseInt(r);return"NaN"==a&&n.validationException(e,o,"NaN",{context:e,input:t,minValue:s,maxValue:l}),a<s&&n.validationException(e,o,"MinValue",{context:e,input:t,minValue:s,maxValue:l}),a>l&&n.validationException(e,o,"MaxValue",{context:e,input:t,minValue:s,maxValue:l}),a};return{setMinValue:function(e){s=e},getMinValue:function(){return s},setMaxValue:function(e){l=e},getMaxValue:function(){return l},setAllowNull:n.setAllowNull,isAllowNull:n.isAllowNull,getTypeName:n.getTypeName,setTypeName:n.setTypeName,setEncoder:n.setEncoder,getEncoder:n.getEncoder,assertValid:n.assertValid,getValid:n.getValid,getValidInput:function(e,t){return c(e,t)},getSafe:n.getSafe,sanitize:function(e,t){var r=0;try{r=c(e,t)}catch(e){}return r},isValid:n.isValid,whitelist:n.whitelist}},$namespace("org.owasp.esapi.reference.validation"),org.owasp.esapi.reference.validation.NumberValidationRule=function(e,t,r,a,i){var n=new org.owasp.esapi.reference.validation.BaseValidationRule(e,t,r),o="Number",s=a||Number.MIN_VALUE,l=i||Number.MAX_VALUE;if(s>=l)throw new IllegalArgumentException("MinValue must be less that MaxValue");var c=function(e,t){if(!t||""==t.trim()){if(n.isAllowNull())return null;n.validationException(e,o,"Required",{context:e,input:t,minValue:s,maxValue:l})}var r=n.getEncoder().cananicalize(t),a=0;try{a=parseFloat(r)}catch(r){n.validationException(e,o,"Invalid",{context:e,input:t,minValue:s,maxValue:l})}return"NaN"==a&&n.validationException(e,o,"NaN",{context:e,input:t,minValue:s,maxValue:l}),a<s&&n.validationException(e,o,"MinValue",{context:e,input:t,minValue:s,maxValue:l}),a>l&&n.validationException(e,o,"MaxValue",{context:e,input:t,minValue:s,maxValue:l}),a};return{setMinValue:function(e){s=e},getMinValue:function(){return s},setMaxValue:function(e){l=e},getMaxValue:function(){return l},setAllowNull:n.setAllowNull,isAllowNull:n.isAllowNull,getTypeName:n.getTypeName,setTypeName:n.setTypeName,setEncoder:n.setEncoder,getEncoder:n.getEncoder,assertValid:n.assertValid,getValid:n.getValid,getValidInput:function(e,t){return c(e,t)},getSafe:n.getSafe,sanitize:function(e,t){var r=0;try{r=c(e,t)}catch(e){}return r},isValid:n.isValid,whitelist:n.whitelist}},$namespace("org.owasp.esapi.reference.validation"),org.owasp.esapi.reference.validation.StringValidationRule=function(e,t,r,a){var i=new org.owasp.esapi.reference.validation.BaseValidationRule(e,t,r),n="String",o=Array(),s=Array(),l=0,c=Number.MAX_VALUE,d=!0;if(a)if(a instanceof String)o.push(new RegExp(a));else{if(!(a instanceof RegExp))throw new IllegalArgumentException("sWhiteListPattern must be a string containing RegExp or a RegExp Object");o.push(a)}var u=function(e,t,r){o.each((function(a){t.match(a)&&i.validationException(e,n,"Whitelist",{context:e,input:t,orig:r,pattern:a.toString(),minLength:l,maxLength:c,validateInputAndCanonical:d})}))},m=function(e,t,r){s.each((function(a){t.match(a)&&i.validationException(e,n,"Blacklist",{context:e,input:t,orig:r,pattern:a.toString(),minLength:l,maxLength:c,validateInputAndCanonical:d})}))},p=function(e,t,r){return t.length<l&&i.validationException(e,n,"MinLength",{context:e,input:t,orig:r,minLength:l,maxLength:c,validateInputAndCanonical:d}),t.length>c&&i.validationException(e,n,"MaxLength",{context:e,input:t,orig:r,minLength:l,maxLength:c,validateInputAndCanonical:d}),t},g=function(e,t,r){if(!t||""==t.trim()){if(i.isAllowNull())return null;i.validationException(e,n,"Required",{context:e,input:t,orig:r,minLength:l,maxLength:c,validateInputAndCanonical:d})}};return{addWhitelistPattern:function(e){if(e instanceof String)o.push(new RegExp(e));else{if(!(e instanceof RegExp))throw new IllegalArgumentException("p must be a string containing RegExp or a RegExp Object");o.push(e)}},addBlacklistPattern:function(e){if(e instanceof String)s.push(new RegExp(e));else{if(!(e instanceof RegExp))throw new IllegalArgumentException("p must be a string containing RegExp or a RegExp Object");s.push(e)}},setMinLength:function(e){l=e},getMinLength:function(){return l},setMaxLength:function(e){c=e},getMaxLength:function(){return c},setValidateInputAndCanonical:function(e){d=e},isValidateInputAndCanonical:function(){return d},setAllowNull:i.setAllowNull,isAllowNull:i.isAllowNull,getTypeName:i.getTypeName,setTypeName:i.setTypeName,setEncoder:i.setEncoder,getEncoder:i.getEncoder,assertValid:i.assertValid,getValid:i.getValid,getValidInput:function(e,t){var r=null;return null==g(e,t)?null:(d&&(p(e,t),u(e,t),m(e,t)),r=this.getEncoder().cananicalize(t),null==g(e,r,t)?null:(p(e,r,t),u(e,r,t),m(e,r,t),r))},getSafe:i.getSafe,sanitize:function(e,t){return this.whitelist(t,org.owasp.esapi.EncoderConstants.CHAR_ALNUM)},isValid:i.isValid,whitelist:i.whitelist}},$namespace("org.owasp.esapi.reference.validation"),org.owasp.esapi.reference.validation.ValidationException=function(e,t){var r,a;arguments[2]&&arguments[2]instanceof Exception?(r=arguments[2],arguments[3]&&arguments[3]instanceof String&&(a=arguments[3])):arguments[2]&&arguments[2]instanceof String&&(a=arguments[2]);var i=new org.owasp.esapi.EnterpriseSecurityException(e,t,r);return{setContext:function(e){a=e},getContext:function(){return a},getMessage:i.getMessage,getUserMessage:i.getMessage,getLogMessage:i.getLogMessage,getStackTrace:i.getStackTrace,printStackTrace:i.printStackTrace}};var ESAPI_Standard_en_US={name:"ESAPI Standard Messages - US English",locale:"en-US",messages:{Test:"This is test #{testnumber}","CreditCard.Required.Usr":"{context}: Input credit card required","CreditCard.Required.Log":"Input credit card required: context={context}, input={input}","CreditCard.Invalid.Usr":"{context}: Invalid credit card input","CreditCard.Invalid.Log":"Invalid credit card input: context={context}, input={input}","Date.Required.Usr":"{context}: Input date required in {format} format","Date.Required.Log":"Date required: context={context}, input={input}, format={format}","Date.Invalid.Usr":"{context}: Invalid date, please use {format} format","Date.Invalid.Log":"Invalid date: context={context}, input={input}, format={format}","Integer.Required.Usr":"{context}: Input number required","Integer.Required.Log":"Input number required: context={context}, input={input}, minValue={minValue}, maxValue={maxValue}","Integer.NaN.Usr":"{context}: Invalid number","Integer.NaN.Log":"Invalid number: context={context}, input={input}, minValue={minValue}, maxValue={maxValue}","Integer.MinValue.Usr":"{context}: Invalid number - Must be greater than {minValue}","Integer.MinValue.Log":"Invalid number: context={context}, input={input}, minValue={minValue}, maxValue={maxValue}","Integer.MaxValue.Usr":"{context}: Invalid number - Must be less than {maxValue}","Integer.MaxValue.Log":"Invalid number: context={context}, input={input}, minValue={minValue}, maxValue={maxValue}","Number.Required.Usr":"{context}: Input number required","Number.Required.Log":"Input number required: context={context}, input={input}, minValue={minValue}, maxValue={maxValue}","Number.NaN.Usr":"{context}: Invalid number","Number.NaN.Log":"Invalid number: context={context}, input={input}, minValue={minValue}, maxValue={maxValue}","Number.MinValue.Usr":"{context}: Invalid number - Must be greater than {minValue}","Number.MinValue.Log":"Invalid number: context={context}, input={input}, minValue={minValue}, maxValue={maxValue}","Number.MaxValue.Usr":"{context}: Invalid number - Must be less than {maxValue}","Number.MaxValue.Log":"Invalid number: context={context}, input={input}, minValue={minValue}, maxValue={maxValue}","String.Required.Usr":"{context}: Input required","String.Required.Log":"Input required: context={context}, input={input}, original={orig}","String.Whitelist.Usr":"{context}: Invalid input - Conform to regex {pattern}","String.Whitelist.Log":"Invalid input - Whitelist validation failed: context={context}, input={input}, original={orig}, pattern={pattern}","String.Blacklist.Usr":"{context}: Invalid input - Dangerous input matching {pattern} detected","String.Blacklist.Log":"Invalid input - Blacklist validation failed: context={context}, input={input}, original={orig}, pattern={pattern}","String.MinLength.Usr":"{context}: Invalid input - Minimum length is {minLength}","String.MinLength.Log":"Invalid input - Too short: context={context}, input={input}, original={orig}, minLength={minLength}","String.MaxLength.Usr":"{context}: Invalid input - Maximum length is {maxLength}","String.MaxLength.Log":"Invalid input - Too long: context={context}, input={input}, original={orig}, maxLength={maxLength}","HTTPUtilities.Cookie.Protocol":"Cookies disallowed on non http[s] requests. Current protocol: {protocol}","HTTPUtilities.Cookie.UnsafeData":"Attempt to add unsafe data to cookie (skip mode) - Cookie: {name}={value}","HTTPUtilities.Cookie.CantKill":"Unable to kill cookie named {name}","Cookie.Name":'Cookie name "{name}" is a reserved token',"Cookie.Version":'Cookie version "{version}" is not a valid version. Version must be 0 or 1.'}};$namespace("Base.esapi.properties"),Base.esapi.properties={application:{Name:"ESAPI4JS Base Application"},httputilities:{cookies:{ForceSecure:!0}},logging:{Implementation:org.owasp.esapi.reference.logging.Log4JSLogFactory,Level:org.owasp.esapi.Logger.ERROR,Appenders:[],LogUrl:!1,LogApplicationName:!1,EncodingRequired:!0},encoder:{Implementation:org.owasp.esapi.reference.encoding.DefaultEncoder,AllowMultipleEncoding:!1},localization:{StandardResourceBundle:ESAPI_Standard_en_US,DefaultLocale:"en-US"},validation:{Implementation:org.owasp.esapi.reference.validation.DefaultValidator,AccountName:"^[a-zA-Z0-9]{3,20}$",SafeString:"[a-zA-Z0-9\\-_+]*",Email:"^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\\.[a-zA-Z]{2,4}$",IPAddress:"^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$",URL:"^(ht|f)tp(s?)\\:\\/\\/[0-9a-zA-Z]([-.\\w]*[0-9a-zA-Z])*(:(0-9)*)*(\\/?)([a-zA-Z0-9\\-\\.\\?\\,\\:\\'\\/\\\\\\+=&amp;%\\$#_]*)?$",CreditCard:"^(\\d{4}[- ]?){3}\\d{4}$",SSN:"^(?!000)([0-6]\\d{2}|7([0-6]\\d|7[012]))([ -]?)(?!00)\\d\\d\\3(?!0000)\\d{4}$",HttpScheme:"^(http|https)$",HttpServerName:"^[a-zA-Z0-9_.\\-]*$",HttpParameterName:"^[a-zA-Z0-9_]{1,32}$",HttpParameterValue:"^[a-zA-Z0-9.\\-\\/+=_ ]*$",HttpCookieName:"^[a-zA-Z0-9\\-_]{1,32}$",HttpCookieValue:"^[a-zA-Z0-9\\-\\/+=_ ]*$"}};var crmStickies={contentTextLimit:2e3,contentLimit:6e3,contentEdited:[],contentUpdateRequest:[],lengthElemt:12,wrapperTopPos:"",wrapperLeftPos:"",range:"",timer:0,reminderStickyId:"",toDeleteStickyId:"",reminderStickies:[],stickyViewData:[],lastModifiedStickies:[],crmFreezeLayer:"FreezeLayer",crmStickesNotesDom:"stNotes",crmStickyNotesWrapper:"sticky-notes-wrapper",crmStickyNotesContenteditable:"sticky-notes-contenteditable",crmStickyNotesLabel:"sticky-notes-label",windowHeight:"",windowWidth:"",updateRequested:0,initRequest:function(e,t,r,a){var i=new crmRequestPool;return i.initiate({action:e,type:t,headers:{"X-ZCSRF-TOKEN":csrfParamName+"="+csrfToken},data:r,success:function(e){a(e)}}),i},showReminderNotification:function(){crmStickies.windowHeight=renderingUtils.windowHeight-50,crmStickies.windowWidth=renderingUtils.windowWidth-50,crmStickies.initRequest("/crm/v2/Stickies","GET","",(function(e){if(null!=e){for(var t=e.stickies,r=t.length,a=0;a<r;a++){var i=t[a].stickyId;t[a].properties.firstSticky&&(t[a].content=I18n.getMsg("crm.sticky.create.content.dynamic",Crm.appName)),crmStickies.stickyViewData[i]=t[a],t[a].hasReminderAlert&&(crmStickies.reminderStickies.contains(i)||crmStickies.reminderStickies.push(i)),crmStickies.lastModifiedStickies.push(i)}crmStickies.showReminders(),crmStickies.displayStickyNotes()}}))},getStickiesArray:function(){for(var e=Object.keys(crmStickies.stickyViewData),t=[],r=e.length,a=crmStickies.getLastModified(),i=0;i<r;i++){e[i]!=a?crmStickies.stickyViewData[e[i]].last_modified=!1:crmStickies.stickyViewData[e[i]].last_modified=!0;var n=crmStickies.stickyViewData[e[i]];t.push(n)}return t},updateLastModified:function(e,t){crmStickies.removeFromLastModifiedStickies(e),t||(crmStickies.lastModifiedStickies[crmStickies.lastModifiedStickies.length]=e)},getLastModified:function(){return crmStickies.lastModifiedStickies[crmStickies.lastModifiedStickies.length-1]},reInitStickiesContentUpdate:function(){crmStickies.contentEdited=$u.union(crmStickies.contentEdited,crmStickies.contentUpdateRequest),crmStickies.contentUpdate()},removeFromReminderStickies:function(e){if(crmStickies.reminderStickies.contains(e)){var t=crmStickies.reminderStickies.indexOf(e);crmStickies.reminderStickies.splice(t,1)}},removeFromLastModifiedStickies:function(e){if(crmStickies.lastModifiedStickies.contains(e)){var t=crmStickies.lastModifiedStickies.indexOf(e);crmStickies.lastModifiedStickies.splice(t,1)}},removeFromContentEditedStickies:function(e){if(crmStickies.contentEdited.contains(e)){var t=crmStickies.contentEdited.indexOf(e);crmStickies.contentEdited.splice(t,1)}},displayStickyNotes:function(){var e=$("#"+crmStickies.crmStickesNotesDom),t=crmStickies.getStickiesArray();if(t=crmStickies.resizeViewDataLayoutPosition(t),e.append(Handlebars.templates.viewNotes({viewdata:t})),$.each(t,(function(e,t){crmStickies.setToolBarMethods(t.stickyId)})),0==Object.keys(crmStickies.stickyViewData).length)crmStickies.createStickyNewNote();else{for(var r=t.length,a=0;a<r;a++)t[a].hasReminderAlert||crmStickies.removeFromReminderStickies(t[a].stickyId);crmStickies.updateNotificationCount(),crmStickies.resizableSN("contentEditableID"),crmStickies.draggableSN();var i=$("."+crmStickies.crmStickyNotesContenteditable);i.on("keyup keydown",crmStickies.stickyNotesWrapperKeyRelease),i.on("blur",crmStickies.stickyNotesSaveContent),Crm.userDetails.ISROMODE&&(i.attr("contenteditable",!1),$(".sticky-notes-wrapper.active").find(".sticky-notes-contenteditable").focus())}},viewStickyNewNote:function(e){Crm.trackSpotLightAction("Sticky Notes - View Click");var t=$(e),r=t.attr("data-active"),a=$("."+crmStickies.crmStickyNotesContenteditable);if("viewed"==r)crmStickies.contentUpdate(),$("#basic").off("keyup",crmStickies.documentKeyup),$("#sticky-delete-warning-popup,#sticky-remainder-popup").remove(),crmStickies.remainderClose(),crmStickies.hideShowMsgBand(),a.off("keyup keydown",crmStickies.stickyNotesWrapperKeyRelease),a.off("blur",crmStickies.stickyNotesSaveContent),$("."+crmStickies.crmStickyNotesWrapper).remove(),removeFreezeLayer(),$("html").removeClass("oH"),crmStickies.unbindfreezeClick(),$("#"+crmStickies.crmFreezeLayer).css({opacity:"0.4"}),$("#"+crmStickies.crmStickesNotesDom).css("display","none").hide(),t.attr("data-active","view").removeClass("stNotestActive"),crmStickies.showReminders();else{var i=$("#basic");i.on("keyup",crmStickies.documentKeyup);var n=$("#"+crmStickies.crmStickesNotesDom);0===n.length&&(Handlebars.registerPartial("stickyNotesMain",Handlebars.templates.stickyNotesMain),i.append(Handlebars.templates.stickyNotesMain()),Crm.userDetails.ISROMODE&&$("."+crmStickies.crmStickesNotesDom).addClass("stickies_ro_mode"),n=$("#"+crmStickies.crmStickesNotesDom)),freezeBackground(),$(window).scrollTop(0),crmStickies.freezeLayerClick(),$("html").addClass("oH"),$("#"+crmStickies.crmFreezeLayer).css({opacity:"0.1"}),$("."+crmStickies.crmStickyNotesWrapper).remove(),n.css("display","block").show(),t.attr("data-active","view").addClass("stNotestActive"),Handlebars.registerPartial("viewNotes",Handlebars.templates.viewNotes),"view"==t.attr("data-active")&&(0==Object.keys(crmStickies.stickyViewData).length?crmStickies.showReminderNotification():crmStickies.displayStickyNotes(),t.attr("data-active","viewed")),$("."+crmStickies.crmStickyNotesLabel).removeClass("active")}},createStickyNewNote:function(){if(Crm.trackSpotLightAction("Sticky Notes - Add New Click"),$(".colorPickerDropdown").hide(),!Crm.userDetails.ISROMODE){freezeBackground(),Handlebars.registerPartial("createnewNotes",Handlebars.templates.createnewNotes);var e={};crmStickies.positionBox(),e.properties=JSON.stringify({leftPos:crmStickies.wrapperLeftPos,topPos:crmStickies.wrapperTopPos});var t=[];t.push(e);var r={stickies:t};crmStickies.updateRequested++,crmStickies.initRequest("/crm/v2/Stickies","POST",JSON.stringify(r),(function(e){if(null!==e){var t=e.stickies[0];if("SUCCESS"!==t.code)crmui.showMsgBand("warning",t.message,3e3);else{var r={};r.stickyId=t.details.id,r.hasReminder=!1,r.last_modified=t.details.last_modified,r.content=t.details.content,r.properties=t.details.properties,$("."+crmStickies.crmStickyNotesWrapper).removeClass("active"),$("#"+crmStickies.crmStickesNotesDom).append(Handlebars.templates.createnewNotes(r)),crmStickies.resizableSN("contentEditableID"),crmStickies.draggableSN(),$(".active."+crmStickies.crmStickyNotesWrapper).find(".sticky-notes-contenteditable").focus();var a=$("."+crmStickies.crmStickyNotesContenteditable);a.on("keyup keydown",crmStickies.stickyNotesWrapperKeyRelease),a.on("blur",crmStickies.stickyNotesSaveContent),crmStickies.stickyViewData[r.stickyId]=r,crmStickies.updateLastModified(r.stickyId),crmStickies.setToolBarMethods(r.stickyId)}}}))}},setToolBarMethods:function(e){var t="stickyFRColorPicker"+e,r="stickyBGColorPicker"+e,a="sticky-fs-"+e;document.getElementById(t).setMethods({onSelect:function(e,t){crmStickies.toolbar("",t.hex,"foreColor")}}),document.getElementById(r).setMethods({onSelect:function(e,t){crmStickies.toolbar("",t.rgb,"backColor")}}),document.getElementById(a).setMethods({onMenuClick:function(e){crmStickies.toolbar("",e,"fontSize")}})},updateStickyNotes:function(e,t){var r={stickies:e},a=null!=t;if(!a||0!=Object.keys(e[0]).length){crmStickies.updateRequested++;var i="/crm/v2/Stickies"+(a?"/"+t:"");crmStickies.initRequest(i,"PUT",JSON.stringify(r),(function(r){if(null!=r){crmStickies.contentUpdateRequest=[];for(var i=(r=r.stickies).length,n=$("#stickyReminderErrMsg"),o=0;o<i;o++){var s=r[o];if("SUCCESS"!==s.code)a&&void 0!==e[0].addReminder?n.text(s.message):(crmStickies.stickyNotesActive($("#"+s.details.stickyId).parent()),crmui.showMsgBand("warning",s.message,3e3));else{if(t=s.details.id,a&&void 0!==e[0].addReminder)crmStickies.remainderClose(),crmui.showMsgBand("success",s.message,3e3);else if(a){var l=$("#sticky_main_"+t);l.hasClass("sticky-remainder-alert")&&void 0!==e[0].dismissReminder&&(l.removeClass("sticky-remainder-alert"),crmStickies.removeFromReminderStickies(t),crmStickies.updateNotificationCount(),crmStickies.stickyViewData[t].hasReminderAlert=!1,crmui.showMsgBand("success",s.message,3e3))}crmStickies.stickyViewData[t].content=void 0!==s.details.properties.firstSticky?I18n.getMsg("crm.sticky.create.content.dynamic",Crm.appName):s.details.content,crmStickies.stickyViewData[t].properties=s.details.properties,crmStickies.updateLastModified(t),a||Crm.trackSpotLightAction("Sticky Notes - Content Modified")}}}}))}},destroy:function(e){crmStickies.hideShowMsgBand(),$("#basic").append(Handlebars.templates.stickyNotesDeletePopup()),$(".colorPickerDropdown").hide(),crmStickies.toDeleteStickyId=$(e).parents(".sticky-notes-wrapper").attr("sticky-id"),$("#"+crmStickies.toDeleteStickyId).html().length>0?($("#sticky-delete-warning-popup").addClass("zcrm-show"),$("#"+crmStickies.crmFreezeLayer).css({"z-index":"306"}),crmStickies.unbindfreezeClick()):crmStickies.stdeleteSubmit()},stdeleteCancel:function(){$("#"+crmStickies.crmFreezeLayer).css({"z-index":"20"}),crmStickies.toDeleteStickyId="",crmStickies.freezeLayerClick(),$("#sticky-delete-warning-popup").remove()},stdeleteSubmit:function(){Crm.userDetails.ISROMODE?crmStickies.stdeleteCancel():(Crm.trackSpotLightAction("Sticky Notes - Delete Sticky Click"),crmStickies.updateRequested++,crmStickies.initRequest("/crm/v2/Stickies/"+crmStickies.toDeleteStickyId,"DELETE","",(function(e){if(null!=e){$("#sticky_main_"+crmStickies.toDeleteStickyId).remove(),crmStickies.removeFromContentEditedStickies(crmStickies.toDeleteStickyId),delete crmStickies.stickyViewData[crmStickies.toDeleteStickyId],crmStickies.updateLastModified(crmStickies.toDeleteStickyId,!0);var t=crmStickies.getLastModified();crmStickies.toDeleteStickyId!==t&&($("#sticky_main_"+t).addClass("active"),$(".sticky-notes-wrapper.active").find(".sticky-notes-contenteditable").focus())}crmStickies.stdeleteCancel()})))},draggableSN:function(){$(".colorPickerDropdown").hide(),$("."+crmStickies.crmStickyNotesWrapper).draggable({containment:"window",start:function(e){$(e.currentTarget.offsetParent).one("click",(function(e){e.stopPropagation()}))},scroll:!1,stop:function(){crmStickies.propertiesUpdate($(this))},handle:".sticky-notes-header,.sticky-notes-toolbar"})},positionBox:function(){var e=crmStickies.windowHeight;crmStickies.wrapperTopPos=30,crmStickies.wrapperLeftPos=100;var t=$("."+crmStickies.crmStickyNotesWrapper),r=t.length;if(r){var a=$(t[r-1]),i=a.offset().top,n=a.offset().left,o=i+a.outerHeight();if((i=o+250)>e){var s=document.elementFromPoint(i,200);if($(s).length)crmStickies.wrapperTopPos=crmStickies.wrapperTopPos+crmStickies.lengthElemt,crmStickies.wrapperLeftPos=n,crmStickies.lengthElemt=crmStickies.lengthElemt+12,crmStickies.wrapperTopPos+250>e&&(crmStickies.lengthElemt=0,crmStickies.wrapperTopPos=30+crmStickies.lengthElemt,0==crmStickies.lengthElemt&&(crmStickies.lengthElemt=crmStickies.lengthElemt+12))}else crmStickies.wrapperTopPos=o,crmStickies.wrapperLeftPos=n}},stickyNotesActive:function(e){var t=$(e),r=t.height();if($(".colorPickerDropdown").hide(),t.hasClass("sticky-remainder-alert")&&t.hasClass("sncollapseOut"))crmStickies.dismissReminder(t);else if(!t.hasClass("active")&&!Crm.userDetails.ISROMODE){var a=$(".active."+crmStickies.crmStickyNotesWrapper),i=a.attr("data-height");a.css("height",i),$("."+crmStickies.crmStickyNotesWrapper).removeClass("active"),t.addClass("active"),t.find(".sticky-notes-contenteditable").focus()}t.css("height",r)},toggleNotesEditor:function(e){var t=$(e),r=t.parent(),a=r.find("sticky-notes-toolbar").height(),i=r.attr("data-height");$(".colorPickerDropdown").hide(),r.hasClass("sncollapseOut")?(r.removeClass("sncollapseOut"),r.addClass("sncollapseIn"),r.attr("data-collapse","sncollapseIn"),t.find(".sticky-minimize-icon").removeClass("sticky-minimize-icon").addClass("sticky-maximize-icon")):(r.removeClass("sncollapseIn"),r.addClass("sncollapseOut"),r.attr("data-collapse","sncollapseOut"),a>0&&(i-=21),r.css("height",i),t.find(".sticky-maximize-icon").removeClass("sticky-maximize-icon").addClass("sticky-minimize-icon"));var n=r.find(".sticky-notes-contenteditable");n.focus();var o=n.text();t.find(".sticky-notes-header-text").text(o),crmStickies.propertiesUpdate(r)},resizableSN:function(e){$("."+crmStickies.crmStickyNotesWrapper).resizable({alsoResize:"#"+e,containment:"window",maxHeight:renderingUtils.windowHeight-30,start:function(e){$(e.currentTarget.offsetParent).one("click",(function(e){e.stopPropagation()}))},stop:function(){var e=$(this),t=e.height(),r=e.width(),a=e.find(".sticky-notes-contenteditable"),i=a.height();e.removeClass("resizable-active"),0==i?a.css("display","none"):a.css("display","block"),e.attr({"data-width":r,"data-height":t}),crmStickies.propertiesUpdate(e)}})},hoverToolbar:function(){crmStickies.range=crmStickies.saveSelection(),$(".sticky-notes-wrapper.active").find(".sticky-notes-contenteditable").focus()},toolbar:function(e,t,r){crmStickies.restoreSelection(crmStickies.range);var a=$(".sticky-notes-wrapper.active");if("foreColor"==r&&null!=r){var i=t,n=a.attr("sticky-id");document.execCommand("foreColor",!1,i)}else if("backColor"==r&&null!=r){i=t,n=a.attr("sticky-id");document.execCommand("backColor",!1,i)}else if("fontSize"==r&&null!=r){i=parseInt(t),n=a.attr("sticky-id");document.execCommand("fontSize",!1,i)}else{var o=$(e).attr("command");n=a.attr("sticky-id");document.execCommand(o,!1,!0)}null!=crmStickies.range&&crmStickies.range.endOffset!=crmStickies.range.startOffset&&(crmStickies.contentEdited.contains(n)||crmStickies.contentEdited.push(n)),crmStickies.range=crmStickies.saveSelection(),a.find(".sticky-notes-contenteditable").focus()},hideShowMsgBand:function(){$("#crm-msg").remove()},saveSelection:function(){var e=window.getSelection?window.getSelection():document.selection,t=null;return e&&(e.createRange?t=e.createRange():e.rangeCount>0&&e.getRangeAt?t=e.getRangeAt(0):e.anchorNode&&e.focusNode&&_doc.createRange&&((t=_doc.createRange()).setStart(e.anchorNode,e.anchorOffset),t.setEnd(e.focusNode,e.focusOffset),t.collapsed!==e.isCollapsed&&(t.setStart(e.focusNode,e.focusOffset),t.setEnd(e.anchorNode,e.anchorOffset)))),t},restoreSelection:function(e){var t=window.getSelection?window.getSelection():document.selection;t&&e&&(e.select?e.select():t.removeAllRanges&&t.addRange&&(t.removeAllRanges(),t.addRange(e)))},colorPickerChange:function(e){var t=$(e),r=t.attr("class");t.parents(".colorPickerDropdown").hide();var a=t.parents("."+crmStickies.crmStickyNotesWrapper);a.removeClass("ping blue purple green gray yellow"),a.addClass(r),a.attr({"note-color":r}),crmStickies.propertiesUpdate(a)},colorPicker:function(e){var t=$(e);crmStickies.stickyNotesActive(t.parents("."+crmStickies.crmStickyNotesWrapper)),t.find(".colorPickerDropdown").toggle()},contentUpdate:function(e){if(!Crm.userDetails.ISROMODE){var t=[];if(!e){var r=$(".sticky-notes-wrapper.active").attr("sticky-id");crmStickies.contentEdited.contains(r)||crmStickies.contentEdited.push(r)}crmStickies.contentUpdateRequest=crmStickies.contentEdited.slice();for(var a=crmStickies.contentUpdateRequest.length,i=0;i<a;i++){var n=crmStickies.contentUpdateRequest[i],o=$("#"+n);if(o.length>0){var s=o.text().length,l=o.html();if(s>crmStickies.contentTextLimit||l.length>crmStickies.contentLimit)crmStickies.stickyViewData[n].content=l,crmui.showMsgBand("warning",I18n.getMsg("crm.sticky.create.contentLimitExceeded"),3e3),crmStickies.stickyNotesActive(o.parent());else{var c={};c.id=n,c.content=l,c.contentLength=s,t.push(c)}}crmStickies.removeFromContentEditedStickies(n)}t.length>0&&crmStickies.updateStickyNotes(t)}},propertiesUpdate:function(e){if(!Crm.userDetails.ISROMODE){var t={};t.id=e.attr("sticky-id"),t.properties=JSON.stringify(crmStickies.getStickyProperties(e));var r=[];r.push(t),crmStickies.updateStickyNotes(r,t.id)}},getStickyProperties:function(e){var t={},r=$(e);return t.leftPos=r.offset().left,t.topPos=r.offset().top,t.widthParent=r.width(),t.heightParent=r.height(),t.color=r.attr("note-color"),t.dataCollapse=r.attr("data-collapse"),t},resizeLayoutPosition:function(){crmStickies.windowHeight=renderingUtils.windowHeight-50,crmStickies.windowWidth=renderingUtils.windowWidth-50;for(var e=$("."+crmStickies.crmStickyNotesWrapper),t=e.length,r=[],a=0;a<t;a++)r[a]={},r[a].dom=e.eq(a),r[a].sLeft=r[a].dom.offset().left,r[a].sTop=r[a].dom.offset().top,r[a].sLeft+r[a].dom.width()>crmStickies.windowWidth&&(r[a].sLeft=crmStickies.windowWidth-r[a].dom.width()),r[a].sTop+r[a].dom.height()>crmStickies.windowHeight&&(r[a].sTop=crmStickies.windowHeight-r[a].dom.height()),r[a].sTop<=0&&(r[a].sTop=0),r[a].sLeft<=0&&(r[a].sLeft=0);for(a=0;a<t;a++)r[a].dom.css({left:r[a].sLeft,top:r[a].sTop})},resizeViewDataLayoutPosition:function(e){for(var t=e.length,r=0;r<t;r++){var a=e[r].properties.leftPos,i=e[r].properties.topPos,n=e[r].properties.widthParent,o=e[r].properties.heightParent;a+n>crmStickies.windowWidth&&(a=crmStickies.windowWidth-n),i+o>crmStickies.windowHeight&&(i=crmStickies.windowHeight-o),i<=0&&(i=0),a<=0&&(a=0),e[r].properties.leftPos=a,e[r].properties.topPos=i}return e},remainder:function(e){crmStickies.hideShowMsgBand(),$("#basic").append(Handlebars.templates.stickyNotesReminderPopup()),"HH:mm"==Crm.userDetails.TIME_FORMAT&&$(".stickyremindAtAMPM").hide();var t=$(e).parents("."+crmStickies.crmStickyNotesWrapper);crmStickies.stickyNotesActive(t);var r=t.attr("sticky-id");$("#sticky-remainder-popup").addClass("zcrm-show"),$("#"+crmStickies.crmFreezeLayer).css({"z-index":"306"}),crmStickies.reminderStickyId=r,populateTimeVal(),crmStickies.getCurrentDateofYear(),crmStickies.unbindfreezeClick()},remainderSubmit:function(){var e={};e.date=$("#stickyremindAtDate").val();var t=$("#stickyremindAtTime").attr("time").split(":");e.hour=t[0],e.minute=t[1],e.ampm=t[2],e.id=crmStickies.reminderStickyId,e.addReminder=!0;var r=[];r.push(e),crmStickies.updateStickyNotes(r,e.id),Crm.trackSpotLightAction("Sticky Notes -  Reminder Submit")},clearReminderErrMsg:function(){$("#stickyReminderErrMsg").text("")},remainderClose:function(){crmStickies.clearReminderErrMsg(),$("#"+crmStickies.crmFreezeLayer).css({"z-index":"20"}),crmStickies.reminderStickyId="",crmStickies.freezeLayerClick(),$("#sticky-remainder-popup").remove()},updateReminderCount:function(e){var t=e.id;crmStickies.stickyViewData&&crmStickies.stickyViewData[t]&&(crmStickies.reminderStickies.contains(t)||crmStickies.reminderStickies.push(t),crmStickies.stickyViewData[t].hasReminderAlert=!0,crmStickies.showReminders())},updateNotificationCount:function(e){crmStickies.reminderStickies.length>0?(e||setTimeout((function(){crmStickies.showReminders()}),100),$("#sticky-notification-count").text(crmStickies.reminderStickies.length).show()):$("#sticky-notification-count").empty().hide(),isLoadedInCRMPlusIFrame()&&CrmPlusImpl.trigger("setNotificationCount",["stickynotes",crmStickies.reminderStickies.length])},showReminders:function(){var e=$("#"+crmStickies.crmStickesNotesDom).length;if(crmStickies.updateNotificationCount(e),e)for(var t=crmStickies.reminderStickies.length,r=0;r<t;r++){$("."+crmStickies.crmStickyNotesWrapper).removeClass("active"),$("#sticky_main_"+crmStickies.reminderStickies[r]).addClass("sticky-remainder-alert active")}},dismissReminder:function(e){var t=$(e).attr("sticky-id");if(!Crm.userDetails.ISROMODE){var r={};r.id=t,r.properties=JSON.stringify(crmStickies.getStickyProperties(e)),r.dismissReminder=!0;var a=[];a.push(r),crmStickies.updateStickyNotes(a,r.id)}},hideStickiesLayer:function(){(removeFreezeLayer(),$("html").removeClass("oH"),crmStickies.unbindfreezeClick(),$("#"+crmStickies.crmFreezeLayer).css({opacity:"0.4"}),$("#"+crmStickies.crmStickesNotesDom).css("display","none").hide(),$(".sticky-notes-label").attr("data-active","view").removeClass("stNotestActive"),"undefined"!=typeof CrmPlusImpl&&CrmPlusImpl.isLoadedInCrmplus())&&$(CrmPlusImpl).attr("data-active","view")},freezeLayerClick:function(){$("#"+crmStickies.crmFreezeLayer).click((function(){crmStickies.hideStickiesLayer()}))},unbindfreezeClick:function(){$("#"+crmStickies.crmFreezeLayer).off("click"),crmStickies.contentUpdate()},getCurrentDateofYear:function(){var e="HH:mm"==Crm.userDetails.TIME_FORMAT,t=new Date;t.getMinutes()<30?t.setHours(t.getHours()+1):t.setHours(t.getHours()+2),t.setMinutes(0);var r,a,i,n=e?Utils.getTimeInUserFormat(t):Utils.convertTo12HoursFormatTimeObj(t),o=("0"+t.getMinutes()).slice(-2);if(e)a=r=(i=("0"+t.getHours()).slice(-2))+":"+o;else{i=("0"+Utils.convertTimeTo12HoursFormat(t.getHours(),n.meridiem)).slice(-2);var s=n.meridiem.toUpperCase();r=i+":"+o+":"+s,a=i+":"+o,$(".stickyremindAtAMPM").text(I18n.getMsg(s)).attr("ampm",s)}$("#stickyremindAtDate").val(Utils.getDateInUserDatePattern(t)),$("#stickyremindAtTime").val(a).attr("time",r)},handleCustomMessage:function(e){"stickies-remainder"===e.moduleClass?crmStickies.updateReminderCount(e):"updateRequest_custom_message"===e.moduleClass&&(crmStickies.updateRequested>0?crmStickies.updateRequested--:"viewed"===$("."+crmStickies.crmStickyNotesLabel).attr("data-active")&&(crmStickies.viewStickyNewNote($("."+crmStickies.crmStickyNotesLabel)),crmStickies.stickyViewData=[]))},stickyNotesSaveContent:function(e){0!==$(e.relatedTarget).length&&crmStickies.contentUpdate(!0)},stickyNotesWrapperKeyRelease:function(e){crmStickies.range="";var t=27===e.keyCode;if(t||e.stopPropagation(),!(t||e.keyCode<20&&8!==e.keyCode)){var r=$(e.target).attr("id");if(crmStickies.contentEdited.contains(r)||crmStickies.contentEdited.push(r),(null!=e.target.innerText?e.target.innerText.length:e.target.textContent.length)>=crmStickies.contentTextLimit){var a=!1,i=!0===e.metaKey||!0===e.ctrlKey;i&&86===e.keyCode?a=!0:8===e.keyCode||27===e.keyCode||e.keyCode>=35&&e.keyCode<=40||i||i&&(65===e.keyCode||67===e.keyCode)||(a=!0),a&&(crmui.showMsgBand("warning",I18n.getMsg("crm.sticky.create.contentLimitExceeded"),3e3),e.preventDefault())}}},documentKeyup:function(e){if(27===e.keyCode){var t=$("."+crmStickies.crmStickyNotesLabel);"viewed"===t.attr("data-active")&&crmStickies.viewStickyNewNote(t)}},beforeUnload:function(){crmStickies.contentUpdate()},showColorPicker:function(e,t){Lyte.injectResources(networkUtils.returnDependencyFiles(["lyte-colorpicker.js"],crmConstants.jsStaticPathForLyte),void 0,(function(){var r={originElement:"#"+e,basicColorPicker:!0,show:!0,closeOnBodyClick:!0,colorPreview:!1,usedColors:!1,standardColors:!1,title:I18n.getMsg(t),advancedColorButton:!1,closeOnSelection:!0};document.getElementById(e).querySelector("lyte-colorpicker").ltProp(r)}))},clearStikcyValue:function(){crmStickies.range=""}};window.onbeforeunload=crmStickies.beforeUnload;var eventMethod=window.addEventListener?"addEventListener":"attachEvent",eventer=window[eventMethod],messageEvent="attachEvent"==eventMethod?"onmessage":"message";function CrmDate(e,t){"string"!=typeof e&&"number"!=typeof e||(e=new Date(e));var r=e||new Date,a=r.getUTCMinutes(),i=t?a+CrmDateUtils.getTimeOffsetInMins(Crm.userDetails.ORGTIME_ZONE):a+CrmDateUtils.getTimeOffsetInMins(Crm.userDetails.TIME_ZONE);this.primitiveDateObject=new Date(r.getTime()),r.setUTCMinutes(i),this.userDisplayDate=r.getUTCDate(),this.userDisplayMonth=r.getUTCMonth()+1,this.userDisplayYear=r.getUTCFullYear(),this.userHourIn24hrFmt=r.getUTCHours(),this.userDisplayMinute=r.getUTCMinutes(),this.userDisplayDay=I18n.getMsg(["ssun","smon","stue","swed","sthu","sfri","ssat"][r.getUTCDay()]),this.userDisplayMonthName=I18n.getMsg(["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][r.getUTCMonth()]),this.dateObject=r}eventer(messageEvent,(function(e){var t=RebrandLinkUtil.getProperty("index_zoho_url");if(t&&t.includes(e.origin)&&e.data.score){var r=e.data,a="https://"+RebrandLinkUtil.getProperty("CRMURL")+"/crm/v2/npssurvey";networkUtils.setCsrfParam(r),$.ajax({type:"POST",url:a,data:e.data})}}),!1),CrmDate.prototype.getDateTimeInUserPattern=function(){return this.getDateInUserPattern()+" "+this.getTimeInUserPattern()},CrmDate.prototype.getDateInUserPattern=function(){var e=Crm.userDetails.DATE_PATTERN;return this.getDateInPattern(e)},CrmDate.prototype.getDateTimeInDefault=function(){return this.getDateInPattern("YYYY-MM-DD")+" "+this.userHourIn24hrFmt+":"+this.userDisplayMinute},CrmDate.prototype.getDateInPattern=function(e){return e=(e=e.toUpperCase()).replace("EEE","ddd"),$L.moment(new Date(this.userDisplayYear,this.userDisplayMonth-1,this.userDisplayDate)).format(e)},CrmDate.prototype.validate=function(){try{return $L.moment(this.dateObject).validate()}catch(e){return!1}},CrmDate.prototype.getTimeInUserPattern=function(e){var t;if("HH:mm"===Crm.userDetails.TIME_FORMAT)t=Utils.formatTimeVal(this.userHourIn24hrFmt)+":"+Utils.formatTimeVal(this.userDisplayMinute);else{var r=null;12==this.userHourIn24hrFmt||this.userHourIn24hrFmt>12?r="PM":this.userHourIn24hrFmt<12&&(r="AM");var a=Utils.convertTimeTo12HoursFormat(this.userHourIn24hrFmt,r),i=e?r:I18n.getMsg(r);t=Utils.formatTimeVal(a)+":"+Utils.formatTimeVal(this.userDisplayMinute)+" "+i}return t},CrmDate.prototype.getFormattedTime=function(){return this.isToday()?this.getTimeInUserPattern():this.isCurrentYear()?this.getDateInPattern("MMM DD"):this.getDateInPattern("MMM DD,YYYY")},CrmDate.prototype.isToday=function(){return this.getDateInUserPattern()==(new CrmDate).getDateInUserPattern()},CrmDate.prototype.isCurrentYear=function(){return this.userDisplayYear==(new CrmDate).userDisplayYear},CrmDate.prototype.isFutureTime=function(){return this.dateObject>(new CrmDate).dateObject},CrmDate.prototype.greaterThanCrmDate=function(e){return this.dateObject>e.dateObject},CrmDate.prototype.lesserThanCrmDate=function(e){return this.dateObject<e.dateObject},CrmDate.prototype.leadingTimeInMins=function(e){var t=e||new CrmDate,r=this.dateObject.getTime()-t.dateObject.getTime();return Math.round(r/6e4)},CrmDate.prototype.leadingTimeInDays=function(e){var t=e||new CrmDate,r=new Date(this.userDisplayYear,this.userDisplayMonth-1,this.userDisplayDate),a=new Date(t.userDisplayYear,t.userDisplayMonth-1,t.userDisplayDate),i=(r.getTime()-a.getTime())/1e3;return i/=86400,Math.round(i)};var CrmDateUtils={getTimeOffsetInMins:function(e){var t=e.split("."),r=t[0],a=t[1],i=Math.abs(60*r)+Number(a);return i=Number(r)>=0?i:-1*i},getCrmDateFromUserTime:function(e,t,r,a,i,n,o){n=n||"00";var s=Utils.getTimezoneOffset(),l=parseInt(s/60),c=parseInt(s%60),d=l<0?"GMT+":"GMT-";c=(c=c<0?-1*c:c)<10?"0"+c:c,l=l<0?-1*l:l;var u=e+"/"+t+"/"+r+" "+a+":"+i+":"+n;if("HH:mm"!=Crm.userDetails.TIME_FORMAT&&o){-1!=["AM","PM","am","pm"].indexOf(o)?u=u+" "+o:I18n.getMsg("AM")==o||I18n.getMsg("am")==o?u+=" AM":I18n.getMsg("PM")!=o&&I18n.getMsg("pm")!=o||(u+=" PM")}return u=u+" "+d+l+c,new CrmDate(new Date(u))},getCrmDateAfterMins:function(e){var t=(new Date).getTime()+6e4*e;return new CrmDate(new Date(t))},getCrmDateAfterMillis:function(e,t){var r=(t=t||new Date).getTime()+e;return new CrmDate(new Date(r))},getAfterMinsByCrmdate:function(e,t){var r=t.primitiveDateObject.getTime()+6e4*e;return new CrmDate(new Date(r))},isValidDate:function(e,t){if(!e)return!1;t||(t=Crm.userDetails.DATE_PATTERN.toUpperCase());try{return $L.moment(e,t).validate()}catch(e){return!1}},getDateObjectFromString:function(e,t){if(!e)return new Date;if(!e.getMonth){var r;if(!t)if(t=Crm.userDetails.DATE_PATTERN.toUpperCase(),e.indexOf(":")>-1){var a=Crm.userDetails.TIME_FORMAT;(e.indexOf("AM")>1||e.indexOf("PM")>1)&&(a=a.replace("a","A")),t+=" "+a}try{r=$L.moment(e.trim(),t.trim()).getDObj()}catch(e){murphy.error(e)}return r||(r=new Date),r}return e},convertDateToUserPattern:function(e,t){return t||(t=Crm.userDetails.DATE_PATTERN.toUpperCase()),$L.moment(new Date(e)).format(t)},getFormattedDate:function(e){return $L.moment(new Date(e)).format("YYYY-MM-DD")},getDateInPattern:function(e,t){return $L.moment(new Date(e)).format(t)},convertDateToISO:function(e,t,r){return void 0===t&&(t="DD/MM/YYYY"),void 0===r&&(r="T00:00:00%2B00:00"),e&&""!=e?CrmDateUtils.getFormattedDate(this.getDateObjectFromString(e,t))+r:""},convertDateTimetoISOFormat:function(e){var t=e.indexOf(":"),r=e.substring(0,t-3),a=e.substring(t-2,e.length),i=[];i.push(r);var n=a.split(" ");i.push(n[0]),n.length>1&&i.push(n[1]);var o=CrmDateUtils.convertdateToDBformat(i[0]),s=i[1].split(":"),l=Crm.userDetails.TIME_ZONE.replace(".",":"),c=parseInt(s[0]);c="HH:mm"==Crm.userDetails.TIME_FORMAT?c:Utils.convertTimeTo24HoursFormat(c,i[2]);var d=parseInt(s[1]);c<10&&(c="0"+c),d<10&&(d="0"+d);return o+"T"+(c+":"+d+":00")+l},convertdateToDBformat:function(e){var t=CrmDateUtils.getDateObjectFromString(e);return $L.moment(new Date(t)).format("YYYY-MM-DD")},convertDateAndTimeApiFormatToUserViewFormat:function(e){var t,r,a,i=null,n=null,o=null,s=null;return i=new Date(e),(s=(o=e).substring(o.length-6).split(":"))[0].substring(0,1),s[1]=parseInt(s[1]),t=(i=new Date(o.substr(0,o.length-6))).getMonth(),r=i.getDate(),a=i.getFullYear(),n=Utils.getTimeStringWithAmPm(i),"HH:mm"!==Crm.userDetails.TIME_FORMAT?I18n.getMsg(CrmTags.shortMonth[t])+" "+r+", "+a+" "+n.hrs+":"+n.mins+" "+I18n.getMsg(n.meridiem.toUpperCase()):I18n.getMsg(CrmTags.shortMonth[t])+" "+r+", "+a+" "+n.hrs+":"+n.mins},covertTimeValueTo24HourFormat:function(e){var t=e.split(":"),r=t[0],a=t[1].split(" "),i=a[0];return null!=a[1]&&a[1].toUpperCase()==I18n.getMsg("AM")&&"12"==r&&(r="0"),null!=a[1]&&a[1].toUpperCase()==I18n.getMsg("PM")&&r<12&&(r=Number(r)+12),Number(r)<10&&r.toString().length<2&&(r="0"+r),r+":"+i},convertTimeTo12HourFormat:function(e){var t=e.split(":"),r=t[0],a=t[1],i=I18n.getMsg("AM");return r>12&&(r=Number(r)-12,i=I18n.getMsg("PM")),0==r?(r=12,i=I18n.getMsg("AM")):12==r&&(i=I18n.getMsg("PM")),r<10&&r.toString().length<2&&(r="0"+r),r+":"+a+" "+i},compareTime:function(e,t,r){var a=CrmDateUtils.timeTomilliseconds(e),i=CrmDateUtils.timeTomilliseconds(t)-a;return r?i>=0:i>=1e3},timeTomilliseconds:function(e){var t=e.split(":");return 60*t[0]*60*1e3+60*t[1]*1e3},getDayNumber:function(e){switch(e){case"Monday":return 1;case"Tuesday":return 2;case"Wednesday":return 3;case"Thursday":return 4;case"Friday":return 5;case"Saturday":return 6;default:return 0}},checkTimeValue:function(e){var t=e.split(":");if(t.length<=1)return!0;if(!t[0]||isNaN(Number(t[0]))&&Number(t[0])>24)return!0;var r=t[1].split(" ");if(r.length>0){if(!r[0]||isNaN(Number(r[0])&&Number(r[0]))>60)return!0;if("hh:mm a"==Crm.userDetails.TIME_FORMAT&&(!r[1]||r[1].toUpperCase()!=I18n.getMsg("AM")&&r[1].toUpperCase()!=I18n.getMsg("PM")))return!0}return!1}},crmCalendar={currCalDate:void 0,currDateObj:void 0,currMonth:void 0,currYear:void 0,currDate:void 0,currMonthEnd:[31,28,31,30,31,30,31,31,30,31,30,31],monthName:void 0,days:void 0,displayPanel:void 0,callFnAfterClose:void 0,sDate:void 0,eDate:void 0,isHideToday:void 0,goDate:void 0,crmCalposition:void 0,dayslist_lower:["sun","mon","tue","wed","thu","fri","sat"],calDefColor:"#515CCB",weekdays:{1:"Sunday",2:"Monday",3:"Tuesday",4:"Wednesday",5:"Thursday",6:"Friday",7:"Saturday"},months:{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"},init:function(){this.monthName=[{html:I18n.getMsg("January"),value:0},{html:I18n.getMsg("February"),value:1},{html:I18n.getMsg("March"),value:2},{html:I18n.getMsg("April"),value:3},{html:I18n.getMsg("May"),value:4},{html:I18n.getMsg("June"),value:5},{html:I18n.getMsg("July"),value:6},{html:I18n.getMsg("August"),value:7},{html:I18n.getMsg("September"),value:8},{html:I18n.getMsg("October"),value:9},{html:I18n.getMsg("November"),value:10},{html:I18n.getMsg("December"),value:11}],this.monthNameWithThreeLetter=[{html:I18n.getMsg("Jan"),value:0},{html:I18n.getMsg("Feb"),value:1},{html:I18n.getMsg("Mar"),value:2},{html:I18n.getMsg("Apr"),value:3},{html:I18n.getMsg("May"),value:4},{html:I18n.getMsg("Jun"),value:5},{html:I18n.getMsg("Jul"),value:6},{html:I18n.getMsg("Aug"),value:7},{html:I18n.getMsg("Sep"),value:8},{html:I18n.getMsg("Oct"),value:9},{html:I18n.getMsg("Nov"),value:10},{html:I18n.getMsg("Dec"),value:11}],this.days=["ssunday","smonday","stuesday","swednesday","sthursday","sfriday","ssaturday"],this.dayNamesShort=["ssun","smon","stue","swed","sthu","sfri","ssat"],this.daysBasedOnPrefernce=["ssunday","smonday","stuesday","swednesday","sthursday","sfriday","ssaturday"];for(var e=0;e<Crm.calPreferences.WEEKSTARTSON;e++){var t=this.daysBasedOnPrefernce[0];this.daysBasedOnPrefernce.shift(1),this.daysBasedOnPrefernce.push(t);var r=this.dayNamesShort[0];this.dayNamesShort.shift(1),this.dayNamesShort.push(r)}this.daysFullString=[I18n.getMsg("Sunday"),I18n.getMsg("Monday"),I18n.getMsg("Tuesday"),I18n.getMsg("Wednesday"),I18n.getMsg("Thursday"),I18n.getMsg("Friday"),I18n.getMsg("Saturday")],this.weekSequence=[{html:I18n.getMsg("First"),value:1},{html:I18n.getMsg("Second"),value:2},{html:I18n.getMsg("Third"),value:3},{html:I18n.getMsg("Fourth"),value:4},{html:I18n.getMsg("Last"),value:5}]},setCurrMonthEnd:function(){1==this.currMonth&&(this.currMonthEnd[1]=this.currYear%400==0||this.currYear%4==0&&this.currYear%100!=0?29:28)},getTitle:function(){return this.monthName[this.currMonth].html+" "+this.currYear},getDateObjectFromGivenDateString:function(e,t){var r=CrmDateUtils.getDateObjectFromString(e,t?t.toUpperCase():t);return this.currDateObj=r,this.currDate=r.getDate(),this.currMonth=r.getMonth(),this.currYear=r.getFullYear(),this.currDateObj},showCalendar:function(e,t,r,a,i,n,o,s){var l,c=document.getElementById("iskanbanview");if(Activities.RemainderHideOnly(),"topPanel"===t&&$("#leftPanelCalendarP").is(":visible"))return renderingUtils.stopEvent(e),!1;this.callFnAfterClose=r;var d,u=e.target;if(c&&"true"===c.value||$(u).parents(".diUserSettingContainerData").is(":visible")||$("#datFilter_-1").is(":visible")||$(".dIBestTimeDropdown").length||"Crm_Tasks_DUEDATE"===$(u).attr("id")&&$("#rmStatusMesg").length>0||hideMenu(),n?(l=$("input[name='"+n+"']")[0],e=window.event):"string"==typeof e?(l="A"===getElemById(e).nodeName?$("a[id='"+e+"']"):$("input[name='"+e+"']")[0],e=window.event):l=c&&"true"===c.value&&null!=calenderTargetElKv&&(void 0!==e.srcElement&&"input"!==e.srcElement.tagName.toLowerCase()||void 0!==e.target&&"input"!==e.target.tagName.toLowerCase())?getObj(calenderTargetElKv):renderingUtils.getTargetElem(e),"img"==l.nodeName)l.readOnly;else{if(d=l.value,void 0!==$(l).attr("data-other")){var m=$(l).attr("data-other");d=$("#"+m).val()}$(l).data("uitype",i)}if(!(l.name&&l.name.indexOf("searchdate")>-1&&0==l.value.indexOf("$"))){var p=$(l).data("datepattern"),g=p||(Crm.userDetails&&Crm.userDetails.DATE_PATTERN?Crm.userDetails.DATE_PATTERN:"mm/dd/yyyy"),h=l.value;if(d==g&&(h="",d=""),!Utils.isValidDate(g,d)){var f=new Date;d=this.convertToUserDatePattern(f.getDate()+" "+f.getMonth()+" "+f.getFullYear(),p)}"topPanel"==t||0==l.readOnly&&!d?(this.currDateObj=new Date,this.currMonth=this.currDateObj.getMonth(),this.currYear=this.currDateObj.getFullYear(),this.currYear<1e3&&(this.currYear+=1900),this.currDate=this.currDateObj.getDate()):(""!=g&&(this.currDateObj=this.getDateObjectFromGivenDateString(d,p)),this.currYear<1e3&&(this.currYear+=1900)),l.focus();var v=$(l);v.closest(".newInputStyleEle").length&&(v=v.parent());var C=v.offset();this.displayField=l.id,this.displayPanel=t||"leftPanel",this.createCalendar(this.currDate,this.currMonth,this.currYear,a,o,s);var y,E=$(".crmTrendDashBoard");if("topPanel"==this.displayPanel){var I=$("#leftPanelCalendarP"),w=$("#sCalenDar").offset();if(""!=crmCalendar.crmCalposition&&null!=crmCalendar.crmCalposition){var T=crmCalendar.crmCalposition.left,b=crmCalendar.crmCalposition.top,S=T;I.addClass("top0")}else T=C.left-I.outerWidth()/2+v.outerWidth()/2,b=C.top+v.height()-1,S=$(".lyteMenuSettings #sCalenDar").offset().left+$(".lyteMenuSettings #sCalenDar").outerWidth();if(Crm.userDetails.RTL_ENABLED)I.css({left:w.left-50+"px",top:b+14});else{var _=renderingUtils.windowWidth+$(window).scrollLeft()-S-65-95;I.css({top:b+14,right:_}),$("#leftPanelCalendarP .SocialArrow").css({right:25})}$("#conditionalFieldRightSection").length&&void 0!==e&&27!==e.which&&void 0!==e.which&&$("#conditionalFieldRightSection").css("right","-650px"),$("#validationRuleRightSection").length&&void 0!==e&&27!==e.which&&void 0!==e.which&&$("#validationRuleRightSection").hide(),$(".newCalendarIcon").addClass("newCalendarIconH").removeClass("newCalendarIcon")}else{var M=window.innerWidth?window.innerWidth:document.body.clientWidth,D=window.innerHeight?window.innerHeight:document.body.clientHeight,A=M-(C.left-document.body.scrollLeft);if($("#searchCreatePopup").is(":visible"))var k=D-(C.top-$("html,body").scrollTop());else k=D-(C.top-document.body.scrollTop);if("INPUT"==l.nodeName){var N=$("#Calendar").width(),L=C.left,R=$("#Calendar").outerHeight(),O=v.outerHeight(),P=C.top+v.outerHeight()-1;N>A&&(L=L-N+v.outerWidth()-1),k<R&&(P=C.top-R);E=$(".crmTrendDashBoard");document.addEventListener("scroll",crmCalendar.scrollFix=function(e){var t,r=$(l).offset().top,a=D-r,i=$(e.target),n=i.offset().top,o=i.outerHeight(),s=$("#Calendar");t=a-28>R?r+O:r-R,s.css({top:t+"px"}),(n-O>=r||o+n<=r)&&(E.length||crmCalendar.close(),$(l).blur()),$("#searchCreatePopup").is(":visible")&&$("#Calendar").hide()},!0)}else L=C.left+v.outerWidth(),P=C.top-1;if($("#updateCallStatus").is(":visible")){P=v.position().top+v.outerHeight();$("#Calendar").show().css({position:"fixed",top:P+1+"px",left:L+"px"})}else $("#Calendar").show().css({position:"absolute",top:P+1+"px",left:L+"px"})}if(E.length&&CrmIntelligence.calendarDropAppend(),document.getElementById("iskanbanview")&&"true"===document.getElementById("iskanbanview").value){var U=P+1+"px";TaskKanbanView.setCalenderScroll("kanbanTaskDetailctn",U)}crmCalendar.sDate=o,crmCalendar.eDate=s,this.goDate&&(y=new Date(this.goDate));var x=$("#Calendar");"Crm_Services_STARTING_DATE"==e.target.id||"Crm_Services_CLOSING_DATE"==e.target.id?(x.addClass("serviceCalender"),x.removeClass("serviceCalenderDates")):e.target.id.startsWith("Crm_Services_AVAILABLE_DATES")||"Crm_Services_AVAILABLE_DATES"==e.target.id?x.addClass("serviceCalender serviceCalenderDates"):x.removeClass("serviceCalender serviceCalenderDates"),crmCalendar.updateDatePicker(e,void 0,void 0,y),"INPUT"==l.nodeName&&l.setAttribute("autocomplete","off"),l.value=h,this.calendarNode=l,$(".dICal").length&&$(".dICal").removeClass("dICal"),renderingUtils.stopEvent(e)}},scrollFix:{},updateDatePicker:function(e,t,r,a,i){var n=$("#Calendar");if("topPanel"==this.displayPanel&&(n=$("#leftPanelCalendarP")),void 0!==a?(this.currDate=a.getDate(),this.currMonth=a.getMonth(),this.currYear=a.getFullYear()):void 0!==t?1==t?11==this.currMonth?i?this.currMonth=CrmIntelligence.inc:(this.currMonth=0,this.currYear++):i?this.currMonth=CrmIntelligence.inc:this.currMonth++:0==this.currMonth?(this.currMonth=11,this.currYear--):this.currMonth--:void 0!==r&&(this.currYear=i?CrmIntelligence.inc:parseInt(this.currYear)+r),this.createCalendar(this.currDate,this.currMonth,this.currYear,this.showExecutionDay),n.show(),void 0!==crmCalendar.eDate){"object"!=typeof crmCalendar.eDate&&(crmCalendar.eDate=crmCalendar.eDate.replace(/,/g,"/"));var o=(d=new Date(crmCalendar.eDate)).getDate(),s=d.getMonth(),l=d.getFullYear();if(parseInt(l)>=this.currYear){if(parseInt(l)==this.currYear)if($(".yearNavRgt").addClass("disabledArow"),parseInt(s)>=this.currMonth){if(s==this.currMonth){$("#nm").addClass("disabledArow");var c=$("#calHeader td").length;$("#calHeader td").each((function(){var e=parseInt($("#calHeader td").eq(c-1).attr("onclick").substr($("#calHeader td").eq(c-1).attr("onclick").indexOf("('")+4,3)),t=parseInt($("#calHeader td").eq(c-1).attr("onclick").substr($("#calHeader td").eq(c-1).attr("onclick").indexOf("('")+2,2))+"_"+e;if(parseInt(o)+"_"+parseInt(s)==t)return!1;$("#calHeader td").eq(c-1).addClass("lightDisabledArr"),c-=1}))}}else $("#nm").addClass("disabledArow"),$("#calHeader td").each((function(){$(this).addClass("lightDisabledArr")}))}else $(".yearNavRgt").addClass("disabledArow"),$("#nm").addClass("disabledArow"),$("#calHeader td").each((function(){$(this).addClass("lightDisabledArr")}))}if(void 0!==crmCalendar.sDate){"object"!=typeof crmCalendar.sDate&&(crmCalendar.sDate=crmCalendar.sDate.replace(/,/g,"/"));var d;o=(d=new Date(crmCalendar.sDate)).getDate(),s=d.getMonth(),l=d.getFullYear();parseInt(l)<=this.currYear?parseInt(l)==this.currYear&&($(".yearNavLft").addClass("disabledArow"),parseInt(s)<=this.currMonth?s==this.currMonth&&($("#pm").addClass("disabledArow"),$("#calHeader td").each((function(){var e=parseInt($(this).attr("onclick").substr($(this).attr("onclick").indexOf("('")+4,3)),t=parseInt($(this).attr("onclick").substr($(this).attr("onclick").indexOf("('")+2,2))+"_"+e;if(parseInt(o)+"_"+parseInt(s)==t)return!1;$(this).addClass("lightDisabledArr")}))):($("#pm").addClass("disabledArow"),$("#calHeader td").each((function(){$(this).addClass("lightDisabledArr")})))):($(".yearNavLft").addClass("disabledArow"),$("#pm").addClass("disabledArow"),$("#calHeader td").each((function(){$(this).addClass("lightDisabledArr")})))}($(".crmTrendDashBoard").length&&CrmIntelligence.calendarDropAppend(),n.hasClass("serviceCalender"))&&((!e||!e.currentTarget||("nm"===e.currentTarget.id||"pm"===e.currentTarget.id||""===e.currentTarget.id?!this.calendarNode||"Crm_Services_AVAILABLE_DATES"===this.calendarNode.id:"Crm_Services_AVAILABLE_DATES"===e.currentTarget.id))&&(this.setHolidays(),this.setBusinessClosedDays()),n.hasClass("serviceCalenderDates")&&this.setAlreadySelectedDate());renderingUtils.stopEvent(e)},createDatePicker:function(e,t,r){this.setCurrMonthEnd();var a=new Date(r,t,1),i=6,n=this.daysBasedOnPrefernce.indexOf(this.days[a.getDay()])+1;i=31===this.currMonthEnd[t]&&n>=6||30===this.currMonthEnd[t]&&7===n?7:28===this.currMonthEnd[t]&&1===n?5:6;var o=this.getTitle(e,r,t),s="topPanel"!=this.displayPanel?'<div id="calenDiv"><i id="calArrow" style="display:none;" class="dIB SocialArrow"></i><div>':'<div><i id="calArrow" class="dIB SocialArrow "></i><div>',l="topPanel"!=this.displayPanel?this.dayNamesShort:this.daysBasedOnPrefernce,c=s+"<div>";c+='<div class="txt-ctr"><span class="calNav yearNavLft" onclick="crmCalendar.updateDatePicker(event,undefined, -1)"></span><span class="calNav dLft" onClick="crmCalendar.updateDatePicker(event,-1)" id="pm"></span><span class="sCalMon">'+o+'</span><span class="calNav dRgt" onClick ="crmCalendar.updateDatePicker(event,1)" id="nm"></span><span class="calNav yearNavRgt" onclick="crmCalendar.updateDatePicker(event,undefined, 1)"></span></div>',c+='<table  class="calDay"  id ="weekDays" style="color:#868686; font-size:1.2rem; margin-left:0"><tr> <th>'+I18n.getMsg(l[0])+"</th> <th>"+I18n.getMsg(l[1])+"</th><th>"+I18n.getMsg(l[2])+"</th><th>"+I18n.getMsg(l[3])+"</th> <th>"+I18n.getMsg(l[4])+"</th> <th>"+I18n.getMsg(l[5])+"</th> <th>"+I18n.getMsg(l[6])+"</th></tr></table>",c+="</div>",c+='<table id="calHeader" class="calDay" style="margin-left:0; margin-top:-5px;" width="100%" cellspacing="0" cellpadding="0" border="0" >';var d="",u=new Date,m=r||u.getFullYear(),p=e||u.getDate(),g=null==t?u.getMonth():t,h=u.getMonth(),f=u.getFullYear(),v=u.getDate();h==t&&r==f&&(d=' style="display:none"');for(var C,y,E,I=a.getDay();I!==Crm.calPreferences.WEEKSTARTSON;)a.setDate(a.getDate()-1),I=a.getDay();for(var w=1;w<=i;w++){c+="<tr>";for(var T=1;T<8;T++){C=a.getMonth(),y=a.getFullYear(),E=a.getDate(),dateId=y+"-"+(parseInt(C)+1)+"-"+E;var b="cdate lt-gray";"topPanel"!=this.displayPanel&&E==p&&y==m&&C==g&&(b="cdate lt-gray"),C==g&&(b="cdate"),E==v&&C==h&&y==f&&(b="cDate crmCalendarToday"),E==p&&C==h&&y==f&&(b="sel"),"topPanel"!=this.displayPanel?c+='<td class="'+b+'" onClick="crmCalendar.displaySelectedDate(\''+E+" "+C+" "+y+"')\">"+E+"</td>":c+='<td id="day_'+dateId+'" class="'+b+'" onClick="crmCalendar.goToView(\''+dateId+"')\">"+E+"</td>",a.setDate(a.getDate()+1)}c+="</tr>"}if(c+="</table>",c+="<div>","topPanel"!=this.displayPanel?(this.isHideToday||(c+='<div id="calBtns" class="pT15 pB15 fL"><a'+d+' class="cP fL" href="javascript:;" id="todayBtn" onclick="crmCalendar.displaySelectedDate(\'today\')">'+I18n.getMsg("Today")+"</a>"),this.showExecutionDay&&(c+='<span id="calBtnsExec" class="fR"><a class="cP" href="javascript:;" id="executionDayBtn" onclick="crmCalendar.displaySelectedDate(\'executionDay\')">'+I18n.getMsg("workflow.filedUpdate.executeDay.label")+"</a></span>"),c+="</div>"):c+='<div id="calBtns" class="mT10 pT15"><p class="fL"><a class="cP" id="todayBtn" onclick="crmCalendar.updateDatePicker(event,undefined, undefined, new Date())" '+d+">"+I18n.getMsg("Today")+'</a></p><p id="calBtns1" class="fR"><a href="javascript:;"  id="cal_dayView" onclick="crmCalendar.goToView(\''+y+"-"+C+"-"+v+"', 'dayview')\">"+I18n.getMsg("crm.report.day")+'</a><a href="javascript:;" class="mL15" id="cal_weekView" onclick="crmCalendar.goToView(\''+y+"-"+C+"-"+v+"', 'weekview')\">"+I18n.getMsg("crm.report.week")+'</a><a href="javascript:;" class="mL15" id="cal_monthView" onclick="crmCalendar.goToView(\''+y+"-"+C+"-"+v+"', 'monthview')\">"+I18n.getMsg("crm.report.month")+"</a></p></div>",c+="</div>",c+="</div></div>","topPanel"==this.displayPanel){var S=new Date(r,t,1);S.setDate(1);var _=S.getFullYear()+"-"+(S.getMonth()+1)+"-"+S.getDate(),M=crmCalendar.calcTDWidth("monthview"),D=$("#topdivbg"),A=Math.ceil((renderingUtils.windowHeight-(D.length?D.height():0)-100)/100);$.ajax({url:Crm.getCrmBasePath()+"/events/CalendarView.do",type:"POST",data:"type=monthview&secAction=dotsForSmallCal&obtaineddate="+_+"&tdWidthParam="+M+"&userFetchCnt="+A,success:function(e){crmCalendar.fillDot(e.split(":"))}})}return c},goToView:function(e,t){t||(t="dayview");var r=$("#topdivbg"),a=$(window).height(),i=r.height();$("#leftPanelCalendarP").hide();var n={type:t,obtaineddate:e,tdWidthParam:crmCalendar.calcTDWidth(t),userFetchCnt:Math.ceil((a-(r.length?i:0)-100)/100)},o={isSmallCal:!0};"true"===$("#isAllEventViewLoaded").val()&&(o.action="saveCalRecentView",n.idStr="ALLEVENT",o.calViewType="ALLEVENT"),Lyte.Router.transitionTo({route:"crm.crm-calendar",queryParams:n}).data=o},fillDot:function(e){for(i=0;i<e.length;i++){var t=$("#day_"+e[i]);if(t.length>0){var r=t.attr("class");r&&("cdate"==r?t.attr("class","dot"):"cdate lt-gray"==r?t.attr("class","dot2"):t.attr("class","toDayDot"))}}},createCalendar:function(e,t,r,a){this.monthName||crmCalendar.init(),Crm.userDetails||(Crm.userDetails=window.opener.Crm.userDetails),this.showExecutionDay=a;var i=this.createDatePicker(e,t,r);"topPanel"==this.displayPanel?document.getElementById("leftPanelCalendarP").ltProp("show",!0):$("#Calendar").html(i)},close:function(){$("#Calendar").hide(),1!==$("#analyticalPageContainer").length&&1!==$("#createDashboardPanel").length||AnalyticsChart.rm_focusCalenderEle(),$(".dICal").length&&$(".dICal").removeClass("dICal"),$("#leftPanelCalendarP").hide(),this.calendarNode=void 0,document.removeEventListener("scroll",crmCalendar.scrollFix,!0),crmCalendar.scrollFix=null},displaySelectedDate:function(e,t){var r=this.calendarNode;if(!t)t=$(this.calendarNode);var a,i=$(t).data("datepattern");"today"==e&&(e=(a=new Date).getDate()+" "+a.getMonth()+" "+a.getFullYear());if("executionDay"==e){var n=t.data("uitype");o=786===n||14===n||333===n?crmConstants.executionTimeFormula:crmConstants.executionDayFormula,$("#execDayElems").show(),$(t).closest(".updateCalendarOption").find(".execDayTime").show(),$(t).closest(".updateCalendarOption").find(".newtimefrmt").hide(),$("#dateFrmSPAN").hide(),$("#timefrmspan").hide()}else{var o=this.convertToUserDatePattern(e,i);a=this.getDateObjectFromGivenDateString(o,i);var s=t.data("dateObj")?new Date(t.data("dateObj")):a;s.setDate(a.getDate()),s.setMonth(a.getMonth()),s.setFullYear(a.getFullYear()),t.data("dateObj",s),786===t.data("uitype")||14===t.data("uitype")||333===t.data("uitype")?($(t).closest(".updateCalendarOption").find(".newtimefrmt").show(),$("#dateFrmSPAN").hide(),$("#timefrmspan").show()):$("#timefrmspan").hide(),$("#execDayElems").hide(),$(t).closest(".updateCalendarOption").find(".execDayTime").hide()}if(t.val(o),t.focus(),renderingUtils.triggerEvent("change",t),document.getElementById("iskanbanview")&&"true"===document.getElementById("iskanbanview").value&&getObj("headervaluetkv_Due Date")&&"inline"!==getObj("headervaluetkv_Due Date").style.display&&""!==getObj("headervaluetkv_Due Date").style.display){getObj("headervaluetkv_Due Date").innerText=o,getObj("headervaluetkv_Due Date").style.display="inline",getObj("headertextarea_Due Date").style.display="none";var l=document.getElementById("entityId").value;Callonclickofbutton("/crm/v2/","textbox_Due Date","headervaluetkv_Due Date","headertextarea_Due Date","Due Date","Tasks","subvalue_Due Date","24","CrmTask","DUEDATE",l,"false"),tkvajaxEdit=!1}crmCalendar.close(),this.callFnAfterClose&&this.callFnAfterClose(r)},setDayViewIconDate:function(){var e=new Date(calView.currCalDateObj);$("#calLeftIconDate").text(e.getDate()),$("#calLeftIconDay").text(I18n.getMsg(this.weekdays[e.getDay()+1])),$("#calLeftIconMonth").text(I18n.getMsg(this.months[e.getMonth()+1])+" "+e.getFullYear())},calcTDWidth:function(e){var t=155;if("dayview"==e){var r=$(window).width(),a=2*$("#tabLayer").offset().left+74,i=$("#calendarCont")&&$("#calendarCont").width()>0?$("#calendarCont").width()-70:r-a;$(".user")&&$(".user").next().remove();var n=216,o=6;r>=1280&&r<1366?n=215:r>=1366&&r<1440?n=218:r>=1440&&r<1600?n=214:r>=1600&&r<1680?(n=212,o=7):r>=1680&&r<1900||r>=1900&&r<2100?(n=216,o=8):r>=2100&&r<3e3&&(n=212,o=8),$(".user")&&$(".user").width(n);var s=(i-n-10)/o;t=d=Math.ceil(s)}else if("weekview"==e){t=186;r=$(window).width();var l=$("#calendarCont"),c=l.width();$("#calendarCont.month.multiUserCalCon").length&&(c+=15);i=l&&c>0?c-70:r-174;$(".user")&&$(".user").next().remove();n=210,o=5;c>1679&&(o=7),$(".user")&&$(".user").width(n);s=(i-n-8)/o;var d=Math.ceil(s);c<1679&&(d+=2),t=d}return t},convertToUserDatePattern:function(e,t){var r=e.split(" "),a=new Date(r[2],r[1],r[0]),i=t||Crm.userDetails.DATE_PATTERN;return CrmDateUtils.convertDateToUserPattern(a,i.toUpperCase())},setHolidays:function(){if(null!=Crm.holidays){var e=Crm.holidays.length;if(e>0&&null==Crm.holidays[0].shift)for(var t=0;t<e;t++)for(var r=Crm.holidays[t].details.length,a=0;a<r;a++){var i=new Date(Crm.holidays[t].details[a].date);this.markHolidays(i)}}},setAlreadySelectedDate:function(){var e=Crm.holidays.selectedDate.length;if(e>0)for(var t=0;t<e;t++){var r=new Date(Crm.holidays.selectedDate[t]);this.markHolidays(r)}},markHolidays:function(e){for(var t="crmCalendar.displaySelectedDate('"+e.getUTCDate()+" "+e.getUTCMonth()+" "+e.getUTCFullYear()+"')",r=$("#calenDiv").find('td[class="cdate"],[class="sel"],[class="cdate lt-gray"]'),a=r.length,i=0;i<a;i++){var n=$(r[i]);n.attr("onclick")==t&&(n.removeAttr("onclick"),n.removeClass("lt-gray"),n.addClass("red"))}},setBusinessClosedDays:function(){if(null!=Crm.businessJSON&&Crm.businessJSON.business_days){var e=Crm.businessJSON.business_days.length;if(e>0&&e<7)for(var t=$("#calenDiv").find('td[class="cdate"],[class="sel"],[class="cdate lt-gray"],[class="cdate red"],[class="sel red"]'),r=t.length/7,a=Crm.businessJSON.closedDay,i=a.length,n=0;n<i;n++)for(var o=0;o<r;o++){var s=CrmDateUtils.getDayNumber(a[n])-1,l=$(t[s+7*o]);l.removeAttr("onclick"),l.removeClass("lt-gray"),l.addClass("red")}}}};!function(){var e=["translate","translateX","translateY","translateZ","scale","scaleX","scaleY","scaleZ","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],t={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},r=["background","background-color","stroke","border-color","border-bottom-color","border-left-color","border-right-color","border-top-color","color"];this.animate=function(){this.settings={version:"v2.0",element:"",easing:"linear",duration:1e3,elasticity:200,delay:0,stagger:0,transformOrigin:"center",autoPlay:!1,pause:!1,repeat:1,repeatIndex:1,reverse:!1,start:!1,process:!1,complete:!1},this.options=arguments[0];var e=f(this.options);this.options.reverse&&(e=(e=Object.keys(e).map((function(t){return e[t]}))).reverse());this.element=v(e,this.options),this.cssProperty=p(this.options,this.settings),this.eachCSSProp=g(this.element,this.settings,this.cssProperty),this.tween=s(this.eachCSSProp)},animate.prototype.pause=function(){this.tween.forEach((function(e){e.pause=!0,e.from=e.val,e.duration=e.newDuration}))},animate.prototype.seek=function(e){this.progressBar=document.querySelectorAll(e),$(".sliderBar").draggable({axis:"x",containment:"parent"})},animate.prototype.reset=function(){this.tween.forEach((function(e){e.element.style.transformOrigin=null,e.pause=!0;var t=e.element;"css"===e.type?t.style[e.name]=e.from+e.unit:"transform"===e.type?t.style[e.type]=e.name+"("+e.from+e.unit+")":"color"===e.type&&(t.style[e.name]="rgb("+e.from.r+", "+e.from.g+", "+e.from.b+")")}))},animate.prototype.play=function(){var e=this,t=this.tween,r={tArray:[],tVal:[],isCompleted:!1,isStart:!1};t.forEach((function(t){if(t.pause=!1,"transform"===t.type){var i=t.element;if(null==i.style.transform){var n=["-webkit-","-moz-","-ms-"];for(var o in n)void 0!==i.style[n[o]+"transform"]&&(t.prefix=n[o],i.style[t.prefix+"transformOrigin"]=t.transformOrigin)}else t.element.style.transformOrigin=t.transformOrigin,t.prefix=""}t.pause||(t.currentTime=(new Date).getTime()),a(e,t,r)}))};var a=function(e,t,r){var a=t.delay+t.duration;t.start&&!r.isStart&&t.start.call(),r.isStart=!0,window.requestAnimationFrame((function i(){var n=o(t,t.currentTime,t.delay,t.duration,t.easing,t.elasticity);t.ease=n[0];var s=n[1];return t.newDuration=t.duration-s,t.newFrom=t.val,t.pause?(window.cancelAnimationFrame(i),void(t.pause=!1)):(e.seekBar(t,t.ease,r),a<=s?(window.cancelAnimationFrame(i),t.complete&&!r.isCompleted&&t.complete.call(),void(r.isCompleted=!0)):void window.requestAnimationFrame(i))}))};animate.prototype.seekBar=function(e,t,r){var a=r.tArray,i=r.tVal;if("css"===e.type)e.val=e.from+t*(e.to-e.from),e.element.style[e.name]=e.val+""+e.unit;else if("color"===e.type){var n=parseInt(e.from.r+t*(e.to.r-e.from.r)),o=parseInt(e.from.g+t*(e.to.g-e.from.g)),s=parseInt(e.from.b+t*(e.to.b-e.from.b));e.val="rgb("+n+", "+o+", "+s+")",e.element.style[e.name]=e.val}else if("transform"===e.type){var l,c=e.from+t*(e.to-e.from);e.val=c,!w(a,e.name)&&a.push(e.name),c=e.name+"("+c+e.unit+")",i[a.indexOf(e.name)]=c,l=(l=i.join()).replace(/,/g," "),e.element.style[e.prefix+""+e.type]=l}return c};var i,n,o=function(e,t,r,a,i,n){var o=Date.now()-t,s=Math.min(Math.max(o-r,0),a)/a;return[C[i](s,n),o]},s=function(e){var t=[];return e.forEach((function(e){switch(e.type){case"css":e=d(e);break;case"color":e=c(e);break;case"transform":e=l(e)}t.push(e)})),t},l=function(e){var t=e.values;if(S.array(t)){var r=e.name.indexOf("scale")?S.number(t[0])?"px":I(t[0]):"";e=u(e,parseInt(t[0],10),parseInt(t[1],10),r)}else if(S.object(t))if(S.array(t.value)){r=e.name.indexOf("scale")?S.number(t.value[0])?"px":I(t.value[0]):"";e=u(e,t.value[0],t.value[1],r)}else{r=e.name.indexOf("scale")?S.number(t.value)?"px":I(t.value):"";e=u(e,0,parseInt(t.value,10),r)}else{r=e.name.indexOf("scale")?S.number(t)?"px":I(t):"";e=u(e,0,parseInt(t,10),r)}return e},c=function(e){var t=e.values;return e=S.array(t)?u(e,b(t[0]),b(t[1])):S.object(t)?S.array(t.value)?u(e,b(t.value[0]),b(t.value[1])):u(e,b(m(e.element,e.name)),b(t.value)):u(e,b(m(e.element,e.name)),b(t))},d=function(e){var t=e.values;if(S.array(t)){var r=e.name.indexOf("opacity")?S.number(t[0])?"px":I(t[0]):"";e=u(e,parseInt(t[0],10),parseInt(t[1],10),r)}else if(S.object(t))if(S.array(t.value)){r=e.name.indexOf("opacity")?S.number(t.value[0])?"px":I(t.value[0]):"";e=u(e,t.value[0],t.value[1],S.number(t.value[0])?"px":I(t.value[0]))}else{var a=parseInt(m(e.element,e.name),10);r=e.name.indexOf("opacity")?S.number(t.value)?"px":I(t.value):"";e=u(e,a,parseInt(t.value,10),r)}else{a=parseInt(m(e.element,e.name),10),r=e.name.indexOf("opacity")?S.number(t)?"px":I(t):"";e=u(e,a,parseInt(t,10),r)}return e},u=function(e,t,r,a){return e.from=t,e.to=r,!S.undefined(a)&&(e.unit=a),e},m=function(e,t){var r;return t in e.style&&(r=getComputedStyle(e).getPropertyValue(E.camelCase(t))||"0"),r},p=function(e,t){var r={};return Object.keys(e).forEach((function(a){t.hasOwnProperty(a)?t[a]=e[a]:r[a]=e[a]})),e.reverse?t.reverseState=!0:t.reverseState=!1,r},g=function(e,t,r){var a=[];return e.forEach((function(e){Object.keys(r).forEach((function(i){var n=y.object(t),o=r[i];h(n,i,e.target),n.values=o,n.currentTime=0,n.name=i,n.element=e.target,n.duration=S.undefined(o.duration)?t.duration:o.duration,n.easing=S.undefined(o.easing)?t.easing:o.easing,n.elasticity=S.undefined(o.elasticity)?t.elasticity:o.elasticity;var s=S.undefined(o.delay)?t.delay:o.delay;n.delay=S.number(e.stagger)?e.stagger+s:s,a.push(n)}))})),a},h=function(t,a){return w(e,a)?(t.type="transform",t):w(r,a)?t.type="color":t.type="css"},f=function(e){var t=e.element;return"string"==typeof t?document.querySelectorAll(t):t.length?t:[t]},v=function(e,t){for(var r=[],a=e.length,i=0;i<a;i++){var n={};n.target=e[i],n.id=i,n.stagger=i*t.stagger,r.push(n)}return r},C=(i={},n={Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e,t){if(0===e||1===e)return e;var r=1-Math.min(t,998)/1e3,a=e/1-1,i=r/(2*Math.PI)*Math.asin(1);return-Math.pow(2,10*a)*Math.sin((a-i)*(2*Math.PI)/r)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){return 1/Math.pow(4,-1)-7.5625*Math.pow(NaN-e,2)}},["Quad","Cubic","Quart","Quint","Expo"].forEach((function(e,t){n[e]=function(e){return Math.pow(e,t+2)}})),Object.keys(n).forEach((function(e){var t=n[e];i["easeIn"+e]=t,i["easeOut"+e]=function(e,r){return 1-t(1-e,r)},i["easeInOut"+e]=function(e,r){return e<.5?t(2*e,r)/2:1-t(-2*e+2,r)/2}})),i.linear=function(e){return e},i),y={object:function(e){var t={};return Object.keys(e).forEach((function(r){t[r]=e[r]})),t}},E={camelCase:function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},array:function(e){return S.array(e)?e:e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e]}},I=function(e){return/([\+\-]?[0-9|auto\.]+)(%|px|pt|em|rem|in|cm|mm|ex|pc|vw|vh|deg)?/.exec(e)[2]},w=function(e,t){return e.some((function(e){return e===t}))},T=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}},b=function(e){if(t.hasOwnProperty(e))return T(t[e]);if(S.rgb(e)){var r=e.match(/\d+/g);return{r:parseInt(r[0]),g:parseInt(r[1]),b:parseInt(r[2])}}return S.rgba(e)?e:S.hex(e)?T(e):void 0},S={array:function(e){return Array.isArray(e)},string:function(e){return"string"==typeof e},object:function(e){return"object"==typeof e},undefined:function(e){return void 0===e},number:function(e){return!isNaN(e)},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},rgba:function(e){return/^rgba/.test(e)},hsl:function(e){return/^hsl/.test(e)},color:function(e){return t.hasOwnProperty(e)||S.hex(e)||S.rgb(e)||S.rgba(e)||S.hsl(e)}}}();var Search="object"!=typeof Search?{}:Search;function initSkyEyeAutoComplete(e){$(e).autocomplete({appendTo:e.parent(),source:function(e,t){$("#externalCompanyId").val("");var r=new crmRequestPool,a="searchmodule=Accounts&currFldName=Crm_Accounts_ACCOUNTNAME&acVersion=new&srchValue="+encodeURIComponent(e.term);commonUtils.showHideLoadingDiv(!0),r.initiate({action:Crm.getCrmBasePath()+"/FetchBusinessDetails.do",data:a,type:"GET",success:function(e){commonUtils.showHideLoadingDiv(),e&&t(e)}})},delay:750,minLength:2,change:function(e,t){if(t.item){var r=t.item.recInfo;Crm.fillAddressinfo(void 0,r)}},select:function(t,r){$(e).val(r.item.label);var a=new crmRequestPool,i=r.item.companyID;$("#externalCompanyId").val(i);var n="searchmodule=Accounts&acVersion=new&externalSourceId="+i;return commonUtils.showHideLoadingDiv(!0),a.initiate({action:Crm.getCrmBasePath()+"/FetchBusinessDetails.do?"+n,data:{},success:function(e){commonUtils.showHideLoadingDiv(),e?function(e){for(var t in e){var r="Crm_Accounts_"+t,a=$("#"+r);if(a){var i=a.attr("data-content-type"),n=e[t];switch(i){case"Date":case"DateTime":var o=new Date(Number(n)),s=Utils.getDateInUserDatePattern(o);a.val(s);break;case"Pick List":var l=a.data("mapVal");l||(l=a.data("values"));var c="select2-"+r+"-container span";if(n){void 0!==(u=a.attr("data-maxlength"))&&(n=n.slice(0,u));var d=l;d.push(n),a.data("mapVal",d),a.append($("<option>",{value:n,text:n})),a.val(n),$("#"+c).text(n)}else a.val(""),$("#"+c).text(I18n.getMsg("crm.label.picklist.none"));break;default:var u;void 0!==(u=a.attr("data-maxlength"))&&(n=n.slice(0,u)),a.val(n)}}}}(e):crmui.showMsgBand("error",I18n.getMsg("crm.skyeye.setup.msg.error"),4e3)}}),!1},open:function(){var e=$("#Crm_Accounts_ACCOUNTNAME").autocomplete("widget"),t=$("#Crm_Accounts_ACCOUNTNAME").parent(),r=t.offset().left,a=t.outerHeight()+t.offset().top,i=t.outerWidth();e.offset({top:a,left:r}),e.width(i)}}).data("ui-autocomplete")._renderItem=function(e,t){return $("<li class='ui-menu-item'>").append("<div tabindex='-1' class='ui-menu-item-wrapper'>"+t.value+"</div>").appendTo(e)}}Search.init=function(){Search.rowcnt=1,Search.calform="";var e=crmConstants.imgStaticPath;FingerPrint.isEnabled&&(e=crmConstants.fp_imgStaticPath),Search.titleImageSrc=e+"/search_87df67c_.png",Search.titleImageWidth=26,Search.titleImageHeight=31,Search.defaultMatch="all",Search.delImageSrc=e+"/del_3f73c4a_.gif",Search.calImageSrc=e+"/cal_9612405_.gif",Search.calAltText="Calendar",Search.spacerImg=e+"/spacer_e17b417_.gif",Search.userDatePattern=Crm.userDetails.DATE_PATTERN,Search._HOURVAL=new Array("01","02","03","04","05","06","07","08","09","10","11","12"),Search._MINUTEVAL=new Array("00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"),Search._AMPMVAL=[["AM",I18n.getMsg("AM")],["PM",I18n.getMsg("PM")]];var t=I18n.getMsg("is"),r=I18n.getMsg("isn't"),a=I18n.getMsg("is empty"),i=I18n.getMsg("is not empty"),n=I18n.getMsg("contains"),o=I18n.getMsg("doesn't contain"),s=I18n.getMsg("crm.filter.email.isblocked"),l=I18n.getMsg("crm.filter.email.isnotblocked");Search._ACTIVITYTYPES=[{html:I18n.getMsg("Tasks"),value:"Tasks"},{html:I18n.getMsg("Calls"),value:"Calls"},{html:I18n.getMsg(Crm.getModuleDisplayName(!1,!0,!0)),value:"Events"}],Search._ACTIVITYCRT=[{html:t,value:"is"},{value:"isn't",html:r}],Search.actCriteria={select:{events:{onchange:function(){Search.changeValue(this,"criteria")}}},option:Search._ACTIVITYCRT,type:"criteria"},Search.params={select:{attr:{class:"multiSel p10",multiple:"",style:"width:350px;","data-placeholder":" "},events:{onchange:function(){Search.changeValue(this,"type")}}},option:Search._ACTIVITYTYPES,multiSelect:"true",type:"type"},Search._MATCH=[["and",I18n.getMsg("crm.label.and")],["or",I18n.getMsg("crm.label.or")]],Search._USERCOND=[["is",t],["isn't",r],["is empty",a],["is not empty",i]],Search._LAYOUTCOND=[["is",t],["isn't",r]],Search._WIZARDCOND=[["is",t],["isn't",r]],Search._CONSENTCOND=[["equal",t],["not_equal",r]],Search._TAGCOND=[["is",t],["isn't",r],["is empty",a],["is not empty",i]],Search._CAMPCVCOND=[["is",t],["isn't",r],["is empty",a],["is not empty",i]],Search._TXTCOND=[["None",I18n.getMsg("None")],["is",t],["isn't",r],["contains",n],["doesn't contain",o],["starts with",I18n.getMsg("starts with")],["ends with",I18n.getMsg("ends with")],["is empty",a],["is not empty",i]],Search._ENCTXTCOND=[["is empty",a],["is not empty",i]],Search._PICKLISTCOND=[["None",I18n.getMsg("None")],["is",t],["isn't",r],["is empty",a],["is not empty",i]],Search._CALLSTATUSCOND=[["None",I18n.getMsg("None")],["Scheduled",I18n.getMsg("Scheduled")],["Attended Dialled",I18n.getMsg("Attended Dialled")],["Unattended Dialled",I18n.getMsg("Unattended Dialled")],["Overdue",I18n.getMsg("Overdue")],["Cancelled",I18n.getMsg("Cancelled")],["Received",I18n.getMsg("Received")],["Missed",I18n.getMsg("Missed")]],Search._DATETIMECOND=[["is",t],["isn't",r],["is before",I18n.getMsg("is before")],["is after",I18n.getMsg("is after")],["between",I18n.getMsg("between")],["not between",I18n.getMsg("not between")],["Today",I18n.getMsg("Today")],["Tommorow",I18n.getMsg("Tommorow")],["Tommorow Onwards",I18n.getMsg("Tommorow Onwards")],["Yesterday",I18n.getMsg("Yesterday")],["Till Yesterday",I18n.getMsg("Till Yesterday")],["Last Month",I18n.getMsg("Last Month")],["Current Month",I18n.getMsg("Current Month")],["Next Month",I18n.getMsg("Next Month")],["Last Week",I18n.getMsg("Last Week")],["Current Week",I18n.getMsg("Current Week")],["Next Week",I18n.getMsg("Next Week")],["Last Year",I18n.getMsg("crm.prediction.analytics.filter.year")],["This Year",I18n.getMsg("crm.thisyear")],["Next Year",I18n.getMsg("crm.label.next.year")],["Previous FQ",I18n.getMsg("Previous FQ")],["Current FQ",I18n.getMsg("Current FQ")],["Next FQ",I18n.getMsg("Next FQ")],["Previous FY",I18n.getMsg("Previous FY")],["Current FY",I18n.getMsg("Current FY")],["Next FY",I18n.getMsg("Next FY")],["is empty",a],["is not empty",i],["Age in Days",I18n.getMsg("Age in Days")],["Due in Days",I18n.getMsg("Due in Days")]],Search._MINDATETIMECOND=[["is",t],["isn't",r],["is empty",a],["is not empty",i]],Search._NUMCOND=[["=","="],["!=","!="],["<","<"],["<=","<="],[">",">"],[">=",">="],["between",I18n.getMsg("between")],["not between",I18n.getMsg("not between")],["is empty",a],["is not empty",i]],Search._ENCNUMCOND=[["=","="],["!=","!="],["is empty",a],["is not empty",i]],Search._AGEINDAYSCOND=[["=","="],["!=","!="],["<","<"],["<=","<="],[">",">"],[">=",">="]],Search._BOOLEANCOND=[["is",t]],Search._PROFILECOND=[["is",t],["isn't",r]],Search._ROLECOND=[["is",t],["isn't",r]],Search.andOrMapping={},Search.andOrMapping[I18n.getMsg("and").trim()]="and",Search.andOrMapping[I18n.getMsg("or").trim()]="or",Search._TERRITORYCOND=[["is",t]],Search._DATETIMEFILTERS1=[["Age in Days",I18n.getMsg("crm.condition.in.last")],["0",I18n.getMsg("on")],["7",I18n.getMsg("before")],["5",I18n.getMsg("crm.label.general.small.after")],["14",I18n.getMsg("between")],["${TODAY}",I18n.getMsg("Today")],["${YESTERDAY}",I18n.getMsg("Yesterday")],["${THISWEEK}",I18n.getMsg("crm.thisweek")],["${THISMONTH}",I18n.getMsg("crm.label.this.month")],["${THISYEAR}",I18n.getMsg("crm.thisyear")],["${LASTWEEK}",I18n.getMsg("Last Week")],["${LASTMONTH}",I18n.getMsg("Last Month")],["${EMPTY}",I18n.getMsg("crm.condition.till.today")]],Search._DATETIMEFILTERS=[["Age in Days",I18n.getMsg("crm.condition.in.last")],["0",I18n.getMsg("on")],["7",I18n.getMsg("before")],["5",I18n.getMsg("crm.label.general.small.after")],["14",I18n.getMsg("between")],["${TODAY}",I18n.getMsg("Today")],["${YESTERDAY}",I18n.getMsg("Yesterday")],["${THISWEEK}",I18n.getMsg("crm.thisweek")],["${THISMONTH}",I18n.getMsg("crm.label.this.month")],["${THISYEAR}",I18n.getMsg("crm.thisyear")],["${LASTWEEK}",I18n.getMsg("Last Week")],["${LASTMONTH}",I18n.getMsg("Last Month")]],Search._DATETIMEFILTERS2=[["Age in Days",I18n.getMsg("crm.condition.in.last")],["0",I18n.getMsg("on")],["7",I18n.getMsg("before")],["5",I18n.getMsg("crm.label.general.small.after")],["14",I18n.getMsg("between")],["${TODAY}",I18n.getMsg("Today")],["${YESTERDAY}",I18n.getMsg("Yesterday")],["${THISWEEK}",I18n.getMsg("crm.thisweek")],["${THISMONTH}",I18n.getMsg("crm.label.this.month")],["${THISYEAR}",I18n.getMsg("crm.thisyear")],["${LASTWEEK}",I18n.getMsg("Last Week")],["${LASTMONTH}",I18n.getMsg("Last Month")],["${UNTILNOW}",I18n.getMsg("condition.till.now")]],Search._ACTIVITYFILTERS=[["${TODAY}",I18n.getMsg("Today")],["${TOMORROW}",I18n.getMsg("Tommorow")],["${NEXT7DAYS}",I18n.getMsg("Next 7 Days")],["${TODAYANDOVERDUE}",I18n.getMsg("Today + Overdue"),"default"]],Search._NUMFILTERS=[["0","="],["1","!="],["7","<"],["6","<="],["5",">"],["4",">="],["14",I18n.getMsg("between")],["15",I18n.getMsg("not between")],["${EMPTY}",a],["${NOTEMPTY}",i]],Search._RFMNUMFILTERS=[["0","="],["1","!="],["7","<"],["6","<="],["5",">"],["4",">="],["14",I18n.getMsg("between")],["15",I18n.getMsg("not between")]],Search._ENCNUMFILTERS=[["0","="],["1","!="],["${EMPTY}",a],["${NOTEMPTY}",i]],Search._NUMFILTERS1=[["0","="],["1","!="],["7","<"],["6","<="],["5",">"],["4",">="]],Search._DEALPREFILTER=[["5",">"],["7","<"],["4",">="],["6","<="]],Search.defaultFilters=["${EMPTY}","${NOTEMPTY}","${TODAY}","${TOMORROW}","${NEXT7DAYS}","${TODAYANDOVERDUE}","${YESTERDAY}","${THISWEEK}","${THISMONTH}","${THISYEAR}","${LASTMONTH}","${LASTWEEK}","${CURRENTUSER}","${NEXTMONTH}","${NEXTWEEK}","${TOMORROWPLUS}","${YESTERDAYMINUS}","${UNTILNOW}","${LASTDAYS30}","${LASTDAYS60}","${LASTDAYS90}","${LASTYEAR}","${THISFY}","${THISFQ}","${PREVFY}","${PREVFQ}","${NEXTYEAR}","${NEXTFY}","${NEXTFQ}","${OPEN}","${CLOSEDWON}","${CLOSEDLOST}"],Search._LEADPREFILTER=[["7","<"],["5",">"],["6","<="],["4",">="],["14",I18n.getMsg("between")]],Search._T=[["0",t],["1",r],["2",n],["3",o],["10",I18n.getMsg("starts with")],["11",I18n.getMsg("ends with")],["${EMPTY}",a],["${NOTEMPTY}",i]],Search._BOUNCE=[["${BLOCKED}",s],["${NOTBLOCKED}",l]],Search.bounceDefaultFilters=["${BLOCKED}","${NOTBLOCKED}"],Search._ENCT=[["${EMPTY}",a],["${NOTEMPTY}",i]],Search._CS=[["${Calls.Call Status.Scheduled}",I18n.getMsg("Scheduled")],["${Calls.Call Status.Attended Dialled}",I18n.getMsg("Attended Dialled")],["${Calls.Call Status.Unattended Dialled}",I18n.getMsg("Unattended Dialled")],["${Calls.Call Status.Overdue}",I18n.getMsg("Overdue")],["${Calls.Call Status.Cancelled}",I18n.getMsg("Cancelled")],["${Calls.Call Status.Received}",I18n.getMsg("Received")],["${Calls.Call Status.Missed}",I18n.getMsg("Missed")]],Search._DT=[["Age in Days",I18n.getMsg("crm.condition.in.last")],["Due in Days",I18n.getMsg("crm.zinvoice.dueIn")],["0",I18n.getMsg("on")],["7",I18n.getMsg("before")],["5",I18n.getMsg("crm.label.general.small.after")],["14",I18n.getMsg("between")],["${TODAY}",I18n.getMsg("Today")],["${YESTERDAY}",I18n.getMsg("Yesterday")],["${THISWEEK}",I18n.getMsg("crm.thisweek")],["${THISMONTH}",I18n.getMsg("crm.label.this.month")],["${THISYEAR}",I18n.getMsg("crm.thisyear")],["${LASTWEEK}",I18n.getMsg("Last Week")],["${LASTMONTH}",I18n.getMsg("Last Month")],["${EMPTY}",a],["${NOTEMPTY}",i]],Search._MONTHFILTERS=[["${LASTAGEINMONTHS1}",I18n.getMsg("game.month.left")],["${LASTAGEINMONTHS2}",I18n.getMsg("game.months.left",2)],["${LASTAGEINMONTHS3}",I18n.getMsg("game.months.left",3)],["${LASTAGEINMONTHS4}",I18n.getMsg("game.months.left",4)],["${LASTAGEINMONTHS5}",I18n.getMsg("game.months.left",5)],["${LASTAGEINMONTHS6}",I18n.getMsg("game.months.left",6)]],Search._RESTRICTEDDTFILTERS=[["Age in Days",I18n.getMsg("crm.condition.in.last")],["${THISWEEK}",I18n.getMsg("crm.thisweek")],["${THISMONTH}",I18n.getMsg("crm.label.this.month")],["${LASTWEEK}",I18n.getMsg("Last Week")],["${LASTMONTH}",I18n.getMsg("Last Month")]],Search._EMPTYCOND=[["${EMPTY}",a],["${NOTEMPTY}",i]],Search._TRACKINGFILTERS=[["Age in Days",I18n.getMsg("crm.condition.in.last")],["${TODAY}",I18n.getMsg("Today")],["${THISWEEK}",I18n.getMsg("crm.thisweek")],["${THISMONTH}",I18n.getMsg("crm.label.this.month")],["${THISYEAR}",I18n.getMsg("crm.thisyear")],["${LASTDAYS30}",I18n.getMsg("crm.condition.last.30.days")],["${LASTDAYS60}",I18n.getMsg("crm.condition.last.60.days")],["${LASTDAYS90}",I18n.getMsg("crm.condition.last.90.days")],["${NOTEMPTY}",I18n.getMsg("crm.condition.until.now")]],Search._DEFAULT=[["equal",t],["not_equal",r]],Search._SERVICESTATUSCOND=[["equal",t],["not_equal",r]],Search._TXTCOND1=[["None",I18n.getMsg("None")],["equal",t],["not_equal",r],["contains",n],["not_contains",o],["starts_with",I18n.getMsg("starts with")],["ends_with",I18n.getMsg("ends with")],["No of Characters",I18n.getMsg("crm.criteria.editor.no.of.characters")]],Search._ENCTXTCOND1=[],Search._DATETIMECOND1=[["equal",t],["not_equal",r],["less_than",I18n.getMsg("is before")],["greater_than",I18n.getMsg("is after")],["between",I18n.getMsg("between")],["not_between",I18n.getMsg("not between")],["${TODAY}",I18n.getMsg("Today")],["${TOMORROW}",I18n.getMsg("Tommorow")],["${TOMORROWPLUS}",I18n.getMsg("Tommorow Onwards")],["${YESTERDAY}",I18n.getMsg("Yesterday")],["${YESTERDAYMINUS}",I18n.getMsg("Till Yesterday")],["${LASTMONTH}",I18n.getMsg("Last Month")],["${THISMONTH}",I18n.getMsg("Current Month")],["${NEXTMONTH}",I18n.getMsg("Next Month")],["${LASTWEEK}",I18n.getMsg("Last Week")],["${THISWEEK}",I18n.getMsg("Current Week")],["${NEXTWEEK}",I18n.getMsg("Next Week")],["${LASTYEAR}",I18n.getMsg("crm.prediction.analytics.filter.year")],["${THISYEAR}",I18n.getMsg("crm.thisyear")],["${NEXTYEAR}",I18n.getMsg("crm.label.next.year")],["${PREVFQ}",I18n.getMsg("Previous FQ")],["${THISFQ}",I18n.getMsg("Current FQ")],["${NEXTFQ}",I18n.getMsg("Next FQ")],["${PREVFY}",I18n.getMsg("Previous FY")],["${THISFY}",I18n.getMsg("Current FY")],["${NEXTFY}",I18n.getMsg("Next FY")],["Age in Days",I18n.getMsg("Age in Days")],["Due in Days",I18n.getMsg("Due in Days")]],Search._NUMCOND1=[["equal","="],["not_equal","!="],["less_than","<"],["less_equal","<="],["greater_than",">"],["greater_equal",">="],["between",I18n.getMsg("between")],["not_between",I18n.getMsg("not between")]],Search._AGEINDAYSCOND1=[["equal","="],["not_equal","!="],["less_than","<"],["less_equal","<="],["greater_than",">"],["greater_equal",">="]],Search._AGEINDAYSCOND1=[["equal","="],["not_equal","!="],["less_than","<"],["less_equal","<="],["greater_than",">"],["greater_equal",">="]],Search._SOURCETRACKING=[["BOTH",I18n.getMsg("crm.source.user.and.system")],["EITHER",I18n.getMsg("crm.source.user.or.system")],["USER",I18n.getMsg("User")],["SYSTEM",I18n.getMsg("crm.label.system2")],["USERONLY",I18n.getMsg("crm.source.user.only")],["SYSTEMONLY",I18n.getMsg("crm.source.system.only")]],Search._ENCNUMCOND1=[["equal","="],["not_equal","!="]],Search._PREDEFINED=[["equal",t],["not_equal",r]],Search.typeVsCondMap={picklist:"text",datetime:"date",CML:"defwithempty",ServiceStatus:"servicestatus"},Search.fieldTypeVsDataType={textarea:"text",mediumtext:"text",integer:"num",currency:"num",bigint:"num",double:"num",ownerlookup:"U",lookup:"text",website:"text",email:"text",phone:"text",autonumber:"text",multiselectpicklist:"text"},Search.isFormRuleCriteria=!1,Search.isVRCriteria=!1,Search.isFromScoringRule=!1,Search.DEFAULTCOND={equal:t,not_equal:r},Search.TXTCOND={None:I18n.getMsg("None"),equal:t,not_equal:r,contains:n,not_contains:o,starts_with:I18n.getMsg("starts with"),ends_with:I18n.getMsg("ends with")},Search.DATETIMECOND={equal:t,not_equal:r,less_than:I18n.getMsg("is before"),greater_than:I18n.getMsg("is after"),between:I18n.getMsg("between"),not_between:I18n.getMsg("not between"),"${TODAY}":I18n.getMsg("Today"),"${TOMORROW}":I18n.getMsg("Tommorow"),"${TOMORROWPLUS}":I18n.getMsg("Tommorow Onwards"),"${YESTERDAY}":I18n.getMsg("Yesterday"),"${YESTERDAYMINUS}":I18n.getMsg("Till Yesterday"),"${LASTMONTH}":I18n.getMsg("Last Month"),"${THISMONTH}":I18n.getMsg("Current Month"),"${NEXTMONTH}":I18n.getMsg("Next Month"),"${LASTWEEK}":I18n.getMsg("Last Week"),"${THISWEEK}":I18n.getMsg("Current Week"),"${NEXTWEEK}":I18n.getMsg("Next Week"),"${LASTYEAR}":I18n.getMsg("crm.prediction.analytics.filter.year"),"${THISYEAR}":I18n.getMsg("crm.thisyear"),"${NEXTYEAR}":I18n.getMsg("crm.label.next.year"),"${PREVFQ}":I18n.getMsg("Previous FQ"),"${THISFQ}":I18n.getMsg("Current FQ"),"${NEXTFQ}":I18n.getMsg("Next FQ"),"${PREVFY}":I18n.getMsg("Previous FY"),"${THISFY}":I18n.getMsg("Current FY"),"${NEXTFY}":I18n.getMsg("Next FY"),"Age in Days":I18n.getMsg("Age in Days"),"Due in Days":I18n.getMsg("Due in Days")},Search.NUMCOND={equal:"=",not_equal:"!=",less_than:"<",less_equal:"<=",greater_than:">",greater_equal:">=",between:I18n.getMsg("between"),not_between:I18n.getMsg("not between")},Search.DATATYPEVSCMPMAP={boolean:Search.DEFAULTCOND,textarea:Search.TXTCOND,picklist:Search.TXTCOND,text:Search.TXTCOND,num:Search.NUMCOND,ownerlookup:Search.DEFAULTCOND,U:Search.DEFAULTCOND,date:Search.DATETIMECOND,datetime:Search.DATETIMECOND,mediumtext:Search.TXTCOND,integer:Search.NUMCOND,currency:Search.NUMCOND,bigint:Search.NUMCOND,double:Search.NUMCOND,lookup:Search.TXTCOND,website:Search.TXTCOND,email:Search.TXTCOND,phone:Search.TXTCOND,autonumber:Search.TXTCOND,multiselectpicklist:Search.TXTCOND,layout:Search.DEFAULTCOND,L:Search.DEFAULTCOND,tag:Search.DEFAULTCOND},Search._STAGECOND=[["None",I18n.getMsg("None")],["equal",t],["not_equal",r],["${OPEN}",I18n.getMsg("is OPEN")],["${CLOSEDWON}",I18n.getMsg("is WON")],["${CLOSEDLOST}",I18n.getMsg("is LOST")],["contains",n],["not_contains",o],["starts_with",I18n.getMsg("starts with")],["ends_with",I18n.getMsg("ends with")]],Search._STAGECOND1=[["None",I18n.getMsg("None")],["is",t],["isn't",r],["is OPEN",I18n.getMsg("is OPEN")],["is WON",I18n.getMsg("is WON")],["is LOST",I18n.getMsg("is LOST")],["contains",n],["doesn't contain",o],["starts with",I18n.getMsg("starts with")],["ends with",I18n.getMsg("ends with")],["is empty",a],["is not empty",i]],Search._STAGECONDFORM=[["None",I18n.getMsg("None")],["is",t],["isn't",r],["is OPEN",I18n.getMsg("is OPEN")],["is WON",I18n.getMsg("is WON")],["is LOST",I18n.getMsg("is LOST")],["is empty",a],["is not empty",i]]};var crmSchedulerNotification={fiveSecondsMinimize:null,permenentRemove:null,initDiv:function(e){if(0==$("#schedulerNotificationPopup").length){var t='<div id="schedulerNotificationPopup" class="pF schedularProgress-pop schedularOpen"><div class="schedularPop-Header"><h2 class="f17 pR10">';t+=I18n.getMsg(e),t+='<a href="javascript:;" class="dB fR minimizeSchedularPop pR mT5" onclick="crmSchedulerNotification.minimizeSchedularPopup();"></a></h2></div><ul class="m0 pL20 pR20 scheduledList"></ul>',$("body").append(t)}},minimizeSchedularPopup:function(){$("#schedulerNotificationPopup").removeClass("schedularOpen"),$("#MultiOperationSchedular").find(".crm-wms-icon").addClass("insideBar"),crmSchedulerNotification.checkingStatus()},addOrUpdateStatus:function(e,t){$("#MultiOperationSchedular").removeClass("dN"),this.initDiv(t);var r=$("#picklist_pop_"+e.id),a=$("#schedulerNotificationPopup"),i=a.find("ul");if(0==r.length?(clearTimeout(crmSchedulerNotification.fiveSecondsMinimize),crmSchedulerNotification.minimizeSchedular(),clearTimeout(crmSchedulerNotification.permenentRemove),i.append('<li class="m0 p20 scheduledDataList picklistReplaceList" id ="picklist_pop_'+e.id+'">'),r=$("#picklist_pop_"+e.id),a.addClass("schedularOpen")):(clearTimeout(crmSchedulerNotification.fiveSecondsMinimize),r.empty(),clearTimeout(crmSchedulerNotification.permenentRemove),crmSchedulerNotification.permenentRemovePop(),0!==$("#shareProgress").length&&$("#shareContactPopup").remove()),r.append(Handlebars.templates.crmSchedulerNotification(e)),a.addClass("schedularOpen"),a.find("li").length>3){var n=renderingUtils.windowHeight/4*3;i.css("max-height",n).addClass("oA")}},minimizeSchedular:function(){crmSchedulerNotification.fiveSecondsMinimize=setTimeout((function(){$("#schedulerNotificationPopup").removeClass("schedularOpen")}),5e3)},permenentRemovePop:function(){clearTimeout(crmSchedulerNotification.permenentRemove),0===$(".progressBarAnime").length&&(crmSchedulerNotification.permenentRemove=setTimeout((function(){$("#schedulerNotificationPopup").removeClass("schedularOpen",(function(){var e=$("#schedulerNotificationPopup");e.find("ul").empty(),e.remove()})),$("#MultiOperationSchedular").addClass("dN")}),15e3))},checkingStatus:function(){$("scheduledDataList").each((function(){$(this).find("div").hasClass("progressBarAnime")?clearTimeout(crmSchedulerNotification.fiveSecondsMinimize):(clearTimeout(crmSchedulerNotification.permenentRemove),crmSchedulerNotification.permenentRemovePop())}))},hideInSchedularBar:function(e){var t=$(e);t.hasClass("insideBar")?($("#schedulerNotificationPopup").addClass("schedularOpen"),t.removeClass("insideBar")):($("#schedulerNotificationPopup").removeClass("schedularOpen"),t.addClass("insideBar")),clearTimeout(crmSchedulerNotification.fiveSecondsMinimize),clearTimeout(crmSchedulerNotification.permenentRemove),crmSchedulerNotification.permenentRemovePop()},stopRemove:function(){clearTimeout(crmSchedulerNotification.permenentRemove)},hideRecordNotification:function(e){var t=$("#picklist_pop_"+e),r=$("#schedulerNotificationPopup");r.find("li").length<=1?(r.removeClass("schedularOpen",(function(){r.remove()})),$("#MultiOperationSchedular").addClass("dN")):t.length>0&&t.slideUp().remove()}};!function(){function e(t){var r=e.modules[t];if(!r)throw new Error('failed to require "'+t+'"');return"exports"in r||"function"!=typeof r.definition||(r.client=r.component=!0,r.definition.call(this,r.exports={},r),delete r.definition),r.exports}e.modules={},e.register=function(t,r){e.modules[t]={definition:r}},e.define=function(t,r){e.modules[t]={exports:r}},e.register("component~emitter@1.1.2",(function(e,t){function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},r.prototype.once=function(e,t){var r=this;function a(){r.off(e,a),t.apply(this,arguments)}return this._callbacks=this._callbacks||{},a.fn=t,this.on(e,a),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,a=this._callbacks[e];if(!a)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var i=0;i<a.length;i++)if((r=a[i])===t||r.fn===t){a.splice(i,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),r=this._callbacks[e];if(r)for(var a=0,i=(r=r.slice(0)).length;a<i;++a)r[a].apply(this,t);return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}})),e.register("dropzone",(function(t,r){r.exports=e("dropzone/lib/dropzone.js")})),e.register("dropzone/lib/dropzone.js",(function(t,r){(function(){var t,a,i,n,o,s,l,c,d={}.hasOwnProperty,u=[].slice;a="undefined"!=typeof Emitter&&null!==Emitter?Emitter:e("component~emitter@1.1.2"),l=function(){},t=function(e){var t;function r(e,a){var i,n,o;if(this.element=e,this.version=r.version,this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,""),this.clickableElements=[],this.listeners=[],this.files=[],"string"==typeof this.element&&(this.element=document.querySelector(this.element)),!this.element||null==this.element.nodeType)throw new Error("Invalid dropzone element.");if(this.element.dropzone)throw new Error("Dropzone already attached.");if(r.instances.push(this),this.element.dropzone=this,i=null!=(o=r.optionsForElement(this.element))?o:{},this.options=t({},this.defaultOptions,i,null!=a?a:{}),this.options.forceFallback||!r.isBrowserSupported())return this.options.fallback.call(this);if(null==this.options.url&&(this.options.url=this.element.getAttribute("action")),this.options.acceptedFiles&&this.options.acceptedMimeTypes)throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");this.options.acceptedMimeTypes&&(this.options.acceptedFiles=this.options.acceptedMimeTypes,delete this.options.acceptedMimeTypes),this.options.method=this.options.method.toUpperCase(),(n=this.getExistingFallback())&&n.parentNode&&n.parentNode.removeChild(n),!1!==this.options.previewsContainer&&(this.options.previewsContainer?this.previewsContainer=r.getElement(this.options.previewsContainer,"previewsContainer"):this.previewsContainer=this.element),this.options.clickable&&(!0===this.options.clickable?this.clickableElements=[this.element]:this.clickableElements=r.getElements(this.options.clickable,"clickable")),this.init()}return function(e,t){for(var r in t)d.call(t,r)&&(e[r]=t[r]);function a(){this.constructor=e}a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype}(r,e),r.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached"],r.prototype.defaultOptions={url:null,method:"post",withCredentials:!1,parallelUploads:2,uploadMultiple:!1,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:100,thumbnailHeight:100,maxFiles:null,params:{},clickable:!1,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!1,autoQueue:!0,addRemoveLinks:!1,previewsContainer:null,dictDefaultMessage:I18n.getMsg("crm.feed.dropfiles"),dictFallbackMessage:I18n.getMsg("crm.feed.dropzone.browser.notsupport"),dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:I18n.getMsg("crm.mailmerge.filesize",4),dictInvalidFileType:I18n.getMsg("crm.feed.dropzone.filetype.message"),dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:I18n.getMsg("crm.feed.dropzone.cancel.upload"),dictCancelUploadConfirmation:I18n.getMsg("crm.feed.dropzone.upload.makesure"),dictRemoveFile:I18n.getMsg("crm.feed.dropzone.removefile"),dictRemoveFileConfirmation:null,dictMaxFilesExceeded:I18n.getMsg("crm.feed.dropzone.file.limit.message"),accept:function(e,t){return t()},init:function(){return l},forceFallback:!1,fallback:function(){var e,t,a,i,n,o;for(this.element.className=this.element.className+" dz-browser-not-supported",i=0,n=(o=this.element.getElementsByTagName("div")).length;i<n;i++)e=o[i],/(^| )dz-message($| )/.test(e.className)&&(t=e,e.className="dz-message");return t||(t=r.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(t)),(a=t.getElementsByTagName("span")[0])&&(a.textContent=this.options.dictFallbackMessage),this.element.appendChild(this.getFallbackForm())},resize:function(e){var t,r,a;return t={srcX:0,srcY:0,srcWidth:e.width,srcHeight:e.height},r=e.width/e.height,t.optWidth=this.options.thumbnailWidth,t.optHeight=this.options.thumbnailHeight,null==t.optWidth&&null==t.optHeight?(t.optWidth=t.srcWidth,t.optHeight=t.srcHeight):null==t.optWidth?t.optWidth=r*t.optHeight:null==t.optHeight&&(t.optHeight=1/r*t.optWidth),a=t.optWidth/t.optHeight,e.height<t.optHeight||e.width<t.optWidth?(t.trgHeight=t.srcHeight,t.trgWidth=t.srcWidth):r>a?(t.srcHeight=e.height,t.srcWidth=t.srcHeight*a):(t.srcWidth=e.width,t.srcHeight=t.srcWidth/a),t.srcX=(e.width-t.srcWidth)/2,t.srcY=(e.height-t.srcHeight)/2,t},drop:function(e){return this.element.classList.remove("dz-drag-hover")},dragstart:l,dragend:function(e){return this.element.classList.remove("dz-drag-hover")},dragenter:function(e){return this.element.classList.add("dz-drag-hover")},dragover:function(e){return this.element.classList.add("dz-drag-hover")},dragleave:function(e){return this.element.classList.remove("dz-drag-hover")},paste:l,reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(e){var t,a,i,n,o,s,l,c,d,u,m,p,g;if(this.element===this.previewsContainer&&this.element.classList.add("dz-started"),this.previewsContainer){for(e.previewElement=r.createElement(this.options.previewTemplate.trim()),e.previewTemplate=e.previewElement,this.previewsContainer.appendChild(e.previewElement),i=0,s=(d=e.previewElement.querySelectorAll("[data-dz-name]")).length;i<s;i++)d[i].textContent=e.name;for(n=0,l=(u=e.previewElement.querySelectorAll("[data-dz-size]")).length;n<l;n++)u[n].innerHTML=this.filesize(e.size);for(this.options.addRemoveLinks&&(e._removeLink=r.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'+this.options.dictRemoveFile+"</a>"),e.previewElement.appendChild(e._removeLink)),g=this,t=function(t){return t.preventDefault(),t.stopPropagation(),e.status===r.UPLOADING?r.confirm(g.options.dictCancelUploadConfirmation,(function(){return g.removeFile(e)})):g.options.dictRemoveFileConfirmation?r.confirm(g.options.dictRemoveFileConfirmation,(function(){return g.removeFile(e)})):g.removeFile(e)},p=[],o=0,c=(m=e.previewElement.querySelectorAll("[data-dz-remove]")).length;o<c;o++)a=m[o],p.push(a.addEventListener("click",t));return p}},removedfile:function(e){var t;return e.previewElement&&null!=(t=e.previewElement)&&t.parentNode.removeChild(e.previewElement),this._updateMaxFilesReachedClass()},thumbnail:function(e,t){var r,a,i,n,o;if(e.previewElement){for(e.previewElement.classList.remove("dz-file-preview"),e.previewElement.classList.add("dz-image-preview"),o=[],a=0,i=(n=e.previewElement.querySelectorAll("[data-dz-thumbnail]")).length;a<i;a++)(r=n[a]).alt=e.name,o.push(r.src=t);return o}},error:function(e,t){var r,a,i,n,o;if(e.previewElement){for(e.previewElement.classList.add("dz-error"),"String"!=typeof t&&t.error&&(t=t.error),o=[],a=0,i=(n=e.previewElement.querySelectorAll("[data-dz-errormessage]")).length;a<i;a++)r=n[a],o.push(r.textContent=t);return o}},errormultiple:l,processing:function(e){if(e.previewElement&&(e.previewElement.classList.add("dz-processing"),e._removeLink))return e._removeLink.textContent=this.options.dictCancelUpload},processingmultiple:l,uploadprogress:function(e,t,r){var a,i,n,o,s;if(e.previewElement){for(s=[],i=0,n=(o=e.previewElement.querySelectorAll("[data-dz-uploadprogress]")).length;i<n;i++)a=o[i],s.push(a.style.width=t+"%");return s}},totaluploadprogress:l,sending:l,sendingmultiple:l,success:function(e){if(e.previewElement)return e.previewElement.classList.add("dz-success")},successmultiple:l,canceled:function(e){return this.emit("error",e,"Upload canceled.")},canceledmultiple:l,complete:function(e){if(e._removeLink)return e._removeLink.textContent=this.options.dictRemoveFile},completemultiple:l,maxfilesexceeded:l,maxfilesreached:l,previewTemplate:'<div class="dz-preview dz-file-preview">\n  <div class="dz-details">\n    <div class="dz-filename"><span data-dz-name></span></div>\n    <div class="dz-size" data-dz-size></div>\n    <img data-dz-thumbnail />\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-success-mark"><span>✔</span></div>\n  <div class="dz-error-mark"><span>✘</span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n</div>'},t=function(){var e,t,r,a,i,n,o;for(a=arguments[0],n=0,o=(r=2<=arguments.length?u.call(arguments,1):[]).length;n<o;n++)for(e in t=r[n])i=t[e],a[e]=i;return a},r.prototype.getAcceptedFiles=function(){var e,t,r,a,i;for(i=[],t=0,r=(a=this.files).length;t<r;t++)(e=a[t]).accepted&&i.push(e);return i},r.prototype.getRejectedFiles=function(){var e,t,r,a,i;for(i=[],t=0,r=(a=this.files).length;t<r;t++)(e=a[t]).accepted||i.push(e);return i},r.prototype.getFilesWithStatus=function(e){var t,r,a,i,n;for(n=[],r=0,a=(i=this.files).length;r<a;r++)(t=i[r]).status===e&&n.push(t);return n},r.prototype.getQueuedFiles=function(){return this.getFilesWithStatus(r.QUEUED)},r.prototype.getUploadingFiles=function(){return this.getFilesWithStatus(r.UPLOADING)},r.prototype.getActiveFiles=function(){var e,t,a,i,n;for(n=[],t=0,a=(i=this.files).length;t<a;t++)(e=i[t]).status!==r.UPLOADING&&e.status!==r.QUEUED||n.push(e);return n},r.prototype.init=function(){var e,t,a,i,n,o,s,l;for("form"===this.element.tagName&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(r.createElement('<div id="dropzonediv" style="display:none" class="dz-default dz-message"><span style="display:none">'+this.options.dictDefaultMessage+"</span></div>")),this.clickableElements.length&&(l=this,a=function(){return l.hiddenFileInput&&document.body.removeChild(l.hiddenFileInput),l.hiddenFileInput=document.createElement("input"),l.hiddenFileInput.setAttribute("type","file"),(null==l.options.maxFiles||l.options.maxFiles>1)&&l.hiddenFileInput.setAttribute("multiple","multiple"),l.hiddenFileInput.className="dz-hidden-input",null!=l.options.acceptedFiles&&l.hiddenFileInput.setAttribute("accept",l.options.acceptedFiles),l.hiddenFileInput.style.visibility="hidden",l.hiddenFileInput.style.position="absolute",l.hiddenFileInput.style.top="0",l.hiddenFileInput.style.left="200px",l.hiddenFileInput.style.height="0",l.hiddenFileInput.style.width="0",document.body.appendChild(l.hiddenFileInput),l.hiddenFileInput.addEventListener("change",(function(){var e,t,r,i;if((t=l.hiddenFileInput.files).length)for(r=0,i=t.length;r<i;r++)e=t[r],l.addFile(e);return a()}))},a()),this.URL=null!=(o=window.URL)?o:window.webkitURL,i=0,n=(s=this.events).length;i<n;i++)e=s[i],this.on(e,this.options[e]);return this.on("uploadprogress",function(e){return function(){return e.updateTotalUploadProgress()}}(this)),this.on("removedfile",function(e){return function(){return e.updateTotalUploadProgress()}}(this)),this.on("canceled",function(e){return function(t){return e.emit("complete",t)}}(this)),this.on("complete",function(e){return function(t){if(0===e.getUploadingFiles().length&&0===e.getQueuedFiles().length)return setTimeout((function(){return e.emit("queuecomplete")}),0)}}(this)),t=function(e){return e.stopPropagation(),e.preventDefault?e.preventDefault():e.returnValue=!1},this.listeners=[{element:this.element,events:{dragstart:function(e){return function(t){return e.emit("dragstart",t)}}(this),dragenter:function(e){return function(r){return t(r),e.emit("dragenter",r)}}(this),dragover:function(e){return function(r){var a;try{a=r.dataTransfer.effectAllowed}catch(e){}return r.dataTransfer.dropEffect="move"===a||"linkMove"===a?"move":"copy",t(r),e.emit("dragover",r)}}(this),dragleave:function(e){return function(t){return e.emit("dragleave",t)}}(this),drop:function(e){return function(r){return t(r),e.drop(r)}}(this),dragend:function(e){return function(t){return e.emit("dragend",t)}}(this)}}],this.clickableElements.forEach(function(e){return function(t){return e.listeners.push({element:t,events:{click:function(a){if(t!==e.element||a.target===e.element||r.elementInside(a.target,e.element.querySelector(".dz-message")))return e.hiddenFileInput.click()}}})}}(this)),this.enable(),this.options.init.call(this)},r.prototype.destroy=function(){var e;return this.disable(),this.removeAllFiles(!0),(null!=(e=this.hiddenFileInput)?e.parentNode:void 0)&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null),delete this.element.dropzone,r.instances.splice(r.instances.indexOf(this),1)},r.prototype.updateTotalUploadProgress=function(){var e,t,r,a,i,n,o;if(r=0,t=0,this.getActiveFiles().length){for(i=0,n=(o=this.getActiveFiles()).length;i<n;i++)r+=(e=o[i]).upload.bytesSent,t+=e.upload.total;a=100*r/t}else a=100;return this.emit("totaluploadprogress",a,t,r)},r.prototype._getParamName=function(e){return"function"==typeof this.options.paramName?this.options.paramName(e):""+this.options.paramName+(this.options.uploadMultiple?e:"")},r.prototype.getFallbackForm=function(){var e,t,a,i;return(e=this.getExistingFallback())?e:(a='<div class="dz-fallback">',this.options.dictFallbackText&&(a+="<p>"+this.options.dictFallbackText+"</p>"),a+='<input type="file" name="'+this._getParamName(0)+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><input type="submit" value="Upload!"></div>',t=r.createElement(a),"FORM"!==this.element.tagName?(i=r.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"></form>')).appendChild(t):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),null!=i?i:t)},r.prototype.getExistingFallback=function(){var e,t,r,a,i,n;for(t=function(e){var t,r,a;for(r=0,a=e.length;r<a;r++)if(t=e[r],/(^| )fallback($| )/.test(t.className))return t},a=0,i=(n=["div","form"]).length;a<i;a++)if(r=n[a],e=t(this.element.getElementsByTagName(r)))return e},r.prototype.setupEventListeners=function(){var e,t,r,a,i,n,o;for(o=[],a=0,i=(n=this.listeners).length;a<i;a++)e=n[a],o.push(function(){var a,i;for(t in i=[],a=e.events)r=a[t],i.push(e.element.addEventListener(t,r,!1));return i}());return o},r.prototype.removeEventListeners=function(){var e,t,r,a,i,n,o;for(o=[],a=0,i=(n=this.listeners).length;a<i;a++)e=n[a],o.push(function(){var a,i;for(t in i=[],a=e.events)r=a[t],i.push(e.element.removeEventListener(t,r,!1));return i}());return o},r.prototype.disable=function(){var e,t,r,a,i;for(this.clickableElements.forEach((function(e){return e.classList.remove("dz-clickable")})),this.removeEventListeners(),i=[],t=0,r=(a=this.files).length;t<r;t++)e=a[t],i.push(this.cancelUpload(e));return i},r.prototype.enable=function(){return this.clickableElements.forEach((function(e){return e.classList.add("dz-clickable")})),this.setupEventListeners()},r.prototype.filesize=function(e){var t;return e>=109951162777.6?(e/=109951162777.6,t="TB"):e>=107374182.4?(e/=107374182.4,t="GB"):e>=104857.6?(e/=104857.6,t="MB"):e>=102.4?(e/=102.4,t="KB"):(e*=10,t="b"),"<strong>"+Math.round(e)/10+"</strong> "+t},r.prototype._updateMaxFilesReachedClass=function(){return null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(this.getAcceptedFiles().length===this.options.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dz-max-files-reached")):this.element.classList.remove("dz-max-files-reached")},r.prototype.drop=function(e){var t,r;e.dataTransfer&&(this.emit("drop",e),(t=e.dataTransfer.files).length&&((r=e.dataTransfer.items)&&r.length&&null!=r[0].webkitGetAsEntry?this._addFilesFromItems(r):this.handleFiles(t)))},r.prototype.paste=function(e){var t,r;if(null!=(null!=e&&null!=(r=e.clipboardData)?r.items:void 0))return this.emit("paste",e),(t=e.clipboardData.items).length?this._addFilesFromItems(t):void 0},r.prototype.handleFiles=function(e){var t,r,a,i;for(i=[],r=0,a=e.length;r<a;r++)t=e[r],i.push(this.addFile(t));return i},r.prototype._addFilesFromItems=function(e){var t,r,a,i,n;for(n=[],a=0,i=e.length;a<i;a++)null!=(r=e[a]).webkitGetAsEntry&&(t=r.webkitGetAsEntry())?t.isFile?n.push(this.addFile(r.getAsFile())):t.isDirectory?n.push(this._addFilesFromDirectory(t,t.name)):n.push(void 0):null!=r.getAsFile&&(null==r.kind||"file"===r.kind)?n.push(this.addFile(r.getAsFile())):n.push(void 0);return n},r.prototype._addFilesFromDirectory=function(e,t){var r,a,i;return r=e.createReader(),i=this,a=function(e){var r,a,n;for(a=0,n=e.length;a<n;a++)(r=e[a]).isFile?r.file((function(e){if(!i.options.ignoreHiddenFiles||"."!==e.name.substring(0,1))return e.fullPath=t+"/"+e.name,i.addFile(e)})):r.isDirectory&&i._addFilesFromDirectory(r,t+"/"+r.name)},r.readEntries(a,(function(e){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log?console.log(e):void 0}))},r.prototype.accept=function(e,t){return e.size>1024*this.options.maxFilesize*1024?(alert(this.options.dictFileTooBig),this.removeFile(e)):r.isValidFile(e,this.options.acceptedFiles)?null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(alert(this.options.dictMaxFilesExceeded),this.removeFile(e)):this.options.accept.call(this,e,t):(alert(this.options.dictInvalidFileType),this.removeFile(e))},r.prototype.addFile=function(e){return e.upload={progress:0,total:e.size,bytesSent:0},this.files.push(e),e.status=r.ADDED,this.emit("addedfile",e),this._enqueueThumbnail(e),this.accept(e,(t=this,function(r){return r?(e.accepted=!1,t._errorProcessing([e],r)):(e.accepted=!0,t.options.autoQueue&&t.enqueueFile(e)),t._updateMaxFilesReachedClass()}));var t},r.prototype.enqueueFiles=function(e){var t,r,a;for(r=0,a=e.length;r<a;r++)t=e[r],this.enqueueFile(t);return null},r.prototype.enqueueFile=function(e){if(e.status!==r.ADDED||!0!==e.accepted)throw new Error("This file can't be queued because it has already been processed or was rejected.");if(e.status=r.QUEUED,this.options.autoProcessQueue)return setTimeout((t=this,function(){return t.processQueue()}),0);var t},r.prototype._thumbnailQueue=[],r.prototype._processingThumbnail=!1,r.prototype._enqueueThumbnail=function(e){if(this.options.createImageThumbnails&&e.type.match(/image.*/)&&e.size<=1024*this.options.maxThumbnailFilesize*1024)return this._thumbnailQueue.push(e),setTimeout((t=this,function(){return t._processThumbnailQueue()}),0);var t},r.prototype._processThumbnailQueue=function(){var e;if(!this._processingThumbnail&&0!==this._thumbnailQueue.length)return this._processingThumbnail=!0,this.createThumbnail(this._thumbnailQueue.shift(),(e=this,function(){return e._processingThumbnail=!1,e._processThumbnailQueue()}))},r.prototype.removeFile=function(e){if(e.status===r.UPLOADING&&this.cancelUpload(e),this.files=c(this.files,e),this.emit("removedfile",e),0===this.files.length)return this.emit("reset")},r.prototype.removeAllFiles=function(e){var t,a,i,n;for(null==e&&(e=!1),a=0,i=(n=this.files.slice()).length;a<i;a++)((t=n[a]).status!==r.UPLOADING||e)&&this.removeFile(t);return null},r.prototype.createThumbnail=function(e,t){var r,a;return(r=new FileReader).onload=(a=this,function(){var i;return(i=document.createElement("img")).onload=function(){var r,n,o,l,c,d,u,m;if(e.width=i.width,e.height=i.height,null==(o=a.options.resize.call(a,e)).trgWidth&&(o.trgWidth=o.optWidth),null==o.trgHeight&&(o.trgHeight=o.optHeight),n=(r=document.createElement("canvas")).getContext("2d"),r.width=o.trgWidth,r.height=o.trgHeight,s(n,i,null!=(c=o.srcX)?c:0,null!=(d=o.srcY)?d:0,o.srcWidth,o.srcHeight,null!=(u=o.trgX)?u:0,null!=(m=o.trgY)?m:0,o.trgWidth,o.trgHeight),l=r.toDataURL("image/png"),a.emit("thumbnail",e,l),null!=t)return t()},i.src=r.result}),r.readAsDataURL(e)},r.prototype.processQueue=function(){var e,t,r,a;if(t=this.options.parallelUploads,e=r=this.getUploadingFiles().length,!(r>=t)&&(a=this.getQueuedFiles()).length>0){if(this.options.uploadMultiple)return this.processFiles(a.slice(0,t-r));for(;e<t;){if(!a.length)return;this.processFile(a.shift()),e++}}},r.prototype.processFile=function(e){return this.processFiles([e])},r.prototype.processFiles=function(e){var t,a,i;for(a=0,i=e.length;a<i;a++)(t=e[a]).processing=!0,t.status=r.UPLOADING,this.emit("processing",t);return this.options.uploadMultiple&&this.emit("processingmultiple",e),this.uploadFiles(e)},r.prototype._getFilesWithXhr=function(e){var t;return function(){var r,a,i,n;for(n=[],r=0,a=(i=this.files).length;r<a;r++)(t=i[r]).xhr===e&&n.push(t);return n}.call(this)},r.prototype.cancelUpload=function(e){var t,a,i,n,o,s,l;if(e.status===r.UPLOADING){for(i=0,o=(a=this._getFilesWithXhr(e.xhr)).length;i<o;i++)(t=a[i]).status=r.CANCELED;for(e.xhr.abort(),n=0,s=a.length;n<s;n++)t=a[n],this.emit("canceled",t);this.options.uploadMultiple&&this.emit("canceledmultiple",a)}else(l=e.status)!==r.ADDED&&l!==r.QUEUED||(e.status=r.CANCELED,this.emit("canceled",e),this.options.uploadMultiple&&this.emit("canceledmultiple",[e]));if(this.options.autoProcessQueue)return this.processQueue()},r.prototype.uploadFile=function(e){return this.uploadFiles([e])},r.prototype.uploadFiles=function(e){var a,i,n,o,s,l,c,d,u,m,p,g,h,f,v,C,y,E,I,w,T,b,S,_,M,D,A,k,N,L,$,R;for(C=new XMLHttpRequest,y=0,T=e.length;y<T;y++)(a=e[y]).xhr=C;for(o in C.open(this.options.method,this.options.url,!0),C.withCredentials=!!this.options.withCredentials,h=null,R=this,n=function(){var t,r,i;for(i=[],t=0,r=e.length;t<r;t++)a=e[t],i.push(R._errorProcessing(e,h||R.options.dictResponseError.replace("{{statusCode}}",C.status),C));return i},f=function(t){return function(r){var i,n,o,s,l,c,d,u,m;if(null!=r)for(n=100*r.loaded/r.total,o=0,c=e.length;o<c;o++)(a=e[o]).upload={progress:n,total:r.total,bytesSent:r.loaded};else{for(i=!0,n=100,s=0,d=e.length;s<d;s++)100===(a=e[s]).upload.progress&&a.upload.bytesSent===a.upload.total||(i=!1),a.upload.progress=n,a.upload.bytesSent=a.upload.total;if(i)return}for(m=[],l=0,u=e.length;l<u;l++)a=e[l],m.push(t.emit("uploadprogress",a,n,a.upload.bytesSent));return m}}(this),C.onload=function(t){return function(a){var i;if(e[0].status!==r.CANCELED&&4===C.readyState){if("success"!=(h=C.responseText)?e.length>1?alert(I18n.getMsg("crm.security.virus.alert.many")):alert(I18n.getMsg("crm.security.virus.alert.one")):document.getElementById("feed_status").value="",C.getResponseHeader("content-type")&&~C.getResponseHeader("content-type").indexOf("application/json"))try{h=JSON.parse(h)}catch(e){a=e,h="Invalid JSON response from server."}return f(),200<=(i=C.status)&&i<300?t._finished(e,h,a):n()}}}(this),C.onerror=function(){if(e[0].status!==r.CANCELED)return n()},(null!=(D=C.upload)?D:C).onprogress=f,l={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"},this.options.headers&&t(l,this.options.headers),l)s=l[o],C.setRequestHeader(o,s);if(i=new FormData,this.options.params)for(p in A=this.options.params)v=A[p],i.append(p,v);for(E=0,b=e.length;E<b;E++)a=e[E],this.emit("sending",a,C,i);if(this.options.uploadMultiple&&this.emit("sendingmultiple",e,C,i),"FORM"===this.element.tagName)for(I=0,S=(k=this.element.querySelectorAll("input, textarea, select, button")).length;I<S;I++)if(u=(d=k[I]).getAttribute("name"),m=d.getAttribute("type"),null!=u)if("SELECT"===d.tagName&&d.hasAttribute("multiple"))for(w=0,_=(N=d.options).length;w<_;w++)(g=N[w]).selected&&i.append(u,g.value);else(!m||"checkbox"!==(L=m.toLowerCase())&&"radio"!==L||d.checked)&&i.append(u,d.value);for(c=M=0,$=e.length-1;0<=$?M<=$:M>=$;c=0<=$?++M:--M)i.append(this._getParamName(c),e[c],e[c].name);try{return C.send(i)}catch(t){e.length>1?alert(I18n.getMsg("crm.security.virus.alert.many")):alert(I18n.getMsg("crm.security.virus.alert.one"))}},r.prototype._finished=function(e,t,a){var i,n,o;for(n=0,o=e.length;n<o;n++)(i=e[n]).status=r.SUCCESS,this.emit("success",i,t,a),this.emit("complete",i);if(this.options.uploadMultiple&&(this.emit("successmultiple",e,t,a),this.emit("completemultiple",e)),this.options.autoProcessQueue)return this.processQueue()},r.prototype._errorProcessing=function(e,t,a){var i,n,o;for(n=0,o=e.length;n<o;n++)(i=e[n]).status=r.ERROR,this.emit("error",i,t,a),this.emit("complete",i);if(this.options.uploadMultiple&&(this.emit("errormultiple",e,t,a),this.emit("completemultiple",e)),this.options.autoProcessQueue)return this.processQueue()},r}(a),t.version="3.10.2",t.options={},t.optionsForElement=function(e){return e.getAttribute("id")?t.options[i(e.getAttribute("id"))]:void 0},t.instances=[],t.forElement=function(e){if("string"==typeof e&&(e=document.querySelector(e)),null==(null!=e?e.dropzone:void 0))throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return e.dropzone},t.autoDiscover=!0,t.discover=function(){var e,r,a,i,n,o;for(document.querySelectorAll?a=document.querySelectorAll(".dropzone"):(a=[],e=function(e){var t,r,i,n;for(n=[],r=0,i=e.length;r<i;r++)t=e[r],/(^| )dropzone($| )/.test(t.className)?n.push(a.push(t)):n.push(void 0);return n},e(document.getElementsByTagName("div")),e(document.getElementsByTagName("form"))),o=[],i=0,n=a.length;i<n;i++)r=a[i],!1!==t.optionsForElement(r)?o.push(new t(r)):o.push(void 0);return o},t.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i],t.isBrowserSupported=function(){var e,r,a,i;if(e=!0,window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a"))for(r=0,a=(i=t.blacklistedBrowsers).length;r<a;r++)i[r].test(navigator.userAgent)&&(e=!1);else e=!1;else e=!1;return e},c=function(e,t){var r,a,i,n;for(n=[],a=0,i=e.length;a<i;a++)(r=e[a])!==t&&n.push(r);return n},i=function(e){return e.replace(/[\-_](\w)/g,(function(e){return e.charAt(1).toUpperCase()}))},t.createElement=function(e){var t;return(t=document.createElement("div")).innerHTML=e,t.childNodes[0]},t.elementInside=function(e,t){if(e===t)return!0;for(;e=e.parentNode;)if(e===t)return!0;return!1},t.getElement=function(e,t){var r;if("string"==typeof e?r=document.querySelector(e):null!=e.nodeType&&(r=e),null==r)throw new Error("Invalid `"+t+"` option provided. Please provide a CSS selector or a plain HTML element.");return r},t.getElements=function(e,t){var r,a,i,n,o,s,l;if(e instanceof Array){a=[];try{for(i=0,o=e.length;i<o;i++)r=e[i],a.push(this.getElement(r,t))}catch(e){e,a=null}}else if("string"==typeof e)for(a=[],n=0,s=(l=document.querySelectorAll(e)).length;n<s;n++)r=l[n],a.push(r);else null!=e.nodeType&&(a=[e]);if(null==a||!a.length)throw new Error("Invalid `"+t+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");return a},t.confirm=function(e,t,r){return window.confirm(e)?t():null!=r?r():void 0},t.isValidFile=function(e,t){var r,a,i,n,o;if(!t)return!0;for(t=t.split(","),r=(a=e.type).replace(/\/.*$/,""),n=0,o=t.length;n<o;n++)if("."===(i=(i=t[n]).trim()).charAt(0)){if(-1!==e.name.toLowerCase().indexOf(i.toLowerCase(),e.name.length-i.length))return!0}else if(/\/\*$/.test(i)){if(r===i.replace(/\/.*$/,""))return!0}else if(a===i)return!0;return!1},"undefined"!=typeof jQuery&&null!==jQuery&&(jQuery.fn.dropzone=function(e){return this.each((function(){return new t(this,e)}))}),null!=r?r.exports=t:window.Dropzone=t,t.ADDED="added",t.QUEUED="queued",t.ACCEPTED=t.QUEUED,t.UPLOADING="uploading",t.PROCESSING=t.UPLOADING,t.CANCELED="canceled",t.ERROR="error",t.SUCCESS="success",o=function(e){var t,r,a,i,n,o,s,l;for(e.naturalWidth,n=e.naturalHeight,(t=document.createElement("canvas")).width=1,t.height=n,(r=t.getContext("2d")).drawImage(e,0,0),a=r.getImageData(0,0,1,n).data,l=0,i=n,o=n;o>l;)0===a[4*(o-1)+3]?i=o:l=o,o=i+l>>1;return 0===(s=o/n)?1:s},s=function(e,t,r,a,i,n,s,l,c,d){var u;return u=o(t),e.drawImage(t,r,a,i,n,s,l,c,d/u)},n=function(e,t){var r,a,i,n,o,s,l,c,d;if(i=!1,d=!0,a=e.document,c=a.documentElement,r=a.addEventListener?"addEventListener":"attachEvent",l=a.addEventListener?"removeEventListener":"detachEvent",s=a.addEventListener?"":"on",n=function(r){if("readystatechange"!==r.type||"complete"===a.readyState)return("load"===r.type?e:a)[l](s+r.type,n,!1),!i&&(i=!0)?t.call(e,r.type||r):void 0},o=function(){try{c.doScroll("left")}catch(e){return e,void setTimeout(o,50)}return n("poll")},"complete"!==a.readyState){if(a.createEventObject&&c.doScroll){try{d=!e.frameElement}catch(e){}d&&o()}return a[r](s+"DOMContentLoaded",n,!1),a[r](s+"readystatechange",n,!1),e[r](s+"load",n,!1)}},t._autoDiscoverFunction=function(){if(t.autoDiscover)return t.discover()},n(window,t._autoDiscoverFunction)}).call(this)})),"object"==typeof exports?module.exports=e("dropzone"):"function"==typeof define&&define.amd?define([],(function(){return e("dropzone")})):this.Dropzone=e("dropzone")}(),Handlebars.registerHelper("getEntityImgSrc",(function(e,t,r){var a=networkUtils.getImageUrl("user_d522435_.jpg",ResourceConstants.CRM);return"Contacts"===e||"Leads"===e?validationUtils.isNotEmpty(e)&&validationUtils.isNotEmpty(r)&&(a=Crm.getCrmBasePath()+"/EntityImageAttach.do?action_module="+e+"&entityId="+t+"&actionName=readImage&fileId="+r):a="",a})),Handlebars.registerHelper("ctiapi_businesscard_entityimage",(function(e,t,r,a){var i=Handlebars.helpers.getEntityImgSrc(e,t,r),n="";return""!==i&&(n='<div class="floatL ',n+=1==a?'zchat-propic"':'pR10"',n+='id="ctiapi_businesscard_entityimage"><img src="'+i+'" width="42"></div>'),new Handlebars.SafeString(n)})),Handlebars.registerHelper("ctiapi_businesscard_entityextradetails",(function(e,t,r,a){var i="";return i="Contacts"===e&&validationUtils.isNotEmpty(t)?'<p><a href="javascript:void(0);" class="color_79 ellipsistext dB w250" id="ctiapi_businesscard_entityextradetails" onclick="CTIAPI.openUrl(\''+t+"','"+r+"');\">"+$ESAPI.encoder().encodeForHTML(a)+"</a></p>":'<p><a href="javascript:void(0);" class="color_79 ellipsistext dB w250" id="ctiapi_businesscard_entityextradetails">'+$ESAPI.encoder().encodeForHTML(a)+"</a></p>",new Handlebars.SafeString(i)})),Handlebars.registerHelper("ctiapi_businesscard_entityextradetails_forchat",(function(e,t,r,a){var i;return i='<span id="ctiapi_businesscard_entityextradetails_forchat"> - '+$ESAPI.encoder().encodeForHTML(a)+"</span>",new Handlebars.SafeString(i)})),Handlebars.registerHelper("ctiapi_businesscard_create",(function(e){var t,r="",a=e.isForChat;if(!a){var i=e.useridVsProfileidMap,n=e.moduleVsProfiles,o=n[e.entitymodule][i[void 0!==Crm.userDetails.USER_ID?Crm.userDetails.USER_ID:ctiApiUrlUserId]];t=Object.keys(o)}if(a){r+="<div>",r+='<div class="zchat-msgbox pL15 pR15">',r+='<div class="zchat-msgtitle ellipsis"><span class="subtitle"></span></div>',r+='<div class="zchat-msgcntbdy">',r+='<div class="zchat-msgtble">',r+='<div class="zchat-thmeslabcnt">';for(var s=e.orderedbusinessCard.length,l=0;l<s;l++){var c=(p=e.orderedbusinessCard[l]).labelName,d=p.displayLabelName,u=p.p_moduleName,m=p.uiType;r+='<div class="zchat-zcmslble">',r+=$ESAPI.encoder().encodeForHTML(d),r+="</div>",r+='<div class="zchat-zcmsnme">',validationUtils.isNotEmpty(e.businessCard[c])&&("301"!==m||e.forPostingChat?r+="3"===m?'<div id="setWidthForCallRemDesc" style="width:175px;" class="ellipsistext">'+$ESAPI.encoder().encodeForHTML(e.businessCard[c]+"")+"</div>":$ESAPI.encoder().encodeForHTML(e.businessCard[c]+""):!0===e.businessCard[c]||"true"===e.businessCard[c]?r+='<span " class="yes" style="display: block; position: absolute;" width="13px" height="12px"><span>':r+=""),r+="</div>"}r+="</div></div></div></div></div>"}else{r+='<table cellpadding="0" cellspacing="0" border="0" class="pT10 fixedlayout" width="100%" >';for(s=e.orderedbusinessCard.length,l=0;l<s;l++){var p;c=(p=e.orderedbusinessCard[l]).labelName,d=p.displayLabelName,u=p.p_moduleName,m=p.uiType;if(void 0!==i&&void 0!==n&&-1!==t.indexOf(c)||a){if(r+="<tr>",r+='<td class="color_79 pR15 pT5 f13" valign="top">',r+=$ESAPI.encoder().encodeForHTML(d),r+="</td>",r+='<td class="color1 pT5 f13 ellipsistext" valign="top"><div class="ellipsistext '+(e.forPostingChat?"w300":"")+'">',validationUtils.isNotEmpty(e.businessCard[c]))if("9"===m&&"Vendors"===u){var g=e.businessCard[c],h=g.entityid,f=g.entityName;validationUtils.isNotEmpty(f)&&(r+="<a href='javascript:void(0);' onclick=\"CTIAPI.openUrl('"+h+"','"+u+"')\">"+$ESAPI.encoder().encodeForHTML(f)+"</a>")}else if("301"!==m||e.forPostingChat)if("3"===m)r+='<div id="setWidthForCallRemDesc" style="width:175px;" class="ellipsistext">'+$ESAPI.encoder().encodeForHTML(e.businessCard[c]+"")+"</div>";else if("21"===m){var v="http://",C=e.businessCard[c].toLowerCase().includes("https://")||e.businessCard[c].toLowerCase().includes(v),y=e.businessCard[c];!1===C&&(y=v+y),r+="<a href='"+y+"' target='_blank'>"+$ESAPI.encoder().encodeForHTML(e.businessCard[c]+"")+"</a>"}else r+="25"===m?"<a href='mailto:"+e.businessCard[c]+"'>"+$ESAPI.encoder().encodeForHTML(e.businessCard[c]+"")+"</a>":$ESAPI.encoder().encodeForHTML(e.businessCard[c]+"");else!0===e.businessCard[c]||"true"===e.businessCard[c]?r+='<span " class="yes" style="display: block; position: absolute;" width="13px" height="12px"><span>':r+="";r+="</div></td>",r+="</tr>"}}r+="</table>"}return new Handlebars.SafeString(r)})),Handlebars.registerHelper("ctiapi_singlepotential_create",(function(e){var t="",r=e.potentials.potential1,a=e.useridVsProfileidMap,i=e.moduleVsProfiles,n=void 0!==a,o=void 0!==i,s=i.Potentials[a[void 0!==Crm.userDetails.USER_ID?Crm.userDetails.USER_ID:ctiApiUrlUserId]],l=Object.keys(s);t+='<table cellpadding="0" cellspacing="0" border="0" class="pT5">';for(var c=r.orderedbusinessCard.length,d=0;d<c;d++){var u=r.orderedbusinessCard[d],m=u.labelName,p=u.displayLabelName,g=u.p_moduleName,h=u.uiType;if(n&&o&&-1!==l.indexOf(m)){if(t+="<tr>",t+='<td class="color_79 pR15 pT5 f13" valign="top">',t+=$ESAPI.encoder().encodeForHTML(p),t+="</td>",t+='<td class="color1 pT5 f13 ellipsistext" valign="top"><div class="ellipsistext">',validationUtils.isNotEmpty(r.businessCard[m]))if("4"!==h&&"13"!==h&&"5"!==h||"Contacts"!==g&&"Accounts"!==g&&"Campaigns"!==g)if("21"===h){var f="http://",v=r.businessCard[m].toLowerCase().includes("https://")||r.businessCard[m].toLowerCase().includes(f),C=r.businessCard[m];!1===v&&(C=f+C),t+="<a href='"+C+"' target='_blank'>"+$ESAPI.encoder().encodeForHTML(r.businessCard[m]+"")+"</a>"}else t+="25"===h?"<a href='mailto:"+r.businessCard[m]+"'>"+$ESAPI.encoder().encodeForHTML(r.businessCard[m]+"")+"</a>":$ESAPI.encoder().encodeForHTML(r.businessCard[m]+"");else{var y=r.businessCard[m],E=y.entityid,I=y.entityName;validationUtils.isNotEmpty(I)&&(t+="<a href='javascript:void(0);' onclick=\"CTIAPI.openUrl('"+E+"','"+g+"')\">"+$ESAPI.encoder().encodeForHTML(I)+"</a>")}t+="</div></td>",t+="</tr>"}}return t+="</table>",new Handlebars.SafeString(t)})),Handlebars.registerHelper("ctiapi_singlepotential",(function(e){return new Handlebars.SafeString(Handlebars.templates.ctiapi_businesscard_single_potential(e))})),Handlebars.registerHelper("ctiapi_businesscard_multi_potential_tablebody",(function(e){return new Handlebars.SafeString(Handlebars.templates.ctiapi_businesscard_multi_potential_tablebody(e))})),Handlebars.registerHelper("ctiapi_businesscard",(function(e){return new Handlebars.SafeString(Handlebars.templates.ctiapi_businesscard(e))})),Handlebars.registerHelper("ctiapi_dialpad_keypad",(function(e){for(var t=[1,2,3,4,5,6,7,8,9,"*",0,"#"],r="",a=t.length,i=0;i<a;i++)r+=e.fn(t[i]);return r})),Handlebars.registerHelper("ctiapi_calltransfer_to_repslistview",(function(e){return Handlebars.templates.ctiapi_calltransfer_to_repslistview(e)})),Handlebars.registerHelper("ctiapi_calldesc_div_create",(function(e){var t="",r=e.moduleVsProfiles,a=e.useridVsProfileidMap,i=r.Calls[a[void 0!==Crm.userDetails.USER_ID?Crm.userDetails.USER_ID:ctiApiUrlUserId]];t='<div id="ctiapi_calldesc_div" class="clearFix" style="display:none;">';return-1!=Object.keys(i).indexOf("Description")&&(t+='<textarea class="w100p p10 h70 fL bL0 bsbb" id="ctiapi_calldesc" placeholder="'+I18n.getMsg("crm.tpi.ctiapi.label.notification.callnotes")+'" onkeyup="ctiApiNotifier.new_editDesc(this.value);ctiApiNotifier.descTextAreaAdjust(this)"></textarea><div class="svgIcons callrResizeIcon dIB bgFFF"></div>'),t+="</div>",new Handlebars.SafeString(t)})),Handlebars.registerHelper("ctiapi_businesscard_potential_count_multiple",(function(e){var t=moduleRecordMapping.Potentials.plural_label,r="("+e+")",a=I18n.getMsg("crm.right.open.module",t+" "+r);return new Handlebars.SafeString(a)})),Handlebars.registerHelper("ctiapi_pass_multipotential",(function(e){return JSON.stringify(e)})),Handlebars.registerHelper("ctiapi_businesscard_potential_count_single",(function(){var e=moduleRecordMapping.Potentials.singular_label,t=I18n.getMsg("crm.right.open.module",e);return new Handlebars.SafeString(t)})),Handlebars.registerHelper("getFormatedName",(function(e,t){return CTIAPI.getFormatedName(e,t)})),Handlebars.registerHelper("ifSingleNo",(function(e,t){return 1===Object.keys(e.phoneNo).length?t.fn(e):($("#businessView").closest("td").css("width","150px"),t.inverse(e))})),Handlebars.registerHelper("getWidth",(function(e){return e&&e.phoneNo&&Object.keys(e.phoneNo).length>1?new Handlebars.SafeString("width:150px;"):new Handlebars.SafeString("width:140px;")})),Handlebars.registerHelper("getPhoneFiled",(function(e){for(var t in e)if(e.hasOwnProperty(t))return e[t];return""})),Handlebars.registerHelper("getActivityId",(function(e){return!e.callStatus||e.callStatus.toUpperCase()!=="scheduled".toUpperCase()&&e.callStatus.toUpperCase()!=="overdue".toUpperCase()?"":e.entityid})),Handlebars.registerHelper("getActivityIdCallBack",(function(e){if(!e.callStatus||e.callStatus.toUpperCase()!=="scheduled".toUpperCase()&&e.callStatus.toUpperCase()!=="overdue".toUpperCase())return"";var t={};return t.callActivityId=e.entityid,JSON.stringify(t)})),Handlebars.registerHelper("getEnableValue",(function(e,t){return"type3"==t?I18n.getMsg("crm.button.enable"):"type4"===t?e?I18n.getMsg("crm.phonebridge.provider.getitnow"):I18n.getMsg("crm.phonebridge.provider.comingsoon"):I18n.getMsg("crm.button.enable")})),Handlebars.registerHelper("getClickFn",(function(e,t,r,a){return"AWSLily"===r?"ctiApiConfig.enableLily()":"type4"===t||"type2"===t?a?'window.open("'+e+'")':'CTIAPI.sendEmail("'+r+'")':"widget"===t?'window.open("'+e+'")':void 0})),Handlebars.registerHelper("isVideoAvail",(function(e,t){for(var r in e)if(e.hasOwnProperty(r)&&validationUtils.isNotEmpty(e[r])&&-1===e[r].indexOf(".jpg")&&-1===e[r].indexOf(".png"))return t.fn(e[r]);return null})),Handlebars.registerHelper("iterImage",(function(e,t){var r="";return Object.keys(e).forEach((function(a,i){!validationUtils.isNotEmpty(e[i])||-1===e[i].indexOf(".jpg")&&-1===e[i].indexOf(".png")||(r+=t.fn(e[i]))})),r})),Handlebars.registerHelper("isBetaAccessProvider",(function(e){return e&&"*"===e.trim()?"openAccess":"betaAccess"})),Handlebars.registerHelper("getModFromMap",(function(e){var t=e.slice(0,e.length-1);return moduleRecordMapping[e].singular_label!==t?moduleRecordMapping[e].singular_label:I18n.getMsg(t)})),Handlebars.registerHelper("getDisableFunc",(function(e,t,r){var a="";switch(e){case"type3":"AWSLily"===t&&(a="ctiApiConfig.disableLily()");break;case"type4":a="crmui.showPopup('revokePop');";break;case"widget":a='window.open("'+r+'")'}return a})),function(){var e=Handlebars.template;(Handlebars.templates=Handlebars.templates||{}).ctiapi_reminder_businesscard=e({1:function(e,t,r,a,i){return' <div class="bT p20 profileCont"> '},3:function(e,t,r,a,i){var n;return' <div class="p15 pT20 pB20 bussinesCardCtn '+(null!=(n=r.if.call(null!=t?t:{},null!=t?t.isForChat:t,{name:"if",hash:{},fn:e.program(4,i,0),inverse:e.noop,data:i}))?n:"")+'" > '},4:function(e,t,r,a,i){return" zchat-zcmsg_bx zchat-zcmsg_bx10"},6:function(e,t,r,a,i){return" <div> "},8:function(e,t,r,a,i){return' <div class="floatL"> '},10:function(e,t,r,a,i){var n;return" "+(null!=(n=r.isNotEmpty.call(null!=t?t:{},null!=t?t.extradetails:t,{name:"isNotEmpty",hash:{},fn:e.program(11,i,0),inverse:e.noop,data:i}))?n:"")+" "},11:function(e,t,r,a,i){return" "+e.escapeExpression(r.ctiapi_businesscard_entityextradetails_forchat.call(null!=t?t:{},null!=t?t.entitymodule:t,null!=t?t.extraid:t,null!=t?t.extramodule:t,null!=t?t.extradetails:t,{name:"ctiapi_businesscard_entityextradetails_forchat",hash:{},data:i}))+" "},13:function(e,t,r,a,i){return' <div class="cB"></div> </div> '},15:function(e,t,r,a,i){var n;return' <div> <a href="javascript;;" class="color_79"> '+(null!=(n=r.isNotEmpty.call(null!=t?t:{},null!=t?t.extradetails:t,{name:"isNotEmpty",hash:{},fn:e.program(16,i,0),inverse:e.noop,data:i}))?n:"")+" </a> </div> "},16:function(e,t,r,a,i){return" "+e.escapeExpression(r.ctiapi_businesscard_entityextradetails.call(null!=t?t:{},null!=t?t.entitymodule:t,null!=t?t.extraid:t,null!=t?t.extramodule:t,null!=t?t.extradetails:t,{name:"ctiapi_businesscard_entityextradetails",hash:{},data:i}))+" "},18:function(e,t,r,a,i){return" </div> "},compiler:[7,">= 4.0.0"],main:function(e,t,r,a,i){var n,o=null!=t?t:{},s=e.escapeExpression,l=e.lambda;return" "+(null!=(n=r.if.call(o,null!=t?t.lower_reminder:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.program(3,i,0),data:i}))?n:"")+" "+(null!=(n=r.if.call(o,null!=t?t.isForChat:t,{name:"if",hash:{},fn:e.program(6,i,0),inverse:e.noop,data:i}))?n:"")+" "+s(r.ctiapi_businesscard_entityimage.call(o,null!=t?t.entitymodule:t,null!=t?t.entityid:t,null!=t?t.photofileid:t,null!=t?t.isForChat:t,{name:"ctiapi_businesscard_entityimage",hash:{},data:i}))+" "+(null!=(n=r.unless.call(o,null!=t?t.isForChat:t,{name:"unless",hash:{},fn:e.program(8,i,0),inverse:e.noop,data:i}))?n:"")+' <div class="fL zchat-btncnt"> <a href="javascript:void(0);" class="font20 color1 ellipsistext dB w250" id="ctiapi_businesscard_entityname" onclick="CTIAPI.openUrl(\''+s(l(null!=t?t.entityid:t,t))+"','"+s(l(null!=t?t.entitymodule:t,t))+"','','','','_blank');\" title=\""+s(r.encodeForHtmlWithoutNull.call(o,null!=t?t.entityname:t,{name:"encodeForHtmlWithoutNull",hash:{},data:i}))+'"> '+s(r.encodeForHtmlWithoutNull.call(o,null!=t?t.entityname:t,{name:"encodeForHtmlWithoutNull",hash:{},data:i}))+" </a> "+(null!=(n=r.if.call(o,null!=t?t.isForChat:t,{name:"if",hash:{},fn:e.program(10,i,0),inverse:e.noop,data:i}))?n:"")+" </div> "+(null!=(n=r.if.call(o,null!=t?t.isForChat:t,{name:"if",hash:{},fn:e.program(13,i,0),inverse:e.noop,data:i}))?n:"")+" "+(null!=(n=r.unless.call(o,null!=t?t.isForChat:t,{name:"unless",hash:{},fn:e.program(15,i,0),inverse:e.noop,data:i}))?n:"")+" "+s(r.ctiapi_businesscard_create.call(o,t,{name:"ctiapi_businesscard_create",hash:{},data:i}))+" "+(null!=(n=r.unless.call(o,null!=t?t.isForChat:t,{name:"unless",hash:{},fn:e.program(18,i,0),inverse:e.noop,data:i}))?n:"")+' <br class="clearB"> </div>'},useData:!0})}();var pricingDetails={addHeader:function(e){var t=document.createElement("div");return t.id="Product_Details",e.appendChild(t),t.innerHTML="<table width='100%' border=0 cellspacing=0 cellpadding=0 class='pricingDet'><tr id='tablehead' class='tableHeadBg '><th nowrap=true><div class='labelTabCreate pL5 pR newmandatory'>"+I18n.getMsg("From Range")+"</div></th><th nowrap=true><div class='labelTabCreate pL5 pR newmandatory'>"+I18n.getMsg("To Range")+"</div></th><th nowrap=true><div class='labelTabCreate pL5 pR newmandatory'>"+I18n.getMsg("Discount (%)")+"</div></th><th nowrap=true class='tableHead' align='center' width='15'></th></tr><tr id='hrow1' class='hrow1'></tr></table>",t},addFooter:function(e,t){var r=renderingUtils.createHTML({name:"table",attr:{width:"100%",border:0,cellspacing:"0",cellpadding:"0",bgcolor:"#FFFFFF"}});r.innerHTML='<tbody><tr><td width="150" class="pT20"><input type="button" class="outlineprimary newbutton" value="Add" onclick="pricingDetails.create(\''+$ESAPI.encoder().encodeForHTML(e)+"',true)\"></td></tr></tbody>",t.appendChild(r)},delete:function(e){var t=$(".hrow1").length;$("#hrow"+e).remove(),$("#tableline"+e).remove();for(var r=e+1;r<=t;r++){var a=$("#hrow"+r);a.find("#delRow").attr("onClick","return pricingDetails.delete("+(r-1)+")"),a.attr("id","hrow"+(r-1)),$("#Crm_PriceBooks_txtFromRange"+r).data({name:"fromRange"+(r-1),label:"fromRange"+(r-1),colname:"txtFromRange"+(r-1),zcqa:"fromRange"+(r-1)}).attr("id","Crm_PriceBooks_txtFromRange"+(r-1)),$("#Crm_PriceBooks_txtToRange"+r).data({name:"toRange"+(r-1),label:"toRange"+(r-1),colname:"txtToRange"+(r-1),zcqa:"toRange"+(r-1)}).attr("id","Crm_PriceBooks_txtToRange"+(r-1)),$("#Crm_PriceBooks_txtDiscount"+r).data({name:"discount"+(r-1),label:"discount"+(r-1),colname:"txtDiscount"+(r-1),zcqa:"txtDiscount"+(r-1)}).attr("id","Crm_PriceBooks_txtDiscount"+(r-1))}},create:function(e,t){var r,a;r=document.createDocumentFragment(),PriceBooks.createEditJson.entityMapJson&&PriceBooks.createEditJson.entityMapJson.PRICINGDETAILS&&(a=PriceBooks.createEditJson.entityMapJson.PRICINGDETAILS.pricingDetails);var i=document.getElementsByClassName("hrow1"),n=i.length,o="false",s=null;if(t)o="true";if(!t&&a&&a.length>0){o="true";var l=0,c=a.length;for(l=0;l<c;l++)if(a[l]){if(0==l)i=this.addHeader(r).getElementsByClassName("hrow1")[0];else(u=document.createElement("tr")).id="hrow"+(l+1),u.className="hrow1",i.parentNode.appendChild(u),i=u;var d={module:e,currentField:{colname:"txtFromRange"+(l+1),customfield:"false",displaylabel:I18n.getMsg("From Range"),label:"fromRange"+(l+1),mandate:o,maxlength:"19",type:"text",decimalLength:"2",uitype:"38",defaultvalue:a[l].fromRange}};(s=document.createElement("td")).appendChild(crmTemplate.createFieldContent(d)),s.childNodes[0].size=17,$(s).attr({class:"tableData",valign:"top"}).find("input,select").removeClass("searchFormatText").css("width",""),i.appendChild(s);d={module:e,currentField:{colname:"txtToRange"+(l+1),customfield:"false",displaylabel:I18n.getMsg("To Range"),label:"toRange"+(l+1),mandate:o,maxlength:"19",type:"text",uitype:"38",decimalLength:"2",defaultvalue:a[l].toRange}};(s=document.createElement("td")).appendChild(crmTemplate.createFieldContent(d)),s.childNodes[0].size=17,$(s).attr({class:"tableData",valign:"top"}).find("input,select").removeClass("searchFormatText").css("width",""),i.appendChild(s);d={module:e,currentField:{colname:"txtDiscount"+(l+1),customfield:"false",displaylabel:I18n.getMsg("Discount (%)"),label:"discount"+(l+1),mandate:o,maxlength:"19",decimalLength:"2",type:"text",uitype:"38",defaultvalue:a[l].discount}};if((s=document.createElement("td")).appendChild(crmTemplate.createFieldContent(d)),s.childNodes[0].size=17,$(s).attr({class:"tableData",valign:"top"}).find("input,select").removeClass("searchFormatText").css("width",""),i.appendChild(s),0!=l)(m=renderingUtils.createHTML({name:"td",css:"padding:3px;",attr:{align:"center",width:"15",class:"tableData"}})).innerHTML='<span id="delRow"  title="Delete Row"  class="close1 dIB mL0 mT20"  onclick="return pricingDetails.delete('+(l+1)+')">&nbsp;',i.appendChild(m)}this.addFooter(e,r)}else{var u;if(0==n)i=this.addHeader(r).getElementsByClassName("hrow1")[0];else(u=document.createElement("tr")).id="hrow"+(n+1),u.className="hrow1",i[n-1].parentNode.appendChild(u),i=u;d={module:e,currentField:{colname:"txtFromRange"+ ++n,customfield:"false",displaylabel:I18n.getMsg("From Range"),label:"fromRange"+n,mandate:o,maxlength:"19",type:"text",uitype:"38",decimalLength:"2"}};(s=document.createElement("td")).appendChild(crmTemplate.createFieldContent(d)),s.childNodes[0].size=17,$(s).attr({class:"tableData",valign:"top"}).find("input,select").removeClass("searchFormatText").css("width",""),i.appendChild(s);d={module:e,currentField:{colname:"txtToRange"+n,customfield:"false",displaylabel:I18n.getMsg("To Range"),label:"toRange"+n,mandate:o,maxlength:"19",type:"text",uitype:"38",decimalLength:"2"}};(s=document.createElement("td")).appendChild(crmTemplate.createFieldContent(d)),s.childNodes[0].size=17,$(s).attr({class:"tableData",valign:"top"}).find("input,select").removeClass("searchFormatText").css("width",""),i.appendChild(s);d={module:e,currentField:{colname:"txtDiscount"+n,customfield:"false",displaylabel:I18n.getMsg("Discount (%)"),label:"discount"+n,mandate:o,maxlength:"19",type:"text",uitype:"38",decimalLength:"2"}};if((s=document.createElement("td")).appendChild(crmTemplate.createFieldContent(d)),s.childNodes[0].size=17,$(s).attr({class:"tableData",valign:"top"}).find("input,select").removeClass("searchFormatText").css("width",""),i.appendChild(s),n-1==0&&this.addFooter(e,r),n>1){(m=renderingUtils.createHTML({name:"td",css:"padding:3px;",attr:{align:"center",width:"15",class:"tableData"}})).innerHTML='<span id="delRow" title="Delete Row" class="close1 dIB mL0 mT20" onclick="return pricingDetails.delete('+n+')">&nbsp;',i.appendChild(m)}else{var m=renderingUtils.createHTML({name:"td",css:"padding:3px;",attr:{align:"center",width:"15",class:"tableData"}});i.appendChild(m)}$("#Crm_PriceBooks_txtFromRange"+n).focus()}return r},togglePricingDetails:function(e){var t=$("#secDiv_Pricing_Details"),r=t.find(".hrow1"),a=r.length;if("-None-"==e||""===e){t.hide();for(var i=0;i<a;i++)$(r[i]).find(".textField").data("mandate",!1)}else{for(i=0;i<a;i++)$(r[i]).find(".textField").data("mandate",!0);t.show()}}};function init(e,t,r){if(location.host.includes("zoho.in")&&"60010197171"===crmZgid&&(detailview_log.initJS_start=performance.now()),"quickView"!==t&&$("html, body").animate({scrollTop:0},"0"),"undefined"!=typeof returnJson){detailView.createTemplate(returnJson);returnJson.entityMapJson&&returnJson.entityMapJson.CONTACTID;if(returnJson.Calls&&returnJson.entMetaData&&returnJson.entMetaData.phoneNo&&!isNewCallView){var a=$("#unknownEntityContainer");$("#headervalue_CONTACTID").html(a.html());var i=a.find(".ctiapi_unknown_phone_noActivity");i.addClass("mR10"),i.removeClass("fL"),$("#value_CONTACTID").html(a.html()),$("#unknownEntityContainer").remove()}}populateTimeVal(),callTimer.reset();var n=$("#pcVersionInfo").length>0?$("#pcVersionInfo").closest("form")[0].name:void 0,o="h12";"HH:mm"===Crm.userDetails.TIME_FORMAT&&(o="h24"),$(".newtimefrmt").addClass(o);var s,l,c=-1;ajaxback=!0,itsonview=!1,itsonedit=!1,dtPtn=getElm(n,"dtPtn")?getElm(n,"dtPtn").value:null!=typeof Crm.userDetails.DATE_PATTERN?Crm.userDetails.DATE_PATTERN:"","HH:mm"!==Crm.userDetails.TIME_FORMAT&&$(".ampmSpan").show(),rowCnt=1;var d=document.getElementById("aclayer");d&&($("#aclayer").empty(),d.style.display="none");var u="";if(r?u=r:getElm(n,"property(module)")?u=getElm(n,"property(module)").value:getElm(n,"module")?u=getElm(n,"module").value:null!=getObj("module")&&(u=getObj("module").value),(crmTab.isZBCustomModule(u)||crmTab.isZSCustomModule(u))&&(ZInvoice.commentsArray=[],$("#newleft_History").addClass("disabled").removeAttr("onclick")),getObj("_DIALOG_LAYER")&&$("#_DIALOG_LAYER").empty(),getElm(n,"focusid")){var m=getElm(n,"focusid").value,p=getElm(n,m);if(p){p.setAttribute("autocomplete","off");try{p.focus()}catch(e){}}}if("Tasks"==u&&getObj("property(leContModSel)")&&"Contacts"==getObj("property(leContModSel)").value&&getObj("modid")&&""==getObj("modid").value&&0!=$("#modsel option[value='Accounts']").length&&$("#modsel").val("Accounts"),"Calls"==u&&$("input[type='radio'][name='property(leContModSel)']").length>0&&"Contacts"==$("input[type='radio'][name='property(leContModSel)']:checked").val()&&getObj("modid")&&""==getObj("modid").value&&0!=$("#modsel option[value='Accounts']").length&&$("#modsel").val("Accounts"),getObj("dupCheck")&&"clone"==getElm(n,"operation").value&&getElm(n,"property(Email)").focus(),getElm(n,"fieldvalues")){if(getElm(n,"operation")){var g=getElm(n,"operation").value;"edit"!=g&&("Cases"!=u&&"Solutions"!=u||("Cases"==u?(getElm(n,"secHeadSolution Information")&&getElm(n,"secHeadSolution Information").parentNode.removeChild(getElm(n,"secHeadSolution Information")),getElm(n,"secContentSolution Information")&&getElm(n,"secContentSolution Information").parentNode.removeChild(getElm(n,"secContentSolution Information"))):getElm(n,"row2_Description Information")&&getElm(n,"row2_Description Information").parentNode.removeChild(getElm(n,"row2_Description Information")),getElm(n,"secHeadComments Information")&&getElm(n,"secHeadComments Information").parentNode.removeChild(getElm(n,"secHeadComments Information")),getElm(n,"secContentComments Information")&&getElm(n,"secContentComments Information").parentNode.removeChild(getElm(n,"secContentComments Information"))))}var h=JSON.parse(document.getElementsByName("fieldvalues")[0].value);if("Tasks"==u||"Events"==u){var f=h.alertRadio;void 0===f&&(f="")}var v=getElm(n,"rowCount").value;if(priceRowCount=1,v>1){rowCnt=1;for(var C=getProdListBody(),y=0;y<v-1;y++)"PriceBooks"==u?addRange():addRow("newItem",C)}for(var E in h)if(h.hasOwnProperty(E)){var I=E,w=h[E],T=1;if(($e=getElm(n,"uiType_property("+I+")"))&&(T=$e.value),"Currency"==I&&getElm(n,"operation")&&""!=w&&getObj("currencyDetails")){var b=getElm(n,"property(Currency)");b&&selectOrAddSelectOption(b,"property(Currency)",w),fillCurrencySymbols(w,"","createoredit")}if("module"==I)if("Leads"==w||"Contacts"==w)if("Calls"==u){var S=document[n].elements["property(leContModSel)"];"Leads"==w?S[1].checked="checked":S[0].checked="checked"}else getElm(n,"property(leContModSel)")&&(document.getElementById("cvEditSave")&&"none"!==document.getElementById("cvEditSave").style.display||(getElm(n,"property(leContModSel)").value=w));else"Calls"===u&&getElm(n,"property(Call Duration)")&&(document.getElementById("property(Call Duration)").value="00:00"),getElm(n,"property(modsel)")&&"Home"!=w&&(getElm(n,"property(modsel)").value=w);if(("module"==I&&"Leads"==w||"leContModSel"==I&&"Leads"==w)&&(getElm(n,"property(modsel)")&&(getElm(n,"property(modsel)").disabled=!0),getElm(n,"property(modname)")&&(getElm(n,"property(modname)").disabled=!0),getElm(n,"modNameImg")&&(getElm(n,"modNameImg").style.visibility="hidden"),"Calls"==u)){var _=document.getElementById("contactNameLabel");document.getElementById("leadNameLabel").style.display="block",_.style.display="none";var M=document.getElementById("leContTopArrow"),D=getElm(n,"leContModSel");document.getElementById("iskanbanview")&&"true"===document.getElementById("iskanbanview").value||(M.style.left=D[1].offsetLeft+"px")}if("secmod"==I&&null!=w&&(getElm(n,"modselId")&&$(getElm(n,"modselId")).empty(),getElm(n,"modnameId")&&$(getElm(n,"modnameId")).empty(),getElm(n,"leContModSelId")&&$(getElm(n,"leContModSelId")).empty(),getElm(n,"leContModNameId")&&$(getElm(n,"leContModNameId")).empty()),"period"==I&&("Events"==u||"Tasks"==u)){getElm(n,w+"1").style.display="block";var A=h["Recurring Activity"];if(A=A.split("*#"),period=A[0],"daily"==period)selradio=A[1],document[n].daily11[selradio-1].checked=!0,getElm(n,"dailyhidden").value=selradio,2==selradio?getElm(n,"daily111").value=A[4]:getElm(n,"daily111").value="";else if("weekly"==period){getElm(n,"weeklyhidden").value=A[4];var k=A[3].split("^^");for(wcnt=0;wcnt<k.length;wcnt++)getElm(n,"day"+k[wcnt]).checked=!0}else"monthly"==period?(selradio=A[1],getElm(n,"monthlyhidden").value=selradio,document[n].monthly11[selradio-1].checked=!0,1==selradio?(getElm(n,"monthly1select").value=A[4],getElm(n,"noMonths1").value=A[5]):(getElm(n,"weeksequence").value=A[4],getElm(n,"weekdays").value=A[5],getElm(n,"noMonths2").value=A[6])):"yearly"==period&&(selradio=A[1],getElm(n,"yearlyhidden").value=selradio,document[n].yearly11[selradio-1].checked=!0,1==selradio?(getElm(n,"yearmonths").value=A[4],getElm(n,"yearlydays1select").value=A[5]):(getElm(n,"weeksequence1").value=A[4],getElm(n,"weekdays1").value=A[5],getElm(n,"yearmonths1").value=A[6]))}if("Events"!=u&&"Tasks"!=u||"edit"!=g||(getElm(n,"recurringspan")?(getElm(n,"property(Recurring Activity)").checked=!0,getElm(n,"recurringDiv").style.display="block","Events"==u?(getElm(n,"property(Start DateTime)").disabled=!0,getElm(n,"property(End DateTime)").disabled=!0):getElm(n,"property(Remind At)")&&(getElm(n,"remTime").className="select",getElm(n,"property(Remind At)").className="hide",getElm(n,"dtPtn_property(Remind At)").className="hide",getElm(n,"reminBefore").className=""),getElm(n,"property(Recurring Activity)").disabled=!0):(getElm(n,"property(Recurring Activity)")&&(getElm(n,"property(Recurring Activity)").disabled=!0),getElm(n,"recurringDiv")&&(getElm(n,"recurringDiv").style.display="none"))),"Events"!==u&&"Calls"!==u||"edit"!==g&&"clone"!==g||"Remind At"!==I&&"Reminder"!==I)if("Tasks"!=u||"edit"!=g&&"clone"!=g||"Remind At"!=I){if("Calls"===u&&"edit"===g&&"Call Status"===I&&!isNewCallView){var N=document.getElementById("call_duration_row");if(null!=N&&null!=N&&(N.style.display=""),"Scheduled"===w||"Overdue"===w){w,$("form[name='"+n+"'] input[data-zcqa='btn_Edit_SaveNewTask_Bottom']").hide(),$("form[name='"+n+"'] input[data-zcqa='btn_EditCall_SaveNewTask']").hide(),$("#Inbound").prop("disabled",!0);var L=getElm(n,"property(Call Start Time)"),R=getElm(n,"whichCallDiv");if($("input:radio[name=whichCall][value='ScheduleCall']").prop("checked",!0),null!=L&&null!=L&&null!=R&&null!=R){var O=$("<div>",{id:"markComplete",name:"markComplete"}),P=$("<input>",{id:"complete",name:"complete",onclick:"Calls.handleScheduledCallComplete();",type:"checkbox"}),U=$("<label>",{class:"newLblrd",for:"complete"}),x=$("<label>").html(I18n.getMsg("crm.label.mark.this.call.complete")),F=$("<table>",{width:"100%"}),V=$("<tr>"),H=$("<td>",{width:"20"}),B=$("<td>",{style:"color:#8f8f8f;font-size:1.4rem;"});$("#iskanbanview").length>0&&"true"===$("#iskanbanview").val()||B.removeAttr("style"),H.append(P).append(U),B.append(x),V.append(H).append(B),O=O.append(F.append(V)),$("#whichCallDiv").after(O)}$("#callTimerDiv,#whichCallDiv,#call_duration_row").hide(),$("[id='property(Call Duration)']").val(""),getObj("remTime")&&jQuery("#remTime").closest("tr").show()}else"Cancelled"===w||"Unattended Dialled"===w?(w,getObj("remTime")&&$("#remTime").closest("tr").hide(),$("#Inbound").prop("disabled",!0),$("#callTimerDiv,#whichCallDiv,#call_duration_row").hide(),$("[id='property(Call Duration)']").val("00:00"),$("[id='property(DurationInMinute)']").val("00"),$("[id='property(DurationInSecond)']").val("00"),$("input[id='property(DurationInMinute)'],input[id='property(DurationInSecond)']").attr("readonly",!0),$("input[name='property(Call Start Time)'],input[name='Call Start TimedateTime'],span[id='Call Start Time_ampmSpan']").attr("readonly",!0)):(w,getObj("remTime")&&jQuery("#remTime").closest("tr").hide(),$("#callTimerDiv,#whichCallDiv").hide(),$("input[id='property(DurationInMinute)'],input[id='property(DurationInSecond)']").attr("readonly",!0),$("input[name='property(Call Start Time)'],input[name='Call Start TimedateTime'],span[id='Call Start Time_ampmSpan']").attr("readonly",!0));if("HH:mm"!==Crm.userDetails.TIME_FORMAT){$(".ampmSpan").show();var j=getElm(n,"property(Call Start Timeampm)"),z=getElm(n,"Call Start Time_ampmSpan");null!=j&&null!=j&&null!=z&&null!=z&&($(z).empty(),z.innerHTML=j.value)}}}else""!=trimBoth(w)&&(getElm(n,"remCheckTask").checked=!0,getElm(n,"RemindAtdiv").style.display="block"),"email"==f?(document[n].alertRadio[0].checked=!0,document[n].alertType.value="email"):"popup"==f&&(document[n].alertRadio[1].checked=!0,document[n].alertType.value="popup");else if(getElm(n,"remTime")){("0 days"==trimBoth(w)||"0 weeks"===trimBoth(w))&&(w="0");for(var W=getElm(n,"remTime"),q="NO",Y=0;Y<W.length;Y++)W.options[Y].value===w&&(q="YES");if("NO"===q){var J=document.createElement("option");J.value=w,void 0===J.textContent?J.innerText=w:J.textContent=w,W.appendChild(J)}getElm(n,"remTime").value=w,getElm(n,"remCheckTask").checked=!0,"Calls"===u?getObj("remTime")&&jQuery("#remTime").closest("tr").show():getElm(n,"RemindAtdiv").style.display="block","email"==f?(document[n].alertRadio[0].checked=!0,document[n].alertType.value="email"):"popup"==f&&(document[n].alertRadio[1].checked=!0,document[n].alertType.value="popup")}if("CDate"==I&&getElm(n,"startcDate")&&(getElm(n,"startcDate").value=w),"ownerName"==I||"Handler"==I)getElm(n,"handlerName")&&(getElm(n,"handlerName").value=w);else if("ownerId"==I)getElm(n,"handlerId")&&(getElm(n,"handlerId").value=w);else if("rememberDays"==I)c=w;else if("Comments"==I&&("Cases"==u||"Solutions"==u)&&null!=w&&getElm(n,"uiType_property(Comments)")){var G=getElm(n,"uiType_property(Comments)").parentNode;$(G).empty(),G.innerHTML=w+"<input type='hidden' name='property(No of comments)' value=''>"}-1!=I.indexOf("itemDescription")&&(getElm(n,"div_"+I)?getElm(n,"div_"+I).style.visibility="visible":document.getElementById("div_"+I)&&(document.getElementById("div_"+I).style.visibility="visible"),getElm(n,"indicator_"+I)?getElm(n,"indicator_"+I).className="maindownArrow":document.getElementById("indicator_"+I)&&(document.getElementById("indicator_"+I).className="maindownArrow"));var K=getElm(n,"property("+I+")");if(K)if("checkbox"==K.type)"true"==w?(K.checked=!0,K.value="on","none"==K.style.display&&(getElm(n,"ro_property("+I+")").innerHTML="<span class='yes dIB vam'></span>")):(K.checked=!1,"none"==K.style.display&&(getElm(n,"ro_property("+I+")").innerHTML="<span class='no-new dIB vam'></span>"));else if(K.length>1&&"radio"==K[0].type){for(var Q=K,X=Q.length,Z=0;Z<X;Z++)if(w==Q[Z].value){Q[Z].checked=!0;break}}else if(786===T||14===T||333===T)$("input[name=property("+I+")]").val(w);else if(100==T)if(getElm(n,I)){var ee=!1,te=0,re=new Array,ae=getElm(n,I).value,ie=getElm(n,"comboValue"+ae);if(w.indexOf(";")>-1){var ne=w.split(";");for(y=0;y<ne.length;y++){for(var oe=0;oe<ie.length;oe++)if(ee=!1,ne[y]==ie.options[oe].value){ie.options[oe].selected=!0,ee=!0;break}ee||(re[te]=ne[y],te+=1)}for(var se="comboValue"+ae,le=0;le<re.length;le++){var ce=document.createElement("OPTION");ce.setAttribute("value",re[le]),ce.innerHTML=re[le],ce.selected=!0,document.getElementById(se).appendChild(ce)}}else ie.value=w}else K&&(K.value=w);else if(2==T||26==T){se="property("+I+")";var de=K;de.value=w,selectOrAddSelectOption(de,se,w)}else{var ue="property("+I+")";null==getElm(n,ue).value?document.getElementById(ue).value=w:getElm(n,ue).value=w,36==T&&(w=parseFloat(w)),null==K.value?document.getElementById("property("+I+")").value=w:K.value=w}else getElm(n,I)&&((K=getElm(n,I)).value=w,"SPAN"===K.tagName&&("AM"!=w&&"PM"!=w||(K.setAttribute("ampm",w),w=I18n.getMsg(w)),$(K).empty(),K.innerHTML=w));if("modus1"==I&&(s=w),"modus2"==I&&(l=w),"leContModSel"==I&&"Leads"==w){var me=getElm(null,"leContModSel");"Calls"===$('input[name="property(module)"]').val()&&(me=$("input[id^='leContModSel']")),$("select[name='property(modsel)']").prop("disabled",!0),$("input[name='property(modname)']").prop("disabled",!0),$("#modNameImg").css({visibility:"hidden"}),"select-one"==me.type&&0==$("select[name='property(leContModSel)'] option[value='"+w+"']").length?($("#leContModSel").append($('<option value="'+w+'" id="toberemoved" dispName="'+h.leContModName+'" idVal="'+h.leContModId+'">'+I18n.getMsg(null!=s?s:h.modus1)+"</option>")),$("#leadCntModLukup").css({visibility:"hidden"}),$("select[name='property(leContModSel)']").val(w)):"radio"==me[0].type&&(document.getElementById("iskanbanview")&&"true"===document.getElementById("iskanbanview").value?"none"==$("#label"+me[1].id).css("display")&&($("#label"+me[1].id).show(),$("#leContModSelSpan").show(),$(me[1]).attr("dispName",h.leContModName).attr("idVal",h.leContModId).attr("toberemoved","toberemoved"),$("#leadCntModLukup").css({visibility:"hidden"})):"none"==$(me[1]).css("display")&&($(me[1]).show(),$("#leContModSelSpan").show(),$("#leContTopArrow").css("margin-left",me[1].offsetLeft+"px"),$(me[1]).attr("dispName",h.leContModName).attr("idVal",h.leContModId).attr("toberemoved","toberemoved"),$("#leadCntModLukup").css({visibility:"hidden"})))}"modsel"==I&&0==$("#modsel option[value='"+w+"']").length&&($("#modsel").append($('<option value="'+w+'" id="toberemoved" dispName="'+h.modname+'" idVal="'+h.modid+'">'+I18n.getMsg(null!=l?l:h.modus2)+"</option>")),$("select[name='property(modsel)']").val(w),$("#modNameImg").css({visibility:"hidden"}))}populateProductLineItems(),c>-1&&getElm(n,"rememberBlock")&&(getElm(n,"rememberBlock").className="",getElm(n,"property(rememberDays)").value=c)}if(getObj("mapValues")||"undefined"!=typeof returnJson){var pe=null;getObj("id")&&(pe=getObj("id").value),"Activities"===Crm.activityGrp[u]&&(pe=$("#leftPanel").find("#id").val());if(getObj("relatedPageContent")&&!isRelatedListLoaded){if(getObj("messageValue"))var ge=Crm.getCrmBasePath()+"/NewRelatedList.do?action=getAllData&messageValue="+getObj("messageValue").value+"&module="+u+"&id="+detailView.entityId;else ge=Crm.getCrmBasePath()+"/NewRelatedList.do?action=getAllData&module="+u+"&id="+detailView.entityId;var he,fe;if(detailView.changedBCJson?(he=detailView.changedBCJson.hidden.cvid,fe=detailView.changedBCJson.recordNum):(he=getObj("cvid").value,fe=getObj("recordNum").value),"Tasks"==u){var ve=detailView.changedBCJson.isProjectTask,Ce=detailView.entityId;if(Ce&&1==ve)if($("#rightPanelSelect").is(":visible")){var ye=new Option(I18n.getMsg("crm.project.integration.title"),'{"id":"'+Ce+'","module":"'+I18n.getMsg("Projects")+'"}');$("#rightPanelSelect").append(ye),$("#rightPanelSelect").parent().show()}else{var Ee=$("#cvlist_"+Ce),Ie=Ee.attr("data-params");Ie||(Ie=(Ee=$("#recordid_"+Ce)).attr("data-params")),Ie=JSON.parse(Ie);var we=$("#entity_name").val();we.length||(we=I18n.getMsg("Account"));var Te='<option value=\'{"id":"'+Ie.relid+'", "module":"'+Ie.setype+"\"}'>"+$ESAPI.encoder().encodeForHTML(we)+'</option><option value=\'{"id":"'+Ce+'","module":"'+I18n.getMsg("Projects")+"\"}'>"+I18n.getMsg("crm.project.integration.title")+"</option>";$("#rightPanelSelect").html(Te).parent().show()}}var be=document.getElementById("relNEID"),Se="";if(be&&/^[0-9]+$/.test(be.value)&&(Se="&neid="+be.value),ge+="&cvid="+he+"&recordNum="+fe+"&nav=false"+Se,getObj("parentCurrencyISOCode")&&getObj("parentExchangeRate")&&(ge+="&parentCurrencyISOCode="+getObj("parentCurrencyISOCode").value+"&parentExchangeRate="+getObj("parentExchangeRate").value),getObj("zproject_errorcode")&&""!=getObj("zproject_errorcode").value&&"null"!=getObj("zproject_errorcode").value&&(ge+="&errorcode="+getObj("zproject_errorcode").value),getObj("zproject_not_added_clients")&&""!=getObj("zproject_not_added_clients").value&&"null"!=getObj("zproject_not_added_clients").value&&(ge+="&zproject_not_added_clients="+getObj("zproject_not_added_clients").value),"Potentials"==u){var _e=$("#cntId");_e.length>0&&"null"!==_e.val()&&(ge+="&relCntId="+_e.val())}if(void 0===t||"kanbanview"!==t)if("Events"==u){var Me=$("#eventAttachmentDataDiv").find("tr").first().find("td"),De=[];Me.each((function(e){De.push($(this).outerWidth())})),Me.each((function(e){var t=$("#eventAttTable").find("td").eq(e);t.css("width",De[e]),t.css("max-width",De[e])})),transferRelatedDetails(),bindAttachmentsRelatedList(u,detailView.entityId)}else loadRelatedListNew(ge,onCompleteFnRl,onSuccessFnRl,u,pe,e)}if(isRelatedListLoaded=!1,"undefined"==typeof returnJson){var Ae=typeof mapValuesVar;if(mapValues_new="undefined"==Ae?JSON.parse(getObj("mapValues").value):mapValuesVar,getObj("inventoryConversion")&&(-1!=getObj("mapValues").value.indexOf("isConverted")?getObj("inventoryConversion").value="0":getObj("inventoryConversion").value="1"),priceRowCount=1,getObj("rowCount"))if((v=getObj("rowCount").value)>1)if(rowCnt=1,"PriceBooks"==u)for(y=0;y<v-1;y++)addViewRange();else{var ke=getProdListBody();for(y=0;y<v-1;y++)addViewRow(ke)}var Ne=mapValues_new;for(var E in mapValues_new)if(mapValues_new.hasOwnProperty(E)){I=E;if("Events"==u&&"Description"===I&&"quickView"!==t)continue;var Le=E;I=E,w=mapValues_new[E];"Potentials"!=u||"Sales Cycle Duration"!=I&&"Lead Conversion Time"!=I&&"Overall Sales Duration"!=I||(SalesSummaryInfo[I]=w);T=1;var $e=getObj("uiType_"+I),Re=getObj("value_"+I);if($e)T=parseInt($e.value);else if(Re){var Oe=Re.getAttribute("uitype");Oe&&(T=parseInt(Oe))}if(2===parseInt(T)&&(w=(w=w.replace(/</g,"&lt;")).replace(/>/g,"&gt;")),100===parseInt(T)&&(w=revertSplChrs(w)),"modus1"==I&&null!=w){var Pe=getObj("labelTD_Who Id");Pe&&($(Pe).empty(),Pe.innerHTML=w,!0)}if("modus2"==I)if(null!=w)(nt=getObj("labelTD_What Id"))&&"Events"!=u&&($(nt).empty(),nt.innerHTML=w,!0);I=(I=(I=I.replace("(","____")).replace(")","_____")).replace(".","___");var Ue=getObj("value_"+I),xe=null;if(new RegExp(/^(\d.*)+$/).test(I))xe=document.getElementsByName(I)[0];else"id"!=I.toLowerCase()&&"module"!=I.toLowerCase()&&(xe=getObj(I));if(null==w||!Ue||xe&&"Company"!=I&&"hidden"==xe.type){if(null!=w&&xe)if("hidden"==xe.type)xe.value=w;else try{document.getElementById("cvEditSave")&&"none"!==document.getElementById("cvEditSave").style.display&&("leContModSel"===I||"modsel"===I)||"value_Remind At"===I?"value_Remind At"===I&&(xe.innerHTML=Events.remindersInQuickView(w,Ne)):($(xe).empty(),xe.innerHTML=w)}catch(e){}}else{if(36!=T&&32!=T||0!=w&&0!=w||(w=""),98===T){var Fe=I18n.getMsg("Prepared");null!=w&&(w=parseInt(w),-1!=[1,2,3,4].indexOf(w)?Fe=I18n.getMsg("Confirmed"):-1==w&&(Fe=I18n.getMsg("Cancelled"))),$(Ue).attr("statusvalue",w),w=Fe}else if(t&&"quickView"==t)if(14==T||333==T){getObj(globaltextboxpanid);var Ve=getElemById("labelTD_"+Le),He=getElemById("mouseArea__"+Le);if("Start DateTime"==Le)Ve.style.display="none",He.style.display="none";else if("End DateTime"==Le){var Be=!1,je=Ne["All day"];null!=je&&-1!=je.indexOf(",#;")&&-1==je.indexOf(networkUtils.getImageUrl("yes_cb0870e_.gif",ResourceConstants.CRM))&&(je=je.replace(/,#;/g,'"')),$("#value_All day").empty(),getElemById("value_All day").innerHTML=je,"none"==getObj("yes_All day").style.display&&(Be=!1),"none"==getObj("no_All day").style.display&&(Be=!0),$(Ve).empty(),Ve.innerHTML=I18n.getMsg("Time"),He.innerHTML=Events.getDateTimeValForQuickView(new Date(Ne["Start DateTime"]),new Date(Ne["End DateTime"]),Be)}}else if(41==T){v=parseInt($("#invCntValHid").val());var ze=I18n.getMsg("None"),We=document.createElement("a"),qe="invited cp invNone";v>0&&(ze=I18n.getMsg("crm.create.inv.cnt.label",[v]),We.setAttribute("onclick","Events.viewInviteesPop(-2, undefined, 'quickView')"),qe="invited cp");var Ye=document.createElement("div"),Je=$(We).clone()[0];Je.setAttribute("onclick","Events.showAddParticipants(undefined, undefined, 'quickView')"),Ye.appendChild(We),Ye.appendChild(Je),$(We).attr({href:"javascript:;",class:qe}).html(ze),$(Je).attr({class:"viewAdd mlink"}),$(Je).html(I18n.getMsg("crm.button.add")+"&nbsp;"),w=Ye.innerHTML;var Ge=JSON.parse(trimBoth($("#inviteeStatusJson").val())),Ke=$("#textarea_Participants");if(v>0){var Qe=document.createElement("span"),Xe=document.createElement("span"),Ze=document.createElement("span"),et=document.createElement("span"),tt=document.createElement("span"),rt=document.createElement("span");Qe.setAttribute("onclick","Events.viewInviteesPop(1, undefined, 'quickView')"),Xe.setAttribute("onclick","Events.viewInviteesPop(2, undefined, 'quickView')"),Ze.setAttribute("onclick","Events.viewInviteesPop(-1, undefined, 'quickView')"),$(Qe).addClass("partLab cP").html(I18n.getMsg("crm.invitation.status.going.label")),$(Xe).addClass("partLab cP").html(I18n.getMsg("crm.quickview.mystatus.maybe")),$(Ze).addClass("partLab cP").html(I18n.getMsg("Invited")),$(et).addClass("partVal going").html("("+Ge.accept+")"),$(tt).addClass("partVal maybe").html("("+Ge.maybe+")"),$(rt).addClass("partVal invitedSt").html("("+Ge.invited+")"),Ke.css({display:"block"}),Ke.append(Ze),Ke.append(rt),Ke.append(Qe),Ke.append(et),Ke.append(Xe),Ke.append(tt)}}else if("All day"==Le)getElemById("labelTD_"+Le).style.display="none",getElemById("mouseArea__"+Le).style.display="none";else if("Who Id"==Le){var at=Events.getQuickViewRelatedToContent(Ne),it=getElemById("mouseArea__"+Le),nt=getObj("labelTD_Who Id");$(it).empty(),it.innerHTML=at.val,$(nt).text(at.label);var ot=$(it).find("a");ot.attr({target:"_blank"}),ot.removeAttr("data-cid")}else"1234"==T||"value_Remind At"==I?w=Events.remindersInQuickView(w,Ne):"11"==T&&(w=$ESAPI.encoder().encodeForHTML(w));if($(Ue).empty(),Ue.innerHTML=w,t&&"quickView"==t&&8==T)Ue.innerHTML=$("#ownerName_id").html();else if(33==T)getObj("hiddenValue_"+I)&&getObj("subvalue_"+I)&&(getObj("subvalue_"+I).setAttribute("class","phoneRtl"),getObj("subvalue1_"+I)&&getObj("subvalue1_"+I).setAttribute("class","phoneRtl"),getObj("hiddenValue_"+I).value=getObj("subvalue_"+I).innerHTML);else if(2===T&&mapValues_new.color_code_enabled_fieldLabel===I){var st=mapValues_new.colorcode;if(st&&""!==st)$('<span class="dIB activitesColor" data-zcqa="colorcode_selectColorComponent" style="background:'+st+'"></span>').insertBefore(Ue)}}33==T&&getObj("mouseArea__"+I)&&($("#mouseArea__"+I).empty(),getObj("mouseArea__"+I).innerHTML=w)}}populateProductLineItems(!0);var lt=document.location.href;null!=e&&""!=e&&lt.indexOf("ShowEntityInfo")<0&&(ajaxback=!1)}if("PriceBooks"==u&&("create"==g||"edit"==g||"clone"==g?getObj("property(Pricing Model)")?""==getObj("property(Pricing Model)").value&&(getObj("secDivPricing Details").style.display="none"):getObj("secDivPricing Details").style.display="none":getObj("value_Pricing Model")?""!=getObj("value_Pricing Model").innerHTML&&0!=getObj("rowCount").value||(getObj("secDivPricing Details").style.display="none"):getObj("secDivPricing Details")),getObj("dateFields")&&"null"!=getObj("dateFields").value){var ct=getObj("dateFields").value.split("|");for(oe=0;oe<ct.length;oe++){getObj("dtPtn_"+ct[oe])&&("INPUT"!=getObj("dtPtn_"+ct[oe]).nodeName?document.getElementById("iskanbanview")&&"true"===document.getElementById("iskanbanview").value?getObj(ct[oe]).setAttribute("placeholder",document.getElementsByName("dtPtn")[0].value):getObj(ct[oe]).setAttribute("placeholder",getObj("dtPtn").value):getObj("dtPtn_"+ct[oe]).value=getObj("dtPtn").value);var dt=ct[oe].substring(ct[oe].indexOf("(")+1,ct[oe].indexOf(")")),ut=getObj(dt+"dateTime");if(ut){""===ut.value&&(ut.value="01:00");var mt=h[dt+"ampm"],pt=ut.value+(mt?":"+mt:"");ut.setAttribute("time",pt)}}}if(getObj("picklistFields")){var gt=getObj("picklistFields").value;if("null"!=gt){var ht=gt.split(";");for(Y=0;Y<ht.length-1;Y++){var ft=ht[Y];fieldDependency(ft,u)}}}if("Events"==u&&handlePrivateEvent(),getObj("searchField")&&"All"!=getObj("searchField").value&&""!=getObj("searchField").value){var vt=getObj("searchField").value;getObj(vt).className="sel"}if(getElemById("searchCategoryDiv")&&(getElemById("searchCategoryDiv").style.display="none"),getObj("feedback_top")&&(getObj("feedback_top").style.display="none"),selectCurrentCV(),!document.getElementById("iskanbanview")||document.getElementById("iskanbanview").value,getLength(SalesSummaryInfo)<1){var Ct=$("#showSalesSummaryAlink");Ct&&Ct.hide()}u&&"Campaigns"==u&&"undefined"!=typeof mapValues&&"Google Adwords"==mapValues.Type&&(getObj("googleicon").style.display="block"),"Calls"===u&&"create"===g&&getObj("remTime")&&jQuery("#remTime").closest("tr").hide(),"Calls"!==u||"create"!==g&&"edit"!==g||!getObj("ownerName")||"ScheduleCall"!==jQuery("input[name=whichCall]:checked").val()&&jQuery("#ownerName").closest("tr").hide(),"Calls"===u&&"ScheduleCall"===jQuery("input[name=whichCall]:checked").val()&&$("input[name='property(Call Start Time)']").attr("onclick","crmCalendar.showCalendar(event,'leftPanel',Events.callDuplicationDateHandler, undefined, 786)"),"undefined"!=typeof returnJson&&returnJson&&returnJson[u]&&("undefined"!=typeof WidgetHandler&&setTimeout((function(){var e={};e.moduleID=CrmWidgets.Utils.GetTabIDFromTabName(u),e.urlModule=u,e.paramsID=detailView.entityId,WidgetHandler.loadWidgets(e)}),10),setTimeout((function(){Crm.addRecentItems(returnJson[u].entityid,u)}),200),detailView.refreshInWms||detailView.loadRelatedDetails(u,returnJson[u].entityid));try{"Potentials"==u&&null==Crm.userDetails.CLIENT_ACCOUNT&&Crm.userDetails.LICENSE_TYPE_ACTUAL&&["E","A","U","C","Z","D"].contains(Crm.userDetails.LICENSE_TYPE_ACTUAL)&&networkUtils.loadFeatureScripts(["zohocrm_attributions.js"],(function(){Attribution.displayAttributionDiv(detailView.entityId,u)}))}catch(e){murphy.error(e)}location.host.includes("zoho.in")&&"60010197171"===crmZgid&&(detailview_log.initJS_end=performance.now(),detailview_log.initJS_diff=detailview_log.initJS_end-detailview_log.initJS_start)}function populateProductLineItems(e){var t,r=getElemById("productLineItems");if(detailView.changedBCJson?t=detailView.changedBCJson.productLineItems:r&&(t=JSON.parse(r.value)),t)for(var a in t)if(t.hasOwnProperty(a)){var i=a,n=t[a];if(e){if((l=document.getElementById("value_"+i))||(l=document.getElementById(i)))try{$(l).empty(),l.innerHTML=n}catch(e){}}else{var o,s,l;if(-1!=i.indexOf("itemDescription"))((o=document.getElementById("div_"+i))||(o=getObj("div_"+i)))&&(o.style.visibility="visible"),((s=document.getElementById("indicator_"+i))||(s=getObj("indicator_"+i)))&&(s.className="maindownArrow");if(l=document.getElementById(i))l.value=n;else{var c=document.getElementsByName("property("+i+")")[0];c&&(c.value=n)}}}}function selectOrAddSelectOption(e,t,r){if("text"!=e.type){for(var a="no",i=(e.length,0);i<e.length;i++)if(e.options[i].value.trim()==r.trim()){e.options[i].selected=!0,a="yes";break}if("no"==a){r.trim().indexOf(":")>0&&(r=r.trim().replace("0:",""));var n=document.createElement("OPTION");n.setAttribute("value",r.trim()),$(n).empty(),n.innerHTML=r.trim(),n.selected=!0,getObj(t).appendChild(n)}}}function bindAttachmentsRelatedList(e,t){if(document.querySelector('crm-related-list-view-header[related-module="Attachments"]'))Lyte.triggerEvent("relatedList",{module:"Attachments"}),refreshFollowDiv();else{var r,a=[],i=store.peekRecord(moduleRecordMapping[e].id,t);i||a.push(store.findRecord(moduleRecordMapping[e].id,t,{approved:"both"}));var n,o=store.peekRecord("module",moduleRecordMapping[e].id).related_lists,s=function(e){for(var t=e.length,r=0;r<t;r++)if("ATTACHMENTSPERSONALITY"===e[r].personality_name)return e[r]};o?n=s(o):a.push(store.findRecord("module",moduleRecordMapping[e].id).related_lists);var l=function(){$("#eventsRightPanelAttachDiv").html(""),Lyte.Component.render("crm-related-list-view-header",{entityId:t,module:e,relatedList:n,record:i,layoutId:r},"#eventsRightPanelAttachDiv")};a.length>0?Promise.all(a).then((function(){i||(i=store.peekRecord(moduleRecordMapping[e].id,t)),r=i.Layout?i.Layout.id:store.peekRecord("module",moduleRecordMapping[e].id).layouts[0].id,o||(o=store.peekRecord("module",moduleRecordMapping[e].id).related_lists,n=s(o)),l()})).catch((function(e){murphy.error(e)})):(r=i.Layout?i.Layout.id:store.peekRecord("module",moduleRecordMapping[e].id).layouts[0].id,l())}}function initPage(e,t,r){formNameVsTimerObjMap.reset("createEntityFormctiapicall"),showHideCallDuration("none",r);var a=$("#_leContModSel").val(),i=$("#_modSel").val();""!=a&&$("select[name='property(leContModSel)'] option[value='"+a+"']").prop("selected",!0),"Leads"==a&&(0==$("select[name='property(leContModSel)'] option[value='"+a+"']").length&&$("#leContModSel").append($('<option value="'+a+'">'+I18n.getMsg(a)+"</option>")),$("select[name='property(leContModSel)'] option[value='"+a+"']").prop("selected",!0),$("select[name='property(leContModSel)']").val(a),$("select[name='property(modsel)']").prop("disabled",!0),$("input[name='property(modname)']").prop("disabled",!0),$("#modNameImg").css({visibility:"hidden"})),""!=i&&(0==$("select[name='property(modsel)'] option[value='"+i+"']").length&&$("#modsel").append($('<option value="'+i+'">'+I18n.getMsg(i)+"</option>")),$("select[name='property(modsel)'] option[value='"+i+"']").prop("selected",!0),$("select[name='property(modsel)']").val(i));for(var n=e.split(";"),o=0;o<n.length;o++){var s=getObj("property("+n[o]+")");s&&setDependent(s,!0,!0,t)}$("#moreFieldsContainer input[name],#moreFieldsContainer select[name],#moreFieldsContainer textarea[name]").each((function(){var e=$(this).attr("type"),r=$(this).attr("name"),a=$(this).val();Crm.moreFldNameVsValue[t][r]="checkbox"==e?$(this).prop("checked"):a}))}var Browser={zuid:void 0,getBrowserDetails:function(){var e,t=navigator.userAgent,r=t.match(/(opera|crios|chrome|safari|firefox|msie|FxiOS|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(r[1])?{name:"msie",version:(e=/\brv[ :]+(\d+)/g.exec(t)||[])[1]||""}:(/crios/i.test(r[1])&&(r[1]="Chrome"),/fxios/i.test(r[1])&&(r[1]="Firefox"),"Chrome"===r[1]&&null!=(e=t.match(/\bOPR\/(\d+)/))?{name:"opera",version:e[1]}:(r=r[2]?[r[1],r[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&r.splice(1,1,e[1]),{name:r[0],version:r[1]}))},supportedVersion:{chrome:49,firefox:44,msie:11,safari:9,opera:45},checkVersion:function(){var e=this.getBrowserDetails();e.name.toLowerCase(),e.version}};$(document).ready((function(){Browser.checkVersion()}));var crmNavig={fetchComplete:void 0,EOAindex:void 0,entityDetails:{},customViewKey:void 0,recentListViewUrl:void 0,listOfBuffers:[],NAVIGCACHEOBJ:{},parseCurrentListView:function(e){setTimeout((function(){if(!Crm.isHeadless){var t=crmListView.getObject(),r=t&&!0===(t.isStageView||t.isPredictView),a=[],i=void 0,n=void 0;if(crmNavig.customViewKey&&crmNavig[crmNavig.customViewKey]&&!e&&(crmNavig[crmNavig.customViewKey].recordId=[]),crmNavig.recentListViewUrl=crmHistory.getState().url,e||r){n=(o=$("li").filter((function(){return this.id.match(/^detailView_[0-9]+$/)}))).length;for(s=0;s<n;s++)a[s]=$(o[s])}else{var o;n=(o=$("tr").filter((function(){return this.id.match(/^[0-9]+$/)}))).length;for(var s=0;s<n;s++)a[s]=$(o[s])}for(var l=0;n&&l<n;l++){var c,d=a[l];c=e||r?d.attr("id").split("detailView_")[1]:d.attr("id"),i=JSON.parse(d.find("a[data-cid=detailView][id$="+c+"]").attr("data-params")||"null"),null!=t&&t.isCustomizedView&&(i=JSON.parse(d.attr("data-params")||"null")),null==i&&(d.find("[lt-prop-id=listView_"+c+"]").attr("lt-prop-td")?i=JSON.parse(d.find("[lt-prop-id=listView_"+c+"]").attr("lt-prop-td")):d.find("[lt-prop-id=homePage_"+c+"]").attr("lt-prop-td")&&(i=JSON.parse(d.find("[lt-prop-id=homePage_"+c+"]").attr("lt-prop-td"))),null==i&&(i=JSON.parse(d.find("[data-cid=detailView][id$="+d.attr("id").split("detailView_")[1]+"]").attr("data-params")||"null")));try{null==i&&d.attr("data-params")&&(i=JSON.parse(d.attr("data-params"))),i&&"null"!==i&&i.recordNum&&(crmNavig.customViewKey=i.cvid&&null!==i.cvid&&"null"!==i.cvid?i.cvid:i.module,crmNavig.customViewKey=r?crmNavig.customViewKey+"#"+$("#listView_"+i.id).closest("div.sv_each_stage").attr("id"):crmNavig.customViewKey,crmNavig[crmNavig.customViewKey]||(crmNavig[crmNavig.customViewKey]={recordId:[],currentOption:$("#currentOption")[0]?parseInt($("#currentOption")[0].value):10},crmNavig.listOfBuffers.push(crmNavig.customViewKey)),crmNavig[crmNavig.customViewKey].recordId[i.recordNum]={id:i.id,module:i.module})}catch(e){}}try{!$("#lastSortOrderId").length>0&&(crmNavig.entityDetails={previousCVName:$("input[name= previousCVName]")[0].value,searchCr:$("#searchCr")[0].value,OnSelect:$("input[name= OnSelect]")[0].value,PreviousUnParsedViewName:$("input[name= PreviousUnParsedViewName]")[0].value,sortTaskColumnString:$("input[name=sortTaskColumnString]")[0].value,sortTaskOrderString:$("input[name= sortTaskOrderString]")[0].value,sortEventColumnString:$("input[name=sortEventColumnString]")[0].value,sortEventOrderString:$("input[name= sortEventOrderString]")[0].value})}catch(e){}}}),200)},parseGlobalSearchList:function(e){var t,r=[],a=void 0;crmNavig.recentListViewUrl=crmHistory.getState().url;var i=$("[id=ajax_"+e+"]").find("tr[id^="+e+"_]").filter((function(){return this.id.match(/[0-9]+$/)}));t=i.length;for(var n=0;n<t;n++)r[n]=$(i[n]);for(var o=0;t&&o<t;o++){var s=r[o];a=JSON.parse(s.find("a[data-cid=detailView][id$="+s.attr("id").split("_")[1]+"]").attr("data-params")||"null");try{a&&"null"!==a&&a.recordNum&&(crmNavig[e]||(crmNavig[e]={recordId:[],currentOption:$("#currentOption")[0]?parseInt($("#currentOption")[0].value):10},crmNavig.listOfBuffers.push(e)),crmNavig[e].recordId.push({id:a.id,module:a.module}))}catch(e){}}try{!$("#lastSortOrderId").length>0&&(crmNavig.entityDetails={previousCVName:$("input[name= previousCVName]")[0].value,searchCr:$("#searchCr")[0].value,OnSelect:$("input[name= OnSelect]")[0].value,PreviousUnParsedViewName:$("input[name= PreviousUnParsedViewName]")[0].value,sortTaskColumnString:$("input[name=sortTaskColumnString]")[0].value,sortTaskOrderString:$("input[name= sortTaskOrderString]")[0].value,sortEventColumnString:$("input[name=sortEventColumnString]")[0].value,sortEventOrderString:$("input[name= sortEventOrderString]")[0].value})}catch(e){}},updateDataParamValue:function(e,t,r){var a=JSON.parse($("[id="+e+"]").attr("data-params")||"null");a[t]=r,$("[id="+e+"]").attr("data-params",JSON.stringify(a))},getRecordNumToId:function(e,t){if(crmNavig[t])for(var r=1;r<crmNavig[t].recordId.length;r++)if(crmNavig[t].recordId[r]&&crmNavig[t].recordId[r].id===e)return r;return-1},navigateRecord:function(e,t,r){var a=t?$(t).attr("data-params"):r,i=t?$(t).attr("data-cid"):r.clickId,n=a?"object"==typeof a?a:JSON.parse(a):{},o=$("input[name=fromIndex]")?parseInt($("input[name=fromIndex]")[0].value):n.fromIndex,s=$("input[name=toIndex]")?parseInt($("input[name=toIndex]")[0].value):n.toIndex,l=parseInt(n.recordNum),c=(n.cvid?n.cvid:$("input[name=cvid]")[0].value,parseInt(s)-parseInt(o)+1),d=$("#id").val();return"NavNext"===i?(parseInt(l)>=parseInt(s)&&(o=parseInt(s)+1,s=parseInt(s)+c),!n.fromDel&&"true"!==n.fromDel&&(l=parseInt(l)+1)):"NavPrevious"===i&&(parseInt(l)<=o&&(o=parseInt(o)-c,s=parseInt(s)-c),l=parseInt(l)-1),crmNavig.processObjectNew(o,s,d,n,i,l),!1},triggerFetch:function(e,t,r,a,i,n){var o=parseInt(t)-parseInt(e)+1,s=a.module;if("Activities"===s&&$("#cvRangeValue").length&&(o=parseInt($("#cvRangeValue").val())),"NavNext"===i?r=parseInt(r)+1:"NavPrevious"===i&&(r=parseInt(r)-1),r>=1&&crmNavig[crmNavig.customViewKey]&&("true"===a.fromDel&&!crmNavig[crmNavig.customViewKey].recordId[t]||!crmNavig[crmNavig.customViewKey].recordId[r]&&"EOA"!==crmNavig[crmNavig.customViewKey].recordId[r]||r>=t||r<=e)&&"Activities"===s){if(r<=e&&r>1?(e=parseInt(e)-o,t=parseInt(t)-o):r>1&&(e=r,t+=o),!crmNavig[crmNavig.customViewKey].recordId[t]){crmNavig.recentListViewUrl=crmNavig.recentListViewUrl?crmNavig.recentListViewUrl:crmHistory.getState().url;var l=crmNavig.recentListViewUrl;(c=crmNavig.fetchNextSetUrl(e,t,l,a.module,a))&&crmNavig.fetchNextSet(c,e,t,s,n)}}else if(crmNavig[crmNavig.customViewKey]&&"EOA"!==crmNavig[crmNavig.customViewKey].recordId[r]&&r&&(null===crmNavig[crmNavig.customViewKey].recordId[r]||void 0===crmNavig[crmNavig.customViewKey].recordId[r]||"true"===a.trigg)&&r>1){r<=e?(e=parseInt(e)-o,t=parseInt(t)-o):r!==t&&(e=r,t+=o),crmNavig.recentListViewUrl=crmNavig.recentListViewUrl?crmNavig.recentListViewUrl:crmHistory.getState().url;var c;l=crmNavig.recentListViewUrl;(c=crmNavig.fetchNextSetUrl(e,t,l,a.module,a))&&crmNavig.fetchNextSet(c,e,t,s,n)}else n&&n.call()},processObjectNew:function(e,t,r,a,i,n,o){var s;s="Activities"===Crm.activityGrp[a.module]&&void 0!==Lyte.Router.getRouteInstance().parent&&void 0!==Lyte.Router.getRouteInstance().parent.parent&&"Activities"===Lyte.Router.getRouteInstance().parent.parent.getDynamicParam()?"Activities":a.module,(r=crmNavig[crmNavig.customViewKey].recordId[n]?crmNavig[crmNavig.customViewKey].recordId[n].id:void 0)&&(a.module=crmNavig[crmNavig.customViewKey].recordId[n].module);var l="";"true"!==a.fromDel||"NavPrevious"===i?l="&FROM_INDEX="+encodeURIComponent(e)+"&TO_INDEX="+encodeURIComponent(t):"NavNext"===i&&(l="&FROM_INDEX="+$("input[name = fromIndex]")[0].value+"&TO_INDEX="+$("input[name = toIndex]")[0].value);var c=Crm.getCrmBasePath()+"/ShowEntityInfo.do?nav=true&id="+encodeURIComponent(r)+"&module="+encodeURIComponent(a.module)+"&recordNum="+encodeURIComponent(n)+"&navig=true&lookback=true"+l;if(a.cvid&&(c=c+"&cvid="+a.cvid),Crm.userDetails.templatingEnabled&&(c+="&CTEnabledInClient=true"),getObj("pfrom")&&(a.pfrom=getObj("pfrom").value),a.pfrom&&(c+="&pfrom="+a.pfrom),!0===crmConstants.clientTemplatingSupported[a.module]&&(c+="&format=json"),a.stageId&&(c+="&stageId="+a.stageId),n<1)if("EOA"!==crmNavig[crmNavig.customViewKey].recordId[1]){var d='<div onclick="sE()" class="w500 p20"><div class="floatL pL20 w430"><div class="f20"><h2 style="color:#E20000";>'+I18n.getMsg("crm.alert.heading.cannot.access.record",I18n.getMsg(moduleRecordMapping[s].singular_label))+'</h2></div><div class="mT10">'+I18n.getMsg("crm.alert.content.cannot.access.record",I18n.getMsg(moduleRecordMapping[s].singular_label))+'</div></div><br class="clearB"><div class="alignright mT20"><input type="button" class="newgraybtn" value="'+I18n.getMsg("crm.label.backToModule",I18n.getMsg(s))+'" onclick="hide(\'popupnew\');removeFreezeLayer();crmHistory.backOneLevel();document.getElementById(\'popupnew\').style.zIndex=30;"><input type="button" class="newgraybtn" value="'+I18n.getMsg("Close")+"\" onclick=\"hide('popupnew');removeFreezeLayer();document.getElementById('popupnew').style.zIndex=30\"></div></div>";renderingUtils.popUpWithFreeze(d),crmNavig.setNavigButtonState(1)}else crmHistory.backOneLevel();else if(r){var u="NavNext"===i,m=$("input[name=fromIndex]")?parseInt($("input[name=fromIndex]")[0].value):a.fromIndex,p=$("input[name=toIndex]")?parseInt($("input[name=toIndex]")[0].value):a.toIndex,g=document.getElementById("cvid");if("Activities"===s||"Tasks"===s||"Events"===s||"Calls"===s){var h=$("#recordNum")[0].value;if((parseInt(h)<e||parseInt(h)>t)&&"true"!==a.fromDel||"true"===a.fromDel&&(parseInt(h)<=m&&!u||parseInt(h)>p&&u))if(crmNavig[crmNavig.customViewKey].rpURl){var f=networkUtils.parseUrl(crmNavig[crmNavig.customViewKey].rpURl),v=(m=parseInt($("input[name=fromIndex]")[0].value),p=parseInt($("input[name=toIndex]")[0].value),parseInt($("#cvRangeValue").val())),C=objectUtils.cloneObject(a);("true"!==a.fromDel||parseInt(n)>p||parseInt(n)<m)&&("NavNext"===i?(m=parseInt(p)+1,p=parseInt(p)+v):(m=parseInt(m)-v,p=parseInt(p)-v)),C.FROM_INDEX=encodeURIComponent(m),C.TO_INDEX=encodeURIComponent(p),C.forRp="true",C.cvid=encodeURIComponent(f.params.cvid),C.pfrom=C.cvid&&null!==C.cvid&&"null"!==C.cvid&&"undefined"!==C.cvid?"cv":"gsearch";for(var y=C.FROM_INDEX,E="cv"===C.pfrom?C.cvid:$("#module")[0].value,I=[];crmNavig[E].recordId[y]&&y<=parseInt(C.TO_INDEX);)I.push(crmNavig[E].recordId[y].id),y++;var w={seIds:I.toString()};C.loadNextEntity="true",delete C.backOneLevel;c=networkUtils.constructUrl(Crm.getCrmBasePath()+"/"+f.action+".do",C);(new crmRequestPool).initiate({type:"GET",url:c,data:w,dataType:"text",success:function(e){placeRes(e,void 0,c)}})}else{(new crmRequestPool).initiate({type:"GET",url:Crm.getCrmBasePath()+"/RelActCV.do?pfrom=cv&cvid="+$("#cvid")[0].value+"&FROM_INDEX="+e+"&TO_INDEX="+t,dataType:"text",success:function(e){placeRes(e,void 0,c)}})}else{n=parseInt($("#recordNum")[0].value);"true"!=a.fromDel&&(u?n++:n--),"Activities"===s?Lyte.Router.transitionTo({route:"crm.tab.module.entity.detail",dynamicParams:["Activities",r],queryParams:{sub_module:a.module}}).data={fromDetailView:!0,navig:"true",recordNum:n,FROM_INDEX:e,TO_INDEX:t,cvid:g.value,stageId:a.stageId,fromActivityListView:"true",fromDel:a.fromDel}:Lyte.Router.transitionTo({route:"crm.tab.module.entity.detail",dynamicParams:[a.module,r]}).data={fromDetailView:!0,navig:"true",recordNum:n,FROM_INDEX:e,TO_INDEX:t,cvid:g.value,stageId:a.stageId,fromActSubModuleListView:"true",fromDel:a.fromDel}}o&&o.call()}else{if("true"!=a.fromDel){n=parseInt($("#recordNum")[0].value);u?n++:n--}"Messages"===s?Lyte.Router.transitionTo({route:"crm.tab.messages.view",dynamicParams:[r]}).data={recordNum:n}:(Lyte.Router.transitionTo({route:"crm.tab.module.entity.detail",dynamicParams:[a.module,r]}).data={navig:"true",recordNum:n,FROM_INDEX:e,TO_INDEX:t,cvid:g.value,stageId:a.stageId,fromDel:a.fromDel},isRelatedListLoaded=!0)}}else if("true"===a.fromDel){var T={};(T=crmHistory.getCurrentStateData()).fromDel="true",T.clickId="NavPrevious",crmNavig[crmNavig.customViewKey].recordId[n]="EOA",n&&(T.recordNum=n),crmNavig.navigateRecord(void 0,void 0,T)}else{d='<div onclick="sE()" class="w500 p20"><div class="floatL pL20 w430"><div class="f20"><h2 style="color:#E20000";>'+I18n.getMsg("crm.alert.heading.cannot.access.record",I18n.getMsg(moduleRecordMapping[s].singular_label))+'</h2></div><div class="mT10">'+I18n.getMsg("crm.alert.content.cannot.access.record",I18n.getMsg(moduleRecordMapping[s].singular_label))+'</div></div><br class="clearB"><div class="alignright mT20"><input type="button" class="newgraybtn" value="'+I18n.getMsg("crm.label.backToModule",I18n.getMsg(s))+'" onclick="hide(\'popupnew\');removeFreezeLayer();crmHistory.backOneLevel();document.getElementById(\'popupnew\').style.zIndex=30;"><input type="button" class="newgraybtn" value="'+I18n.getMsg("Close")+"\" onclick=\"hide('popupnew');removeFreezeLayer();document.getElementById('popupnew').style.zIndex=30\"></div></div>";renderingUtils.popUpWithFreeze(d),crmNavig.setNavigButtonState(n-1)}},setNavigButtonState:function(e){var t=parseInt(e),r=crmNavig.customViewKey,a=$("#detailPrevious"),i=$("#detailNext"),n=$("#module").length>0?$("#module")[0].value:"";if(r&&window[n]&&"view"==window[n].currentStatus&&crmNavig[r]){var o=crmNavig[r].recordId[t-1],s=crmNavig[r].recordId[t+1];!o||"EOA"===o||"object"==typeof o&&0==Object.keys(o).length?a.attr("class","prev-dv disabled").removeAttr("data-cid"):(i.css("display","inline-block"),a.attr({class:"prev-dv","data-cid":"NavPrevious"}).css("display","inline-block")),!s||"EOA"===s||"object"==typeof s&&0==Object.keys(s).length?i.attr("class","next-dv disabled").removeAttr("data-cid"):(i.attr({class:"next-dv","data-cid":"NavNext"}).css("display","inline-block"),a.css("display","inline-block")),s&&"EOA"!==s||o&&"EOA"!==o||(i.hide(),a.hide(),$("#navigtd").css("width","30px !important"))}else i.hide(),a.hide(),$("#navigtd").css("width","30px !important")},fetchNextSetUrl:function(e,t,r,a,i,n){var o=a,s=networkUtils.parseUrl(decodeURIComponent(r)),l=s.action,c=r.indexOf(a)>-1&&s.params?s.params:{},d="NavigateByRecords";for(var u in c)c[u]=decodeURIComponent(c[u]);if(c.fromDV="true",-1!==r.indexOf("GlobalSearch")){var m=-1!==crmNavig.recentListViewUrl.indexOf("userOption")?"true":"false",p={fromIndex:e,toIndex:t,isNavigate:"true",fileName:Crm.getCrmBasePath()+"/GSearch.do",totalRecords:10,userOption:m,sModules:a};$L.extend(p,c),c["mod_"+a]="true","true"===n&&(c.forRp="true",delete c.fromDV)}else if(-1!==r.indexOf("Home")){p={};p={fromIndex:e,toIndex:t,fileName:Crm.getCrmBasePath()+"/HomePageLayout.do",mod:!0,dashletId:i.cvid?i.cvid:crmHistory.getState().data.cvid,module:o,layoutId:i.layoutId?i.layoutId:crmHistory.getState().data.layoutId},$L.extend(c,p)}else if(-1!==r.indexOf("ViewPipeline")){p={OnSelect:"true",isParent:"true",actiontype:"viewPipeline",frmidx:e,toIdx:t,module:o,rangeValue:parseInt(t)-parseInt(e)+1,currentOption:parseInt(t)-parseInt(e)+1,fileName:Crm.getCrmBasePath()+"/ViewPipeline.do?mod=true"};$L.extend(p,c),c.ownerId=i.ownerId&&"null"!==i.ownerId&&null!==i.ownerId?i.ownerId:crmHistory.getState().data.ownerId,c.roleId=i.roleId?i.roleId:crmHistory.getState().data.roleId}else if("MassUpdate"===l||"MassDeleted"===l||"MassTransfer"===l||"MassConvert"===l){if(c.fromIndex=e,c.toIndex=t,"MassUpdate"===l?c.actiontype="mass_update":"MassDeleted"===l?c.actiontype="mass_delete":"MassConvert"===l?c.actiontype="mass_convert":"MassTransfer"===l&&(c.actiontype="mass_transfer"),c.searchDetails){var g=JSON.parse(c.searchDetails);c.rowCount=g.length;for(var h=0;h<g.length;h++){var f=g[h];c["searchfield"+(h+1)]=f.text,c["searchfieldtype"+(h+1)]=f.type,c["match"+(h+1)]=f.match,"T"===f.type?(c["searchtext"+(h+1)]=f.value,c["textcondition"+(h+1)]=f.ptn):"U"===f.type?(c["searchuser"+(h+1)]=f.value,c["temp_searchuser"+(h+1)]=f.temp_value,c["usercondition"+(h+1)]=f.ptn):"CML"===f.type?(c["searchcampcv"+(h+1)]=f.value,c["temp_searchcampcv"+(h+1)]=f.temp_value,c["campcvcondition"+(h+1)]=f.ptn):"C"===f.type?(c["searchusercv"+(h+1)]=f.value,c["usercvcondition"+(h+1)]=f.ptn):"B"===f.type?(c["searchboolean"+(h+1)]=f.value,c["booleancondition"+(h+1)]=f.ptn):"N"===f.type?(c["searchnum"+(h+1)]=f.value,c["numcondition"+(h+1)]=f.ptn):"D"===f.type?(c["searchdate"+(h+1)]=f.value,c["datecondition"+(h+1)]=f.ptn):"DT"===f.type&&(c["searchdatedate"+(h+1)]=f.value,c["datetimecondition"+(h+1)]=f.ptn,c["searchsthour"+(h+1)]=f.sthour,c["searchstminute"+(h+1)]=f.stminute,c["searchstampm"+(h+1)]=f.stampm,c["searchetminute"+(h+1)]=f.endminute,c["searchenddate"+(h+1)]=f.enddate,c["searchethour"+(h+1)]=f.endhour,c["searchetampm"+(h+1)]=f.endampm)}}else c.rowCount=1;c&&c.fromIndex&&c.toIndex&&(d="NavigateByRecords",c.fileName=Crm.getCrmBasePath()+"/MassRecords.do?mod=true"),delete c.searchDetails,delete c.calleeObj,delete c.backOneLevel,delete c.clickId;var v=new crmRequestPool,C=JSON.parse(JSON.stringify(c));(Crm.isPageLoad||Crm.isFromBack)&&c.operation_mode&&(delete C.operation_mode,delete C.fromIndex,delete C.toIndex,delete C.currentOption,v.initiate({action:Crm.getCrmBasePath()+"/MassRecords.do",data:C,success:function(e){$("#show").html(e),C.rowCount>=1||C.searchfieldtype1?(Search.setValues("create",C),Search.rowcnt=C.rowCount):(Search.setDefaultValues("create",void 0,void 0,void 0,void 0,!0),Search.rowcnt=1)}}),v.addUp({action:Crm.getCrmBasePath()+"/"+d+".do",data:c,success:function(e){$("#massResult").html(e)}}))}else{if(c.changeOption=!0,c.search_letter&&(c.searchletter=c.search_letter,delete c.search_letter),(c.searchDetails||c.searchletter&&""!==c.searchletter||1!==c.fromIndex)&&delete c.changeOption,c&&e&&t&&(c.fromIndex=e,c.toIndex=t,c.fileName=Crm.approvalActions[l]?Crm.approvalActions[l]:Crm.getCrmBasePath()+"/ShowSelectedCustomView.do",c.mod=!0),c.module=o,"Activities"===Crm.activityGrp[o]&&void 0!==Lyte.Router.getRouteInstance().parent&&void 0!==Lyte.Router.getRouteInstance().parent.parent&&"Activities"===Lyte.Router.getRouteInstance().parent.parent.getDynamicParam()&&(c.module="Activities"),"Chat"===c.module||"Documents"===c.module)return void Utils.windowLocationHref(Crm.getCrmBasePath()+"/ShowDetails.do?module="+c.module);if(delete c.sortOrderString,delete c.sortColumnString,c.searchDetails){g=JSON.parse(c.searchDetails);for(var y=0;y<g.length;y++){f=g[y];c["advSearch_text_"+(y+1)]=f.text?f.text:"",c["advSearch_select_"+(y+1)]=f.ptn,c["advSearch_name_"+(y+1)]=f.name,f.hr&&(c["advSearch_DT_hour"+(y+1)]=f.hr),f.min&&(c["advSearch_DT_minute"+(y+1)]=f.min),f.ampm&&(c["advSearch_DT_ampm"+(y+1)]=f.ampm)}delete c.searchDetails,c.advSearchCnt=y,c.searchField="All",c.advSearchEnable=!0}if("true"!==$("#iskanbanview").val()&&(crmListView.getFilterParams(c),(c.filters||c.cross_filters)&&(c.isNewFilter=!0)),"true"===n&&(c.forRp="true",delete c.fromDV),i.stageId&&(c.stageId=i.stageId,!c.fileName))return}var E=Crm.getCrmBasePath()+"/"+d+".do";h=0;for(var u in delete c.per_page,delete c.page,delete c.sort_order,delete c.sort_by,c)/\b(calleeObj|clickId)\b/.test(u)||void 0!==c[u]&&(E+=0===h?"?":"&",E+=u+"="+encodeURIComponent(c[u]),h++);return E},fetchNextSet:function(e,t,r,a,i){e+="&isload=true",crmNavig.fetchComplete=void 0,$.ajax({type:"POST",url:e,success:function(e){for(var a=t,n=r-t+1,o=t;o<r;o++)crmNavig[crmNavig.customViewKey].recordId[o]=void 0;if(e.length<=0){crmNavig[crmNavig.customViewKey].noFurtherRecords="true";for(o=a;o<=parseInt(r)+1;o++)crmNavig[crmNavig.customViewKey].recordId[o]="EOA";crmNavig.EOAindex=a}for(o=0;o<n;o++){var s=e[o]?e[o].split(":::"):void 0;s?(crmNavig[crmNavig.customViewKey].recordId[a]={},crmNavig[crmNavig.customViewKey].recordId[a].id=s[0],crmNavig[crmNavig.customViewKey].recordId[a].module=s[1]?s[1]:$("#module")[0]?$("#module")[0].value:crmListView.getObject().module):crmNavig[crmNavig.customViewKey].recordId[a]="EOA",a++}i&&i.call(),crmNavig.fetchComplete="true";var l=$("#recordNum").length>0?$("#recordNum")[0].value:void 0;l&&crmNavig.setNavigButtonState(l)}})},removeFeaturCacheObj:function(e){delete crmNavig.NAVIGCACHEOBJ[e]},checkForNavigReq:function(e,t,r,a,i,n,o){var s=r+"_"+a;return crmNavig.NAVIGCACHEOBJ[e]&&crmNavig.NAVIGCACHEOBJ[e][t]&&crmNavig.NAVIGCACHEOBJ[e][t][s]&&!o?(n(crmNavig.NAVIGCACHEOBJ[e][t][s]),!1):(i(),!0)},assignNavigCacheData:function(e,t,r,a,i){var n=r+"_"+a;jQuery.isEmptyObject(crmNavig.NAVIGCACHEOBJ[e])?crmNavig.NAVIGCACHEOBJ[e]={}:crmNavig.NAVIGCACHEOBJ[e],jQuery.isEmptyObject(crmNavig.NAVIGCACHEOBJ[e][t])?crmNavig.NAVIGCACHEOBJ[e][t]={}:crmNavig.NAVIGCACHEOBJ[e][t],crmNavig.NAVIGCACHEOBJ[e][t][n]=i}},CrmPhoneNumbers={currentActivityId:null,showConversionForm:function(e,t,r,a,i){"NO_CHANGE"!=a&&(CrmPhoneNumbers.currentActivityId=a),null!=t&&"null"!=t&&t!==I18n.getMsg("crm.tpi.ctiapi.label.notification.unknowncaller")||(t=""),t=t.trim();var n=Crm.getCrmBasePath()+"/QCreate.do",o={fromCreate:"QuickCreate",module:e,ctiapi:!0,isPhoneNoConversion:!0,phoneno:t,phoneNoId:r};i&&(o.layoutId=i),networkUtils.setCsrfParam(o),(new crmRequestPool).initiate({action:n,cache:!1,type:"GET",data:o,success:function(e){if(-1!==e.indexOf("createEntityForm")){Crm.downloadValidationRules(Crm.getCrmBasePath()+"/QCreate.do?module="+o.module,o.module);var r=$("#ctinotifier_center");CrmPhoneNumbers.setupFormBackground(),r.html(e).show();var a=r.outerHeight()/2;r.css("margin-top","-"+a+"px"),commonUtils.showHideLoadingDiv(),CrmPhoneNumbers.populatePhoneNumberInForm($("form[name=createEntityFormbyPhoneConversion]"),t)}else"noPhoneFields"===e?CrmPhoneNumbers.noFieldErrFn():CrmPhoneNumbers.closeConversionForm()},error:function(){CrmPhoneNumbers.closeConversionForm()}})},saveAndConvertToEntity:function(e,t,r,a){var i=$(t),n=i.closest("form").get(0).name;new Promise((function(t){t(CVRExec.evalRules("edit",e))})).then((function(t){if(t&&quickCreateValidateAction("All",e,n)){i.attr("disabled",!0);var o=formData2QueryString(document.createEntityFormbyPhoneConversion,e);(new crmRequestPool).initiate({action:Crm.getCrmBasePath()+"/QuickCreateCommonModule.do?isload=true",type:"POST",data:o,success:function(e){e.entityId?(crmui.showMsgBand("success",I18n.getMsg("crm.label.creator.created.successMsg"),4e3),CrmPhoneNumbers.convertPhoneNoToEntity(a,r,e.entityModule,e.entityId,e.entityName,CrmPhoneNumbers.noFieldErrFn)):(crmui.showMsgBand("error",I18n.getMsg("crm.unable.to.process.request"),4e3),i.attr("disabled",!1))},error:function(){crmui.showMsgBand("error",I18n.getMsg("crm.unable.to.process.request"),4e3),i.attr("disabled",!1)}})}}))},convertPhoneNoToEntity:function(e,t,r,a,i,n){var o={phoneNoId:e,fromActivityId:CrmPhoneNumbers.currentActivityId,toModule:r,toEntityId:a,toEntityName:i};if("undefined"!=typeof ctiApiNotifier){var s=ctiApiNotifier.getCallRefIdForPhoneNo(t);s&&(o.callRefId=s)}networkUtils.setCsrfParam(o),(new crmRequestPool).initiate({action:Crm.getCrmBasePath()+"/ConvertPhoneNumber.do",type:"POST",data:o,success:function(){var e=new BasicEntityInfo(r,a,i);CrmPhoneNumbers.closeConversionForm(e),$(".phoneNo_"+t).parent().trigger("convertedFromPhone",[a,r,i])},error:function(){CrmPhoneNumbers.closeConversionForm(),n()}})},setupFormBackground:function(){Crm.menu.globalHideMenu();$("#crm_phnoconversion_freezeLayers").remove(),$("body").append("<div id='crm_phnoconversion_freezeLayers' class='ctiapiFreezeLayer' style='opacity:0.1;z-index:20;'></div>")},closeConversionForm:function(e){$("#ctinotifier_center,#availField").empty().hide(),$("#crm_phnoconversion_freezeLayers").remove(),Crm.isHeadless&&void 0!==WindowsCommunicator&&(e?WindowsCommunicator.notifyParent("crm-quick-create",e):WindowsCommunicator.notifyParent("cancel-operation"))},populatePhoneNumberInForm:function(e,t){if(t!==I18n.getMsg("crm.tpi.ctiapi.label.notification.unknowncaller")){var r=e.find("input[name='property(Phone)']"),a=e.find("input[name='property(Mobile)']");r.length>0?Crm.userDetails.isPhoneNoNewView?CrmPhoneNumberInput.setPhoneValue(r,t):r.val(t):a.length>0?Crm.userDetails.isPhoneNoNewView?CrmPhoneNumberInput.setPhoneValue(a,t):a.val(t):$("#qcFieldsContent").find(".labelValCreate").each((function(e,r){var a=$(r).find("input");if(a.data("uitype")==CrmFieldConstants.PHONE)return Crm.userDetails.isPhoneNoNewView?CrmPhoneNumberInput.setPhoneValue(a,t):a.val(t),!1}))}},showAssociateForm:function(e,t,r,a){CrmPhoneNumbers.currentActivityId=a,CrmPhoneNumbers.getAvailablePhoneFields(e,void 0,void 0,void 0,(function(){var a="associatePhNoForm"+r,i=Crm.getCrmBasePath()+"/Search.do?searchmodule="+e+"&fldName=assocWithName&fldId=assocWithId&targetForm="+a;Crm.menu.globalHideMenu(),$("#assocWithModule").val(e),commonUtils.openCustomLookup(i,void 0,"topBandPopup",renderingUtils.windowWidth-300),CRMLookupCallBack=function(){CRMLookupCallBack=null,$("form[name="+a+"]").each((function(){var a=$(this).find("#assocWithId").val();if(a){var i=$(this).find("#assocWithName").val();return CrmPhoneNumbers.onInputChange(a,i,e,t,r),!1}}))}}),CrmPhoneNumbers.noFieldErrFn)},onInputChange:function(e,t,r,a,i){CrmPhoneNumbers.setupFormBackground();var n="CrmPhoneNumbers.saveFieldAndConvertToEntity('"+r+"','"+e+"','"+$ESAPI.encoder().encodeForJavaScript(t)+"','"+a+"','"+i+"');";CrmPhoneNumbers.getAvailablePhoneFields(r,e,n,"CrmPhoneNumbers.closeConversionForm()",CrmPhoneNumbers.populateAvailablePhoneFields,CrmPhoneNumbers.noFieldErrFn)},getAvailablePhoneFields:function(e,t,r,a,i,n){var o={mode:"getAvailablePhoneFieldMap",entityId:t,module:e};(new crmRequestPool).initiate({action:Crm.getCrmBasePath()+"/CtiApiConfig.do",type:"GET",data:o,success:function(t){t.length?i(e,t,r,a):n&&n()}})},populateAvailablePhoneFields:function(e,t,r,a){t.sort(CrmPhoneNumbers.sortPhoneFields);var i={};i.availFields=t,i.module=e,i.saveFn=r,i.cancelFn=a;var n=Handlebars.templates.show_available_phn_fields(i);$("#availField").html(n).show();var o=$("input.availPhnField");o.eq(0).siblings(".fieldValue").length<1&&o.eq(0).attr("checked",!0),o.on("change",CrmPhoneNumbers.changePhoneField)},saveFieldAndConvertToEntity:function(e,t,r,a,i){var n=$("input[type=radio][name='availPhnField']:checked"),o=JSON.parse(n.attr("value")),s="/crm/v2/"+e+"/"+t+"?affected_data=true",l={},c=[],d={};l[o.SYS_REF_NAME]=a,c.push(l),d.data=c;var u={"X-ZCSRF-TOKEN":csrfParamName+"="+csrfToken};clientPortalName&&(u["X-CRMPORTAL"]=window.clientPortalName),(new crmRequestPool).initiate({action:s,type:"PUT",data:JSON.stringify(d),headers:u,contentType:"application/json",success:function(){$("#availField").empty().hide();var n=I18n.getMsg("PHONE NUMBER");crmui.showMsgBand("success",I18n.getMsg("crm.social.entity.associate.success",n),4e3),CrmPhoneNumbers.convertPhoneNoToEntity(a,i,e,t,r,(function(){crmui.showMsgBand("error",I18n.getMsg("crm.privileges.restrict"),"infinity",null)}))},error:function(){crmui.showMsgBand("error",I18n.getMsg("crm.privileges.restrict"),"infinity",null)}})},sortPhoneFields:function(e,t){return e.fieldValue||t.fieldValue?e.fieldValue?t.fieldValue&&!0===e.isPrimaryCol?-1:1:-1:!0===e.isPrimaryCol?-1:1},noFieldErrFn:function(){renderingUtils.showCustomAlert(I18n.getMsg("crm.calls.error.noassociate.field"),void 0,void 0,CrmPhoneNumbers.closeConversionForm)},changePhoneField:function(){1===$(this).siblings(".fieldValue").length?$("#rcpref").find("#save").attr({value:I18n.getMsg("crm.button.replace")}):$("#rcpref").find("#save").attr({value:I18n.getMsg("Save")})}};!function(){var e=Handlebars.template;(Handlebars.templates=Handlebars.templates||{}).crmSchedulerNotification=e({1:function(e,t,r,a,i){var n;return' <div class="picklist_progress progressBarAnime"> <p class="pB20 pR pL8">'+(null!=(n=e.lambda(null!=t?t.message:t,t))?n:"")+'</p> <div class="pR progBarWarp"> <div class="progBarWheel"> </div> </div> </div> '},3:function(e,t,r,a,i){var n,o=null!=t?t:{};return' <div class="schedularMsg"> <p class="pB5 pL10 '+(null!=(n=r.ifCond.call(o,null!=t?t.status:t,"=","success",{name:"ifCond",hash:{},fn:e.program(4,i,0),inverse:e.program(6,i,0),data:i}))?n:"")+' pR"> '+(null!=(n=e.lambda(null!=t?t.message:t,t))?n:"")+" </p> "+(null!=(n=r.if.call(o,null!=t?t.link:t,{name:"if",hash:{},fn:e.program(8,i,0),inverse:e.noop,data:i}))?n:"")+" </div> "},4:function(e,t,r,a,i){return"succesIcoSchedular"},6:function(e,t,r,a,i){return"failedIcoRLS"},8:function(e,t,r,a,i){var n;return" "+(null!=(n=r.if.call(null!=t?t:{},null!=t?t.canvasid:t,{name:"if",hash:{},fn:e.program(9,i,0),inverse:e.program(11,i,0),data:i}))?n:"")+" "},9:function(e,t,r,a,i){var n=e.lambda,o=e.escapeExpression;return' <link-to onclick="crmSchedulerNotification.stopRemove()" lt-prop-route="crm.tab.module.entity.canvas" lt-prop-dp=\'["'+o(n(null!=t?t.module:t,t))+'","'+o(n(null!=t?t.id:t,t))+'","'+o(n(null!=t?t.canvasid:t,t))+'"]\' lt-prop-qp=\'{"showShared":"true"}\' lt-prop-class="f13 mL2 pL10 uline1 viewInfoTbl"> '+o(r.getI18n.call(null!=t?t:{},null!=t?t.linkMsg:t,{name:"getI18n",hash:{},data:i}))+" </link-to> "},11:function(e,t,r,a,i){var n=e.lambda,o=e.escapeExpression;return' <link-to onclick="crmSchedulerNotification.stopRemove()" lt-prop-route="crm.tab.module.entity.detail" lt-prop-dp=\'["'+o(n(null!=t?t.module:t,t))+'","'+o(n(null!=t?t.id:t,t))+'"]\' lt-prop-qp=\'{"showShared":"true"}\' lt-prop-class="f13 mL2 pL10 uline1 viewInfoTbl"> '+o(r.getI18n.call(null!=t?t:{},null!=t?t.linkMsg:t,{name:"getI18n",hash:{},data:i}))+" </link-to> "},compiler:[7,">= 4.0.0"],main:function(e,t,r,a,i){var n;return(null!=(n=r.ifCond.call(null!=t?t:{},null!=t?t.status:t,"=","progress",{name:"ifCond",hash:{},fn:e.program(1,i,0),inverse:e.program(3,i,0),data:i}))?n:"")+" "},useData:!0})}();var CPMF={initClientPortalUserRequest:function(e,t,r,a){var i=new crmRequestPool;return i.initiate({action:e,type:t,headers:{"X-ZCSRF-TOKEN":csrfParamName+"="+csrfToken,"X-CRMPORTAL":Crm.userDetails.CLIENT_PORTAL_NAME},data:r,success:function(e){a(e)},error:function(e){"403"!==e.status&&"400"!==e.status||renderingUtils.displayPermissionDenied()}}),i},getClientPortalProfilesRelatedToPersonalityModule:function(e,t,r,a){var i=networkUtils.returnDependencyFiles(["crm-client-portal-user-mixin.js"],crmConstants.jsStaticPathForLyte),n=networkUtils.returnDependencyFiles(["crm-portals-detail-view-related.js","user_type.js"],crmConstants.jsStaticPathForLyte),o=networkUtils.returnDependencyFiles(["crm-portals-detail-view-related.css","crm-client-portal-send-invite.css"],crmConstants.cssStaticPathForLyte),s=n.concat(o);Lyte.injectResources({parent:i,child:s},void 0,(function(){if("reinvite"!==r)store.findAll("user_type").then((function(i){for(var n=i.length,o=[],s=Crm.moduleInfo[e].apiname,l=!1,c=0;c<n;c++){var d=i[c];if(d.personality_module.api_name===s&&d.active){var u={};u.id=d.id,u.name=d.name,u.id===a&&(l=!0),o.push(u)}}if(o.length>0){var m={};m.allowed_records=o,m.title="invite"===r?I18n.getMsg("custmr.prtl.send.invite"):I18n.getMsg("custmr.prtl.send.reinvite"),m.primaryButtonTitle="invite"===r?I18n.getMsg("crm.label.invite"):I18n.getMsg("custmr.prtl.label.reinvite"),m.isFromInvite="invite"===r,m.selected_value=a&&l?a:o[0].id,m.entityId=t,m.module=e,Lyte.Component.render("crm-client-portal-send-invite",m,"body"),$L("#sendInvitePopUp").e.ltProp("show",!0)}else Lyte.registeredMixins["crm-client-portal-user-util"].showErrorMsg({message:"custmr.prtl.no.portal.type.active"})}));else{var i={};i.title="invite"===r?I18n.getMsg("custmr.prtl.send.invite"):I18n.getMsg("custmr.prtl.send.reinvite"),i.primaryButtonTitle="invite"===r?I18n.getMsg("crm.label.invite"):I18n.getMsg("custmr.prtl.label.reinvite"),i.isFromInvite="invite"===r,i.selected_value=a,i.entityId=t,i.module=e,Lyte.Component.render("crm-client-portal-send-invite",i,"body"),$L("#sendInvitePopUp").e.ltProp("show",!0)}}))},togglePortalUserStatus:function(e,t,r){var a=networkUtils.returnDependencyFiles(["crm-client-portal-user-mixin.js"],crmConstants.jsStaticPathForLyte),i=networkUtils.returnDependencyFiles(["crm-portals-detail-view-related.js","user_type.js"],crmConstants.jsStaticPathForLyte),n=networkUtils.returnDependencyFiles(["crm-portals-detail-view-related.css","crm-client-portal-send-invite.css"],crmConstants.cssStaticPathForLyte),o=i.concat(n);Lyte.injectResources({parent:a,child:o},void 0,(function(){Lyte.registeredMixins["crm-client-portal-user-util"].changePortalUserStatus(e,t,r).then((function(e){if("success"===e.users[0].status){var t="activate"===r?I18n.getMsg("custmr.prtl.actvtd.success"):I18n.getMsg("custmr.prtl.deactvtd.success");crmui.showMsgBand("success",t,3e3);var a="activate"===r?"#deactivateClient":"#activateClient";$("#deactivateClient"===a?"#activateClient":"#deactivateClient").hide(),$(a).show(),$("#timeLineContainerDataDV").empty(),refreshFollowDiv(),"canvas"===Lyte.Router.getRouteInstance().routeName&&Lyte.Router.getRouteInstance().refresh()}}),(function(e){Lyte.registeredMixins["crm-client-portal-user-util"].showErrorMsg(e.responseJSON)}))}))},getClientPortalUserLocaleInfo:function(){Lyte.injectResources(networkUtils.returnDependencyFiles([networkUtils.getI18nJSUrl("portaluser")]),void 0,(function(){CPMF.initClientPortalUserRequest("/crm/v2/settings/clientportal/getUserLocaleInfo","GET","",(function(e){var t=I18n.getMsg("custmr.prtl.portal.user.preferences"),r=new Array(2);r[0]="id='removePopup'",r[1]="data-zcqa='removePopup'";var a=crmPopupUtils.getButtonJson("newgraybtn",I18n.getMsg("crm.button.skip"),!1,"CPMF.removePopup('localeEditPopup')",r),i=new Array(2);i[0]="id='updateLocaleDetails'",i[1]="data-zcqa='updateLocaleDetails'";var n=crmPopupUtils.getPrimaryButton(I18n.getMsg("custmr.prtl.updt.locale"),"CPMF.updateClientPortalUserLocaleInfo();",i),o=Handlebars.templates.clientPortalUserLocaleInformation(e),s="localeEditPopup",l={};l.closeButton=a,l.primaryButton=n;var c=crmPopupUtils.getHeader(s,t,"","","w600"),d=crmPopupUtils.getFooter("",l),u=crmPopupUtils.getPopUpJson(c,o,d);crmPopupUtils.showPopup(s,u),thirdPartyUtils.bindSelect2(".newSelect select")}))}))},updateClientPortalUserLocaleInfo:function(){var e=$("#language").find(":selected").val(),t=$("#timeFormat").find(":selected").val(),r=$("#timeZone").find(":selected").val(),a=$("#country").find(":selected").val(),i=$("#currency").find(":selected").val(),n=$("#gseparator").find(":selected").data("option"),o=$("#dseparator").find(":selected").data("option"),s={};s.preferredLanguage=e,s.preferredTimeFormat=t,s.preferredTimeZone=r,s.preferredCountry=a,s.preferredCurrency=i,s.gSeparator=n,s.dSeparator=o;CPMF.initClientPortalUserRequest("/crm/v2/settings/clientportal/updateUserLocaleInfo","POST",s,(function(e){if("SUCCESS"===e.message){CPMF.removePopup("localeEditPopup"),crmui.showMsgBand("success",I18n.getMsg("custmr.prtl.portal.user.updt.preferences"),5e3);var r=location.href;(-1!==r.indexOf("newSignUp")||e.refresh)&&(r=r.replace("?newSignUp=true",""),networkUtils.openUrl(r,"_self"));var a="hh:mm a";"24"==t&&(a="HH:mm"),Crm.userDetails.TIME_FORMAT=a}}))},removePopup:function(e){crmui.hidePopup(e),$("#"+e).remove()},getPortalUserTypesForTransfer:function(e,t,r,a,i){var n=networkUtils.returnDependencyFiles(["crm-client-portal-user-mixin.js"],crmConstants.jsStaticPathForLyte),o=networkUtils.returnDependencyFiles(["crm-portals-detail-view-related.js","user_type.js"],crmConstants.jsStaticPathForLyte),s=networkUtils.returnDependencyFiles(["crm-portals-detail-view-related.css","crm-client-portal-send-invite.css"],crmConstants.cssStaticPathForLyte),l=o.concat(s);Lyte.injectResources({parent:n,child:l},void 0,(function(){Lyte.registeredMixins["crm-client-portal-user-util"].renderChangeUserTypePopup(e,t,r,a,i)}))},removePortalUser:function(e,t){var r=networkUtils.returnDependencyFiles(["crm-client-portal-user-mixin.js","crm-client-portal-user-data-store.js"],crmConstants.jsStaticPathForLyte),a=networkUtils.returnDependencyFiles(["crm-portals-detail-view-related.js"],crmConstants.jsStaticPathForLyte),i=networkUtils.returnDependencyFiles(["crm-portals-detail-view-related.css"],crmConstants.cssStaticPathForLyte),n=a.concat(i);Lyte.injectResources({parent:r,child:n},void 0,(function(){Lyte.registeredMixins["crm-client-portal-user-util"].renderRemoveUserPopup(t,e,"detailView")}))},showPortalPreferenceDropDown:function(e){var t=$(e).offset(),r=$("#customizedd").outerWidth(),a=$("#portalUsrPreferenceDD"),i=t.left-a.outerWidth(),n=t.left+r,o=t.top;Crm.userDetails.RTL_ENABLED?a.show().css({left:n,top:o}):a.show().css({left:i,top:o})},hidePortalPreferenceDropDown:function(){var e=$("#portalUsrPreferenceDD");setTimeout((function(){e.is(":hover")?e.show():e.hide()}),100)},chgrouping:function(){var e=$("#gseparator"),t=$("#dseparator"),r=e.val();r===t.val()&&("Comma"===r?(t.val("Period"),t.val("Period").trigger("change")):(t.val("Comma"),t.val("Comma").trigger("change")))},chdecimal:function(){var e=$("#gseparator"),t=$("#dseparator"),r=e.val(),a=t.val();r===a&&("Comma"===a?(e.val("Period"),e.val("Period").trigger("change")):(e.val("Comma"),e.val("Comma").trigger("change")))}},EntityEmail={globalDealPopupVisibility:!1,showDealPopup:function(e,t,r){EntityEmail.removePopUps();var a,i,n=$(e),o=0!=$("#selectMails").parents().find("crm-emails-related-list").length,s=o?$("#"+t).closest(".ecnBodyTxt").parent():n.closest(".mailcontDiv"),l=s.data("dealid"),c=s.data("dealname"),d="canvas"==Lyte.Router.getRouteInstance().routeName,u=$("crm-emailsrl-canvas-view"),m=$("#module").val(),p=$("#id").val();if("Contacts"===m)i=p,a=$("#primEmail").val();else if("Potentials"===m)i=$("#cntId").val(),a=$("#primEmail").val(),d&&(i=u.attr("associated-cont-id"));else if("Accounts"==m){var g=$("#contactSelDropdownInAcc");"ALL"==g.val()||"ALL"==g.attr("lt-prop-selected")?i=s.data("contactid"):(i=g.val(),a=$("#contactSelDropdownInAcc option:selected").attr("email"),(o||d)&&(i=g.attr("lt-prop-selected"),a=$('lyte-drop-item[data-value="'+i+'"]').data("email")))}if(i&&""!==i&&"null"!==i)if(a&&""!==a&&"null"!==a){var h=n.offset().top+n.outerHeight()+10,f=n.closest("td").offset().left,v=$("#dvinner"),C=h-v.offset().top+v.scrollTop()-50,y=function(){var e;if(h=n.offset().top+n.outerHeight()+10,f=n.offset().left,r){var a={assoPotentialToId:t,name:"potDealOptions",dealId:l,dealName:c};$("body").append(Handlebars.templates.EmailPopUps(a)),e=$("#potDealOptions"),f-=e.outerWidth()/2}else{a={assoPotentialToId:t,name:"associateDeal",dealName:c,dealId:l};$("body").append(Handlebars.templates.EmailPopUps(a)),e=$("#ldealInfo"),f-=80,e.draggable({handle:"#draggableHandle"})}Crm.userDetails.RTL_ENABLED&&o?f-=e.outerWidth()/2:o||d||(f-=80),e.css({top:h,left:f,"z-index":20}),v=0==v.length?$("#detailcanvascontainer"):v,setTimeout((function(){v.scroll((function(){EntityEmail.removePopUps()}))}),100)};if(n.offset().top+160>renderingUtils.windowHeight){var E=C+"px";v.animate({scrollTop:E},300,y)}else y()}else crmui.showMsgBand("error",I18n.getMsg("crm.relatedList.deals.error")+I18n.getMsg("crm.label.Email")+".",4e3);else crmui.showMsgBand("error",I18n.getMsg("crm.relatedList.deals.error")+".",4e3)},showDVDealPopup:function(){$("#emailDetailIframeContent").contents().find("#editDealOptionsInner").show()},removePopUps:function(){$("#ldealInfo").remove(),$("#ldPopup").remove(),$("#dvinner").unbind("scroll"),$("#potDealOptions").remove()},listViewChangeDeal:function(e){EntityEmail.removePopUps(),$("#"+e).length>0?renderingUtils.triggerEvent("click",$("#"+e)):Crm.showLookUp($("#module").val(),e,e,"Potentials","Potentials","rLEmail")},showHideDealToolTip:function(e,t){var r=$(t),a=r.closest(".mailcontDiv").data("dealname");"show"==e?EntityEmail.globalDealPopupVisibility=setTimeout((function(){var e=$("#ldPopup"),t=e.outerHeight();if(!$("#ldealInfo").is(":visible")){var i=r.position(),n=i.top,o=i.left+r.outerWidth()+20,s={name:"dealInfo",dealName:a};$("body").append(Handlebars.templates.EmailPopUps(s)),e.css({left:o,top:n-t/2+10})}}),1500):"hide"==e&&(clearTimeout(EntityEmail.globalDealPopupVisibility),$("#ldPopup").remove())},changeDealForEmail:function(e,t,r,a){var i=0!=$("#selectMails").parents().find("crm-emails-related-list").length,n=$("#"+t),o=$("#emailDetailIframeContent").contents(),s=i?n.closest(".ecnBodyTxt").parent():n.closest(".mailcontDiv"),l=Crm.getCrmBasePath()+"/mailer/EntityEmailAction.do",c={};if(c.action=e,s.length>0)c.userId=s.data("userid")?s.data("userid"):void 0,c.msgId=s.data("msgid"),c.mailSource=s.data("emailtype");else if(null!=o&&null!=o){var d=o.find("#mailUserId").val();c.userId=null!=d?d:void 0,c.msgId=t.split("assoPotential_")[1],c.mailSource=o.find("#viewMailType").val()}"associateDeal"===e&&(c.dealId=r),null!=csrfParamName&&null!=csrfParamName&&null!=csrfToken&&null!=csrfToken?c[csrfParamName]=csrfToken:c[parent.csrfParamName]=parent.csrfToken;var u=$("#module").val(),m=$("#id").val(),p=Lyte.Router.getRouteInstance()&&"canvas"==Lyte.Router.getRouteInstance().routeName;if("Contacts"===u)c.contactId=m,c.email=$("#primEmail").val(),p&&(c.email=document.querySelector("crm-emailsrl-canvas-view").getData("email"));else if("Potentials"===u)c.contactId=$("#cntId").val(),c.email=$("#primEmail").val(),p&&(c.contactId=$("crm-emailsrl-canvas-view").attr("associated-cont-id"));else if("Accounts"==u){var g=$("#contactSelDropdownInAcc");$("#isFromNewAPI").length>0?"ALL"==g.attr("lt-prop-selected")?(c.contactId=s.data("contactid"),c.email=$('lyte-drop-item[data-value="'+c.contactId+'"]').data("email")):(c.contactId=g.attr("lt-prop-selected"),c.email=$('lyte-drop-item[data-value="'+c.contactId+'"]').data("email")):"ALL"==g.val()?(c.contactId=s.data("contactid"),c.email=g.find('option[value="'+c.contactId+'"]').attr("email")):(c.contactId=g.val(),c.email=$("#contactSelDropdownInAcc option:selected").attr("email"))}(new crmRequestPool).initiate({action:l,type:"POST",data:c,dataType:"json",success:function(i){if("success"===i.status){var n=store.peekRecord("emails_rl_user",s.data("msgid"));if("associateDeal"===e){var o=s.closest(".topband_dv_row");if(s.addClass("hasDeal"),s.find(".ecnBodyTxt").addClass("hasDeal"),s.find(".elipse_toE").addClass("hasDeal"),s.data("dealid",r),s.data("dealname",a),o.addClass("ldHighlightRow"),void 0!==n)(u=n.data).linked_deal={},u.linked_deal.id=r,u.linked_deal.name=a,store.pushPayload("emails_rl_user",{content:s.data("msgid"),data:u});setTimeout((function(){o.addClass("ldAnimateHighlight")}),500),setTimeout((function(){$(".ldAnimateHighlight").removeClass("ldHighlightRow ldAnimateHighlight")}),4e3),(c=$("#emailDetailIframeContent").contents()).find('li[name="dealLiOption"]').html(I18n.getMsg("crm.relatedList.deals.unlinkdeal",I18n.getMsg(moduleRecordMapping.Potentials.singular_label)));var l={name:"dealInfoInMailDetailView",dealId:r,dealName:a,assoPotentialToId:t};c.find("#emailLinkedDeal").html(Handlebars.templates.EmailPopUps(l)).show().addClass("hasDeal"),"dealsOnly"!==(d=$("#dealOnlyDropDown")).val()&&"dealsOnly"!==d.attr("lt-prop-selected")||(m!=r?o.addClass("hide"):o.hasClass("hide")&&o.removeClass("hide"),o.siblings(".topband_dv_row").length||reloadPersonality("emailspersonality")),crmui.showMsgBand("success",i.message+" '"+a+"'",4e3)}else if("dissociateDeal"===e){var c,d,u;if(s.removeClass("hasDeal"),s.removeData("dealid"),s.removeData("dealname"),$("#ldealInfo").remove(),(c=$("#emailDetailIframeContent").contents()).find('li[name="dealLiOption"]').html(I18n.getMsg("crm.relatedList.deals.link",I18n.getMsg(moduleRecordMapping.Potentials.singular_label))),c.find("#emailLinkedDeal").html("").hide().removeClass("hasDeal"),"dealsOnly"===(d=$("#dealOnlyDropDown")).val()||"dealsOnly"===d.attr("lt-prop-selected"))(o=s.closest(".topband_dv_row")).addClass("hide"),o.siblings(".topband_dv_row").length||reloadPersonality("emailspersonality");if(crmui.showMsgBand("success",i.message+" '"+a+"'",4e3),void 0!==n)$("#unlinkDeal").addClass("hide"),$("#linkDeal").removeClass("hide"),delete(u=n.data).linked_deal,store.pushPayload("emails_rl_user",{content:s.data("msgid"),data:u})}}}})},changeEmailsViewForDeals:function(e){var t=$(e).val();t=""==t||null==t?$(e).attr("lt-prop-selected"):t;var r,a=$("#selectMails"),i=0!=a.parents().find("crm-emails-related-list").length;if(a.addClass("onDealChange"),"dealsOnly"===t)if(i){a.find('lyte-drop-group:not([type="2"]) lyte-drop-item').prop("disabled",!0);if((r=a.find("[data-value='"+a.attr("lt-prop-selected")+"']").parent("lyte-drop-group")).length)"2"!=r.attr("type")&&a.attr("lt-prop-selected","IMAP_ALL")}else{if(a.find('optGroup:not([type="2"]) option').prop("disabled",!0),(r=a.find(":selected").parent("optGroup")).length)"2"!=r.attr("type")&&a.val("IMAP_ALL")}else i?a.find('lyte-drop-group:not([type="2"]) lyte-drop-item').prop("disabled",!1):a.find('optGroup:not([type="2"]) option').prop("disabled",!1);a.length&&(i?showMailsListViaAPI("","0"):(thirdPartyUtils.bindSelect2(a),renderingUtils.triggerEvent("change",a)))},linkUnlinkDeal:function(){if($("#ecnSummeryView").hasClass("hide")||0!==$("#emailDetailIframeContent").length){var e=$("#emailDetailIframeContent").contents(),t=e.find("#dealLinkId").val();if(e.find("#emailLinkedDeal.hasDeal").length){var r=$("#"+t),a=r.closest(".mailcontDiv"),i=a.data("dealid"),n=a.data("dealname");if($("#isFromNewAPI").length>0&&0==a.length){var o=r.closest("lyte-td").children("div").data();i=o.dealid,n=o.dealname}EntityEmail.changeDealForEmail("dissociateDeal",t,i,n)}else EntityEmail.listViewChangeDeal(t)}else $("#linkDeal").hasClass("hide")?EntityEmail.linkUnlinkDealForSummary("unlink_deal"):EntityEmail.linkUnlinkDealForSummary("link_deal")},linkUnlinkDealForSummary:function(e){var t=$L("#summaryMailDet");if("unlink_deal"===e){var r=$("#unlinkDeal"),a=r.data("id"),i=r.data("name");EntityEmail.changeDealForEmail("dissociateDeal","assoPotential_"+t.data("msgid"),a,i)}else EntityEmail.listViewChangeDeal("assoPotential_"+t.data("msgid"))}};