var Attribution={actionurl:"/crm/v2/settings/marketing/Attribution",moduleurl:"/crm/v2/marketing/Attribution",stageJson:[],defaultstage:[{stagename:"Lead Creation",module:"Leads",weightage:25,isdefault:!0,defaultstagename:"Lead Creation"},{stagename:"Lead Conversion",module:"Contacts",weightage:25,isdefault:!0,defaultstagename:"Lead Conversion"},{stagename:"Potentials Creation",module:"Potentials",weightage:25,isdefault:!0,defaultstagename:"Potentials Creation"},{stagename:"Potentials Won",module:"Potentials",weightage:25,isdefault:!0,defaultstagename:"Potentials Won"}],counter:0,confdetail:[],timer:1500,isPageModified:!1,refresh_weightagepop:!0,singular_module:[],remove_potential_stages:[],potential_stages_backup:[],showSetup:function(){Attribution.connect(Attribution.actionurl+"/showsetup","Attribution.showSetupcalback",{},"GET")},showSetupcalback:function(){var t=arguments[0],e=$("#tabLayer"),a=$(".setupleftmenutd"),n=e.offset().top+e.outerHeight()+30,i=a.next();a.addClass("pR slideHiderLeftPane"),i.addClass("pR slideHiderMidPane"),a.removeClass("slideHiderLeftPane").hide(),i.removeClass("slideHiderMidPane").css({left:"0px"});var o=t;if(Attribution.confdetail=o.Attribution.conf_details,Attribution.singular_module=o.Attribution.singular_module,Attribution.potential_stages_backup=o.Attribution.potential_stage[0].pick_list_values,$(".new_setupview").addClass("newSetupRightShow marketAttribution"),void 0!==Attribution.confdetail&&void 0!==Attribution.confdetail.type){var l=o.Attribution.conf_details.type,r=o.Attribution.conf_details.weightage_campaign_type,s=o.Attribution.conf_details.exclude_campaign_type,c=o.Attribution.conf_details.stages;(s=JSON.parse(s)).length>0&&$("#exclude_source").val(s),r=JSON.parse(r),Attribution.populateIncludeExcludeJson(r),$("#convFlowGetStartTitle, #convFlowGetStart").addClass("dN"),$("#convFlowConfiguration").removeClass("dN"),Attribution.setHeightForAttribution(),$("#convFlowBox").removeClass("dN"),$(".convFlowShapesSaved").removeClass("convFlowShapesSaved"),$(".convFlowShapesActive").removeClass("convFlowShapesActive"),$("#shape_"+l).addClass("convFlowShapesActive convFlowShapesSaved"),"U_SHAPE"===l||"W_SHAPE"===l?(Attribution.applydefaultstages(l,c),Attribution.widthUpdate(),Attribution.drawShapes(l),Attribution.svgWidthHeightUpdate(),Attribution.generateAndInitializeShape(l),$(".convFlowModule.convFlowModuleActive").find(".convFlowRemainModule").removeClass("dN"),Attribution.drawTopLine(),$("#shape_defn").text(I18n.getMsg("crm.setup.attribution."+l+".defn"))):Attribution.showStages($("#shape_"+l)),Attribution.refreshPotentialStages()}else $("#convFlowGetStartTitle, #convFlowGetStart").removeClass("dN"),$("#convFlowConfiguration").addClass("dN"),Attribution.emptyRemovePotentialStage(),$("#convFlowAttribution").css("height","calc(100vh - "+n+"px)");Attribution.updateBTN(),Attribution.setRemainValue(l),Attribution.isPageModified=!1},refreshPotentialStages:function(){var t=$(".convFlowShapesActive").attr("data-attr");if(void 0!==Attribution.confdetail&&void 0!==Attribution.confdetail.type&&Attribution.confdetail.type===t){var e=Attribution.confdetail.stages,a=0;$(e).each((function(t,e){1!=e.isdefault&&(Attribution.remove_potential_stages[a++]=e.stagename)}))}else void 0!==Attribution.confdetail&&void 0!==Attribution.confdetail.type&&(Attribution.remove_potential_stages=[]);Attribution.repopulateStages()},setHeightForAttribution:function(){var t=$("#tabLayer"),e=$("#convFlowRight"),a=t.offset().top+t.outerHeight(),n=renderingUtils.windowHeight-(a+28),i=$("#convFlowSaveCancelDiv").outerHeight();$("#convFlowAttribution").css("height",n),e.css("top",a),$("#convFlowLeft").css("height",n-i)},populateIncludeExcludeJson:function(t){if(Attribution.refresh_weightagepop){var e=t.length;if(e>0){var a=$("#modWeightageCriteria").find(".addCriteria");$(".modWeightType").length;$(t).each((function(t){t<e-1&&a.trigger("click")})),$("#modWeightageCriteria").find(".modWeightType").each((function(e){if("modWeightType"===$(this).attr("name")){var a=JSON.parse(t[e]);$(this).val(a.type),$(this).attr("data-weight",a.weightage)}})),$("#modWeightageCriteria").find('select[name="weightx"]').each((function(e){var a=JSON.parse(t[e]);"1"!==a.weightage&&$(this).val(a.weightage),$(this).trigger("mouseout")}))}}},updateBTN:function(){Attribution.unbind("deactivateBTN"),Attribution.unbind("saveBTN");var t=$("#deactivateBTN"),e=$("#saveBTN");void 0!==Attribution.confdetail&&void 0!==Attribution.confdetail.type?(e.text(I18n.getMsg("crm.button.update")),t.click((function(){Attribution.goToSetup()})),e.click((function(){Attribution.saveconfirmation()})),$("#convFlowDeactivateBtn").removeClass("dN")):(e.text(I18n.getMsg("zb.common.Save")),t.text(I18n.getMsg("crm.livedesk.disable.cancel")),t.click((function(){Attribution.cancelConfiguration()})),e.click((function(){Attribution.save()})),$("#convFlowDeactivateBtn").addClass("dN"))},selectShapePage:function(t){var e=$(t).attr("data-attr");$("#convFlowConfiguration").removeClass("dN"),$("#convFlowGetStartTitle, #convFlowGetStart").addClass("dN"),$(".new_setupview").addClass("newSetupRightShow marketAttribution"),Attribution.setHeightForAttribution(),$(".convFlowShapesSaved").removeClass("convFlowShapesSaved"),$(".convFlowShapesActive").removeClass("convFlowShapesActive"),$("#shape_"+e).click().addClass("convFlowShapesSaved convFlowShapesActive");var a=$(".convFlowShapesSaved").data("attr");$("#convFlowShapeSaved").text(a),"U_SHAPE"!==e&&"W_SHAPE"!==e||Attribution.svgWidthHeightUpdate(),$("#shape_defn").text(I18n.getMsg("crm.setup.attribution."+e+".defn")),Attribution.updateBTN()},cancelConfiguration:function(){$(".convFlowShapesSaved").removeClass("convFlowShapesSaved"),$("#convFlowGetStartTitle, #convFlowGetStart").removeClass("dN"),$(".new_setupview").addClass("newSetupRightShow marketAttribution"),$("#convFlowConfiguration").addClass("dN")},zoom:function(t){var e=$(".convFlowShapesActive").attr("data-attr"),a=Attribution.currentZoomVal();if("plus"===t)a<1&&$("#stageul").css("transform","scale("+(a+.1)+")");else{if(a<=.5)return;$("#stageul").css("transform","scale("+(a-.1)+")")}Attribution.svgWidthHeightUpdate(),Attribution.updateShapesAfterAddStage(e),Attribution.drawTopLine()},currentZoomVal:function(){var t,e=$("#stageul").css("transform");if("none"==e)t=1;else if(null!=e){var a=(a=(a=e.split("(")[1]).split(")")[0]).split(",");t=parseFloat(a[3])}return t},showStages:function(t){if(Attribution.isPageModified)Attribution.showPopupIfChanged(t);else{sE(event);var e,a=(t=$(t)).attr("data-attr"),n=$("#conFlowZoomDiv"),i=$("#convFlowBox"),o=$("#convFlowRemainShape"),l=$("#convFlowLinearShape"),r=$("#convAttrShape");if($(".convFlowShapesActive").removeClass("convFlowShapesActive"),t.addClass("convFlowShapesActive"),void 0!==Attribution.confdetail&&void 0!==Attribution.confdetail.type?(a===Attribution.confdetail.type?(e=Attribution.confdetail.stages,Attribution.refreshPotentialStages()):Attribution.emptyRemovePotentialStage(),Attribution.applydefaultstages(a,e)):Attribution.applydefaultstages(a),Attribution.widthUpdate(),Attribution.showWeightageDiv(a),l.addClass("dN"),r.removeClass("dN"),"U_SHAPE"==a||"W_SHAPE"==a)i.removeClass("dN"),o.addClass("dN"),Attribution.svgWidthHeightUpdate(),Attribution.drawShapes(a),Attribution.updateShapesAfterAddStage(a),$(".convFlowModule.convFlowModuleActive").find(".convFlowRemainModule").removeClass("dN"),Attribution.drawTopLine(),Attribution.setRemainValue(a),n.removeClass("dN");else{i.addClass("dN"),o.removeClass("dN");var s=$(".convFlowBarDiv"),c=s.find(".convFlowBarOuter"),d=s.find(".convFlowBarPer"),u=s.find(".convFlowBarInner");switch($("#convAttrRemainShapeDiv, #convFlowRemainShapeLine, #convFlowStageName").addClass("dN"),d.addClass("dN").removeClass("convFlowBarPerEmpty"),c.addClass("dN"),u.removeClass("convFlowBar"),s.removeClass("convFlowBarActive convFlowBarLinear convFlowBarTimeDecay"),a){case"FIRST_TOUCH":var v=s.eq(0);Attribution.firstLastTouch(v);break;case"LAST_TOUCH":var p=s.eq(3);Attribution.firstLastTouch(p);break;case"LINEAR":s.addClass("convFlowBarActive convFlowBarLinear"),l.removeClass("dN"),thirdPartyUtils.bindSelect2(".modWeightType,.convFlowWeightx,#exclude_source"),Attribution.showLinearDecay();break;case"TIME_DECAY":s.addClass("convFlowBarActive convFlowBarTimeDecay"),l.addClass("dN"),Attribution.showLinearDecay()}$(".convFlowRemainModule").addClass("dN"),$("#convFlowBottomLine").removeAttr("style").addClass("dN"),n.addClass("dN")}$("#shape_defn").text(I18n.getMsg("crm.setup.attribution."+a+".defn"))}},firstLastTouch:function(t){var e=$(t);e.find(".convFlowBarOuter").removeClass("dN"),e.find(".convFlowBarPer").removeClass("dN"),e.find(".convFlowBarInner").addClass("convFlowBar"),e.addClass("convFlowBarActive"),$("#convAttrShape").addClass("dN")},goToSetup:function(){Attribution.isPageModified?Attribution.gosetup():document.location.href=Crm.getOrgSpecificURL(Crm.getCrmBasePath()+"/settings/index")},gosetup:function(){var t="stayonPageConfirmBox",e=$("#"+t);freezeBackground(),mailsetCenter(t),e.find(".leavePage").off("click").click((function(){$("#"+t).hide(),removeFreezeLayer(),Attribution.isPageModified=!1,document.location.href=Crm.getOrgSpecificURL(Crm.getCrmBasePath()+"/settings/index")})),e.find(".stayPage").off("click").click((function(){$("#"+t).hide(),removeFreezeLayer()})),e.focus()},showLinearDecay:function(){var t=$(".convFlowBarDiv"),e=t.find(".convFlowBarInner"),a=t.find(".convFlowBarPer");e.addClass("convFlowBar"),a.removeClass("dN").addClass("convFlowBarPerEmpty"),Attribution.linearDecaySvgWidth(),Attribution.drawTopLineLinearDecay(),Attribution.generateLineShape()},linearDecaySvgWidth:function(){var t=$(".convFlowBarDiv"),e=$("#convFlowAttribution").outerHeight(),a=t.length,n=t.outerWidth()*a;$("#convAttrRemainShapeDiv").removeClass("dN"),$("#convAttrRemainShapeSvgDiv").css({width:n+12,height:e})},drawTopLineLinearDecay:function(){var t=$("#convFlowRemainShapeLine"),e=$("#convFlowFixedShape").find(".convFlowBarBubbleOuter"),a=e.eq(0).offset(),n=e.outerWidth()/2,i=a.left+n,o=e.last().offset().left+n,l=Attribution.getScrollLeftVal("convFlowLeft");Crm.userDetails.RTL_ENABLED?t.css({right:renderingUtils.windowWidth-i+l,width:i-o,top:a.top+100}):t.css({left:i+l,width:o-i,top:a.top+100}),t.removeClass("dN")},showWeightageDiv:function(t){void 0!==t&&"LINEAR"===t?$("#convFlowLinearShape").removeClass("dN"):$("#convFlowLinearShape").addClass("dN")},connect:function(t,e,a,n,i){var o=new crmRequestPool,l={"X-ZCSRF-TOKEN":csrfParamName+"="+csrfToken};commonUtils.showHideLoadingDiv(!0),o.initiate({type:n,action:t,data:a,contentType:"application/json",dataType:"json",headers:l,success:function(t){commonUtils.showHideLoadingDiv(!1),null!=e&&Lyte.registeredMixins["crm-utilities"].executeFunctionByName(e,window,t,i)},error:function(t){commonUtils.showHideLoadingDiv(!1),null!=e&&void 0!==t&&void 0!==t.responseJSON&&Lyte.registeredMixins["crm-utilities"].executeFunctionByName(e,window,t.responseJSON,i)}})},constructStage:function(t){var e="marketing_attr_"+t.stagename,a="marketing_attr_addstage_"+t.stagename,n=renderingUtils.createHTML({name:"div",attr:{class:"convFlowModule","data-zcqa":e,"data-stage":JSON.stringify(t),onclick:"sE(event);Attribution.openCreateStagewidget(this,'"+t.module+"', false);"}}),i=renderingUtils.createHTML({name:"div",attr:{class:"convFlowModuleContent"}});n.appendChild(i);var o=0==t.weightage?"convFlowModuleCount dN":"convFlowModuleCount",l=renderingUtils.createHTML({name:"span",attr:{id:"weightageSpan",class:o},child:[{name:"text",content:t.weightage+" %"}]});n.appendChild(l);var r=t.stagename.split(" ")[0],s=null!=Attribution.singular_module?[Attribution.singular_module[r]]:[t.module],c=I18n.getMsg(t.stagename,s);l=renderingUtils.createHTML({name:"span",attr:{id:"stageNameSpan",class:"convFlowModuleName dB color_6 f13 fs"},child:[{name:"text",content:c}]});if(i.appendChild(l),void 0!==t.module&&"Potentials"===t.module){var d=renderingUtils.createHTML({name:"span",attr:{class:"convFlowAdd","data-zcqa":a,onclick:"Attribution.openCreateStagewidget(this,'"+t.module+"', true);"}});n.appendChild(d);var u=renderingUtils.createHTML({name:"span",attr:{class:"svgIcons ico-plus-small convFlowAddIcon dIB op5"}});d.appendChild(u)}var v=renderingUtils.createHTML({name:"span",attr:{class:"convFlowRemainModule pA dN"}});n.appendChild(v);var p=renderingUtils.createHTML({name:"span",attr:{class:"convFlowVertLine pA"}});v.appendChild(p);var g=renderingUtils.createHTML({name:"div",attr:{class:"convFlowDropDiv dN"}});n.appendChild(g);var m=renderingUtils.createHTML({name:"span",attr:{class:"convFlowBubbleOuter"}});return g.appendChild(m),n},applydefaultstages:function(t,e){var a=$("#stageul");if(a.empty(),"TIME_DECAY"===t)(r=$("<li/>").text("Time decay - Credits will be calculated based on the theory")).appendTo(a),$("#weightage_div").hide();else if("W_SHAPE"===t||"U_SHAPE"===t){var n,i;void 0===e?(e=Attribution.defaultstage,n=JSON.parse(JSON.stringify(e)),i=Attribution.updateDefaultWeightage(t,n)):i=n=JSON.parse(JSON.stringify(e));for(var o=i.length,l=0;l<o;l++){var r=Attribution.constructStage(i[l]);a.append(r)}$("#weightage_div").removeClass("dN")}},updateDefaultWeightage:function(t,e){var a=e.length;switch(t){case"FIRST_TOUCH":for(var n=0;n<a;n++)e[n].weightage=0==n?100:0;break;case"LAST_TOUCH":for(n=0;n<a;n++)e[n].weightage=3==n?100:0;break;case"U_SHAPE":for(n=0;n<a;n++)e[n].weightage=0==n||3==n?40:0;break;case"W_SHAPE":for(n=0;n<a;n++)e[n].weightage=0==n||2==n||3==n?30:0}return e},openCreateStagewidget:function(t,e,a){sE(event);var n=$(".convFlowShapesActive").attr("data-attr");void 0!==Attribution.confdetail&&void 0!==Attribution.confdetail.type&&Attribution.confdetail.type;if("LINEAR"!==n){var i;Attribution.addStagePositioning(t,a);var o,l,r=!1;$(t).closest(".convFlowAdd").addClass("convFlowAddActive");var s=$(t).attr("data-stage");s=void 0!==s?JSON.parse(s):s,!1===a&&(i=s.stagename,r=s.isdefault,o=s.weightage,l=s.defaultstagename),$("#modStageName").val(i),$("#modWeight").val(o),$("#isdefault").val(r),$("#module").val(e),$("#defaultstagename").val(l),!0===a||null!=r&&!0!==r?($("#convFlowStageSelectDiv").removeClass("dN"),$("#convAttrStageInputDiv").addClass("dN"),!0===a?($("#api_value").val("-None-"),Attribution.refreshPotentialStages()):(Attribution.deleteRemovePotentialStage(i),$("#api_value").val(i)),thirdPartyUtils.bindSelect2("#api_value")):$("#modStageInputName").prop("disabled",!0),Attribution.unbind("addstagebtn"),Attribution.unbind("convFlowStageDelete");var c=$("#addstagebtn"),d=$("#convFlowStageDelete");c.click((function(){!1===a?Attribution.addStage(t):Attribution.addStage()})),d.click((function(){Attribution.deleteStage(t)})),void 0!==n&&"LINEAR"===n&&thirdPartyUtils.bindSelect2("#modWeightType"),Attribution.showhideDeleteicon(t)}},unbind:function(t){$("#"+t).unbind("click")},getCriteriaEditorcalback:function(){var t=arguments[0],e=arguments[1],a=t.Attribution.fields;a.length>0?($("#criteriapartdiv").html(Handlebars.templates.AttributionCriteria(a)),void 0!==e&&($("#api_name").val(e[0].api_name),$("#api_value").val(e[0].value),thirdPartyUtils.bindSelect2("#api_value"))):Attribution.cancelStageDetails()},deleteStage:function(t){crmui.showPopup({id:"warning_to_delete",headerBg:!0}),Attribution.unbind("stageDeleteBtn"),$("#stageDeleteBtn").click((function(){if(void 0!==t){var e=JSON.parse($(t).attr("data-stage")),a=e.stagename;Attribution.deleteRemovePotentialStage(a),Attribution.repopulateStages();for(var n=$(t),i=n.index(),o=$(".convFlowModule").length,l=i+1;l<=o;l++)if(!$(".convFlowModule").eq(l).hasClass("convFlowModuleActive")){n=$(".convFlowModule").eq(l);break}if(null==n||0==n.length)for(l=i;l>0;l--)if(!$(".convFlowModule").eq(l).hasClass("convFlowModuleActive")){n=$(".convFlowModule").eq(l);break}if(void 0!==n&&n.length>0){var r=void 0!==e.weightage&&0===e.weightage?"":e.weightage+" %";""===r?n.find("#weightageSpan").removeClass("dN convFlowModuleCount").text(""):n.find("#weightageSpan").text(r).removeClass("dN");var s=JSON.parse(n.attr("data-stage"));s.weightage=e.weightage,n.attr("data-stage",JSON.stringify(s))}$(t).remove(),Attribution.cancelStageDetails(),crmui.hidePopup("warning_to_delete");var c=$(".convFlowShapesActive").attr("data-attr");$("#convFlowStageDiv").addClass("dN").removeClass("dIB"),Attribution.svgWidthHeightUpdate(),Attribution.drawShapes(c),Attribution.generateAndInitializeShape(c),Attribution.drawTopLine(),setTimeout((function(){$(".convFlowModActive").removeClass("convFlowModActive")}),Attribution.timer),Attribution.deleteRemovePotentialStage(a),Attribution.isPageModified=!0}}))}};Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Attribution.addStage=function(t){var e,a=$("#modWeight"),n=$("#modStageName"),i=$("#isdefault"),o=$("#api_value");if("true"===i.val()||"-None-"!==o.val())if(isNaN(a.val())||""===a.val()||parseInt(a.val())<=0)crmui.showMsgBand("error",I18n.getMsg("crm.attribution.noproperweightage"),4e3);else if(parseInt(a.val())>99)crmui.showMsgBand("error",I18n.getMsg("crm.attribution.error.exceedweightage"),4e3);else if(Number.isInteger(Number(a.val())))if(""===a.val()&&a.val(0),""!==n.val()){var l=[],r="";!1===i.val()||"false"===i.val()?(l.push({api_name:$("#api_name").val(),comparator:"equal",value:o.val()}),r=o.val()):r=$("#modStageInputName").val(),e={stagename:r,module:$("#module").val(),weightage:parseInt(a.val()),isdefault:"true"===i.val(),defaultstagename:$("#defaultstagename").val(),criteria:l};var s,c=$(".convFlowAddActive");null!=t&&(c=$(".convFlowEditModActive"),s=$(t).attr("data-stage"),s=JSON.parse(s));for(var d,u,v=c.closest(".convFlowModule"),p=c.closest(".convFlowModule").index(),g=$(".convFlowModule").length,m=p+1;m<=g;m++)if($(".convFlowModule").eq(m).hasClass("convFlowModuleActive")){d=$(".convFlowModule").eq(m);break}if(null==d||0==d.length)for(m=p;m>0;m--)if($(".convFlowModule").eq(m).hasClass("convFlowModuleActive")){d=$(".convFlowModule").eq(m);break}if(void 0===s&&parseInt(a.val())>0||void 0!==s&&parseInt(s.weightage)<1&&parseInt(a.val())>0)if(d.hasClass("convFlowModuleActive")&&(u=d),void 0!==u&&u.length>0){u.find("#weightageSpan").text("").addClass("dN");var h=JSON.parse(u.attr("data-stage"));h.weightage=0,u.attr("data-stage",JSON.stringify(h))}var b=$(".convFlowShapesActive");if(void 0===t){var f=b.attr("data-attr"),w=Attribution.constructStage(e);v.after(w),$("#stageul").attr("data-newelement","1"),Attribution.widthUpdateAfterAdd(),n.val(""),a.val(""),c.removeClass("convFlowAddActive"),$("#convFlowStageDiv").addClass("dN").removeClass("dIB"),Attribution.svgWidthHeightUpdate(),Attribution.drawShapes(f),Attribution.generateAndInitializeShape(f),Attribution.drawTopLine(),setTimeout((function(){$(".convFlowModActive").removeClass("convFlowModActive")}),Attribution.timer),Attribution.addRemovePotentialStage(r)}else{f=b.attr("data-attr");var A=$(t),S=A.attr("data-stage"),F=JSON.parse(S);void 0!==F&&null!=F.stageid&&""!==F.stageid&&(e.stageid=F.stageid),A.attr("data-stage",JSON.stringify(e));var _=A.find("#weightageSpan");_.text(a.val()+" %"),A.find("#stageNameSpan").text(r),parseInt(F.weightage)<1&&parseInt(a.val())>0&&(_.removeClass("dN"),$("#stageul").attr("data-newelement","1"),Attribution.widthUpdateAfterAdd(),Attribution.svgWidthHeightUpdate(),Attribution.drawShapes(f),Attribution.generateAndInitializeShape(f),Attribution.drawTopLine())}Attribution.setRemainValue(b.attr("data-attr")),Attribution.cancelStageDetails(),Attribution.isPageModified=!0}else crmui.showMsgBand("error","Please specify the stage name",4e3);else crmui.showMsgBand("error",I18n.getMsg("crm.attribution.noproperweightage"),4e3);else crmui.showMsgBand("error",I18n.getMsg("crm.attribution.stageempty"),4e3)},Attribution.enableChangeStatus=function(){Attribution.isPageModified=!0},Attribution.showPopupIfChanged=function(t){var e="stayonPageConfirmBox",a=$("#"+e);freezeBackground(),mailsetCenter(e),a.find(".leavePage").off("click").click((function(){$("#"+e).hide(),removeFreezeLayer(),Attribution.isPageModified=!1,Attribution.showStages(t),void 0!==Attribution.confdetail&&void 0!==Attribution.confdetail.type||Attribution.emptyRemovePotentialStage()})),a.find(".stayPage").off("click").click((function(){$("#"+e).hide(),removeFreezeLayer()})),a.focus()},Attribution.emptyRemovePotentialStage=function(){Attribution.remove_potential_stages=[],Attribution.repopulateStages()},Attribution.filterfromArray=function(t,e){var a=[];return $.each(t,(function(t,n){n!==e&&a.push(n)})),a},Attribution.deleteRemovePotentialStage=function(t){Attribution.remove_potential_stages=Attribution.filterfromArray(Attribution.remove_potential_stages,t),Attribution.repopulateStages()},Attribution.addRemovePotentialStage=function(t){Attribution.remove_potential_stages.push(t),Attribution.repopulateStages()},Attribution.repopulateStages=function(){if(void 0!==Attribution.potential_stages_backup){var t=$("#api_value");t.html(""),$.each(Attribution.potential_stages_backup,(function(e,a){$.inArray(a,Attribution.remove_potential_stages)<0&&t.append('<option value="'+a+'">'+I18n.getMsg(a)+"</option>")}))}thirdPartyUtils.bindSelect2("#api_value")},Attribution.setRemainValue=function(t){var e=0;if($("#stageul .convFlowModule").each((function(){var t=$(this).attr("data-stage");void 0!==t&&(t=JSON.parse(t),e+=parseInt(t.weightage))})),void 0!==t&&("U_SHAPE"===t||"W_SHAPE"===t)){var a=100-e>0?100-e:0;$("#convFlowRemainValue").text(a+" %")}},Attribution.showhideDeleteicon=function(t){var e=void 0!==t&&void 0!==$(t).attr("data-stage")?$(t).attr("data-stage"):"[]";!0===(e=JSON.parse(e)).isdefault||e.length<1?$("#convFlowStageDelete").addClass("dN"):$("#convFlowStageDelete").removeClass("dN")},Attribution.clonetype=function(){$("#modWeightageCriteria").find("tbody>tr select.select2-hidden-accessible").select2("destroy");var t=$("#modWeightageCriteria").find("tbody>tr").last().clone(!0),e=t.attr("data-index"),a=t.find("#modPatternNum"),n=t.find("#modWeightType"),i=t.find("#weightx");$(t).addClass("clonedNode"),t.find("#removelink").show(),n.val(""),i.val("1"),a.val(parseInt(e)+1),t.insertAfter("#modWeightageCriteria tbody>tr:last"),t.attr("data-index",parseInt(e)+1),thirdPartyUtils.bindSelect2($(".modWeightType,.convFlowWeightx")),$(".clonedNode").removeClass("clonedNode")},Attribution.deleteRow=function(t){var e=$(t).closest("tbody>tr"),a=!1;$("#modWeightageCriteria").find("tbody>tr").each((function(){if(!0===a){var t=$(this).attr("data-index");$(this).find("#modPatternNum").val(parseInt(t)-1),$(this).attr("data-index",parseInt(t)-1)}$(this).attr("data-index")===e.attr("data-index")&&(a=!0)})),e.remove(),Attribution.isPageModified=!0},Attribution.addweightinselect=function(t){Attribution.isPageModified=!0,$(t).closest("tr").find(".modWeightType").attr("data-weight",$(t).val())},Attribution.validateNoofWeightage=function(t,e){var a=0,n=!0;return e.each((function(){var e=$(this).attr("data-stage");if(void 0!==e){if(e=JSON.parse(e),0!==parseInt(e.weightage)&&++a,a>2&&"U_SHAPE"===t)return crmui.showMsgBand("warning",I18n.getMsg("crm.attribution.error.u_shape.moreweightage"),4e3),n=!1,!1;if(a>3&&"W_SHAPE"===t)return n=!1,crmui.showMsgBand("error",I18n.getMsg("crm.attribution.error.w_shape.moreweightage"),4e3),!1}})),n},Attribution.validate=function(){var t=$(".convFlowShapesActive").attr("data-attr"),e=!0,a=$("#stageul").find(".convFlowModule");switch(t){case"FIRST_TOUCH":case"LAST_TOUCH":case"LINEAR":case"TIME_DECAY":break;case"U_SHAPE":case"W_SHAPE":e=Attribution.validateNoofWeightage(t,a)}if(("W_SHAPE"===t||"U_SHAPE"===t)&&!0===e){var n=0;if(a.each((function(){var t=$(this).attr("data-stage");void 0!==t&&(t=JSON.parse(t),n+=parseInt(t.weightage))})),n>100)return crmui.showMsgBand("error",I18n.getMsg("crm.attribution.error.exceedweightage"),4e3),!1}var i=jQuery.parseJSON(Attribution.getIncludeJson()),o=[];if(!0===e&&$(i).each((function(t,a){a=JSON.parse(a);var n=$.inArray(a.type,o);if(o.push(a.type),n>-1)return crmui.showMsgBand("error",I18n.getMsg("crm.attribution.error.duplicatetype",crmTab.getDisplayName("Campaigns",!0)),4e3),e=!1,!1})),!0===e){var l=jQuery.parseJSON(Attribution.getExcludeJson());$(i).each((function(t,a){if(a=JSON.parse(a),$.inArray(a.type,l)>-1)return crmui.showMsgBand("error",I18n.getMsg("crm.attribution.error.weightforexcludecampaign",crmTab.getDisplayName("Campaigns",!0)),4e3),e=!1,!1}))}return e},Attribution.deactivateconfirmation=function(){Attribution.unbind("warningSaveBtn"),$("#warningSaveBtn").click((function(){Attribution.deleteconf()}));var t=I18n.getMsg("crm.setup.attribution.warning.deactivate",crmTab.getDisplayName("Campaigns",!1));$(".pp-content").text(t),crmui.showPopup({id:"warning_to_save",headerBg:!0})},Attribution.saveconfirmation=function(){var t=$(".convFlowShapesActive").attr("data-attr");if(Attribution.isPageModified||!Attribution.confdetail||Attribution.confdetail.type!==t){if(Attribution.validate())if(Attribution.unbind("warningSaveBtn"),$("#warningSaveBtn").click((function(){Attribution.save()})),void 0!==Attribution.confdetail&&void 0!==Attribution.confdetail.type){var e=[];e.push($(".convFlowShapesActive").attr("data-attr").replace(/_/g," "));var a=I18n.getMsg("crm.setup.attribution.warning.update",[e,crmTab.getDisplayName("Campaigns",!1)]);$(".pp-content").text(a),crmui.showPopup({id:"warning_to_save",headerBg:!0})}else Attribution.save()}else crmui.showMsgBand("error",I18n.getMsg("crm.alert.no.changes"),4e3)},Attribution.save=function(){if(Attribution.validate()){var t={stages:Attribution.getStages(),type:$(".convFlowShapesActive").attr("data-attr"),exclude_campaign_type:Attribution.getExcludeJson(),weightage_campaign_type:Attribution.getIncludeJson()},e=JSON.stringify(t);Attribution.connect(Attribution.actionurl,"Attribution.savecalback",e,"POST")}},Attribution.savecalback=function(){Attribution.refresh_weightagepop=!1;var t=arguments[0];commonUtils.showHideLoadingDiv(!1),Attribution.isPageModified=!1;var e=t.code;if(crmui.hidePopup("warning_to_save"),null!=e&&"TOO_MANY_REQUESTS"===e)return crmui.showMsgBand("error",I18n.getMsg("crm.setup.attribution."+e),4e3),void(Attribution.isPageModified=!0);if(null!=e&&"LIMIT_EXCEEDED"===e)return crmui.showMsgBand("error",I18n.getMsg("crm.limit.reached"),4e3),void(Attribution.isPageModified=!0);var a=t.Attribution.code;if("SUCCESS"===a){Attribution.showSetup();var n=I18n.getMsg("crm.license.success");crmui.showMsgBand("success",n,1e3)}},Attribution.deleteconf=function(){Attribution.connect(Attribution.actionurl,"Attribution.deleteconfcalback",{},"DELETE")},Attribution.refreshWeightage=function(){$("#modWeightageCriteria").find("tbody>tr").each((function(){var t=$(this);if("1"!==t.attr("data-index"))t.remove();else{var e=t.find(".modWeightType");e.val("").attr("data-weight",1),e.find('select[name="weightx"]').val("")}}))},Attribution.deleteconfcalback=function(){var t=arguments[0];Attribution.refreshWeightage();var e=t.Attribution.code;"SUCCESS"===e&&(Attribution.showSetup(),crmui.showMsgBand("success",I18n.getMsg("crm.label.deleted.successfully"),1e3)),Attribution.confdetail=[],commonUtils.showHideLoadingDiv(!1),crmui.hidePopup("warning_to_save"),$("#convFlowDeactivateBtn").addClass("dN")},Attribution.getExcludeJson=function(){var t=[];return"LINEAR"===$(".convFlowShapesActive").attr("data-attr")&&$("#exclude_source").find(":selected").map((function(){t.push($(this).val())})),JSON.stringify(Attribution.removeDuplicate(t))},Attribution.removeDuplicate=function(t){var e=[];return $.each(t,(function(t,a){-1==$.inArray(a,e)&&e.push(a)})),e},Attribution.getIncludeJson=function(){var t=[];return"LINEAR"===$(".convFlowShapesActive").attr("data-attr")&&$("#modWeightageCriteria").find('select[name="modWeightType"]').each((function(){""!==$(this).val()&&""!==$(this).attr("data-weight")&&t.push('{"type":"'+$(this).val()+'","weightage":"'+$(this).attr("data-weight")+'"}')})),JSON.stringify(t)},Attribution.getStages=function(){var t=[],e=0;return $("#stageul").find(".convFlowModule").each((function(){var a=$(this).attr("data-stage");void 0!==a&&((a=JSON.parse(a)).order=++e,t.push(a))})),t},Attribution.displayAttributionDiv=function(t,e){Attribution.connect(Attribution.moduleurl+"/getattribution?module="+e+"&id="+t,"Attribution.displayAttributionDivcalback",{},"GET",e)},Attribution.displayAttributionDivcalback=function(){var t=arguments[0];t.keys=["crm.label.CampaignName","Type","crm.label.CampaignStartDate","crm.label.CampaignEndDate","Actual Cost","crm.adword.tab.revenue"],$("#attribution").html(Handlebars.templates.AttributionDetails(t)).removeClass("dN")},Attribution.widthUpdate=function(){var t=$("#stageul"),e=t.find(".convFlowModule"),a=e.length,n=renderingUtils.windowWidth-$("#convFlowRight").outerWidth(),i=e.eq(1).outerWidth(!0),o=Attribution.currentZoomVal(),l=i*a;$("#convFlowLeft").css("width",n),o<1?Attribution.widthUpdateAfterAdd():t.css("width",l)},Attribution.widthUpdateAfterAdd=function(){var t=$("#stageul"),e=Attribution.currentZoomVal(),a=t.outerWidth();if(1==t.attr("data-newelement"))var n=$(".convFlowModule").eq(1).outerWidth(!0)/e;else n=0;t.attr("data-newelement","0");var i=a/e;t.css({width:i+n})},Attribution.selectTab=function(t,e){t=$(t);if($(".convFlowTabs").removeClass("convFlowTabsActive"),$(".convFlowShapeStage").addClass("dN"),t.addClass("convFlowTabsActive"),$("#convFlow"+e).removeClass("dN"),"ChooseShape"==e){$(".convFlowAddActive").removeClass("convFlowAddActive"),$("#convFlowStageNameField, #convFlowStagePerField").val("");var a=$("#convFlowStageDiv");a.addClass("dN"),a.removeClass("dIB")}},Attribution.drawBubble=function(){$("#stageul").find(".convFlowModule").each((function(){var t=$(this),e=t.attr("data-stage");void 0!==e&&(e=JSON.parse(e)).weightage>0&&t.addClass("convFlowModuleActive")}))},Attribution.drawShapes=function(t){$(".convFlowModuleActive").removeClass("convFlowModuleActive"),$(".convFlowBubble").remove(),"U_SHAPE"==t?(Attribution.drawBubble(),$(".convFlowModuleActive").append("<span class='convFlowBubble'></span>"),Attribution.generateShapes("U_SHAPE"),Attribution.dragInitialize("U_SHAPE")):"W_SHAPE"==t?(Attribution.drawBubble(),$(".convFlowModuleActive").append("<span class='convFlowBubble'></span>"),Attribution.generateShapes("W_SHAPE"),Attribution.dragInitialize("W_SHAPE")):$("#convAttrShapeSvgId").html("")},Attribution.drawTopLine=function(){var t=$("#convFlowBottomLine"),e=$("#stageul").find(".convFlowBubble"),a=e.offset().top,n=e.outerWidth()/2,i=e.eq(0).offset().left+n,o=e.last().offset().left+n,l=$("#convFlowLeft").scrollTop(),r=Attribution.getScrollLeftVal("convFlowLeft");Crm.userDetails.RTL_ENABLED?t.css({right:renderingUtils.windowWidth-i+r,width:i-o}):t.css({left:i+r,width:o-i}),t.css({top:a+130+l}).removeClass("dN")},Attribution.dragInitialize=function(t){var e={x:0,y:0,zoomVal:1},a=$("#convFlowLeft"),n=$(".convFlowDropDiv"),i=$("#convFlowBottomLine"),o=$("#stageul");$(".convFlowBubble").draggable({refreshPositions:!0,containment:".convFlowLeftModules",axis:"x",cursor:"-webkit-grabbing",start:function(t){e.x=t.clientX,e.y=t.clientY,e.zoomVal=Attribution.currentZoomVal()},revert:function(){Attribution.revertToPosition(t)},drag:function(l,r){o.css("overflow-x","hidden");var s=r.originalPosition;r.position={left:(l.clientX-e.x+s.left)/e.zoomVal},a.addClass("convFlowCursor"),clearTimeout(Attribution.timer),Attribution.resetHighlight(),Attribution.cancelStageDetails(),$(this).closest(".convFlowModule").addClass("convFlowModuleDrag"),$(".convFlowBubble").addClass("convFlowBubbleActive"),n.removeClass("dN"),$("#convAttrShape").addClass("convAttrShapeActive"),Attribution.generateShapes(t),$("path.convFlowLine").addClass("dN"),i.addClass("dN"),Attribution.isPageModified=!0},stop:function(){o.css("overflow-x",""),a.removeClass("convFlowCursor")}}),n.droppable({cursor:"-webkit-grab",drop:function(){o.css("overflow-x","");var e=$(this).closest(".convFlowModule"),a=$(".convFlowModuleDrag"),l=a.find("#weightageSpan");if(e.find(".convFlowBubble").length)o.css("overflow-x",""),Attribution.revertToPosition(t);else{var r=JSON.parse(a.attr("data-stage")),s=r.weightage;r.weightage=0,a.attr("data-stage",JSON.stringify(r)),a.find(".convFlowBubble").remove(),e.addClass("convFlowModuleActive");var c=l.text();l.addClass("dN").text("");var d=e;d.find("#weightageSpan").removeClass("dN").text(c);var u=JSON.parse(d.attr("data-stage"));u.weightage=s,d.attr("data-stage",JSON.stringify(u)),e.append('<span class="convFlowBubble convFlowBubbleActive"></span>'),a.removeClass("convFlowModuleActive convFlowModuleDrag"),n.addClass("dN"),$(".convFlowModuleActive").addClass("convFlowModActive"),setTimeout((function(){Attribution.resetHighlight()}),Attribution.timer),Attribution.generateAndInitializeShape(t),$(".convFlowModule.convFlowModuleActive").find(".convFlowRemainModule").removeClass("dN"),$("path.convFlowLine").removeClass("dN"),i.removeClass("dN"),Attribution.drawTopLine()}}})},Attribution.revertToPosition=function(t){$(".convFlowModuleDrag").find(".convFlowBubble").removeAttr("style"),$(".convFlowModule").removeClass("convFlowModuleDrag"),$(".convFlowBubble").removeClass("convFlowBubbleActive"),$("#convAttrShape").removeClass("convAttrShapeActive"),$(".convFlowDropDiv").addClass("dN"),$("path.convFlowLine, #convFlowBottomLine").removeClass("dN"),Attribution.generateAndInitializeShape(t)},Attribution.resetHighlight=function(){$(".convFlowModuleActive").removeClass("convFlowModActive"),$("#convAttrShape").removeClass("convAttrShapeActive"),$(".convFlowBubble").removeClass("convFlowBubbleActive")},Attribution.getCoords=function(){var t=[];return $(".convFlowBubble").each((function(){var e=$(this),a=e.offset(),n=a.top+e.outerHeight()/2,i=a.left+e.outerWidth()/2;t.push(Math.round(i),Math.round(n))})),t},Attribution.cancelStageDetails=function(){var t=$(".convFlowEditModActive"),e=void 0!==t&&void 0!==$(t).attr("data-stage")?$(t).attr("data-stage"):"[]";if(e){var a=(e=JSON.parse(e)).isdefault,n=e.stagename;!a&&n&&Attribution.remove_potential_stages.push(n)}$(".convFlowModule").removeClass("convFlowEditModActive"),$(".convFlowAdd").removeClass("convFlowAddActive"),$("#convFlowStageNameField, #convFlowStagePerField").val(""),$("#convFlowStageSelectDiv").removeClass("dN"),$("#convAttrStageInputDiv, #convFlowStageName").addClass("dN")},Attribution.svgWidthHeightUpdate=function(){var t=parseInt($("#stageul").outerWidth(!0))-7,e=$("#convFlowAttribution").outerHeight();$("#convAttrShapeSvgDiv").css({width:t,height:e})},Attribution.getScrollLeftVal=function(t){var e=null,a=document.getElementById(t);return e=(e=Crm.userDetails.RTL_ENABLED?a.scrollWidth-(a.scrollLeft+$("#"+t).innerWidth()):$("#"+t).scrollLeft())>0?e:0,Math.abs(parseInt(e))},Attribution.generateShapes=function(t){var e,a,n,i,o="",l=null,r=null,s=null,c=null,d=$("#tabLayer"),u=$("#convFlowLeft").scrollTop(),v=$("#convAttrShapeSvgDiv").offset().left,p=d.offset().top+d.outerHeight();if(e=Attribution.getCoords(),Crm.userDetails.RTL_ENABLED?(l=e[2]-v,r=e[0]-v):(l=e[0]-v,r=e[2]-v),a=e[1]+u-p,n=e[3]+u-p,i=e[1]+u+156,"U_SHAPE"===t)o=(o=(o='<path class="convFlowSvg" d="M'+l+" "+a+" C"+(l+90)+" "+(s=e[1]+130)+" "+(r-90)+" "+s+" "+r+" "+n+'"/>')+'<path class="convFlowLine" d="M'+l+" "+a+" L"+l+" "+i+'"/>')+'<path class="convFlowLine" d="M'+r+" "+n+" L"+r+" "+i+'"/>';else if("W_SHAPE"===t){Crm.userDetails.RTL_ENABLED?(l=e[4]-v,r=e[2]-v,c=e[0]-v):(l=e[0]-v,r=e[2]-v,c=e[4]-v);var g=(l+r)/2,m=(r+c)/2,h=a+130,b=n+130,f=e[5]+u-p;o=(o=(o='<path class="convFlowSvg" d="M'+l+" "+a+" L"+g+" "+h+" "+r+" "+n+" "+m+" "+b+" "+c+" "+f+'"/>')+'<path class="convFlowLine" d="M'+l+" "+a+" L"+l+" "+i+'"/>')+'<path class="convFlowLine" d="M'+c+" "+f+" L"+c+" "+i+'"/>'}$("#convAttrShapeSvgDiv").html('<svg id="convAttrShapeSvgId" class="convAttrShapeSvg">'+o+"</svg>")},Attribution.generateLineShape=function(){var t,e,a,n=null,i=null,o="",l=$("#convFlowLeft"),r=$(".convFlowBarDiv"),s=l.scrollTop(),c=r.eq(0).find(".convFlowBarBubbleOuter").offset(),d=r.eq(3).find(".convFlowBarBubbleOuter").offset(),u=$(".convFlowBarBubbleOuter").outerWidth()/2,v=$("#convAttrRemainShapeSvgDiv").offset().left;Crm.userDetails.RTL_ENABLED?(n=d.left-v+u,i=c.left-v+u):(n=c.left-v+u,i=d.left-v+u),t=c.top+s-40,e=d.top+s-40,o=(o=o+'<path class="convFlowLine" d="M'+n+" "+t+" L"+n+" "+(a=c.top+s+120)+'"/>')+'<path class="convFlowLine" d="M'+i+" "+e+" L"+i+" "+a+'"/>',$("#convAttrRemainShapeSvgDiv").html('<svg id="convAttrRemainShapeSvg" class="convAttrRemainShapeSvg">'+o+"</svg>")},Attribution.updateShapesAfterAddStage=function(t){"U_SHAPE"===t||"W_SHAPE"===t?Attribution.generateAndInitializeShape(t):$("#convAttrShapeSvgId").html("")},Attribution.generateAndInitializeShape=function(t){Attribution.generateShapes(t),Attribution.dragInitialize(t)},Attribution.addStagePositioning=function(t,e){t=$(t);var a=$("#convFlowStageName"),n=$("#convFlowStageNameField"),i=$("#convFlowLeft"),o=$("#convFlowStageSelectDiv"),l=$("#convAttrStageInputDiv"),r=null,s=crmui.getOffset(t),c=t.outerHeight(),d=t.outerWidth()/2,u=a.outerWidth()/2,v=Attribution.getScrollLeftVal("convFlowLeft"),p=i.scrollTop(),g=s.top+p+c-44;Crm.userDetails.RTL_ENABLED?((r=renderingUtils.windowWidth-s.left+(v-d-u))<0&&(r=10),a.css("right",r)):((r=s.left+(v-u+d))<0&&(r=10),a.css("left",r)),$(".convFlowModule").removeClass("convFlowEditModActive"),$(".convFlowAdd").removeClass("convFlowAddActive"),0==e?(o.addClass("dN"),l.removeClass("dN"),t.addClass("convFlowEditModActive"),$("#modStageInputName").val(t.find("#stageNameSpan").text()),$("#addstagebtn").text(I18n.getMsg("crm.button.save")),$("#convAttr_title").text(I18n.getMsg("crm.link.edit.stage"))):(o.removeClass("dN"),l.addClass("dN"),t.addClass("convFlowAddActive"),$("#addstagebtn").text(I18n.getMsg("crm.button.add")),$("#convAttr_title").text(I18n.getMsg("crm.link.add.stage"))),a.css({top:g}).removeClass("dN"),$("#convFlowStagePerField").val(""),n.val("").focus()},Attribution.renderRevenueComponent=function(t){var e=t.Attribution;$L("detailview-attribution-campaign")[0].setData("attributionData",e)},function(){var t=Handlebars.template,e=Handlebars.templates=Handlebars.templates||{};e.AttributionCampaignDetails=t({1:function(t,e,a,n,i){var o,l=null!=e?e:{},r=t.escapeExpression,s=t.lambda;return' <div class="pp-content p0"> <span class="ico-close op5 pA right30 svgIcons top20 op5 cP" onclick="crmui.hidePopup(\'attribution_campaign_popup\');"></span> <span class="dB color_1 mB20 bold f17 pL30 pR30 mT20" data-zcqa="marketing_attr_help_to_earn">'+r(a.getI18n.call(l,"crm.attribution.dealshelptoearn",{name:"getI18n",hash:{},data:i}))+" "+r(s(null!=(o=null!=e?e.module_name:e)?o.Potentials:o,e))+'</span> <span class="dN color_6 mB15 mL30">'+r(a.getI18n.call(l,"crm.attribution.noofdeals",a.getPluralModuleLabel.call(l,"Deals",{name:"getPluralModuleLabel",hash:{},data:i}),{name:"getI18n",hash:{},data:i}))+': <span class="bold color_1">'+r(s(null!=e?e.size:e,e))+'</span></span> <div class="pL30 pR30"> <table class="marAttrTableList newtable m0" width="100%"> <thead> <tr> <th class=\'first_td\'>'+r(a.getI18n.call(l,"crm.label.CampaignName",null!=(o=null!=e?e.module_name:e)?o.Potentials:o,{name:"getI18n",hash:{},data:i}))+"</th> <th>"+r(a.getI18n.call(l,"Stage",{name:"getI18n",hash:{},data:i}))+"</th> <th>"+r(a.getI18n.call(l,"Amount",{name:"getI18n",hash:{},data:i}))+"</th> <th>"+r(a.getI18n.call(l,"crm.attribution.attributedamt",{name:"getI18n",hash:{},data:i}))+"</th> <th>"+r(a.getI18n.call(l,"Closing Date",{name:"getI18n",hash:{},data:i}))+"</th> </tr> </thead> <tbody> "+(null!=(o=a.each.call(l,null!=e?e.Attribution:e,{name:"each",hash:{},fn:t.program(2,i,0),inverse:t.noop,data:i}))?o:"")+" </tbody> </table> </div> </div> "},2:function(t,e,a,n,i){var o,l=null!=e?e:{},r=t.escapeExpression,s=t.lambda;return" <tr> <td class='first_td'><a href=\""+r(a.getCrmBasePath.call(l,{name:"getCrmBasePath",hash:{},data:i}))+"/tab/Potentials/"+r(s(null!=e?e.potential_id:e,e))+'" target="_blank" data-zcqa="marketing_attr_'+r(s(null!=e?e.potential_name:e,e))+'"> '+r(s(null!=e?e.potential_name:e,e))+"</a></td> <td>"+r(s(null!=e?e.potential_stage:e,e))+"</td> <td>"+r(a.formatCurrencyValue.call(l,null!=e?e.total_potential_amount:e,null!=e?e.currency_iso_code:e,{name:"formatCurrencyValue",hash:{},data:i}))+"</td> <td> "+(null!=(o=a.if.call(l,null!=e?e.amount:e,{name:"if",hash:{},fn:t.program(3,i,0),inverse:t.program(5,i,0),data:i}))?o:"")+" </td> <td> "+(null!=(o=a.if.call(l,null!=e?e.potentialClosingDate:e,{name:"if",hash:{},fn:t.program(7,i,0),inverse:t.program(5,i,0),data:i}))?o:"")+" </td> </tr> "},3:function(t,e,a,n,i){return" "+t.escapeExpression(a.formatCurrencyValue.call(null!=e?e:{},null!=e?e.amount:e,null!=e?e.currency_iso_code:e,{name:"formatCurrencyValue",hash:{},data:i}))+" "},5:function(t,e,a,n,i){return" &nbsp; "},7:function(t,e,a,n,i){return" "+t.escapeExpression(t.lambda(null!=e?e.potentialClosingDate:e,e))+" "},compiler:[7,">= 4.0.0"],main:function(t,e,a,n,i){var o;return' <div id="attribution_campaign_popup" class="newpopup w600 is-scroll ppTop dN"> '+(null!=(o=a.if.call(null!=e?e:{},null!=e?e.Attribution:e,{name:"if",hash:{},fn:t.program(1,i,0),inverse:t.noop,data:i}))?o:"")+" </div> "},useData:!0}),e.AttributionCampaignRevenue=t({1:function(t,e,a,n,i){return' <span class="svgIcons dIB vmiddle mL3 marAttrGreenArrow" id="roi_icon"></span> '},3:function(t,e,a,n,i){var o;return" "+(null!=(o=a.ifEquals.call(null!=e?e:{},null!=e?e.closed_roi:e,"NA",{name:"ifEquals",hash:{},fn:t.program(4,i,0),inverse:t.program(6,i,0),data:i}))?o:"")+" "},4:function(t,e,a,n,i){return' <span class="svgIcons dIB vmiddle mL3 id="roi_icon"></span> '},6:function(t,e,a,n,i){var o;return' <span class="svgIcons dIB vmiddle mL3 '+(null!=(o=a.ifNotEquals.call(null!=e?e:{},null!=e?e.closed_roi:e,"0.0",{name:"ifNotEquals",hash:{},fn:t.program(7,i,0),inverse:t.noop,data:i}))?o:"")+'" id="roi_icon"></span> '},7:function(t,e,a,n,i){return" marAttrRedArrow"},compiler:[7,">= 4.0.0"],main:function(t,e,a,n,i){var o,l=null!=e?e:{},r=t.escapeExpression,s=t.lambda;return'<style> .marAttrGreenArrow {\n    background-position: -6px -2218px;\n    vertical-align: middle;\n}\n.marAttrRedArrow {\n    background-position: -33px -2218px;\n}\n.marAttrGreenArrow, .marAttrRedArrow {\n    width: 20px;\n    height: 20px;\n} </style> <div class="dIB vam pR20"> <div class="color_9 f13 mB3 zCamSecondaryColor">'+r(a.getI18n.call(l,"Revenue",{name:"getI18n",hash:{},data:i}))+'</div> <div id="camp_won_sum" class="f20 zCamPrimaryColor">'+r(a.formatCurrencyValueWithZero.call(l,null!=e?e.won_sum:e,null!=e?e.currency_iso_code:e,{name:"formatCurrencyValueWithZero",hash:{},data:i}))+'</div> <span id="camp_won_count" class="color_9 f12 zCamSecondaryColor">'+r(a.getI18n.call(l,"crm.num.from.closed.deals",null!=e?e.won_count:e,a.getModuleLabel.call(l,"Potentials",{name:"getModuleLabel",hash:{},data:i}),{name:"getI18n",hash:{},data:i}))+'</span> </div> <span class="svgIconsImg camPlusIcon vam zCamNewDetPlusIcon dN" id="pipeline_span"></span> <div class="vam pR30 dN" id="pipeline_div"> <div class="color_9 mB3 f12 zCamSecondaryColor">'+r(a.getI18n.call(l,"In Pipeline",{name:"getI18n",hash:{},data:i}))+'</div> <div id="camp_open_sum" class="f20 zCamPrimaryColor">'+r(a.formatCurrencyValueWithZero.call(l,null!=e?e.open_sum:e,null!=e?e.currency_iso_code:e,{name:"formatCurrencyValueWithZero",hash:{},data:i}))+'</div> <span id="camp_open_count" class="color_9 f12 zCamSecondaryColor">'+r(a.getI18n.call(l,"crm.num.from.open.deals",null!=e?e.open_count:e,a.getModuleLabel.call(l,"Potentials",{name:"getModuleLabel",hash:{},data:i}),{name:"getI18n",hash:{},data:i}))+'</span> </div> <div class="dIB vam mR30 pL20 leftSeparation" data-zcqa="marketing_attr_ROI"> <div class="color_9 mB3 f12 zCamSecondaryColor">ROI</div> <div> <span id="open_camp_roi" class="dIB vmiddle f18 hide zCamPrimaryColor">'+r(s(null!=e?e.open_roi:e,e))+'</span> <span id="closed_camp_roi" class="dIB vmiddle f18 zCamPrimaryColor">'+r(s(null!=e?e.closed_roi:e,e))+"</span> "+(null!=(o=a.if.call(l,null!=e?e.staus_arrow:e,{name:"if",hash:{},fn:t.program(1,i,0),inverse:t.program(3,i,0),data:i}))?o:"")+" </div> </div> "},useData:!0}),e.AttributionCli=t({1:function(t,e,a,n,i){var o=t.lambda,l=t.escapeExpression,r=null!=e?e:{};return' <div class="convFlowShapeInner mB15" onclick="Attribution.selectShapePage(this);" data-attr="'+l(o(e,e))+'" data-zcqa="marketing_attr_span_'+l(o(e,e))+'"> <div class="convFlowShapes vam"> <span class="convFlowShapeSvg convFlow_'+l(o(e,e))+' convFlowShapePos"></span> </div> <div class="convFlowDescWidth dIB vam"> <span class="dB mB10 bld f15">'+l(a.getI18n.call(r,a.concat.call(r,"crm.setup.attribution.",e,".title",{name:"concat",hash:{},data:i}),{name:"getI18n",hash:{},data:i}))+'</span> <p class="color_3 fs f13">'+l(a.getI18n.call(r,a.concat.call(r,"crm.setup.attribution.",e,".defn",{name:"concat",hash:{},data:i}),{name:"getI18n",hash:{},data:i}))+"</p> </div> </div> "},3:function(t,e,a,n,i){var o;return" "+(null!=(o=a.each.call(null!=e?e:{},null!=e?e.pick_list_values:e,{name:"each",hash:{},fn:t.program(4,i,0),inverse:t.noop,data:i}))?o:"")+" "},4:function(t,e,a,n,i){var o=t.lambda,l=t.escapeExpression;return' <option value="'+l(o(e,e))+'">'+l(o(e,e))+"</option> "},6:function(t,e,a,n,i){var o=null!=e?e:{},l=t.escapeExpression;return' <button class="newgraybtn" data-zcqa="marketing_attr_cancl_butn" onclick="Attribution.goToSetup();">'+l(a.getI18n.call(o,"crm.button.cancel",{name:"getI18n",hash:{},data:i}))+'</button> <button class="greenbtn" id="saveBTN" data-zcqa="marketing_attr_upd_btn">'+l(a.getI18n.call(o,"crm.button.update",{name:"getI18n",hash:{},data:i}))+"</button> "},8:function(t,e,a,n,i){var o=null!=e?e:{},l=t.escapeExpression;return' <button class="newgraybtn" id="deactivateBTN" data-zcqa="marketing_attr_cancl_btn">'+l(a.getI18n.call(o,"crm.button.cancel",{name:"getI18n",hash:{},data:i}))+'</button> <button class="greenbtn" id="saveBTN" data-zcqa="marketing_attr_sve_btn">'+l(a.getI18n.call(o,"crm.button.save",{name:"getI18n",hash:{},data:i}))+"</button> "},10:function(t,e,a,n,i){var o=t.lambda,l=t.escapeExpression;return' <div class="convFlowShapes" data-attr="'+l(o(e,e))+'" id="shape_'+l(o(e,e))+'" onclick="Attribution.showStages(this)" data-zcqa="marketing_attr_addstage_'+l(o(e,e))+'"> <span class="convFlowShapeSvg convFlow_'+l(o(e,e))+' convFlowShapePos"></span> </div> '},12:function(t,e,a,n,i){var o=t.lambda,l=t.escapeExpression,r=null!=e?e:{};return' <div id="'+l(o(e,e))+'_definition_Div" class="convFlowShapeDesc dN"> <span class="dB bold f15 mB15">'+l(o(e,e))+'</span> <p class="mB30 color_6 fs">'+l(a.getI18n.call(r,a.concat.call(r,"crm.setup.attribution.",e,".defn",{name:"concat",hash:{},data:i}),{name:"getI18n",hash:{},data:i}))+"</p> </div> "},14:function(t,e,a,n,i){var o=t.lambda,l=t.escapeExpression;return' <option value="'+l(o(null!=e?e.fieldid:e,e))+'">'+l(o(null!=e?e.fieldname:e,e))+"</option> "},compiler:[7,">= 4.0.0"],main:function(t,e,a,n,i){var o,l=null!=e?e:{},r=t.escapeExpression;return'\x3c!--link href="'+r(a.getStaticCssPathFromHelper.call(l,"attribution.css",{name:"getStaticCssPathFromHelper",hash:{},data:i}))+'" rel="stylesheet" type="text/css" /--\x3e <div id="convFlowAttribution" class="convFlowAttribution pR"> \x3c!--Get start div starts here test--\x3e <div id="convFlowGetStartTitle" class="mB10"> <div class="convFlowShapeTitle f21 crm-font-regular"> <span class="convFlowBackIcon svgIcons ico-lineArrow-left dIB vam cP op06" onclick="Attribution.goToSetup();"></span> <span class="vam">'+r(a.getI18n.call(l,"crm.attribution.chooseshapetocontinue",{name:"getI18n",hash:{},data:i}))+'</span> <a id="context-helplink" class="toplink fR mT8 f14 mR0" onclick="openHelp(\''+r(a.getHelpUrl.call(l,"help.marketing.attribution",{name:"getHelpUrl",hash:{},data:i}))+'\')" href="javascript:;">'+r(a.getI18n.call(l,"crm.topmenu.help",{name:"getI18n",hash:{},data:i}))+'</a> <div class="cB"></div> </div> <p class="w90per mL60 mAuto">'+r(a.getI18n.call(l,"crm.attribution.chooseshapetocontinue1",{name:"getI18n",hash:{},data:i}))+'</p> <div class="txt-ctr mT10 dN"> <span class="ico-play svgIcons dIB vam mR5"></span><span class="dIB vam">'+r(a.getI18n.call(l,"crm.attribution.watch",{name:"getI18n",hash:{},data:i}))+'</span> </div> </div> <div class="convFlowShapeSelect" id="convFlowGetStart"> <div class="convFlowShapeOuter clearFix"> '+(null!=(o=a.each.call(l,null!=(o=null!=e?e.Attribution:e)?o.types:o,{name:"each",hash:{},fn:t.program(1,i,0),inverse:t.noop,data:i}))?o:"")+' </div> </div> \x3c!--Get start div ends here--\x3e \x3c!-- configuration starts here--\x3e <div id="convFlowConfiguration" class="dN"> <div id="convFlowLeft" class="convFlowLeft hI" onclick="Attribution.cancelStageDetails();"> <div id="convFlowBox" class="hI dN"> <div class="convFlowLeftModules" id="stageul">&nbsp;</div> \x3c!--create stage div starts here--\x3e <div id="convFlowStageName" class="convFlowStageName pA dN" onclick="sE(event);"> \x3c!--<div id="convFlowStageName" class="convFlowShapeStage dN"> <div class="p20 bbd1 pB0 pR"> <span class="convFlowStageClose svgIcons ico-close pA cP" onclick="Attribution.cancelStageDetails();"></span> </div>--\x3e <span id="convAttrAddArrow" class="svgIcons convAttrAddStageArrow"></span> \x3c!--span class="dIB mB15 f17 bld">Stage Name</span--\x3e <div> <span id="convAttr_title" class="color_1 bld fL">'+r(a.getI18n.call(l,"crm.link.add.stage",{name:"getI18n",hash:{},data:i}))+'</span> <span id="convFlowStageDelete" class="ttUpper f12 red cP fR">'+r(a.getI18n.call(l,"crm.button.delete",{name:"getI18n",hash:{},data:i}))+'</span> <span class="dB cB"></span> <div id="convFlowStageSelectDiv" class="mT15"> <span class="convFlowStageLabel dB pB5 pR color_3 fs">'+r(a.getI18n.call(l,"crm.attribution.choosestage",{name:"getI18n",hash:{},data:i}))+'</span> <div class="convAttrStageNames newSelect w100per convAttrMandatory mR0"> <input type="hidden" id="api_name" value="Potentials.Stage"></input> <select id="api_value" data-zcqa="marketing_attr_api_value_btn"> '+(null!=(o=a.each.call(l,null!=(o=null!=e?e.Attribution:e)?o.potential_stage:o,{name:"each",hash:{},fn:t.program(3,i,0),inverse:t.noop,data:i}))?o:"")+' </select> </div> </div> <div id="convAttrStageInputDiv" class="mT15 dN"> <span class="convFlowStageLabel dB pB5 pR color_3 fs">'+r(a.getI18n.call(l,"crm.potential.stage.name",{name:"getI18n",hash:{},data:i}))+'</span> <input id="modStageInputName" type="text" class="convFlowStageDet w100per"> </div> <span class="convFlowStageLabel dB pB5 pR color_3 fs mT20">'+r(a.getI18n.call(l,"percentage",{name:"getI18n",hash:{},data:i}))+'</span> <div class="convAttrMandatory pR"> <input id="modWeight" type="text" maxlength="3" class="convFlowStageDet w100per" data-zcqa="marketing_attr_mod_weight_btn"> </div> <input type="hidden" id="module" class="textField w100per"> <input type="hidden" id="isdefault" class="textField w100per"> <input type="hidden" id="defaultstagename" class="textField w100per"> \x3c!-- <div class="mT20" id="criteria_container"> <span class="color_1 bld dB mB10">Criteria</span> <div id="criteriapartdiv"> </div> </div> --\x3e </div> <div class="mT20 alignright"> <span id="addstagebtn" class="dIB vam col2c7bd0 ttUpper cP f12 mR15" data-zcqa="marketing_attr_addstage_btn">'+r(a.getI18n.call(l,"crm.button.add",{name:"getI18n",hash:{},data:i}))+'</span> <span class="dIB vam color_3 ttUpper cP f12" onclick="Attribution.cancelStageDetails();" data-zcqa="marketing_attr_cancelstage_btn">'+r(a.getI18n.call(l,"crm.button.cancel",{name:"getI18n",hash:{},data:i}))+'</span> </div> \x3c!--</div>--\x3e </div> \x3c!--create stage div ends here--\x3e <span id="convFlowBottomLine" class="convFlowBottomLine pA dN"> <span class="convFlowRemainVal pA w50per" data-zcqa="marketing_attr_remain_weighatge"> <span id="convFlowRemainValue" class="convFlowRemainValue dB bold f15"></span> \x3c!--span class="color_6">Touch Count</span--\x3e </span> </span> <div id="convAttrShape" class="convAttrShape"> <div id="convAttrShapeSvgDiv"></div> </div> </div> <div id="convFlowRemainShape" class="convFlowRemainShape pR dN"> <div id="convFlowFixedShape" class="convFlowFixedShape"> <div class="convFlowBarDiv"> <div class="convFlowBarPer pR color_3 bld dN">100%</div> <div class="convFlowBarOuter pR dN"> <div class="convFlowBarInner pA"></div> </div> <div class="convFlowDropBarDiv"> <span class="convFlowBarBubbleOuter"></span> </div> <span class="convFlowShapeText color_6 pA">'+r(a.getI18n.call(l,"crm.setup.attribution.FIRST_TOUCH.title",{name:"getI18n",hash:{},data:i}))+'</span> </div><div class="convFlowBarDiv"> <div class="convFlowBarPer pR dN"></div> <div class="convFlowBarOuter pR dN"> <div class="convFlowBarInner pA"></div> </div> <div class="convFlowDropBarDiv"> <span class="convFlowBarBubbleOuter"></span> </div> </div><div class="convFlowBarDiv"> <div class="convFlowBarPer pR dN"></div> <div class="convFlowBarOuter pR dN"> <div class="convFlowBarInner pA"></div> </div> <div class="convFlowDropBarDiv"> <span class="convFlowBarBubbleOuter"></span> </div> </div><div class="convFlowBarDiv"> <div class="convFlowBarPer pR color_3 bld dN">100%</div> <div class="convFlowBarOuter pR dN"> <div class="convFlowBarInner pA"></div> </div> <div class="convFlowDropBarDiv"> <span class="convFlowBarBubbleOuter"></span> </div> <span class="convFlowShapeText color_6 pA">'+r(a.getI18n.call(l,"crm.setup.attribution.LAST_TOUCH.title",{name:"getI18n",hash:{},data:i}))+'</span> </div><div class="convFlowConversionDiv"> <span class="dIB"></span> <div class="convFlowDropBarDiv"> <span class="convFlowShapeSvg convFlowConversionIcon"></span> </div> </div> </div> <span id="convFlowRemainShapeLine" class="convFlowRemainShapeLine pA dN"> <span class="convFlowRemainVal pA bold">100 %</span> </span> <div id="convAttrRemainShapeDiv" class="dN"> <div id="convAttrRemainShapeSvgDiv"></div> </div> </div> </div> <div id="convFlowSaveCancelDiv" class="convFlowSaveCancelDiv pF"> <button id="convFlowDeactivateBtn" class="redbtn outlineredlight dN mL40 fL" data-zcqa="marketing_attr_deactivate_btn" onclick="Attribution.deactivateconfirmation();">'+r(a.getI18n.call(l,"crm.label.deactivate",{name:"getI18n",hash:{},data:i}))+'</button> <div class="convFlowFooter fR pR20"> '+(null!=(o=a.if.call(l,null!=(o=null!=e?e.Attribution:e)?o.conf_details:o,{name:"if",hash:{},fn:t.program(6,i,0),inverse:t.program(8,i,0),data:i}))?o:"")+' </div> <div class="cB"></div> </div> <div id="conFlowZoomDiv" class="conFlowZoomDiv pF"> <div class="conFlowZoomSpan pR bb3" onclick="Attribution.zoom(\'plus\');"> <span class="conFlowZoom svgIcons ico-plus-small-bold"></span> </div> <div class="conFlowZoomSpan pR" onclick="Attribution.zoom(\'minus\');"> <span class="conFlowZoom svgIcons ico-minus-small-bold"></span> </div> </div> <div class="convFlowNote pF"> <span class="color_1 bld mR8">'+r(a.getI18n.call(l,"crm.label.note2",{name:"getI18n",hash:{},data:i}))+'</span><span class="color_3">'+r(a.getI18n.call(l,"crm.attribution.representation",{name:"getI18n",hash:{},data:i}))+'</span> </div> <div id="convFlowRight" class="convFlowRight pF"> <div id="convFlowChooseShape" class="convFlowSlideOuter"> <div class="p20 bbd1 pB0"> <span id="convFlowShapeDiv" class="convFlowTabs dIB" onclick="Attribution.selectTab(this, \'ChooseShape\');">'+r(a.getI18n.call(l,"crm.attribution.chooseshape",{name:"getI18n",hash:{},data:i}))+'</span> <a id="context-helplink" class="toplink fR mT4 mR0" onclick="openHelp(\''+r(a.getHelpUrl.call(l,"help.marketing.attribution",{name:"getHelpUrl",hash:{},data:i}))+'\')" href="javascript:;">'+r(a.getI18n.call(l,"crm.topmenu.help",{name:"getI18n",hash:{},data:i}))+'</a> <div class="cB"></div> \x3c!--<span id="convFlowStageDiv" class="convFlowTabs dN" onclick="Attribution.selectTab(this, \'StageName\');">Stage Name</span>--\x3e </div> <div id="convFlowTabDet" class="convFlowTabDet p30 pA"> \x3c!--span class="convFlowHelpText f13 dB mB15">Your account is now running by <span id="convFlowShapeSaved"></span></span--\x3e <div class="convFlowShapesList"> '+(null!=(o=a.each.call(l,null!=(o=null!=e?e.Attribution:e)?o.types:o,{name:"each",hash:{},fn:t.program(10,i,0),inverse:t.noop,data:i}))?o:"")+" </div> "+(null!=(o=a.each.call(l,null!=(o=null!=e?e.Attribution:e)?o.types:o,{name:"each",hash:{},fn:t.program(12,i,0),inverse:t.noop,data:i}))?o:"")+' \x3c!-- Linear - exclude & weighatage div starts here--\x3e <div id="convFlowLinearShape" class="dN"> <div id="add_weightage_div"> <span class="color_1 bld dIB vam">'+r(a.getI18n.call(l,"crm.setup.attribution.addweightage",{name:"getI18n",hash:{},data:i}))+'</span> <span class="svgIcons ico-info mL10 dIB vam" onmouseenter=\'crmui.showTooltip("'+r(a.getI18n.call(l,"crm.setup.attribution.tooltip.addweight",{name:"getI18n",hash:{},data:i}))+'");\' onmouseleave="crmui.hideTooltip();"></span> <table id="modWeightageCriteria" border="0" cellpadding="0" cellspacing="5" class="modWeightageCriteria newApCriteriaTable newCriUi newSrchView mT10 f13"> <tbody> <tr id="weighatgeTR" data-index="1"> <td width=""> <div> <div class="wf_chosen_ui"> <select name="modWeightType" class="modWeightType" data-weight="1" onchange="Attribution.enableChangeStatus()"> <option value="">-'+r(a.getI18n.call(l,"crm.forecast.type.select",{name:"getI18n",hash:{},data:i}))+"-</option> "+(null!=(o=a.each.call(l,null!=(o=null!=e?e.Attribution:e)?o.campaign_source:o,{name:"each",hash:{},fn:t.program(14,i,0),inverse:t.noop,data:i}))?o:"")+' </select> </div> </div> </td> <td valign="top" width="360" class="wf_field_type_td"> <div class="pB5"> <div class="pR"> <select name="weightx" class="convFlowWeightx" onchange="Attribution.addweightinselect(this);"> <option value="">-'+r(a.getI18n.call(l,"crm.setup.attribution.Weightage",{name:"getI18n",hash:{},data:i}))+'-</option> <option value="2">2</option> <option value="3">3</option> <option value="4">4</option> </select> \x3c!--input type="text" class="w342 newinputText fL searchdate" id="weightx" onmouseout="Attribution.addweightinselect(this);"--\x3e </div> </div> </td> <td class="alignleft" valign="top"> <div> <a id=\'removelink\' style="display:none;" class="removeCriteria" onclick="Attribution.deleteRow(this);"></a> <a class="addCriteria" id="addRow" onclick="Attribution.clonetype();"></a> </div> </td> </tr> </tbody> </table> <div class="mT15"> <span class="color_1 bld dIB vam">'+r(a.getI18n.call(l,"crm.attribution.exculdecampaign",{name:"getI18n",hash:{},data:i}))+'</span> <span class="svgIcons ico-info mL10 dIB vam" onmouseenter=\'crmui.showTooltip("'+r(a.getI18n.call(l,"crm.setup.attribution.tooltip.exclude",a.getPluralModuleLabel.call(l,"Campaigns",{name:"getPluralModuleLabel",hash:{},data:i}),{name:"getI18n",hash:{},data:i}))+'");\' onmouseleave="crmui.hideTooltip();"></span> <div class="textFld tabDivCreate mT15 newInputStyleEle"> <div class="labelValCreate w100per campExcOptDiv mlSelect"> <select id="exclude_source" multiple onchange="Attribution.enableChangeStatus();"> '+(null!=(o=a.each.call(l,null!=(o=null!=e?e.Attribution:e)?o.campaign_source:o,{name:"each",hash:{},fn:t.program(14,i,0),inverse:t.noop,data:i}))?o:"")+' </select> </div> </div> </div> </div> </div> \x3c!-- Linear - exclude & weighatage div end here--\x3e <div id="convFlowLinearWeightage" class="dN"> <div id="criteriaDiv"></div> </div> \x3c!--shape definition goes here--\x3e <div id=\'shape_defn\' class="color_3 mT15 mB15">&nbsp;</div> \x3c!--shape definition ends here--\x3e </div> </div> </div> </div> </div> <div id="warning_to_save" class="newpopup w500 is-scroll ppTop dN"> <h2 class="pp-header"> '+r(a.getI18n.call(l,"crm.workflow.lock.warning",{name:"getI18n",hash:{},data:i}))+' </h2> <div class="pp-content"> The LINEAR model will replace the current model for ROI calculation in Campaigns. Do you wish to update? </div> <div class="pp-footer alignright"> <button class="newgraybtn" onclick="crmui.hidePopup(\'warning_to_save\');" data-zcqa="marketing_attr_save_btn">'+r(a.getI18n.call(l,"crm.button.cancel",{name:"getI18n",hash:{},data:i}))+'</button> <button class="primarybtn mR0" id="warningSaveBtn" data-zcqa="marketing_attr_ok_btn">'+r(a.getI18n.call(l,"crm.button.oktoproceed",{name:"getI18n",hash:{},data:i}))+'</button> </div> </div> <div id="warning_to_delete" class="newpopup w500 is-scroll ppTop dN"> <div class="pp-content"> '+r(a.getI18n.call(l,"crm.label.confirm.message",{name:"getI18n",hash:{},data:i}))+' </div> <div class="pp-footer alignright"> <button class="newgraybtn" onclick="crmui.hidePopup(\'warning_to_delete\');" data-zcqa="marketing_attr_cancel_btn">'+r(a.getI18n.call(l,"crm.button.cancel",{name:"getI18n",hash:{},data:i}))+'</button> <button class="redbtn mR0" id="stageDeleteBtn" data-zcqa="marketing_attr_delete_btn">'+r(a.getI18n.call(l,"crm.button.delete",{name:"getI18n",hash:{},data:i}))+"</button> </div> </div> "},useData:!0}),e.AttributionCriteria=t({1:function(t,e,a,n,i){var o=t.lambda,l=t.escapeExpression;return' <option value="'+l(o(null!=e?e.api_name:e,e))+'">'+l(o(null!=e?e.field_label:e,e))+"</option> "},3:function(t,e,a,n,i){var o;return" "+(null!=(o=a.each.call(null!=e?e:{},null!=e?e.pick_list_values:e,{name:"each",hash:{},fn:t.program(4,i,0),inverse:t.noop,data:i}))?o:"")+" "},4:function(t,e,a,n,i){var o=t.lambda,l=t.escapeExpression;return' <option value="'+l(o(e,e))+'">'+l(o(e,e))+"</option> "},compiler:[7,">= 4.0.0"],main:function(t,e,a,n,i){var o,l=null!=e?e:{};return'<table border="0" cellpadding="0" cellspacing="0" class="modWeightageCriteria newApCriteriaTable newCriUi newSrchView"> <tbody> <tr id="weighatgeTR"> <td width=""> <div> <div class="wf_chosen_ui"> <select id="api_name" name="api_name" class="modWeightType" onchange=""> <option value="">-Select-</option> '+(null!=(o=a.each.call(l,e,{name:"each",hash:{},fn:t.program(1,i,0),inverse:t.noop,data:i}))?o:"")+' </select> </div> </div> </td> <td valign="top" width="360" class="wf_field_type_td"> <select id="api_value" name="api_value" class="modWeightType" onchange=""> '+(null!=(o=a.each.call(l,e,{name:"each",hash:{},fn:t.program(3,i,0),inverse:t.noop,data:i}))?o:"")+" </select> </td> </tr> </tbody> </table> "},useData:!0}),e.AttributionDetails=t({1:function(t,e,a,n,i){var o,l=null!=e?e:{},r=t.escapeExpression;return' <style> .marAttrTableList thead th {\n        background-color: #f7f7f7;\n    }\n    .DetailsPageBox #attribution{\n        background: #fff;\n\t    box-shadow: 0px 0px 6px #D0DDEA;\n\t    border-radius: 6px;\n    } </style> <span class="dB color_1 mB20 bold f17 dvcompHeader relatedlist-header">'+r(a.getI18n.call(l,"crm.attribution.campaignhelptoearn",null!=(o=null!=(o=null!=e?e.Attribution:e)?o.singular_module:o)?o.Campaigns:o,{name:"getI18n",hash:{},data:i}))+'</span> <span class="dIB color_3D6078 mB15 mR30 pL20 pR20">'+r(a.getI18n.call(l,"crm.attribution.noofcampaign",null!=(o=null!=(o=null!=e?e.Attribution:e)?o.singular_module:o)?o.Campaigns:o,{name:"getI18n",hash:{},data:i}))+': <span class="bold color_3D6078">'+r(t.lambda(null!=(o=null!=e?e.Attribution:e)?o.no_of_campaign:o,e))+'</span></span> <div><table class="marAttrTableList newtable m0" width="100%"> <thead> <tr> <th class=\'first_td\'>'+r(a.getI18n.call(l,"crm.label.CampaignName",null!=(o=null!=(o=null!=e?e.Attribution:e)?o.singular_module:o)?o.Campaigns:o,{name:"getI18n",hash:{},data:i}))+"</th> <th>"+r(a.getI18n.call(l,"Type",{name:"getI18n",hash:{},data:i}))+"</th> <th>"+r(a.getI18n.call(l,"crm.label.CampaignStartDate",null!=(o=null!=(o=null!=e?e.Attribution:e)?o.singular_module:o)?o.Campaigns:o,{name:"getI18n",hash:{},data:i}))+"</th> <th>"+r(a.getI18n.call(l,"crm.label.CampaignEndDate",null!=(o=null!=(o=null!=e?e.Attribution:e)?o.singular_module:o)?o.Campaigns:o,{name:"getI18n",hash:{},data:i}))+"</th> <th>"+r(a.getI18n.call(l,"Actual Cost",{name:"getI18n",hash:{},data:i}))+"</th> <th>"+r(a.getI18n.call(l,"crm.adword.tab.revenue",{name:"getI18n",hash:{},data:i}))+"</th> </tr> </thead> <tbody> "+(null!=(o=a.each.call(l,null!=(o=null!=e?e.Attribution:e)?o.campaign_details:o,{name:"each",hash:{},fn:t.program(2,i,0),inverse:t.noop,data:i}))?o:"")+" </tbody> </table> "},2:function(t,e,a,n,i){var o,l=null!=e?e:{},r=t.escapeExpression,s=t.lambda;return" <tr> <td class='first_td'><a href=\""+r(a.getCrmBasePath.call(l,{name:"getCrmBasePath",hash:{},data:i}))+"/tab/Campaigns/"+r(s(null!=e?e.campaign_id:e,e))+'/" target="_blank" data-zcqa="marketing_attr_'+r(s(null!=e?e.campaign_id:e,e))+'"> '+r(s(null!=e?e.campaign_name:e,e))+"</a></td> <td>"+r(s(null!=e?e.campaign_source:e,e))+"</td> <td>"+r(s(null!=e?e.startdate:e,e))+"</td> <td>"+r(s(null!=e?e.enddate:e,e))+"</td> <td> "+(null!=(o=a.if.call(l,null!=e?e.cost:e,{name:"if",hash:{},fn:t.program(3,i,0),inverse:t.program(5,i,0),data:i}))?o:"")+" </td> <td> "+(null!=(o=a.if.call(l,null!=e?e.amount:e,{name:"if",hash:{},fn:t.program(7,i,0),inverse:t.program(5,i,0),data:i}))?o:"")+" </td> </tr> "},3:function(t,e,a,n,i){return" "+t.escapeExpression(a.formatCurrency.call(null!=e?e:{},null!=e?e.cost:e,{name:"formatCurrency",hash:{},data:i}))+" "},5:function(t,e,a,n,i){return" &nbsp; "},7:function(t,e,a,n,i){return" "+t.escapeExpression(a.formatCurrency.call(null!=e?e:{},null!=e?e.amount:e,{name:"formatCurrency",hash:{},data:i}))+" "},compiler:[7,">= 4.0.0"],main:function(t,e,a,n,i){var o;return" "+(null!=(o=a.if.call(null!=e?e:{},null!=(o=null!=e?e.Attribution:e)?o.no_of_campaign:o,{name:"if",hash:{},fn:t.program(1,i,0),inverse:t.noop,data:i}))?o:"")+" </div>"},useData:!0})}();