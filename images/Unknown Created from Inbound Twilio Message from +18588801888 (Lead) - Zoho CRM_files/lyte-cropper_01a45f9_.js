lyteDomObj&&(lyteDomObj.prototype.cropper=function(t){if("destroy"===t||"Destroy"===t){var e=this[0],i=e.parentElement,p=$L(i).find(".lyteCropArea")[0];i.removeChild(p),$L(e).data("cropper",{}),e.style.display="block"}else if(t&&(t.type||(t.type="default")),"default"===t.type){function h(t){return t.getBoundingClientRect()}var o,l,s=this[0],n=1,r=s.parentElement,a="n:n",d=1,g=t,c=!1;t&&t.useExif&&(c=t.useExif);var x=function(){},f=function(){};t&&(t.beforeRender&&(x=t.beforeRender),t.afterRender&&(f=t.afterRender));var y=0,m=0;g||(g={aspectRatio:"n:n"});var u,w,L,C,$,v,b,R,B,S,E,A,z,I,D,M,k,F,H,T,W,Y,V,N,P,X,G,U,O,_={},q=function(){},j=function(){},J=function(){},K=function(){};if(0!==r.querySelectorAll(".lyteCropArea").length){var Q=r.querySelectorAll(".lyteCropArea")[0];m=$L(s).data("cropper").exifAngle,$L(s).data("cropper")?(l=$L(s).data("cropper").angle,m=$L(s).data("cropper").exifAngle):l=y,r.removeChild(Q),s.style.display="block",o=h(s)}function Z(){s.complete&&0===r.querySelectorAll(".lyteCropArea").length&&(o=h(s),s.style.display="none"),s.removeEventListener("load",Z)}function tt(){u=document.createElement("DIV"),w=document.createElement("DIV"),L=document.createElement("DIV"),C=document.createElement("DIV"),v=document.createElement("DIV"),$=document.createElement("DIV"),b=document.createElement("DIV"),R=document.createElement("DIV"),B=document.createElement("DIV"),S=document.createElement("DIV"),E=document.createElement("DIV"),z=document.createElement("DIV"),A=document.createElement("DIV"),I=document.createElement("DIV"),k=document.createElement("SPAN"),F=document.createElement("SPAN"),H=document.createElement("SPAN"),T=document.createElement("SPAN"),Y=document.createElement("SPAN"),V=document.createElement("SPAN"),N=document.createElement("SPAN"),P=document.createElement("SPAN"),gt=document.createElement("IMG"),D=document.createElement("IMG"),M=document.createElement("IMG"),(W=s.parentElement).appendChild(u),u.appendChild(w),w.appendChild(L),L.appendChild(D),w.appendChild(C),w.appendChild($),$.appendChild(b),b.appendChild(Y),$.appendChild(R),R.appendChild(V),$.appendChild(B),B.appendChild(N),$.appendChild(S),S.appendChild(P),$.appendChild(E),$.appendChild(z),$.appendChild(I),$.appendChild(A),$.appendChild(k),$.appendChild(F),$.appendChild(H),$.appendChild(T),$.appendChild(v),v.appendChild(M)}function et(){switch(g&&(a=g.aspectRatio),g.cropStart&&(q=g.cropStart),g.cropDrag&&(j=g.cropDrag),g.onSet&&(J=g.onSet),g.cropEnd&&(K=g.cropEnd),a){case"n:n":d=void 0;break;case"1:1":d=1;break;case"2:3":d=2/3;break;case"3:2":d=1.5;break;case"4:3":d=4/3;break;case"3:4":d=3/4;break;case"16:9":d=16/9;break;case"9:16":d=9/16}n=s.naturalWidth/s.naturalHeight,s.naturalWidth>s.naturalHeight?xt="landscape":s.naturalWidth<=s.naturalHeight&&(xt="portrait"),tt(),u.setAttribute("class","lyteCropArea"),gt.setAttribute("class","lyteCropMainImage"),w.setAttribute("class","lyteCropBox"),L.setAttribute("class","lyteCropFixedDiv"),D.setAttribute("class","lyteCropFixedImage"),C.setAttribute("class","lyteCropOpacityDiv"),$.setAttribute("class","lyteCropCropper"),k.setAttribute("class","lytecropVerGrid1"),F.setAttribute("class","lytecropVerGrid2"),H.setAttribute("class","lytecropHorGrid1"),T.setAttribute("class","lytecropHorGrid2"),b.setAttribute("class","lyteCropTopEdge"),Y.setAttribute("class","lyteCropTopSpan"),R.setAttribute("class","lyteCropBottomEdge"),V.setAttribute("class","lyteCropBottomSpan"),B.setAttribute("class","lyteCropLeftEdge"),N.setAttribute("class","lyteCropLeftSpan"),S.setAttribute("class","lyteCropRightEdge"),P.setAttribute("class","lyteCropRightSpan"),E.setAttribute("class","lyteCropTopRightCorner"),z.setAttribute("class","lyteCropTopLeftCorner"),A.setAttribute("class","lyteCropBottomRightCorner"),I.setAttribute("class","lyteCropBottomLeftCorner"),v.setAttribute("class","lyteCropDivImage"),M.setAttribute("class","lyteCropDivImageImg"),function(){var t=function(){var t={};switch(xt){case"landscape":t.imageWidth=h(W).width,t.imageHeight=h(W).width/n;break;case"portrait":t.imageWidth=h(W).height*n,t.imageHeight=h(W).height}return t}();D.style.height=t.imageHeight+"px",D.style.width=t.imageWidth+"px",M.style.height=t.imageHeight+"px",M.style.width=t.imageWidth+"px",u.style.height=h(D).height+"px",u.style.width=h(D).width+"px";var e,i=(e={},"landscape"===xt?(e.imageTop=(h(W).height-h(D).height)/2,e.imageLeft=0):(e.imageTop=0,_lyteUiUtils.getRTL()?e.imageLeft="-"+(h(W).width-h(D).width)/2:e.imageLeft=(h(W).width-h(D).width)/2),e);u.style.left=i.imageLeft+"px",u.style.top=i.imageTop+"px";var p=function(){var t,e,i={};return D.src=gt.src=M.src=s.src,i.cropperWidth=ot(),i.cropperHeight=(t=d,"n:n"===a&&(t=1),g.selection?g.selection.size?(e=parseFloat(g.selection.size)/t,g.maxSize&&parseFloat(g.maxSize)<parseFloat(g.selection.size)&&(e=parseFloat(g.maxSize)/t),g.minSize&&parseFloat(g.minSize)>parseFloat(g.selection.size)&&(e=parseFloat(g.minSize)/t)):e=lt().height:e="n:n"===a?h(D).height:lt().height,e),i}();$.style.height=p.cropperHeight+"px",$.style.width=p.cropperWidth+"px";var o=function(){var t={};return g.selection?(g.selection.top?t.cropperTop=st().top:t.cropperTop=nt().cropperTop,g.selection.left?t.cropperLeft=st().left:t.cropperLeft=nt().cropperLeft):(t.cropperLeft=nt().cropperLeft,t.cropperTop=nt().cropperTop),t}();if($.style.top=o.cropperTop+"px",$.style.left=o.cropperLeft+"px",M.style.left=-o.cropperLeft+"px",M.style.top=-o.cropperTop+"px",w.style.overflow="unset",90===l||270===l){var r=h($),c=h(u);h(D);if(x=l)l-90,(x=l)>=360&&(x=0),D.style.transform="rotate("+x+"deg) rotateY("+m+"deg)",M.style.transform="rotate("+x+"deg) rotateY("+m+"deg)";else{var x=90;D.style.transform="rotate("+x+"deg) rotateY("+m+"deg)",M.style.transform="rotate("+x+"deg) rotateY("+m+"deg)"}d=1/d,xt="landscape"===xt?"portrait":"landscape",it(),at(r,c)}180!==l&&0!==l||(0===(x=l)?(l-90,(x=l)>=360&&(x=0),D.style.transform="rotate("+x+"deg) rotateY("+m+"deg)",M.style.transform="rotate("+x+"deg) rotateY("+m+"deg)"):(D.style.transform="rotate("+x+"deg) rotateY("+m+"deg)",M.style.transform="rotate("+x+"deg) rotateY("+m+"deg)")),dt(),$.addEventListener("mousedown",rt)}(),it(),dt()}function it(){switch(a){case"n:n":pt(1),ht(1);break;case"1:1":case"2:3":case"3:2":case"4:3":case"3:4":case"16:9":case"9:16":pt(d),ht(d)}}function pt(t){g.minSize?(G=g.minSize,X=g.minSize/t):(G=15,X=15/t)}function ht(t){var e=h(D);"landscape"===xt?g.maxSize?g.maxSize>e.width?(U=e.height,O=e.height*t,"n:n"===a&&(U=e.height,O=e.width)):(O=g.maxSize,U=g.maxSize/t,"n:n"===a&&(U=g.maxSize,O=g.maxSize)):(U=e.height,O=e.height*t,"n:n"===a&&(U=e.height,O=e.width)):"portrait"===xt&&(g.maxSize?g.maxSize>e.height?(U=e.width/t,O=e.width,"n:n"===a&&(U=e.height,O=e.width)):(O=g.maxSize*t,U=g.maxSize,"n:n"===a&&(U=g.maxSize,O=g.maxSize)):(U=e.width/t,O=e.width,"n:n"===a&&(U=e.height,O=e.width)))}function ot(t){var e;return g.selection?g.selection.size?(e=parseFloat(g.selection.size),g.maxSize&&parseFloat(g.maxSize)<parseFloat(g.selection.size)&&(e=parseFloat(g.maxSize)),g.minSize&&parseFloat(g.minSize)>parseFloat(g.selection.size)&&(e=parseFloat(g.minSize))):initialValue=lt().width:e="n:n"===a?h(D).width:lt().width,e}function lt(){var t={};return"landscape"===xt?(t.width=h(D).height*d,t.height=h(D).height):(t.width=h(D).width,t.height=h(D).width/d),t.width>h(D).width&&(t.width=h(D).width,t.height=h(D).width/d),t.height>h(D).height&&(t.height=h(D).height,t.width=h(D).height*d),t}function st(){var t={};return parseFloat(g.selection.top)+h($).height>h(C).bottom?t.top=h(C).height-h($).height:t.top=parseFloat(g.selection.top),parseFloat(g.selection.left)+h($).width>h(C).right?t.left=h(C).width-h($).width:t.left=parseFloat(g.selection.left),t}function nt(){var t={};return t.cropperTop=(h(C).height-h($).height)/2,t.cropperLeft=(h(D).width-h($).width)/2,t}function rt(t){var e;switch(q(),k.style.opacity=F.style.opacity=H.style.opacity=T.style.opacity=1,C.style.opacity="0.6",t.preventDefault(),e="lyteCropDivImageImg"===t.target.className||"lyteCropDivImage"===t.target.className?"parent":"child",$L(".lyteCropTopEdge")[0],$L(".lyteCropRightEdge")[0],$L(".lyteCropBottomEdge")[0],$L(".lyteCropLeftEdge")[0],$L(".lyteCropTopRightCorner")[0],$L(".lyteCropBottomRightCorner")[0],$L(".lyteCropBottomLeftCorner")[0],$L(".lyteCropTopLeftCorner")[0],e){case"parent":if("lyteCropDivImage"===t.target.className||"lyteCropDivImageImg"===t.target.className){var i=h($),p=h(C),o=h(u),l=h(w),s=(h(D),t.clientX),n=t.clientY,r=p.left-o.left,g=p.right-i.width-l.left,c=p.top-o.top;function x(t){k.style.opacity=F.style.opacity=H.style.opacity=T.style.opacity=1,t.preventDefault();var e=t.clientX,l=t.clientY;i.top+(l-n)-o.top+o.top>p.top?$.style.top=i.top+(l-n)-o.top+"px":$.style.top=c+"px",i.left+(e-s)-o.left+o.left>p.left?$.style.left=i.left+(e-s)-o.left+"px":$.style.left=r+"px",i.right+(e-s)-o.right+o.right<p.right||($.style.left=g+"px"),i.bottom+(l-n)-o.bottom+o.bottom<p.bottom||($.style.top=p.bottom-i.height-o.top+"px");var a=D.style.transform;D.style.transform="rotate(0deg)",M.style.left=h(D).left-h($).left+"px",M.style.top=h(D).top-h($).top+"px",D.style.transform=a,dt()}o.bottom,o.bottom,p.bottom,i.height,window.innerHeight,o.bottom,document.addEventListener("mousemove",x),document.addEventListener("mouseup",(function t(){C.style.opacity="",k.style.opacity=F.style.opacity=H.style.opacity=T.style.opacity=0,document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",t),document.removeEventListener("mousedown",x),dt(),J()}))}break;case"child":{var f,y=h($),m=y.left,L=y.top,v=y.width,b=y.height,R=y.right,B=y.bottom,S=h(C),E=S.top,A=S.left,z=S.width,I=S.height,W=S.bottom,Y=S.right,V=h(u),N=V.top,P=V.left,_=(V.width,V.height,V.right),Q=V.bottom,Z=h(w),tt=(Z.height,Z.width,Z.left,Z.top,h(D)),et=tt.left,it=tt.top,pt=tt.width,ht=tt.height,ot=(s=t.clientX,n=t.clientY,y.top+y.height/2-V.top),lt=y.left+y.width/2-V.left;function st(t){dt(),j();var e,i,p,o,l,r,g=t.clientX,c=t.clientY,x=t.clientX,y=t.clientY,u=h($);function w(){u=h($)}switch(f){case"lyteCropLeftEdge":if(w(),e=0,i=0,p=0,o=0,v-(g-s)>=G&&v-(g-s)<=O)g>A&&(p=v-(x-s)+"px",o=(v-(x-s))/d+"px",e=L-N+(x-s)/d/2+"px",i=m-P+(g-s)+"px",$L($).css({width:p,height:o,top:e,left:i})),w(),g-6<=A&&(u.height>=I&&(u.width>=z||!(u.top<E))||(e=W-((z-(Y-R))/d+(W-(ot+(z-(Y-R))/d/2)))+"px",i=A-P+"px",$L($).css({top:e,left:i})),i=A-P+"px",p=R-A+"px",o=(z-(Y-R))/d+"px",$L($).css({width:p,height:o,left:i})),w(),u.bottom>=W&&(e=W-u.height-N+"px",$L($).css({top:e})),w(),u.top<=E&&(e=E-N+"px",$L($).css({top:e})),w(),u.bottom>=W&&u.top<=E&&(i=R-(W-E)*d-P+"px",p=(W-E)*d+"px",o=W-E+"px",e=E-N+"px",$L($).css({width:p,height:o,top:e,left:i}));else if(v-(g-s)<=G)"n:n"!==a?(i=R-G-P+"px",e=ot-X/2+"px",p=G+"px",o=X+"px",$L($).css({width:p,height:o,top:e,left:i})):(i=R-G-P+"px",p=G+"px",$L($).css({width:p,left:i}));else if(v-(g+6-s)>=O)if("n:n"!==a){var C=(v-(x-s))/d;((S=v-(x-s))>=O||C>=U)&&g+6<=A&&R-A>=O&&(i=R-O-P+"px",w(),(e=ot-U/2)<0&&(e=0),e>W-U-E&&(e=W-U-E),p=O+"px",o=U+"px",$L($).css({width:p,height:o,top:e,left:i}))}else O!=pt?(i=R-O-A,p=O+"px"):(i=0,p=R-A+"px"),$L($).css({width:p,left:i});break;case"lyteCropTopEdge":w(),e=0,i=0,p=0,o=0,b-(c-n)>=X&&b-(c-n)<=U?(c>E+6&&(p=(b-(c-n))*d+"px",o=b-(c-n)+"px",i=m-P+(c-n)*d/2+"px",e=L-N+(c-n)+"px",$L($).css({width:p,height:o,top:e,left:i})),w(),c-6<=E&&(u.height>=I&&(u.width>=z||!(u.left<A))||(i=Y-((B-E)*d+(Y-(lt+(B-E)*d/2)))+"px",e=E-N+"px",$L($).css({top:e,left:i})),p=(B-E)*d+"px",o=B-E+"px",$L($).css({width:p,height:o})),w(),u.left<=A&&(i=A-P+"px",$L($).css({left:i})),w(),u.right>=Y&&(i=Y-u.width-P+"px",$L($).css({left:i})),w(),u.right>=Y&&u.left<=A&&(p=Y-A+"px",o=(Y-A)/d+"px",e=B-(Y-A)/d-N+"px",i=A-P+"px",$L($).css({width:p,height:o,top:e,left:i}))):b-(c-n)<=X?"n:n"!==a?(e=B-X-N+"px",i=lt-G/2+"px",p=G+"px",o=X+"px",$L($).css({width:p,height:o,top:e,left:i})):(e=B-X-N+"px",o=X+"px",$L($).css({height:o,top:e})):b-(c-n)>=U&&("n:n"!==a?(C=b-(c-n),((S=(b-(c-n))*d)>=O||C>=U)&&c-6<E&&B-E>=U&&(e=B-U-N+"px",w(),(i=lt-O/2)<0&&(i=0),i>Y-O-A&&(i=Y-O-A),p=O+"px",o=U+"px",$L($).css({width:p,height:o,top:e,left:i}))):(U!=ht?(e=B-U-E,o=U+"px"):(e=0,o=B-E+"px"),$L($).css({height:o,top:e})));break;case"lyteCropRightEdge":if(w(),e=0,l=0,p=0,o=0,i=0,v+(x-s)>=G&&v+(x-s)<=O)x<Y&&(p=v+(x-s)+"px",o=(v+(x-s))/d+"px",e=L-N-(x-s)/d/2+"px",l=R-_-(x-s)+"px",$L($).css({width:p,height:o,top:e,right:l})),x>=Y&&(e=ot-(Y-m)/d/2+"px",p=Y-m+"px",o=(Y-m)/d+"px",$L($).css({width:p,height:o,top:e})),w(),u.bottom>=W&&(e=W-u.height-N+"px",$L($).css({top:e})),w(),u.top<=E&&(e=E-N+"px",$L($).css({top:e})),w(),u.bottom>=W&&u.top<=E&&(i=m-P+"px",p=(W-E)*d+"px",o=W-E+"px",$L($).css({width:p,height:o,left:i}));else if(v+(x-s)<=G)"n:n"!==a?(e=ot-X/2+"px",p=G+"px",o=X+"px",$L($).css({width:p,height:o,top:e})):(p=G+"px",$L($).css({width:p}));else if(v+(g-s)>=O)if("n:n"!==a){var S=v+(x-s);((C=(v+(x-s))/d)>=U||S>=O)&&m<=Y-O&&((e=ot-U/2)<0&&(e=0),e>W-U-E&&(e=W-U-E),p=O+"px",o=U+"px",$L($).css({width:p,height:o,top:e}))}else p=O!=pt?O+"px":Y-m+"px",$L($).css({width:p});break;case"lyteCropBottomEdge":w(),e=0,l=0,p=0,o=0,i=0,b+(c-n)>=X&&b+(c-n)<=U?(c<W&&(p=(b+(y-n))*d+"px",o=b+(c-n)+"px",i=m-P-(y-n)*d/2+"px",r=B-Q-(y-n)+"px",$L($).css({width:p,height:o,left:i,bottom:r})),c>=W&&(i=lt-(W-L)*d/2+"px",p=(W-L)*d+"px",o=W-L+"px",$L($).css({width:p,height:o,left:i})),w(),u.left<=A&&(i=A-P+"px",$L($).css({left:i})),w(),u.right>=Y&&(i=Y-u.width-P+"px",$L($).css({left:i})),w(),u.right>=Y&&u.left<=A&&(i=A-P+"px",p=Y-A+"px",o=(Y-A)/d+"px",$L($).css({width:p,height:o,left:i}))):b+(c-n)<=X?"n:n"!==a?(i=lt-G/2+"px",p=G+"px",o=X+"px",$L($).css({width:p,height:o,left:i})):(o=X+"px",$L($).css({height:o})):b+(c-n)>=U&&("n:n"!==a?(C=b+(c-n),((S=(b+(y-n))*d)>=O||C>=U)&&L<=W-U&&((i=lt-O/2)<0&&(i=0),i>Y-O-A&&(i=Y-O-A),p=O+"px",o=U+"px",$L($).css({width:p,height:o,left:i}))):(o=U!=ht?U+"px":W-L+"px",$L($).css({height:o})));break;case"lyteCropTopRightCorner":w(),e=0,l=0,p=0,o=0,i=0,"n:n"===a?(v+(x-s)>=G&&v+(x-s)<=O?x<Y&&(p=v+(x-s)+"px",$L($).css({width:p}),$L($).css({width:p})):v+(x-s)<G?x<=m&&(p=G+"px",$L($).css({width:p})):v+(x-s)>O&&x>=Y&&(p=O!=pt?O+"px":Y-m+"px",$L($).css({width:p})),b-(y-n)>=X&&b-(y-n)<=U?y>E&&(e=L-N+(c-n)+"px",o=b-(y-n)+"px",$L($).css({height:o,top:e})):b-(y-n)<X?y>B&&(o=X+"px",e=B-X-E+"px",$L($).css({height:o,top:e})):b-(y-n)>U&&y<=E&&(U!=ht?(e=B-U-E+"px",o=U+"px"):(e=E-it+"px",o=B-E+"px"),$L($).css({height:o,top:e}))):b-(c-n)>=X&&b-(c-n)<=U?(c>=E+5&&(p=(b-(c-n))*d+"px",o=b-(c-n)+"px",e=L-N+(c-n)+"px",l=R-_-(g-s)+"px",$L($).css({width:p,height:o,top:e,right:l})),w(),c<E+5&&(u.height>=I&&(u.width>=z||!(u.left<A))||(e=E-N+"px"),p=(B-E)*d+"px",o=B-E+"px",$L($).css({width:p,height:o,top:e})),w(),u.right>=Y&&(e=B-(Y-m)/d-N+"px",p=Y-m+"px",o=(Y-m)/d+"px",$L($).css({width:p,height:o,top:e}))):b-(c-n)<=X?(e=B-X-N+"px",p=G+"px",o=X+"px",$L($).css({width:p,height:o,top:e})):b-(c-n)>=U&&(C=b-(c-n),((S=(b-(c-n))*d)>=O||C>=U)&&c-6<E&&B-E>=U&&m<=Y-O&&(e=B-U-N+"px",(i=lt-O/2)<0&&(i=0),i>Y-O-A&&(i=Y-O-A),p=O+"px",o=U+"px",$L($).css({width:p,height:o,top:e})));break;case"lyteCropTopLeftCorner":w(),e=0,l=0,p=0,o=0,i=0,"n:n"===a?(w(),v-(g-s)>=G&&v-(g-s)<=O?g>A&&(p=v-(x-s)+"px",i=m-P+(g-s)+"px",$L($).css({width:p,left:i})):v-(g-s)<G?x>R&&(p=G+"px",i=R-G-A+"px",$L($).css({width:p,left:i})):v-(g-s)>O&&g<=A&&(O!=pt?(p=O+"px",i=R-O-A+"px"):(p=R-A+"px",i=A-et+"px"),$L($).css({width:p,left:i})),b-(y-n)>=X&&b-(y-n)<=U?y>E&&(e=L-N+(c-n)+"px",o=b-(y-n)+"px",$L($).css({height:o,top:e})):b-(y-n)<X?y>B&&(o=X+"px",e=B-X-E+"px",$L($).css({height:o,top:e})):b-(y-n)>U&&y<=E&&(U!=ht?(e=B-U-E+"px",o=U+"px"):(e=E-it+"px",o=B-E+"px"),$L($).css({height:o,top:e}))):b-(c-n)>=X&&b-(c-n)<=U?(c>=E+5&&(p=(b-(c-n))*d+"px",o=b-(c-n)+"px",e=L-N+(c-n)+"px",i=m-P+(c-n)*d+"px",$L($).css({width:p,height:o,left:i,top:e})),w(),c-6<=E&&(u.height>I&&(u.width>z||!(u.left<A))||(i=Y-((B-E)*d+(Y-R))-P+"px",e=E-N+"px"),p=(B-E)*d+"px",o=B-E+"px",$L($).css({width:p,height:o,left:i,top:e})),w(),u.left<=A&&(e=B-(R-A)/d-N+"px",i=A-P+"px",p=R-A+"px",o=(R-A)/d+"px",$L($).css({width:p,height:o,left:i,top:e}))):b-(c-n)<=X?"n:n"!==a&&(e=B-X-N+"px",i=R-G-P+"px",p=G+"px",o=X+"px",$L($).css({width:p,height:o,left:i,top:e})):b-(c-n)>=U&&(C=b-(c-n),((S=(b-(c-n))*d)>=O||C>=U)&&c-6<E&&B-E>=U&&R-A>=O&&(e=B-U-N+"px",(i=lt-O/2)<0&&(i=0),i>Y-O-A&&(i=Y-O-A),p=O+"px",o=U+"px",$L($).css({width:p,height:o,top:e,left:i})));break;case"lyteCropBottomRightCorner":w(),e=0,l=0,p=0,o=0,i=0,"n:n"===a?(w(),b+(c-n)>=X&&b+(c-n)<=U?c<W&&(o=b+(c-n)+"px",$L($).css({height:o})):b+(c-n)<X?y<L&&(o=X+"px",$L($).css({height:o})):b+(c-n)>U&&c>=W&&(o=U!=ht?U+"px":W-L+"px",$L($).css({height:o})),v+(g-s)>=G&&v+(g-s)<=O?g<Y&&(p=v+(g-s)+"px",$L($).css({width:p})):v+(g-s)<G?x<=m&&(p=G+"px",$L($).css({width:p})):v+(g-s)>O&&g>=Y&&(p=O!=pt?O+"px":Y-m+"px",$L($).css({width:p}))):v+(x-s)>=G&&v+(x-s)<=O?(x<Y&&(p=v+(x-s)+"px",o=(v+(x-s))/d+"px",$L($).css({width:p,height:o})),w(),u.right>=Y-5&&x>=Y-5&&(p=Y-m+"px",o=(Y-m)/d+"px",$L($).css({width:p,height:o})),w(),u.bottom>=W&&(o=W-L+"px",p=(W-L)*d+"px",$L($).css({width:p,height:o}))):v+(x-s)<=G?(p=G+"px",o=X+"px",$L($).css({width:p,height:o})):v+(x-s)>=O&&(S=v+(x-s),((C=(v+(x-s))/d)>=U||S>=O)&&W-L>=U&&Y-m>=O&&(p=O+"px",o=U+"px",$L($).css({width:p,height:o})));break;case"lyteCropBottomLeftCorner":w(),e=0,l=0,p=0,o=0,i=0,"n:n"===a?(w(),v-(g-s)>=G&&v-(g-s)<=O?g>A&&(p=v-(x-s)+"px",i=m-P+(g-s)+"px",$L($).css({width:p,left:i})):v-(g-s)<G?x>R&&(p=G+"px",i=R-G-A+"px",$L($).css({width:p,left:i})):v-(g-s)>O&&g<=A&&(O!=pt?(p=O+"px",i=R-O-A+"px"):(p=R-A+"px",i=A-et+"px"),$L($).css({width:p,left:i})),b+(c-n)>=X&&b+(c-n)<=U?c<W&&(o=b+(c-n)+"px",$L($).css({height:o})):b+(c-n)<X?y<L&&(o=X+"px",$L($).css({height:o})):b+(c-n)>U&&c>=W&&(o=U!=ht?U+"px":W-L+"px",$L($).css({height:o}))):v-(g-s)>=G&&v-(g-s)<=O?(g>A&&(p=v-(x-s)+"px",o=(v-(x-s))/d+"px",i=m-P+(g-s)+"px",$L($).css({width:p,height:o,left:i})),w(),g-6<=A+2&&(u.height>=I&&(u.width>=z||!(u.left<A))||(i=A-P+"px"),p=R-A+"px",o=(R-A)/d+"px",$L($).css({width:p,height:o,left:i})),w(),u.bottom>=W&&(o=W-L+"px",p=(W-L)*d+"px",i=Y-((W-L)*d+(Y-R))-P+"px",$L($).css({width:p,height:o,left:i}))):v-(g-s)<=G?"n:n"!==a&&(i=R-G-P+"px",p=G+"px",o=X+"px",$L($).css({width:p,height:o,left:i})):v-(g-s)>=O&&"n:n"!==a&&(S=v-(x-s),((C=(v-(x-s))/d)>=U||S>=O)&&g-6<A&&R-A>=O&&W-L>=U&&(i=R-O-P+"px",p=O+"px",o=U+"px",$L($).css({width:p,height:o,left:i})))}var k=D.style.transform;D.style.transform="rotate(0deg)",M.style.left=h(D).left-h($).left+"px",M.style.top=h(D).top-h($).top+"px",D.style.transform=k,dt()}r=S.left-V.left,c=S.top-V.top,g=S.right-y.width-Z.left,f=""===t.target.className?t.target.parentElement.className:t.target.className,document.addEventListener("mousemove",st),document.addEventListener("mouseup",(function t(){C.style.opacity="",k.style.opacity=F.style.opacity=H.style.opacity=T.style.opacity=0,document.removeEventListener("mousemove",st),document.removeEventListener("mouseup",t),dt(),K()}))}}}function at(t,e,i,p,l){var s=D.style.transform.match(/-?\d+/g)[0],n=parseInt(s),g=n;if(90===(n=Math.abs(n))||270===n){if(o.height<o.width){D.style.width=M.style.width=h(r).height+"px",D.style.height=M.style.height="auto",u.style.height=h(r).height+"px",u.style.top="0px",u.style.width=h(D).width+"px";var c=Math.abs(h(u).left-h(D).left);_lyteUiUtils.getRTL()?(u.style.left="-"+(h(r).width-h(u).width)/2+"px",D.style.left=-c+"px"):(u.style.left=(h(r).width-h(u).width)/2+"px",D.style.left=-c+"px")}else if(o.height>o.width){D.style.width=M.style.width="auto",D.style.height=M.style.height=h(r).width+"px",u.style.width=h(r).width+"px",u.style.left="0px",u.style.height=h(D).height+"px",u.style.top=(h(r).height-h(u).height)/2+"px";var x=Math.abs(h(u).left-h(D).left);_lyteUiUtils,D.style.left=x+"px"}D.style.top=h(u).top-h(D).top+"px",it(),"n:n"!==a?(X=h(u).height/e.width*15,G=X*d):(X=h(u).height/e.width*15,G=X);var f=m=t.height*h(u).width/e.height,y=L=t.width*h(u).height/e.width;G>m&&"n:n"!=a&&(y=(f=G)/d),X>L&&"n:n"!=a&&(f=(y=X)*d),$.style.width=f+"px",$.style.height=y+"px",-90!==g&&-270!==g||($.style.left=(t.top-e.top)*h(u).width/e.height+"px",$.style.top=h(u).height-((t.left-e.left)*h(u).height/e.width+h($).height)+"px"),90!==g&&270!==g||($.style.top=(t.left-e.left)*h(u).height/e.width+"px",$.style.left=h(u).width-(h($).width+(t.top-e.top)*h(u).width/e.height)+"px")}else{var m,L;o.height<o.width?(D.style.width=M.style.width=h(r).width+"px",D.style.height=M.style.height="auto",u.style.width=h(r).width+"px",u.style.left="0px",u.style.right="",u.style.height=h(D).height+"px",u.style.top=(h(r).height-h(u).height)/2+"px",D.style.left=(h(u).width-h(D).width)/2+"px"):(D.style.width=M.style.width="auto",D.style.height=M.style.height=h(r).height+"px",u.style.height=h(r).height+"px",u.style.top="0px",u.style.width=h(D).width+"px",_lyteUiUtils.getRTL()?u.style.left="-"+(h(r).width-h(u).width)/2+"px":u.style.left=(h(r).width-h(u).width)/2+"px",D.style.left=(h(u).width-h(D).width)/2+"px"),D.style.top=(h(w).height-h(D).height)/2+"px",it(),f=m=t.height*h(u).width/e.height,y=L=t.width*h(u).height/e.width,X>L&&"n:n"!=a&&(f=(y=X)*d),$.style.width=f+"px",$.style.height=y+"px",-180===g&&($.style.top=h(u).height-((t.left-e.left)*h(u).height/e.width+h($).height)+"px",$.style.left=(t.top-e.top)*h(u).width/e.height+"px"),0!==g&&180!==g||($.style.top=(t.left-e.left)*h(u).height/e.width+"px",$.style.left=h(u).width-(h($).width+(t.top-e.top)*h(u).width/e.height)+"px")}var C=D.style.transform;D.style.transform="rotate(0deg)",M.style.left=h(D).left-h($).left+"px",M.style.top=h(D).top-h($).top+"px",D.style.transform=C}function dt(){var t,e,i,p=h($);_.cropperDimensions={top:$.offsetTop,left:$.offsetLeft,width:p.width,height:p.height},_.imageDimension=o,_.resolution=(t=$L(".lyteCropDivImageImg")[0],e=t.naturalWidth/t.getBoundingClientRect().width,i=t.naturalHeight/t.getBoundingClientRect().height,90!==_.angle&&270!==_.angle||(e=t.naturalHeight/t.getBoundingClientRect().width,i=t.naturalWidth/t.getBoundingClientRect().height),{width:$.getBoundingClientRect().width*e,height:$.getBoundingClientRect().height*i}),_.rotate=function(){var t=h($),e=h(u),i=(h(D),D.style.transform);if(i)(p=i.match(/-?\d+/g))[0],(p=parseInt(p[0])+90)>=360&&(p=0),D.style.transform="rotate("+p+"deg) rotateY("+m+"deg)",M.style.transform="rotate("+p+"deg) rotateY("+m+"deg)";else{var p=90;D.style.transform="rotate("+p+"deg) rotateY("+m+"deg)",M.style.transform="rotate("+p+"deg) rotateY("+m+"deg)"}l=p,_.angle=p,d=1/d,xt="landscape"===xt?"portrait":"landscape",at(t,e),dt()},_.getCroppedImage=function(){var t=$L(".lyteCropDivImageImg")[0],e=h($),i=h(u),p=h(M);return t.naturalWidth,e.width,function(h,o){var l=document.createElement("CANVAS"),s=l.getContext("2d");l.style.background="#eee";var n,r,a=D.style.transform,d=0;a&&(d=a.match(/-?\d+/g),d=parseInt(d[0])),90!==Math.abs(d)&&270!==Math.abs(d)&&(M.style.transform="rotate(0deg) rotateY("+m+"deg)");var g=i.left-e.left,c=i.top-e.top;if(90!==Math.abs(d)&&270!==Math.abs(d)?(l.width=Math.round(e.width*(h.naturalWidth/p.width)),l.height=Math.round(e.height*(h.naturalHeight/p.height)),n=h.naturalWidth,r=h.naturalHeight):(l.height=Math.round(e.height*(h.naturalWidth/p.height)),l.width=Math.round(e.width*(h.naturalHeight/p.width)),r=h.naturalWidth,n=h.naturalHeight),g*=n/p.width,c*=r/p.height,M.style.transform=a,0!==d||180===m){s.save(),Math.abs(d)%90==0&&180!==Math.abs(d)&&360!==Math.abs(d)&&(h.naturalWidth,h.naturalHeight);var x=n/2,f=r/2;Math.abs(d)%90==0&&0!=d&&180!==Math.abs(d)&&360!==Math.abs(d)?(s.translate(g+x,c+f),s.rotate(d*(Math.PI/180)),180===m&&s.scale(-1,1),s.drawImage(t,-f,-x,r,n)):(s.translate(g+n/2,c+r/2),s.rotate(d*(Math.PI/180)),180===m&&s.scale(-1,1),s.drawImage(t,-n/2,-r/2,n,r)),s.restore()}else s.drawImage(h,g,c,n,r);return l}(t)},_.changeByHeight=function(t){var e,i,p=h($),o=h(C),l=parseFloat(t);l+h($).top<=h(C).bottom||(l=h(C).bottom-h($).top);var s=h($).left+h($).width/2-h(C).left;l>=U&&(l=U),l<=X&&(l=X);var n=l*d;p.top+l>=o.bottom&&(i=o.bottom-l-o.top,$L($).css({top:i}));var r=s-n/2;r>=0&&$L($).css({left:r}),r+n>=h(C).right-h(C).left&&(r=h(C).right-n-h(C).left,$L($).css({left:r})),"n:n"!==a?$L($).css({width:n,height:l}):(n=h($).width,$L($).css({height:l})),"NaN"===t&&(n=G,l=X),e={cropperWidth:n,cropperHeight:l};var g=D.style.transform;return D.style.transform="rotate(0deg)",M.style.left=h(D).left-h($).left+"px",M.style.top=h(D).top-h($).top+"px",D.style.transform=g,dt(),e},_.changeByWidth=function(t){var e,i,p=parseFloat(t);p+h($).left<=h(C).right||(p=h(C).right-h($).left);var o=h($),l=h(C),s=h($).top+h($).height/2-h(C).top;p>=O&&(p=O),p<=G&&(p=G);var n=p/d;o.left+p>=l.right&&(i=l.right-p-l.left,$L($).css({left:i}));var r=s-n/2;r>=0&&$L($).css({top:r}),r+n>=h(C).bottom-h(C).top&&(r=h(C).bottom-n-h(C).top,$L($).css({top:r})),"n:n"!==a?$L($).css({width:p,height:n}):(n=h($).height,$L($).css({width:p})),"NaN"===t&&(p=G,n=X),e={cropperWidth:p,cropperHeight:n};var g=D.style.transform;return D.style.transform="rotate(0deg)",M.style.left=h(D).left-h($).left+"px",M.style.top=h(D).top-h($).top+"px",D.style.transform=g,dt(),e},_.deleteCropper=function(){r.removeChild(u),s.style.display="block"},_.swapAspectRatio=function(){d=1/d,it();var t,e,i,p,o=h($).height,l=h($).width,s=h($).height/2+h($).top,n=h($).width/2+h($).left;h($).top+l>h(C).bottom?(t=h(C).bottom-l-h(C).top,$L($).css({top:t})):((t=s-h($).width/2-h(C).top)<=0&&(t=0),$L($).css({top:t})),h($).left+o>h(C).right?(e=h(C).right-o-h(C).left,$L($).css({left:e})):((e=n-h($).height/2-h(C).left)<=0&&(e=0),$L($).css({left:e})),$L($).css({width:o,height:l}),l>=h(D).height&&(i=h(D).height*d,p=h(D).height,e=(h(D).width-i)/2,$L($).css({height:p,width:i,top:0,left:e})),o>=h(D).width&&(i=h(D).width,p=h(D).width/d,t=(h(D).height-p)/2,$L($).css({height:p,width:i,left:0,top:t}));var r=D.style.transform;D.style.transform="rotate(0deg)",M.style.left=h(D).left-h($).left+"px",M.style.top=h(D).top-h($).top+"px",D.style.transform=r+"rotateY("+m+")",dt()},_.angle=l,_.exifAngle=m,$L(s).data("cropper",_)}"from-image"!==getComputedStyle(s).imageOrientation&&c?$L.exif&&$L.exif({target:s,getData:function(t){if(s=t.target,"from-image"!==getComputedStyle(s).imageOrientation){switch(t.exifdata.Orientation){case 1:y=0;break;case 2:y=0,m=180;break;case 3:y=180;break;case 4:y=180,m=180;break;case 5:y=270,m=180;break;case 6:y=90;break;case 7:y=90,m=180;break;case 8:y=270}x(t.exifdata.Orientation),Z(),$L(s).data("cropper")?(l=$L(s).data("cropper").angle,m=$L(s).data("cropper").exifAngle):l=y,s.style.display="none",et(),f()}}}):(x(),Z(),et(),f())}else if("DP"===t.type){var gt,ct=(gt=this[0]).getBoundingClientRect();gt.style.display="none";var xt,ft,yt,mt,ut,wt,Lt,Ct,$t=gt.parentElement,vt=$t.getBoundingClientRect();_={},t||(t={}),t.cropperSize||(t.cropperSize=300),xt=ct.height<ct.width?"landscape":"portrait";var bt,Rt,Bt,St,Et=function(){mt.appendChild(ut),mt.appendChild(Ct),Lt.appendChild(wt),mt.appendChild(Lt),$t.appendChild(mt),ft=ut.getBoundingClientRect()},At=function(){Lt.style.width=Lt.style.height=t.cropperSize+"px",Lt.style.top=vt.height/2-t.cropperSize/2+"px",Lt.style.left=vt.width/2-t.cropperSize/2+"px","landscape"===xt?(ut.style.top=vt.height/2-t.cropperSize/2+"px",ut.style.left=(vt.width-ft.width)/2+"px"):(ut.style.top=(vt.height-ft.height)/2+"px",ut.style.left=vt.width/2-t.cropperSize/2+"px"),wt.style.left=ut.getBoundingClientRect().left-Lt.getBoundingClientRect().left+"px",wt.style.top=ut.getBoundingClientRect().top-Lt.getBoundingClientRect().top+"px",yt=ut.getBoundingClientRect(),$t.addEventListener("mousedown",zt)},zt=function(t){$L(t.target).hasClass("lytePSvisualArea")&&($t.addEventListener("mousemove",It),$t.addEventListener("mouseup",Dt),bt=ut.getBoundingClientRect().top-$t.getBoundingClientRect().top,Rt=ut.getBoundingClientRect().left-$t.getBoundingClientRect().left,Bt=t.clientY,St=t.clientX)},It=function(e){vt.height,t.cropperSize,e.clientY;var i=bt-(Bt-e.clientY),p=(e.clientX,vt.width,t.cropperSize,Rt-(St-e.clientX));p<=Lt.getBoundingClientRect().left-$t.getBoundingClientRect().left?(ut.style.left=Rt-(St-e.clientX)+"px",wt.style.left=Rt-(St-e.clientX)-(vt.width/2-t.cropperSize/2)+"px"):(ut.style.left=Lt.getBoundingClientRect().left-$t.getBoundingClientRect().left+"px",wt.style.left=Lt.getBoundingClientRect().left-$t.getBoundingClientRect().left-(vt.width/2-t.cropperSize/2)+"px"),p+ut.getBoundingClientRect().width<Lt.getBoundingClientRect().left-$t.getBoundingClientRect().left+Lt.getBoundingClientRect().width&&(ut.style.left=-1*(ut.getBoundingClientRect().width-Lt.getBoundingClientRect().width-(Lt.getBoundingClientRect().left-$t.getBoundingClientRect().left))+"px",wt.style.left=-1*(ut.getBoundingClientRect().width-Lt.getBoundingClientRect().width-(Lt.getBoundingClientRect().left-$t.getBoundingClientRect().left))-(vt.width/2-t.cropperSize/2)+"px"),i<=Lt.getBoundingClientRect().top-$t.getBoundingClientRect().top?(ut.style.top=bt-(Bt-e.clientY)+"px",wt.style.top=-1*(vt.height/2-t.cropperSize/2)+(bt-(Bt-e.clientY))+"px"):(ut.style.top=Lt.getBoundingClientRect().top-$t.getBoundingClientRect().top+"px",wt.style.top=-1*(vt.height/2-t.cropperSize/2)+(Lt.getBoundingClientRect().top-$t.getBoundingClientRect().top)+"px"),i+ut.getBoundingClientRect().height<Lt.getBoundingClientRect().top-$t.getBoundingClientRect().top+Lt.getBoundingClientRect().height&&(ut.style.top=-1*(ut.getBoundingClientRect().height-Lt.getBoundingClientRect().height-(Lt.getBoundingClientRect().top-$t.getBoundingClientRect().top))+"px",wt.style.top=-1*(ut.getBoundingClientRect().height-Lt.getBoundingClientRect().height-(Lt.getBoundingClientRect().top-$t.getBoundingClientRect().top))-(vt.height/2-t.cropperSize/2)+"px")},Dt=function(t){$t.removeEventListener("mousemove",It),$t.removeEventListener("mouseup",Dt)};mt=document.createElement("DIV"),Ct=document.createElement("DIV"),ut=document.createElement("IMG"),Lt=document.createElement("DIV"),wt=document.createElement("IMG"),ut.src=wt.src=gt.src,mt.setAttribute("class","lytePSParent"),Ct.setAttribute("class","lytePSFreezeLayer"),ut.setAttribute("class","lytePSBackImage"),Lt.setAttribute("class","lytePSvisualArea"),wt.setAttribute("class","lytePSFrontImage"),"landscape"===xt?(ut.style.height=t.cropperSize+"px",wt.style.height=t.cropperSize+"px"):(ut.style.width=t.cropperSize+"px",wt.style.width=t.cropperSize+"px"),Et(),At(),_.zoomImage=function(t){var e,i,p=t/100+1,h=$t.getBoundingClientRect(),o=parseFloat(ut.style.top),l=parseFloat(ut.style.left),s=ut.getBoundingClientRect(),n=s.height,r=s.width,a=l+r,d=o+n,g=Lt.getBoundingClientRect(),c=g.top-h.top,x=g.left-h.left,f=x-l,y=a-(x+g.width),m=c-o,u=d-(c+g.height),w=yt.height*p,L=yt.width*p,C=r-g.width,$=n-g.height,v=w-n,b=L-r,R=f/C*(L-g.width),B=m/$*(w-g.height);f==y&&m==u?(i=l-b/2,e=o-v/2):f==y?(e=c-B,i=l-b/2):m==u?(e=o-v/2,i=x-R):(e=c-B,i=x-R),"landscape"===xt?(ut.style.height=w+"px",wt.style.height=w+"px"):(ut.style.width=L+"px",wt.style.width=L+"px"),ut.style.top=e+"px",wt.style.top=e-c+"px",ut.style.left=i+"px",wt.style.left=i-x+"px"},_.getCroppedImage=function(){var t=wt,e=Lt.getBoundingClientRect(),i=(mt.getBoundingClientRect(),wt.getBoundingClientRect());return t.naturalWidth,e.width,function(p,h){var o=document.createElement("CANVAS"),l=o.getContext("2d");o.style.background="#eee";var s,n,r=ut.style.transform,a=0;r&&(a=r.match(/-?\d+/g),a=parseInt(a[0]));var d=i.left-e.left,g=i.top-e.top;return 90!==Math.abs(a)&&270!==Math.abs(a)?(o.width=Math.round(e.width*(t.naturalWidth/i.width)),o.height=Math.round(e.height*(t.naturalHeight/i.height)),s=t.naturalWidth,n=t.naturalHeight):(o.height=Math.round(e.height*(t.naturalWidth/i.height)),o.width=Math.round(e.width*(t.naturalHeight/i.width)),n=t.naturalWidth,s=t.naturalHeight),d*=s/i.width,g*=n/i.height,wt.style.transform=r,l.drawImage(t,d,g,s,n),o}()},$L(gt).data("lyteCrop",_)}});
