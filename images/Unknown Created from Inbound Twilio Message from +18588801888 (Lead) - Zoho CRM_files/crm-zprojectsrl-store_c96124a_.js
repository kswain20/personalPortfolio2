store.registerModel("zprojects_rl",{OpenBugCNT:Lyte.attr("number",{default:0}),OpenMilestoneCNT:Lyte.attr("number",{default:0}),ProjectName:Lyte.attr("string"),ProjectId:Lyte.attr("string",{primaryKey:!0}),OpenTask:Lyte.attr("number",{default:0}),Index:Lyte.attr("number"),ProjectStatus:Lyte.attr("string",{default:"active"}),CloseBugCNT:Lyte.attr("number",{default:0}),CloseTask:Lyte.attr("number",{default:0}),BugCompletionPercentage:Lyte.attr("number",{default:0}),CloseMilestoneCNT:Lyte.attr("number",{default:0}),TaskCompletion:Lyte.attr("number",{default:0}),MilestoneCompletionPercentage:Lyte.attr("number",{default:0}),ProjectUsersList:Lyte.attr("array",{default:[]}),ClientUsersList:Lyte.attr("array",{default:[]})}),store.registerAdapter("zprojects_rl",{namespace:"crm",buildURL:function(e,t,r,s,a,c,l){var i=l.moduleName,n=l.entity_id,o=s.ProjectId;switch(a=a.split(e)[0],t){case"deleteRecord":a=a.concat("v2/"+i+"/"+n+"/Zoho_Projects");break;case"updateRecord":a=a.concat("v2/"+i+"/"+n+"/Zoho_Projects/"+o+"/users")}return a},methodForRequest:function(e){return"PATCH"===e?"PUT":e}}),store.registerSerializer("zprojects_rl",{serialize:function(e,t,r,s,a){switch(e){case"updateRecord":var c={};c.action=s.action,c.client_name=s.client_name,c.project_id=r.ProjectId,c.project_name=r.ProjectName,c.crm_account_id=s.crm_account_id;for(var l=s.projectUserMap,i=s.existingProjectUsers,n=[],o=0,d=l.length;o<d;o++){var u={},_=l[o],p=_.email;u.email=p,_.is_user_selected&&i.includes(p)||!_.is_user_selected&&!i.includes(p)||(_.is_user_selected&&!i.includes(p)&&(u.profile_id=_.project_profile_id,u.role_id=_.project_role_id),!_.is_user_selected&&i.includes(p)&&(u.zuid=_.id,u._delete="null"),n.push(u))}c.project_users=n;var m=s.existingClientUsers,f=s.clientUserMap,y=[],j=store.peekAll("project_profiles").filter((function(e){return"client"===e.type&&e.default}));for(o=0,d=f.length;o<d;o++){var b={},L=f[o];p=L.email;if(b.email=p,!(L.is_user_selected&&!L.portal_access_enabled&&m.includes(p)||!L.is_user_selected&&L.portal_access_enabled&&!m.includes(p))){if(L.is_user_selected){b.crm_contactId=L.contact_id,b.zpuser_id=L.zpuserid,b.portal_access_enabled=L.portal_access_enabled;var g=L.profile_id;b.profile_id=g||j[0].id}!L.is_user_selected&&m.includes(p)&&(b._delete="null",b.portal_access_enabled=L.portal_access_enabled,b.zpuser_id=L.zpuserid,b.crm_contactId=L.contact_id),b&&Object.keys(b).length>1&&y.push(b)}}c.client_users=y;var P=[];P.push(c),delete t[a],t.data=P;break;case"deleteRecord":t={}}return t}});
