//$Id$
/**
 * IMPORTANT NOTE: This compressed javascript includes thirdparty javascripts
 * listed at docs.zoho.com/html/thirdparty.html
 * The original javascript sources are available in the above location.
 */
function ZDDialog(){}function ZDUtils(){}function ZDConstants(){this.openTarget="_blank",this.callback=!1,this.folderArray=[],this.urlInvoker,this.moveUpFolder=!1,this.nextPage=!1,this.totalFiles="",this.templates="false",this.nameSortArrow="",this.nameSortOrder="",this.timeSortArrow="",this.timeSortOrder="desc",this.folderId="folder",this.parentFolderId="1",this.fromIndex="0",this.endIndex="10",this.prevIndex="1",this.nextIndex="10",this.docsPerPage="10",this.topLevelFetch="0",this.bottomLevelFetch="50",this.startFrom="0",this.fetchLimit="50",this.isShareEnabled=!1,this.advSearchFile=!1,this.trashsort=!1,this.searchQuery="",this.jsonData="",this.includeJSandCSSFiles=!1,this.selectedLeftPanel="recentservicedocs",this.templateObj={},this.rename_openfile={id:"rename_openfile",label:zd_js_obj.rename,icon:"zdc-rename_css",attr:{title:zd_js_obj.rename}},this.trash_openfile={id:"trash_openfile",label:zd_js_obj.deletedoc,icon:"zdc-toolbardeleteactive",attr:{title:zd_js_obj.deletedoc}},this.delete_openfile={id:"delete_openfile",label:zd_js_obj.deletedoc,icon:"zdc-toolbardeleteactive",attr:{title:zd_js_obj.deletedoc}},this.restore_openfile={id:"restore_openfile",label:zd_js_obj.restore,icon:"zdc-restoreicon_css",attr:{title:zd_js_obj.restore}},this.viewer={id:"zd_viewer_perm",label:zd_js_obj.read_only,icon:"viewer",attr:{title:zd_js_obj.read_only}},this.collaborator={id:"zd_collaborator_perm",label:zd_js_obj.read_write,icon:"collaborator",attr:{title:zd_js_obj.read_write}},this.coowner={id:"zd_coowner_perm",label:zd_js_obj.coowner,icon:"co-owner",attr:{title:zd_js_obj.coowner}},this.comment_only={id:"zd_comment_perm",label:zd_js_obj.label_read_comment,icon:"viewer",attr:{title:zd_js_obj.label_read_comment}},this.readfill={id:"zd_readfill_perm",label:zd_js_obj.label_read_fill,icon:"viewer",attr:{title:zd_js_obj.label_read_fill}},this.SCR_WTH="",this.SCR_HT="",this.searchType="relevance",this.createFolder={id:"createfolder",label:zd_js_obj.create,icon:"zdc-foldericon_css"},this.renameFolder={id:"renamefolder",label:zd_js_obj.rename,icon:"zdc-rename_css"},this.deleteFolder={id:"deletefolder",label:zd_js_obj.deletedoc,icon:"zdc-toolbardeleteactive"},this.viewer_details={id:"viewer_details",label:zd_js_obj.read_only,icon:"viewer",attr:{title:zd_js_obj.read_only}},this.collaborator_details={id:"collaborator_details",label:zd_js_obj.read_write,icon:"collaborator",attr:{title:zd_js_obj.read_write}},this.coowner_details={id:"coowner_details",label:zd_js_obj.coowner,icon:"co-owner",attr:{title:zd_js_obj.coowner}},this.comment_details={id:"comment_details",label:zd_js_obj.label_read_comment,icon:"viewer",attr:{title:zd_js_obj.label_read_comment}},this.readfill_details={id:"readfill_details",label:zd_js_obj.label_read_fill,icon:"viewer",attr:{title:zd_js_obj.label_read_fill}},this.trimmedEmails="",this.trimmedPerGroupIds="",this.trimmedOrgGroupIds="",this.groupNameList=[],this.groupNameAndIdList=[],this.docId,this.allShareJson={},this.isInternalMailId=!0,this.isCo_owner=!1,this.isFolderShare=!1,this.isVisibility=!1,this.updateShareStatus=!1,this.folderIds,this.resIds,this.autocomplete_selectValue="",this.G_fromAutoComplete=[],this.G_zdc_permissionType="2",this.defaultText="",this.templateCount=0}function LINKDOCS(){this.moveUpFolder=!1,this.nextPage=!1,this.totalFiles="",this.nameSortArrow="",this.sortOrder="desc",this.timeSortArrow="",this.fieldName="date",this.fromIndex="0",this.endIndex="10",this.prevIndex="1",this.nextIndex="10",this.docsPerPage="10",this.topLevelFetch="0",this.bottomLevelFetch="50",this.startFrom="0",this.fetchLimit="50",this.jsonData="",this.fid="",this.autoscrollData="",this.includeJSandCSSFiles=!1,this.selectedLeftPanel="recentservicedocs",this.SCR_WTH="",this.SCR_HT="",this.docsURL="",this.selecteddocs=[],this.wsId="",this.folderId="",this.udserverEnable=!0,this.thumbnailview=!1,this.listview=!1,this.foldertree=[],this.uploadFileLimit=3,this.filelimit=5,this.search=!1,this.isNewComp=!0,this.progresscallbck="",this.zsoid="",this.attachlabel="",this.service="",this.uploadenable=!1,this.container_id="",this.defaultObj={servicename:"",zsoid:"",filelimit:"5",handbckobj:"",search:!0,wsId:"",positionObj:[],isDraggable:!0,isResize:!1,height:400,width:650,zIndex:1e4,staticURL:location.protocol+"//css.zohostatic.com/personal/docs_v393/docscomponents",thumbnailview:!1,listview:!1},this.attachObj={}}function ATTACHDIALOG(){this.urlInvoker,this.moveUpFolder=!1,this.nextPage=!1,this.totalFiles="",this.nameSortArrow="",this.timeSortArrow="",this.sortOrder="",this.orderBy="",this.folderId="folder",this.parentFolderId="1",this.fromIndex="0",this.endIndex="10",this.prevIndex="1",this.nextIndex="10",this.docsPerPage="10",this.topLevelFetch="0",this.bottomLevelFetch="50",this.asLink="false",this.startFrom="0",this.fetchLimit="50",this.jsonData="",this.selectedLeftPanel="recentservicedocs",this.SCR_WTH="",this.SCR_HT="",this.folderId="folder",this.folderpermission="",this.searchenabled=!1,this.defaultObj={servicename:"",attachCount:"5",handbckobj:"",sharedDocs:!0,search:!0,workspace:!0,positionObj:[],isDraggable:!0,isResize:!1,height:570,width:650,staticURL:location.protocol+"//css.zohostatic.com/personal/docs_v492/docscomponents"},this.attachObj={},this.docsURL="",this.gridObj={documentNameHeader:!0,lastModifiedTimeHeader:!0,checkboxIconSpace:!0,checkboxIcon:"normalcheckboxicon_css flleft",hoverclass:"data-hover",documentIcon:!0,documentName:!0,authorName:!1,lastModifiedTime:!0}}ZDDialog.showCommonDialog=function(e,t,s,a,i,o,d,r,n,l,c,_){_=_?_:1e4;ZD("#"+s).dialog({autoOpen:!0,zIndex:_,title:e,modal:t,resizable:n,closeText:"closeIcon",buttons:a,position:i,width:o,minWidth:l,minHeight:c,draggable:d,height:r,drag:function(){if("sharedialogdiv"==s){if(ZD("#zd_sharetextarea").is(":visible")){var e=ZD("#zd_sharetextarea").offset().top,t=ZD("#zd_sharetextarea").offset().left;ZD(".zdc_shareautocompletedialog.ui-autocomplete").css({top:e+45,left:t})}if(ZD("#zdc_visible_default_hidediv").is(":visible")){var a=ZD("#zdc_visible_changelink"),i=ZD(a).offset(),o=i.left-100,d=i.top+30;ZD("#zdc_visible_default_hidediv").css({top:d,left:o})}}},open:function(){ZD("#"+s).parent().addClass("docsdialog").prev();if("undefined"!=typeof G_OF_OBJ&&!ZD("#docsdialoguidialogzindex").length&&"zohosheet"===G_OF_OBJ.urlInvoker){var e=ZD(this).closest(".ui-dialog"),t=parseInt(e.css("z-index"))+5,a=document.createElement("style");a.type="text/css",a.id="docsdialoguidialogzindex";var i=".docsdialog.ui-dialog{z-index:";i+=t+" !important;}",a.innerHTML=i,document.getElementsByTagName("head")[0].appendChild(a)}},resize:function(e,t){ZDDialog.resizeDialog(e,t,s)}});return ZD("#"+s).bind("dialogclose",function(){return ZDDialog.closePopUp(s),ZD(document).trigger("dialogbeforeclose"),!1}),!1},ZDDialog.resizeDialog=function(e,t,s){if("attachopenfiledialogdiv"==s){var a=t.size.height-92;ZD("#showopenservicefilespace").css("height",a),ZD("#showopenservicefilespace").openfiledatagrid("resize")}else if("sharedialogdiv"==s){ZD("#zd_initial_sharetextarea").is(":visible")&&ZD("#zd_initial_sharetextarea").trigger("focus");var a=t.size.height-279;ZD("#sharedialogdiv").css("overflow","hidden"),ZD(".privateshare-list").css("height",a),ZD("#zd_top_menu").is(":visible")&&ZD(".privateshare-list").css("height",a-93)}else if("attachfiledialogdiv"==s){var a=t.size.height-225;ZD("div#showattachfilespace").css("height",a),ZD("div#showattachfilespace").attachfiledatagrid("resize")}else if("adddocdialogdiv"==s){var a=t.size.height-255;ZD("div#tree_container").css("height",a).parent().css("height",a+40)}},ZDDialog.openAlert=function(e,t,s,a,i,o,d){ZD("#frameDiv").remove(),(void 0==i||""==i)&&(i=[200,350]),o=350;var r=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(r).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:e,modal:!1,resizable:!1,closeText:"",buttons:a,position:i,width:o,draggable:d,height:"auto",close:function(){ZD(this).dialog("destroy").remove()},open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return ZD("#frameDiv").empty().html('<span class="flleft icon_divider"></span><p>'+t+"</p>").removeAttr("style"),ZD("#frameDiv").bind("dialogclose",function(){return ZDDialog.closePopUp("frameDiv"),!1}),ZD("#frameDiv").addClass("custommargin_lightgrey"),!1},ZDDialog.componentAlert=function(e,t,s,a,i,o,d){ZD("#frameDiv").remove(),(void 0==i||""==i)&&(i=[]),o=520;var r=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(r).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:e,modal:!1,resizable:!1,dialogClass:"zdocsalert",buttons:a,position:i,width:o,draggable:d,height:"auto",open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return ZD("#frameDiv").empty().html('<span class="flleft icon_divider"></span><p>'+t+"</p>").removeAttr("style"),ZD(".zdocsalert").find(".ui-icon-closethick").hide(),ZD("#frameDiv").addClass("custommargin_lightgrey"),!1},ZDDialog.createNewFolderDialog=function(e,t,s,a,i,o){ZD("#createnewfolderdiv").remove();var d=ZD('<div id="createnewfolderdiv" style="display:none;"></div>');ZD(d).appendTo("body");ZD("#createnewfolderdiv").dialog({autoOpen:!0,zIndex:10008,title:e,modal:t,resizable:!1,closeText:"closeIcon",buttons:s,position:a,width:i,draggable:!0,height:o,open:function(){ZD("#createnewfolderdiv").parent().addClass("docsdialog")}});ZD("#createnewfolderdiv").unbind().bind("dialogclose",function(){return ZDDialog.closePopUp("createnewfolderdiv"),!1})},ZDDialog.showValidatePasswordDialog=function(e,t,s,a,i,o){ZD("#passworddialogdiv").remove();var d=ZD('<div id="passworddialogdiv" style="display:none;"></div>');ZD(d).appendTo("body");ZD("#passworddialogdiv").dialog({autoOpen:!0,zIndex:10008,title:e,modal:t,resizable:!1,closeText:"closeIcon",buttons:s,position:a,width:i,draggable:!0,height:o,open:function(){ZD(".ui-dialog-titlebar-close").hide()},closeOnEscape:!1,open:function(){ZD("#passworddialogdiv").parent().addClass("docsdialog")}});ZD("#passworddialogdiv").unbind().bind("dialogclose",function(){return ZDDialog.closePopUp("passworddialogdiv"),!1})},ZDDialog.showDialogForSendingMail=function(e,t,s,a,i,o){ZD("#securesharedialogdiv").remove();var d=ZD('<div id="securesharedialogdiv" style="display:none;"></div>');ZD(d).appendTo("body");ZD("#securesharedialogdiv").dialog({autoOpen:!0,zIndex:100008,title:e,modal:!1,resizable:!1,closeText:"closeIcon",buttons:s,position:a,width:i,draggable:!0,height:o,open:function(){ZD("#securesharedialogdiv").parent().addClass("docsdialog")}});ZD("#securesharedialogdiv").unbind().bind("dialogclose",function(){return ZDDialog.closePopUp("securesharedialogdiv"),!1})},ZDDialog.closePopUp=function(e,t){ZD("#"+e).unbind("dialogclose"),"attachopenfiledialogdiv"==e?(ZD("#zd_leftmenu,#zd_rightmenu").unbind().remove(),ZD("#recentservicedocs").addClass("selectedView"),ZD("#serviceDialogLeftPanel,#showopenservicefilespace,div#selectboxdiv,div#searchdivforservicefiles,#servicefilepagination,table.toolbar").undelegate(),ZD("#attachopenfiledialogdiv").unbind("dialogclose"),ZD("div#showopenservicefilespace").openfiledatagrid("destroy"),ZD("#attachopenfiledialogdiv").dialog("destroy"),ZD("#attachopenfiledialogdiv").filedialog("destroy").remove(),ZD("#createnewfolderdiv,#frameDiv").dialog("destroy").remove()):"passworddialogdiv"==e?ZD("#passworddialogdiv").dialog("destroy").remove():"securesharedialogdiv"==e?(ZD("#securesharedialogdiv").dialog("destroy").remove(),public_PwdExpiryDate="",ZD_G_CurrentVisibility=""):"linkdocsdialogdiv"==e?(ZD("#recentservicedocs").addClass("selectedView"),ZD("div#showopenservicefilespace").linkdocsdatagrid("destroy"),ZD("#linkdocsdialogdiv").dialog("destroy"),ZD("#linkdocsdialogdiv").linkdocsdialog("destroy").remove()):"attachfiledialogdiv"==e?(ZD("#attachfiledialogdiv").unbind("dialogclose"),ZD("#zd_leftmenu,#zd_rightmenu,#homeButton").unbind().remove(),ZD("#serviceDialogLeftPanel,#showattachfilespace,div#selectboxdiv,div#servicefilepagination").undelegate(),ZD("div#showattachfilespace").attachfiledatagrid("destroy").remove(),ZD("div#attachfiledialogdiv").attachfiledialog("destroy").remove(),ZD("#attachfiledialogdiv").dialog("destroy").remove()):"zdattachcontainer"==e?(ZD("#zd_leftmenu,#zd_rightmenu,#homeButton").unbind().remove(),ZD("#serviceDialogLeftPanel,#showattachfilespace,div#selectboxdiv,div#servicefilepagination").undelegate(),ZD("div#showattachfilespace").attachfiledatagrid("destroy").remove(),ZD("#zdattachcontainer").attachfiledialog("destroy").remove()):"adddocdialogdiv"==e?(ZD("#adddocdialogdiv").unbind("dialogclose"),ZD("#expand_view,#folder_container").undelegate(),ZD("#"+e).dialog("destroy").remove()):"frameDiv"==e||"createnewfolderdiv"==e||"sharedialogdiv"==e||"uploadConfirmDiv"==e?("sharedialogdiv"==e&&(ZD(".zdc_shareautocompletedialog.ui-autocomplete").remove(),ZD("#zd_leftmenu,#visibilityoptions_top").unbind(),ZD("#zd_leftmenu,#visibilityoptions_top").remove(),ZD("#sharedialogdiv").undelegate(),ZD("#zdc_visible_default_hidediv").undelegate(),ZD("body").undelegate("#sharedialogdiv, #zdc_visible_default_hidediv, .ui-widget-overlay","click"),ZD("#zd_sharetextarea").autocomplete("destroy"),ZD("#zd_sharetextarea,#share_via_link_edit").unbind(),ZD("#frameDiv").dialog("destroy").remove(),G_COMP_OBJ.isReqFromDocs&&ZDUtils.deSelectDocs(),G_OF_OBJ.autocomplete_selectValue="",G_OF_OBJ.trimmedPerGroupIds="",G_OF_OBJ.trimmedOrgGroupIds="",G_OF_OBJ.trimmedEmails="",G_OF_OBJ.G_fromAutoComplete=[],G_OF_OBJ.isCo_owner=!1),"passwordvalidation"!=t&&ZD("#zdc_visible_default_hidediv").remove(),ZD("#"+e).dialog("destroy").remove()):"sharecollabupgradediv"==e?ZD("#"+e).dialog("destroy").remove():"mycollaboratorslistdiv"==e?ZD("#"+e).dialog("destroy").remove():"dialogdiv"==e?ZD("#"+e).html("").removeAttr("style").dialog("destroy"):"statusdialogdiv"==e?ZD("#"+e).dialog("destroy").remove():"customfieldsdialogdiv"===e?(ZD("#"+e).dialog("destroy").remove(),ZD("#"+e).remove()):"sharefileaslinkcontainer"===e?(ZD("#"+e).dialog("destroy").remove(),ZD("#"+e).remove()):"ui-zmoveto-dialog"===e?(ZD("#"+e).dialog("destroy").remove(),ZD("#"+e).remove()):"ui-zdocssaveas-dialog"===e?(ZD("#"+e).dialog("destroy").remove(),ZD("#"+e).remove()):"initSaveAs"===e&&(ZD("#"+e).dialog("destroy").remove(),ZD("#"+e).remove())},ZDDialog.showExternalUsersList=function(e,t,s,a,i,o){ZD("#frameDiv").remove(),(void 0==s||""==s)&&(s=[200,350]),width=450;var d=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(d).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:e,modal:!1,resizable:!1,closeText:"",buttons:t,position:s,width:width,draggable:!0,height:"auto",close:function(){ZD(this).dialog("destroy").remove()},open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return"invalidList"==i?ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>'+zd_js_obj.label_users_listed_invalid+':</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_to_continue_share_remove_users_share_again+"</div></div></div>").removeAttr("style"):3==a&&"externalList"==i&&0==o?ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>'+zd_js_obj.label_coowner_permission_not_allowed+'</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_continue_remove_users_share_again+"</div></div></div>").removeAttr("style"):ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>'+zd_js_obj.label_list_contains_people_not_part_organization+':</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_are_you_sure_you_want_to_share+"</div></div></div>").removeAttr("style"),ZD("#frameDiv").addClass("custommargin_lightgrey"),ZD("#frameDiv").bind("dialogclose",function(){return ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton(),!1}),!1},ZDDialog.showNonZohoUserList=function(e,t,s){ZD("#frameDiv").remove(),(void 0==s||""==s)&&(s=[200,350]),width=450;var a,i=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');a="NONE"==zd_third_party||""==zd_third_party||"undefined"==zd_third_party||void 0==zd_third_party?"zoho":zd_third_party.toLowerCase(),ZD(i).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:e,modal:!1,resizable:!1,closeText:"",buttons:t,position:s,width:width,draggable:!0,height:"auto",close:function(){ZD(this).dialog("destroy").remove()},open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return ZD("#frameDiv").empty().html('<div  style="display: block;"><div><div>'+ZDUtils.replaceParams(zd_js_obj.label_users_groups_listed_invalid,new Array(a))+':</div><div class="zdc-external-list"></div></div></div>').removeAttr("style"),ZD("#frameDiv").addClass("custommargin_lightgrey"),ZD("#frameDiv").bind("dialogclose",function(){return ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton(),!1}),!1},ZDDialog.showInactiveUserList=function(e,t,s){ZD("#frameDiv").remove(),(void 0==s||""==s)&&(s=[200,350]),width=450;var a=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(a).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:e,modal:!1,resizable:!1,closeText:"",buttons:t,position:s,width:width,draggable:!0,height:"auto",close:function(){ZD(this).dialog("destroy").remove()},open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>'+zd_js_obj.label_users_listed_are_inactive+'</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_to_continue_share_remove_users_share_again+"</div></div></div>").removeAttr("style"),ZD("#frameDiv").addClass("custommargin_lightgrey"),ZD("#frameDiv").bind("dialogclose",function(){return ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton(),!1}),!1},ZDDialog.sharePolicyFailList=function(e,t,s,a,i){ZD("#frameDiv").remove(),(void 0==s||""==s)&&(s=[200,350]),width=450;var o=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(o).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:e,modal:!1,resizable:!1,closeText:"",buttons:t,position:s,width:width,draggable:!0,height:"auto",close:function(){ZD(this).dialog("destroy").remove()},open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return"ext_fail"==a?ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>Your organization policy does not allow you to share with below users:</div><div class="zdc-external-list"></div><div>To continue sharing, please contact your administrator.</div></div></div>').removeAttr("style"):"accept_fail"==a&&ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>Organization policy of below user(s) does not allow you to share with them :</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_to_continue_share_remove_users_share_again+"</div></div></div>").removeAttr("style"),ZD("#frameDiv").addClass("custommargin_lightgrey"),ZD("#frameDiv").bind("dialogclose",function(){return ZDDialog.closePopUp("frameDiv"),"undefined"==typeof i&&(ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton()),!1}),!1},ZDDialog.showStatusDialog=function(e,t,s,a,i){var o=ZD('<div id="statusdialogdiv" style="display:none;"></div>');if(ZD(o).appendTo("body"),(""===s||void 0===s)&&(s=[SCR_WTH-SCR_WTH/1.6,SCR_HT-SCR_HT/1.6]),ZDdialog=ZD("#statusdialogdiv").dialog({autoOpen:!0,title:e,modal:t,resizable:!1,closeText:"",buttons:"",position:s,width:a,draggable:!0,height:i,open:function(){ZD(".ui-dialog-titlebar-close").hide()}}),!ZD("#statusdialogdiv").parent(".dialog-inner-container").length){var d=ZD('<div class="ui-corner-all dialog-inner-container" style="display:block;"></div>');d.insertBefore(ZD("#statusdialogdiv")).append(ZD("#statusdialogdiv"))}if(ZD(".sshow_layoutcontainer").length){var r=parseInt(ZD(".sshow_layoutcontainer").css("z-index"));ZD("#statusdialogdiv").closest(".ui-dialog").css("z-index",r+5)}ZD("#statusdialogdiv").unbind().bind("dialogclose",function(){return ZDDialog.closePopUp("statusdialogdiv"),!1})},ZDDialog.showPreviewImg=function(e,t,s){ZDDialog.showCommonDialog(e,!0,"dialogdiv","","",SCR_WTH/1.35,!0,SCR_HT/1.5);var a='<div align="center"  style="padding:10px;"><img src="'+s+'" style="max-height:'+SCR_HT/1.5+'px" /></div>';ZD("#dialogdiv").html(a)},ZDUtils.SIZE_CALC_WITH_BYTES=1024,ZDUtils.getHeight=function(){var e;return self.innerHeight?e=self.innerHeight:document.documentElement&&document.documentElement.clientHeight?e=document.documentElement.clientHeight:document.body&&(e=document.body.clientHeight),e},ZDUtils.getWidth=function(){var e;return self.innerHeight?e=self.innerWidth:document.documentElement&&document.documentElement.clientHeight?e=document.documentElement.clientWidth:document.body&&(e=document.body.clientWidth),e},ZDUtils.isEmailId=function(e){if(!e)return!1;e=e.trim();var t=/^(([\w\.]+)|[\w]([\w\-\.\+\'\/]*)@([\w\.\-]+\.[a-zA-Z]{2,22}))$/i;return t.test(e)},ZDUtils.substringName=function(e,t){var s=e;return s.length>t&&(s=s.substring(0,t),s+=".."),s},ZDUtils.escapeSpecialCharacters=function(e){e+="";var t=e.replace(/"/g,"&quot;"),s=t.replace(/'/g,"&apos;"),a=s.replace(/</g,"&lt;"),i=a.replace(/>/g,"&gt;");return i},ZDUtils.hasSpecialChar=function(e,t){var s="!@#$%^&*()+=-[]\\';,/{}|\":<>?";"docrename"==t?s="<>*%#&?\\',\"()":"emailidchk"==t&&(s="!#$%^&*()+=-[]\\';/{}|\":<>?");for(var a=1,i=0;i<e.length;i++)-1!=s.indexOf(e.charAt(i))&&(a+=1);return a>1?(FILEDIALOG.statusmsg("failure_status boldText",zd_js_obj.special_characters_validaton),!0):!1},ZDUtils.hasWhiteSpaceChar=function(e,t){return""===e?("renamefolder"==t?FILEDIALOG.statusmsg("failure_status boldText",zd_js_obj.folder_name_empty_validation):FILEDIALOG.statusmsg("failure_status boldText",zd_js_obj.document_name_empty_validation),!0):!1},ZDUtils.showAlertBox=function(e,t){"rename"==t?FILEDIALOG.statusmsg("failure_status boldText",e):"folder"==t?FILEDIALOG.statusmsg("failure_status boldText",zd_js_obj.folder_name_empty_validation):ZDDialog.openAlert(zd_js_obj.alert,e,!0)},ZDUtils.LoadingMsg=function(e){var t=zd_js_obj.loading;""!=e&&void 0!=e&&(t=e),ZD("#msgdiv").remove(),ZD("#openloadingmsg").append('<span  id="msgdiv" class="zdcomp_loading">'+t+"</span>")},ZDUtils.hideLoadingMsg=function(){ZD("#openloadingmsg").children().remove()},ZDUtils.openFileLoadingMsg=function(e){var t="Loading...";""!=e&&void 0!=e&&(t=e);var s=ZD("#showopenservicefilespace").height()/2.2,a=ZD("#showopenservicefilespace").width()/2.2;ZD("#openfileloadingdiv").css({"margin-left":a,"margin-top":s,display:"block"}).find("span").html(t)},ZDUtils.hideOpenFileLoadingMsg=function(){ZD("#openfileloadingdiv").hide()},ZDUtils.showLoading=function(e,t){var s=zd_js_obj.loading;void 0!=t&&""!=t&&(s=t);var a=e+"_msg";ZD("#"+a).remove(),ZD("#"+e).append('<span  id="'+a+'" class="zdcomp_loading">'+s+"</span>")},ZDUtils.hideLoading=function(e){ZD("#"+e).hide()},ZDUtils.getI18N=function(e){ZDUtils.getUserRelatedDetails("",e)},ZDUtils.split=function(e){return e.split(/,\s*/)},ZDUtils.extractLast=function(e){var t=e.toString();return ZD.trim(ZDUtils.split(t).pop())},ZDUtils.startsWithRegEx=function(e,t){var s=e.label,a=s.substring(0,s.indexOf("(")-1).trim();if((void 0==a||""==a)&&(a=s),a=a.toLowerCase(),t=t.toLowerCase(),a.substring(0,t.length)==t)return e;var i=ZDUtils.getLastNameOfContact(a);if(i=i.toLowerCase(),i.substring(0,t.length)==t)return e;var o=s.substring(s.indexOf("(")+1,s.length);return o=o.toLowerCase(),void 0==o||""==o?"":o.substring(0,t.length)==t?e:void 0},ZDUtils.getLastNameOfContact=function(e){var t=e.substring(e.lastIndexOf(" ")+1,e.length);return t},ZDUtils.validateResource=function(e,t,s){window.canLoadWDOrDocsDialog||(window.canLoadWDOrDocsDialog=!1);var a="/workdriveapi/getproductinfo.do?rid="+s;ZD.ajax({url:a,type:"GET",dataType:"html",success:function(a){window.isWDCustomDomain=!1;var i=JSON.parse(a);i.isCustomDomain&&(window.isWDCustomDomain=i.isCustomDomain),ZDUtils.getCustomerRelatedDetails(e,t,s,a)}})},ZDUtils.getUserDetails=function(e,t,s){ZDUtils.validateResource(e,t,s)},ZDUtils.getUserRelatedDetails=function(e,t,s){if(s)ZDUtils.validateResource(e,t,s);else{var a='{"isTeamResource":false}';ZDUtils.getCustomerRelatedDetails(e,t,s,a)}},ZDUtils.getCustomerRelatedDetails=function(e,t,s,a){var i=ZD.parseJSON(a),o="";if(i.isTeamResource){window.ZD_IS_NEW_UI_ENABLED=!0,window.tdURL=i.pcUrl,window.wdResId=s,window.wdStaticURLs={},"undefined"!=typeof i.jsStaticDomain&&(wdStaticURLs.JS_STATIC_DOMAIN=i.jsStaticDomain),"undefined"!=typeof i.CDN_STATIC_DOMAIN&&(wdStaticURLs.CDN_STATIC_DOMAIN=i.CDN_STATIC_DOMAIN);var d=document.createElement("script");return d.type="text/javascript",d.src=i.CDN_STATIC_DOMAIN+"/personal/stable/jsapps/workdrive-third-party/workdrive-components.js",d.async=!1,document.getElementsByTagName("head")[0].appendChild(d),void(d.onload=function(){window.workdriveinstance=new WorkDrive,window.canLoadWDOrDocsDialog=!0})}if(o="/docs/zduserdetails.do",""!=t&&void 0!=t){var r=t.charAt(t.length-1);"/"!=r&&(t+="/"),o=t+"docs/zduserdetails.do"}var n="_t="+ZD.now()+(G_COMP_OBJ.isReqFromDocs?"&service=docs":"");void 0!==s&&(n=n+"&resourceId="+s),ZD.ajax({url:o,type:"GET",data:n,dataType:"html",success:function(s){if(ZD("body").append(ZD(s).filter("#zd_user_details")[0]),ZD("body").append(ZD(s).filter("#zd_i18ndetails")[0]),zd_js_obj=JSON.parse(ZD("#zd_i18ndetails").attr("zd_js_obj")),ZD("body").append(ZD(s).filter("#zd_component_variables")[0]),window.ZUID=ZD("#zd_component_variables").attr("zuid"),window.zd_isorguser="true"==ZD("#zd_component_variables").attr("zd_isorguser")?!0:!1,window.orgnameofcurrentuser=ZD("#zd_component_variables").attr("orgnameofcurrentuser"),window.orgLabel=zd_js_obj.label_everyone_org,orgnameofcurrentuser.length){var a=orgnameofcurrentuser;if(orgnameofcurrentuser.length>40)var a=orgnameofcurrentuser.substring(0,40);orgLabel=ZDUtils.replaceParams(zd_js_obj.label_everyone_orgname,new Array(a))}if(window.userFullName=ZD("#zd_component_variables").attr("userFullName"),window.PC_USER_PLAN_TYPE=parseInt(ZD("#zd_component_variables").attr("PC_USER_PLAN_TYPE")),window.zd_third_party=ZD("#zd_component_variables").attr("zd_third_party"),window.ZOHO_CN=ZD("#zd_component_variables").attr("ZOHO_CN"),window.docsCSRFParamNAME=ZD("#zd_component_variables").attr("docsCSRFParamNAME"),window.docsCSRFCookieName=ZD("#zd_component_variables").attr("docsCSRFCookieName"),window.isCommentEnabled="true"==ZD("#zd_component_variables").attr("isCommentEnabled")?!0:!1,window.serviceUrl=ZD("#zd_component_variables").attr("serviceUrl"),window.pcUrl=ZD("#zd_component_variables").attr("pcUrl"),window.docsExternalURL=ZD("#zd_component_variables").attr("docsExternalURL"),window.zd_serviceName=ZD("#zd_component_variables").attr("zd_serviceName"),window.zd_udservicekey=ZD("#zd_component_variables").attr("zd_udservicekey"),window.zd_udserverurl=ZD("#zd_component_variables").attr("zd_udserverurl"),window.userCanShareExternally=ZD("#zd_component_variables").attr("userCanShareExternally"),window.IAM_URL=ZD("#zd_component_variables").attr("IAM_URL"),window.currentBrowserDetails=ZD("#zd_component_variables").attr("currentBrowserDetails"),window.isCommonErrorPageEnabled="true"==ZD("#zd_component_variables").attr("isCommonErrorPageEnabled")?!0:!1,window.ZD_GUEST_EDIT_SHEET="true"==ZD("#zd_component_variables").attr("ZD_GUEST_EDIT_SHEET")?!0:!1,window.ZD_GUEST_EDIT_SHOW="true"==ZD("#zd_component_variables").attr("ZD_GUEST_EDIT_SHOW")?!0:!1,window.ZD_COMMENT_ENABLEDFOR_SHEET="true"==ZD("#zd_component_variables").attr("ZD_COMMENT_ENABLEDFOR_SHEET")?!0:!1,window.ZD_COMMENT_ENABLEDFOR_SHOW="true"==ZD("#zd_component_variables").attr("ZD_COMMENT_ENABLEDFOR_SHOW")?!0:!1,window.ZD_SHARENOTE_GOTIT_ORGSHARE="true"==ZD("#zd_component_variables").attr("ZD_SHARENOTE_GOTIT_ORGSHARE")?!0:!1,window.ZD_SHARENOTE_GOTIT_LINKSHARE="true"==ZD("#zd_component_variables").attr("ZD_SHARENOTE_GOTIT_LINKSHARE")?!0:!1,window.ZD_SHARENOTE_GOTIT_SECUREEMAILSHARE="true"==ZD("#zd_component_variables").attr("ZD_SHARENOTE_GOTIT_SECUREEMAILSHARE")?!0:!1,window.zdc_ContactsURL=ZD("#zd_component_variables").attr("zdc_ContactsURL"),window.css_lable=ZD("#zd_component_variables").attr("css_lable"),window.compStaticServer=ZD("#zd_component_variables").attr("compStaticServer"),window.staticVersionToLoad=ZD("#zd_component_variables").attr("staticVersionToLoad"),window.READ_CMT_ENABLED_SERVICES="zw",window.ZD_IS_NEW_UI_ENABLED=ZD("#zd_component_variables").attr("ZD_IS_NEW_UI_ENABLED"),ZD_COMMENT_ENABLEDFOR_SHEET&&(READ_CMT_ENABLED_SERVICES+="|zohosheet"),ZD_COMMENT_ENABLEDFOR_SHOW&&(READ_CMT_ENABLED_SERVICES+="|zohoshow"),window.ZDOCScsrfToken=ZD("#zd_component_variables").attr("ZDOCScsrfToken"),serviceUrl=window.location.origin,window.zdcsrfPair=window.docsCSRFParamNAME+"="+window.ZDOCScsrfToken,window.canLoadWDOrDocsDialog=!0,isCommonErrorPageEnabled&&("WRITER"==zd_serviceName||"SHEET"==zd_serviceName||"SHOW"==zd_serviceName||"DOCS"==zd_serviceName)&&!currentBrowserDetails.IS_SUPPORTED_BROWSER){var i=ZD("#browser-error-msg").html();if(null!=i)if(ZD(document).znotifier)ZD(document).znotifier({type:"warning",iconclass:"ui-components-icon ui-state-warning-icon",position:"north",content:i,autohide:!1});else{var o='<div id="browserErrorMsg" style="width: auto; text-align: center; margin: 0 auto; -webkit-border-bottom-right-radius: 7px; -webkit-border-bottom-left-radius: 7px; -moz-border-radius-bottomright: 7px; -moz-border-radius-bottomleft: 7px; border-bottom-right-radius: 7px; border-bottom-left-radius: 7px; -moz-box-shadow: 0px 0px 4px #d8d8d8; box-shadow: 0px 0px 4px #d8d8d8; -webkit-box-shadow: 0px 0px 4px #d8d8d8; box-shadow: 0px 0px 4px #d8d8d8; position: fixed; top: 0; z-index: 9999; left: 40%; margin-left: -25%; background: #fff; border-color: #d1d6ed; color: #000; padding: 10px; font-size: 12px; border-left: 1px solid #d1d6ed; border-right: 1px solid #d1d6ed; overflow: hidden; text-align: center; border-bottom-right-radius: 7px;">'+i+'<span style="padding-left: 5px; padding-right: 5px;">|</span><a href="javascript:void(0)" style="cursor: pointer; text-decoration: underline;" onclick="ZD(\'#browserErrorMsg\').hide();">'+zd_js_obj.label_close+"</a></div>";ZD("body").append(o)}}"undefined"==typeof ZD_G_ContactSearchEnabled&&(window.ZD_G_ContactSearchEnabled=!0),ZDUtils.getPlanType("",t),void 0!=e&&""!=e&&"function"==typeof e&&e()}})},ZDUtils.triggerUploadList=function(e){var t=ZD("#zd_user_details").attr("serviceName"),s=e.files,a=s[0].fileName,i=s[0].fileSize,o=0;(""==a||void 0==a)&&(a=s[0].name),(""==i||void 0==i)&&(i=s[0].size);var d=a.split(".")[a.split(".").length-1],o=0;if(i>SIZE_CALC_WITH_BYTES*SIZE_CALC_WITH_BYTES)return alert("Upload files greater than 10MB"),ZDDialog.closePopUp("uploadConfirmDiv"),!1;if("WRITER"==t){if("doc"!=d.toLowerCase()&&"docx"!=d.toLowerCase()&&"odt"!=d.toLowerCase()&&"rtf"!=d.toLowerCase())return alert("Only this files doc,docx,odt,rtf are allowed"),ZDDialog.closePopUp("uploadConfirmDiv"),o-=1,!1;ZDUtils.uploadProgress(e)}else if("SHEET"==t){if("xls"!=d.toLowerCase()&&"xlsx"!=d.toLowerCase()&&"sxc"!=d.toLowerCase()&&"ods"!=d.toLowerCase()&&"csv"!=d.toLowerCase()&&"tsv"!=d.toLowerCase())return alert("Only this files xls,xlsx,sxc,ods,csv,tsv are allowed"),ZDDialog.closePopUp("uploadConfirmDiv"),o-=1,!1;ZDUtils.uploadProgress(e)}else if("SHOW"==t){if("pptx"!=d.toLowerCase()&&"ppsx"!=d.toLowerCase()&&"ppt"!=d.toLowerCase()&&"pps"!=d.toLowerCase()&&"odp"!=d.toLowerCase()&&"sxi"!=d.toLowerCase())return alert("Only this files pptx,ppsx,ppt,pps,odp,sxi are allowed"),ZDDialog.closePopUp("uploadConfirmDiv"),o-=1,!1;ZDUtils.uploadProgress(e)}},ZDUtils.uploadProgress=function(e){var t=ZDUtils.updateFileNameSelected(e),s=ZD("#uploadfilediv"),a="target"+(new Date).getTime(),i=(ZDUtils.createIframe(a),ZDUtils.createForm(t,a)),o=(ZD(e).parent(),ZD(e).clone());ZD(o).unbind(),i.append(e),s.append(i)},ZDUtils.updateFileNameSelected=function(e){var t=ZD(e).attr("value"),s=ZDUtils.getFileName(t);-1!=s.toLowerCase().indexOf(".zip")&&(s=s.substring(0,s.length-4)+".zip");var a=(new Date).getTime();return ZDUtils.showFileList(s,a,!1,!1),a},ZDUtils.showFileList=function(e){return ZD(".fileinfo").text("Selected File"),ZD("#upload_detailview").text(e),ZD(".file_size_info").addClass("hidediv"),!1},ZDUtils.createIframe=function(e){var t=ZD('<iframe  name="'+e+'">').attr({height:"0",width:"0",id:e}).css("display","none");return ZD(t).appendTo("body"),t},ZDUtils.createForm=function(e,t){var s=ZD("<form></form>");return s.attr({id:"form-"+e,target:t,name:"form-"+e,method:"POST",encType:"multipart/form-data",encoding:"multipart/form-data"}),s.css({margin:0,display:"none"}),s},ZDUtils.getFileName=function(e){var t,s=e;t=s.lastIndexOf(isWin||chrome7||isSafari?"\\":"/");var a=s.substring(t+1);return a},ZDUtils.deSelectDocs=function(){var e=ZD("div.selecteddoc");e.each(function(){ZD(this).closest("div.dataDiv").removeClass("select"),ZD(this).attr("class","unselecteddoc"),ZD(this).children().attr("class","normalcheckboxicon_css")}),ZD("#selectAllCheckBox").hasClass("selectcheckboxicon_css")&&ZD("#selectAllCheckBox").attr({"class":"normalcheckboxicon_css",name:"allDocsUnSelected"})},ZDUtils.deSelectDoc=function(e){ZD("div[id="+e+"]").removeClass("select").find("div.selecteddoc").attr("class","unselecteddoc").children().attr("class","normalcheckboxicon_css")},ZDUtils.replaceParams=function(e,t){if("undefined"!=t&&t.length>0)for(i=0;i<t.length;i++)e=ZDUtils.replace(e,"{"+i+"}",t[i]);return e},ZDUtils.replace=function(e,t,s){var a=e.length,i=t.length;if(0===a||0===i)return e;var o=e.indexOf(t);if(!o&&t!=e.substring(0,i))return e;if(-1==o)return e;var d=e.substring(0,o)+s;return a>o+i&&(d+=ZDUtils.replace(e.substring(o+i,a),t,s)),d},ZDUtils.statusmsg=function(e,t,s){ZD("#docs_statusmsg_div").length&&ZD("#docs_statusmsg_div").remove();var a='<div style="width:100%;position:absolute;padding-top:5px;" id="docs_statusmsg_div"><div align="center"><span id="statusmsgdiv" class=""></span></div></div>';ZD("#"+s).prepend(a),ZD("span#statusmsgdiv").attr("class",e).html(t).parent().css("display","block"),setTimeout(function(){ZD("#docs_statusmsg_div").remove()},4e3)},ZDUtils.getMyContacts=function(e,t){var s;s="method=getContacts&_t="+ZD.now()+"&"+zdcsrfPair;var a=serviceUrl+"/docs/docsrequest.do";void 0!=t&&""!=t&&(a=t+"docs/docsrequest.do"),ZD.ajax({url:a,data:s,dataType:"json",type:"POST",success:function(e){docs_myContacts=e.contact_list}})},ZDUtils.getPersonalContacts=function(e){var t;t="method=getPersonalContacts&_t="+ZD.now()+"&"+zdcsrfPair;var s=serviceUrl+"/docs/docsrequest.do";void 0!=e&&""!=e&&(s=e+"docs/docsrequest.do"),ZD.ajax({url:s,data:t,dataType:"json",type:"POST",success:function(e){docs_myContacts=e.contact_list}})},ZDUtils.getPlanType=function(e,t){var s="undefined"==typeof e||""===e?!0:e;if(void 0!=t&&""!=t)var a=t+"docs/docsrequest.do?method=getPlanType";else var a=serviceUrl+"/docs/docsrequest.do?method=getPlanType";return ZD.ajax({async:s,url:a,dataType:"json",type:"GET",success:function(e){zdcomp_userType=e.response.result.PlanType.MESSAGE,("WRITER"==zd_serviceName||"SHEET"==zd_serviceName||"SHOW"==zd_serviceName||"DOCS"==zd_serviceName)&&("FREE_PLAN_TYPE"!=zdcomp_userType&&""!=zdcomp_userType&&void 0!=zdcomp_userType&&"undefined"!=typeof zdcomp_userType?"undefined"!=typeof ZD_G_ContactSearchEnabled&&ZD_G_ContactSearchEnabled||ZDUtils.getMyContacts("",t):"undefined"!=typeof ZD_G_ContactSearchEnabled&&ZD_G_ContactSearchEnabled||ZDUtils.getPersonalContacts(t))},error:function(){zdcomp_userType=""}}),!1},ZDUtils.getSelectedDocuments=function(){var e="";"explorer"===G_SwitchTab?e="#explorergrid":"workspace"===G_SwitchTab?e="#wsdocsgrid":"group"===G_SwitchTab?e="#showgroupdocspace":"tag"===G_SwitchTab?e="#taggrid":"search"===G_SwitchTab&&(e="#searchgrid");var t=ZD("div.selectcheckboxicon_css",e);return t},ZDUtils.getOwnedSelectedDocs=function(){var e=ZDUtils.getSelectedDocuments(),t=[];return e.each(function(e){var s={},a=ZD(this).closest("div.dataDiv"),i=ZD(this).closest("div.folderDiv"),o=a.data("scope");if(0===o){var d=a.attr("id"),r=a.data("permission"),n=a.data("fileName"),l=a.data("encFileName"),c=a.data("encAttrFileName"),_=a.data("encUrlFileName"),p=a.data("serviceType"),h=a.data("fileType"),D=a.data("fileExt"),v=a.data("authorId"),u=a.data("classIconName"),m=a.data("encSharedDocId"),f=a.data("is_doc_author"),O=a.data("parentId"),g=a.attr("fileId");authorName=a.data("authorName"),isLocked=a.data("isLocked"),lockedBy=a.data("lockedBy"),s.isFolder=i.length?!0:!1,s.isDocAuthor=f,s.authorId=v,s.encSharedDocId=m,s.docId=d,s.scope=o,s.permission=r,s.fileId=g,s.file_name=n,s.encFile_name=l,s.encAttrFile_name=c,s.encUrlFile_name=_,s.service=p,s.filetype=h,s.fileext=D,s.classname=u,s.authorName=authorName,s.parentId=O,s.isLocked=isLocked,s.lockedBy=lockedBy,t[e]=s,parseInt(s.scope)>0&&(sharedDocExist=!0)}else 1===o&&(a.removeClass("select"),ZD(this).attr("class","normalcheckboxicon_css"))}),t},ZDUtils.getSelectedDocumentIds=function(){var e=ZDUtils.getOwnedSelectedDocs();if(!e.length)return alert("Document Visibility can be set for owned documents only."),!1;for(var t="",s=0;s<e.length;s++)t+=e[s].docId+",";return t},ZDUtils.insertDynamicButton=function(e,t,s,a,i){var o='<button style="margin-right:5px;"   class="ui-button ui-widget ui-state-default ui-corner-all  zd_dynamicbutton"><span class="ui-button-text">'+e+"</span></button>";if(ZD("#"+s+" button:nth-child("+t+")").remove(),1==t?ZD("#"+s).prepend(o):ZD("#"+s).append(o),a){var d='<span class="ui-button-icon-primary ui-icon ui-icon-loader"></span>';ZD(".zd_dynamicbutton").addClass("ui-button-disabled ui-state-disabled ui-status-icon ui-button-text-icon-primary").prepend(d)}else ZD(".zd_dynamicbutton").addClass("ui-button-text-only");""!=i&&void 0!=i&&ZD(".zd_dynamicbutton").unbind().bind("click",function(){return i(),!1})},ZDUtils.loadComponentsStaticFiles=function(e,t,s){var a=navigator.userAgent.match(/(?:MSIE |Trident\/.*; rv:)(\d+)/),i=(a?parseInt(a[1]):void 0,function(e,t){var s=document.getElementsByTagName("head")[0];if(!jQuery("#css_linkdocscomponents").length){var a=document.createElement("link");a.href=e,a.rel="stylesheet",a.type="text/css",a.id="css_linkdocscomponents",s.appendChild(a)}if(!jQuery("#js_linkdocscomponents").length){var i=document.createElement("script");i.src=t,i.type="text/javascript",i.id="js_linkdocscomponents",s.appendChild(i)}}),o=e+"/docs/docsrequest.do?method=loadComponentsStaticFiles",d="service="+t.toUpperCase()+"&_t="+(new Date).getTime();jQuery.ajax({url:o,type:"GET",dataType:"json",data:d,xhrFields:{withCredentials:!0},success:function(e){if("undefined"==typeof s){var t=e.cssfilepath,a=e.jsfilepath;i(t,a)}else s(e)}})},ZDUtils.loadZDCStaticFilesForEditors=function(e,t,s,a){var i=location.protocol+"//"+location.hostname+"/docs/docsrequest.do?method=loadComponentsStaticFiles",o="service="+e+"&_t="+(new Date).getTime();void 0!==t&&(o+="&jsfilename="+t),void 0!==s&&(o+="&cssfileName="+s),jQuery.ajax({url:i,type:"GET",dataType:"json",data:o,success:function(e){var t=e.cssfilepath,s=e.jsfilepath,i=(e.staticversiontoload,e.jsfilename),o=e.cssfilename;if("undefined"!=typeof a)a(e);else{var d=function(e,t){var s=document.getElementsByTagName("head")[0];if(!jQuery("#"+o).length){var a=document.createElement("link");a.href=e,a.rel="stylesheet",a.type="text/css",a.id=o,s.appendChild(a)}if(!jQuery("#"+i).length){var d=document.createElement("script");d.src=t,d.type="text/javascript",d.id=i,s.appendChild(d)}};d(t,s)}}})},ZDUtils.matchFullNameForCommentMentions=function(e,t){var s=e.name;return s=s.toLowerCase(),t=t.toLowerCase(),s.substring(0,t.length)===t?e:""},G_COMP_CONSTANTS=function(){this.isReqFromDocs=!1,this.serviceType=""};var G_COMP_OBJ=new G_COMP_CONSTANTS,zd_isIE="";!function(){var e=navigator.userAgent.match(/(?:MSIE |Trident\/.*; rv:)(\d+)/);zd_isIE=e?parseInt(e[1]):void 0}();var G_OF_OBJ,G_FormDataArray=[],G_FileDataArray=[],G_UploadIndexCounter=0,ZD_collaboratorCount=0,docs_myContacts=[],user_emailContacts=[],ZD=jQuery,zd_js_obj="",zdcsrfPair,isWin=-1!=navigator.appVersion.indexOf("Win")?!0:!1,isSafari=navigator.userAgent.toLowerCase().indexOf("safari")>-1,userAgent=navigator.userAgent.toLowerCase(),us=userAgent.substring(userAgent.indexOf("chrome/")+7),chrome7=parseInt(us.substring(us,us.indexOf(".")))>=7?!0:!1,zdcomp_userType,ZD_G_CurrentVisibility="private",public_PwdExpiryDate="",G_LD_OBJ,zd_js_obj="";LINKDOCS.showLinkFileDialog=function(e){var t=e.docsURL;if(G_LD_OBJ=new LINKDOCS,G_LD_OBJ.urlInvoker=e.servicename,G_LD_OBJ.docsIframeURL=e.docsIframeURL,G_LD_OBJ.iamServiceName=e.iamServiceName,void 0==zd_js_obj||""==zd_js_obj){var s=function(){LINKDOCS.showLinkFileDialog(e)};return LINKDOCS.getI18N(s,t,e),!1}if(!ZD("#linkdocsdialogdiv").length){G_LD_OBJ.attachObj=ZD.extend({},G_LD_OBJ.defaultObj,e),G_LD_OBJ.filelimit=G_LD_OBJ.attachObj.filelimit,G_LD_OBJ.uploadenable=e.uploadenable,G_LD_OBJ.zsoid=G_LD_OBJ.attachObj.zsoid,G_LD_OBJ.service=e.service,G_LD_OBJ.progresscallbck=e.progresscallbck,"cms"!==G_LD_OBJ.urlInvoker&&(G_LD_OBJ.search=G_LD_OBJ.attachObj.search),G_LD_OBJ.docsURL=t,G_LD_OBJ.uploadFileLimit=e.uploadFileLimit,G_LD_OBJ.callBackFn=e.callBackFn,G_LD_OBJ.udserverEnable=e.udserverEnable,G_LD_OBJ.staticURL=G_LD_OBJ.attachObj.staticURL,G_LD_OBJ.thumbnailview=G_LD_OBJ.attachObj.thumbnailview,G_LD_OBJ.listview=G_LD_OBJ.attachObj.listview,G_LD_OBJ.wsId=G_LD_OBJ.attachObj.wsId,G_LD_OBJ.container_id=e.container_id,G_LD_OBJ.staticURL=location.protocol+"//"+css_lable+"."+compStaticServer+"/personal/docs_"+staticVersionToLoad,G_LD_OBJ.spacerImagePath=G_LD_OBJ.staticURL+"/images/spacer.gif",""!==G_LD_OBJ.container_id&&void 0!==G_LD_OBJ.container_id?ZD("#"+G_LD_OBJ.container_id).append('<div id="zdlinkcontainer" class="docsdialog">'):ZD("body").append('<div id="linkdocsdialogdiv" style="display:none;">');var a={},i=G_LD_OBJ.attachObj.positionObj,o=G_LD_OBJ.attachObj.isDraggable,d=G_LD_OBJ.attachObj.isResize,r=G_LD_OBJ.attachObj.height,n=G_LD_OBJ.attachObj.width,l=G_LD_OBJ.attachObj.zIndex;void 0!==G_LD_OBJ.attachObj.wsId&&""!==G_LD_OBJ.attachObj.wsId&&(G_LD_OBJ.wsId=G_LD_OBJ.attachObj.wsId),void 0!==G_LD_OBJ.attachObj.wsAuthorId&&""!==G_LD_OBJ.attachObj.wsAuthorId&&(G_LD_OBJ.wsAuthorId=G_LD_OBJ.attachObj.wsAuthorId);var c=400;zd_isIE&&"crm"==G_LD_OBJ.urlInvoker&&(c=585),G_LD_OBJ.attachlabel=zd_js_obj.label_attach,"insert"===e.attachlabel&&(G_LD_OBJ.attachlabel="Insert",G_LD_OBJ.fileType=e.fileType),""!==G_LD_OBJ.container_id&&void 0!==G_LD_OBJ.container_id?(ZD("div#zdlinkcontainer").linkdocsdialog({workspaces:{show:!0,name:zd_js_obj.folders},recentDocs:{show:!0,name:zd_js_obj.label_recent_docs}}),ZD("div#showopenservicefilespace").linkdocsdatagrid()):(a[G_LD_OBJ.attachlabel]=function(){LINKDOCS.getSelectedDocList()},a[zd_js_obj.cancel]=function(){ZDDialog.closePopUp("linkdocsdialogdiv")},"cms"===G_LD_OBJ.urlInvoker?(ZDDialog.showCommonDialog(zd_js_obj.attach_from_documents,!0,"linkdocsdialogdiv",a,i,n,o,r,d,400,c,l),ZD("div#linkdocsdialogdiv").css("height","400px"),ZD("div#linkdocsdialogdiv").linkdocsdialog({workspaces:{show:!0,name:zd_js_obj.folders},recentDocs:{show:!0,name:zd_js_obj.label_recent_docs}}),ZDUtils.LoadingMsg(zd_js_obj.loading),ZDUtils.hideLoadingMsg(),ZD("div#showopenservicefilespace").linkdocsdatagrid()):(ZDDialog.showCommonDialog(zd_js_obj.attach_from_documents,!0,"linkdocsdialogdiv",a,i,n,o,r,d,400,c,l),ZD("div#linkdocsdialogdiv").css("height","400px"),ZD("div#linkdocsdialogdiv").linkdocsdialog({workspaces:{show:!0,name:zd_js_obj.folders},recentDocs:{show:!0,name:zd_js_obj.label_recent_docs}}),ZD("div#showopenservicefilespace").linkdocsdatagrid()))}},LINKDOCS.showUploadedFile=function(e){ZD("#noitems").remove();var t=G_LD_OBJ.docsURL+"/api/v2/files/properties?action=jsonobject&crossdomain=true&accessService="+G_LD_OBJ.urlInvoker+"&zsoid="+G_LD_OBJ.zsoid+"&resourceid="+e+"&"+zdcsrfPair;ZD.ajax({url:t,datatype:"json",xhrFields:{withCredentials:!0},success:function(t){ZD("#thumbnailcontainer").prepend("<div id="+e+' style="float:left;" class="docscursor"><div style="width:75px;height:75px;"><img src="'+t.preview_url+'" class="backupPic_'+e+'" style="height:75px;width:75px;"></div><div style="height:18px"><p style="overflow:hidden;font-size:small;margin-top:0px;height:18px;width:81px;margin-left:-3px;white-space: nowrap;" title="'+t.enc_res_name+'">'+t.enc_res_name+"</p></div></div>"),ZD(".backupPic_"+t.res_id).error(function(){LINKDOCS.imgLoadingError(t.no_preview_class,this)}),ZD("[id='"+t.res_id+"']").click(function(){LINKDOCS.selectDoc(this,t.res_id,t.enc_res_name,t.download_url),ZD("div#showopenservicefilespace").linkdocsdatagrid("showSelectedDocs")}),ZD("[id='"+t.res_id+"']").removeClass("thumb-select").addClass("thumb-deselect")}})},LINKDOCS.getLinkDocs=function(){ZD("body").append('<div id="linkdocsdialogdiv" style="display:none;">');var e={};e[zd_js_obj.label_attach]=function(){LINKDOCS.attachFiles()},e[zd_js_obj.cancel]=function(){ZDDialog.closePopUp("linkdocsdialogdiv")},ZDDialog.showCommonDialog("Link To Documents",!0,"linkdocsdialogdiv",e,[50,150],650,!0,"auto"),ZD("div#linkdocsdialogdiv").linkdocsdialog({workspaces:{show:!0}}),ZD("div#showopenservicefilespace").linkdocsdatagrid()},LINKDOCS.getDocsList=function(e,t){var s;""!=e&&void 0!=e?s=ZD(e).attr("id"):""!=t&&void 0!==t&&(s=t),"zsoidwsdocs"==s&&(void 0!==G_LD_OBJ.attachObj.wsId&&""!==G_LD_OBJ.attachObj.wsId?(G_LD_OBJ.wsId=G_LD_OBJ.attachObj.wsId,G_LD_OBJ.folderId=G_LD_OBJ.attachObj.wsId):G_LD_OBJ.wsId="workspace"),""!=s&&void 0!=s&&(LINKDOCS.changeAllToNormalView(s),G_LD_OBJ.selectedLeftPanel=s),LINKDOCS.resetAll(),ZD("div#showopenservicefilespace").linkdocsdatagrid("populateDataPanel")},LINKDOCS.resetAll=function(){LINKDOCS.reset();var e=ZD("#showopenservicefilespace").children();ZD(e).each(function(e,t){ZD(t).empty().remove()}),ZD("#showopenservicefilespace").linkdocsdatagrid("resetOptions"),ZD("#servicefilepagination").css("display","none")},LINKDOCS.changeAllToNormalView=function(e){ZD("#serviceDialogLeftPanel").find("td.selectedView").toggleClass("selectedView normalView"),""!=e&&void 0!=e&&ZD("#"+e).addClass("selectedView").removeClass("normalView")},LINKDOCS.reset=function(){G_LD_OBJ.fromIndex="0",G_LD_OBJ.endIndex="10",G_LD_OBJ.prevIndex="1",G_LD_OBJ.nextIndex="10",G_LD_OBJ.startFrom="0"},LINKDOCS.selectRow=function(e){ZD("#"+e).find("td.checkboxtd").children().removeClass("normalcheckboxicon_css").addClass("selectcheckboxicon_css"),ZD("#"+e).children("table.data-hover").addClass("zd_select")},LINKDOCS.deselectRow=function(e){ZD("#"+e).find("td.checkboxtd").children().removeClass("selectcheckboxicon_css").addClass("normalcheckboxicon_css"),ZD("#"+e).children("table.data-hover").removeClass("zd_select"),ZD("#selectedfile_"+e).length&&ZD("#selectedfile_"+e).remove()},LINKDOCS.showSelectedDocs=function(e){var t=ZD(e).closest("div.documentDataDiv"),s=t.attr("id");if(ZD(e).hasClass("zd_select"))return void LINKDOCS.deselectRow(s);LINKDOCS.selectRow(s);var a=t.attr("docName"),i='<div class="selectbox flleft" style="overflow:hidden;" id="selectedfile_'+s+'" docId="'+s+'" docName="'+a+'"><span class="flleft">'+a+'</span><span action="delete" id="'+s+'_delete" class="closeBtn_css flleft cursor cls"></span></div>';ZD("#selectboxdiv").append(i)},LINKDOCS.attachFiles=function(){ZD("#selectboxdiv").find(".selectbox").length>0&&ZD(".ui-dialog-buttonpane button:first").attr("disabled","disabled");var e=ZD("div.selectbox","#selectboxdiv"),t="",s="",a="",i="";if(0==e.length){var o={};return o[zd_js_obj.ok]=function(){ZDDialog.closePopUp("frameDiv")},void ZDDialog.openAlert(zd_js_obj.alert,zd_js_obj.select_the_documents,!0,o)}var d=LINKDOCS.getSelectedDocs();if(d.length>G_LD_OBJ.filelimit)return void ZDDialog.openAlert(zd_js_obj.alert,ZDUtils.replaceParams(zd_js_obj.validation_for_attachfile,new Array(G_LD_OBJ.filelimit+"")),!0);for(var r=0,n=d.length;n>r;r++)a=d[r].docId,documentName=d[r].docName,t=t+a+",",s=s+encodeURIComponent(documentName)+",";s=s.substring(0,s.length-1),t=t.substring(0,t.length-1),i+="docIds="+t+"&docNames="+s,ZDDialog.closePopUp("linkdocsdialogdiv"),docsIntegCallBackFn(i)},LINKDOCS.getSelectedDocs=function(){var e=ZD("div.selectbox","div#selectboxdiv"),t=[];return e.each(function(e){var s={},a=ZD(this).closest("div"),i=a.attr("docId"),o=a.attr("docName");docUrl=G_LD_OBJ.docsURL+"/ws/viewdoczsoid.do?docId="+i+"&ftype=image&filename="+o+"&zsoidservice=cms&zsoid="+G_LD_OBJ.zsoid,s.docId=i,s.docName=o,s.docUrl=docUrl,t[e]=s}),t},LINKDOCS.updateSelectedDocs=function(){for(var e=LINKDOCS.getSelectedDocs(),t=0,s=e.length;s>t;t++){var a=e[t].docId;LINKDOCS.selectRow(a)}},LINKDOCS.setSortOrder=function(e){var t=ZD(e).attr("id");G_LD_OBJ.nameSortArrow=ZD(e).children().attr("class"),G_LD_OBJ.timeSortArrow=ZD(e).children().attr("class"),"nameHeader"==t?G_LD_OBJ.fieldName="name":"dateModifiedHeader"==t&&(G_LD_OBJ.fieldName="date"),G_LD_OBJ.sortOrder=ZD(e).children().hasClass("DownArrow")||ZD(e).children().hasClass("DownArrowH")?"asc":"desc"},LINKDOCS.setClassAfterSorting=function(e){var t=ZD(e).attr("id");"nameHeader"==t?(ZD("#dateModifiedHeader").children("img:first").removeClass().addClass("DownArrowH"),ZD("#"+t).children("img:first").removeClass().addClass("UpArrow"==G_LD_OBJ.nameSortArrow?"DownArrow":"UpArrow")):"dateModifiedHeader"==t&&ZD("#"+t).children("img:first").removeClass().addClass("UpArrow"==G_LD_OBJ.timeSortArrow?"DownArrow":"UpArrow")},LINKDOCS.search=function(e){return"*"===ZD.trim(e)||""===ZD.trim(e)?void ZDUtils.hideOpenFileLoadingMsg():(LINKDOCS.changeAllToNormalView(),ZD("#moveUpFolder").removeClass("hover").addClass("non-hover").children().removeClass("back-folder cursor").addClass("back-folder-inactive flleft"),G_LD_OBJ.selectedLeftPanel="search",void LINKDOCS.getSearchResults(e))},LINKDOCS.getSearchResults=function(e,t,s,a){ZDUtils.LoadingMsg(zd_js_obj.loading),null==t&&(t=0),null==s&&(s="time"),null==a&&(a="desc");var i=G_LD_OBJ.docsURL+"/docs/viewsearchresults.do?method=searchIntegWSDocs&start="+t+"&field="+s+"&action="+a+"&searchquery="+encodeURIComponent(e)+"&zsoid="+G_LD_OBJ.zsoid+"&service="+G_LD_OBJ.urlInvoker;"undefined"!=typeof G_LD_OBJ.attachObj.wsId&&""!=G_LD_OBJ.attachObj.wsId&&(i+="&wsid="+G_LD_OBJ.attachObj.wsId),i+="&_t="+(new Date).getTime(),ZD.ajax({url:i,datatype:"html",xhrFields:{withCredentials:!0},success:function(e){var t=ZD("#showopenservicefilespace").children();ZD(t).each(function(e,t){ZD(t).empty().remove()}),ZD("#showopenservicefilespace").html(e),ZDUtils.hideLoadingMsg()}})},LINKDOCS.constructSearchResults=function(e,t){var s=e.timeclassname,a='<div id="searchHeaderDiv"><table class="docs-tableheader" width="100%" cellpadding="0" cellspacing="0" border="0" align="center"><tr><td width="20"></td><td nowrap="nowrap">'+zd_js_obj.name+'</td><td class="searchtimesort docscursor" nowrap="nowrap" width="100">'+zd_js_obj.date_modified+'<img id="searchtimesortgif" style="margin-left:0px;" class="'+s+'" src="'+G_LD_OBJ.spacerImagePath+'" border=0/></td></tr></table></div>';t.append(a);for(var i='<div id="inner_searchgrid" class="zd_scroll" style="padding-bottom:5px;vertical-align:top;border:0px solid #000000;height:312px;"><table class="docs-tabledata" width="100%" cellpadding="0" cellspacing="0" border="0" align="center">',o=e.documentListContainer.length,d=e.documentListContainer,r=0;o>r;r++){var n=d[r],l=n.encAttrDocId,c=n.encAttrDocName,_=n.encDocName,p=n.encUrlDocName,h=n.encAttrService,D=n.encAttrAuthorId,v=n.encAttrFileType,u="fileNameSpan_"+l,m=n.enclastEdited,f=n.encAttrFileExtn,O=n.encAttrEncryptedIds,g=n.encAttrClassName;i+='<tr><td nowrap="nowrap"><div class="documentDataDiv docs-tablediv" id="'+l+'" docName="'+c+'" data-docName="'+c+'" data-encFileName="'+_+'" data-encUrlFileName="'+p+'"  data-serviceType="'+h+'" data-authorId="'+D+'" data-fileType="'+v+'"  data-fileExt="'+f+'" data-encryptedId ="'+O+'"><table class="data-hover" width="100%" cellspacing="0" cellpadding="0" border="0" align="center"><tr><td><table width="100%" cellpadding="0" cellspacing="1" border="0" class="docs-tablerow"><tr><td width="20" nowrap="nowrap" height="20" elem="checkbox" class="docscursor checkboxtd"><img class="normalcheckboxicon_css flleft" src="'+G_LD_OBJ.spacerImagePath+'"></td><td width="20" nowrap="nowrap" elem="documenticon"><div class="'+g+'" flleft docscursor"></div></td><td nowrap="nowrap" align="left" elem="documentname">&nbsp;<a class="activelink"><span class="docscursor" title="'+c+'" docid="'+l+'" id="'+u+'">'+_+'</span></a></td><td width="90" nowrap="nowrap" align="left" elem="lastmodifiedtime">&nbsp;<a><span>'+m+"</span></a></td></tr></table></td></tr></table></div></td></tr>"}i+="</table></div>",t.append(i);var b=e.field,w=e.changeaction,L=e.action,G=e.searchquery,I=e.prevPage,B=e.nextPage,C=e.prevButtonClass,Z=e.nextButtonClass,y=e.start,x=e.end,F=e.totalCount;x>F&&(x=F),ZD("#inner_searchgrid").data({prevButtonClass:C,nextButtonClass:Z,start:y,end:x,totalCount:F,field:b,changeSortingAction:w,sortingClassNameOfTime:s,sortAction:L,searchquery:G,prevPage:I,nextPage:B,noOfResults:10}),ZD("#servicefilepagination").html('<table cellspacing="0" cellpadding="0" border="0"><tr><td id=searchpagestatusid" class="pagecount smallText">'+y+" - "+x+" "+zd_js_obj.of+" "+F+'</td><td><div id="searchprevbuttonid" >&nbsp;</div></td><td><div id="searchnextbuttonid" >&nbsp;</div></td></tr></table>'),ZD("#searchprevbuttonid").addClass(C),ZD("#searchnextbuttonid").addClass(Z),ZD("#servicefilepagination").show(),ZD("#searchHeaderDiv").undelegate(),ZD("#searchHeaderDiv").delegate("td.searchtimesort","mouseover mouseout",function(e){"mouseover"==e.type?LINKDOCS.searchMouseOver("time",b,"searchtimesortgif",w):LINKDOCS.searchMouseOut("time",b,"searchtimesortgif")}),ZD("#searchHeaderDiv").delegate("td.searchtimesort","click",function(){LINKDOCS.searchSorting("time",w)}),ZD("#ActionsPathDiv").undelegate(),ZD("#ActionsPathDiv").delegate("div#searchprevbuttonid","click",function(){ZD(this).hasClass("zd_prev")&&LINKDOCS.getSearchResults(G,I,b,L)}),ZD("#ActionsPathDiv").delegate("div#searchnextbuttonid","click",function(){ZD(this).hasClass("zd_next")&&LINKDOCS.getSearchResults(G,B,b,L)})},LINKDOCS.searchSorting=function(e,t){var s=ZD("#search_text").val();null==e&&(e="time"),null==t&&(t="desc"),LINKDOCS.getSearchResults(s,0,e,t)},LINKDOCS.searchMouseOver=function(e,t,s,a){e!=t&&("asc"==a?ZD("#"+s).attr("class","UpArrow"):ZD("#"+s).attr("class","DownArrow"))},LINKDOCS.searchMouseOut=function(e,t,s){e!=t&&ZD("#"+s).attr("class","")},LINKDOCS.getI18N=function(e,t,s){var a=t+"/docs/zduserdetails.do?crossdomain=true&accessService="+s.servicename+"&zsoid="+s.zsoid;ZD.ajax({url:a,type:"GET",dataType:"html",xhrFields:{withCredentials:!0},success:function(t){ZD("#zd_user_details").remove(),ZD("body").append(t),ZD(t).find("script").each(function(){ZD.parseJSON(ZD(this).text())}),zdcsrfPair=ZD("#zd_user_details").attr("csrfparamName")+"="+ZD("#zd_user_details").attr("csrftoken"),void 0!=e&&""!=e&&e()}})},LINKDOCS.searchFiles=function(e){G_LD_OBJ.startFrom=0,G_LD_OBJ.fetchLimit=50,G_LD_OBJ.searchKey=e;var t="files";"Insert"===G_LD_OBJ.attachlabel&&(t=G_LD_OBJ.fileType);var s=G_LD_OBJ.docsURL+"/api/v2/files/search?action=soidsearch&zsoid="+G_LD_OBJ.zsoid+"&start="+G_LD_OBJ.startFrom+"&limit="+G_LD_OBJ.fetchLimit+"&category="+t+"&searchfields=&orderby=lastopened&sortorder=asc&wsscope=all&crossdomain=true&accessService="+G_LD_OBJ.urlInvoker+"&searchquery="+G_LD_OBJ.searchKey+"&"+zdcsrfPair;ZD.ajax({url:s,type:"GET",dataType:"json",xhrFields:{withCredentials:!0},success:function(e){if(G_LD_OBJ.jsonData=e,0===G_LD_OBJ.jsonData.dataobj.length)ZD("#showopenservicefilespace").empty(),ZD("#showopenservicefilespace").append('<div id="thumbnailcontainer"></div>'),ZD("#thumbnailcontainer").css("overflow","scroll"),ZD("#thumbnailcontainer").css("overflow-x","hidden"),ZD("#thumbnailcontainer").css("height","inherit"),ZD("#thumbnailcontainer").append('<div id="zd_ldsearch" style="margin-left:70px;margin-top:100px;">'+zd_js_obj.no_results_found_for+"&nbsp<b></b></div>"),ZD("#zd_ldsearch").find("b").text(G_LD_OBJ.searchKey);else{G_LD_OBJ.totalFiles=e.total_resources[0].no_of_res;var t=ZD("#serviceDialogLeftPanel").find("td.selectedView").attr("id");ZD("#"+t).removeClass("selectedView").addClass("normalView"),ZD("div#showopenservicefilespace").linkdocsdatagrid("constructFileContent"),Number(G_LD_OBJ.jsonData.total_resources[0].no_of_res)>50&&LINKDOCS.autoScroll()}}})},LINKDOCS.autoScroll=function(){if(G_LD_OBJ.startFrom<=G_LD_OBJ.totalFiles&&G_LD_OBJ.startFrom+G_LD_OBJ.fetchLimit!=G_LD_OBJ.totalFiles&&G_LD_OBJ.totalFiles>50){G_LD_OBJ.startFrom=Number(G_LD_OBJ.startFrom)+50,Number(G_LD_OBJ.startFrom)+50>=Number(G_LD_OBJ.totalFiles)&&(G_LD_OBJ.fetchLimit=Number(G_LD_OBJ.totalFiles)-Number(G_LD_OBJ.startFrom));var e=(ZD("input#search_text").val(),G_LD_OBJ.docsURL+"/api/v2/files/search?action=soidsearch&zsoid="+G_LD_OBJ.zsoid+"&start="+G_LD_OBJ.startFrom+"&limit="+G_LD_OBJ.fetchLimit+"&category=files&searchfields=&orderby=lastopened&sortorder=asc&wsscope=all&crossdomain=true&accessService="+G_LD_OBJ.urlInvoker+"&searchquery="+G_LD_OBJ.searchKey+"&"+zdcsrfPair);ZD.ajax({url:e,type:"GET",dataType:"json",xhrFields:{withCredentials:!0},success:function(e){G_LD_OBJ.autoscrollData=G_LD_OBJ.jsonData,G_LD_OBJ.jsonData=e,G_LD_OBJ.autoscrollData.dataobj=G_LD_OBJ.autoscrollData.dataobj.concat(G_LD_OBJ.jsonData.dataobj),ZD("div#showopenservicefilespace").linkdocsdatagrid("constructDocsView")}})}},LINKDOCS.autoScrollSubList=function(e,t,s){if(G_LD_OBJ.startFrom<=G_LD_OBJ.totalFiles&&G_LD_OBJ.totalFiles>50){var a="all";"Insert"===G_LD_OBJ.attachlabel&&(a=G_LD_OBJ.fileType),G_LD_OBJ.startFrom=Number(G_LD_OBJ.startFrom)+50,url="crm"===G_LD_OBJ.urlInvoker?G_LD_OBJ.docsURL+"/api/v2/files?action=integworkspaces&start="+G_LD_OBJ.startFrom+"&limit=50&folderid="+e+"&accessService="+G_LD_OBJ.urlInvoker+"&category=all&includefolders=true&zsoid="+G_LD_OBJ.zsoid+"&parentfolderid="+s+"&orderby=kind&sortorder=asc&crossdomain=true&"+zdcsrfPair:"project"===G_LD_OBJ.urlInvoker?G_LD_OBJ.docsURL+"/api/v2/files?action=cmsworkspaces&folderid="+G_LD_OBJ.wsId+"&accessService="+G_LD_OBJ.urlInvoker+"&start="+G_LD_OBJ.startFrom+"&limit=50&category="+a+"&includefolders=true&zsoid="+G_LD_OBJ.zsoid+"&parentfolderid="+e+"&orderby=kind&sortorder=asc&crossdomain=true&"+zdcsrfPair:G_LD_OBJ.docsURL+"/api/v2/files?action=cmsworkspaces&start="+G_LD_OBJ.startFrom+"&limit=50&folderid="+G_LD_OBJ.wsId+"&accessService="+G_LD_OBJ.urlInvoker+"&category="+a+"&includefolders=true&zsoid="+G_LD_OBJ.zsoid+"&parentfolderid="+e+"&orderby=name&sortorder=asc&crossdomain=true&"+zdcsrfPair,ZD.ajax({url:url,type:"GET",dataType:"json",xhrFields:{withCredentials:!0},success:function(a){G_LD_OBJ.autoscrollData=G_LD_OBJ.jsonData,G_LD_OBJ.jsonData=a,G_LD_OBJ.autoscrollData.dataobj=G_LD_OBJ.autoscrollData.dataobj.concat(G_LD_OBJ.jsonData.dataobj),ZD("div#showopenservicefilespace").linkdocsdatagrid("constructFolderView"),ZD("#thumbnailcontainer").unbind().bind("scroll",function(){$(this).scrollTop()+$(this).innerHeight()>=$(this).prop("scrollHeight")-150&&($(this).unbind("scroll"),ZD("#thumbnailcontainer").css("height","inherit"),LINKDOCS.autoScrollSubList(e,t,s))})}})}},LINKDOCS.constructSubList=function(e,t,s){void 0===s&&(s=e),G_LD_OBJ.folderId=e;var a="all";"Insert"===G_LD_OBJ.attachlabel&&(a=G_LD_OBJ.fileType);var i="";i="crm"===G_LD_OBJ.urlInvoker?G_LD_OBJ.docsURL+"/api/v2/files?action=integworkspaces&folderid="+e+"&accessService="+G_LD_OBJ.urlInvoker+"&start="+G_LD_OBJ.startFrom+"&limit=50&category=all&includefolders=true&zsoid="+G_LD_OBJ.zsoid+"&parentfolderid="+s+"&orderby=kind&sortorder=asc&crossdomain=true&"+zdcsrfPair:"project"===G_LD_OBJ.urlInvoker?G_LD_OBJ.docsURL+"/api/v2/files?action=cmsworkspaces&folderid="+G_LD_OBJ.wsId+"&accessService="+G_LD_OBJ.urlInvoker+"&start="+G_LD_OBJ.startFrom+"&limit=50&category="+a+"&includefolders=true&zsoid="+G_LD_OBJ.zsoid+"&parentfolderid="+e+"&orderby=kind&sortorder=asc&crossdomain=true&"+zdcsrfPair:G_LD_OBJ.docsURL+"/api/v2/files?action=cmsworkspaces&folderid="+G_LD_OBJ.wsId+"&start="+G_LD_OBJ.startFrom+"&limit=50&orderby=name&accessService="+G_LD_OBJ.urlInvoker+"&category="+a+"&includefolders=true&zsoid="+G_LD_OBJ.zsoid+"&parentfolderid="+e+"&sortorder=asc&crossdomain=true&"+zdcsrfPair,ZD.ajax({url:i,type:"GET",dataType:"json",xhrFields:{withCredentials:!0},success:function(a){G_LD_OBJ.jsonData=a,ZD("#thumbnailcontainer").css("height","inherit"),ZD("div#showopenservicefilespace").linkdocsdatagrid("constructFileContent"),G_LD_OBJ.totalFiles=a.total_resources[0].no_of_res,ZD("#thumbnailcontainer").unbind().bind("scroll",function(){$(this).scrollTop()+$(this).innerHeight()>=$(this).prop("scrollHeight")-150&&($(this).unbind("scroll"),LINKDOCS.autoScrollSubList(e,t,s))})}})},LINKDOCS.selectDoc=function(e,t,s,a){var i=!1;if(ZD.each(G_LD_OBJ.selecteddocs,function(s,a){return a.res_id===t?(i=!0,G_LD_OBJ.selecteddocs.splice(s,1),ZD(e).removeClass("thumb-select").addClass("thumb-deselect"),!1):void 0}),i===!1&&G_LD_OBJ.selecteddocs.length<Number(G_LD_OBJ.filelimit)){var o={res_id:t,res_name:s,download_url:a};G_LD_OBJ.selecteddocs.push(o),ZD(e).removeClass("thumb-deselect").addClass("thumb-select")}else G_LD_OBJ.selecteddocs.length>=Number(G_LD_OBJ.filelimit)&&i===!1&&alert("file limit exceeded")},LINKDOCS.getSelectedDocList=function(){if(0==G_LD_OBJ.selecteddocs.length&&(""===G_LD_OBJ.container_id||void 0===G_LD_OBJ.container_id)){var e={};e[zd_js_obj.ok]=function(){ZD("#freezediv").remove(),ZDDialog.closePopUp("frameDiv")},ZD("body").append('<div id="freezediv" class="freeze_component_background" style="width: '+ZD(window).width()+"px; height: "+ZD(window).height()+'px; z-index: 10003;"></div>'),ZD(window).resize(function(){$("#freezediv").css("width",ZD(window).width()),$("#freezediv").css("height",ZD(window).height())});{[ZD(window).width()/3,120]}return ZDDialog.openAlert(zd_js_obj.alert,zd_js_obj.select_the_documents,!0,e),void ZD(".ui-icon-closethick").click(function(){ZD("#freezediv").remove()})}if(G_LD_OBJ.selecteddocs.length>G_LD_OBJ.filelimit&&(""===G_LD_OBJ.container_id||void 0===G_LD_OBJ.container_id))return void ZDDialog.openAlert(zd_js_obj.alert,ZDUtils.replaceParams(zd_js_obj.validation_for_attachfile,new Array(G_LD_OBJ.filelimit+"")),!0);if("crm"===G_LD_OBJ.urlInvoker){for(var t="",s="",a="",i="",o=0;o<G_LD_OBJ.selecteddocs.length;o++)t=G_LD_OBJ.selecteddocs[o].res_id,s=G_LD_OBJ.selecteddocs[o].res_name,a=a+t+",",i=i+encodeURIComponent(s)+",";i=i.substring(0,i.length-1),a=a.substring(0,a.length-1);var d="docIds="+a+"&docNames="+i;if(""!==G_LD_OBJ.container_id&&void 0!==G_LD_OBJ.container_id)return d;docsIntegCallBackFn(d)}else G_LD_OBJ.callBackFn(G_LD_OBJ.selecteddocs);ZDDialog.closePopUp("linkdocsdialogdiv")},LINKDOCS.imgLoadingError=function(e,t){var s=ZD(t).parent();ZD(t).remove(),ZD(s).prepend('<span class="'+e+'" style="margin:6px;margin-left:8px;"></span>'),ZD(s).css("height","69px"),ZD(s).css("width","75px")},function(e){e.widget("ui.linkdocsdialog",{options:{recentDocs:{show:!0,name:"Recent Docs",id:"recentservicedocs",action:"getRecentDocuments",iconClass:"recentdocs-icon"},workspaces:{show:!1,name:"Folders",id:"zsoidwsdocs",iconClass:"zdc-foldericon_css"},selectAllButton:{showAction:!1,action:!0,id:"selectMenuOpenFile",iconClass:"",value:"Select"},statusMessageDiv:!0,homeButton:!0,upOneLevel:!0,selectedView:"recentservicedocs",lookIn:!1,documentNameHeader:!0,lastModifiedTimeHeader:!0,advSearchBox:!1},_create:function(){this.options.advSearchBox=G_LD_OBJ.search,this._constructFileDialog(),this._constructLeftPanel(),this._constructRightPanel(),this._constructTopBar(),this._initDelegate()},_constructFileDialog:function(){this.mainPanel=e('<div id="mainPanelforservicefiles" style="overflow:hidden;width:100%;">'),this.leftPanel=e('<div class="ui-left-panel flleft" >'),this.rightPanel=e('<div class="ui-rht-datadiv">'),this.selectedFilesRow=e('<div id="showSelectedBoxDiv" class="showdiv" style="margin-bottom:2px;"><table cellpadding="0" width="100%"  cellspacing="0" style="margin-top:3px;"><tr><td width="107" align="center" class="selectfiles"><strong>'+zd_js_obj.selected_files_list+'</strong></td><td><div id="selectboxdiv" class="selectblock zd_scroll"></div></td></tr></table></div>'),this.topdiv=e("<div>"),this.element.append(this.topdiv),this.element.append(this.mainPanel),this.topdiv.append(this.toolbarTable),this.mainPanel.append(this.leftPanel),this.mainPanel.append(this.rightPanel),this.mainPanel.append(this.selectedFilesRow),this._createLeftPanelHeaders({header1:{name:"Favorites",cursor:"default"}})},_constructTopBar:function(){"crm"===G_LD_OBJ.urlInvoker&&(G_LD_OBJ.listview=!0),this.toolBarPanel=e("table#topBar");var t=e("<tr>"),s='<td valign=top><table width="100%" cellspacing="0" cellpadding="0"><tr><td style="width:90%;" class="rhtspac">';this.options.homeButton&&(s+='<span title="'+zd_js_obj.docs_home+'" class="sort-menu lightbluetxt flleft margright " id="homeButton"><span class="home flleft docscursor"></span></span> <span title="'+zd_js_obj.up_one_level+'" class="sort-menu lightbluetxt flleft margright non-hover" id="moveUpFolders"><span class="back-folder-inactive flleft"></span></span>'),s+='</td><td align="right">',G_LD_OBJ.uploadenable&&(s+='<span title="upload" id="uploadfile" class="sort-menu flleft margright upload" value="+"><div style="padding: 2px 10px;">'+zd_js_obj.upload+"</div></span>"),G_LD_OBJ.thumbnailview&&G_LD_OBJ.listview||!G_LD_OBJ.thumbnailview&&!G_LD_OBJ.listview?s+='<span title="List View" class="sort-menu lightbluetxt flleft margright non-hover active" id="lvbtn" style=""><span class="view-icon list-icon"></span></span><span title="Thumbnail View" class="sort-menu lightbluetxt flleft margright non-hover" id="tvbtn" style="" ><span class="view-icon thumb-icon"</span></span>':G_LD_OBJ.listview?s+='<span title="List View" class="sort-menu lightbluetxt flleft margright non-hover active" id="lvbtn" style="display:none;"><span class="view-icon list-icon"></span></span>':G_LD_OBJ.thumbnailview&&(s+='<span title="Thumbnail View" class="sort-menu lightbluetxt flleft margright non-hover active" id="tvbtn" style="display:none;" ><span class="view-icon thumb-icon"</span></span>'),s+='</td><td align="right"><div id="servicefilepagination"  style="float:right; z-index:1000; padding:3px 0 0;"></div>',s+='</td><td align="right">',s+="</td></tr></table></td>",t.append(s),this.toolBarPanel.append(t),e("#lvbtn").hasClass("active")?(e("#tvbtn").css("background-color",""),e("#lvbtn").css("background-color","grey")):(e("#lvbtn").css("background-color",""),e("#tvbtn").css("background-color","grey"))},_createLeftPanelHeaders:function(t){this.leftPanel.append('<div style="padding-bottom:0px;margin-top:0px;" id="searchbox_div"><div style="height:20px;border-bottom:1px solid #efefef;padding-top:13px;margin-bottom:13px;"></div></div>'),this.options.advSearchBox&&e("#searchbox_div").prepend('<div class="searchdiv ui-corner-all docscursor flright" style=""><input type="submit" value="" class="searchIcon flleft docscursor smallText"><input type="text" value="'+zd_js_obj.search+'" class="searchtext flleft" id="search_text"><input type="hidden" class="" id="search_type_openfile" name="Search All" value="search_all_search"></div>');for(var s in t){var a=t[s];"Favorites"==a.name&&(this.favMenuContainer=e('<table id="serviceDialogLeftPanel" width="100%"  cellpadding="0" cellspacing="0" align="center" class="mailLeftPanel"></table>'),this.leftPanel.append(this.favMenuContainer))}},_constructLeftPanel:function(){this.leftSidePanel=e("table#serviceDialogLeftPanel");for(var t in this.options){var s=this.options[t];s&&s.show&&this.leftSidePanel.append('<tr><td  class="normalView docscursor" id="'+s.id+'" action="'+s.action+'" fid="'+s.fid+'"><span class="'+s.iconClass+' flleft margright"></span><span class="flleft" style="line-height:18px;">'+s.name+"</span></td></tr>")}e("#"+this.options.selectedView).removeClass("normalView").addClass("selectedView")},_constructRightPanel:function(){this.rightPaneltopContainer=e("<div>"),this.rightPanel.append(this.rightPaneltopContainer),this._constructActionsRow(),this._constructStatusMessageRow(),this.rightPanelDataContainer=e('<div id="openloadingmsg"></div><div id="showopenservicefilespace" style="background:#fff; height:340px;padding-left:12px;"></div>'),this.rightPanel.append(this.rightPanelDataContainer)},_constructActionsRow:function(){var e='<div id="ActionsPathDiv" class="toolbar-menu" style="padding: 0px 0px 12px 0px; height: 21px;"><table id="topBar" class="toolbar" width="100%" cellspacing="0" cellpadding="2"></table></div>';this.rightPaneltopContainer.append(e)},_constructStatusMessageRow:function(){this.options.statusMessageDiv&&this.rightPaneltopContainer.append('<div style="width:60%;position:absolute;padding-top:5px;"><div align="center" class="hidediv"><span id="statusmsgdiv" ></span></div></div>')},_initDelegate:function(){G_LD_OBJ.SCR_WTH=ZDUtils.getWidth(),G_LD_OBJ.SCR_HT=ZDUtils.getHeight();for(var t in this.options){var s=this.options[t];if(s&&s.show){var a=s.id;e("#serviceDialogLeftPanel").delegate("td#"+a,"click",function(t){e(t.target);LINKDOCS.getDocsList(this)})}}e("#tvbtn").click(function(){e(this).addClass("active"),e("#lvbtn").removeClass("active"),e("#lvbtn").css("background-color",""),e("#tvbtn").css("background-color","grey"),e("div#showopenservicefilespace").linkdocsdatagrid("constructFileContent")}),e("#lvbtn").click(function(){e(this).addClass("active"),e("#tvbtn").removeClass("active"),e("#tvbtn").css("background-color",""),e("#lvbtn").css("background-color","grey"),e("div#showopenservicefilespace").linkdocsdatagrid("constructFileContent")}),e("#moveUpFolders").click(function(){e("#moveUpFolders").find("span").hasClass("back-folder")&&e("div#showopenservicefilespace").linkdocsdatagrid("moveUp")}),e("#showopenservicefilespace").delegate("div.wsfolderDataDiv","click",function(){var t=e(this).attr("id"),s=e(this).data("wsAuthorId");G_LD_OBJ.wsId=t,G_LD_OBJ.folderId="-1",G_LD_OBJ.parentFolderId="workspace",G_LD_OBJ.wsAuthorId=s,LINKDOCS.getDocsList()}),e("#showopenservicefilespace").delegate("td#nameHeader,td#dateModifiedHeader","click",function(){e("#recentservicedocs").hasClass("selectedView")||"workspace"==G_LD_OBJ.wsId||(e("div#servicefilepagination").hide(),LINKDOCS.setSortOrder(this),LINKDOCS.resetAll(),LINKDOCS.getDocsList(),LINKDOCS.setClassAfterSorting(this))}),e("#moveUpFolder").delegate(".back-folder","click",function(){G_LD_OBJ.moveUpFolder=!0,G_LD_OBJ.parentFolderId==G_LD_OBJ.wsId||"-1"==G_LD_OBJ.parentFolderId?(G_LD_OBJ.folderId="-1",G_LD_OBJ.wsId="workspace"):G_LD_OBJ.folderId=G_LD_OBJ.parentFolderId,LINKDOCS.getDocsList()}),e("#showopenservicefilespace").delegate("table.data-hover","click",function(t){var s=e(t.target);(s.hasClass("activelink")||s.parent().hasClass("activelink")||s.hasClass("selectcheckboxicon_css")||s.hasClass("normalcheckboxicon_css"))&&LINKDOCS.showSelectedDocs(this)}),e("div#selectboxdiv").delegate("span.closeBtn_css","click",function(){var t=e(this).parent().attr("docId");LINKDOCS.deselectRow(t)}),e("#servicefilepagination").delegate("div#prevbuttonid,div#nextbuttonid","click",function(){var t=e(this).attr("id");"prevbuttonid"==t?action="previousPage":"nextbuttonid"==t&&(action="nextPage"),e("#showopenservicefilespace").linkdocsdatagrid(action)}),e("#homeButton").bind("click",function(){e("div#mainPanelforservicefiles").show(),LINKDOCS.getDocsList("","recentservicedocs")}),e("div#searchbox_div").delegate("input#search_text","focusin focusout keypress",function(t){if("focusin"==t.type)e("input#search_text").val("");else if("focusout"==t.type)""==e("input#search_text").val()&&e("input#search_text").val(zd_js_obj.search);else if("keypress"==t.type&&"13"==t.keyCode){var s=e("input#search_text").val();LINKDOCS.searchFiles(s)}})}}),e.extend(e.ui.filedialog,{version:"1.8"})}(jQuery),function(e){e.widget("ui.linkdocsdatagrid",{options:{documentNameHeader:!0,lastModifiedTimeHeader:!0,checkboxIconSpace:!0,checkboxIcon:"normalcheckboxicon_css flleft",hoverclass:"data-hover",documentIcon:!0,documentName:!0,lastModifiedTime:!0},_create:function(){this._constructHeader(),this.sendAjaxRequest()},resetOptions:function(){this.options.documentNameHeader=!0,this.options.lastModifiedTimeHeader=!0,this.options.documentIcon=!0,this.options.documentName=!0,this.options.lastModifiedTime=!0},populateDataPanel:function(){this._constructHeader(),this.sendAjaxRequest()},_constructHeader:function(){},sendAjaxRequest:function(){ZDUtils.LoadingMsg(zd_js_obj.loading);var t="";if(t=this._constructURLParametersForZsoid(),G_LD_OBJ.isNewComp===!0){var s=e("#serviceDialogLeftPanel").find("td.selectedView").attr("id");if("recentservicedocs"===s)if("cms"===G_LD_OBJ.urlInvoker){var a="all",i="";"Insert"===G_LD_OBJ.attachlabel&&(a=G_LD_OBJ.fileType,i=G_LD_OBJ.fileType),G_LD_OBJ.fid=G_LD_OBJ.wsId,e("#uploadfile").DocsFileUploader({fileLimit:G_LD_OBJ.uploadFileLimit,fileLimit:G_LD_OBJ.uploadFileLimit,docs_url:G_LD_OBJ.docsURL,fileType:i,progresscallbck:G_LD_OBJ.progresscallbck,isComp:!0,service:G_LD_OBJ.urlInvoker,zsoid:G_LD_OBJ.zsoid,callback:LINKDOCS.showUploadedFile,folderId:G_LD_OBJ.fid,workSpaceId:G_LD_OBJ.wsId,udserver_upload:G_LD_OBJ.udserverEnable}),t=G_LD_OBJ.docsURL+"/api/v2/files?folderid="+G_LD_OBJ.wsId+"&zsoid="+G_LD_OBJ.zsoid+"&accessService="+G_LD_OBJ.urlInvoker+"&start=0&limit=50&parentfolderid=-1&action=cmsworkspaces&category="+a+"&updatesort=true&orderby=dateorder&sortorder=desc&crossdomain=true&"+zdcsrfPair}else t="project"===G_LD_OBJ.urlInvoker?G_LD_OBJ.docsURL+"/api/v2/files?folderid="+G_LD_OBJ.wsId+"&zsoid="+G_LD_OBJ.zsoid+"&accessService="+G_LD_OBJ.urlInvoker+"&start=0&limit=50&parentfolderid=-1&action=cmsworkspaces&category=all&updatesort=true&orderby=dateorder&sortorder=desc&crossdomain=true&"+zdcsrfPair:G_LD_OBJ.docsURL+"/api/v2/files?folderid=-1&zsoid="+G_LD_OBJ.zsoid+"&accessService="+G_LD_OBJ.urlInvoker+"&start=0&limit=50&parentfolderid=-1&action=cmsworkspaces&category=all&updatesort=true&orderby=dateorder&sortorder=desc&crossdomain=true&"+zdcsrfPair;else"zsoidwsdocs"===s&&(t="cms"===G_LD_OBJ.urlInvoker||"project"===G_LD_OBJ.urlInvoker?G_LD_OBJ.docsURL+"/api/v2/files/tree?zsoid="+G_LD_OBJ.zsoid+"&type=crmwstree&folderid="+G_LD_OBJ.wsId+"&isupload=false&accessService="+G_LD_OBJ.urlInvoker+"&crossdomain=true&"+zdcsrfPair:G_LD_OBJ.docsURL+"/api/v2/files/tree?zsoid="+G_LD_OBJ.zsoid+"&type=crmwstree&folderid=-1&isupload=false&accessService="+G_LD_OBJ.urlInvoker+"&crossdomain=true&"+zdcsrfPair);e.ajax({url:t,type:"GET",xhrFields:{withCredentials:!0},dataType:"text",success:function(t){var s=jQuery.parseJSON(t);G_LD_OBJ.jsonData=s,e("div#showopenservicefilespace").linkdocsdatagrid("constructFileContent")}})}else e.ajax({url:t,type:"GET",xhrFields:{withCredentials:!0},dataType:"text",success:function(t,s){if("success"==s){var a=jQuery.parseJSON(t);if("spacenotreserved"!=a.ERROR)return G_LD_OBJ.jsonData=a,"workspace"!=G_LD_OBJ.wsId||e("#recentservicedocs").hasClass("selectedView")?e("div#showopenservicefilespace").linkdocsdatagrid("constructDocumentRows"):(e("td#dateModifiedHeader").find("img").remove(),e("td#nameHeader").find("img").remove(),G_LD_OBJ.moveUpFolder=!1,e("div#showopenservicefilespace").linkdocsdatagrid("constructWorkspaceRows")),ZDUtils.hideLoadingMsg(),LINKDOCS.updateSelectedDocs(),e("#recentservicedocs").hasClass("selectedView")&&(e("td#dateModifiedHeader").find("img").remove(),e("td#nameHeader").find("img").remove()),G_LD_OBJ.moveUpFolder=!1,!1;ZDUtils.hideLoadingMsg(),e("#openFileDataDiv").html('<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="docs-tabledata"><tr><td colspan="5" nowrap><BR><div align="center">'+zd_js_obj.no_documents_are_present+"</div></td></tr></table>")}}})},constructFileContent:function(){ZDUtils.hideLoadingMsg(),e("#showopenservicefilespace").empty(),e("#showopenservicefilespace").append('<div id="thumbnailcontainer"></div>'),e("#thumbnailcontainer").css("overflow","scroll"),e("#thumbnailcontainer").css("overflow-x","hidden"),e("#thumbnailcontainer").css("height","inherit");var t=e("#serviceDialogLeftPanel").find("td.selectedView").attr("id");if(e("#lvbtn").hasClass("active")){var s='<div id="docsHeaderTab"><table  id="table1" width="100%" cellpadding="0" cellspacing="0" border="0" class="docs-tableheader" align="center"><tr>';this.options.documentNameHeader&&(s+='<td width="20">&nbsp;</td><td id="nameHeader" height="23" nowrap="nowrap" align="left" style="font-size:16px;" class="docscursor sortfield namesortTd pad-lft" sortfield="name">'+zd_js_obj.name+"</td>"),this.options.lastModifiedTimeHeader&&(s+='<td id="dateModifiedHeader" width="200" align="center" nowrap="nowrap" style="font-size:16px;" class="docscursor sortfield datesortTd" sortfield="date">'+zd_js_obj.date_modified+"</td>"),s+="</tr></table></div>",e("#thumbnailcontainer").append(s)}"recentservicedocs"===t?e("div#showopenservicefilespace").linkdocsdatagrid("constructDocsView"):"zsoidwsdocs"===t?e("div#showopenservicefilespace").linkdocsdatagrid("constructFolderView"):(e("#thumbnailcontainer").unbind().bind("scroll",function(){$(this).scrollTop()+$(this).innerHeight()>=$(this).prop("scrollHeight")&&LINKDOCS.autoScroll()}),e("div#showopenservicefilespace").linkdocsdatagrid("constructDocsView"))},constructDocsView:function(){var t=G_LD_OBJ.jsonData.dataobj;void 0===t&&(t=G_LD_OBJ.jsonData.folders),e("#lvbtn").hasClass("active")?(e("div#showopenservicefilespace").linkdocsdatagrid("constructDocsListView"),e("#lvbtn").css("background-color","grey")):e.each(t,function(t,s){if(void 0!==s.preview_url){e("#thumbnailcontainer").append("<div id="+s.res_id+' style="float:left;" class="docscursor"><div style="width:75px;height:75px;"><img class="backupPic_'+s.res_id+'" src="'+s.preview_url+'" style="height:75px;width:75px;"></div><div style="height:18px"><p style="font-size:small;margin-top:0px;overflow:hidden;height:18px;width:81px;margin-left:-3px;white-space: nowrap;" title="'+s.encattr_res_name+'">'+s.enc_res_name+"</p></div></div>"),$(".backupPic_"+s.res_id).error(function(){LINKDOCS.imgLoadingError(s.no_preview_class,this)}),e("[id='"+s.res_id+"']").click(function(){LINKDOCS.selectDoc(this,s.res_id,s.encattr_res_name,s.download_url),e("div#showopenservicefilespace").linkdocsdatagrid("showSelectedDocs")});var a=!1;e.each(G_LD_OBJ.selecteddocs,function(e,t){t.res_id===s.res_id&&(a=!0)}),a?e("[id='"+s.res_id+"']").removeClass("thumb-deselect").addClass("thumb-select"):e("[id='"+s.res_id+"']").removeClass("thumb-select").addClass("thumb-deselect")}}),""!==G_LD_OBJ.autoscrollData&&(G_LD_OBJ.jsonData=G_LD_OBJ.autoscrollData),0===t.length&&0===G_LD_OBJ.startFrom&&e("#thumbnailcontainer").append('<div style="margin-left:70px;margin-top:100px;">'+zd_js_obj.label_no_items_are_present+"</div>")},constructDocsListView:function(){var t=this,s=G_LD_OBJ.jsonData.dataobj;void 0===s&&(s=G_LD_OBJ.jsonData.folders),e.each(s,function(s,a){if(void 0!==a.preview_url){var i=!1,o="";e.each(G_LD_OBJ.selecteddocs,function(e,t){t.res_id===a.res_id&&(i=!0)}),o=i?"selectcheckboxicon_css":"normalcheckboxicon_css";var d=e("<div>").addClass("documentDataDiv").attr({id:a.res_id,docName:a.encattr_res_name}).data({service:a.service_type,cssName:a.class_name,docName:a.encattr_res_name,isDocumentSharedToMe:!1,isTemplates:!1}),r=e('<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" >'),n=e("<tr>"),l=e('<td colspan="4" nowrap="nowrap" width="100%">'),c=a.encattr_res_name,_='<table width="100%" border="0" cellpadding="0" cellspacing="1" class="docs-tablerow"><tr>';t.options.checkboxIconSpace&&(_+='<td width="20" height="20" nowrap="nowrap" class="docscursor checkboxtd" elem="checkbox" ><img src="'+G_LD_OBJ.spacerImagePath+'" class="'+o+'"/></td>'),t.options.documentIcon&&(_+='<td width="20" nowrap="nowrap" elem="documenticon"><div class="'+a.class_name+' flleft docscursor"></div></td>'),t.options.documentName&&(_+="trashservicedocs"!=G_LD_OBJ.selectedLeftPanel?'<td nowrap="nowrap" align="left" elem="documentname">&nbsp;<a class="activelink"><span id="fileNameSpan_'+a.res_id+'" docId="'+a.res_id+'" style="font-size:14px;" title="'+c+'" class="docscursor">'+a.encattr_res_name+"</span></a></td>":'<td nowrap="nowrap" align="left">&nbsp;<a target="_blank"  href="/index.do?docId='+a.res_id+'"><span id="fileNameSpan_'+a.res_id+'" docId="'+a.res_id+'" title="'+c+'" class="trashlink">'+a.encattr_res_name+"</span></a></td>"),t.options.lastModifiedTime&&(_+='<td width="180" nowrap="nowrap" align="center" elem="lastmodifiedtime">&nbsp;<a><span style="font-size:14px;">'+a.last_modified_time+"</span></a></td>"),_+="</tr></table>",l.append(_),n.append(l),r.append(n),d.append(r),e("#thumbnailcontainer").append(d),e("[id='"+a.res_id+"']").click(function(){var t=this,s=!1;if(e.each(G_LD_OBJ.selecteddocs,function(i,o){return o.res_id===a.res_id?(s=!0,e(t).find("td.checkboxtd").children().removeClass("selectcheckboxicon_css").addClass("normalcheckboxicon_css"),e(t).children("table.data-hover").removeClass("zd_select"),G_LD_OBJ.selecteddocs.splice(i,1),!1):void 0}),s===!1&&G_LD_OBJ.selecteddocs.length<Number(G_LD_OBJ.filelimit)){var i={res_id:a.res_id,res_name:a.encattr_res_name,download_url:a.download_url};e(t).find("td.checkboxtd").children().removeClass("normalcheckboxicon_css").addClass("selectcheckboxicon_css"),e(t).children("table").addClass("zd_select"),G_LD_OBJ.selecteddocs.push(i)}else G_LD_OBJ.selecteddocs.length>=Number(G_LD_OBJ.filelimit)&&s===!1&&alert("file limit exceeds");e("div#showopenservicefilespace").linkdocsdatagrid("showSelectedDocs")})}})},constructFolderView:function(){var t=G_LD_OBJ.jsonData.dataobj;void 0===t&&(t=G_LD_OBJ.jsonData.folders),e("#lvbtn").hasClass("active")?(e("#lvbtn").css("background-color","grey"),e("div#showopenservicefilespace").linkdocsdatagrid("constructFolderListView")):e.each(t,function(t,s){if(void 0!=s.res_name){if(s.is_folder){e("#thumbnailcontainer").append("<div id="+s.res_id+' style="float:left;margin-right:15px;margin-bottom:25px;height:75px;width:75px;" class="docscursor"><div style="width:75px;height:73px;"><span class="folder-thumb-icon" style="background-position:-128px -303px;height:53px;width:66px;"></span></div><div style="height:18px"><p style="font-size:small;margin-top:2px;height:18px;white-space:nowrap;overflow:hidden;" title="'+s.encattr_res_name+'">'+s.enc_res_name+"</p></div></div>");var a="images";"Insert"===G_LD_OBJ.attachlabel&&(a=G_LD_OBJ.fileType),e("[id='"+s.res_id+"']").click(function(){G_LD_OBJ.foldertree.push(s),e("#moveUpFolders").removeClass("non-hover").addClass("hover"),e("#moveUpFolders").find("span").removeClass("back-folder-inactive").addClass("back-folder"),LINKDOCS.constructSubList(s.res_id,s.encattr_res_name,s.library_id),G_LD_OBJ.fid=s.res_id,"cms"===G_LD_OBJ.urlInvoker&&(service="cms",e("#uploadfile").DocsFileUploader({fileLimit:G_LD_OBJ.uploadFileLimit,fileLimit:G_LD_OBJ.uploadFileLimit,docs_url:G_LD_OBJ.docsURL,fileType:a,progresscallbck:G_LD_OBJ.progresscallbck,isComp:!0,service:service,zsoid:G_LD_OBJ.zsoid,callback:LINKDOCS.showUploadedFile,folderId:G_LD_OBJ.fid,workSpaceId:G_LD_OBJ.wsId,udserver_upload:G_LD_OBJ.udserverEnable}))})}else e("#thumbnailcontainer").append("<div id="+s.res_id+' style="float:left;" class="docscursor"><div style="width:75px;height:75px;"><img class="backupPic_'+s.res_id+'" src="'+s.preview_url+'" style="height:75px;width:75px;"></div><div style="height:18px;"><p style="overflow:hidden;font-size:small;margin-top:0px;height:18px;width:81px;margin-left:-3px;white-space:nowrap;" title="'+s.encattr_res_name+'">'+s.enc_res_name+"</p></div></div>"),e(".backupPic_"+s.res_id).error(function(){LINKDOCS.imgLoadingError(s.no_preview_class,this)}),e("[id='"+s.res_id+"']").click(function(){LINKDOCS.selectDoc(this,s.res_id,s.encattr_res_name,s.download_url),e("div#showopenservicefilespace").linkdocsdatagrid("showSelectedDocs")});var i=!1;e.each(G_LD_OBJ.selecteddocs,function(e,t){t.res_id===s.res_id&&(i=!0)}),i?e("[id='"+s.res_id+"']").removeClass("thumb-deselect").addClass("thumb-select"):e("[id='"+s.res_id+"']").removeClass("thumb-select").addClass("thumb-deselect")}}),0!==t.length||e("#thumbnailcontainer").find("div").hasClass("folderDataDiv")||e("#thumbnailcontainer").find("div").hasClass("thumb-deselect")||e("#thumbnailcontainer").append('<div id="noitems" style="margin-left:70px;margin-top:100px;">'+zd_js_obj.label_no_items_are_present+"</div>")},constructFolderListView:function(){var t=this,s=G_LD_OBJ.jsonData.dataobj;void 0===s&&(s=G_LD_OBJ.jsonData.folders),e.each(s,function(s,a){if(void 0!=a.res_name){var i=e("<div>").addClass("folderDataDiv").attr({id:a.res_id,folderId:a.res_id,pntFolderId:a.parent_folder_id}).data({folderName:a.encattr_res_name}),o=e('<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center">'),d=e("<tr>"),r=e("<td>"),n=ZDUtils.substringName(a.encattr_res_name,"40"),l='<table width="100%" border="0" cellpadding="0" cellspacing="1" class="docs-tablerow"><tr>';if(a.is_folder)t.options.checkboxIconSpace&&(l+='<td style="width:20px" height="20"></td>'),t.options.documentIcon&&(l+='<td style="width:20px;" nowrap="nowrap"><div class="zdc-foldericon_css">&nbsp;</div></td>'),t.options.documentName&&(l+='<td style="width:100%;font-size:14px;"" class="docscursor" nowrap="nowrap" align="left" title="'+a.encattr_res_name+'"><a style="padding-left:3px;">'+n+"</a></td>");else{var c=!1,_="";e.each(G_LD_OBJ.selecteddocs,function(e,t){t.res_id===a.res_id&&(c=!0)}),_=c?"selectcheckboxicon_css":"normalcheckboxicon_css",t.options.checkboxIconSpace&&(l+='<td width="20" height="20" nowrap="nowrap" class="docscursor checkboxtd" elem="checkbox" ><img src="'+G_LD_OBJ.spacerImagePath+'" class="'+_+'"/></td>'),t.options.documentIcon&&(l+='<td width="20" nowrap="nowrap" elem="documenticon"><div class="'+a.class_name+' flleft docscursor"></div></td>'),t.options.documentName&&(l+='<td nowrap="nowrap" align="left" elem="documentname">&nbsp;<a class="activelink"><span id="fileNameSpan_'+a.res_id+'" docId="'+a.res_id+'" style="font-size:14px;"  title="'+a.encattr_res_name+'" class="docscursor">'+a.encattr_res_name+"</span></a></td>"),t.options.lastModifiedTime&&(l+='<td width="180" nowrap="nowrap" align="center" elem="lastmodifiedtime">&nbsp;<a><span style="font-size:14px;">'+a.last_modified_time+"</span></a></td>")}l+="</tr></table>",r.append(l),d.append(r),o.append(d),i.append(o),e("#thumbnailcontainer").append(i),a.is_folder?e("#"+a.res_id).click(function(){G_LD_OBJ.foldertree.push(a),e("#moveUpFolders").removeClass("non-hover").addClass("hover"),e("#moveUpFolders").find("span").removeClass("back-folder-inactive").addClass("back-folder"),"crm"===G_LD_OBJ.urlInvoker?LINKDOCS.constructSubList(a.res_id,a.res_name,a.library_id):LINKDOCS.constructSubList(a.res_id,a.res_name)}):e("[id='"+a.res_id+"']").click(function(){var t=this,s=!1;if(e.each(G_LD_OBJ.selecteddocs,function(i,o){return o.res_id===a.res_id?(s=!0,e(t).find("td.checkboxtd").children().removeClass("selectcheckboxicon_css").addClass("normalcheckboxicon_css"),e(t).children("table.data-hover").removeClass("zd_select"),G_LD_OBJ.selecteddocs.splice(i,1),!1):void 0}),s===!1&&G_LD_OBJ.selecteddocs.length<Number(G_LD_OBJ.filelimit)){var i={res_id:a.res_id,res_name:a.encattr_res_name,download_url:a.download_url};e(t).find("td.checkboxtd").children().removeClass("normalcheckboxicon_css").addClass("selectcheckboxicon_css"),e(t).children("table").addClass("zd_select"),G_LD_OBJ.selecteddocs.push(i)}else G_LD_OBJ.selecteddocs.length>=Number(G_LD_OBJ.filelimit)&&s===!1&&alert("file limit exceeds");e("div#showopenservicefilespace").linkdocsdatagrid("showSelectedDocs")})}})},showSelectedDocs:function(){e("#selectboxdiv").empty(),e.each(G_LD_OBJ.selecteddocs,function(t,s){if(void 0!==s.res_id){var a='<div class="selectbox flleft" style="overflow:hidden;" id="selectedfile_'+s.res_id+'"><span class="flleft" title="'+s.res_name+'" alt="'+s.res_name+'">'+s.res_name+'</span><span action="delete" id="delete_'+s.res_id+'" class="closeBtn_css flleft cursor cls" alt="'+zd_js_obj.remove+'" title="'+zd_js_obj.remove+'"></span></div>';e("#selectboxdiv").append(a),e("[id='delete_"+s.res_id+"']").click(function(){"cms"===G_LD_OBJ.urlInvoker?e("#"+s.res_id).removeClass("thumb-select").addClass("thumb-deselect"):(e("#"+s.res_id).find("td.checkboxtd").children().addClass("normalcheckboxicon_css").removeClass("selectcheckboxicon_css"),e("#"+s.res_id).children("table.data-hover").removeClass("zd_select"));var t="";e.each(G_LD_OBJ.selecteddocs,function(e,a){return a.res_id===s.res_id?void(t=e):void 0}),G_LD_OBJ.selecteddocs.splice(t,1),e("#selectedfile_"+s.res_id).remove()})}}),e("#selectedfile_undefined").remove()},moveUp:function(){var t=G_LD_OBJ.foldertree;if(t.length<=1)G_LD_OBJ.foldertree.pop(),e("#moveUpFolders").find("span").removeClass("back-folder").addClass("back-folder-inactive"),e("#moveUpFolders").removeClass("hover").addClass("non-hover"),e("div#showopenservicefilespace").linkdocsdatagrid("sendAjaxRequest");else{var s=t[t.length-2].res_id,a=t[t.length-2].res_name,i=t[t.length-1].library_id;G_LD_OBJ.foldertree.pop(),"crm"===G_LD_OBJ.urlInvoker?LINKDOCS.constructSubList(s,a,i):LINKDOCS.constructSubList(s,a)}},_constructURLParametersForZsoid:function(){var t=G_LD_OBJ.docsURL,s=e("#serviceDialogLeftPanel").find("td.selectedView").attr("id");return e("#moveUpFolder").removeClass("hover").addClass("non-hover").children().removeClass("back-folder cursor").addClass("back-folder-inactive flleft"),"recentservicedocs"==s?(t+="/docs/linkdocsrequest.do?method=getRecentDocsForZSOID&zsoid="+G_LD_OBJ.zsoid+"&service="+G_LD_OBJ.urlInvoker+"&_t="+(new Date).getTime(),void 0!==G_LD_OBJ.attachObj.wsId&&""!==G_LD_OBJ.attachObj.wsId&&(t+="&wsId="+G_LD_OBJ.attachObj.wsId)):"zsoidwsdocs"==s&&"workspace"==G_LD_OBJ.wsId?(t+="/docs/linkdocsrequest.do?method=getWorkspacesForZSOID&zsoid="+G_LD_OBJ.zsoid+"&service="+G_LD_OBJ.urlInvoker+"&_t="+(new Date).getTime(),void 0!==G_LD_OBJ.attachObj.wsId&&""!==G_LD_OBJ.attachObj.wsId&&(t+="&wsId="+G_LD_OBJ.attachObj.wsId)):(void 0===G_LD_OBJ.wsAuthorId&&(G_LD_OBJ.wsAuthorId=""),e("#moveUpFolder").toggleClass("non-hover hover").children().toggleClass("back-folder-inactive back-folder docscursor"),t+="/docs/linkdocsrequest.do?method=getFolderDocsForZSOID&zsoid="+G_LD_OBJ.zsoid+"&service="+G_LD_OBJ.urlInvoker+"&wsid="+G_LD_OBJ.wsId+"&folderId="+G_LD_OBJ.folderId+"&fromIndex="+G_LD_OBJ.startFrom+"&noOfDocuments="+G_LD_OBJ.fetchLimit+"&wsAuthorId="+G_LD_OBJ.wsAuthorId+"&order="+G_LD_OBJ.sortOrder+"&field="+G_LD_OBJ.fieldName+"&_t="+(new Date).getTime(),G_LD_OBJ.moveUpFolder&&(t+="&isParentFolderDocs=true")),t},constructWorkspaceRows:function(){var t="";if(0==G_LD_OBJ.jsonData.WORKSPACE.length)return this.noDocuments=e("div#openFileDataDiv"),t+='<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="docs-tabledata"><tr><td colspan="5" nowrap><BR><div align="center">'+zd_js_obj.no_folders+"</div></td></tr></table>",void this.noDocuments.append(t);for(var s=0,a=G_LD_OBJ.jsonData.WORKSPACE.length;a>s;s++){this.wsFolderDataDiv=e("div#openFileDataDiv");var i=e("<div>").addClass("wsfolderDataDiv").attr({id:G_LD_OBJ.jsonData.WORKSPACE[s].WORKSPACEID,wsId:G_LD_OBJ.jsonData.WORKSPACE[s].WORKSPACEID,context:"rightmenu"}).data({wsName:G_LD_OBJ.jsonData.WORKSPACE[s].WORKSPACENAME,wsAuthorId:G_LD_OBJ.jsonData.WORKSPACE[s].AUTHORID}),o=G_LD_OBJ.jsonData.WORKSPACE[s].CLASSNAME,d=e('<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="wsfolderDiv">'),r=e("<tr>"),n=e("<td>"),l=ZDUtils.substringName(G_LD_OBJ.jsonData.WORKSPACE[s].WORKSPACENAME,"40"),c='<table width="100%" border="0" cellpadding="0" cellspacing="1" class="docs-tablerow"><tr>';this.options.checkboxIconSpace&&(c+='<td style="width:20px" height="20"></td>'),this.options.documentIcon&&(c+='<td style="width:20px;" nowrap="nowrap"><div class="'+o+'">&nbsp;</div></td>'),this.options.documentName&&(c+='<td style="width:100%" class="docscursor" nowrap="nowrap" align="left" title="'+G_LD_OBJ.jsonData.WORKSPACE[s].WORKSPACENAME+'"><a style="padding-left:3px;">'+l+"</a></td>"),c+="</tr></table>",n.append(c),r.append(n),d.append(r),i.append(d),this.wsFolderDataDiv.append(i)}},constructDocumentRows:function(){var t="";return 0==G_LD_OBJ.jsonData.DOC.length&&0==G_LD_OBJ.jsonData.FOLDER.length?(this.noDocuments=e("div#openFileDataDiv"),G_LD_OBJ.parentFolderId=G_LD_OBJ.folderId,t+='<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="docs-tabledata"><tr><td colspan="5" nowrap><BR><div align="center">'+zd_js_obj.no_documents_are_present+"</div></td></tr></table>",void this.noDocuments.append(t)):(G_LD_OBJ.jsonData.FOLDER.length>0&&1==Math.abs(G_LD_OBJ.prevIndex)?this._constructFolderInfoRows():G_LD_OBJ.parentFolderId=G_LD_OBJ.folderId,G_LD_OBJ.jsonData.DOC.length>0&&(G_LD_OBJ.totalFiles=e("#recentservicedocs").hasClass("selectedView")?G_LD_OBJ.jsonData.DOC.length:G_LD_OBJ.jsonData.TOTALDOCS[0].NOOFDOCS,this._constructPaginationData(),this._constructDocInfoRows()),void("folder"==G_LD_OBJ.folderId&&e("#moveUpFolder").removeClass("hover").addClass("non-hover").children().removeClass("back-folder cursor").addClass("back-folder-inactive flleft")))},_constructDocInfoRows:function(){var t="";t=G_LD_OBJ.endIndex>G_LD_OBJ.jsonData.DOC.length?G_LD_OBJ.jsonData.DOC.length:G_LD_OBJ.endIndex,this.containerDiv=e("div#openFileDataDiv"),Math.abs(G_LD_OBJ.prevIndex)>1?this.containerDiv.empty():this.containerDiv.find(".documentDataDiv").remove();for(var s=G_LD_OBJ.fromIndex;t>s;s++){var a=e("<div>").addClass("documentDataDiv").attr({id:G_LD_OBJ.jsonData.DOC[s].DOCID,docName:G_LD_OBJ.jsonData.DOC[s].DOCNAME}).data({service:G_LD_OBJ.jsonData.DOC[s].SERVICE_TYPE,cssName:G_LD_OBJ.jsonData.DOC[s].CLASSNAME,docName:G_LD_OBJ.jsonData.DOC[s].DOCNAME,isDocumentSharedToMe:!1,isTemplates:!1}),i=e('<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="'+this.options.hoverclass+'">'),o=e("<tr>"),d=e('<td colspan="4" nowrap="nowrap" width="100%">'),r=G_LD_OBJ.jsonData.DOC[s].ENCATTR_DOCNAME,n=G_LD_OBJ.jsonData.DOC[s].ENC_DOCNAME;n=ZDUtils.substringName(n,"40");var l='<table width="100%" border="0" cellpadding="0" cellspacing="1" class="docs-tablerow"><tr>';this.options.checkboxIconSpace&&(l+='<td width="20" height="20" nowrap="nowrap" class="docscursor checkboxtd" elem="checkbox" ><img src="'+G_LD_OBJ.spacerImagePath+'" class="'+this.options.checkboxIcon+'"/></td>'),this.options.documentIcon&&(l+='<td width="20" nowrap="nowrap" elem="documenticon"><div class="'+G_LD_OBJ.jsonData.DOC[s].CLASSNAME+' flleft docscursor"></div></td>'),this.options.documentName&&(l+="trashservicedocs"!=G_LD_OBJ.selectedLeftPanel?'<td nowrap="nowrap" align="left" elem="documentname">&nbsp;<a class="activelink"><span id="fileNameSpan_'+G_LD_OBJ.jsonData.DOC[s].DOCID+'" docId="'+G_LD_OBJ.jsonData.DOC[s].DOCID+'" title="'+r+'" class="docscursor">'+n+"</span></a></td>":'<td nowrap="nowrap" align="left">&nbsp;<a target="_blank"  href="/index.do?docId='+G_LD_OBJ.jsonData.DOC[s].DOCID+'"><span id="fileNameSpan_'+G_LD_OBJ.jsonData.DOC[s].DOCID+'" docId="'+G_LD_OBJ.jsonData.DOC[s].DOCID+'" title="'+r+'" class="trashlink">'+n+"</span></a></td>"),this.options.lastModifiedTime&&(l+='<td width="90" nowrap="nowrap" align="left" elem="lastmodifiedtime">&nbsp;<a><span>'+G_LD_OBJ.jsonData.DOC[s].LAST_MODIFIEDTIME+"</span></a></td>"),l+="</tr></table>",d.append(l),o.append(d),i.append(o),a.append(i),this.containerDiv.append(a)}},_constructFolderInfoRows:function(){for(var t=0,s=G_LD_OBJ.jsonData.FOLDER.length;s>t;t++){G_LD_OBJ.parentFolderId!=G_LD_OBJ.jsonData.FOLDER[t].PARENTFOLDERID&&(G_LD_OBJ.parentFolderId=G_LD_OBJ.jsonData.FOLDER[t].PARENTFOLDERID),this.folderDataDiv=e("div#openFileDataDiv");var a=e("<div>").addClass("folderDataDiv").attr({id:G_LD_OBJ.jsonData.FOLDER[t].FOLDERID,folderId:G_LD_OBJ.jsonData.FOLDER[t].FOLDERID,pntFolderId:G_LD_OBJ.jsonData.FOLDER[t].PARENTFOLDERID}).data({folderName:G_LD_OBJ.jsonData.FOLDER[t].FOLDERNAME}),i=e('<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="folderDiv">'),o=e("<tr>"),d=e("<td>"),r=ZDUtils.substringName(G_LD_OBJ.jsonData.FOLDER[t].FOLDERNAME,"40"),n='<table width="100%" border="0" cellpadding="0" cellspacing="1" class="docs-tablerow"><tr>';this.options.checkboxIconSpace&&(n+='<td style="width:20px" height="20"></td>'),this.options.documentIcon&&(n+='<td style="width:20px;" nowrap="nowrap"><div class="zdc-foldericon_css">&nbsp;</div></td>'),this.options.documentName&&(n+='<td style="width:100%" class="docscursor" nowrap="nowrap" align="left" title="'+G_LD_OBJ.jsonData.FOLDER[t].FOLDERNAME+'"><a style="padding-left:3px;">'+r+"</a></td>"),n+="</tr></table>",d.append(n),o.append(d),i.append(o),a.append(i),this.folderDataDiv.append(a)}},_constructPaginationData:function(){var t="";G_LD_OBJ.totalFiles>0&&(t='<table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td id="pagestatusid" class="pagecount smallText"></td><td><div id="prevbuttonid" class="zd_prev">&nbsp;</div></td><td><div id="nextbuttonid" class="zd_next">&nbsp;</div></td></tr></tbody></table>',e("#servicefilepagination").html(t),G_LD_OBJ.nextIndex>=G_LD_OBJ.totalFiles&&(G_LD_OBJ.nextIndex=G_LD_OBJ.totalFiles,e("#prevbuttonid").removeClass().addClass("zd_prev"),e("#nextbuttonid").removeClass().addClass("zd_nextDis")),1==G_LD_OBJ.prevIndex&&e("#prevbuttonid").removeClass().addClass("zd_preDis"),e("#pagestatusid").text(G_LD_OBJ.prevIndex+" - "+G_LD_OBJ.nextIndex+" "+zd_js_obj.of+" "+G_LD_OBJ.totalFiles),e("#servicefilepagination").show())},previousPage:function(){e("#prevbuttonid","#servicefilepagination").hasClass("zd_preDis")||(G_LD_OBJ.nextIndex=Math.abs(G_LD_OBJ.prevIndex)-Math.abs(1),G_LD_OBJ.prevIndex=Math.abs(G_LD_OBJ.nextIndex)-(Math.abs(G_LD_OBJ.docsPerPage)-Math.abs(1)),G_LD_OBJ.prevIndex<G_LD_OBJ.topLevelFetch?(G_LD_OBJ.topLevelFetch=Math.abs(G_LD_OBJ.prevIndex),G_LD_OBJ.bottomLevelFetch=Math.abs(G_LD_OBJ.topLevelFetch)+Math.abs(G_LD_OBJ.fetchLimit)-Math.abs(1),G_LD_OBJ.endIndex="10",G_LD_OBJ.fromIndex="0",G_LD_OBJ.startFrom=G_LD_OBJ.topLevelFetch,e("div#showopenservicefilespace").linkdocsdatagrid("sendAjaxRequest")):G_LD_OBJ.prevIndex<=G_LD_OBJ.bottomLevelFetch&&(G_LD_OBJ.fromIndex=Math.abs(G_LD_OBJ.fromIndex)-Math.abs(10),G_LD_OBJ.endIndex=Math.abs(G_LD_OBJ.endIndex)-Math.abs(10),e("div#showopenservicefilespace").linkdocsdatagrid("constructDocumentRows")),ZDUtils.hideLoadingMsg())},nextPage:function(){return e("#nextbuttonid","#servicefilepagination").hasClass("zd_nextDis")?!1:(G_LD_OBJ.prevIndex=Math.abs(G_LD_OBJ.nextIndex)+Math.abs(1),G_LD_OBJ.nextIndex=Math.abs(G_LD_OBJ.nextIndex)+Math.abs(G_LD_OBJ.docsPerPage),G_LD_OBJ.nextIndex<=G_LD_OBJ.bottomLevelFetch?(G_LD_OBJ.fromIndex=Math.abs(G_LD_OBJ.endIndex),G_LD_OBJ.endIndex=Math.abs(G_LD_OBJ.endIndex)+Math.abs(G_LD_OBJ.docsPerPage),e("div#showopenservicefilespace").linkdocsdatagrid("constructDocumentRows")):(G_LD_OBJ.fromIndex="0",G_LD_OBJ.endIndex="10",G_LD_OBJ.topLevelFetch=Math.abs(G_LD_OBJ.bottomLevelFetch)+Math.abs(1),G_LD_OBJ.bottomLevelFetch=Math.abs(G_LD_OBJ.bottomLevelFetch)+Math.abs(G_LD_OBJ.fetchLimit),G_LD_OBJ.startFrom=G_LD_OBJ.topLevelFetch,e("div#showopenservicefilespace").linkdocsdatagrid("sendAjaxRequest")),void ZDUtils.hideLoadingMsg())}}),e.extend(e.ui.linkdocsdatagrid,{version:"1.8"})}(jQuery);var G_OF_OBJ;ATTACHDIALOG.initMenu=function(e){("left"==e||"both"==e)&&(ZD("#leftmenu,#visibilityoptions_top").zmenu().bind("menubeforeshow",function(e,t){var s=ZDMenu.createLeftMenu(e,t);return s}),ZD("#leftmenu,#visibilityoptions_top").bind("menuitemclicked",function(e,t){return ZDMenu.leftMenuItemActions(e,t),!0})),("right"==e||"both"==e)&&(ZD("#rightmenu").zmenu().live("menubeforeshow",function(e,t){var s=ZDMenu.createContextMenu(e,t);return s}),ZD("#rightmenu").live("menuitemclicked",function(e,t){return ZDMenu.contextMenuItemActions(e,t),!0}))},ATTACHDIALOG.attachDocsFiles=function(){if("undefined"!=typeof teamMigrationObj&&"1"===teamMigrationObj.enabled&&"2"===teamMigrationObj.type&&"4"===teamMigrationObj.user_status)return alert("You have migrated your data from Docs to WorkDrive. You cannot perfom any action on Docs files"),!1;var e=ZD("div.selectbox","#selectboxdiv");if(0==e.length)return ATTACHDIALOG.statusmsg(zd_js_obj.select_the_documents),void ZDUtils.hideLoadingMsg();var t=ATTACHDIALOG.getSelectedDocs();if(t.length>G_OF_OBJ.attachObj.attachCount)return ATTACHDIALOG.statusmsg(ZDUtils.replaceParams(zd_js_obj.validation_for_attachfile,new Array(G_OF_OBJ.attachObj.attachCount+""))),void ZDUtils.hideLoadingMsg();for(var s={},a=[],i=0,o=t.length;o>i;i++){var d={},r=t[i].docId,n=t[i].docName,l=t[i].service;l="zw"==l?"writer":"zohoshow"==l?"show":"zohosheet"==l?"sheet":"upload";var c=t[i].isDocumentSharedToMe,_=t[i].encryptedId;"undefined"==_&&(_=""),d.docId=r,d.docName=n,d.service=l,d.isDocumentSharedToMe=c,d.encryptedId=_,a[i]=d}s.docObj=a,s.handbckobj=G_OF_OBJ.attachObj.handbckobj,("salesInbox"==G_OF_OBJ.urlInvoker||"zpulse"==G_OF_OBJ.urlInvoker||"zmail"==G_OF_OBJ.urlInvoker||"zcrm"==G_OF_OBJ.urlInvoker||"discussion"==G_OF_OBJ.urlInvoker||"zcreator"==G_OF_OBJ.urlInvoker||"zprojects"==G_OF_OBJ.urlInvoker||"zwiki"==G_OF_OBJ.urlInvoker)&&attachDocsIntegCallBackFn(s),ZDDialog.closePopUp("attachfiledialogdiv")},ATTACHDIALOG.attachFiles=function(){if("undefined"!=typeof teamMigrationObj&&"1"===teamMigrationObj.enabled&&"2"===teamMigrationObj.type&&"4"===teamMigrationObj.user_status)return alert("You have migrated your data from Docs to WorkDrive. You cannot perfom any action on Docs files"),!1;var e=ZD("div.selectbox","#selectboxdiv"),t="",s="",a="",i="",o="",d="",r="",n="",l="",c="",_="",p=!1,h=!1,D=!1;if(0==e.length){var v={},u=parseInt(ZD("#attachfiledialogdiv").parent().css("left"))+160,m=parseInt(ZD("#attachfiledialogdiv").parent().css("top"))+180,f=[u,m],O=G_OF_OBJ.attachObj.isDraggable;return v[zd_js_obj.ok]=function(){ZDDialog.closePopUp("frameDiv")},void ZDDialog.openAlert(zd_js_obj.alert,zd_js_obj.select_the_documents,!0,v,f,"",O)}var g=ATTACHDIALOG.getSelectedDocs();if(g.length>G_OF_OBJ.attachObj.attachCount){var v={},u=parseInt(ZD("#attachfiledialogdiv").parent().css("left"))+160,m=parseInt(ZD("#attachfiledialogdiv").parent().css("top"))+180,f=[u,m],O=G_OF_OBJ.attachObj.isDraggable;return v[zd_js_obj.ok]=function(){ZDDialog.closePopUp("frameDiv")},void ZDDialog.openAlert(zd_js_obj.alert,ZDUtils.replaceParams(zd_js_obj.validation_for_attachfile,new Array(G_OF_OBJ.attachObj.attachCount+"")),!0,v,f,"",O)}for(var b=0,w=g.length;w>b;b++)i=g[b].docId,o=g[b].docName,d=g[b].service,p=g[b].isDocumentSharedToMe,c=g[b].encryptedId,"true"==p?(D=!0,"zw"==d?(r=r+i+",",l+="writer,"):"zohoshow"==d?(r=r+i+",",l+="show,"):"zohosheet"==d?(r=r+i+",",l+="sheet,"):(r=r+c+",",l+="upload,"),n=n+encodeURIComponent(o)+","):(h=!0,a+="zw"==d?"writer,":"zohoshow"==d?"show,":"zohosheet"==d?"sheet,":"upload,",t=t+i+",",s=s+encodeURIComponent(o)+",");h&&(t=t.substring(0,t.length-1),s=s.substring(0,s.length-1),a=a.substring(0,a.length-1),_+="docIds="+t+"&docNames="+s+"&service="+a),h&&D&&(_+="&"),D&&(r=r.substring(0,r.length-1),n=n.substring(0,n.length-1),l=l.substring(0,l.length-1),_+="sharedDocIds="+r+"&sharedDocNames="+n+"&sharedService="+l),"discussion"==G_OF_OBJ.urlInvoker&&attachDocsIntegCallBackFn(_),ZDDialog.closePopUp("attachfiledialogdiv")},ATTACHDIALOG.getSelectedDocs=function(){var e=ZD("div.selectbox","div#selectboxdiv"),t=[],s=0;return e.each(function(){if(!ZD(this).closest("div").hasClass("selectionblur")){var e={},a=ZD(this).closest("div"),i=a.attr("docId"),o=a.attr("docName"),d=a.attr("service"),r=a.attr("fileType"),n=a.attr("isDocumentSharedToMe"),l=a.attr("encryptedId");e.docId=i,e.docName=o,e.docType=r,e.service=d,e.docURL=G_OF_OBJ.docsURL+"/file/"+e.docId,e.isDocumentSharedToMe=n,e.encryptedId=l,t[s]=e,s++}}),t},ATTACHDIALOG.checkSelectedFiles=function(e){var t=ZD("div.selectbox","div#selectboxdiv"),s=!1;return t.each(function(){var t=ZD(this).closest("div"),a=t.attr("permission"),i=t.attr("scope");1==i&&3!==a&&(a=""!==G_OF_OBJ.folderpermission?Number(G_OF_OBJ.folderpermission):2),"undefined"==a||3==a||0==a||G_OF_OBJ.asLink!==!0||ZD("#selectedfile_"+t.attr("docId")).hasClass("selectionblur")||ZD("#selectedfile_"+t.attr("docId")).addClass("selectionblur"),e===t.attr("docId")&&(s=!0)}),s},ATTACHDIALOG.getDocAsLink=function(){var e=ATTACHDIALOG.getSelectedDocs(),t="",s="";t=1===e.length&&"zw"===e[0].service?{recipentsofemail:{permission:"ro rw rc co",expirydate:!1,password:!1},everyoneinorg:{permission:"ro rw rc",expirydate:!1,password:!1},everyoneininternet:{expirydate:!0,permission:!1,password:!1},extshare:{permission:"ro rw rc",expirydate:!0,password:!0}}:{recipentsofemail:{permission:"ro rw co",expirydate:!1,password:!1},everyoneinorg:{permission:"ro rw",expirydate:!1,password:!1},everyoneininternet:{expirydate:!0,permission:!1,password:!1},extshare:{permission:"ro rw",expirydate:!0,password:!0}},0===PC_USER_PLAN_TYPE?s="FREE":1===PC_USER_PLAN_TYPE?s="STANDARD":2===PC_USER_PLAN_TYPE&&(s="PREMIUM");var a={attachObj:e,shareLinkObj:t,ZD_USER_PLAN_TYPE:s,isOrgEnable:zd_isorguser};return a},ATTACHDIALOG.asLink=function(){G_OF_OBJ.asLink=!0,G_OF_OBJ.searchenabled===!0?ATTACHDIALOG.disableNonSharable():ZD("div#showattachfilespace").attachfiledatagrid("constructDocumentRows")},ATTACHDIALOG.asAttachment=function(){G_OF_OBJ.asLink=!1,G_OF_OBJ.searchenabled===!0?ATTACHDIALOG.disableNonSharable():(ZD("div#showattachfilespace").attachfiledatagrid("constructDocumentRows"),ZD("#selectboxdiv").find("div").removeClass("selectionblur"))},ATTACHDIALOG.getSelectedDocsForOpenFileDialog=function(){var e=ZD("div#attachFileDataDiv table.zd_select"),t=[];return e.each(function(e){var s={},a=ZD(this).closest("div"),i=a.attr("id"),o=a.data("fileId"),d=a.data("service"),r=a.data("docName"),n=a.data("cssName"),l=a.data("isDocumentSharedToMe"),c=a.data("isTemplates"),_=a.data("encryptedId");s.docId=i,s.fileId=o,s.file_name=r,s.service=d,s.classname=n,s.isDocumentSharedToMe=l,s.encryptedId=_,s.isTemplates=c,t[e]=s}),t},ATTACHDIALOG.statusmsg=function(e){ZD("span#zd_statusmsgdiv").html(e).parent().css("display","block"),ZD("div.attach_message").css("margin-top","0px"),setTimeout(function(){ZD("span#zd_statusmsgdiv").html("").parent().css("display","none")},4e3)},ATTACHDIALOG.reset=function(){G_OF_OBJ.fromIndex="0",G_OF_OBJ.endIndex="10",G_OF_OBJ.prevIndex="1",G_OF_OBJ.nextIndex="10",G_OF_OBJ.startFrom="0",G_OF_OBJ.gridObj.authorName=!1},ATTACHDIALOG.selectRow=function(e){ZD("#"+e).find("td.checkboxtd").children().removeClass("normalcheckboxicon_css").addClass("selectcheckboxicon_css"),ZD("#"+e).children("table.data-hover").addClass("zd_select")},ATTACHDIALOG.deselectRow=function(e){ZD("#"+e).find("td.checkboxtd").children().removeClass("selectcheckboxicon_css").addClass("normalcheckboxicon_css"),ZD("#"+e).children("table.data-hover").removeClass("zd_select"),ZD("#selectedfile_"+e).length&&ZD("#selectedfile_"+e).remove()},ATTACHDIALOG.showSelectedDocsToAttach=function(e){var t=ZD(e).closest("div.documentDataDiv"),s=t.attr("id");if(ZD(e).find(".checkboxtd").children().hasClass("selectcheckboxicon_css"))return void ATTACHDIALOG.deselectRow(s);ATTACHDIALOG.selectRow(s);var a=t.attr("serviceType");void 0===a&&(a=ZD("#"+s).data("service"));var i=t.attr("isDocumentSharedToMe"),o=t.attr("encryptedId"),d=t.data("encAttrFileName");void 0===d&&(d=ZD("#"+s).data("encfilename"));var r=t.data("permission"),n=ZD("#"+s).data("fileType"),l=ZDUtils.substringName(d,"10");void 0!==t.attr("data-encattrfilename")&&(d=t.attr("data-encattrfilename"));var c='<div class="selectbox flleft" style="overflow:hidden;" id="selectedfile_'+s+'" fileType="'+n+'" permission="'+r+'"  docId="'+s+'" docName="'+d+'" service="'+a+'" isDocumentSharedToMe="'+i+'" encryptedId="'+o+'"><span class="flleft" title="'+d+'" alt="'+d+'">'+l+'</span><span action="delete" id="'+s+'_delete" class="closeBtn_css flleft cursor cls" alt="'+zd_js_obj.remove+'" title="'+zd_js_obj.remove+'"></span></div>';if(ZD("#selectboxdiv").append(c),G_OF_OBJ.asLink===!0&&t.hasClass("opacityshare")){var _="You can share only the files you own or co-own via link. Please add as attachment.";void 0!=zd_js_obj.label_alert_while_click_shared&&(_=zd_js_obj.label_alert_while_click_shared),ATTACHDIALOG.statusmsg(_),ZD("#selectedfile_"+s).addClass("selectionblur")}},ATTACHDIALOG.selectOrdeselectRow=function(e,t){var s=ZD(t).closest(".documentDataDiv"),a=(currentObj.attr("id"),s.children("table.data-hover").hasClass("zd_select"));return a?(s.find("td.checkboxtd").children().removeClass("selectcheckboxicon_css").addClass("normalcheckboxicon_css"),s.children("table.data-hover").removeClass("zd_select")):(s.find("td.checkboxtd").children().removeClass("normalcheckboxicon_css").addClass("selectcheckboxicon_css"),s.children("table.data-hover").addClass("zd_select")),!1},ATTACHDIALOG.clearSelectedRows=function(){var e=ZD("#attachFileDataDiv").find("div.documentDataDiv").children("table.zd_select");ZD(e).each(function(e,t){ZD(t).removeClass("zd_select"),ZD(t).find("td.checkboxtd").children().toggleClass("normalcheckboxicon_css selectcheckboxicon_css")})},ATTACHDIALOG.getSharedDocs=function(e,t,s){ATTACHDIALOG.LoadingMsg(zd_js_obj.loading),G_OF_OBJ.selectedLeftPanel="shareddocs",null==e&&(e=0),null==t&&(t="time"),null==s&&(s="desc");var a=G_OF_OBJ.docsURL+"/docs/viewsearchresults.do?method=attachFileSharedDocs&start="+e+"&field="+t+"&action="+s+"&_t="+(new Date).getTime(),i=ZD("#showattachfilespace").children();ZD(i).each(function(e,t){ZD(t).empty().remove()}),ZD.ajax({url:a,xhrFields:{withCredentials:!0},type:"POST",datatype:"html",success:function(e){ZD("#showattachfilespace").html(e),ATTACHDIALOG.hideLoadingMsg(),ATTACHDIALOG.updateSelectedDocs()}})},ATTACHDIALOG.clearText=function(){"Searchfiles"==ZD("#searchFileName").value&&(ZD("#searchFileName").value="")},ATTACHDIALOG.LoadingMsg=function(e){var t=zd_js_obj.loading;""!=e&&void 0!=e&&(t=e),ZD("#msgdiv").remove(),ZD("#openloadingmsg").append('<span  id="msgdiv" style="padding:3px 5px;background-color:#848484;color:#FFF;font-size:11px;font-weight:bold;text-align:center;right:3px;position:absolute;">'+t+"</span>")},ATTACHDIALOG.hideLoadingMsg=function(){ZD("#openloadingmsg").children().remove()},ATTACHDIALOG.getDocAsList=function(e,t){var s;""!=e&&void 0!=e?s=ZD(e).attr("id"):""!=t&&void 0!==t&&(s=t),ZD("#actionMenuOpenFile").css("display","block"),("desktopservicedocs"===s||"sharedservicedocs"===s)&&(G_OF_OBJ.folderId="folder"),"workspacelist"===s&&(G_OF_OBJ.folderId="wshome",G_OF_OBJ.wsId="wshome"),""!=s&&void 0!=s&&(ATTACHDIALOG.changeAllToNormalView(s),G_OF_OBJ.selectedLeftPanel=s),ATTACHDIALOG.resetAll();var a=G_OF_OBJ.gridObj;ZD("#sharedservicedocs").hasClass("selectedView")&&(a.authorName=!0),ZD("div#showattachfilespace").attachfiledatagrid("populateDataPanel",a)},ATTACHDIALOG.getSortDocAsList=function(e,t){var s;""!=e&&void 0!=e?s=ZD(e).attr("id"):""!=t&&void 0!==t&&(s=t),ZD("#actionMenuOpenFile").css("display","block"),""!=s&&void 0!=s&&(ATTACHDIALOG.changeAllToNormalView(s),G_OF_OBJ.selectedLeftPanel=s),ATTACHDIALOG.resetAll();var a=G_OF_OBJ.gridObj;"sharedservicedocs"==s&&(a.authorName=!0),ZD("div#showattachfilespace").attachfiledatagrid("populateDataPanel",a)},ATTACHDIALOG.resetAll=function(){ATTACHDIALOG.reset();var e=ZD("#showattachfilespace").children();ZD(e).each(function(e,t){ZD(t).empty().remove()}),ZD("#showattachfilespace").attachfiledatagrid("resetOptions"),ZD("#servicefilepagination").css("display","none")},ATTACHDIALOG.changeAllToNormalView=function(e){ZD("#serviceDialogLeftPanel").find("td.selectedView").toggleClass("selectedView normalView"),""!=e&&void 0!=e&&ZD("#"+e).addClass("selectedView").removeClass("normalView")},ATTACHDIALOG.setSortOrder=function(e){var t=ZD(e).attr("id");G_OF_OBJ.nameSortArrow=ZD(e).children().attr("class"),G_OF_OBJ.timeSortArrow=ZD(e).children("img").attr("class"),"nameHeader"==t?(G_OF_OBJ.timeSortArrow="",G_OF_OBJ.sortOrder="",G_OF_OBJ.orderBy="name",G_OF_OBJ.sortOrder=ZD(e).children().hasClass("DownArrow")?"asc":"desc"):"dateModifiedHeader"==t&&(G_OF_OBJ.nameSortArrow="",G_OF_OBJ.sortOrder="",G_OF_OBJ.orderBy="date",G_OF_OBJ.sortOrder=ZD(e).children().hasClass("DownArrow")?"asc":"desc")},ATTACHDIALOG.setClassAfterSorting=function(e){var t=ZD(e).attr("id");"nameHeader"==t?(ZD("#dateModifiedHeader").children("img:first").removeClass().addClass("DownArrowH"),ZD("#"+t).children("img:first").removeClass().addClass("UpArrow"==G_OF_OBJ.nameSortArrow?"DownArrow":"UpArrow")):"dateModifiedHeader"==t&&(ZD("#nameHeader").children("img:first").removeClass().addClass("DownArrowH"),ZD("#"+t).children("img:first").removeClass().addClass("UpArrow"==G_OF_OBJ.timeSortArrow?"DownArrow":"UpArrow"))},ATTACHDIALOG.getUserDocsPlan=function(e){var t=e+"/docs/zduserdetails.do",s={};return ZD.ajax({url:t,type:"GET",dataType:"html",async:!1,cache:!1,xhrFields:{withCredentials:!0},success:function(e){ZD("#zd_user_details").remove(),ZD("body").append(e),ZD(e).find("script").each(function(){ZD.parseJSON(ZD(this).text())}),zdcsrfPair=ZD("#zd_user_details").attr("csrfparamName")+"="+ZD("#zd_user_details").attr("csrftoken"),0===PC_USER_PLAN_TYPE?userPlanType="FREE":1===PC_USER_PLAN_TYPE?userPlanType="STANDARD":2===PC_USER_PLAN_TYPE&&(userPlanType="PREMIUM"),s={ZD_USER_PLAN_TYPE:userPlanType,isOrgEnable:zd_isorguser}}}),s},ATTACHDIALOG.getI18N=function(e,t){var s=t+"/docs/zduserdetails.do";ZD.ajax({url:s,type:"GET",dataType:"html",xhrFields:{withCredentials:!0},success:function(t){ZD("#zd_user_details").remove(),ZD("body").append(t),ZD(t).find("script").each(function(){ZD.parseJSON(ZD(this).text())}),zdcsrfPair=ZD("#zd_user_details").attr("csrfparamName")+"="+ZD("#zd_user_details").attr("csrftoken"),void 0!=e&&""!=e&&e()}})},ATTACHDIALOG.getI18NForCSPCase=function(e,t){var s=t+"/docs/zduserdetails.do";ZD.ajax({url:s,type:"GET",dataType:"html",xhrFields:{withCredentials:!0},success:function(t){if(ZD("body").append(ZD(t).filter("#zd_user_details")[0]),ZD("body").append(ZD(t).filter("#zd_i18ndetails")[0]),zd_js_obj=JSON.parse(ZD("#zd_i18ndetails").attr("zd_js_obj")),ZD("body").append(ZD(t).filter("#zd_component_variables")[0]),window.ZUID=ZD("#zd_component_variables").attr("zuid"),window.zd_isorguser="true"==ZD("#zd_component_variables").attr("zd_isorguser")?!0:!1,window.orgnameofcurrentuser=ZD("#zd_component_variables").attr("orgnameofcurrentuser"),window.orgLabel=zd_js_obj.label_everyone_org,orgnameofcurrentuser.length){var s=orgnameofcurrentuser;if(orgnameofcurrentuser.length>40)var s=orgnameofcurrentuser.substring(0,40);orgLabel=ZDUtils.replaceParams(zd_js_obj.label_everyone_orgname,new Array(s))}if(window.userFullName=ZD("#zd_component_variables").attr("userFullName"),window.PC_USER_PLAN_TYPE=parseInt(ZD("#zd_component_variables").attr("PC_USER_PLAN_TYPE")),window.zd_third_party=ZD("#zd_component_variables").attr("zd_third_party"),window.ZOHO_CN=ZD("#zd_component_variables").attr("ZOHO_CN"),window.docsCSRFParamNAME=ZD("#zd_component_variables").attr("docsCSRFParamNAME"),window.docsCSRFCookieName=ZD("#zd_component_variables").attr("docsCSRFCookieName"),window.isCommentEnabled="true"==ZD("#zd_component_variables").attr("isCommentEnabled")?!0:!1,window.serviceUrl=ZD("#zd_component_variables").attr("serviceUrl"),window.pcUrl=ZD("#zd_component_variables").attr("pcUrl"),window.zd_serviceName=ZD("#zd_component_variables").attr("zd_serviceName"),window.zd_udservicekey=ZD("#zd_component_variables").attr("zd_udservicekey"),window.zd_udserverurl=ZD("#zd_component_variables").attr("zd_udserverurl"),window.userCanShareExternally=ZD("#zd_component_variables").attr("userCanShareExternally"),window.IAM_URL=ZD("#zd_component_variables").attr("IAM_URL"),window.currentBrowserDetails=ZD("#zd_component_variables").attr("currentBrowserDetails"),window.isCommonErrorPageEnabled="true"==ZD("#zd_component_variables").attr("isCommonErrorPageEnabled")?!0:!1,window.ZD_GUEST_EDIT_SHEET="true"==ZD("#zd_component_variables").attr("ZD_GUEST_EDIT_SHEET")?!0:!1,window.ZD_GUEST_EDIT_SHOW="true"==ZD("#zd_component_variables").attr("ZD_GUEST_EDIT_SHOW")?!0:!1,window.ZD_COMMENT_ENABLEDFOR_SHEET="true"==ZD("#zd_component_variables").attr("ZD_COMMENT_ENABLEDFOR_SHEET")?!0:!1,window.ZD_COMMENT_ENABLEDFOR_SHOW="true"==ZD("#zd_component_variables").attr("ZD_COMMENT_ENABLEDFOR_SHOW")?!0:!1,window.ZD_SHARENOTE_GOTIT_ORGSHARE="true"==ZD("#zd_component_variables").attr("ZD_SHARENOTE_GOTIT_ORGSHARE")?!0:!1,window.ZD_SHARENOTE_GOTIT_LINKSHARE="true"==ZD("#zd_component_variables").attr("ZD_SHARENOTE_GOTIT_LINKSHARE")?!0:!1,window.ZD_SHARENOTE_GOTIT_SECUREEMAILSHARE="true"==ZD("#zd_component_variables").attr("ZD_SHARENOTE_GOTIT_SECUREEMAILSHARE")?!0:!1,window.zdc_ContactsURL=ZD("#zd_component_variables").attr("zdc_ContactsURL"),window.css_lable=ZD("#zd_component_variables").attr("css_lable"),window.compStaticServer=ZD("#zd_component_variables").attr("compStaticServer"),window.staticVersionToLoad=ZD("#zd_component_variables").attr("staticVersionToLoad"),window.READ_CMT_ENABLED_SERVICES="zw",window.ZD_IS_NEW_UI_ENABLED=ZD("#zd_component_variables").attr("ZD_IS_NEW_UI_ENABLED"),ZD_COMMENT_ENABLEDFOR_SHEET&&(READ_CMT_ENABLED_SERVICES+="|zohosheet"),ZD_COMMENT_ENABLEDFOR_SHOW&&(READ_CMT_ENABLED_SERVICES+="|zohoshow"),window.ZDOCScsrfToken=ZD("#zd_component_variables").attr("ZDOCScsrfToken"),serviceUrl=window.location.origin,window.zdcsrfPair=window.docsCSRFParamNAME+"="+window.ZDOCScsrfToken,window.canLoadWDOrDocsDialog=!0,isCommonErrorPageEnabled&&("WRITER"==zd_serviceName||"SHEET"==zd_serviceName||"SHOW"==zd_serviceName||"DOCS"==zd_serviceName)&&!currentBrowserDetails.IS_SUPPORTED_BROWSER){var a=ZD("#browser-error-msg").html();if(null!=a)if(ZD(document).znotifier)ZD(document).znotifier({type:"warning",iconclass:"ui-components-icon ui-state-warning-icon",position:"north",content:a,autohide:!1});else{var i='<div id="browserErrorMsg" style="width: auto; text-align: center; margin: 0 auto; -webkit-border-bottom-right-radius: 7px; -webkit-border-bottom-left-radius: 7px; -moz-border-radius-bottomright: 7px; -moz-border-radius-bottomleft: 7px; border-bottom-right-radius: 7px; border-bottom-left-radius: 7px; -moz-box-shadow: 0px 0px 4px #d8d8d8; box-shadow: 0px 0px 4px #d8d8d8; -webkit-box-shadow: 0px 0px 4px #d8d8d8; box-shadow: 0px 0px 4px #d8d8d8; position: fixed; top: 0; z-index: 9999; left: 40%; margin-left: -25%; background: #fff; border-color: #d1d6ed; color: #000; padding: 10px; font-size: 12px; border-left: 1px solid #d1d6ed; border-right: 1px solid #d1d6ed; overflow: hidden; text-align: center; border-bottom-right-radius: 7px;">'+a+'<span style="padding-left: 5px; padding-right: 5px;">|</span><a href="javascript:void(0)" style="cursor: pointer; text-decoration: underline;" onclick="ZD(\'#browserErrorMsg\').hide();">'+zd_js_obj.label_close+"</a></div>";ZD("body").append(i)}}"undefined"==typeof ZD_G_ContactSearchEnabled&&(window.ZD_G_ContactSearchEnabled=!0),void 0!=e&&""!=e&&"function"==typeof e&&e()}})},ATTACHDIALOG.checkWorkspaceStatus=function(e,t){var s=t+"/docs/attachfilerequest.do?method=checkWorkspaceStatus";ZD.ajax({url:s,type:"GET",xhrFields:{withCredentials:!0},dataType:"json",success:function(t){void 0!=e&&""!=e&&e(t.status)}})},ATTACHDIALOG.showAttachFileDialog=function(e,t){var s=e.docsURL;if(void 0==zd_js_obj||""==zd_js_obj){G_OF_OBJ=new ATTACHDIALOG;var a=function(){ATTACHDIALOG.showAttachFileDialog(e,t)};return e.servicename&&"zmail"===e.servicename?ATTACHDIALOG.getI18NForCSPCase(a,s):ATTACHDIALOG.getI18N(a,s),!1}if(void 0===t||""===t){var i=function(t){ATTACHDIALOG.showAttachFileDialog(e,t)};return ATTACHDIALOG.checkWorkspaceStatus(i,s),!1}if(!ZD("#attachfiledialogdiv").length||1==e.isnewui&&"zmail"==G_OF_OBJ.urlInvoker){"undefined"==typeof G_OF_OBJ&&(G_OF_OBJ=new ATTACHDIALOG),G_OF_OBJ.docsURL=s,"undefined"!=typeof ZOHO_CN&&"true"===ZOHO_CN&&(G_OF_OBJ.defaultObj.staticURL=location.protocol+"//css.zohostatic.com.cn/personal/docs_v481/docscomponents"),G_OF_OBJ.attachObj=ZD.extend({},G_OF_OBJ.defaultObj,e),G_OF_OBJ.urlInvoker=G_OF_OBJ.attachObj.servicename,G_OF_OBJ.attachObj.staticURL=location.protocol+"//"+css_lable+"."+compStaticServer+"/personal/docs_"+staticVersionToLoad,G_OF_OBJ.spacerImagePath=G_OF_OBJ.attachObj.staticURL+"/images/spacer.gif",("zmail"!=G_OF_OBJ.urlInvoker||1!=e.isnewui)&&ZD("body").append('<div id="attachfiledialogdiv" style="display:none;">'),ZD("body").append('<ul id="zd_leftmenu" style="display:none;"></ul>'),ZD("body").append('<ul id="zd_rightmenu" style="display:none;"></ul>');var o={};"zmail"==G_OF_OBJ.urlInvoker&&1==e.isnewui?(ZD("#"+e.container_id).append('<div id="zdattachcontainer">'),$("#zdattachcontainer").addClass("docsdialog")):("discussion"==G_OF_OBJ.urlInvoker?o[zd_js_obj.label_attach]=function(){ATTACHDIALOG.attachFiles()}:("zpulse"==G_OF_OBJ.urlInvoker||"zmail"==G_OF_OBJ.urlInvoker||"zcrm"==G_OF_OBJ.urlInvoker||"zcreator"==G_OF_OBJ.urlInvoker||"zprojects"==G_OF_OBJ.urlInvoker||"zwiki"==G_OF_OBJ.urlInvoker||"salesInbox"==G_OF_OBJ.urlInvoker)&&(o[zd_js_obj.label_attach]=function(){ATTACHDIALOG.attachDocsFiles()}),o[zd_js_obj.cancel]=function(){ZDDialog.closePopUp("attachfiledialogdiv")});var d=G_OF_OBJ.attachObj.positionObj,r=G_OF_OBJ.attachObj.isDraggable,n=G_OF_OBJ.attachObj.isResize,l=G_OF_OBJ.attachObj.height,c=G_OF_OBJ.attachObj.width,_=!0,p="undefined"!=typeof t?t:G_OF_OBJ.attachObj.workspace,h=G_OF_OBJ.attachObj.sharedDocs,D=400;zd_isIE&&"zcrm"==G_OF_OBJ.urlInvoker&&(D=600),G_OF_OBJ.attachObj.search||(_=!1),"zmail"==G_OF_OBJ.urlInvoker?l-=64:("zcrm"==G_OF_OBJ.urlInvoker||"salesInbox"==G_OF_OBJ.urlInvoker)&&(l-=24);var v="undefined"!=typeof zd_third_party&&"FUJI"===zd_third_party?"fujidocs":"undefined"!=typeof zd_third_party&&"BAIHUI"===zd_third_party?"baihuidocs":"";"zmail"==G_OF_OBJ.urlInvoker&&1==e.isnewui?(ZD("div#zdattachcontainer").addClass(v).attachfiledialog({recentDocs:{name:zd_js_obj.label_recent_docs,title:zd_js_obj.label_recent_docs},desktopDocs:{name:zd_js_obj.my_folders,title:zd_js_obj.my_folders},myDocs:{name:zd_js_obj.label_my_docs,title:zd_js_obj.label_my_docs},mySheets:{name:zd_js_obj.label_my_spreadsheets,title:zd_js_obj.label_my_spreadsheets},myPresentations:{name:zd_js_obj.label_my_presentations,title:zd_js_obj.label_my_presentations},myPictures:{name:zd_js_obj.label_my_pictures,title:zd_js_obj.label_my_pictures},sharedDocs:{show:h,name:zd_js_obj.shared_with_me,title:zd_js_obj.shared_with_me},workspace:{show:p,name:zd_js_obj.label_workspaces,title:zd_js_obj.label_workspaces},trashedDocs:{show:!1},upOneLevel:!0,advSearchBox:_}),$("#selectboxdiv").css("height",50),G_OF_OBJ.asLink=!1):(ZDDialog.showCommonDialog(zd_js_obj.label_attach_from_zoho_docs,!0,"attachfiledialogdiv",o,d,c,r,l,n,450,D),("zpulse"==G_OF_OBJ.urlInvoker||"zmail"==G_OF_OBJ.urlInvoker||"zcrm"==G_OF_OBJ.urlInvoker||"discussion"==G_OF_OBJ.urlInvoker||"zcreator"==G_OF_OBJ.urlInvoker||"zprojects"==G_OF_OBJ.urlInvoker||"zwiki"==G_OF_OBJ.urlInvoker||"salesInbox"==G_OF_OBJ.urlInvoker)&&ZD("div#attachfiledialogdiv").addClass(v).attachfiledialog({recentDocs:{name:zd_js_obj.label_recent_docs,title:zd_js_obj.label_recent_docs},desktopDocs:{name:zd_js_obj.my_folders,title:zd_js_obj.my_folders},myDocs:{name:zd_js_obj.label_my_docs,title:zd_js_obj.label_my_docs},mySheets:{name:zd_js_obj.label_my_spreadsheets,title:zd_js_obj.label_my_spreadsheets},myPresentations:{name:zd_js_obj.label_my_presentations,title:zd_js_obj.label_my_presentations},myPictures:{name:zd_js_obj.label_my_pictures,title:zd_js_obj.label_my_pictures},sharedDocs:{show:h,name:zd_js_obj.shared_with_me,title:zd_js_obj.shared_with_me},workspace:{show:p,name:zd_js_obj.label_workspaces,title:zd_js_obj.label_workspaces},trashedDocs:{show:!1},upOneLevel:!0,advSearchBox:_})),"undefined"!=typeof teamMigrationObj&&"1"===teamMigrationObj.enabled&&"2"===teamMigrationObj.type&&"4"===teamMigrationObj.user_status&&(ZD("#attachfiledialogdiv").prepend('<div id="wd_mig_message" style=" background:#fe5454; padding: 10px 5px 10px 5px; color: white;"><span>You have migrated your data from Docs to WorkDrive. you cannot perfom any action on Docs files</span></div>'),ZD("#attachfiledialogdiv").css({pointerEvents:"none"})),"zprojects"==G_OF_OBJ.urlInvoker&&ZD("div#attachfiledialogdiv").parent().css({"box-shadow":"0 0 8px #B0B0B0","-moz-box-shadow":"0 0 8px #B0B0B0","-webkit-box-shadow":"0 0 8px #B0B0B0","z-index":"999999999"}),ZD("div#showattachfilespace").attachfiledatagrid()}},ATTACHDIALOG.clearSelectedFiles=function(){for(var e=ATTACHDIALOG.getSelectedDocsForOpenFileDialog(),t=0,s=e.length;s>t;t++){var a=e[t].docId;ATTACHDIALOG.selectOrdeselectRow(a)}},ATTACHDIALOG.split=function(e){return e.split(/,\s*/)},ATTACHDIALOG.extractLast=function(e){return ATTACHDIALOG.split(e).pop()},ATTACHDIALOG.startsWithRegEx=function(e,t){var s=e.label,a="^"+t.toLowerCase();if(s.toLowerCase().match(a)==t.toLowerCase())return e;var i=e.fullname;return i.toLowerCase().match(a)==t.toLowerCase()?e:""},ATTACHDIALOG.showHideShareMsg=function(e){var t=ZD(e).hasClass("editmsg_add");t?(ZD(e).text("Discard Message"),ZD(e).removeClass("editmsg_add"),ZD("#shareMsgDiv").removeClass("hidediv").children("textarea").focus()):(ZD(e).text("Add Message"),ZD(e).addClass("editmsg_add"),ZD("#shareMsgDiv").addClass("hidediv").children("textarea").val(""))},ATTACHDIALOG.showHideMsg=function(e){var t=ZD(e).attr("checked");t?(ZD(".docsdialog .checkbox_add").text("Add Message"),ZD("#shareMsgDiv").removeClass("hidediv").children("textarea").focus()):(ZD(".docsdialog .checkbox_add").text(""),ZD("#shareMsgDiv").addClass("hidediv").children("textarea").val(""))},ATTACHDIALOG.searchMouseOver=function(e,t,s,a){e!=t&&("asc"==a?ZD("#"+s).attr("class","UpArrow"):ZD("#"+s).attr("class","DownArrow"))},ATTACHDIALOG.searchMouseOut=function(e,t,s){e!=t&&ZD("#"+s).attr("class","")},ATTACHDIALOG.searchFile=function(e){var e=ZD("#searchFileName").val();return"*"===ZD.trim(e)||""===ZD.trim(e)?(ATTACHDIALOG.statusmsg(zd_js_obj.enter_valid_text_search),void ZDUtils.hideLoadingMsg()):(ATTACHDIALOG.changeAllToNormalView(),G_OF_OBJ.selectedLeftPanel="search",void ATTACHDIALOG.getSearchResults(e,0))},ATTACHDIALOG.searchSorting=function(e,t){var s=ZD("#searchFileName").val();null==e&&(e="time"),null==t&&(t="desc"),ATTACHDIALOG.getSearchResults(s,0,e,t)},ATTACHDIALOG.getSearchResults=function(e,t,s,a){ZDUtils.LoadingMsg(zd_js_obj.loading),null==t&&(t=0),null==s&&(s="time"),null==a&&(a="desc");var i=ZD("#showopenservicefilespace").children();ZD(i).each(function(e,t){ZD(t).empty().remove()});var i=ZD("#showattachfilespace").children();ZD(i).each(function(e,t){ZD(t).empty().remove()});var o=G_OF_OBJ.docsURL+"/docs/viewsearchresults.do?method=attachFileSearch&start="+t+"&field="+s+"&action="+a+"&searchquery="+encodeURIComponent(e)+"&category="+G_OF_OBJ.urlInvoker+"&_t="+(new Date).getTime();ZD.ajax({url:o,xhrFields:{withCredentials:!0},datatype:"html",success:function(e){ZD("#showattachfilespace").html(e),ZD("#attachFileDataDiv strong").first().empty(),ZD("#attachFileDataDiv").css("height","302px"),ZDUtils.hideLoadingMsg(),ATTACHDIALOG.updateSelectedDocs()}})},ATTACHDIALOG.constructSearchResults=function(e,t){for(var s='<div id="attachFileDataDiv" class="zd_scroll" style="padding-bottom:5px;vertical-align:top;border:0px solid #000000;height:320px;"><table class="docs-tabledata" width="100%" cellpadding="0" cellspacing="0" border="0" align="center">',a=e.documentListContainer.length,i=e.documentListContainer,o=0;a>o;o++){var d=i[o],r=d.encAttrDocId,n=d.encAttrDocName,l=d.encDocName,c=d.encUrlDocName,_=d.encAttrService,p=d.encAttrAuthorId,h=d.encAttrFileType,D=d.enclastEdited,v=d.encAttrFileExtn,u=d.encAttrEncryptedIds,m=d.encAttrClassName,f=(d.isAuthor,d.isDocumentSharedToMe),O=d.indexType,g=(d.shareicon,d.sharetitle,d.encAuthorName);G_OF_OBJ.asLink===!0&&ATTACHDIALOG.getPermission(r),s+='<tr><td nowrap="nowrap"><div class="documentDataDiv docs-tablediv " id="'+r+'" fileName="'+n+'" data-fileName="'+n+'" data-encFileName="'+l+'" data-encUrlFileName="'+c+'"  data-serviceType="'+_+'" data-authorId="'+p+'" data-author="'+g+'" data-indexType="'+O+'" data-fileType="'+h+'" data-authorName="'+g+'" data-service ="'+_+'" data-fileExt="'+v+'"    data-encryptedId="'+u+'" isDocumentSharedToMe="'+f+'">',s+=ZD("#selectedfile_"+r).length?'<table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" class="data-hover zd_select"><tr><td colspan="4" nowrap="nowrap" width="100%"><table width="100%" cellpadding="0" border="0" class="docs-tablerow"><tr><td width="20" height="20" class="docscursor checkboxtd" elem="checkbox"><img src="'+G_OF_OBJ.spacerImagePath+'" class="selectcheckboxicon_css flleft"/></td><td nowrap="nowrap" width="20" elem="documenticon" ><div class="'+m+'"/></td><td nowrap="nowrap" align="left" elem="documenticon"><span title="'+n+'" class="docscursor">'+l+'</span></td><td width="50" nowrap="nowrap" align="center"><span>&nbsp;</span></td><td width="110" nowrap="nowrap"><span>&nbsp;'+g+'</span></td><td width="100" nowrap="nowrap"><span class="pad-lft">'+D+"</span></td></tr></table></td></tr></table></div>":'<table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" class="data-hover"><tr><td colspan="4" nowrap="nowrap" width="100%"><table width="100%" cellpadding="0" border="0" class="docs-tablerow"><tr><td width="20" height="20" class="docscursor checkboxtd" elem="checkbox"><img src="'+G_OF_OBJ.spacerImagePath+'" class="normalcheckboxicon_css flleft"/></td><td nowrap="nowrap" width="20" elem="documenticon" ><div class="'+m+'"/></td><td nowrap="nowrap" align="left" elem="documenticon"><span title="'+n+'" class="docscursor">'+l+'</span></td><td width="50" nowrap="nowrap" align="center"><span>&nbsp;</span></td><td width="110" nowrap="nowrap"><span>&nbsp;'+g+'</span></td><td width="100" nowrap="nowrap"><span class="pad-lft">'+D+"</span></td></tr></table></td></tr></table></div>"}s+="</td></tr></table></div>",t.append(s);var b=e.field,w=e.changeaction,L=e.timeclassname,G=e.action,I=e.searchquery,B=e.prevPage,C=e.nextPage,Z=e.prevButtonClass,y=e.nextButtonClass,x=e.start,F=e.end,J=e.totalCount;F>J&&(F=J),ZD("#servicefilepagination").html('<table cellpadding="0" cellspacing="0" border="0"><tr><td id=searchpagestatusid" class="pagecount">'+x+" - "+F+" "+zd_js_obj.of+" "+J+'</td><td><div id="searchprevbuttonid" >&nbsp;</div></td><td><div id="searchnextbuttonid" >&nbsp;</div></td></tr></table>'),ZD("#attachFileDataDiv").data({prevButtonClass:Z,nextButtonClass:y,start:x,end:F,totalCount:J,field:b,changeSortingAction:w,sortingClassNameOfTime:L,sortAction:G,searchquery:I,prevPage:B,nextPage:C,noOfResults:10}),ZD("#searchprevbuttonid").addClass(Z),ZD("#searchnextbuttonid").addClass(y),ZD("#servicefilepagination").show(),ZD("#attachFileHeader").delegate("td.searchauthorsort","mouseover mouseout",function(e){"mouseover"==e.type?ATTACHDIALOG.searchMouseOver("author",b,"searchauthorsortgif",w):ATTACHDIALOG.searchMouseOut("author",b,"searchauthorsortgif")}),ZD("#attachFileHeader").delegate("td.searchtimesort","mouseover mouseout",function(e){"mouseover"==e.type?ATTACHDIALOG.searchMouseOver("time",b,"searchtimesortgif",w):ATTACHDIALOG.searchMouseOut("time",b,"searchtimesortgif")}),ZD("#attachFileHeader").delegate("td.searchauthorsort","click",function(){ATTACHDIALOG.searchSorting("author",w)}),ZD("#attachFileHeader").delegate("td.searchtimesort","click",function(){ATTACHDIALOG.searchSorting("time",w)}),ZD("#ActionsPathDiv").undelegate(),ZD("#ActionsPathDiv").delegate("div#searchprevbuttonid","click",function(){ZD(this).hasClass("zd_prev")&&ATTACHDIALOG.getSearchResults(I,B,b,G)}),ZD("#ActionsPathDiv").delegate("div#searchnextbuttonid","click",function(){ZD(this).hasClass("zd_next")&&ATTACHDIALOG.getSearchResults(I,C,b,G)})},ATTACHDIALOG.updateSelectedDocs=function(){for(var e=ATTACHDIALOG.getSelectedDocs(),t=0,s=e.length;s>t;t++){var a=e[t].docId;ATTACHDIALOG.selectRow(a)}},ATTACHDIALOG.getPermission=function(e){ZD("#selectedfile_"+e).length&&(ZD("#"+e).find("td.checkboxtd").children().removeClass("normalcheckboxicon_css").addClass("selectcheckboxicon_css"),ZD("#"+e).children("table.data-hover").addClass("zd_select"));var t=G_OF_OBJ.docsURL+"/docs/docsrequest.do?method=getShareDetailsPermission",s="docId="+e+"&_t="+ZD.now();ZD.ajax({url:t,data:s,dataType:"text",type:"GET",success:function(e){return"success"===e.trim()?e.trim():void 0},error:function(){ZD("#"+e).addClass("opacityshare"),ZD("#"+e).find(".data-hover").hasClass("zd_select")&&ZD("#selectedfile_"+e).addClass("selectionblur")}})},ATTACHDIALOG.disableNonSharable=function(){ZD(".documentDataDiv").each(function(){G_OF_OBJ.asLink===!0?ATTACHDIALOG.getPermission(ZD(this).attr("id")):ZD(this).hasClass("opacityshare")&&(ZD(this).removeClass("opacityshare"),ZD(this).find(".data-hover").hasClass("zd_select")&&ZD("#selectedfile_"+ZD(this).attr("id")).removeClass("selectionblur"))})},ATTACHDIALOG.showStatusMsg=function(e){ZD("#msg_content").html(e),ZD("#status_msg").fadeIn(400),setTimeout(function(){ZD("#status_msg").fadeOut(400),ZD("#msg_content").html("")},4e3)},ATTACHDIALOG.setSharingTypeForSelectedUser=function(e,t){var s={};ZD("#sharefileaslinkcontainer").remove();var a='<div id="sharefileaslinkcontainer" style="display:none;"></div>';ZD("body").append(a),s.Share=function(){return ATTACHDIALOG.getAPIDetails(t,e),ZD("#sharefileaslinkcontainer").dialog("destroy").remove(),ZD("#sharefileaslinkcontainer").remove(),!1},s.Cancel=function(){return ZD("#sharefileaslinkcontainer").dialog("destroy").remove(),ZD("#sharefileaslinkcontainer").remove(),!1},ZDDialog.showCommonDialog("Share File",!0,"sharefileaslinkcontainer",s,"","550",!0,"auto",!1);var i='<div id="multi_visiblity_container"><p style="font-size: 15px;">Choose how you want the share the selected files:</p><ul id="visibilityoptions_top" class="zd_visiblity_list_container"><li class="zdl-menu zdl-brdtp" id="zd_private_visible" visible_type="private"><span class="zdl-icon"><span class="ui-icon zdc-specific"></span></span><span class="zdl-text">Recipients of this email </span><span class="zdl-shortcut">Recipients must have a Zoho account.</span><span class="ui-zmenu-item-placeholder"></span></li><li class="zdl-menu zd-everyone-org" id="zd_anyone_link_visible" visible_type="anyone_link"><span class="zdl-icon"><span class="ui-icon zdc-anyoneshare"></span></span><span class="zdl-text">'+orgLabel+'</span><span class="zdl-shortcut">Members within Organization who have the link can access.</span><span class="ui-zmenu-item-placeholder"></span></li><li class="zdl-menu zdl-brdtp" id="zd_nosignin_visible" visible_type="everyone_internet"><span class="zdl-icon"><span class="ui-icon zdc-anyoneinternet"></span></span><span class="zdl-text">Everone In Internet</span><span class="zdl-shortcut">Anyone who has the link can access. No sign-in required.</span><span class="ui-zmenu-item-placeholder"></span></li><li class="zdl-menu zdl-brdtp" id="zd_secure_share" visible_type="secureshare"><span class="zdl-icon"><span class="ui-icon zdc-specific"></span></span><span class="zdl-text">Share file(s) with password protection to external contacts.</span><span class="zdl-shortcut">Anyone who has the link and its password can access.</span><span class="ui-zmenu-item-placeholder"></span></li></ul></div>';return ZD("#sharefileaslinkcontainer").html(i),ATTACHDIALOG.bindEventHandlers(),ZD("#visibilityoptions_top").find("li:first").trigger("click"),!1},ATTACHDIALOG.getAPIDetails=function(e,t){for(var s="",a="",i="",o="",d="",r=ZD("#visibilityoptions_top").find("li.zdl-selection").attr("id"),n=ZD("#"+r).find(".zd-selectdiv-sib").attr("permission"),l=0;l<e.length;l++)d+=e[l].docId+",";if("zd_private_visible"===r)s=G_OF_OBJ.docsURL+"/api/v2/files/share",a=zdcsrfPair,a+="&type=private&resids="+d+"&emailids=&pergroupIds=&orggroupIds=&message=&notify=false&permission="+n+"&ischangepermission=false";else if("zd_anyone_link_visible"===r){var c=!1;s=G_OF_OBJ.docsURL+"/api/v2/files/share",c=!0,a="type=orgshare&resids="+d+"&permission="+n+"&updatepermission=false&alloweveryoneaccess="+c+"&"+zdcsrfPair}else"zd_nosignin_visible"===r?(s=G_OF_OBJ.docsURL+"/api/v2/files/share",i=ZD("#"+r).find("#zdpublic_datepicker").val(),a="type=linkshare&resids="+d+"&permission=1&expiry_date="+i.trim()+"&"+zdcsrfPair):"zd_secure_share"===r&&(s=G_OF_OBJ.docsURL+"/api/v2/files/share",i=ZD("#"+r).find("#zdsecureshare_datepicker").val(),o=ZD("#"+r).find("#zd-secureshare-pwd").val(),a="type=userpwdlink&sendpasswordinmail=false&resids="+d+"&permission="+n+"&expiry_date="+i.trim()+"&password="+o+"&isCommonLink=true&emailids=&"+zdcsrfPair);return t({apiurl:s,apiparams:a})},ATTACHDIALOG.bindEventHandlers=function(){ZD("#visibilityoptions_top").undelegate().delegate("li","click",function(e){var t=ZD(e.target),s=t.closest("li").attr("id");if(ZD("#visibilityoptions_top").find("li").removeClass("zdl-selection").css("height",""),ZD("#"+s).addClass("zdl-selection"),"zd_private_visible"===s){if(0===ZD("#"+s).find(".visibility_permission_container").length){var a='<div style="margin-top:18px;float: left;padding-left: 50px;" class="visibility_permission_container"><div id="zdperm_visibility_text" style="line-height:25px;float:left;">Set Permission:<select class="zd-private-select" style="display:none;border:1px solid #DADADA;background:#fff;padding:5px;outline:none;"><option permission="1">Read Only</option><option permission="2">Read/Write</option><option permission="3">Co-Owner</option></select></div></div>';ZD("#"+s).append(a)}ATTACHDIALOG.customizeSelectElement(ZD(".zd-private-select"))}else if("zd_anyone_link_visible"===s){if(0===ZD("#"+s).find(".visibility_permission_container").length){var i='<div style="margin-top: 10px;float: left;padding-left: 50px;" class="visibility_permission_container"><div id="zdperm_visibility_text" style="line-height:25px;float:left;">Whoever accesses can:<select class="zd-org_share" style="display:none;border:1px solid #DADADA;background:#fff;padding:5px;outline:none;"><option permission="1">Read Only</option><option permission="2">Read/Write</option></select></div></div>';ZD("#"+s).append(i)}ATTACHDIALOG.customizeSelectElement(ZD(".zd-org_share"))}else if("zd_nosignin_visible"===s){if(0===ZD("#"+s).find(".zd-everyone-internet").length){var o='<div class="zd-everyone-internet zdc-extwrd visibility_permission_container" style="margin-top:10px;float:left;padding-left: 50px;display:block;"><div style="margin-bottom:5px;"><span class="zdpublic_setexpirylabel"><input style="margin:0 5px 0 0;" type="checkbox" id="set_expir_date_public_web"><label for="set_expir_date_public_web"><span>Set expiry date</span></label></span><p style="display:none;" class="datepicker_public">Expires on :<input type="text" id="zdpublic_datepicker" readonly="true/"></p></div></div>';ZD("#"+s).append(o),ZD("#zdpublic_datepicker").datepicker({minDate:1}),ZD("#set_expir_date_public_web").click(function(){var e=ZD(this);e.is(":checked")?(ZD(".datepicker_public").css("display","block"),ZD("#zdpublic_datepicker").datepicker("show")):(ZD(".datepicker_public").css("display","none"),ZD("#zdpublic_datepicker").datepicker("hide"))})}}else if("zd_secure_share"===s){if(0===ZD("#"+s).find(".zd-secureshare-container").length){var d='<div class="zd-secureshare-container visibility_permission_container" style="margin-top:10px;float:left;padding-left: 50px;display:block;"><div id="zdperm_visibility_text" style="line-height:25px;float:left;">Set Permission:<select class="zd-secure-share-selectelem" style="display:none;border:1px solid #DADADA;background:#fff;padding:5px;outline:none;"><option permission="1">Read Only</option><option permission="2">Read/Write</option></select></div><div style="float:left;margin-bottom:10px;" class="zd-setpassword-container"><span>Set Password:</span><input id="zd-secureshare-pwd" style="outline:none;width:200px;height: 18px;margin-left: 9px;" type="password" value=""></input></div><div style="float:left;margin: 0px 0px 10px 30px;" id="zd-send-password-email"><input id="zd-ecs-sendpass" type="checkbox" name="check" value="" class="zd-checkbox"><label for="zd-ecs-sendpass" class="zd-checkbox-clone"> Send password through email </label></div><div style="float:left;width:100%;margin-left:30px;"><div><span class="zdsecureshare_setexpirylabel"><input style="margin:0 5px 0 0;" type="checkbox" id="set_expiry_date_secureshare"><label for="set_expiry_date_secureshare"><span>Set expiry date</span></label></span><p style="display:none;" class="zd-securesharedatepicker_container">Expires on :<input type="text" id="zdsecureshare_datepicker" readonly="true/"></p></div></div></div>';ZD("#"+s).append(d),ZD("#zdsecureshare_datepicker").datepicker({minDate:1}),ZD("#set_expiry_date_secureshare").click(function(){var e=ZD(this);e.is(":checked")?(ZD(".zd-securesharedatepicker_container").css("display","block"),ZD("#zdsecureshare_datepicker").datepicker("show")):(ZD(".zd-securesharedatepicker_container").css("display","none"),ZD("#zdsecureshare_datepicker").datepicker("hide"))})}ATTACHDIALOG.customizeSelectElement(ZD(".zd-secure-share-selectelem"))}var r=ZD(".zd_visiblity_list_container").find(".visibility_permission_container");r.css("display","none"),ZD("#"+s).find(".visibility_permission_container").css("display","block")})},ATTACHDIALOG.customizeSelectElement=function(e){e.each(function(){var t=ZD(this),s=ZD(this).children("option").length,a=e.closest("li");ZD(".zd-selectsib-ulcontainer").remove();var i="";if(0===t.closest(".zd-select-wrap").length){t.wrap('<div class="zd-select-wrap"></div>');var o=a.find(".zd-select-wrap");o.append('<div class="zd-selectdiv-sib"></div>'),a.find("div.zd-selectdiv-sib").attr("permission",1).text(t.children("option").eq(0).text())}i=a.find("div.zd-selectdiv-sib");for(var d=ZD("<ul />",{"class":"zd-selectsib-ulcontainer"}).appendTo("body"),r=0;s>r;r++)ZD("<li />",{text:t.children("option").eq(r).text(),permission:t.children("option").eq(r).attr("permission"),rel:t.children("option").eq(r).val()}).appendTo(d);var n=d.children("li");i.click(function(e){var t=(a.find(".zd-selectdiv-sib").offset(),i.offset());e.stopPropagation(),d.css({position:"absolute",top:t.top+23,left:t.left,"z-index":1e7}),ZD("div.zd-selectdiv-sib.active").each(function(){ZD(this).removeClass("active"),ZD("ul.zd-selectsib-ulcontainer").hide()}),ZD(this).toggleClass("active"),ZD("ul.zd-selectsib-ulcontainer").toggle()}),n.click(function(e){e.stopPropagation(),i.text(ZD(this).text()).removeClass("active"),i.attr("permission",ZD(this).attr("permission")),d.hide()}),ZD(document).click(function(){i.removeClass("active"),d.hide()})})},function(e){e.widget("ui.attachfiledialog",{options:{recentDocs:{show:!0,name:"recentDocs",id:"recentservicedocs",action:"getDocumentsByType",iconClass:"recentdocs-icon",title:"recentDocs"},desktopDocs:{show:!0,name:"My Folders",id:"desktopservicedocs",action:"getDocumentsForFolder",fid:"folder",iconClass:"zdc-foldericon_css",title:"My Folders"},myDocs:{show:!0,name:"My Docs",id:"mydocs",action:"getDocumentsByType",fid:"folder",iconClass:"mydocs_icon",title:"My Docs"},mySheets:{show:!0,name:"My Sheets",id:"mysheets",action:"getDocumentsByType",fid:"folder",iconClass:"myspreadsheet_icon",title:"My Sheets"},myPresentations:{show:!0,name:"My Presentations",id:"mypresentations",action:"getDocumentsByType",fid:"folder",iconClass:"mypresentation_icon",title:"My Presentations"},myPictures:{show:!0,name:"My Pictures",id:"mypictures",action:"getDocumentsByType",fid:"folder",iconClass:"mypic_icon",title:"My Pictures"},sharedDocs:{show:!0,name:"Shared Docs",id:"sharedservicedocs",action:"getShareddocs",iconClass:"shareTome",title:"Shared Docs"},workspace:{show:!0,name:"Workspaces",id:"workspacelist",action:"getWorkspaces",iconClass:"zdc-ws",title:"Workspaces"},trashedDocs:{show:!0,name:"Trash",id:"trashservicedocs",action:"getTrashedDocuments",iconClass:"trash-icon",fid:"trash"},actionsButton:{showAction:!1,action:!0,id:"actionMenuOpenFile",iconClass:"action-css",value:"Actions"},homeButton:!0,upOneLevel:!1,selectedView:"recentservicedocs",lookIn:!1,advSearchBox:!1},_create:function(){this._constructFileDialog(),this._constructLeftPanel(),this._constructRightPanel(),this._initDelegate();var t=G_OF_OBJ.attachObj.height-220;e("#showattachfilespace").css({height:t})},_constructFileDialog:function(){this.mainPanel=e('<div id="mainPanelforservicefiles" style="overflow:hidden;width:100%;margin: 12px 0px;">'),this.leftPanel=e('<div class="ui-left-panel flleft" style="width:145px;" >'),this.rightPanel=e('<div class="ui-rht-datadiv">'),this.selectedFilesRow=e('<div id="showSelectedBoxDiv" class="showdiv" style="margin-bottom:2px;"><table cellpadding="0" width="100%"  cellspacing="0"><tr><td width="107" align="center" class="selectfiles"><strong>'+zd_js_obj.selected_files_list+'</strong></td><td><div id="selectboxdiv" class="selectblock zd_scroll"></div></td></tr></table></div>'),this.element.append(this.mainPanel),this.mainPanel.append(this.leftPanel),this.mainPanel.append(this.rightPanel),this.mainPanel.append(this.selectedFilesRow)},_constructLeftPanel:function(){var t=e('<table id="serviceDialogLeftPanel" width="100%"  cellpadding="0" cellspacing="0" align="center" class="mailLeftPanel"></table>');if(this.options.advSearchBox){var s='<tr><td><div id="attachfilesearchdiv" style="padding-bottom:0px;margin-top:0px;"><div class="searchdiv ui-corner-all docscursor flright"><input type="submit" class="searchIcon flleft docscursor smallText" value=""><input type="text" id="searchFileName" class="searchtext flleft" value=""><input type="hidden" value="search_all_search" name="'+zd_js_obj.label_search_all+'" id="search_type_attachfile" class=""></div><div style="height:15px;border-bottom:1px solid #efefef;margin-bottom:13px;clear:both;"></div></div></td></tr>';e(t).append(s)}else e(t).append('<tr><td><div class="ui-left-heading">'+zd_js_obj.label_favorites+"</div></td></tr>");for(var a in this.options){var i=this.options[a];i&&i.show&&e(t).append('<tr><td  class="normalView docscursor" id="'+i.id+'" action="'+i.action+'" ><span class="'+i.iconClass+' flleft margright"></span><span class="flleft" style="line-height:15px;white-space:nowrap;overflow:hidden;" title="'+i.title+'" alt="'+i.title+'">'+i.name+"</span></td></tr>")}this.leftPanel.append(t),e("#"+this.options.selectedView).removeClass("normalView").addClass("selectedView")},_constructRightPanel:function(){this.rightPaneltopContainer=e("<div>"),this.rightPanel.append(this.rightPaneltopContainer),this._constructActionsRow(),this._constructStatusMessageRow(),this.rightPanelDataContainer=e('<div id="showattachfilespace" style="background:#fff;margin: 0px 0px 0px 12px;"></div>'),this.rightPanel.append(this.rightPanelDataContainer)},_constructActionsRow:function(){var e='<div id="ActionsPathDiv" class="toolbar-menu" style="padding: 0px 0px 12px 0px; height: 21px;"><table width="100%" cellpadding="0" cellspacing="0" border="0" align="center"><tr><td>';this.options.homeButton&&(e+='<span title="'+zd_js_obj.docs_home+'" class="sort-menu lightbluetxt flleft margright " id="homeButton"><span class="home flleft docscursor"></span></span>'),this.options.upOneLevel&&(e+='<span title="'+zd_js_obj.up_one_level+'" class="sort-menu lightbluetxt flleft margright non-hover" id="moveUpFolder"><span class="back-folder-inactive flleft"></span></span>'),this.options.lookIn&&(e+='<span class="flright boldText" style="padding-top:5px;color:#676565;">View</span>'),e+='</td><td align="right"><div id="servicefilepagination"  style="float:right; z-index:1000;padding-right:2px;display:none;"></div></td>',e+='<td><div id="openloadingmsg"></div></td></tr></table></div>',this.rightPaneltopContainer.append(e)},_constructStatusMessageRow:function(){this.rightPaneltopContainer.append('<div class="hidediv attach_message" style="display:none;"><span id="zd_statusmsgdiv"></span></div>')},_initDelegate:function(){G_OF_OBJ.SCR_WTH=ZDUtils.getWidth(),G_OF_OBJ.SCR_HT=ZDUtils.getHeight(),e("#serviceDialogLeftPanel").delegate("td.docscursor","click",function(){G_OF_OBJ.folderpermission="",G_OF_OBJ.searchenabled=!1,ATTACHDIALOG.getDocAsList(this)}),e("#showattachfilespace").delegate("div.folderDataDiv","click",function(t){var s=e(t.target);if("renameinputform"==s.attr("id"))return!1;ATTACHDIALOG.reset();var a=e(this).attr("folderId");void 0==a&&(a=-1),void 0!==e(this).attr("permission")&&(G_OF_OBJ.folderpermission=e(this).attr("permission"));var i=e(this).attr("pntFolderId"),o=e(this).attr("wsid");e("#servicefilepagination").show(),e("#showattachfilespace").css("display","block"),G_OF_OBJ.parentFolderId=i,G_OF_OBJ.folderId=a,G_OF_OBJ.wsId=o,ATTACHDIALOG.getDocAsList()}),e("#showattachfilespace").delegate("table.data-hover","click",function(t){var s=e(t.target);(s.hasClass("selectcheckboxicon_css")||s.hasClass("normalcheckboxicon_css")||s.is("td")||s.is("span"))&&ATTACHDIALOG.showSelectedDocsToAttach(this)}),e("div#selectboxdiv").delegate("span.closeBtn_css","click",function(){var t=e(this).parent().attr("docId");ATTACHDIALOG.deselectRow(t)}),e("div#servicefilepagination").delegate("div#prevbuttonid,div#nextbuttonid","click",function(){var t=e(this).attr("id");"prevbuttonid"==t?action="previousPage":"nextbuttonid"==t&&(action="nextPage"),e("#showattachfilespace").attachfiledatagrid(action)}),e("#showattachfilespace").delegate("td#nameHeader,td#dateModifiedHeader","click",function(){(e(this).find("img#_sortname").length||e(this).find("img#_sortdate").length)&&(e("div#servicefilepagination").hide(),ATTACHDIALOG.setSortOrder(this),ATTACHDIALOG.resetAll(),e("#desktopservicedocs").hasClass("selectedView")?G_OF_OBJ.folderId="0"==G_OF_OBJ.parentFolderId||"1"==G_OF_OBJ.parentFolderId?"folder":G_OF_OBJ.parentFolderId:e("#workspacelist").hasClass("selectedView")&&(G_OF_OBJ.folderId="0"==G_OF_OBJ.parentFolderId||"1"==G_OF_OBJ.parentFolderId?"folder":G_OF_OBJ.parentFolderId),ATTACHDIALOG.getSortDocAsList("",G_OF_OBJ.selectedLeftPanel),ATTACHDIALOG.setClassAfterSorting(this))}),e("#homeButton").bind("click",function(){G_OF_OBJ.folderpermission="",G_OF_OBJ.searchenabled=!1;var e="";ATTACHDIALOG.getDocAsList(e,"recentservicedocs")}),e("div#attachfilesearchdiv").delegate("input#searchFileName","focusin focusout keypress",function(t){if("focusin"==t.type)e("input#searchFileName").val(""),e("input#search_type_attachfile").addClass("searchquery");else if("focusout"==t.type)""==e("input#searchFileName").val()&&(e("input#searchFileName").val(e("input#search_type_attachfile").attr("name")),e("input#search_type_attachfile").removeClass("searchquery"));else if("keypress"==t.type&&"13"==t.keyCode){G_OF_OBJ.searchenabled=!0,G_OF_OBJ.folderpermission="";var s=e("input#searchFileName").val();ATTACHDIALOG.searchFile(s)}}),e("div#attachfilesearchdiv").delegate("input.searchIcon","click",function(){var t=e("input#searchFileName").val(),s=e("input#search_type_attachfile").attr("class");return""==t||null==t||"searchquery"!=s?(ATTACHDIALOG.statusmsg("failure_status boldText","Enter valid text to search"),void e("input#searchFileName").val(e("input#search_type_attachfile").attr("name"))):(G_OF_OBJ.folderpermission="",G_OF_OBj.searchenabled=!0,void ATTACHDIALOG.searchFile(t))}),e("#moveUpFolder").delegate(".back-folder","click",function(){G_OF_OBJ.folderpermission="",e("#desktopservicedocs").hasClass("selectedView")?(ATTACHDIALOG.changeAllToNormalView("desktopservicedocs"),G_OF_OBJ.moveUpFolder=!0,G_OF_OBJ.folderId="0"==G_OF_OBJ.parentFolderId||"1"==G_OF_OBJ.parentFolderId?"folder":G_OF_OBJ.parentFolderId,ATTACHDIALOG.getDocAsList()):e("#sharedservicedocs").hasClass("selectedView")?(ATTACHDIALOG.changeAllToNormalView("sharedservicedocs"),G_OF_OBJ.moveUpFolder=!0,G_OF_OBJ.folderId="0"===G_OF_OBJ.parentFolderId||"1"===G_OF_OBJ.parentFolderId?"folder":G_OF_OBJ.parentFolderId,ATTACHDIALOG.getDocAsList()):e("#workspacelist").hasClass("selectedView")&&(ATTACHDIALOG.changeAllToNormalView("workspacelist"),G_OF_OBJ.moveUpFolder=!0,G_OF_OBJ.parentFolderId==G_OF_OBJ.wsId||"-1"==G_OF_OBJ.parentFolderId?(G_OF_OBJ.folderId="wshome",G_OF_OBJ.wsId="wshome"):G_OF_OBJ.folderId=G_OF_OBJ.parentFolderId,ATTACHDIALOG.getDocAsList())})},destroy:function(){e.Widget.prototype.destroy.apply(this,arguments),this.element.unbind("."+this.widgetName);var t=this.element,s=e(t).children();e(s).each(function(t,s){e(s).undelegate(),e(s).empty().remove()})}}),e.extend(e.ui.filedialog,{version:"1.8"})}(jQuery),function(e){e.widget("ui.attachfiledatagrid",{defaults:{documentNameHeader:!0,lastModifiedTimeHeader:!0,checkboxIconSpace:!0,checkboxIcon:"normalcheckboxicon_css flleft",hoverclass:"data-hover",documentIcon:!0,documentName:!0,authorName:!1,lastModifiedTime:!0},_create:function(){this.options=e.extend({},this.defaults,this.options),this._constructHeader(),this.sendAjaxRequest(),this.resize()},resetOptions:function(){this.options.documentNameHeader=!0,this.options.lastModifiedTimeHeader=!0,this.options.documentIcon=!0,this.options.documentName=!0,this.options.authorName=!1,this.options.lastModifiedTime=!0},populateDataPanel:function(t){this.options=e.extend(this.options,this.defaults);for(var s in t)this.options[s]=t[s];this.clearData(),this._constructHeader(),this.sendAjaxRequest(),this.resize(),G_OF_OBJ.bottomLevelFetch=50},clearData:function(){var t=this.element,s=e(t).children();e(s).each(function(t,s){e(s).empty().remove()})},_constructHeader:function(){var e='<div id="docsHeaderTab"><table  id="table1" width="100%" cellpadding="0" cellspacing="0" border="0" class="docs-tableheader" align="center"><tr>';this.options.documentNameHeader&&(e+='<td width="20">&nbsp;</td><td id="nameHeader" height="23" nowrap="nowrap" align="left" class="docscursor sortfield namesortTd pad-lft" sortfield="name">'+zd_js_obj.name+'<img id="_sortname" src="'+G_OF_OBJ.spacerImagePath+'" class="" style="margin-left:2px;"></td>'),this.options.authorName&&(e+='<td width="20">&nbsp;</td><td id="authorHeader" width="110" nowrap="nowrap" align="left" class="docscursor sortfield authorsortTd pad-lft" sortfield="author"><span class="zd_divider">|</span>'+zd_js_obj.author+"</td>"),this.options.lastModifiedTimeHeader&&(e+='<td id="dateModifiedHeader" width="130" nowrap="nowrap" class="docscursor sortfield datesortTd" sortfield="date"><span class="zd_divider">|</span>'+zd_js_obj.date_modified+'<img id="_sortdate" src="'+G_OF_OBJ.spacerImagePath+'" style="margin-left: 2px;" class="DownArrow"></td>'),e+='</tr></table></div><div id="attachFileDataDiv" style="overflow:auto;vertical-align:top;border:0px solid #000000;">',this.element.append(e)},sendAjaxRequest:function(){ATTACHDIALOG.LoadingMsg(zd_js_obj.loading);var t=this._constructURLParameters();e.ajax({url:t,xhrFields:{withCredentials:!0},type:"GET",dataType:"json",success:function(t,s){return"success"==s?(G_OF_OBJ.jsonData=t,e("div#showattachfilespace").attachfiledatagrid("constructDocumentRows"),ATTACHDIALOG.hideLoadingMsg(),ATTACHDIALOG.updateSelectedDocs(),(e("#recentservicedocs").hasClass("selectedView")||e("#workspacelist").hasClass("selectedView")&&"wshome"==G_OF_OBJ.wsId)&&(e("td#dateModifiedHeader").find("img").remove(),e("td#nameHeader").find("img").remove()),G_OF_OBJ.moveUpFolder=!1,!1):void 0}})},_constructURLParameters:function(){var t="",s="",a=e("#serviceDialogLeftPanel").find("td.selectedView").attr("id");return"workspacelist"!=a?(t="method="+e("#"+a).attr("action")+"&fromIndex="+G_OF_OBJ.startFrom+"&noOfDocuments="+G_OF_OBJ.fetchLimit,e("#moveUpFolder").removeClass("hover").addClass("non-hover").children().removeClass("back-folder cursor").addClass("back-folder-inactive flleft"),"recentservicedocs"!=a&&(t+="&sortorder="+G_OF_OBJ.sortOrder+"&orderby="+G_OF_OBJ.orderBy),"desktopservicedocs"==a&&(t+="&fid="+G_OF_OBJ.folderId,"folder"!=G_OF_OBJ.folderId&&e("#moveUpFolder").toggleClass("non-hover hover").children().toggleClass("back-folder-inactive back-folder docscursor")),"sharedservicedocs"===a&&("folder"===G_OF_OBJ.folderId&&(G_OF_OBJ.folderId="-1"),t+="&folderid="+G_OF_OBJ.folderId,"folder"!==G_OF_OBJ.folderId&&e("#moveUpFolder").toggleClass("non-hover hover").children().toggleClass("back-folder-inactive back-folder docscursor")),"trashservicedocs"==a&&(t+="&fid=trash"),G_OF_OBJ.moveUpFolder&&"folder"!=G_OF_OBJ.folderId&&(t+="&isParentFolderDocs=true"),"recentservicedocs"==a?t+="&type=myrecentdocs":"mydocs"==a?t+="&type=mydocs":"mypresentations"==a?t+="&type=mypresentations":"mysheets"==a?t+="&type=myspreadsheets":"mypictures"==a&&(t+="&type=mypictures")):(e("#moveUpFolder").removeClass("hover").addClass("non-hover").children().removeClass("back-folder cursor").addClass("back-folder-inactive flleft"),t="method="+e("#"+a).attr("action"),"wshome"!=G_OF_OBJ.folderId&&(t+="&fromIndex="+G_OF_OBJ.startFrom+"&noOfDocuments="+G_OF_OBJ.fetchLimit,t+="&sortorder="+G_OF_OBJ.sortOrder+"&orderby="+G_OF_OBJ.orderBy,t+="&fid="+G_OF_OBJ.folderId,t+="&wsid="+G_OF_OBJ.wsId,t+="&type=getwsdocs",G_OF_OBJ.moveUpFolder&&"wshome"!=G_OF_OBJ.folderId&&(t+="&isParentFolderDocs=true")),"wshome"!=G_OF_OBJ.folderId&&e("#moveUpFolder").toggleClass("non-hover hover").children().toggleClass("back-folder-inactive back-folder docscursor")),t+="&_t="+(new Date).getTime(),s=G_OF_OBJ.docsURL+"/docs/attachfilerequest.do?"+t},constructDocumentRows:function(){var t="";this.containerDiv=e("div#attachFileDataDiv"),Math.abs(G_OF_OBJ.prevIndex)>1?this.containerDiv.empty():(this.containerDiv.empty(),this.containerDiv.find(".documentDataDiv").remove());var s=e("#serviceDialogLeftPanel").find("td.selectedView").attr("id");if("desktopservicedocs"===s||"sharedservicedocs"===s){if(0==G_OF_OBJ.jsonData.FOLDER.length&&0==G_OF_OBJ.jsonData.DOC.length)return this.noDocuments=e("div#attachFileDataDiv"),G_OF_OBJ.parentFolderId=G_OF_OBJ.folderId,t+='<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="docs-tabledata"><tr><td colspan="5" nowrap><BR><div align="center">'+zd_js_obj.label_no_items_are_present+"</div></td></tr></table>",e("td#dateModifiedHeader").find("img").remove(),e("td#nameHeader").find("img").remove(),void this.noDocuments.append(t)}else if("workspacelist"==s){if(void 0!=G_OF_OBJ.jsonData.WORKSPACE&&0==G_OF_OBJ.jsonData.WORKSPACE.length)return this.noDocuments=e("div#attachFileDataDiv"),G_OF_OBJ.parentFolderId=G_OF_OBJ.folderId,t+='<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="docs-tabledata"><tr><td colspan="5" nowrap><BR><div align="center">'+zd_js_obj.no_workspace+"</div></td></tr></table>",void this.noDocuments.append(t);if(void 0!=G_OF_OBJ.jsonData.DOC&&0==G_OF_OBJ.jsonData.DOC.length&&void 0!=G_OF_OBJ.jsonData.FOLDER&&0==G_OF_OBJ.jsonData.FOLDER.length)return this.noDocuments=e("div#attachFileDataDiv"),G_OF_OBJ.parentFolderId=G_OF_OBJ.folderId,t+='<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="docs-tabledata"><tr><td colspan="5" nowrap><BR><div align="center">'+zd_js_obj.dashboard_msg_no_documents+"</div></td></tr></table>",e("td#dateModifiedHeader").find("img").remove(),e("td#nameHeader").find("img").remove(),void this.noDocuments.append(t)}else if(0==G_OF_OBJ.jsonData.DOC.length)return this.noDocuments=e("div#attachFileDataDiv"),t+='<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="docs-tabledata"><tr><td colspan="5" nowrap><BR><div align="center">'+zd_js_obj.dashboard_msg_no_documents+"</div></td></tr></table>",e("td#dateModifiedHeader").find("img").remove(),e("td#nameHeader").find("img").remove(),void this.noDocuments.append(t);void 0!==G_OF_OBJ.jsonData.FOLDER&&G_OF_OBJ.jsonData.FOLDER.length>0&&1===Math.abs(G_OF_OBJ.prevIndex)&&("desktopservicedocs"===s||"workspacelist"===s||"sharedservicedocs"===s)?this._constructFolderInfoRows():G_OF_OBJ.parentFolderId=G_OF_OBJ.folderId,void 0!=G_OF_OBJ.jsonData.WORKSPACE&&G_OF_OBJ.jsonData.WORKSPACE.length>0&&1==Math.abs(G_OF_OBJ.prevIndex)&&"workspacelist"==s&&this._constructWSInfoRows(),void 0!=G_OF_OBJ.jsonData.DOC&&G_OF_OBJ.jsonData.DOC.length>0&&(G_OF_OBJ.totalFiles=e("#recentservicedocs").hasClass("selectedView")?G_OF_OBJ.jsonData.DOC.length:G_OF_OBJ.jsonData.TOTALDOCS[0].NOOFDOCS,this._constructPaginationData(),this._constructDocInfoRows()),"folder"==G_OF_OBJ.folderId&&e("#moveUpFolder").removeClass("hover").addClass("non-hover").children().removeClass("back-folder cursor").addClass("back-folder-inactive flleft")},_constructDocInfoRows:function(){var t="";t=G_OF_OBJ.endIndex>G_OF_OBJ.jsonData.DOC.length?G_OF_OBJ.jsonData.DOC.length:G_OF_OBJ.endIndex,this.containerDiv=e("div#attachFileDataDiv"),Math.abs(G_OF_OBJ.prevIndex)>1?this.containerDiv.empty():this.containerDiv.find(".documentDataDiv").remove();for(var s=(e("div.selectbox","div#selectboxdiv"),G_OF_OBJ.fromIndex);t>s;s++){var a=this.options.checkboxIcon,i=ATTACHDIALOG.checkSelectedFiles(G_OF_OBJ.jsonData.DOC[s].DOCID);i&&(a="flleft selectcheckboxicon_css");var o=e("<div>").addClass("documentDataDiv").attr({id:G_OF_OBJ.jsonData.DOC[s].DOCID,fileName:G_OF_OBJ.jsonData.DOC[s].DOCNAME,serviceType:G_OF_OBJ.jsonData.DOC[s].SERVICE_TYPE,isDocumentSharedToMe:!1}).data({serviceType:G_OF_OBJ.jsonData.DOC[s].SERVICE_TYPE,cssName:G_OF_OBJ.jsonData.DOC[s].CLASSNAME,encAttrFileName:G_OF_OBJ.jsonData.DOC[s].ENCATTR_DOCNAME,fileName:G_OF_OBJ.jsonData.DOC[s].DOCNAME,isDocumentSharedToMe:!1,isTemplates:!1,permission:G_OF_OBJ.jsonData.DOC[s].PERMISSION,scope:G_OF_OBJ.jsonData.DOC[s].SCOPE}),d=e('<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="'+this.options.hoverclass+'">'),r=e("<tr>"),n=e('<td colspan="4" nowrap="nowrap" width="100%">'),l=G_OF_OBJ.jsonData.DOC[s].ENCATTR_DOCNAME,c=G_OF_OBJ.jsonData.DOC[s].ENC_DOCNAME;c=ZDUtils.substringName(c,"40");var _='<table width="100%" border="0" cellpadding="0" class="docs-tablerow"><tr>';this.options.checkboxIconSpace&&(_+='<td width="20" height="20" nowrap="nowrap" class="docscursor checkboxtd" elem="checkbox" ><img src="'+G_OF_OBJ.spacerImagePath+'" class="'+a+'"/></td>'),this.options.documentIcon&&(_+='<td width="20" nowrap="nowrap" elem="documenticon"><div class="'+G_OF_OBJ.jsonData.DOC[s].CLASSNAME+' flleft docscursor"></div></td>'),this.options.documentName&&(_+='<td nowrap="nowrap" align="left" elem="documentname">&nbsp;<span id="fileNameSpan_'+G_OF_OBJ.jsonData.DOC[s].DOCID+'" docId="'+G_OF_OBJ.jsonData.DOC[s].DOCID+'" service="'+G_OF_OBJ.jsonData.DOC[s].SERVICE_TYPE+'" docName="'+l+'" title="'+l+'" class="docscursor">'+c+"</span></td>"),this.options.authorName&&(_+='<td width="110" class="zdtext-truncate" title="'+G_OF_OBJ.jsonData.DOC[s].ENCATTR_AUTHOR_NAME+'" nowrap="nowrap" align="left" elem="authorname">&nbsp;<a><span style="padding-left:10px;">'+G_OF_OBJ.jsonData.DOC[s].ENCATTR_AUTHOR_NAME+"</span></a></td>"),this.options.lastModifiedTime&&(_+='<td width="100" nowrap="nowrap" align="left" elem="lastmodifiedtime">&nbsp;<a><span style="padding-left:10px;">'+G_OF_OBJ.jsonData.DOC[s].LAST_MODIFIEDTIME+"</span></a></td>"),_+="</tr></table>",n.append(_),r.append(n),d.append(r),o.append(d),this.containerDiv.append(o),1===G_OF_OBJ.jsonData.DOC[s].SCOPE&&3!==G_OF_OBJ.jsonData.DOC[s].PERMISSION&&(G_OF_OBJ.jsonData.DOC[s].PERMISSION=""!==G_OF_OBJ.folderpermission?Number(G_OF_OBJ.folderpermission):2),G_OF_OBJ.asLink===!0&&void 0!==G_OF_OBJ.jsonData.DOC[s].PERMISSION&&3!==G_OF_OBJ.jsonData.DOC[s].PERMISSION&&0!==G_OF_OBJ.jsonData.DOC[s].PERMISSION&&(e("#"+G_OF_OBJ.jsonData.DOC[s].DOCID).addClass("opacityshare"),e("#selectedfile_"+G_OF_OBJ.jsonData.DOC[s].DOCID).addClass("selectionblur"))}},_constructFolderInfoRows:function(){for(var t=e("#serviceDialogLeftPanel").find("td.selectedView").attr("id"),s=0,a=G_OF_OBJ.jsonData.FOLDER.length;a>s;s++){"desktopservicedocs"==t?(G_OF_OBJ.parentFolderId!=G_OF_OBJ.jsonData.FOLDER[s].PARENTFOLDERID&&(G_OF_OBJ.parentFolderId=G_OF_OBJ.jsonData.FOLDER[s].PARENTFOLDERID),("1"==G_OF_OBJ.parentFolderId||"0"==G_OF_OBJ.parentFolderId)&&(G_OF_OBJ.folderId="folder")):"sharedservicedocs"===t?(G_OF_OBJ.parentFolderId!==G_OF_OBJ.jsonData.FOLDER[s].PARENTFOLDERID&&(G_OF_OBJ.parentFolderId=G_OF_OBJ.jsonData.FOLDER[s].PARENTFOLDERID),("1"===G_OF_OBJ.parentFolderId||"0"===G_OF_OBJ.parentFolderId)&&(G_OF_OBJ.folderId="folder")):"workspacelist"==t&&(G_OF_OBJ.parentFolderId!=G_OF_OBJ.jsonData.FOLDER[s].PARENTFOLDERID&&(G_OF_OBJ.parentFolderId=G_OF_OBJ.jsonData.FOLDER[s].PARENTFOLDERID),("1"==G_OF_OBJ.parentFolderId||"0"==G_OF_OBJ.parentFolderId)&&(G_OF_OBJ.folderId="folder")),this.folderDataDiv=e("div#attachFileDataDiv");var i=e("<div>").addClass("folderDataDiv").attr({id:G_OF_OBJ.jsonData.FOLDER[s].FOLDERID,permission:G_OF_OBJ.jsonData.FOLDER[s].PERMISSION,folderId:G_OF_OBJ.jsonData.FOLDER[s].FOLDERID,pntFolderId:G_OF_OBJ.jsonData.FOLDER[s].PARENTFOLDERID,wsid:G_OF_OBJ.jsonData.FOLDER[s].WORKSPACEID}).data({folderName:G_OF_OBJ.jsonData.FOLDER[s].ENCATTR_FOLDERNAME}),o=e('<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="folderDiv">'),d=e("<tr>"),r=e("<td>"),n=ZDUtils.substringName(G_OF_OBJ.jsonData.FOLDER[s].ENCATTR_FOLDERNAME,"40"),l='<table width="100%" border="0" cellpadding="0" class="docs-tablerow"><tr>';this.options.checkboxIconSpace&&(l+='<td width="20" height="20" nowrap="nowrap" class="checkboxtd" elem="checkbox" ><img src="'+G_OF_OBJ.spacerImagePath+'" class="'+this.options.checkboxIcon+'" style="opacity:0.3;"/></td>'),this.options.documentIcon&&(l+='<td style="width:20px;" nowrap="nowrap"><div class="zdc-foldericon_css">&nbsp;</div></td>'),this.options.documentName&&(l+='<td style="width:100%" class="docscursor" nowrap="nowrap" align="left" title="'+G_OF_OBJ.jsonData.FOLDER[s].ENCATTR_FOLDERNAME+'"><a style="padding-left:6px;">'+n+"</a></td>"),this.options.authorName&&(l+='<td width="110" class="zdtext-truncate" title="'+G_OF_OBJ.jsonData.FOLDER[s].ENCATTR_AUTHOR_NAME+'" nowrap="nowrap" align="left" elem="authorname">&nbsp;<a><span style="padding-left:10px;">'+G_OF_OBJ.jsonData.FOLDER[s].ENCATTR_AUTHOR_NAME+'</span></a></td><td width="100" nowrap="nowrap" ></td>'),l+="</tr></table>",r.append(l),d.append(r),o.append(d),i.append(o),this.folderDataDiv.append(i)}},_constructWSInfoRows:function(){for(var t=0,s=G_OF_OBJ.jsonData.WORKSPACE.length;s>t;t++){this.wsDataDiv=e("div#attachFileDataDiv");var a=e("<div>").addClass("folderDataDiv").attr({id:G_OF_OBJ.jsonData.WORKSPAwswsID,wsid:G_OF_OBJ.jsonData.WORKSPACE[t].wsID,pntFolderId:G_OF_OBJ.jsonData.WORKSPACE[t].PARENTFOLDERID}).data({wsName:G_OF_OBJ.jsonData.WORKSPACE[t].wsName}),i=e('<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="workspaceDiv">'),o=e("<tr>"),d=e("<td>"),r=ZDUtils.substringName(G_OF_OBJ.jsonData.WORKSPACE[t].wsName,"40"),n='<table width="100%" border="0" cellpadding="0" class="docs-tablerow"><tr>';this.options.checkboxIconSpace&&(n+='<td style="width:20px" height="20"></td>'),this.options.documentIcon&&(n+="userws"==G_OF_OBJ.jsonData.WORKSPACE[t].type?'<td style="width:20px;" nowrap="nowrap"><div class="zdc-ws">&nbsp;</div></td>':'<td style="width:20px;" nowrap="nowrap"><div class="zdc-sharedws">&nbsp;</div></td>'),this.options.documentName&&(n+='<td style="width:100%" class="docscursor" nowrap="nowrap" align="left" title="'+G_OF_OBJ.jsonData.WORKSPACE[t].wsName+'"><a style="padding-left:6px;">'+r+"</a></td>"),n+="</tr></table>",d.append(n),o.append(d),i.append(o),a.append(i),this.wsDataDiv.append(a)}},_constructPaginationData:function(){var t="";G_OF_OBJ.totalFiles>0&&(t='<table cellspacing="0" cellpadding="0" border="0" ><tr><td nowrap="nowrap" id="pagestatusid" class="pagecount smallText"></td><td><div id="prevbuttonid"  class="prevActive">&nbsp;</div></td><td><div id="nextbuttonid"  class="nextActive">&nbsp;</div></td></tr></table>',e("#servicefilepagination").html(t),G_OF_OBJ.nextIndex>=G_OF_OBJ.totalFiles&&(G_OF_OBJ.nextIndex=G_OF_OBJ.totalFiles,e("#prevbuttonid").removeClass().addClass("prevActive"),e("#nextbuttonid").removeClass().addClass("nextDis")),1==G_OF_OBJ.prevIndex&&e("#prevbuttonid").removeClass().addClass("preDis"),e("#pagestatusid").text(G_OF_OBJ.prevIndex+" - "+G_OF_OBJ.nextIndex+" "+zd_js_obj.of+" "+G_OF_OBJ.totalFiles),e("#servicefilepagination").show())},previousPage:function(){e("#prevbuttonid","#servicefilepagination").hasClass("preDis")||(G_OF_OBJ.nextIndex=Math.abs(G_OF_OBJ.prevIndex)-Math.abs(1),G_OF_OBJ.prevIndex=Math.abs(G_OF_OBJ.nextIndex)-(Math.abs(G_OF_OBJ.docsPerPage)-Math.abs(1)),G_OF_OBJ.prevIndex<G_OF_OBJ.topLevelFetch?(G_OF_OBJ.topLevelFetch=Math.abs(G_OF_OBJ.prevIndex),G_OF_OBJ.bottomLevelFetch=Math.abs(G_OF_OBJ.topLevelFetch)+Math.abs(G_OF_OBJ.fetchLimit)-Math.abs(1),G_OF_OBJ.endIndex="10",G_OF_OBJ.fromIndex="0",G_OF_OBJ.startFrom=G_OF_OBJ.topLevelFetch,e("div#showattachfilespace").attachfiledatagrid("sendAjaxRequest")):G_OF_OBJ.prevIndex<=G_OF_OBJ.bottomLevelFetch&&(G_OF_OBJ.fromIndex=Math.abs(G_OF_OBJ.fromIndex)-Math.abs(10),G_OF_OBJ.endIndex=Math.abs(G_OF_OBJ.endIndex)-Math.abs(10),e("div#showattachfilespace").attachfiledatagrid("constructDocumentRows")),ATTACHDIALOG.hideLoadingMsg())},nextPage:function(){return e("#nextbuttonid","#servicefilepagination").hasClass("nextDis")?!1:(G_OF_OBJ.prevIndex=Math.abs(G_OF_OBJ.nextIndex)+Math.abs(1),G_OF_OBJ.nextIndex=Math.abs(G_OF_OBJ.nextIndex)+Math.abs(G_OF_OBJ.docsPerPage),G_OF_OBJ.nextIndex<=G_OF_OBJ.bottomLevelFetch?(G_OF_OBJ.fromIndex=Math.abs(G_OF_OBJ.endIndex),G_OF_OBJ.endIndex=Math.abs(G_OF_OBJ.endIndex)+Math.abs(G_OF_OBJ.docsPerPage),e("div#showattachfilespace").attachfiledatagrid("constructDocumentRows")):(G_OF_OBJ.fromIndex="0",G_OF_OBJ.endIndex="10",G_OF_OBJ.topLevelFetch=Math.abs(G_OF_OBJ.bottomLevelFetch)+Math.abs(1),G_OF_OBJ.bottomLevelFetch=Math.abs(G_OF_OBJ.bottomLevelFetch)+Math.abs(G_OF_OBJ.fetchLimit),G_OF_OBJ.startFrom=G_OF_OBJ.topLevelFetch,e("div#showattachfilespace").attachfiledatagrid("sendAjaxRequest")),void ATTACHDIALOG.hideLoadingMsg())},resize:function(){e("#attachFileDataDiv").css({height:this.element.height()-30})},destroy:function(){e.Widget.prototype.destroy.apply(this,arguments),this.element.unbind("."+this.widgetName);var t=this.element,s=e(t).children();e(s).each(function(t,s){e(s).undelegate(),e(s).empty().remove()})}}),e.extend(e.ui.attachfiledatagrid,{version:"1.8"})}(jQuery),function(e){e.widget("ui.DocsFileUploader",{defaults:{service:"zdocs",container_id:"",fileLimit:3,maxFileSize:100,fileSizeInByte:1024,docs_url:"",udserver_url:"",permaLink:"",doc_conversion:!1,ie_url:"",folderId:"-1",workSpaceId:"",libraryId:"",callback:"",ieParams:"",udserver_upload:!0,zsoid:"",progresscallbck:"",UploadStatusObj:{},uploadto:"",handback:"",fileType:"",params:{isUploadStatus:!1,totalFilesCount:1,sharedType:""}},_create:function(){this.options=e.extend({},this.defaults,this.options),this.options.permaLink=this.options.docs_url;var t="?";for(var s in this.options.params)t=t+s+"="+this.options.params[s]+"&";t=""!=this.options.workSpaceId&&"-1"!=this.options.folderId?t+"doc_conversion="+this.options.doc_conversion+"&folderId="+this.options.folderId+"&isWSsubFolder=true&workSpaceUpload=true&workSpaceId="+this.options.workSpaceId:""!=this.options.libraryId&&"zdocs"===this.options.service?t+"workSpaceId="+this.options.libraryId+"&isWSsubFolder=false&folderId=-1&workSpaceUpload=true&libraryId="+this.options.libraryId:""!=this.options.workSpaceId&&"-1"===this.options.folderId?t+"doc_conversion="+this.options.doc_conversion+"&workSpaceUpload=true&folderId="+this.options.workSpaceId:t+"doc_conversion="+this.options.doc_conversion+"&folderId="+this.options.folderId,this.options.ie_url=this.options.docs_url,"zdocs"===this.options.service||"zwriter"===this.options.service?this.options.docs_url=this.options.docs_url+"/dndupload.do"+t:"cms"===this.options.service?this.options.docs_url=this.options.docs_url+"/ws/wsdndupload.do?zsoid="+this.options.zsoid+"&updateDoc=false&workSpaceId="+this.options.workSpaceId+"&folderId=-1&zsoidservice="+this.options.service:"zcrm"===this.options.service&&(this.options.url=this.options.url+t),this.options.ieParams=t,this._buttonInit()},_buttonInit:function(){var t=this;if(void 0==zd_js_obj||""==zd_js_obj){var s=function(){t._buttonInit()};return t.getI18N(s,t.options.docs_url),!1}if(this.options.isComp)""===this.options.fileType||"all"===this.options.fileType?e("#linkdocsdialogdiv").append('<input type="file" id="zd_UploadButton" name="multiupload_file" value="" style="visibility:hidden;" multiple>'):"images"===this.options.fileType?e("#linkdocsdialogdiv").append('<input type="file" accept="image/*" id="zd_UploadButton" name="multiupload_file" value="" style="visibility:hidden;" multiple>'):"videos"===this.options.fileType&&e("#linkdocsdialogdiv").append('<input type="file" accept="video/*" id="zd_UploadButton" name="multiupload_file" value="" style="visibility:hidden;" multiple>'),e(this.element).click(function(){e("#zd_UploadButton").click()});else{e(this.element).append('<input type="file" id="zd_UploadButton" name="multiupload_file" value="" style="opacity:0;position:absolute;left:-2000px;" multiple>');var a=e(this.element).width();e("#zd_UploadButton").css("width",a),e(this.element).hover(function(){e("#zd_UploadButton").css("left","0px")},function(){e("#zd_UploadButton").css("left","-2000px")})}var t=this;e("#zd_UploadButton").bind("change",function(){""===t.options.container_id&&""===t.options.callback&&e("body").append('<table id="zd_contain"></table>');var s=t.options.docs_url,a=navigator.appVersion.split(";"),i=a[1],o=10;if(void 0!==i&&(o=parseInt(i.replace("MSIE ",""))),"Microsoft Internet Explorer"===navigator.appName&&(t.options.udserver_upload=!1),"Microsoft Internet Explorer"===navigator.appName&&9>=o){{e("#zd_UploadButton").attr("value")}curFileElement=e("#zd_UploadButton");var d=(new Date).getTime(),r="target"+(new Date).getTime(),n=e("#zd_UploadButton").parent(),l=e("#zd_UploadButton").clone();n.append(l);var c=e("<div />").appendTo("body");c.attr("id","uploadfilediv"),c.attr("height","1%");var _=e("<form></form>");_.attr({id:"form-"+d,target:r,name:"form-"+d,method:"POST",encType:"multipart/form-data",encoding:"multipart/form-data"}),_.css({margin:0,display:"none"}),_.append(curFileElement);var p=e('<iframe name="'+r+'">').attr({height:"0",width:"0",id:r}).css("display","none");e("body").append(p),e(c).append(_);var h=e("#uploadfilediv"),D=h.children("form"),v={};v.uid="docsUploadWidget",v.callbck=t.options.callback;var u=t.options.ie_url+"/uploadsingle.do"+t.options.ieParams+"&refFileElementId=docsUploadWidget"+t.options.callback;e(D[0]).attr("action",u),D[0].submit()}else{var m=this.files,f=m.length;f>t.options.fileLimit&&(f=t.options.fileLimit),f>100&&(f=100);for(var O=0;f>O;O++)t.docUpload(m[O],m[O].size,m[O].name,s,O)}})},getI18N:function(t,s){var a="https://"+s+"/docs/zduserdetails.do";e.ajax({url:a,type:"GET",dataType:"html",xhrFields:{withCredentials:!0},success:function(s){e("#zd_user_details").remove(),e("body").append(s),void 0!=t&&""!=t&&t()}})},updateProgress:function(e,t,s,a){var i=this;if(t.lengthComputable){var o=Math.round(100*t.loaded/t.total);if(e.currentProgress!=o){e.currentProgress=o,i.fileUploadProgressUpdated(a,e.fileName,e.fileSize,e.currentProgress,s);var d=(new Date).getTime(),r=d-e.currentStart;if(r>3e3){{t.loaded-e.startData}e.startData=t.loaded,e.currentStart=d,e.currentStart=d}}}},fileUploadProgressUpdated:function(e,t,s,a){var i=this,o=a/100*100;"function"==typeof i.options.progresscallbck&&i.options.progresscallbck(o,t,s,e)},cancelUpload:function(e){var t=this;t.options.UploadStatusObj[e].abort()},docUpload:function(t,s,a,i,o){var d=this;"cms"===d.options.service&&(i=d.options.permaLink+"/ws/corswsdndupload.do?zsoid="+d.options.zsoid+"&updateDoc=false&workSpaceId="+d.options.workSpaceId+"&folderId="+d.options.folderId+"&zsoidservice="+d.options.service);var r=s/(d.options.fileSizeInByte*d.options.fileSizeInByte);if(r>d.options.maxFileSize)return alert(ZDUtils.replaceParams(zd_js_obj.file_chooser_file_size_is_greater_than_limit,[a,d.options.maxFileSize,"MB"])),!1;var n=new XMLHttpRequest,l=n.upload;l.fileIndex=o,l.fileName=a,l.fileSize=r,l.downloadStartTime=(new Date).getTime(),l.currentStart=l.downloadStartTime,l.currentProgress=0,l.startData=0;var c=o+"_new_"+e.now();if(l.upload_id=c,l.addEventListener("progress",function(e){"zcrm"===d.options.service?d.updateProgress(l,e,"CR",c):"cms"===d.options.service&&d.updateProgress(l,e,"cms",c)},!1),n.fileName=a,n.withCredentials=!0,"withCredentials"in n){if(d.options.udserver_upload){n.open("POST",zd_udserverurl+"/webupload",!0),n.setRequestHeader("Connection","Keep-Alive"),n.setRequestHeader("Content-type",t.type),n.setRequestHeader("x-service",zd_udservicekey),"zcrm"===d.options.service?(n.setRequestHeader("invoker","CR"),n.setRequestHeader("x-uploadto",d.options.uploadto)):"cms"===d.options.service?n.setRequestHeader("invoker","cms"):(n.setRequestHeader("invoker","Upload"),n.setRequestHeader("x-uploadTo","myfolders")),n.setRequestHeader("x-streammode","1"),n.setRequestHeader("upload-id",o+"_new_"+e.now()),n.setRequestHeader("x-content_type",t.type),n.setRequestHeader("x-filename",encodeURIComponent(t.name)),n.setRequestHeader("x-doc_conversion",!1),n.setRequestHeader("x-folderId",d.options.folderId),""!==d.options.workSpaceId&&void 0!==d.options.workSpaceId&&n.setRequestHeader("x-wsId",d.options.workSpaceId),""!==d.options.zsoid&&void 0!==d.options.zsoid&&n.setRequestHeader("x-zsoid",d.options.zsoid),n.setRequestHeader("charset","utf-8"),n.setRequestHeader("Content-Length",t.size);var _="";"zwriter"===d.options.service?_="WR":"zsheet"===d.options.service?_="ST":"zshow"===d.options.service?_="SW":"zbooks"===d.options.service?_="ZB":"zmail"===d.options.service?_="VO":"zcrm"===d.options.service?_="CR":"zplanner"===d.options.service?_="PL":"cms"===d.options.service&&(_="ZS"),n.setRequestHeader("x-notifyto",_),n.send(t)}else{var p=new FormData;p.append("multiupload_file",t),p.append(docsCSRFParamNAME,getDocsCsrfTokenFromCookie(docsCSRFCookieName)),n.open("POST",i,!0),n.onreadystatechange=function(){if(4===this.readyState&&this.status>=200&&this.status<400){var t=this.response;e("body").append(t);var s=d.options.permaLink+"/file/"+e("#successdndmessagediv").attr("docId");e(d.element).text(zd_js_obj.file_chooser_label_upload_to_docs);var a="<a href="+s+' name="filelink" id="filelink">'+this.fileName+"</a>";if(e("#theImg").remove(),e(d.element).unbind("click"),e(d.element).bind("click",function(){e("#zd_UploadButton").click()}),e("#result").css("display","block"),""!=d.options.container_id&&""===d.options.callback)e("#"+d.options.container_id).append(a);else if(""!=d.options.callback&&"function"==typeof d.options.callback){var i="";i=""!=d.options.handback?e("#successdndmessagediv").attr("docId")+d.options.handback:e("#successdndmessagediv").attr("docId"),d.options.callback(i)}else e("#zd_contain").append("<tr><td>"+a+"</td></tr>");e("#successdndmessagediv").remove()}},n.send(p)}e(d.element).unbind("click"),e(d.element).text(zd_js_obj.file_chooser_label_uploading),e("#theImg").remove()}},_destroy:function(){e.widget.prototype.destroy.call(this)}})}(jQuery),"undefined"!=typeof Collaboration&&"undefined"!=typeof Collaboration.prototype&&(Collaboration.prototype.constructor.handleCrossProductMessage=function(e){return function(){if("UDSERVER_UPLOAD"===arguments[1].action){var t=arguments[1];jQuery(":data(DocsFileUploader)").each(function(){var e=$(this).data("DocsFileUploader");e.options.isComp&&($(e.element).unbind("click"),$(e.element).bind("click",function(){$("#zd_UploadButton").click()}));var s=e.options.callback;s(t.resourceId)})}else if("CREATE_THUMBNAIL"==arguments[1].action){var t=arguments[1];jQuery(":data(DocsFileUploader)").each(function(){var e=$(this).data("DocsFileUploader");if(e.options.isComp){var s=e.options.permaLink+"/api/v2/files/properties?action=jsonobject&crossdomain=true&resourceid="+t.resourceId+"&"+zdcsrfPair;void 0!==G_LD_OBJ&&(s+="&accessService="+G_LD_OBJ.urlInvoker+"&zsoid="+G_LD_OBJ.zsoid),ZD.ajax({url:s,datatype:"json",xhrFields:{withCredentials:!0},success:function(e){ZD("#"+e.res_id).html(""),ZD("#"+e.res_id).append('<div style="width:75px;height:75px;"><img src="'+e.preview_url+'" style="height:75px;width:75px;" onerror="LINKDOCS.imgLoadingError(\''+e.no_preview_class+'\',this);"></div><div style="height:18px"><p style="font-size:small;margin-top:0px;height:18px;width:81px;overflow:hidden;margin-left:-3px;white-space: nowrap;" title="'+e.enc_res_name+'">'+e.enc_res_name+"</p></div>")}})}})}return e.apply(this,arguments)}}(Collaboration.prototype.constructor.handleCrossProductMessage));