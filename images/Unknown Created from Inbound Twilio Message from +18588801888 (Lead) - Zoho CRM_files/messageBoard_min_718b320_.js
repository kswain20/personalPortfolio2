var sdk=function(e){e.element.style["pointer-events"]="none",(e.element.style.opacity>=1||""==e.element.style.opacity)&&(e.element.style.opacity=e.elementOpacity||"0.2"),this.mics_iframeDiv=document.createElement("div"),this.mics_iframeDiv.id="mics_stacked_carpet",this.mics_iframeDiv.setAttribute("style",e.iframeStyle||"width:700px;z-index:9999;height:100vh;overflow:auto;display:none;position:fixed;bottom:0px;right:0px;border:0px"),this.mics_iframe=document.createElement("iframe"),this.mics_iframe.setAttribute("style","width:100%;height:100%;border:0px;"),this.mics_iframe.setAttribute("sandbox","allow-scripts allow-same-origin"),this.stacked_backdrop=document.createElement("div"),this.stacked_backdrop.id="mics_stacked_backdrop",this.stacked_backdrop.setAttribute("style",e.backdropStyle||"display:none;z-index:9999;width:100vw;height:100vh;background:#000;opacity:0.3;position:fixed;top:0;left:0;"),document.body.appendChild(this.stacked_backdrop),document.body.appendChild(this.mics_iframeDiv),this.mics_iframeDiv.appendChild(this.mics_iframe);var t=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""),s=e.tipengineURL,i=e.styleJson,a=this,o=!1,n=!0,c=function(t){setTimeout((function(){0==o&&(a.mics_iframe.src=e.src||"/analytics/stacked.jsp",c(2*t<3600?2*t:3600))}),1e3*t)};c(300),this.mics_iframe.onload=function(o){a.mics_iframe.contentWindow.postMessage({type:"init",serviceID:e.serviceID,orgID:e.orgID,url:t,panelId:1,panelTemplateName:e.panelTemplateName||"panel-template-primary",styles:i},s)},this.mics_iframe.src=e.src||"/analytics/stacked.jsp",window.addEventListener("message",(function(t,s,i){if(t.origin==e.tipengineURL&&1==t.data.panelId)switch(t.data.type){case"open":e.onclick(t.data);break;case"close":a.stacked_backdrop.style.display="none",a.mics_iframeDiv.style.display="none",document.getElementById("viewFeatures").style.display="none",document.querySelector("#msgBoardDisplay .msg-board-icon").classList.remove("msg-board-icon-active");var d=$L("html"),l=document.getElementById("stNotes");l&&"block"===l.style.display?d.addClass("oH"):d.removeClass("oH");break;case"notification":(0==o||n)&&(e.element.style["pointer-events"]="all",e.element.style.opacity="1",o=!0,n=!1),e.updateNumber(t.data);break;case"reload":o=!1,n=!0,c(300),e.element.style["pointer-events"]="none",e.element.style.opacity=e.elementOpacity||"0.4"}})),e.element.addEventListener("click",(function(){var t=document.getElementById("viewFeatures").style.display;"block"!=t&&0!=t.length||(a.mics_iframe.src||(a.mics_iframe.src=e.src||"/analytics/stacked.jsp"),$L("html").addClass("oH"),a.stacked_backdrop.style.display="block",a.mics_iframeDiv.style.display="block",e.updateNumber({value:{unviewedMessages:0}}),a.mics_iframe.contentWindow.postMessage({type:"focus"},s));var i=document.getElementById("stNotes");i&&"block"===i.style.display&&(a.stacked_backdrop.style.display="none")})),document.getElementById("stackedNumber").addEventListener("click",(function(){var t=document.getElementById("viewFeatures").style.display;"block"!=t&&0!=t.length||(a.mics_iframe.src||(a.mics_iframe.src=e.src||"/analytics/stacked.jsp"),$L("html").addClass("oH"),a.stacked_backdrop.style.display="block",a.mics_iframeDiv.style.display="block",e.updateNumber({value:{unviewedMessages:0}}),a.mics_iframe.contentWindow.postMessage({type:"focus"},s));var i=document.getElementById("stNotes");i&&"block"===i.style.display&&(a.stacked_backdrop.style.display="none")})),this.stacked_backdrop.addEventListener("click",(function(){$L("html").removeClass("oH"),a.stacked_backdrop.style.display="none",a.mics_iframeDiv.style.display="none",document.getElementById("viewFeatures").style.display="none",document.querySelector("#msgBoardDisplay .msg-board-icon").classList.remove("msg-board-icon-active"),a.mics_iframe.contentWindow.postMessage({type:"backdrop"},s)}),!1),sdk.prototype.stylesUpdate=function(e){a.mics_iframe.contentWindow.postMessage({type:"styleUpdate",styles:e},s)},sdk.prototype.orgUpdate=function(t){e.element.style["pointer-events"]="none",e.element.style.opacity=e.elementOpacity||"0.4",document.getElementById("stackedNumber").style.display="none",n=!0,a.mics_iframe.contentWindow.postMessage({type:"orgUpdate",orgID:t},s)}};