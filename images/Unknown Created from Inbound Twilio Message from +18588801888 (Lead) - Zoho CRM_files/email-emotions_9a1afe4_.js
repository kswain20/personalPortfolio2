Lyte.Mixin.register("crm-email-emotions-mixin",{getPreviousMailDetailsFromDB:function(a,e){var i="/crm/v2.2/"+a+"/"+e+"/Emails",n={type:"received",per_page:"1"},o=this;return store.findAll("dummy",n,!1,!1,{url:i}).then((function(a){var e=a?a.Emails[0].emotion:"",i=a?a.Emails[0].from.user_name:"";o.loadEmotionBand(e,i)}))},loadEmotionBand:function(a,e){var i=$("#etZiaEmotionBand"),n="",o="";a&&(n="Happy"===a||"Enthusiasm"===a||"Trust"===a||"Gratitude"===a?"ziaLastMailSendBandHappy":"Neutral"===a?"ziaLastMailSendBandNeutral":"ziaLastMailSendBandangry",e=Handlebars.helpers.encodeHTML(e),a=this.getTranslatedEmotionValue(a),o=EmailComposeUtil.isReplyMail?'<span data-zcqa="emotion_band" class="pA fromTopCenter ziaLastMailSentimentBand col333 '+n+'">'+I18n.getMsg("crm.label.zia.reply.desc",[e,a])+' <div class="ico-close-small pA r10 svgIcons top10 cP" onClick="EmailComposeUtil.closeZiaEmotionBand()"></div></span>':'<span data-zcqa="emotion_band" class="pA fromTopCenter ziaLastMailSentimentBand col333 '+n+'">'+I18n.getMsg("crm.label.zia.compose.desc",[e,a])+' <div class="ico-close-small pA r10 svgIcons top10 cP" onClick="EmailComposeUtil.closeZiaEmotionBand()"></div></span>',i.append(o))},closeZiaEmotionBand:function(){var a=$("#etZiaEmotionBand").children()[0];void 0!==a&&a.remove()},findZiaEmailConfigDetails:function(){var a={isOrgConfig:!0,isCommunication:!0};return Lyte.resolvePromises({zia_config:store.findAll("dummy",a,!1,!1,{url:"/crm/v2/setup/zia/config"})}).then((function(a){return a}))},getTranslatedEmotionValue:function(a){var e="";switch(a){case"Happy":e="crm.label.zia.email.emotion.happy";break;case"Gratitude":e="crm.label.zia.email.emotion.gratitude";break;case"Enthusiasm":e="crm.label.zia.email.emotion.enthusiasm";break;case"Trust":e="crm.label.zia.email.emotion.trust";break;case"Neutral":e="crm.label.zia.email.emotion.neutral";break;case"Discontentment":e="crm.label.zia.email.emotion.discontentment";break;case"Frustration":e="crm.label.zia.email.emotion.frustration";break;case"Confusion":e="crm.label.zia.email.emotion.confusion"}return I18n.getMsg(e)}});
